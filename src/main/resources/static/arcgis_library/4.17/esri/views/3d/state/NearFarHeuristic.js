// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/mathUtils ../../../core/mathUtils ../../../core/unitUtils ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/support/geodesicConstants".split(" "),function(C,n,q,u,v,m,r,p){function t(c,b,e,a){e=w/e;c/b>e?(a.far=c,a.near=a.far/b):(a.near=e,a.far=a.near*b);return a}Object.defineProperty(n,"__esModule",{value:!0});n.createNearFarHeuristic=void 0;n.createNearFarHeuristic=function(c,b,e){return 1===c?new x:new y(b,e)};var y=
function(){function c(b,e){this.elevationProvider=b;this.unitInMeters=v.getMetersPerUnitForSR(e)}c.prototype.compute=function(b,e,a,c,g){g||(g={near:0,far:0});var d=b[2]*this.unitInMeters,h=d;c=d-c;var k=this.elevationProvider?this.elevationProvider.elevationBounds:null;k&&(d=0<=c?h-this.unitInMeters*k.min:this.unitInMeters*k.max-h);h=Math.max(a.xmax-a.xmin,a.ymax-a.ymin,4*Math.max(a.xmax-a.xmin,a.ymax-a.ymin));m.vec3.subtract(f,e,b);l[0]=0<f[0]?a.xmax:a.xmin;l[1]=0<f[1]?a.ymax:a.ymin;l[2]=0<f[2]?
h/2:-h/2;m.vec3.subtract(l,l,b);m.vec3.normalize(f,f);b=1.1*m.vec3.dot(l,f)*this.unitInMeters;e=Math.sqrt(d*(d+2*p.earthRadius));a=Math.max(a.xmax-a.xmin,a.ymax-a.ymin);k=a*z*this.unitInMeters;d=q.clamp((d-k)/(a*A*this.unitInMeters-k),0,1);d=u.lerp(e,b,d*d*d);d*=Math.max(Math.log(Math.abs(c)),1);d=Math.min(d,Math.max(34064E4,h));d/=this.unitInMeters;return t(d,B,this.unitInMeters,g)};return c}(),x=function(){function c(){}c.prototype.compute=function(b,c,a,f,g){g||(g={near:0,far:0});b=m.vec3.length(b)-
p.earthRadius;b=Math.max(Math.abs(b-f),Math.abs(b));f=Math.sqrt(b*(b+2*(p.earthRadius+Math.min(0,f))));b=q.clamp(2E4-(Math.log(b)-7.983)/9.011*19E3,1E3,2E4);return t(1.2*f,b,1,g)};return c}(),B=2E4,w=2,A=.001,z=1E-4,l=r.vec3f64.create(),f=r.vec3f64.create()});