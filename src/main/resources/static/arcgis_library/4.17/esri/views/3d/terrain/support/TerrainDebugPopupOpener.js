// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../Graphic ../../../../symbols ../../../../core/HandleOwner ../../../../core/watchUtils ../../../../core/accessorSupport/decorators ../../../../geometry/support/aaBoundingRect ../../support/debugFlags ../tileUtils".split(" "),function(l,b,k,p,m,q,r,n,t,u,v){Object.defineProperty(b,"__esModule",{value:!0});b.TerrainDebugPopupOpener=void 0;l=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}k.__extends(a,b);a.prototype.initialize=function(){var e=
this;this.handles.add(this.surface.view.on("click",this._clickEvent.bind(this)));u.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!0;this.surface.view.popup.autoOpenEnabled=!1;r.whenFalse(this.surface.view.popup,"visible",function(){e._removeTileBoundaryGraphic()})};a.prototype.destroy=function(){this.surface.view.popup.autoOpenEnabled=!0};a.prototype._clickEvent=function(e){var c=this;this.surface.view.hitTest(e).then(function(a){a=a.intersector.results.min;if("TerrainRenderer"===a.intersector){var b=c.surface.getTile(a.name);
c.surface.view.popup.actions.removeAll();c.surface.view.popup.open({title:"Tile "+a.name,location:e.mapPoint,content:c._createTileDataTable(b)});c._removeTileBoundaryGraphic();c.tileBoundaryGraphic=c._createTileBoundaryGraphic(b);c.surface.view.graphics.add(c.tileBoundaryGraphic)}})};a.prototype._createTileDataTable=function(a){var c=document.createElement("table");c.innerHTML="\x3ctr\x3e\n                             \x3cth style\x3d'text-align:center;font-weight:bold'\x3etype\x26nbsp;\x26nbsp;\x26nbsp;\x3c/th\x3e\n                             \x3cth style\x3d'text-align:center;font-weight:bold'\x3elayer\x26nbsp;\x26nbsp;\x26nbsp;\x3c/th\x3e\n                             \x3cth style\x3d'text-align:center;font-weight:bold'\x3edata from tile\x26nbsp;\x26nbsp;\x26nbsp;\x3c/th\x3e\n                           \x3c/tr\x3e";
for(var b=0;b<a.layerInfo.length;b++)for(var e=a.layerInfo[b],g=0;g<e.length;g++){var f=e[g],h=document.createElement("tr"),d=void 0,d=document.createElement("td");d.textContent=0===g?w[b]:"";h.appendChild(d);d=document.createElement("td");d.textContent=g.toString();h.appendChild(d);f=f.data?a:f.upsampleInfo?f.upsampleInfo.tile:null;d=document.createElement("td");d.textContent=f?v.tile2str(f):"no data";h.appendChild(d);c.appendChild(h)}return c};a.prototype._removeTileBoundaryGraphic=function(){this.tileBoundaryGraphic&&
(this.surface.view.graphics.remove(this.tileBoundaryGraphic),this.tileBoundaryGraphic=null)};a.prototype._createTileBoundaryGraphic=function(a){a=t.toExtent(a.extent,this.surface.spatialReference);var b=new m.PolygonSymbol3D({symbolLayers:[new m.FillSymbol3DLayer({material:{color:"rgba(0, 0, 0, 0)"},outline:{size:"3px",color:"red"}})]});return new p({geometry:a,symbol:b})};k.__decorate([n.property({constructOnly:!0})],a.prototype,"surface",void 0);return a=k.__decorate([n.subclass("esri.views.3d.terrain.support.TerrainDebugPopupOpener")],
a)}(q.HandleOwner);b.TerrainDebugPopupOpener=l;var w=["elev","map"]});