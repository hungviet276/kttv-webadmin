// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../core/Handles ../../../../core/accessorSupport/decorators ../../camera/constraintUtils ../../camera/intersectionUtils ./CameraController".split(" "),function(g,c,d,h,e,k,l,f){Object.defineProperty(c,"__esModule",{value:!0});c.SurfaceCollisionCorrectionController=void 0;g=function(c){function a(b){b=c.call(this,b)||this;b.handles=new h;return b}d.__extends(a,c);Object.defineProperty(a.prototype,"desiredCamera",{set:function(b){this._set("desiredCamera",b.clone())},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"canStop",{get:function(){return!0},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"constraintEnabled",{get:function(){return this.view.state.constraints.collision.enabled},enumerable:!1,configurable:!0});a.prototype.onControllerStart=function(){var b=this;this.state=f.State.Running;this.handles.add(this.view.basemapTerrain.on("elevation-change",function(a){return b.handleElevationChangeEvent(a)}));this.applyCorrection()};
a.prototype.onControllerEnd=function(){this.handles.removeAll()};a.prototype.stepController=function(){};a.prototype.handleElevationChangeEvent=function(b){l.eyeWithinExtent(this.view,this.desiredCamera,b.extent,b.spatialReference)&&this.applyCorrection()};a.prototype.applyCorrection=function(){var b=this;this.view.state.updateCamera(function(a){a.copyViewFrom(b.desiredCamera);k.applySurfaceCollisionConstraint(b.view,a,1)||b.constraintEnabled||(b.state=f.State.Stopped)})};d.__decorate([e.property({constructOnly:!0})],
a.prototype,"view",void 0);d.__decorate([e.property({constructOnly:!0})],a.prototype,"desiredCamera",null);return a=d.__decorate([e.subclass("esri.views.3d.state.controllers.SurfaceCollisionCorrectionController")],a)}(f.CameraController);c.SurfaceCollisionCorrectionController=g});