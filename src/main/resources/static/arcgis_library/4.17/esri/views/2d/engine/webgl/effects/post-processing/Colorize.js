// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../../webgl","../../VertexStream"],function(k,e,m,n){Object.defineProperty(e,"__esModule",{value:!0});e.Colorize=void 0;k=function(){function d(){this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:{a_position:0}}}d.prototype.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};d.prototype.draw=function(a,l,b){this._createOrResizeResources(a);var c=
a.context,f=a.pixelRatio,g=a.state.size,d=a.painter.materialManager,e=this._programDesc,h=this._quad,f=[Math.round(f*g[0]),Math.round(f*g[1])];b=b.colorMatrix;h.bind();g=this._layerFBOTexture;c.bindFramebuffer(l);l.copyToTexture(0,0,f[0],f[1],0,0,g);c.setBlendingEnabled(!1);c.setStencilTestEnabled(!1);a=d.getProgram(a,e);c.bindProgram(a);c.bindTexture(g,2);a.setUniformMatrix4fv("u_coefficients",b);a.setUniform1i("u_colorTexture",2);h.draw();c.setBlendingEnabled(!0);c.setBlendFunction(1,771);c.setStencilTestEnabled(!0);
h.unbind()};d.prototype._createOrResizeResources=function(a){var d=a.context,b=a.pixelRatio,c=a.state.size;a=Math.round(b*c[0]);b=Math.round(b*c[1]);this._layerFBOTexture&&this._size[0]===a&&this._size[1]===b||(this._size[0]=a,this._size[1]=b,this._layerFBOTexture?this._layerFBOTexture.resize(a,b):this._layerFBOTexture=new m.Texture(d,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:a,height:b}),this._quad||(this._quad=new n(d,[-1,-1,
1,-1,-1,1,1,1])))};return d}();e.Colorize=k});