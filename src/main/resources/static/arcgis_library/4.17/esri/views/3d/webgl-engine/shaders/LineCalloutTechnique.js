// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/VerticalOffset.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../materials/internal/MaterialUtil ./LineCallout.glsl ./LineCallout.glsl ../../../webgl/Program ../../../webgl/renderState ../../../webgl/renderState @dojo/framework/shim/Promise".split(" "),
function(l,d,e,m,n,g,p,f,c,q,r,t,u,v,w,h){Object.defineProperty(d,"__esModule",{value:!0});d.LineCalloutTechniqueConfiguration=d.LineCalloutTechnique=void 0;f=function(c){function a(){return null!==c&&c.apply(this,arguments)||this}e.__extends(a,c);a.prototype.initializeProgram=function(k){var c=a.shader.get(),b=this.configuration,c=c.build({occlusionTestEnabled:b.occlusionTestEnabled,verticalOffsetEnabled:b.verticalOffset,screenSizePerspectiveEnabled:b.screenSizePerspective,depthHudEnabled:b.depthHudEnabled,
depthHudAlignStartEnabled:b.depthHudAlignStartEnabled,screenCenterOffsetUnitsEnabled:b.screenCenterOffsetUnitsEnabled,slicePlaneEnabled:b.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!0,viewingMode:k.viewingMode});return new v(k.rctx,c.generateSource("vertex"),c.generateSource("fragment"),q.Default3D)};a.prototype.bindPass=function(k,a,b){g.View.bindProjectionMatrix(this.program,b.camera.projectionMatrix);u.LineCallout.bindUniforms(this.program,a,b.camera.pixelRatio||
1);n.VerticalOffset.bindUniforms(this.program,a,b);this.program.setUniform1i("hudVisibilityTexture",0);k.bindTexture(b.hudVisibilityTexture,0);this.program.setUniform1f("cameraGroundRelative",b.camera.aboveGround?1:-1);this.program.setUniform1f("polygonOffset",a.shaderPolygonOffset);g.View.bindViewport(this.program,b);this.program.setUniform1f("perDistancePixelRatio",Math.tan(b.camera.fovY/2)/(b.camera.fullViewport[2]/2));this.program.setUniformMatrix4fv("viewNormal",b.camera.viewInverseTransposeMatrix);
this.program.setUniform2f("pixelToNDC",2/b.camera.fullViewport[2],2/b.camera.fullViewport[3]);this.program.setUniform1f("lineSize",Math.ceil(a.size)*(b.camera.pixelRatio||1));r.bindScreenSizePerspective(a.screenSizePerspective,this.program,"screenSizePerspectiveAlignment")};a.prototype.bindDraw=function(a){g.View.bindView(this.program,a);g.View.bindCamPosition(this.program,a.origin,a.camera.viewInverseTransposeMatrix);m.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};a.prototype.initializePipeline=
function(){return this.configuration.depthHudEnabled?h.makePipelineState({depthTest:{func:513},depthWrite:w.defaultDepthWriteParams}):h.makePipelineState({blending:h.separateBlendingParams(1,770,771,771),depthTest:{func:513},colorWrite:h.defaultColorWriteParams})};a.shader=new p.ReloadableShaderModule(t,function(){return new Promise(function(a,c){l(["./LineCallout.glsl"],a,c)})});return a}(f.ShaderTechnique);d.LineCalloutTechnique=f;f=function(d){function a(){var a=null!==d&&d.apply(this,arguments)||
this;a.occlusionTestEnabled=!0;a.verticalOffset=!1;a.screenSizePerspective=!1;a.depthHudEnabled=!1;a.depthHudAlignStartEnabled=!1;a.screenCenterOffsetUnitsEnabled=0;a.slicePlaneEnabled=!1;return a}e.__extends(a,d);e.__decorate([c.parameter()],a.prototype,"occlusionTestEnabled",void 0);e.__decorate([c.parameter()],a.prototype,"verticalOffset",void 0);e.__decorate([c.parameter()],a.prototype,"screenSizePerspective",void 0);e.__decorate([c.parameter()],a.prototype,"depthHudEnabled",void 0);e.__decorate([c.parameter()],
a.prototype,"depthHudAlignStartEnabled",void 0);e.__decorate([c.parameter({count:2})],a.prototype,"screenCenterOffsetUnitsEnabled",void 0);e.__decorate([c.parameter()],a.prototype,"slicePlaneEnabled",void 0);return a}(c.ShaderTechniqueConfiguration);d.LineCalloutTechniqueConfiguration=f});