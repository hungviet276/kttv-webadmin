// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ./common ../../support/geometryUtils ../../support/intersectionUtils".split(" "),function(y,g,n,p,h,k,q,r){function m(b,d,c){void 0===c&&(c=k.defaultApplyOptions);var a;a=b.state.constraints.altitude;a=b.state.isGlobal&&a?2===c.interactionType&&k.hasConstraintType(c.selection,1)?!1:!0:!1;if(!a)return 0;var e=b.state.constraints.altitude;a=t;a.min=e.min;a.max=e.max;var f=
c.interactionType;if(0!==f){var e=a.min,g=a.max,l=c.interactionStartCamera;c=c.interactionFactor;var f=2===f||1===f,h=m(b,l),l=0===h?0:b.renderCoordsHelper.getAltitude(l.eye);a.min=e;a.max=g;k.adjustRangeForInteraction(h,l,f,c,.05*l,a)}b=b.renderCoordsHelper.getAltitude(d.eye);b=n.clamp(b,a.min,a.max)-b;return 1E-6>=Math.abs(b)?0:b}function u(b,d,c,a){b.renderCoordsHelper.worldUpAtPosition(d.eye,a);p.vec3.scale(a,a,c);return a}Object.defineProperty(g,"__esModule",{value:!0});g.getAltitudeConstraintError=
g.applyAltitudeConstraint=void 0;g.applyAltitudeConstraint=function(b,d,c){void 0===c&&(c=k.defaultApplyOptions);var a=m(b,d,c);if(0===a)return!1;var e=b.renderCoordsHelper,f=e.getAltitude(d.eye)+a;b=k.interactionDirectionTowardsConstraintMinimization(d,c.interactionDirection,u(b,d,n.sign(a),v),w);c=p.vec3.copy(x,d.viewForward);e.intersectInfiniteManifold(q.ray.wrap(d.eye,b),f,d.eye)||e.setAltitude(f,d.eye);r.closestPointOnRay(d.eye,c,d.center,d.center);d.markViewDirty();return!0};g.getAltitudeConstraintError=
m;var t={min:0,max:0},w=h.vec3f64.create(),v=h.vec3f64.create(),x=h.vec3f64.create()});