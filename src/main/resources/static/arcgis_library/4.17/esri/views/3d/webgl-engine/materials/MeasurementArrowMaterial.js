// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/buffer/InterleavedLayout ../lib/GLMaterial ../lib/Material ../lib/Util ./internal/MaterialUtil ../shaders/MeasurementArrowTechnique".split(" "),function(n,I,p,b,c,B,C,D,h,q,A){n=function(b){function a(a,d){d=b.call(this,d)||this;d.techniqueConfig=new A.MeasurementArrowTechniqueConfiguration;d.params=q.copyParameters(a,E);return d}p.__extends(a,b);a.prototype.getTechniqueConfig=
function(){this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset;return this.techniqueConfig};a.prototype.dispose=function(){};a.prototype.setParameterValues=function(a){q.updateParameters(this.params,a)&&this.parametersChanged()};a.prototype.getParameters=function(){return this.params};a.prototype.getPassParameters=function(){return this.params};a.prototype.intersect=function(){};a.prototype.createBufferWriter=function(){return new F};a.prototype.getGLMaterial=function(a){return 0===
a.output?new G(a):void 0};return a}(D.Material);var G=function(b){function a(a){a=b.call(this,a)||this;a.updateParameters();return a}p.__extends(a,b);a.prototype.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(A.MeasurementArrowTechnique,this.material.getTechniqueConfig(),this.technique)};a.prototype.beginSlot=function(a){return 3===a};a.prototype.bind=function(a,b){a.bindProgram(this.technique.program);this.technique.bindPass(a,this.material.getPassParameters(),
b)};return a}(C.GLMaterial),E={width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1},H=B.newLayout().vec3f(h.VertexAttrConstants.POSITION).vec3f(h.VertexAttrConstants.NORMAL).vec2f(h.VertexAttrConstants.UV0).f32(h.VertexAttrConstants.AUXPOS1),k=c.vec3f64.create(),r=c.vec3f64.create(),v=c.vec3f64.create(),l=c.vec3f64.create(),w=c.vec3f64.create(),F=function(){function c(){this.vertexBufferLayout=H}c.prototype.allocate=function(a){return this.vertexBufferLayout.createBuffer(a)};
c.prototype.elementCount=function(a){return 2*(a.indices[h.VertexAttrConstants.POSITION].length/2+1)};c.prototype.write=function(a,f,d,c){var m=f.vertexAttr[h.VertexAttrConstants.POSITION].data,z=f.vertexAttr[h.VertexAttrConstants.NORMAL].data,t=m.length/3;(f=f&&f.indices&&f.indices.position)&&f.length!==2*(t-1)&&console.warn("MeasurementArrowMaterial does not support indices");f=a.transformation;for(var n=a.invTranspTransformation,p=d.position,q=d.normal,x=d.uv0,g=a=0;g<t;++g){var e=3*g;b.vec3.set(k,
m[e],m[e+1],m[e+2]);g<t-1&&(e=3*(g+1),b.vec3.set(r,m[e],m[e+1],m[e+2]),b.vec3.set(w,z[e],z[e+1],z[e+2]),b.vec3.normalize(w,w),b.vec3.subtract(v,r,k),b.vec3.normalize(v,v),b.vec3.cross(l,w,v),b.vec3.normalize(l,l));e=b.vec3.distance(k,r);f&&n&&(b.vec3.transformMat4(k,k,f),b.vec3.transformMat4(r,r,f),b.vec3.transformMat4(l,l,n));var u=c+2*g,y=u+1;p.setVec(u,k);p.setVec(y,k);q.setVec(u,l);q.setVec(y,l);x.set(u,0,a);x.set(u,1,-1);x.set(y,0,a);x.set(y,1,1);g<t-1&&(a+=e)}d=d.auxpos1;for(g=0;g<2*t;++g)d.set(c+
g,a)};return c}();return n});