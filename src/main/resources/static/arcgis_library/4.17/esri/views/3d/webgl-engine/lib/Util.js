// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64".split(" "),function(H,b,n,A,p,B,v,q,C){function r(a,d){if(!a)throw d=d||"assert",a=Error(d),a.stack&&console.log(a.stack),new w(d);}function x(a){for(var d in a)return d}function y(a,d){a[12]=d[0];a[13]=d[1];
a[14]=d[2]}function z(a,d){void 0===d&&(d=0);for(var c=0,b=0;4>b;b++)c+=a[d+b]*D[b];return c}function E(a){return a-Math.floor(a)}Object.defineProperty(b,"__esModule",{value:!0});b.inverseProjectionInfo=b.unpackFloatRGBA=b.packFloatRGBA=b.fovd2fovy=b.fovd2fovx=b.fovy2fovd=b.fovx2fovd=b.fovy2fovx=b.fovx2fovy=b.isTranslationMatrix=b.createTranslationMatrix=b.getMatrixTranslation=b.setMatrixTranslation3=b.setMatrixTranslation=b.logWithBase=b.objectEmpty=b.getFirstObjectValue=b.getFirstObjectKey=b.project=
b.rayRay2D=b.rayBoxTest=b.rayTriangle3D=b.dec2hex=b.rgb2hex=b.hex2rgb=b.fallbackIfUndefined=b.encodeNormal=b.encodeInt16=b.verify=b.assert=b.VertexAttrConstants=b.AssertException=void 0;var g=C.vec4f64.create(),w=function(){function a(a){this.message=a}a.prototype.toString=function(){return"AssertException: "+this.message};return a}();b.AssertException=w;b.VertexAttrConstants={POSITION:"position",NORMAL:"normal",UV0:"uv0",UVMAPSPACE:"uvMapSpace",MEANVERTEXPOSITION:"meanVertexPosition",AUXPOS1:"auxpos1",
AUXPOS2:"auxpos2",BOUND1:"bound1",BOUND2:"bound2",BOUND3:"bound3",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",TANGENT:"tangent"};b.assert=r;b.verify=function(a,d){a||console.warn("Verify failed: "+(d||"")+"\n"+Error("verify").stack)};b.encodeInt16=function(a){return n.clamp(Math.round(32767*a),-32767,32767)};b.encodeNormal=function(a,d){var b=Math.abs(a[0]),f=Math.abs(a[1]),e=1/(b+f+Math.abs(a[2])),h=Math.min(a[2]*e,0);d[0]=(0>a[0]?-1:1)*(b*e-h);d[1]=(0>a[1]?-1:1)*(f*e-h)};b.fallbackIfUndefined=
function(a,d){return void 0===a?d:a};b.hex2rgb=function(a){a=Math.floor(a);return[(a>>16&255)/255,(a>>8&255)/255,(a&255)/255]};b.rgb2hex=function(a){var d=n.clamp(Math.round(255*a[0]),0,255),b=n.clamp(Math.round(255*a[1]),0,255);a=n.clamp(Math.round(255*a[2]),0,255);return"0x"+((d<<16)+(b<<8)+a).toString(16)};b.dec2hex=function(a){a=a.toString(16);return"00000000".substr(0,8-a.length)+a};b.rayTriangle3D=function(a,d,b,f,e,h,k,m,l){void 0===l&&(l=v.vec3f64.create());var c=f[k]-b[h],g=f[k+1]-b[h+1],
n=f[k+2]-b[h+2];f=e[m]-b[h];k=e[m+1]-b[h+1];e=e[m+2]-b[h+2];var p=d[1]*e-k*d[2],q=d[2]*f-e*d[0],r=d[0]*k-f*d[1];m=c*p+g*q+n*r;if(-1E-5<m&&1E-5>m)return!1;m=1/m;var t=a[0]-b[h],u=a[1]-b[h+1];a=a[2]-b[h+2];l[1]=m*(t*p+u*q+a*r);if(0>l[1]||1<l[1])return!1;b=u*n-g*a;a=a*c-n*t;c=t*g-c*u;l[2]=m*(d[0]*b+d[1]*a+d[2]*c);if(0>l[2]||1<l[1]+l[2])return!1;l[0]=m*(f*b+k*a+e*c);return!0};b.rayBoxTest=function(a,b,c,f){var d,h=(c[0]-a[0])/b[0],k=(f[0]-a[0])/b[0];h>k&&(d=h,h=k,k=d);var g=(c[1]-a[1])/b[1],l=(f[1]-a[1])/
b[1];g>l&&(d=g,g=l,l=d);if(h>l||g>k)return!1;g>h&&(h=g);l<k&&(k=l);c=(c[2]-a[2])/b[2];a=(f[2]-a[2])/b[2];c>a&&(d=c,c=a,a=d);if(h>a||c>k)return!1;a<k&&(k=a);return 0>k?!1:!0};b.rayRay2D=function(a,b,c,f,e,g){void 0===g&&(g=B.vec2f64.create());var d=(f[e]-c[e])*(b[0]-a[0])-(f[0]-c[0])*(b[e]-a[e]);if(0===d)return!1;c=((f[0]-c[0])*(a[e]-c[e])-(f[e]-c[e])*(a[0]-c[0]))/d;g[0]=a[0]+c*(b[0]-a[0]);g[1]=a[e]+c*(b[e]-a[e]);return!0};b.project=function(a,b,c,f,e){e||(e=a);g[0]=a[0];g[1]=a[1];g[2]=a[2];g[3]=1;
q.vec4.transformMat4(g,g,b);2<e.length&&(e[2]=-g[2]);q.vec4.transformMat4(g,g,c);r(0!==g[3]);e[0]=g[0]/g[3];e[1]=g[1]/g[3];e[2]=g[2]/g[3];e[0]=(.5*e[0]+.5)*f[2]+f[0];e[1]=(.5*e[1]+.5)*f[3]+f[1]};b.getFirstObjectKey=x;b.getFirstObjectValue=function(a){return a[x(a)]};b.objectEmpty=function(a){for(var b in a)return!1;return!0};b.logWithBase=function(a,b){return Math.log(a)/Math.log(b)};b.setMatrixTranslation=y;b.setMatrixTranslation3=function(a,b,c,f){a[12]=b;a[13]=c;a[14]=f};b.getMatrixTranslation=
function(a,b){void 0===b&&(b=v.vec3f64.create());b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};b.createTranslationMatrix=function(a,b){a=A.mat4.identity(a);y(a,b);return a};b.isTranslationMatrix=function(a){return 1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&0===a[4]&&1===a[5]&&0===a[6]&&0===a[7]&&0===a[8]&&0===a[9]&&1===a[10]&&0===a[11]&&1===a[15]};b.fovx2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/b)};b.fovy2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/c)};b.fovx2fovd=function(a,
b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/b)};b.fovy2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/c)};b.fovd2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};b.fovd2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};b.packFloatRGBA=function(a,b,c){void 0===c&&(c=0);a=n.clamp(a,0,F);for(var d=0;4>d;d++)b[c+d]=Math.floor(256*E(a*G[d]))};b.unpackFloatRGBA=z;var G=[1,256,65536,16777216],D=[1/256,1/65536,
1/16777216,1/4294967296],F=z(new Uint8ClampedArray([255,255,255,255]));b.inverseProjectionInfo=function(a,b,c,f,e){0===a[11]?(f[0]=2/(b*a[0]),f[1]=2/(c*a[5]),f[2]=(1+a[12])/a[0],f[3]=(1+a[13])/a[5],p.vec2.set(e,0,1)):(f[0]=-2/(b*a[0]),f[1]=-2/(c*a[5]),f[2]=(1-a[8])/a[0],f[3]=(1-a[9])/a[5],p.vec2.set(e,1,0))}});