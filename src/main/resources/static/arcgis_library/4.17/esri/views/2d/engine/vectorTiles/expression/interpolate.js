// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../Color ../../../unitBezier ../GeometryUtils ./expression".split(" "),function(m,k,y,z,g,l){function n(b){return b>A?Math.pow(b,1/3):b/u+v}function p(b){return b>h?b*b*b:u*(b-v)}function q(b){return 255*(.0031308>=b?12.92*b:1.055*Math.pow(b,1/2.4)-.055)}function r(b){b/=255;return.04045>=b?b/12.92:Math.pow((b+.055)/1.055,2.4)}function t(b){var a=r(b.r),d=r(b.g),c=r(b.b),e=n((.4124564*a+.3575761*d+.1804375*c)/.95047),f=n((.2126729*a+.7151522*d+.072175*c)/1),a=n((.0193339*
a+.119192*d+.9503041*c)/1.08883);return{l:116*f-16,a:500*(e-f),b:200*(f-a),alpha:b.a}}function w(b){var a=(b.l+16)/116,d=isNaN(b.a)?a:a+b.a/500,c=isNaN(b.b)?a:a-b.b/200,a=1*p(a),d=.95047*p(d),c=1.08883*p(c);return new y([q(3.2404542*d-1.5371385*a-.4985314*c),q(-.969266*d+1.8760108*a+.041556*c),q(.0556434*d-.2040259*a+1.0572252*c),b.alpha])}function B(b,a,d){return{l:g.interpolate(b.l,a.l,d),a:g.interpolate(b.a,a.a,d),b:g.interpolate(b.b,a.b,d),alpha:g.interpolate(b.alpha,a.alpha,d)}}function x(b){var a=
t(b),d=a.a,c=a.b,e=Math.atan2(c,d)*C;return{h:0>e?e+360:e,c:Math.sqrt(d*d+c*c),l:a.l,alpha:b.a}}function D(b){var a=b.h*E,d=b.c;return w({l:b.l,a:Math.cos(a)*d,b:Math.sin(a)*d,alpha:b.alpha})}function F(b,a,d){var c=b.h,e=a.h-c;return{h:c+d*(180<e||-180>e?e-360*Math.round(e/360):e),c:g.interpolate(b.c,a.c,d),l:g.interpolate(b.l,a.l,d),alpha:g.interpolate(b.alpha,a.alpha,d)}}Object.defineProperty(k,"__esModule",{value:!0});k.Step=k.Interpolate=void 0;var v=4/29,h=6/29,u=3*h*h,A=h*h*h,E=Math.PI/180,
C=180/Math.PI;m=function(){function b(a,b,c,e){this.operator=a;this.input=b;this.stops=c;this.interpolation=e}b.parse=function(a){if(5>a.length)throw Error('"'+a[0]+'" expects at least 4 arguments.');var d=a[1];if(!Array.isArray(d)||0===d.length)throw Error('"'+a[0]+'" expects an interpolation type expression.');switch(d[0]){case "linear":break;case "exponential":if("number"!==typeof d[1])throw Error('"'+a[0]+'" expects a numeric base for exponential interpolation.');break;case "cubic-bezier":if(5!==
d.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.");for(var c=1;5>c;c++){var e=d[c];if("number"!==typeof e||0>e||1<e)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.");}break;default:throw Error('"'+a[0]+'" unknown interpolation type "'+d[0]+'".');}if(1!==a.length%2)throw Error('"'+a[0]+'" expects an even number of arguments.');for(var e=l.createExpression(a[2]),f=[],c=3;c<a.length;c+=2){var g=
a[c];if("number"!==typeof g)throw Error('"'+a[0]+'" requires stop inputs as literal numbers.');if(f.length&&f[f.length-1][0]>=g)throw Error('"'+a[0]+'" requires strictly ascending stop inputs.');f.push([g,l.createExpression(a[c+1])])}return new b(a[0],e,f,d)};b.prototype.evaluate=function(a,d){var c=this.stops;if(1===c.length)return c[0][1].evaluate(a,d);var e=this.input.evaluate(a,d);if(e<=c[0][0])return c[0][1].evaluate(a,d);if(e>=c[c.length-1][0])return c[c.length-1][1].evaluate(a,d);for(var f=
0;++f<c.length&&!(e<c[f][0]););var h=b.interpolationRatio(this.interpolation,e,c[f-1][0],c[f][0]),e=c[f-1][1].evaluate(a,d),k=c[f][1].evaluate(a,d);return"interpolate"===this.operator?Array.isArray(e)?e.map(function(a,b){return g.interpolate(a,k[b],h)}):g.interpolate(e,k,h):"interpolate-hcl"===this.operator?D(F(x(e),x(k),h)):w(B(t(e),t(k),h))};b.interpolationRatio=function(a,d,c,e){var f=0;"exponential"===a[0]?f=b.exponentialInterpolationRatio(d,a[1],c,e):"linear"===a[0]?f=b.exponentialInterpolationRatio(d,
1,c,e):"cubic-bezier"===a[0]&&(f=z.unitBezier(a[1],a[2],a[3],a[4])(b.exponentialInterpolationRatio(d,1,c,e),1E-5));return f};b.exponentialInterpolationRatio=function(a,b,c,e){e-=c;if(0===e)return 0;a-=c;return 1===b?a/e:(Math.pow(b,a)-1)/(Math.pow(b,e)-1)};return b}();k.Interpolate=m;m=function(){function b(a,b){this.input=a;this.stops=b}b.parse=function(a){if(5>a.length)throw Error('"step" expects at least 4 arguments.');if(1!==a.length%2)throw Error('"step" expects an even number of arguments.');
var d=l.createExpression(a[1]),c=[];c.push([-Infinity,l.createExpression(a[2])]);for(var e=3;e<a.length;e+=2){var f=a[e];if("number"!==typeof f)throw Error('"step" requires stop inputs as literal numbers.');if(c.length&&c[c.length-1][0]>=f)throw Error('"step" requires strictly ascending stop inputs.');c.push([f,l.createExpression(a[e+1])])}return new b(d,c)};b.prototype.evaluate=function(a,b){var c=this.stops;if(1===c.length)return c[0][1].evaluate(a,b);for(var d=this.input.evaluate(a,b),f=0;++f<
c.length&&!(d<c[f][0]););return this.stops[f-1][1].evaluate(a,b)};return b}();k.Step=m});