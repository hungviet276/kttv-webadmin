// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../camera/constraintUtils ../PointToPointAnimationController ../../../webgl-engine/lib/Camera ../../../webgl-engine/lib/Intersector ../../../../animation/easing".split(" "),function(h,a,k,m,e,g,n,p,l,q,r){Object.defineProperty(a,"__esModule",{value:!0});a.ZoomStepController=void 0;h=function(a){function c(){var b=null!==a&&a.apply(this,
arguments)||this;b.zoomLocation=g.vec3f64.create();b.tmpCamera=new l.default;b.tmpRayDir=g.vec3f64.create();b.tmpCenter=g.vec3f64.create();b.constraintOptions={selection:15,interactionType:1,interactionFactor:null,interactionStartCamera:new l.default,interactionDirection:null,tiltMode:0};return b}k.__extends(c,a);c.prototype.zoomStep=function(b,a){if(this.active){var d=this.view.state,c=this.constraintOptions.interactionStartCamera;this.animation.finished?c.copyFrom(d.camera):this.animation.cameraAt(1,
c);this.tmpCamera.copyFrom(d.camera);d=new q.Intersector(this.view.state.mode);0<b?(this.intersectionHelper.intersectScreenFreePointFallback(a,this.zoomLocation),this.intersectionHelper.intersectRay(this.tmpCamera.ray,d,this.tmpCenter)&&(this.tmpCamera.center=this.tmpCenter)):this.intersectionHelper.intersectRay(this.tmpCamera.ray,d,this.zoomLocation)?this.tmpCamera.center=this.zoomLocation:e.vec3.copy(this.zoomLocation,this.tmpCamera.center);this.updateCamera(this.tmpCamera,Math.pow(.6,b),this.zoomLocation);
this.begin(this.tmpCamera)}};c.prototype.animationSettings=function(){return{apex:null,duration:.6,easing:r.outExpo}};c.prototype.updateCamera=function(b,a,c){e.vec3.subtract(this.tmpRayDir,c,b.eye);var d=e.vec3.length(this.tmpRayDir),f=d*a;1>=a&&4>f&&(f=4,a=f/d);1E-6>Math.abs(d-f)||(e.vec3.scale(this.tmpRayDir,this.tmpRayDir,a),e.vec3.subtract(b.eye,c,this.tmpRayDir),e.vec3.lerp(b.center,b.center,c,1-a),n.applyAll(this.view,b,this.constraintOptions))};return c=k.__decorate([m.subclass("esri.views.3d.state.controllers.local.ZoomStepController")],
c)}(p.PointToPointAnimationController);a.ZoomStepController=h});