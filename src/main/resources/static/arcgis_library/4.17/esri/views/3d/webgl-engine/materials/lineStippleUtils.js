// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../core/maybe","../../../webgl"],function(g,c,d,k){Object.defineProperty(c,"__esModule",{value:!0});c.createStipplePatternSimple=c.createStipplePattern=c.StippleTextureRepository=void 0;g=function(){function a(){this.cache=new Map}a.prototype.dispose=function(){this.cache.forEach(function(b){d.isSome(b.texture)&&(b.texture.dispose(),b.texture=null)});this.cache.clear()};a.prototype.acquire=function(b){if(d.isNone(b))return null;var f=this.patternId(b),a=this.cache.get(f);
if(a)return a.refCount++,a.bind;var c=this.patternToTextureData(b,2),h=c.length/2,e={refCount:1,texture:null,bind:function(b,a){d.isNone(e.texture)&&(e.texture=new k.Texture(b,{width:c.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},c));b.bindTexture(e.texture,a);return h}};this.cache.set(f,e);return e.bind};a.prototype.release=function(b){if(!d.isNone(b)){b=this.patternId(b);var a=this.cache.get(b);a&&(a.refCount--,0===a.refCount&&(d.isSome(a.texture)&&a.texture.dispose(),
this.cache.delete(b)))}};a.prototype.swap=function(a,c){c=this.acquire(c);this.release(a);return c};a.prototype.patternId=function(a){return a.join(",")};a.prototype.patternToTextureData=function(a,c){for(var b=a.reduce(function(a,b){return a+b})*c,b=new Uint8Array(b),d=!0,h=0,e=0;e<a.length;e++){for(var g=a[e],f=0;f<g*c;f++)b[h++]=d?255:0;d=!d}return b};return a}();c.StippleTextureRepository=g;c.createStipplePattern=function(a){return d.isNone(a)?a:a.slice()};c.createStipplePatternSimple=function(a){return[a,
a]}});