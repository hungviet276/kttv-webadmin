// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ./LayerView3D ./graphics/Graphics3DFrustumVisibility ./graphics/Graphics3DGraphicLikeLayerView ./graphics/graphicUtils ./support/projectExtentUtils ../../layers/LayerView".split(" "),function(t,u,c,h,k,g,d,l,m,n,p,q,r){return function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;a.frustumVisibility=new m;a.slicePlaneEnabled=!1;a.drapeSourceType=
1;a.suspendResumeExtent=null;a.fullExtentInLocalViewSpatialReference=null;return a}c.__extends(a,e);a.prototype.initialize=function(){var a=this;this._set("graphics3d",new n({owner:this,layer:this.layer,scaleVisibilityEnabled:!0}));this.graphics3d.setup();this.frustumVisibility.setup(this);this.setupSuspendResumeExtent();this.updatingHandles.add(this,"fullOpacity",function(){return a.graphics3d.graphicsCore.opacityChange()});this.handles.add(this.layer.on("graphic-update",function(f){return a.graphics3d.graphicsCore.graphicUpdateHandler(f)}));
var b=q.toViewIfLocal(this).then(function(f){a.fullExtentInLocalViewSpatialReference=f});b&&this.addResolvingPromise(b);this.handles.add(g.whenTrueOnce(this.view,"basemapTerrain.ready",function(){return a.notifyChange("updating")}))};a.prototype.destroy=function(){this.frustumVisibility&&(this.frustumVisibility.destroy(),this._set("frustumVisibility",null));this.graphics3d&&(this.graphics3d.destroy(),this._set("graphics3d",null))};Object.defineProperty(a.prototype,"legendEnabled",{get:function(){return this.canResume()},
enumerable:!1,configurable:!0});a.prototype.fetchPopupFeatures=function(a,b){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(a){return[2,h.isSome(b)?b.clientGraphics:null]})})};a.prototype.notifyGraphicUpdate=function(a,b){this.graphics3d.graphicsCore.notifyGraphicUpdate(a,b)};Object.defineProperty(a.prototype,"graphics3DGraphics",{get:function(){return this.graphics3d.graphicsCore.graphics3DGraphics},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"graphics3DGraphicsByObjectID",{get:function(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"symbolUpdateType",{get:function(){return this.graphics3d.graphicsCore.symbolUpdateType},enumerable:!1,configurable:!0});a.prototype.getGraphicFromGraphicUid=function(a){return this.graphics3d.getGraphicFromGraphicUid(a)};a.prototype.whenGraphicBounds=function(a,b){return this.graphics3d.whenGraphicBounds(a,
b)};a.prototype.computeAttachmentOrigin=function(a,b){return this.graphics3d?this.graphics3d.graphicsCore.computeAttachmentOrigin(a,b):null};a.prototype.getSymbolLayerSize=function(a,b){return this.graphics3d.getSymbolLayerSize(a,b)};a.prototype.queryGraphics=function(){return k.resolve(this.loadedGraphics)};a.prototype.occlude=function(a){return this.graphics3d.occlude(a)};a.prototype.highlight=function(a){return this.graphics3d.highlight(a)};a.prototype.canResume=function(){return!e.prototype.canResume.call(this)||
this.frustumVisibility&&this.frustumVisibility.suspended||this.graphics3d&&this.graphics3d.suspended?!1:!0};a.prototype.isUpdating=function(){return!(!(this.graphics3d&&this.graphics3d.updating||this.frustumVisibility&&this.frustumVisibility.updating)&&this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.ready)};a.prototype.setupSuspendResumeExtent=function(){var a=this;g.init(this.graphics3d.graphicsCore,"computedExtent",function(b){a.suspendResumeExtent=p.enlargeExtent(b,a.suspendResumeExtent,
1.2);a.frustumVisibility.setExtent(a.suspendResumeExtent)},!0)};Object.defineProperty(a.prototype,"performanceInfo",{get:function(){return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:this.graphics3d.elevationAlignment.updating,visibilityFrustum:!this.frustumVisibility.suspended}},enumerable:!1,configurable:!0});c.__decorate([d.property({aliasOf:"layer.graphics"})],a.prototype,"loadedGraphics",
void 0);c.__decorate([d.property({dependsOn:["frustumVisibility.suspended","graphics3d.suspended"]})],a.prototype,"suspended",void 0);c.__decorate([d.property({readOnly:!0,dependsOn:["graphics3d.suspended","frustumVisibility.suspended"]})],a.prototype,"legendEnabled",null);c.__decorate([d.property({dependsOn:["frustumVisibility.updating","graphics3d.updating"]})],a.prototype,"updating",void 0);c.__decorate([d.property()],a.prototype,"layer",void 0);c.__decorate([d.property({readOnly:!0})],a.prototype,
"frustumVisibility",void 0);c.__decorate([d.property({readOnly:!0})],a.prototype,"graphics3d",void 0);c.__decorate([d.property({type:Boolean})],a.prototype,"slicePlaneEnabled",void 0);c.__decorate([d.property({aliasOf:"graphics3d.graphicsCore.hasDraped"})],a.prototype,"hasDraped",void 0);return a=c.__decorate([d.subclass("esri.views.3d.layers.GraphicsLayerView3D")],a)}(l.LayerView3D(r))});