// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../../geometry ../../../../core/maybe ../../../../geometry/support/triangulationUtils ./elevationAlignmentUtils ../../support/projectionUtils ../../terrain/OverlayRenderer ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Util".split(" "),function(w,d,k,g,l,t,u,v,m,b){function n(a,e,c){for(var b=[],h=0;h<a.length;h++){var f=a[h],d=f.index,f=f.count;if(!(1>=f)){var g=3*d,q=g+3*f;b.push({index:d,count:f,position:e.subarray(g,q),mapPosition:c?c.subarray(g,q):void 0})}}return b}
function r(a,e,c){for(var b=[],h=function(a,d,h,f){if(1>=d)return"continue";var g=3*a,p=g+3*d;h=h.map(function(c){return c-a});b.push({index:a,count:d,holeIndices:h,pathLengths:f,position:e.subarray(g,p),mapPosition:c?c.subarray(g,p):void 0})},f=0;f<a.length;f++){var d=a[f];h(d.index,d.count,d.holeIndices,d.pathLengths)}return b}Object.defineProperty(d,"__esModule",{value:!0});d.geometryToRenderInfoDraped=d.geometryToRenderInfo=d.geometryAsPolygon=d.createWaterGeometryData=d.createColorGeometryData=
void 0;d.createColorGeometryData=function(a){var e={},c={};c[b.VertexAttrConstants.POSITION]={size:3,data:a.attributeData.position};e[b.VertexAttrConstants.POSITION]=a.indices;if(g.isSome(a.attributeData.color)){var d=new Uint32Array(a.indices.length);c[b.VertexAttrConstants.COLOR]={size:4,data:a.attributeData.color};e[b.VertexAttrConstants.COLOR]=d}g.isSome(a.attributeData.uvMapSpace)&&(c[b.VertexAttrConstants.UVMAPSPACE]={size:4,data:a.attributeData.uvMapSpace},e[b.VertexAttrConstants.UVMAPSPACE]=
a.indices);g.isSome(a.attributeData.bound1)&&(c[b.VertexAttrConstants.BOUND1]={size:3,data:a.attributeData.bound1},e[b.VertexAttrConstants.BOUND1]=a.indices);g.isSome(a.attributeData.bound2)&&(c[b.VertexAttrConstants.BOUND2]={size:3,data:a.attributeData.bound2},e[b.VertexAttrConstants.BOUND2]=a.indices);g.isSome(a.attributeData.bound3)&&(c[b.VertexAttrConstants.BOUND3]={size:3,data:a.attributeData.bound3},e[b.VertexAttrConstants.BOUND3]=a.indices);g.isSome(a.attributeData.mapPosition)&&(c.mapPos=
{size:3,data:a.attributeData.mapPosition},e.mapPos=a.indices);return new m.GeometryData(c,e)};d.createWaterGeometryData=function(a){var e={},c={};c[b.VertexAttrConstants.POSITION]={size:3,data:a.attributeData.position};e[b.VertexAttrConstants.POSITION]=a.indices;c[b.VertexAttrConstants.UV0]={size:2,data:a.attributeData.uv0};e[b.VertexAttrConstants.UV0]=a.indices;g.isSome(a.attributeData.mapPosition)&&(c.mapPos={size:3,data:a.attributeData.mapPosition},e.mapPos=a.indices);return new m.GeometryData(c,
e)};d.geometryAsPolygon=function(a){switch(a.type){case "extent":if(a instanceof k.Extent)return k.Polygon.fromExtent(a);break;case "polygon":return a}return null};d.geometryToRenderInfo=function(a,e,c,d){var b=l.pathsToTriangulationInfo(a.rings,a.hasZ,1),f=new Float64Array(b.position.length);a=t.applyPerVertexElevationAlignment(b.position,a.spatialReference,0,f,0,b.position,0,b.position.length/3,e,c,d);e=null!=a;return{position:b.position,mapPosition:f,polygons:r(b.polygons,b.position,f),outlines:n(b.outlines,
b.position,f),projectionSuccess:e,sampledElevation:a}};d.geometryToRenderInfoDraped=function(a,b){var c=l.pathsToTriangulationInfo(a.rings,!1,1);a=u.bufferToBuffer(c.position,a.spatialReference,0,c.position,b,0,c.position.length/3);for(b=2;b<c.position.length;b+=3)c.position[b]=v.DRAPED_Z;return{position:c.position,polygons:r(c.polygons,c.position),outlines:n(c.outlines,c.position),projectionSuccess:a}}});