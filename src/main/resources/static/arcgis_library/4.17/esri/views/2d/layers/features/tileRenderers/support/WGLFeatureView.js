// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../../../core/promiseUtils ../../../../engine/brushes ../../../../engine/FeatureContainer ../../../../engine/webgl/enums".split(" "),function(g,e,h,l,d,m,k){Object.defineProperty(e,"__esModule",{value:!0});e.WGLFeatureView=void 0;g=function(f){function c(a,b,c){a=f.call(this,a)||this;a._pointToCallbacks=new Map;a._layer=c;a._layerView=b;return a}h.__extends(c,f);c.prototype.renderChildren=function(a){this.hasAnimation&&a.painter.effects.integrate.draw(a,a.attributeView);
f.prototype.renderChildren.call(this,a)};c.prototype.hitTest=function(a,b){a=[a,b];b=l.createResolver();this._pointToCallbacks.set(a,b);this.requestRender();return b.promise};c.prototype.doRender=function(a){var b=this._layer,c=b.maxScale,d=a.state.scale;d<=(b.minScale||Infinity)&&d>=c&&f.prototype.doRender.call(this,a)};Object.defineProperty(c.prototype,"hasAnimation",{get:function(){return this.hasLabels},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"hasLabels",{get:function(){var a=
this._layer.featureReduction,a=a&&"cluster"===a.type&&a.labelsVisible&&a.labelingInfo&&a.labelingInfo.length;return this._layer.labelingInfo&&this._layer.labelingInfo.length&&this._layer.labelsVisible||!!a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"labelsVisible",{get:function(){return this._layer.labelsVisible},enumerable:!1,configurable:!0});c.prototype.prepareRenderPasses=function(a){var b=this,c=a.registerRenderPass({name:"label",brushes:[d.brushes.label],target:function(){return b.hasLabels?
b.children:null},drawPhase:k.WGLDrawPhase.LABEL|k.WGLDrawPhase.LABEL_ALPHA}),e=a.registerRenderPass({name:"geometry",brushes:[d.brushes.fill,d.brushes.line,d.brushes.marker,d.brushes.text],target:function(){return b.children},effects:[{apply:a.effects.highlight,enable:function(){return!!b._layerView.hasHighlight()}},{apply:a.effects.hittest,enable:function(){return!!b._pointToCallbacks.size},args:function(){return b._pointToCallbacks}}]});return h.__spreadArrays(f.prototype.prepareRenderPasses.call(this,
a),[e,c])};return c}(m.FeatureContainer);e.WGLFeatureView=g});