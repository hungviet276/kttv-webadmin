// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/util/View.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../lib/StencilUtils ./Pattern.glsl ../../../webgl/Program ../../../webgl/renderState @dojo/framework/shim/Promise".split(" "),function(l,e,d,m,n,k,p,f,b,q,g,r,t,h){Object.defineProperty(e,
"__esModule",{value:!0});e.PatternTechniqueConfiguration=e.PatternTechnique=void 0;f=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}d.__extends(a,b);a.prototype.initializeProgram=function(u){var b=a.shader.get(),c=this.configuration,b=b.build({output:c.output,attributeColor:c.vertexColors,slicePlaneEnabled:c.slicePlaneEnabled,sliceHighlightDisabled:c.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,style:c.style,patternSpacing:c.patternSpacing,lineWidth:c.lineWidth,
draped:c.draped});return new t(u.rctx,b.generateSource("vertex"),b.generateSource("fragment"),q.Default3D)};a.prototype.bindPass=function(a,b,c){k.View.bindProjectionMatrix(this.program,c.camera.projectionMatrix);this.program.setUniform4fv("matColor",b.color);this.configuration.draped?(this.program.setUniform1f("worldToScreenRatio",1/c.screenToWorldRatioGlobalWM),this.program.setUniform1f("texelSize",1/c.camera.pixelRatio)):(this.program.setUniform1f("worldToScreenPerDistanceRatio",1/c.camera.perScreenPixelRatio),
this.program.setUniform3fv("viewForward",c.camera.viewForward));4===this.configuration.output&&n.OutputHighlight.bindOutputHighlight(a,this.program,c)};a.prototype.bindDraw=function(a){k.View.bindView(this.program,a);k.View.bindCamPosition(this.program,a.origin,a.camera.viewInverseTransposeMatrix);m.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};a.prototype.initializePipeline=function(){var a=function(a){return 0!==a&&{face:1===a?1028:1029,mode:2305}},b=this.configuration,c=h.separateBlendingParams(770,
1,771,771),d=0===b.output?b.transparent&&c:null,c=function(c){return h.makePipelineState({blending:d,polygonOffset:b.polygonOffset&&v,culling:a(b.cullFace),depthTest:g.depthCompareLess,depthWrite:b.writeDepth&&h.defaultDepthWriteParams,colorWrite:h.defaultColorWriteParams,stencilWrite:b.sceneHasOcludees?g.stencilWriteMaskOn:null,stencilTest:b.sceneHasOcludees?c?g.stencilToolMaskBaseParams:g.stencilBaseAllZerosParams:null})};this._occludeeState=c(!0);return c(!1)};Object.defineProperty(a.prototype,
"opaqueOccludeeState",{get:function(){return this._occludeeState},enumerable:!1,configurable:!0});a.shader=new p.ReloadableShaderModule(r,function(){return new Promise(function(a,b){l(["./Pattern.glsl"],a,b)})});return a}(f.ShaderTechnique);e.PatternTechnique=f;var v={factor:1,units:1};f=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;a.output=0;a.cullFace=0;a.slicePlaneEnabled=!1;a.sliceHighlightDisabled=!1;a.vertexColors=!1;a.transparent=!0;a.polygonOffset=!1;a.writeDepth=
!0;a.sceneHasOcludees=!1;return a}d.__extends(a,e);d.__decorate([b.parameter({count:7})],a.prototype,"output",void 0);d.__decorate([b.parameter({count:3})],a.prototype,"cullFace",void 0);d.__decorate([b.parameter()],a.prototype,"slicePlaneEnabled",void 0);d.__decorate([b.parameter()],a.prototype,"sliceHighlightDisabled",void 0);d.__decorate([b.parameter()],a.prototype,"vertexColors",void 0);d.__decorate([b.parameter()],a.prototype,"transparent",void 0);d.__decorate([b.parameter()],a.prototype,"polygonOffset",
void 0);d.__decorate([b.parameter()],a.prototype,"writeDepth",void 0);d.__decorate([b.parameter()],a.prototype,"sceneHasOcludees",void 0);d.__decorate([b.parameter({count:6})],a.prototype,"style",void 0);d.__decorate([b.parameter()],a.prototype,"patternSpacing",void 0);d.__decorate([b.parameter()],a.prototype,"lineWidth",void 0);d.__decorate([b.parameter()],a.prototype,"draped",void 0);return a}(b.ShaderTechniqueConfiguration);e.PatternTechniqueConfiguration=f});