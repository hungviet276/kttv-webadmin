// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../Graphic ../../../core/promiseUtils ../../../geometry/SpatialReference ../../../layers/support/Field ./WorkerHandle".split(" "),function(f,e,d,h,k,g,l,m){Object.defineProperty(e,"__esModule",{value:!0});e.PBFDecoder=void 0;f=function(){function b(a){this._handle=new n(a)}b.prototype.destroy=function(){this._handle.destroy()};b.prototype.invoke=function(a,c){void 0===c&&(c=null);if(!a.buffer||0===a.buffer.byteLength)return k.resolve(null);a.options.sourceSpatialReference&&
a.options.sourceSpatialReference instanceof g&&(a.options=d.__assign(d.__assign({},a.options),{sourceSpatialReference:a.options.sourceSpatialReference.toJSON()}));return this._handle.invoke(a,c).then(function(a){a.spatialReference=g.fromJSON(a.spatialReference);if(a.fields)for(var c=0;c<a.fields.length;c++)a.fields[c]=l.fromJSON(a.fields[c]);for(var c=a.spatialReference,b=0,e=a.features;b<e.length;b++){var d=e[b];d.uid=h.generateUID();d.geometry&&(d.geometry.spatialReference=c)}return a})};return b}();
e.PBFDecoder=f;var n=function(b){function a(a){return b.call(this,"PBFDecoderWorker","_parseFeatureQuery",a,{strategy:"dedicated"})||this}d.__extends(a,b);a.prototype.getTransferList=function(a){return[a.buffer]};return a}(m.WorkerHandle)});