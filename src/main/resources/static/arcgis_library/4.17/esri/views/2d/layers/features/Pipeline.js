// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/core/HandleOwner":function(){define("require exports tslib ./Accessor ./Handles ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ../views/support/WatchUpdatingTracking".split(" "),function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.HandleOwner=a.HandleOwnerMixin=void 0;a.HandleOwnerMixin=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.prototype.destroy=function(){this.destroyed||
(this.handles.destroy(),this.updatingHandles.destroy())};Object.defineProperty(c.prototype,"handles",{get:function(){return this._get("handles")||new k},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"updatingHandles",{get:function(){return this._get("updatingHandles")||new d.WatchUpdatingTracking},enumerable:!1,configurable:!0});b.__decorate([h.property({readOnly:!0})],c.prototype,"handles",null);b.__decorate([h.property({readOnly:!0})],c.prototype,"updatingHandles",null);return c=
b.__decorate([g.subclass("esri.core.HandleOwner")],c)}(a)};m=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);return c=b.__decorate([g.subclass("esri.core.HandleOwner")],c)}(a.HandleOwnerMixin(l));a.HandleOwner=m})},"esri/core/Handles":function(){define("require exports tslib ./Accessor ./Collection ./maybe ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(m,a,b,l,k,h,g,d){return function(a){function c(c){c=a.call(this,
c)||this;c._groups=new Map;return c}b.__extends(c,a);c.prototype.destroy=function(){this.removeAll()};Object.defineProperty(c.prototype,"size",{get:function(){var a=0;this._groups.forEach(function(c){a+=c.length});return a},enumerable:!1,configurable:!0});c.prototype.add=function(a,c){var e=this;if(!this._isHandle(a)&&!Array.isArray(a)&&!k.isCollection(a))return this;var b=this._getOrCreateGroup(c);Array.isArray(a)||k.isCollection(a)?a.forEach(function(a){return e._isHandle(a)&&b.push(a)}):b.push(a);
this.notifyChange("size");return this};c.prototype.forEach=function(a,c){if("function"===typeof a)this._groups.forEach(function(c){return c.forEach(a)});else{var e=this._getGroup(a);e&&c&&e.forEach(c)}};c.prototype.has=function(a){return this._groups.has(this._ensureGroupKey(a))};c.prototype.remove=function(a){if(Array.isArray(a)||k.isCollection(a))return a.forEach(this.remove,this),this;if(!this.has(a))return this;for(var c=this._getGroup(a),e=0;e<c.length;e++)c[e].remove();this._deleteGroup(a);
this.notifyChange("size");return this};c.prototype.removeAll=function(){this._groups.forEach(function(a){for(var c=0;c<a.length;c++)a[c].remove()});this._groups.clear();this.notifyChange("size");return this};c.prototype._isHandle=function(a){return a&&!!a.remove};c.prototype._getOrCreateGroup=function(a){if(this.has(a))return this._getGroup(a);var c=[];this._groups.set(this._ensureGroupKey(a),c);return c};c.prototype._getGroup=function(a){return h.assumeNonNull(this._groups.get(this._ensureGroupKey(a)))};
c.prototype._deleteGroup=function(a){return this._groups.delete(this._ensureGroupKey(a))};c.prototype._ensureGroupKey=function(a){return a||"_default_"};b.__decorate([g.property({readOnly:!0})],c.prototype,"size",null);return c=b.__decorate([d.subclass("esri.core.Handles")],c)}(l)})},"esri/core/Collection":function(){define("require exports tslib ./ArrayPool ./arrayUtils ./Evented ./lang ./maybe ./ObjectPool ./scheduling ./accessorSupport/ensureType ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){function x(a){return a?a instanceof E?a.toArray():a.length?Array.prototype.slice.apply(a):[]:[]}function p(a){if(a&&a.length)return a[0]}function q(a,c,e,b){c&&c.forEach(function(c,d,g){a.push(c);q(a,e.call(b,c,d,g),e,b)})}m=function(){function a(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}a.prototype.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};a.prototype.reset=function(a){this.defaultPrevented=
!1;this.item=a};return a}();var u=new f(m,void 0,function(a){a.item=null;a.target=null;a.defaultPrevented=!1;a.cancellable=!1}),y=function(){},w=new Set,B=new Set,z=new Set,A=new Map,C=0,E=function(a){function f(c){c=a.call(this,c)||this;c._chgListeners=[];c._notifications=null;c._timer=null;c.length=0;c._items=[];Object.defineProperty(c,"uid",{value:C++});return c}b.__extends(f,a);h=f;f.isCollection=function(a){return null!=a&&a instanceof h};f.prototype.normalizeCtorArgs=function(a){return a?Array.isArray(a)||
a instanceof h?{items:a}:a:{}};Object.defineProperty(f.prototype,"items",{get:function(){return this._items},set:function(a){this._emitBeforeChanges(1)||(this._splice.apply(this,b.__spreadArrays([0,this.length],x(a))),this._emitAfterChanges(1))},enumerable:!1,configurable:!0});f.prototype.hasEventListener=function(a){return"change"===a?0<this._chgListeners.length:this._emitter.hasEventListener(a)};f.prototype.on=function(a,c){if("change"===a){var e=this._chgListeners,b={removed:!1,callback:c};e.push(b);
this._notifications&&this._notifications.push({listeners:e.slice(),items:this._items.slice(),changes:[]});return{remove:function(){this.remove=y;b.removed=!0;e.splice(e.indexOf(b),1)}}}return this._emitter.on(a,c)};f.prototype.once=function(a,c){var e=this.on(a,c);return{remove:function(){e.remove()}}};f.prototype.add=function(a,c){if(this._emitBeforeChanges(1))return this;c=this.getNextIndex(null!==c&&void 0!==c?c:null);this._splice(c,0,a);this._emitAfterChanges(1);return this};f.prototype.addMany=
function(a,c){void 0===c&&(c=this._items.length);if(!a||!a.length||this._emitBeforeChanges(1))return this;c=this.getNextIndex(c);this._splice.apply(this,b.__spreadArrays([c,0],x(a)));this._emitAfterChanges(1);return this};f.prototype.removeAll=function(){if(!this.length||this._emitBeforeChanges(2))return[];var a=this._splice(0,this.length)||[];this._emitAfterChanges(2);return a};f.prototype.clone=function(){return this._createNewInstance({items:this._items.map(g.clone)})};f.prototype.concat=function(){for(var a,
c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];c=c.map(x);return this._createNewInstance({items:(a=this._items).concat.apply(a,c)})};f.prototype.drain=function(a,c){if(this.length&&!this._emitBeforeChanges(2)){for(var e=d.assumeNonNull(this._splice(0,this.length)),b=e.length,f=0;f<b;f++)a.call(c,e[f],f,e);this._emitAfterChanges(2)}};f.prototype.every=function(a,c){return this._items.every(a,c)};f.prototype.filter=function(a,c){var e;e=2===arguments.length?this._items.filter(a,c):this._items.filter(a);
return this._createNewInstance({items:e})};f.prototype.find=function(a,c){return k.find(this._items,a,c)};f.prototype.findIndex=function(a,c){return k.findIndex(this._items,a,c)};f.prototype.flatten=function(a,c){var e=[];q(e,this,a,c);return new h(e)};f.prototype.forEach=function(a,c){return this._items.forEach(a,c)};f.prototype.getItemAt=function(a){return this._items[a]};f.prototype.getNextIndex=function(a){var c=this.length;a=null==a?c:a;0>a?a=0:a>c&&(a=c);return a};f.prototype.includes=function(a,
c){void 0===c&&(c=0);return arguments.length?-1!==this._items.indexOf(a,c):!1};f.prototype.indexOf=function(a,c){void 0===c&&(c=0);return this._items.indexOf(a,c)};f.prototype.join=function(a){void 0===a&&(a=",");return this._items.join(a)};f.prototype.lastIndexOf=function(a,c){void 0===c&&(c=this.length-1);return this._items.lastIndexOf(a,c)};f.prototype.map=function(a,c){a=this._items.map(a,c);return new h({items:a})};f.prototype.reorder=function(a,c){void 0===c&&(c=this.length-1);var e=this.indexOf(a);
if(-1!==e){0>c?c=0:c>=this.length&&(c=this.length-1);if(e!==c){if(this._emitBeforeChanges(4))return a;this._splice(e,1);this._splice(c,0,a);this._emitAfterChanges(4)}return a}};f.prototype.pop=function(){if(this.length&&!this._emitBeforeChanges(2)){var a=p(this._splice(this.length-1,1));this._emitAfterChanges(2);return a}};f.prototype.push=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(this._emitBeforeChanges(1))return this.length;this._splice.apply(this,b.__spreadArrays([this.length,
0],a));this._emitAfterChanges(1);return this.length};f.prototype.reduce=function(a,c){var e=this._items;return 2===arguments.length?e.reduce(a,c):e.reduce(a)};f.prototype.reduceRight=function(a,c){var e=this._items;return 2===arguments.length?e.reduceRight(a,c):e.reduceRight(a)};f.prototype.remove=function(a){return this.removeAt(this.indexOf(a))};f.prototype.removeAt=function(a){if(!(0>a||a>=this.length||this._emitBeforeChanges(2)))return a=p(this._splice(a,1)),this._emitAfterChanges(2),a};f.prototype.removeMany=
function(a){if(!a||!a.length||this._emitBeforeChanges(2))return[];a=a instanceof h?a.toArray():a;for(var c=this._items,e=[],b=a.length,d=0;d<b;d++){var f=c.indexOf(a[d]);if(-1<f){for(var g=d+1,n=f+1,t=Math.min(a.length-g,c.length-n),p=0;p<t&&a[g+p]===c[n+p];)p++;g=1+p;(f=this._splice(f,g))&&0<f.length&&e.push.apply(e,f);d+=g-1}}this._emitAfterChanges(2);return e};f.prototype.reverse=function(){if(this._emitBeforeChanges(4))return this;var a=this._splice(0,this.length);a&&(a.reverse(),this._splice.apply(this,
b.__spreadArrays([0,0],a)));this._emitAfterChanges(4);return this};f.prototype.shift=function(){if(this.length&&!this._emitBeforeChanges(2)){var a=p(this._splice(0,1));this._emitAfterChanges(2);return a}};f.prototype.slice=function(a,c){void 0===a&&(a=0);void 0===c&&(c=this.length);return this._createNewInstance({items:this._items.slice(a,c)})};f.prototype.some=function(a,c){return this._items.some(a,c)};f.prototype.sort=function(a){if(!this.length||this._emitBeforeChanges(4))return this;var c=d.assumeNonNull(this._splice(0,
this.length));arguments.length?c.sort(a):c.sort();this._splice.apply(this,b.__spreadArrays([0,0],c));this._emitAfterChanges(4);return this};f.prototype.splice=function(a,c){for(var e=[],d=2;d<arguments.length;d++)e[d-2]=arguments[d];d=(c?2:0)|(e.length?1:0);if(this._emitBeforeChanges(d))return[];e=this._splice.apply(this,b.__spreadArrays([a,c],e))||[];this._emitAfterChanges(d);return e};f.prototype.toArray=function(){return this._items.slice()};f.prototype.toJSON=function(){return this.toArray()};
f.prototype.toLocaleString=function(){return this._items.toLocaleString()};f.prototype.toString=function(){return this._items.toString()};f.prototype.unshift=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(!a.length||this._emitBeforeChanges(1))return this.length;this._splice.apply(this,b.__spreadArrays([0,0],a));this._emitAfterChanges(1);return this.length};f.prototype._createNewInstance=function(a){return new this.constructor(a)};f.prototype._splice=function(a,e){for(var d=
this,f=[],g=2;g<arguments.length;g++)f[g-2]=arguments[g];var g=this._items,n=this.constructor.prototype.itemType,p,t=void 0;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=c.schedule(function(){return d._dispatchChange()}));if(e){t=g.splice(a,e);if(this.hasEventListener("before-remove")){var h=u.acquire();h.target=this;h.cancellable=!0;for(var q=0,
w=t.length;q<w;q++)p=t[q],h.reset(p),this.emit("before-remove",h),h.defaultPrevented&&(t.splice(q,1),g.splice(a,0,p),a+=1,--q,--w);u.release(h)}this.length=this._items.length;if(this.hasEventListener("after-remove")){p=u.acquire();p.target=this;p.cancellable=!1;w=t.length;for(q=0;q<w;q++)p.reset(t[q]),this.emit("after-remove",p);u.release(p)}}if(f&&f.length){if(n){q=[];for(w=0;w<f.length;w++)p=f[w],h=n.ensureType(p),null==h&&null!=p||q.push(h);f=q}n=this.hasEventListener("before-add");q=this.hasEventListener("after-add");
w=a===this.length;if(n||q){p=u.acquire();p.target=this;p.cancellable=!0;h=u.acquire();h.target=this;h.cancellable=!1;for(var y=0,x=f;y<x.length;y++){var k=x[y];n?(p.reset(k),this.emit("before-add",p),p.defaultPrevented||(w?g.push(k):g.splice(a++,0,k),this._set("length",g.length),q&&(h.reset(k),this.emit("after-add",h)))):(w?g.push(k):g.splice(a++,0,k),this._set("length",g.length),h.reset(k),this.emit("after-add",h))}u.release(h);u.release(p)}else{if(w)for(n=0,q=f;n<q.length;n++)g.push(q[n]);else g.splice.apply(g,
b.__spreadArrays([a,0],f));this._set("length",g.length)}}(f&&f.length||t&&t.length)&&this._notifyChangeEvent(f,t);return t};f.prototype._emitBeforeChanges=function(a){var c=!1;if(this.hasEventListener("before-changes")){var e=u.acquire();e.target=this;e.cancellable=!0;e.type=a;this.emit("before-changes",e);c=e.defaultPrevented;u.release(e)}return c};f.prototype._emitAfterChanges=function(a){if(this.hasEventListener("after-changes")){var c=u.acquire();c.target=this;c.cancellable=!1;c.type=a;this.emit("after-changes",
c);u.release(c)}};f.prototype._notifyChangeEvent=function(a,c){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:a,removed:c})};f.prototype._dispatchChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var a=this._notifications;this._notifications=null;for(var c=function(a){var c=a.changes;w.clear();B.clear();z.clear();for(var b=0;b<c.length;b++){var d=c[b],f=d.added,d=d.removed;if(f)if(0===
z.size&&0===B.size)for(var g=0,n=f;g<n.length;g++)f=n[g],w.add(f);else for(g=0,n=f;g<n.length;g++)f=n[g],B.has(f)?(z.add(f),B.delete(f)):z.has(f)||w.add(f);if(d)if(0===z.size&&0===w.size)for(g=0;g<d.length;g++)f=d[g],B.add(f);else for(g=0;g<d.length;g++)f=d[g],w.has(f)?w.delete(f):(z.delete(f),B.add(f))}var p=l.acquire();w.forEach(function(a){p.push(a)});var t=l.acquire();B.forEach(function(a){t.push(a)});var h=e._items,q=a.items,y=l.acquire();z.forEach(function(a){q.indexOf(a)!==h.indexOf(a)&&y.push(a)});
if(a.listeners&&(p.length||t.length||y.length))for(c={target:e,added:p,removed:t,moved:y},b=a.listeners.length,f=0;f<b;f++)d=a.listeners[f],d.removed||d.callback.call(e,c);l.release(p);l.release(t);l.release(y)},e=this,b=0;b<a.length;b++)c(a[b]);w.clear();B.clear();z.clear()}};var h;f.ofType=function(a){if(!a)return h;if(A.has(a))return A.get(a);var c=null;if("function"===typeof a)c=a.prototype.declaredClass;else if(a.base)c=a.base.prototype.declaredClass;else for(var d in a.typeMap)var f=a.typeMap[d].prototype.declaredClass,
c=c?c+(" | "+f):f;d=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}b.__extends(e,a);return e=b.__decorate([t.subclass("esri.core.Collection\x3c"+c+"\x3e")],e)}(h);f={Type:a,ensureType:"function"===typeof a?e.ensureType(a):e.ensureOneOfType(a)};Object.defineProperty(d.prototype,"itemType",{value:f});A.set(a,d);return d};b.__decorate([n.property()],f.prototype,"length",void 0);b.__decorate([n.property()],f.prototype,"items",null);return f=h=b.__decorate([t.subclass("esri.core.Collection")],
f)}(h.EventedAccessor);return E})},"esri/core/Evented":function(){define("require exports tslib ./Accessor ./handleUtils ./accessorSupport/decorators/subclass".split(" "),function(m,a,b,l,k,h){var g=function(){function a(){this._emitter=new a.EventEmitter(this)}a.prototype.emit=function(a,c){return this._emitter.emit(a,c)};a.prototype.on=function(a,c){return this._emitter.on(a,c)};a.prototype.once=function(a,c){return this._emitter.once(a,c)};a.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};
return a}();(function(a){var d=function(){function a(a){void 0===a&&(a=null);this.target=a;this._listenersMap=null}a.prototype.clear=function(){this._listenersMap&&this._listenersMap.clear()};a.prototype.emit=function(a,c){a=this._listenersMap&&this._listenersMap.get(a);if(!a)return!1;var e=this.target||this;b.__spreadArrays(a).forEach(function(a){a.call(e,c)});return 0<a.length};a.prototype.on=function(a,c){var e=this;if(Array.isArray(a)){var b=a.map(function(a){return e.on(a,c)});return k.handlesGroup(b)}if(-1<
a.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);b=this._listenersMap.get(a)||[];b.push(c);this._listenersMap.set(a,b);return{remove:function(){var b=e._listenersMap&&e._listenersMap.get(a)||[],d=b.indexOf(c);0<=d&&b.splice(d,1)}}};a.prototype.once=function(a,c){var e;return e=this.on(a,function(a){e.remove();c.call(null,a)})};a.prototype.hasEventListener=function(a){a=this._listenersMap&&
this._listenersMap.get(a);return null!=a&&0<a.length};return a}();a.EventEmitter=d;a.EventedMixin=function(a){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._emitter=new d;return c}b.__extends(c,a);c.prototype.emit=function(a,c){return this._emitter.emit(a,c)};c.prototype.on=function(a,c){return this._emitter.on(a,c)};c.prototype.once=function(a,c){return this._emitter.once(a,c)};c.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};return c=
b.__decorate([h.subclass("esri.core.Evented")],c)}(a)};var c=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._emitter=new g.EventEmitter(c);return c}b.__extends(c,a);c.prototype.emit=function(a,c){return this._emitter.emit(a,c)};c.prototype.on=function(a,c){return this._emitter.on(a,c)};c.prototype.once=function(a,c){return this._emitter.once(a,c)};c.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};return c=b.__decorate([h.subclass("esri.core.Evented")],
c)}(l);a.EventedAccessor=c})(g||(g={}));return g})},"esri/views/support/WatchUpdatingTracking":function(){define("require exports tslib ../../core/Accessor ../../core/Handles ../../core/scheduling ../../core/watchUtils ../../core/accessorSupport/wire ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass".split(" "),function(m,a,b,l,k,h,g,d,f,c){Object.defineProperty(a,"__esModule",{value:!0});a.WatchUpdatingTracking=void 0;m=function(a){function n(){var c=null!==
a&&a.apply(this,arguments)||this;c.updating=!1;c.handleId=0;c.handles=new k;c.scheduleHandleId=0;c.pendingPromises=new Set;return c}b.__extends(n,a);n.prototype.destroy=function(){this.removeAll();this.handles.destroy()};n.prototype.add=function(a,c,e,b){var d=this;void 0===b&&(b=0);var f=0!==(b&1),n=++this.handleId;f||this.installSyncUpdatingWatch(a,c,n);a=0!==(b&2)?g.init(a,c,e,f):a.watch(c,e,f);this.handles.add(a,n);return{remove:function(){d.handles.remove(n)}}};n.prototype.addOnCollectionPropertyChange=
function(a,c,e,b){var d=this;void 0===b&&(b=0);b=0!==(b&2);var f=++this.handleId;this.handles.add([g.on(a,c,"after-changes",this.createSyncUpdatingCallback()),g.on(a,c,"change",e,b?function(a){e({added:a.items,removed:[],moved:[],target:a})}:void 0)],f);return{remove:function(){d.handles.remove(f)}}};n.prototype.addOnCollectionChange=function(a,c,e){var b=this;void 0===e&&(e=0);e=0!==(e&2);var d=++this.handleId;this.handles.add([a.on("after-changes",this.createSyncUpdatingCallback()),a.on("change",
c)],d);e&&c({added:a.items,removed:[],moved:[],target:a});return{remove:function(){b.handles.remove(d)}}};n.prototype.addPromise=function(a){var c=this;if(!a)return a;var b=++this.handleId;this.handles.add({remove:function(){c.pendingPromises.delete(a)&&(0!==c.pendingPromises.size||c.handles.has(e)||c._set("updating",!1))}},b);this.pendingPromises.add(a);this._set("updating",!0);var d=function(){return c.handles.remove(b)};a.then(d,d);return a};n.prototype.removeAll=function(){this.pendingPromises.clear();
this.handles.removeAll();this._set("updating",!1)};n.prototype.installSyncUpdatingWatch=function(a,c,e){a=d.default(a,c,this.createSyncUpdatingCallback());this.handles.add(a,e);return a};n.prototype.createSyncUpdatingCallback=function(){var a=this;return function(){a.handles.remove(e);++a.scheduleHandleId;var c=a.scheduleHandleId;a._get("updating")||a._set("updating",!0);a.handles.add(h.schedule(function(){c===a.scheduleHandleId&&(a._set("updating",0<a.pendingPromises.size),a.handles.remove(e))}),
e)}};b.__decorate([f.property({readOnly:!0})],n.prototype,"updating",void 0);return n=b.__decorate([c.subclass("esri.views.support.WatchUpdatingTracking")],n)}(l);a.WatchUpdatingTracking=m;var e=-42})},"esri/layers/support/TileInfo":function(){define("require exports tslib ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){var x=new k.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(a){function p(c){c=a.call(this,c)||this;c.dpi=96;c.format=null;c.origin=null;c.minScale=0;c.maxScale=0;c.size=null;c.spatialReference=null;return c}b.__extends(p,a);h=p;p.create=function(a){void 0===
a&&(a={size:256,spatialReference:l.SpatialReference.WebMercator});var c=a.resolutionFactor||1,b=a.scales,d=a.size||256,f=a.spatialReference||l.SpatialReference.WebMercator;if(!e.isValid(f)){c=[];if(b)for(a=0;a<b.length;a++){var n=b[a];c.push({level:a,scale:n,resolution:n})}else{var p=5E-4;for(a=23;0<=a;a--)c.unshift({level:a,scale:p,resolution:p}),p*=2}return new h({dpi:96,lods:c,origin:new l.Point(0,0,f),size:[d,d],spatialReference:f})}var n=e.getInfo(f),t=a.origin?new l.Point({x:a.origin.x,y:a.origin.y,
spatialReference:f}):n?new l.Point({x:n.origin[0],y:n.origin[1],spatialReference:f}):new l.Point({x:0,y:0,spatialReference:f}),q=1/(39.37*g.getMetersPerUnitForSR(f)*96),y=[];if(b)for(a=0;a<b.length;a++)n=b[a],p=n*q,y.push({level:a,scale:n,resolution:p});else for(n=e.isGeographic(f)?512/d*5.916575275917094E8:256/d*5.91657527591555E8,b=Math.ceil(24/c),y.push({level:0,scale:n,resolution:n*q}),a=1;a<b;a++)n/=Math.pow(2,c),p=n*q,y.push({level:a,scale:n,resolution:p});return new h({dpi:96,lods:y,origin:t,
size:[d,d],spatialReference:f})};Object.defineProperty(p.prototype,"isWrappable",{get:function(){var a=this.spatialReference,c=this.origin;if(a&&c){var b=e.getInfo(a);return a.isWrappable&&Math.abs(b.origin[0]-c.x)<=b.dx}return!1},enumerable:!1,configurable:!0});p.prototype.readOrigin=function(a,c){return l.Point.fromJSON(b.__assign({spatialReference:c.spatialReference},a))};Object.defineProperty(p.prototype,"lods",{set:function(a){var c=this,e=0,b=0,d=[];this._levelToLOD={};a&&(e=-Infinity,b=Infinity,
a.forEach(function(a){d.push(a.scale);e=a.scale>e?a.scale:e;b=a.scale<b?a.scale:b;c._levelToLOD[a.level]=a}));this._set("scales",d);this._set("minScale",e);this._set("maxScale",b);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!1,configurable:!0});p.prototype.readSize=function(a,c){return[c.cols,c.rows]};p.prototype.writeSize=function(a,c){c.cols=a[0];c.rows=a[0]};p.prototype.zoomToScale=function(a){var c=this.scales;if(0>=a)return c[0];if(a>=c.length)return c[c.length-1];var e=
Math.round(a);return c[e]+(e-a)*(c[Math.round(a-.5)]-c[e])};p.prototype.scaleToZoom=function(a){for(var c=this.scales,e=c.length-1,b=0;b<e;b++){var d=c[b],f=c[b+1];if(d<=a)break;if(f===a)return b+1;if(d>a&&f<a)return b+1-(a-f)/(d-f)}return b};p.prototype.snapScale=function(a,c){void 0===c&&(c=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=c?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))};p.prototype.tileAt=function(a,b,d,f){var g=this.lodAt(a);if(!g)return null;var p;if("number"===
typeof b)p=b,b=d;else{if(e.equals(b.spatialReference,this.spatialReference))p=b.x,b=b.y;else{f=n.project(b,this.spatialReference);if(!f)return null;p=f.x;b=f.y}f=d}d=g.resolution*this.size[0];g=g.resolution*this.size[1];f||(f={id:null,level:0,row:0,col:0,extent:c.create()});f.level=a;f.row=Math.floor((this.origin.y-b)/g+.001);f.col=Math.floor((p-this.origin.x)/d+.001);this.updateTileInfo(f);return f};p.prototype.updateTileInfo=function(a){var e=this.lodAt(a.level);if(e){var b=e.resolution*this.size[0],
e=e.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=c.create());a.extent[0]=this.origin.x+a.col*b;a.extent[1]=this.origin.y-(a.row+1)*e;a.extent[2]=a.extent[0]+b;a.extent[3]=a.extent[1]+e}};p.prototype.upsampleTile=function(a){var c=this._upsampleLevels[a.level];if(!c||-1===c.parentLevel)return!1;a.level=c.parentLevel;a.row=Math.floor(a.row/c.factor+.001);a.col=Math.floor(a.col/c.factor+.001);this.updateTileInfo(a);return!0};p.prototype.getTileBounds=function(a,c){var e=
this.lodAt(c.level).resolution,b=e*this.size[0],e=e*this.size[1];a[0]=this.origin.x+c.col*b;a[1]=this.origin.y-(c.row+1)*e;a[2]=a[0]+b;a[3]=a[1]+e;return a};p.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null};p.prototype.clone=function(){return h.fromJSON(this.write({}))};p.prototype._initializeUpsampleLevels=function(){var a=this.lods;this._upsampleLevels=[];for(var c=null,e=0;e<a.length;e++){var b=a[e];this._upsampleLevels[b.level]={parentLevel:c?c.level:-1,factor:c?
c.resolution/b.resolution:0};c=b}};var h;b.__decorate([d.property({type:Number,json:{write:!0}})],p.prototype,"compressionQuality",void 0);b.__decorate([d.property({type:Number,json:{write:!0}})],p.prototype,"dpi",void 0);b.__decorate([d.property({type:String,json:{read:x.read,write:x.write,origins:{"web-scene":{read:!1,write:!1}}}})],p.prototype,"format",void 0);b.__decorate([d.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],p.prototype,"isWrappable",null);b.__decorate([d.property({type:l.Point,
json:{write:!0}})],p.prototype,"origin",void 0);b.__decorate([d.reader("origin")],p.prototype,"readOrigin",null);b.__decorate([d.property({type:[t],value:null,json:{write:!0}})],p.prototype,"lods",null);b.__decorate([d.property({readOnly:!0})],p.prototype,"minScale",void 0);b.__decorate([d.property({readOnly:!0})],p.prototype,"maxScale",void 0);b.__decorate([d.property({readOnly:!0})],p.prototype,"scales",void 0);b.__decorate([d.property({cast:function(a){return Array.isArray(a)?a:"number"===typeof a?
[a,a]:[256,256]}})],p.prototype,"size",void 0);b.__decorate([d.reader("size",["rows","cols"])],p.prototype,"readSize",null);b.__decorate([d.writer("size",{cols:{type:f.Integer},rows:{type:f.Integer}})],p.prototype,"writeSize",null);b.__decorate([d.property({type:l.SpatialReference,json:{write:!0}})],p.prototype,"spatialReference",void 0);return p=h=b.__decorate([d.subclass("esri.layers.support.TileInfo")],p)}(h.JSONSupport)})},"esri/core/unitUtils":function(){define("require exports ./compilerUtils ./jsonMap ./SetUtils ../geometry/support/geodesicConstants ../geometry/support/WKIDUnitConversion".split(" "),
function(m,a,b,l,k,h,g){function d(a){if(a=H[a])return a;throw Error("unknown measure");}function f(a){return F[a].baseUnit}function c(a,c){void 0===c&&(c=null);c=c||d(a);return F[c].baseUnit===a}function e(a,e,b){if(e===b)return a;var f=d(e);if(f!==d(b))throw Error("incompatible units");a=c(e,f)?a:a*F[f].units[e].inBaseUnits;return c(b,f)?a:a/F[f].units[b].inBaseUnits}function n(a,c){return 3E3>e(a,c,"meters")?"meters":"kilometers"}function t(a,c){return 1E5>e(a,c,"meters")?"meters":"kilometers"}
function x(a,c){return 1E3>e(a,c,"feet")?"feet":"miles"}function p(a,c){return 1E5>e(a,c,"feet")?"feet":"miles"}function q(a){return D.fromJSON(a.toLowerCase())||null}function u(a,c){void 0===c&&(c=B);return y(a,!0)||c}function y(a,c){void 0===c&&(c=!1);var e,b,d;null!=a&&("object"===typeof a?(e=a.wkid,b=a.wkt):"number"===typeof a?e=a:"string"===typeof a&&(b=a));e?(d=C.values[C[e]],!d&&c&&E.has(e)&&(d=z)):b&&-1!==b.search(/^PROJCS/i)&&(a=A.exec(b))&&a[1]&&(d=parseFloat(a[1].split(",")[1]));return d}
function w(a){var c,e,b;null!=a&&("object"===typeof a?(c=a.wkid,e=a.wkt):"number"===typeof a?c=a:"string"===typeof a&&(e=a));c?b=C.units[C[c]]:e&&-1!==e.search(/^PROJCS/i)&&(a=A.exec(e))&&a[1]&&(b=(a=/[\\"\\']{1}([^\\"\\']+)/.exec(a[1]))&&a[1]);return b?q(b):null}Object.defineProperty(a,"__esModule",{value:!0});a.getDefaultUnitSystem=a.getUnitString=a.getMetersPerUnit=a.getMetersPerUnitForSR=a.getVerticalUnitStringForSR=a.getMetersPerVerticalUnitForSR=a.unitToRESTJSON=a.unitFromRESTJSON=a.lengthToDegrees=
a.preferredImperialAreaUnit=a.preferredMetricAreaUnit=a.preferredImperialVerticalLengthUnit=a.preferredImperialLengthUnit=a.preferredMetricVerticalLengthUnit=a.preferredMetricLengthUnit=a.preferredVerticalLengthUnit=a.preferredLengthUnit=a.convertUnit=a.isBaseUnit=a.baseUnitForUnit=a.baseUnitForMeasure=a.measureForUnit=a.measurementLengthUnits=a.measurementAreaUnits=a.inchesPerMeter=void 0;a.inchesPerMeter=39.37;var B=h.metersPerDegree,z=h.earthRadius*Math.PI/200,A=/UNIT\[([^\]]+)\]\]$/i,C=g,E=k.SetFromValues([4261,
4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),D=l.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers",
"150_kilometers":"150-kilometers"});m={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};l={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},
"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:function(a){return a*a}(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};var F={length:{baseUnit:"meters",units:m},area:{baseUnit:"square-meters",units:l},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*
1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},H=function(){var a={},c;for(c in F)for(var e in F[c].units)a[e]=c;return a}();a.measurementAreaUnits=
"metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");a.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");a.measureForUnit=d;a.baseUnitForMeasure=f;a.baseUnitForUnit=function(a){return f(d(a))};a.isBaseUnit=c;a.convertUnit=e;a.preferredLengthUnit=function(a,c,e){switch(e){case "metric":return n(a,c);case "imperial":return x(a,c);default:return e}};
a.preferredVerticalLengthUnit=function(a,c,e){switch(e){case "metric":return t(a,c);case "imperial":return p(a,c);default:return e}};a.preferredMetricLengthUnit=n;a.preferredMetricVerticalLengthUnit=t;a.preferredImperialLengthUnit=x;a.preferredImperialVerticalLengthUnit=p;a.preferredMetricAreaUnit=function(a,c){return 3E6>e(a,c,"square-meters")?"square-meters":"square-kilometers"};a.preferredImperialAreaUnit=function(a,c){return 1E6>e(a,c,"square-feet")?"square-feet":"square-miles"};a.lengthToDegrees=
function(a,c,b){void 0===b&&(b=h.earthRadius);return e(a,c,"meters")/(b*Math.PI/180)};a.unitFromRESTJSON=q;a.unitToRESTJSON=function(a){return D.toJSON(a)||null};a.getMetersPerVerticalUnitForSR=function(a){a=u(a);return 1E5<a?1:a};a.getVerticalUnitStringForSR=function(a){return 1E5<u(a)?"meters":w(a)};a.getMetersPerUnitForSR=u;a.getMetersPerUnit=y;a.getUnitString=w;a.getDefaultUnitSystem=function(a){if(!a)return null;a=w(a);switch(a){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric";case null:case void 0:break;default:b.neverReached(a)}return null}})},"esri/core/SetUtils":function(){define(["require","exports","./maybe"],function(m,a,b){function l(a){if(0===a.size)throw Error("Set is empty");return a.values().next().value}function k(a){if(0===a.size)throw Error("Set is empty");var d=void 0,f=!1;a.forEach(function(a){f||(d=a,f=!0)});return b.assumeNonNull(d)}Object.defineProperty(a,"__esModule",{value:!0});
a.reduceSet=a.firstOfSet=a.SetFromValues=a.valuesOfSet=a.someSet=void 0;a.someSet=Set.prototype.entries?function(a,b){a=a.entries();for(var d=a.next();!d.done;d=a.next())if(b(d.value[0]))return!0;return!1}:function(a,b){var d=!0;a.forEach(function(a){d&&(d=!b(a))});return!d};m=!!Set.prototype.values;var h=!!Array.from;a.valuesOfSet=m&&h?function(a){return Array.from(a.values())}:function(a){var b=Array(a.size),f=0;a.forEach(function(a){return b[f++]=a});return b};a.SetFromValues=m?function(a){return new Set(a)}:
function(a){for(var b=new Set,f=0;f<a.length;f++)b.add(a[f]);return b};a.firstOfSet=m?l:k;a.reduceSet=function(a,b,f){var c=f;a.forEach(function(a){return c=b(a,c)});return c}})},"esri/geometry/support/aaBoundingRect":function(){define(["require","exports","../../core/compilerUtils","../Extent"],function(m,a,b,l){function k(c){void 0===c&&(c=a.ZERO);return[c[0],c[1],c[2],c[3]]}function h(a){return a[0]>=a[2]?0:a[2]-a[0]}function g(a){return a[1]>=a[3]?0:a[3]-a[1]}function d(a,c,e){return c>=a[0]&&
e>=a[1]&&c<=a[2]&&e<=a[3]}function f(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a}function c(a){return 4===a.length}function e(a,c,e){return a<c?c:a>e?e:a}Object.defineProperty(a,"__esModule",{value:!0});a.UNIT=a.ZERO=a.NEGATIVE_INFINITY=a.POSITIVE_INFINITY=a.equals=a.isPoint=a.is=a.empty=a.set=a.setMax=a.setMin=a.pad=a.offset=a.size=a.distance=a.intersection=a.contains=a.intersects=a.containsPointWithMargin=a.containsXY=a.containsPointObject=a.containsPoint=a.center=a.area=a.diameter=a.height=
a.width=a.allFinite=a.expandWithNestedArray=a.expand=a.expandPointInPlace=a.toExtent=a.fromExtent=a.fromValues=a.clone=a.create=void 0;a.create=k;a.clone=function(a){return[a[0],a[1],a[2],a[3]]};a.fromValues=function(a,c,e,b,d){void 0===d&&(d=k());d[0]=a;d[1]=c;d[2]=e;d[3]=b;return d};a.fromExtent=function(a,c){void 0===c&&(c=k());c[0]=a.xmin;c[1]=a.ymin;c[2]=a.xmax;c[3]=a.ymax;return c};a.toExtent=function(a,c){return new l({xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:c})};a.expandPointInPlace=
function(a,c){c[0]<a[0]&&(a[0]=c[0]);c[0]>a[2]&&(a[2]=c[0]);c[1]<a[1]&&(a[1]=c[1]);c[1]>a[3]&&(a[3]=c[1])};a.expand=function(a,e,d){void 0===d&&(d=a);if("length"in e)if(c(e))d[0]=Math.min(a[0],e[0]),d[1]=Math.min(a[1],e[1]),d[2]=Math.max(a[2],e[2]),d[3]=Math.max(a[3],e[3]);else{if(2===e.length||3===e.length)d[0]=Math.min(a[0],e[0]),d[1]=Math.min(a[1],e[1]),d[2]=Math.max(a[2],e[0]),d[3]=Math.max(a[3],e[1])}else switch(e.type){case "extent":d[0]=Math.min(a[0],e.xmin);d[1]=Math.min(a[1],e.ymin);d[2]=
Math.max(a[2],e.xmax);d[3]=Math.max(a[3],e.ymax);break;case "point":d[0]=Math.min(a[0],e.x);d[1]=Math.min(a[1],e.y);d[2]=Math.max(a[2],e.x);d[3]=Math.max(a[3],e.y);break;default:b.neverReached(e)}return d};a.expandWithNestedArray=function(a,c,e){void 0===e&&(e=a);var b=c.length,d=a[0],f=a[1],g=a[2];a=a[3];for(var n=0;n<b;n++){var h=c[n],d=Math.min(d,h[0]),f=Math.min(f,h[1]),g=Math.max(g,h[0]);a=Math.max(a,h[1])}e[0]=d;e[1]=f;e[2]=g;e[3]=a;return e};a.allFinite=function(a){for(var c=0;4>c;c++)if(!isFinite(a[c]))return!1;
return!0};a.width=h;a.height=g;a.diameter=function(a){var c=h(a);a=g(a);return Math.sqrt(c*c+a*a)};a.area=function(a){return h(a)*g(a)};a.center=function(a,c){void 0===c&&(c=[0,0]);c[0]=(a[0]+a[2])/2;c[1]=(a[1]+a[3])/2;return c};a.containsPoint=function(a,c){return d(a,c[0],c[1])};a.containsPointObject=function(a,c){return d(a,c.x,c.y)};a.containsXY=d;a.containsPointWithMargin=function(a,c,e){return c[0]>=a[0]-e&&c[1]>=a[1]-e&&c[0]<=a[2]+e&&c[1]<=a[3]+e};a.intersects=function(a,c){return Math.max(c[0],
a[0])<=Math.min(c[2],a[2])&&Math.max(c[1],a[1])<=Math.min(c[3],a[3])};a.contains=function(a,c){return c[0]>=a[0]&&c[2]<=a[2]&&c[1]>=a[1]&&c[3]<=a[3]};a.intersection=function(a,c,b){void 0===b&&(b=a);var d=c[0],f=c[1],g=c[2];c=c[3];b[0]=e(a[0],d,g);b[1]=e(a[1],f,c);b[2]=e(a[2],d,g);b[3]=e(a[3],f,c);return b};a.distance=function(a,c){var e=(a[1]+a[3])/2,b=Math.max(Math.abs(c[0]-(a[0]+a[2])/2)-h(a)/2,0);a=Math.max(Math.abs(c[1]-e)-g(a)/2,0);return Math.sqrt(b*b+a*a)};a.size=function(a,c){c[0]=a[2]-a[0];
c[1]=a[3]-a[1]};a.offset=function(a,c,e,b){void 0===b&&(b=a);b[0]=a[0]+c;b[1]=a[1]+e;b[2]=a[2]+c;b[3]=a[3]+e;return b};a.pad=function(a,c,e){void 0===e&&(e=a);e[0]=a[0]-c;e[1]=a[1]-c;e[2]=a[2]+c;e[3]=a[3]+c;return e};a.setMin=function(a,c,e){void 0===e&&(e=a);e[0]=c[0];e[1]=c[1];e!==a&&(e[2]=a[2],e[3]=a[3]);return e};a.setMax=function(a,c,e){void 0===e&&(e=a);e[2]=c[0];e[3]=c[1];e!==a&&(e[0]=a[0],e[1]=a[1]);return a};a.set=f;a.empty=function(c){return c?f(c,a.NEGATIVE_INFINITY):k(a.NEGATIVE_INFINITY)};
a.is=c;a.isPoint=function(a){return(0===h(a)||!isFinite(a[0]))&&(0===g(a)||!isFinite(a[1]))};a.equals=function(a,e,b){if(null==a||null==e)return a===e;if(!c(a)||!c(e))return!1;if(b)for(var d=0;d<a.length;d++){if(!b(a[d],e[d]))return!1}else for(d=0;d<a.length;d++)if(a[d]!==e[d])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0];a.UNIT=[0,0,1,1]})},"esri/layers/support/LOD":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.level=0;c.levelValue=null;c.resolution=0;c.scale=0;return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var f;b.__decorate([k.property({type:h.Integer,json:{write:!0}})],d.prototype,"level",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,"levelValue",void 0);b.__decorate([k.property({type:Number,
json:{write:!0}})],d.prototype,"resolution",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],d.prototype,"scale",void 0);return d=f=b.__decorate([k.subclass("esri.layers.support.LOD")],d)}(l.JSONSupport)})},"esri/views/2d/ViewState":function(){define("require exports tslib ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f32 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec2f64 ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y){var w=[0,0];return function(a){function h(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b._viewpoint2D={center:q.vec2f64.create(),rotation:0,scale:0,spatialReference:null};b.center=[0,0];b.extent=new l.Extent;b.id=0;b.inverseTransform=e.mat2df64.create();b.resolution=0;b.rotation=0;b.scale=0;b.transform=e.mat2df64.create();b.transformNoRotation=e.mat2df64.create();b.displayMat3=t.mat3f32.create();b.displayViewMat3=
t.mat3f32.create();b.viewMat3=t.mat3f32.create();b.viewMat2d=c.mat2df32.create();b.worldScreenWidth=0;b.size=[0,0];return b}b.__extends(h,a);B=h;Object.defineProperty(h.prototype,"pixelRatio",{set:function(a){this._set("pixelRatio",a);this._update()},enumerable:!1,configurable:!0});Object.defineProperty(h.prototype,"size",{set:function(a){this._set("size",a);this._update()},enumerable:!1,configurable:!0});Object.defineProperty(h.prototype,"viewpoint",{set:function(a){if(a){var c=this._viewpoint2D,
e=a.targetGeometry;c.center[0]=e.x;c.center[1]=e.y;c.rotation=a.rotation;c.scale=a.scale;c.spatialReference=e.spatialReference}this._update()},enumerable:!1,configurable:!0});h.prototype.copy=function(a){var c=this.size,e=this.viewpoint;e&&c?(this.viewpoint=y.copy(e,a.viewpoint),this._set("size",x.vec2.copy(c,a.size))):(this.viewpoint=a.viewpoint.clone(),this._set("size",[a.size[0],a.size[1]]));this._set("pixelRatio",a.pixelRatio);return this};h.prototype.clone=function(){return new B({size:this.size,
viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})};h.prototype.toMap=function(a,c,e){if(u.isVec2(c))return x.vec2.transformMat2d(a,c,this.inverseTransform);w[0]=c;w[1]=e;return x.vec2.transformMat2d(a,w,this.inverseTransform)};h.prototype.toScreen=function(a,c,e){if(u.isVec2(c))return x.vec2.transformMat2d(a,c,this.transform);w[0]=c;w[1]=e;return x.vec2.transformMat2d(a,w,this.transform)};h.prototype.toScreenNoRotation=function(a,c,e){if(u.isVec2(c))return x.vec2.transformMat2d(a,c,this.transformNoRotation);
w[0]=c;w[1]=e;return x.vec2.transformMat2d(a,w,this.transformNoRotation)};h.prototype.getScreenTransform=function(a,c){var e=this._viewpoint2D.center,b=this._get("pixelRatio")||1,d=this._get("size");y.getMatrix(a,e,d,c,0,b);return a};h.prototype._update=function(){var a=this._viewpoint2D,c=a.center,e=a.spatialReference,b=a.scale,g=a.rotation,a=this._get("pixelRatio")||1,h=this._get("size"),t=new k({targetGeometry:new l.Point(c[0],c[1],e),scale:b,rotation:g});this._set("viewpoint",t);if(h&&e&&b)return this.resolution=
y.getResolution(t),this.rotation=g,this.scale=b,this.spatialReference=e,x.vec2.copy(this.center,c),n.mat3.set(this.displayMat3,0!==h[0]?2/h[0]:0,0,0,0,0!==h[1]?-2/h[1]:0,0,-1,1,1),b=n.mat3.identity(this.viewMat3),c=p.vec2f32.fromValues(h[0]/2,h[1]/2),e=p.vec2f32.fromValues(-h[0]/2,-h[1]/2),g=d.common.toRadian(g),n.mat3.translate(b,b,c),n.mat3.rotate(b,b,g),n.mat3.translate(b,b,e),n.mat3.multiply(this.displayViewMat3,this.displayMat3,b),b=f.mat2d.identity(this.viewMat2d),f.mat2d.translate(b,b,c),f.mat2d.rotate(b,
b,g),f.mat2d.translate(b,b,e),y.getExtent(this.extent,t,h),y.getTransform(this.transform,t,h,a),f.mat2d.invert(this.inverseTransform,this.transform),y.getTransformNoRotation(this.transformNoRotation,t,h,a),this.worldScreenWidth=y.getWorldScreenWidth(this.spatialReference,this.resolution),this._set("id",this.id+1),this};var B;b.__decorate([g.property({readOnly:!0})],h.prototype,"id",void 0);b.__decorate([g.property({value:1,json:{write:!0}})],h.prototype,"pixelRatio",null);b.__decorate([g.property({json:{write:!0}})],
h.prototype,"size",null);b.__decorate([g.property({type:k,json:{write:!0}})],h.prototype,"viewpoint",null);return h=B=b.__decorate([g.subclass("esri.views.2d.ViewState")],h)}(h.JSONSupport)})},"esri/Viewpoint":function(){define("require exports tslib ./Camera ./geometry ./core/JSONSupport ./core/accessorSupport/decorators ./geometry/support/jsonUtils".split(" "),function(m,a,b,l,k,h,g,d){function f(){return{enabled:!this.camera}}return function(a){function c(c){c=a.call(this,c)||this;c.rotation=0;
c.scale=0;c.targetGeometry=null;c.camera=null;return c}b.__extends(c,a);n=c;c.prototype.castRotation=function(a){a%=360;0>a&&(a+=360);return a};c.prototype.clone=function(){return new n({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry?this.targetGeometry.clone():null,camera:this.camera?this.camera.clone():null})};var n;b.__decorate([g.property({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:f}}}}})],c.prototype,"rotation",
void 0);b.__decorate([g.cast("rotation")],c.prototype,"castRotation",null);b.__decorate([g.property({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:f}}}}})],c.prototype,"scale",void 0);b.__decorate([g.property({types:k.geometryTypes,json:{read:d.fromJSON,write:!0,origins:{"web-scene":{read:d.fromJSON,write:{overridePolicy:f}}}}})],c.prototype,"targetGeometry",void 0);b.__decorate([g.property({type:l,json:{write:!0}})],c.prototype,"camera",void 0);
return c=n=b.__decorate([g.subclass("esri.Viewpoint")],c)}(h.JSONSupport)})},"esri/Camera":function(){define("require exports tslib ./core/JSONSupport ./core/mathUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./geometry/Point ./views/3d/support/mathUtils".split(" "),function(m,a,b,l,k,h,g,d,f){return function(a){function c(){for(var c=[],e=0;e<arguments.length;e++)c[e]=arguments[e];c=a.apply(this,c)||this;c.position=new d([0,0,0]);c.heading=0;c.tilt=0;c.fov=55;return c}
b.__extends(c,a);n=c;c.prototype.normalizeCtorArgs=function(a,c,e,b){a&&"object"===typeof a&&("x"in a||Array.isArray(a))&&(a={position:a},null!=c&&(a.heading=c),null!=e&&(a.tilt=e),null!=b&&(a.fov=b));return a};c.prototype.writePosition=function(a,c,e,b){var d=a.clone();d.x=g.ensureNumber(a.x||0);d.y=g.ensureNumber(a.y||0);d.z=a.hasZ?g.ensureNumber(a.z||0):a.z;c[e]=d.write(null,b)};c.prototype.readPosition=function(a,c){var e=new d;e.read(a,c);e.x=g.ensureNumber(e.x||0);e.y=g.ensureNumber(e.y||0);
e.z=e.hasZ?g.ensureNumber(e.z||0):e.z;return e};c.prototype.equals=function(a){return a?this.tilt===a.tilt&&this.heading===a.heading&&this.fov===a.fov&&this.position.equals(a.position):!1};c.prototype.clone=function(){return new n({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})};var n;b.__decorate([h.property({type:d,json:{write:{isRequired:!0}}})],c.prototype,"position",void 0);b.__decorate([h.writer("position")],c.prototype,"writePosition",null);b.__decorate([h.reader("position")],
c.prototype,"readPosition",null);b.__decorate([h.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),h.cast(function(a){return f.cyclicalDeg.normalize(g.ensureNumber(a))})],c.prototype,"heading",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),h.cast(function(a){return k.clamp(g.ensureNumber(a),-180,180)})],c.prototype,"tilt",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],c.prototype,"fov",void 0);
return c=n=b.__decorate([h.subclass("esri.Camera")],c)}(l.JSONSupport)})},"esri/views/3d/support/mathUtils":function(){define(["require","exports","../../../core/mathUtils","../../../core/libs/gl-matrix-2/vec3","../../../core/libs/gl-matrix-2/vec3f64"],function(m,a,b,l,k){function h(a){for(var c in a){var e=a[c];e instanceof Function&&(a[c]=e.bind(a))}return a}Object.defineProperty(a,"__esModule",{value:!0});a.cyclicalDeg=a.cyclicalPI=a.cyclical2PI=a.planeFromPoints=a.Cyclical=a.makePiecewiseLinearFunction=
a.angle=a.slerp=a.bilerp=a.directionFromTo=a.sphericalToCartesian=a.cartesianToSpherical=a.moduloPositive=a.tangentFrame=a.makeOrthonormal=a.scaleFromMatrix=a.maxScale=a.fovy2fovx=a.fovx2fovy=a.cosCapped=void 0;a.cosCapped=function(a,c){return a>c?Math.cos(c):Math.cos(a)};a.fovx2fovy=function(a,c,e){return 2*Math.atan(e*Math.tan(.5*a)/c)};a.fovy2fovx=function(a,c,e){return 2*Math.atan(c*Math.tan(.5*a)/e)};a.maxScale=function(a){return Math.sqrt(Math.max(Math.max(a[0]*a[0]+a[4]*a[4]+a[8]*a[8],a[1]*
a[1]+a[5]*a[5]+a[9]*a[9]),a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))};a.scaleFromMatrix=function(a,c){l.vec3.set(a,Math.sqrt(c[0]*c[0]+c[4]*c[4]+c[8]*c[8]),Math.sqrt(c[1]*c[1]+c[5]*c[5]+c[9]*c[9]),Math.sqrt(c[2]*c[2]+c[6]*c[6]+c[10]*c[10]));return a};a.makeOrthonormal=function(a,c,e){e=e||a;var b=l.vec3.dot(a,c);l.vec3.set(e,a[0]-b*c[0],a[1]-b*c[1],a[2]-b*c[2]);l.vec3.normalize(e,e)};a.tangentFrame=function(a,c,e){Math.abs(a[0])>Math.abs(a[1])?l.vec3.set(c,0,1,0):l.vec3.set(c,1,0,0);l.vec3.cross(e,a,c);l.vec3.normalize(c,
c);l.vec3.cross(c,e,a);l.vec3.normalize(e,e)};a.moduloPositive=function(a,c){return(a%c+c)%c};a.cartesianToSpherical=function(a,c){var e=l.vec3.length(a),d=b.asinClamped(a[2]/e);l.vec3.set(c,e,d,Math.atan2(a[1]/e,a[0]/e));return c};a.sphericalToCartesian=function(a,c){var e=a[0],b=a[1];a=a[2];var d=Math.cos(b);l.vec3.set(c,e*d*Math.cos(a),e*d*Math.sin(a),e*Math.sin(b))};a.directionFromTo=function(a,c,e){var b=e[0]-c[0],d=e[1]-c[1];c=e[2]-c[2];e=b*b+d*d+c*c;if(!e)return a[0]=0,a[1]=0,a[2]=0,a;e=1/
Math.sqrt(e);a[0]=b*e;a[1]=d*e;a[2]=c*e;return a};a.bilerp=function(a,c,e,b,d,f){a+=(c-a)*d;return a+(e+(b-e)*d-a)*f};a.slerp=function(a,b,d,f){void 0===f&&(f=k.vec3f64.create());var g=l.vec3.length(a),h=l.vec3.length(b),p=l.vec3.dot(a,b)/(g*h);if(.9999999999999999>p){var p=Math.acos(p),n=((1-d)*g+d*h)/Math.sin(p),h=n/h*Math.sin(d*p);l.vec3.scale(c,a,n/g*Math.sin((1-d)*p));l.vec3.scale(e,b,h);return l.vec3.add(f,c,e)}return l.vec3.lerp(f,a,b,d)};a.angle=function(a,d,g){a=l.vec3.normalize(c,a);d=l.vec3.normalize(e,
d);var h=b.acosClamped(l.vec3.dot(a,d));return g&&(a=l.vec3.cross(f,a,d),0>l.vec3.dot(a,g))?-h:h};a.makePiecewiseLinearFunction=function(a){var c=a.length;return function(e){if(e<=a[0][0])return a[0][1];if(e>=a[c-1][0])return a[c-1][1];for(var b=1;e>a[b][0];)b++;var d=a[b][0];e=(d-e)/(d-a[b-1][0]);return e*a[b-1][1]+(1-e)*a[b][1]}};m=function(){function a(a,c){this.min=a;this.max=c;this.range=c-a}a.prototype.ndiff=function(a,c){void 0===c&&(c=0);return Math.ceil((a-c)/this.range)*this.range+c};a.prototype._normalize=
function(a,c,e,b,d){void 0===b&&(b=0);void 0===d&&(d=!1);e-=b;e<a?e+=this.ndiff(a-e):e>c&&(e-=this.ndiff(e-c));d&&e===c&&(e=a);return e+b};a.prototype.normalize=function(a,c,e){void 0===c&&(c=0);void 0===e&&(e=!1);return this._normalize(this.min,this.max,a,c,e)};a.prototype.clamp=function(a,c){void 0===c&&(c=0);return b.clamp(a-c,this.min,this.max)+c};a.prototype.monotonic=function(a,c,e){return a<c?c:c+this.ndiff(a-c,e)};a.prototype.minimalMonotonic=function(a,c,e){return this._normalize(a,a+this.range,
c,e)};a.prototype.center=function(a,c,e){c=this.monotonic(a,c,e);return this.normalize((a+c)/2,e)};a.prototype.diff=function(a,c,e){return this.monotonic(a,c,e)-a};a.prototype.shortestSignedDiff=function(a,c){a=this.normalize(a);c=this.normalize(c);var e=c-a;a=c<a?this.minimalMonotonic(a,c)-a:c-this.minimalMonotonic(c,a);return Math.abs(e)<Math.abs(a)?e:a};a.prototype.contains=function(a,c,e){c=this.minimalMonotonic(a,c);e=this.minimalMonotonic(a,e);return e>a&&e<c};return a}();a.Cyclical=m;a.planeFromPoints=
function(a,c,e,b){l.vec3.subtract(g,c,a);l.vec3.subtract(d,e,a);l.vec3.cross(b,g,d);l.vec3.normalize(b,b);b[3]=-l.vec3.dot(a,b)};var g=k.vec3f64.create(),d=k.vec3f64.create();a.cyclical2PI=h(new m(0,2*Math.PI));a.cyclicalPI=h(new m(-Math.PI,Math.PI));a.cyclicalDeg=h(new m(0,360));var f=k.vec3f64.create(),c=k.vec3f64.create(),e=k.vec3f64.create()})},"esri/core/libs/gl-matrix-2/vec3":function(){define(["require","exports","./math/vec3"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});
a.vec3=void 0;a.vec3=b})},"esri/core/libs/gl-matrix-2/math/vec3":function(){define(["require","exports","../factories/vec3f64","./common"],function(m,a,b,l){function k(a){var c=a[0],e=a[1];a=a[2];return Math.sqrt(c*c+e*e+a*a)}function h(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];return a}function g(a,c,e){a[0]=c[0]-e[0];a[1]=c[1]-e[1];a[2]=c[2]-e[2];return a}function d(a,c,e){a[0]=c[0]*e[0];a[1]=c[1]*e[1];a[2]=c[2]*e[2];return a}function f(a,c,e){a[0]=c[0]/e[0];a[1]=c[1]/e[1];a[2]=c[2]/e[2];return a}function c(a,
c){var e=c[0]-a[0],b=c[1]-a[1];a=c[2]-a[2];return Math.sqrt(e*e+b*b+a*a)}function e(a,c){var e=c[0]-a[0],b=c[1]-a[1];a=c[2]-a[2];return e*e+b*b+a*a}function n(a){var c=a[0],e=a[1];a=a[2];return c*c+e*e+a*a}function t(a,c){var e=c[0],b=c[1],d=c[2],e=e*e+b*b+d*d;0<e&&(e=1/Math.sqrt(e),a[0]=c[0]*e,a[1]=c[1]*e,a[2]=c[2]*e);return a}function x(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]}Object.defineProperty(a,"__esModule",{value:!0});a.sqrLen=a.len=a.sqrDist=a.dist=a.div=a.mul=a.sub=a.equals=a.exactEquals=
a.str=a.angle=a.rotateZ=a.rotateY=a.rotateX=a.transformQuat=a.transformMat3=a.transformMat4=a.random=a.bezier=a.hermite=a.lerp=a.cross=a.dot=a.normalize=a.inverse=a.negate=a.squaredLength=a.squaredDistance=a.distance=a.scaleAndAdd=a.scale=a.round=a.max=a.min=a.floor=a.ceil=a.divide=a.multiply=a.subtract=a.add=a.set=a.copy=a.length=void 0;a.length=k;a.copy=h;a.set=function(a,c,e,b){a[0]=c;a[1]=e;a[2]=b;return a};a.add=function(a,c,e){a[0]=c[0]+e[0];a[1]=c[1]+e[1];a[2]=c[2]+e[2];return a};a.subtract=
g;a.multiply=d;a.divide=f;a.ceil=function(a,c){a[0]=Math.ceil(c[0]);a[1]=Math.ceil(c[1]);a[2]=Math.ceil(c[2]);return a};a.floor=function(a,c){a[0]=Math.floor(c[0]);a[1]=Math.floor(c[1]);a[2]=Math.floor(c[2]);return a};a.min=function(a,c,e){a[0]=Math.min(c[0],e[0]);a[1]=Math.min(c[1],e[1]);a[2]=Math.min(c[2],e[2]);return a};a.max=function(a,c,e){a[0]=Math.max(c[0],e[0]);a[1]=Math.max(c[1],e[1]);a[2]=Math.max(c[2],e[2]);return a};a.round=function(a,c){a[0]=Math.round(c[0]);a[1]=Math.round(c[1]);a[2]=
Math.round(c[2]);return a};a.scale=function(a,c,e){a[0]=c[0]*e;a[1]=c[1]*e;a[2]=c[2]*e;return a};a.scaleAndAdd=function(a,c,e,b){a[0]=c[0]+e[0]*b;a[1]=c[1]+e[1]*b;a[2]=c[2]+e[2]*b;return a};a.distance=c;a.squaredDistance=e;a.squaredLength=n;a.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];return a};a.inverse=function(a,c){a[0]=1/c[0];a[1]=1/c[1];a[2]=1/c[2];return a};a.normalize=t;a.dot=x;a.cross=function(a,c,e){var b=c[0],d=c[1];c=c[2];var f=e[0],g=e[1];e=e[2];a[0]=d*e-c*g;a[1]=c*f-b*e;a[2]=
b*g-d*f;return a};a.lerp=function(a,c,e,b){var d=c[0],f=c[1];c=c[2];a[0]=d+b*(e[0]-d);a[1]=f+b*(e[1]-f);a[2]=c+b*(e[2]-c);return a};a.hermite=function(a,c,e,b,d,f){var g=f*f,h=g*(2*f-3)+1,p=g*(f-2)+f,n=g*(f-1);f=g*(3-2*f);a[0]=c[0]*h+e[0]*p+b[0]*n+d[0]*f;a[1]=c[1]*h+e[1]*p+b[1]*n+d[1]*f;a[2]=c[2]*h+e[2]*p+b[2]*n+d[2]*f;return a};a.bezier=function(a,c,e,b,d,f){var g=1-f,h=g*g,p=f*f,n=h*g,h=3*f*h,g=3*p*g;f*=p;a[0]=c[0]*n+e[0]*h+b[0]*g+d[0]*f;a[1]=c[1]*n+e[1]*h+b[1]*g+d[1]*f;a[2]=c[2]*n+e[2]*h+b[2]*
g+d[2]*f;return a};a.random=function(a,c){c=c||1;var e=2*l.RANDOM()*Math.PI,b=2*l.RANDOM()-1,d=Math.sqrt(1-b*b)*c;a[0]=Math.cos(e)*d;a[1]=Math.sin(e)*d;a[2]=b*c;return a};a.transformMat4=function(a,c,e){var b=c[0],d=c[1];c=c[2];a[0]=e[0]*b+e[4]*d+e[8]*c+e[12];a[1]=e[1]*b+e[5]*d+e[9]*c+e[13];a[2]=e[2]*b+e[6]*d+e[10]*c+e[14];return a};a.transformMat3=function(a,c,e){var b=c[0],d=c[1];c=c[2];a[0]=b*e[0]+d*e[3]+c*e[6];a[1]=b*e[1]+d*e[4]+c*e[7];a[2]=b*e[2]+d*e[5]+c*e[8];return a};a.transformQuat=function(a,
c,e){var b=e[0],d=e[1],f=e[2],g=c[0],h=c[1];c=c[2];var p=d*c-f*h,n=f*g-b*c,q=b*h-d*g;e=2*e[3];a[0]=g+p*e+2*(d*q-f*n);a[1]=h+n*e+2*(f*p-b*q);a[2]=c+q*e+2*(b*n-d*p);return a};a.rotateX=function(a,c,e,b){var d=[],f=[];d[0]=c[0]-e[0];d[1]=c[1]-e[1];d[2]=c[2]-e[2];f[0]=d[0];f[1]=d[1]*Math.cos(b)-d[2]*Math.sin(b);f[2]=d[1]*Math.sin(b)+d[2]*Math.cos(b);a[0]=f[0]+e[0];a[1]=f[1]+e[1];a[2]=f[2]+e[2];return a};a.rotateY=function(a,c,e,b){var d=[],f=[];d[0]=c[0]-e[0];d[1]=c[1]-e[1];d[2]=c[2]-e[2];f[0]=d[2]*Math.sin(b)+
d[0]*Math.cos(b);f[1]=d[1];f[2]=d[2]*Math.cos(b)-d[0]*Math.sin(b);a[0]=f[0]+e[0];a[1]=f[1]+e[1];a[2]=f[2]+e[2];return a};a.rotateZ=function(a,c,e,b){var d=[],f=[];d[0]=c[0]-e[0];d[1]=c[1]-e[1];d[2]=c[2]-e[2];f[0]=d[0]*Math.cos(b)-d[1]*Math.sin(b);f[1]=d[0]*Math.sin(b)+d[1]*Math.cos(b);f[2]=d[2];a[0]=f[0]+e[0];a[1]=f[1]+e[1];a[2]=f[2]+e[2];return a};a.angle=function(a,c){h(p,a);h(q,c);t(p,p);t(q,q);a=x(p,q);return 1<a?0:-1>a?Math.PI:Math.acos(a)};var p=b.create(),q=b.create();a.str=function(a){return"vec3("+
a[0]+", "+a[1]+", "+a[2]+")"};a.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]};a.equals=function(a,c){var e=a[0],b=a[1];a=a[2];var d=c[0],f=c[1];c=c[2];return Math.abs(e-d)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(b-f)<=l.EPSILON*Math.max(1,Math.abs(b),Math.abs(f))&&Math.abs(a-c)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};a.sub=g;a.mul=d;a.div=f;a.dist=c;a.sqrDist=e;a.len=k;a.sqrLen=n})},"esri/core/libs/gl-matrix-2/factories/vec3f64":function(){define(["require",
"exports"],function(m,a){function b(){return[0,0,0]}function l(){return[1,1,1]}function k(){return[1,0,0]}function h(){return[0,1,0]}function g(){return[0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.UNIT_Z=a.UNIT_Y=a.UNIT_X=a.ONES=a.ZEROS=a.unitZ=a.unitY=a.unitX=a.ones=a.zeros=a.createView=a.fromArray=a.fromValues=a.clone=a.create=void 0;a.create=b;a.clone=function(a){return[a[0],a[1],a[2]]};a.fromValues=function(a,b,c){return[a,b,c]};a.fromArray=function(a){for(var d=b(),c=Math.min(3,
a.length),e=0;e<c;++e)d[e]=a[e];return d};a.createView=function(a,b){return new Float64Array(a,b,3)};a.zeros=function(){return b()};a.ones=l;a.unitX=k;a.unitY=h;a.unitZ=g;a.ZEROS=b();a.ONES=l();a.UNIT_X=k();a.UNIT_Y=h();a.UNIT_Z=g()})},"esri/core/libs/gl-matrix-2/math/common":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.equals=a.toDegree=a.toRadian=a.RANDOM=a.EPSILON=void 0;a.EPSILON=1E-6;a.RANDOM=Math.random;var b=Math.PI/180,l=180/Math.PI;
a.toRadian=function(a){return a*b};a.toDegree=function(a){return a*l};a.equals=function(b,h){return Math.abs(b-h)<=a.EPSILON*Math.max(1,Math.abs(b),Math.abs(h))}})},"esri/core/libs/gl-matrix-2/vec3f64":function(){define(["require","exports","./factories/vec3f64"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.vec3f64=void 0;a.vec3f64=b})},"esri/core/libs/gl-matrix-2/common":function(){define(["require","exports","./math/common"],function(m,a,b){Object.defineProperty(a,"__esModule",
{value:!0});a.common=void 0;a.common=b})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports","./math/mat2d"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.mat2d=void 0;a.mat2d=b})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(m,a,b){function l(a,b,d){var f=b[0],c=b[1],e=b[2],g=b[3],h=b[4];b=b[5];var k=d[0],p=d[1],q=d[2],u=d[3],y=d[4];d=d[5];a[0]=f*k+e*p;a[1]=c*k+g*p;a[2]=f*q+e*u;a[3]=c*q+g*u;a[4]=f*
y+e*d+h;a[5]=c*y+g*d+b;return a}function k(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];a[3]=b[3]-d[3];a[4]=b[4]-d[4];a[5]=b[5]-d[5];return a}Object.defineProperty(a,"__esModule",{value:!0});a.sub=a.mul=a.equals=a.exactEquals=a.multiplyScalarAndAdd=a.multiplyScalar=a.subtract=a.add=a.frob=a.str=a.fromTranslation=a.fromScaling=a.fromRotation=a.translate=a.scale=a.rotate=a.multiply=a.determinant=a.invert=a.set=a.identity=a.copy=void 0;a.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];
a[4]=b[4];a[5]=b[5];return a};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a};a.set=function(a,b,d,f,c,e,n){a[0]=b;a[1]=d;a[2]=f;a[3]=c;a[4]=e;a[5]=n;return a};a.invert=function(a,b){var d=b[0],f=b[1],c=b[2],e=b[3],g=b[4];b=b[5];var h=d*e-f*c;if(!h)return null;h=1/h;a[0]=e*h;a[1]=-f*h;a[2]=-c*h;a[3]=d*h;a[4]=(c*b-e*g)*h;a[5]=(f*g-d*b)*h;return a};a.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};a.multiply=l;a.rotate=function(a,b,d){var f=b[0],c=b[1],e=b[2],g=b[3],h=
b[4];b=b[5];var k=Math.sin(d);d=Math.cos(d);a[0]=f*d+e*k;a[1]=c*d+g*k;a[2]=f*-k+e*d;a[3]=c*-k+g*d;a[4]=h;a[5]=b;return a};a.scale=function(a,b,d){var f=b[1],c=b[2],e=b[3],g=b[4],h=b[5],k=d[0];d=d[1];a[0]=b[0]*k;a[1]=f*k;a[2]=c*d;a[3]=e*d;a[4]=g;a[5]=h;return a};a.translate=function(a,b,d){var f=b[0],c=b[1],e=b[2],g=b[3],h=b[4];b=b[5];var k=d[0];d=d[1];a[0]=f;a[1]=c;a[2]=e;a[3]=g;a[4]=f*k+e*d+h;a[5]=c*k+g*d+b;return a};a.fromRotation=function(a,b){var d=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=d;a[2]=
-d;a[3]=b;a[4]=0;a[5]=0;return a};a.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=0;return a};a.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a};a.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};a.add=function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=
b[2]+d[2];a[3]=b[3]+d[3];a[4]=b[4]+d[4];a[5]=b[5]+d[5];return a};a.subtract=k;a.multiplyScalar=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*d;a[5]=b[5]*d;return a};a.multiplyScalarAndAdd=function(a,b,d,f){a[0]=b[0]+d[0]*f;a[1]=b[1]+d[1]*f;a[2]=b[2]+d[2]*f;a[3]=b[3]+d[3]*f;a[4]=b[4]+d[4]*f;a[5]=b[5]+d[5]*f;return a};a.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]};a.equals=function(a,g){var d=a[0],f=a[1],c=
a[2],e=a[3],n=a[4];a=a[5];var h=g[0],k=g[1],p=g[2],q=g[3],u=g[4];g=g[5];return Math.abs(d-h)<=b.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))&&Math.abs(f-k)<=b.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(c-p)<=b.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(e-q)<=b.EPSILON*Math.max(1,Math.abs(e),Math.abs(q))&&Math.abs(n-u)<=b.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-g)<=b.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))};a.mul=l;a.sub=k})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require",
"exports","./factories/mat2df32"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.mat2df32=void 0;a.mat2df32=b})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(m,a){function b(a,b,h,g){var d=b[g];b=b[g+1];a[g]=h[0]*d+h[2]*b+h[4];a[g+1]=h[1]*d+h[3]*b+h[5]}Object.defineProperty(a,"__esModule",{value:!0});a.transformMany=a.transform=a.createView=a.fromValues=a.clone=a.create=void 0;a.create=function(){var a=new Float32Array(6);a[0]=
1;a[3]=1;return a};a.clone=function(a){var b=new Float32Array(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b};a.fromValues=function(a,b,h,g,d,f){var c=new Float32Array(6);c[0]=a;c[1]=b;c[2]=h;c[3]=g;c[4]=d;c[5]=f;return c};a.createView=function(a,b){return new Float32Array(a,b,6)};a.transform=b;a.transformMany=function(a,k,h,g,d,f){void 0===g&&(g=0);void 0===d&&(d=0);void 0===f&&(f=2);for(d=d||k.length/f;g<d;g++)b(a,k,h,g*f)}})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require",
"exports","./factories/mat2df64"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.mat2df64=void 0;a.mat2df64=b})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.createView=a.fromValues=a.clone=a.create=void 0;a.create=function(){return[1,0,0,1,0,0]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5]]};a.fromValues=function(a,l,k,h,g,d){return[a,l,k,h,g,d]};a.createView=
function(a,l){return new Float64Array(a,l,6)}})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.mat3=void 0;a.mat3=b})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(m,a,b){function l(a,b,d){var f=b[0],c=b[1],e=b[2],g=b[3],h=b[4],k=b[5],p=b[6],q=b[7];b=b[8];var u=d[0],y=d[1],w=d[2],l=d[3],z=d[4],A=d[5],C=d[6],E=d[7];d=d[8];a[0]=u*f+y*g+w*
p;a[1]=u*c+y*h+w*q;a[2]=u*e+y*k+w*b;a[3]=l*f+z*g+A*p;a[4]=l*c+z*h+A*q;a[5]=l*e+z*k+A*b;a[6]=C*f+E*g+d*p;a[7]=C*c+E*h+d*q;a[8]=C*e+E*k+d*b;return a}function k(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];a[3]=b[3]-d[3];a[4]=b[4]-d[4];a[5]=b[5]-d[5];a[6]=b[6]-d[6];a[7]=b[7]-d[7];a[8]=b[8]-d[8];return a}Object.defineProperty(a,"__esModule",{value:!0});a.sub=a.mul=a.equals=a.exactEquals=a.multiplyScalarAndAdd=a.multiplyScalar=a.subtract=a.add=a.frob=a.str=a.projection=a.normalFromMat4=a.normalFromMat4Legacy=
a.fromQuat=a.fromMat2d=a.fromScaling=a.fromRotation=a.fromTranslation=a.scaleByVec2=a.scale=a.rotate=a.translate=a.multiply=a.determinant=a.adjoint=a.invert=a.transpose=a.identity=a.set=a.copy=a.fromMat4=void 0;a.fromMat4=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a};a.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};a.set=function(a,b,d,f,c,e,n,t,k,p){a[0]=b;
a[1]=d;a[2]=f;a[3]=c;a[4]=e;a[5]=n;a[6]=t;a[7]=k;a[8]=p;return a};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,b){if(a===b){var d=b[1],f=b[2],c=b[5];a[1]=b[3];a[2]=b[6];a[3]=d;a[5]=b[7];a[6]=f;a[7]=c}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a};a.invert=function(a,b){var d=b[0],f=b[1],c=b[2],e=b[3],g=b[4],h=b[5],k=b[6],p=b[7];b=b[8];var q=b*g-h*p,u=-b*e+h*k,y=p*e-g*
k,w=d*q+f*u+c*y;if(!w)return null;w=1/w;a[0]=q*w;a[1]=(-b*f+c*p)*w;a[2]=(h*f-c*g)*w;a[3]=u*w;a[4]=(b*d-c*k)*w;a[5]=(-h*d+c*e)*w;a[6]=y*w;a[7]=(-p*d+f*k)*w;a[8]=(g*d-f*e)*w;return a};a.adjoint=function(a,b){var d=b[0],f=b[1],c=b[2],e=b[3],g=b[4],h=b[5],k=b[6],p=b[7];b=b[8];a[0]=g*b-h*p;a[1]=c*p-f*b;a[2]=f*h-c*g;a[3]=h*k-e*b;a[4]=d*b-c*k;a[5]=c*e-d*h;a[6]=e*p-g*k;a[7]=f*k-d*p;a[8]=d*g-f*e;return a};a.determinant=function(a){var b=a[3],d=a[4],f=a[5],c=a[6],e=a[7],n=a[8];return a[0]*(n*d-f*e)+a[1]*(-n*
b+f*c)+a[2]*(e*b-d*c)};a.multiply=l;a.translate=function(a,b,d){var f=b[0],c=b[1],e=b[2],g=b[3],h=b[4],k=b[5],p=b[6],q=b[7];b=b[8];var u=d[0];d=d[1];a[0]=f;a[1]=c;a[2]=e;a[3]=g;a[4]=h;a[5]=k;a[6]=u*f+d*g+p;a[7]=u*c+d*h+q;a[8]=u*e+d*k+b;return a};a.rotate=function(a,b,d){var f=b[0],c=b[1],e=b[2],g=b[3],h=b[4],k=b[5],p=b[6],q=b[7];b=b[8];var u=Math.sin(d);d=Math.cos(d);a[0]=d*f+u*g;a[1]=d*c+u*h;a[2]=d*e+u*k;a[3]=d*g-u*f;a[4]=d*h-u*c;a[5]=d*k-u*e;a[6]=p;a[7]=q;a[8]=b;return a};a.scale=function(a,b,d){var f=
d[0],c=d[1];d=d[2];a[0]=f*b[0];a[1]=f*b[1];a[2]=f*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=d*b[6];a[7]=d*b[7];a[8]=d*b[8];return a};a.scaleByVec2=function(a,b,d){var f=d[0];d=d[1];a[0]=f*b[0];a[1]=f*b[1];a[2]=f*b[2];a[3]=d*b[3];a[4]=d*b[4];a[5]=d*b[5];return a};a.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};a.fromRotation=function(a,b){var d=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=d;a[2]=0;a[3]=-d;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=
1;return a};a.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat2d=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};a.fromQuat=function(a,b){var d=b[0],f=b[1],c=b[2];b=b[3];var e=d+d,g=f+f,h=c+c,d=d*e,k=f*e,f=f*g,p=c*e,q=c*g,c=c*h,e=b*e,g=b*g;b*=h;a[0]=1-f-c;a[3]=k-b;a[6]=p+g;a[1]=k+b;a[4]=1-d-c;a[7]=q-e;a[2]=p-g;a[5]=q+e;a[8]=1-d-f;return a};a.normalFromMat4Legacy=function(a,b){var d=
b[0],f=b[1],c=b[2],e=b[4],g=b[5],h=b[6],k=b[8],p=b[9];b=b[10];var q=b*g-h*p,u=-b*e+h*k,y=p*e-g*k,w=d*q+f*u+c*y;if(!w)return null;w=1/w;a[0]=q*w;a[1]=(-b*f+c*p)*w;a[2]=(h*f-c*g)*w;a[3]=u*w;a[4]=(b*d-c*k)*w;a[5]=(-h*d+c*e)*w;a[6]=y*w;a[7]=(-p*d+f*k)*w;a[8]=(g*d-f*e)*w;return a};a.normalFromMat4=function(a,b){var d=b[0],f=b[1],c=b[2],e=b[3],g=b[4],h=b[5],k=b[6],p=b[7],q=b[8],u=b[9],y=b[10],w=b[11],l=b[12],z=b[13],A=b[14];b=b[15];var C=d*h-f*g,E=d*k-c*g,D=d*p-e*g,F=f*k-c*h,H=f*p-e*h,m=c*p-e*k,G=q*z-u*
l,K=q*A-y*l,q=q*b-w*l,L=u*A-y*z,u=u*b-w*z,y=y*b-w*A,w=C*y-E*u+D*L+F*q-H*K+m*G;if(!w)return null;w=1/w;a[0]=(h*y-k*u+p*L)*w;a[1]=(k*q-g*y-p*K)*w;a[2]=(g*u-h*q+p*G)*w;a[3]=(c*u-f*y-e*L)*w;a[4]=(d*y-c*q+e*K)*w;a[5]=(f*q-d*u-e*G)*w;a[6]=(z*m-A*H+b*F)*w;a[7]=(A*D-l*m-b*E)*w;a[8]=(l*H-z*D+b*C)*w;return a};a.projection=function(a,b,d){a[0]=2/b;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/d;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+
a[6]+", "+a[7]+", "+a[8]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};a.add=function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];a[3]=b[3]+d[3];a[4]=b[4]+d[4];a[5]=b[5]+d[5];a[6]=b[6]+d[6];a[7]=b[7]+d[7];a[8]=b[8]+d[8];return a};a.subtract=k;a.multiplyScalar=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*d;a[5]=b[5]*
d;a[6]=b[6]*d;a[7]=b[7]*d;a[8]=b[8]*d;return a};a.multiplyScalarAndAdd=function(a,b,d,f){a[0]=b[0]+d[0]*f;a[1]=b[1]+d[1]*f;a[2]=b[2]+d[2]*f;a[3]=b[3]+d[3]*f;a[4]=b[4]+d[4]*f;a[5]=b[5]+d[5]*f;a[6]=b[6]+d[6]*f;a[7]=b[7]+d[7]*f;a[8]=b[8]+d[8]*f;return a};a.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};a.equals=function(a,g){var d=a[0],f=a[1],c=a[2],e=a[3],n=a[4],t=a[5],h=a[6],p=a[7];a=a[8];var q=g[0],
k=g[1],y=g[2],w=g[3],l=g[4],z=g[5],A=g[6],C=g[7];g=g[8];return Math.abs(d-q)<=b.EPSILON*Math.max(1,Math.abs(d),Math.abs(q))&&Math.abs(f-k)<=b.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(c-y)<=b.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(e-w)<=b.EPSILON*Math.max(1,Math.abs(e),Math.abs(w))&&Math.abs(n-l)<=b.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(t-z)<=b.EPSILON*Math.max(1,Math.abs(t),Math.abs(z))&&Math.abs(h-A)<=b.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(p-
C)<=b.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(a-g)<=b.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))};a.mul=l;a.sub=k})},"esri/core/libs/gl-matrix-2/mat3f32":function(){define(["require","exports","./factories/mat3f32"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f32=void 0;a.mat3f32=b})},"esri/core/libs/gl-matrix-2/factories/mat3f32":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.createView=a.fromValues=
a.clone=a.create=void 0;a.create=function(){var a=new Float32Array(9);a[0]=1;a[4]=1;a[8]=1;return a};a.clone=function(a){var b=new Float32Array(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.fromValues=function(a,l,k,h,g,d,f,c,e){var b=new Float32Array(9);b[0]=a;b[1]=l;b[2]=k;b[3]=h;b[4]=g;b[5]=d;b[6]=f;b[7]=c;b[8]=e;return b};a.createView=function(a,l){return new Float32Array(a,l,9)}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require",
"exports","./math/vec2"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.vec2=void 0;a.vec2=b})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(m,a,b){function l(a,c,b){a[0]=c[0]-b[0];a[1]=c[1]-b[1];return a}function k(a,c,b){a[0]=c[0]*b[0];a[1]=c[1]*b[1];return a}function h(a,c,b){a[0]=c[0]/b[0];a[1]=c[1]/b[1];return a}function g(a,c){var b=c[0]-a[0];a=c[1]-a[1];return Math.sqrt(b*b+a*a)}function d(a,c){var b=c[0]-a[0];a=c[1]-
a[1];return b*b+a*a}function f(a){var c=a[0];a=a[1];return Math.sqrt(c*c+a*a)}function c(a){var c=a[0];a=a[1];return c*c+a*a}Object.defineProperty(a,"__esModule",{value:!0});a.sqrLen=a.sqrDist=a.dist=a.div=a.mul=a.sub=a.len=a.equals=a.exactEquals=a.str=a.angle=a.rotate=a.transformMat4=a.transformMat3=a.transformMat2d=a.transformMat2=a.random=a.lerp=a.cross=a.dot=a.normalize=a.inverse=a.negate=a.squaredLength=a.length=a.squaredDistance=a.distance=a.scaleAndAdd=a.scale=a.round=a.max=a.min=a.floor=a.ceil=
a.divide=a.multiply=a.subtract=a.add=a.set=a.copy=void 0;a.copy=function(a,c){a[0]=c[0];a[1]=c[1];return a};a.set=function(a,c,b){a[0]=c;a[1]=b;return a};a.add=function(a,c,b){a[0]=c[0]+b[0];a[1]=c[1]+b[1];return a};a.subtract=l;a.multiply=k;a.divide=h;a.ceil=function(a,c){a[0]=Math.ceil(c[0]);a[1]=Math.ceil(c[1]);return a};a.floor=function(a,c){a[0]=Math.floor(c[0]);a[1]=Math.floor(c[1]);return a};a.min=function(a,c,b){a[0]=Math.min(c[0],b[0]);a[1]=Math.min(c[1],b[1]);return a};a.max=function(a,
c,b){a[0]=Math.max(c[0],b[0]);a[1]=Math.max(c[1],b[1]);return a};a.round=function(a,c){a[0]=Math.round(c[0]);a[1]=Math.round(c[1]);return a};a.scale=function(a,c,b){a[0]=c[0]*b;a[1]=c[1]*b;return a};a.scaleAndAdd=function(a,c,b,d){a[0]=c[0]+b[0]*d;a[1]=c[1]+b[1]*d;return a};a.distance=g;a.squaredDistance=d;a.length=f;a.squaredLength=c;a.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];return a};a.inverse=function(a,c){a[0]=1/c[0];a[1]=1/c[1];return a};a.normalize=function(a,c){var b=c[0],e=c[1],b=b*b+e*
e;0<b&&(b=1/Math.sqrt(b),a[0]=c[0]*b,a[1]=c[1]*b);return a};a.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]};a.cross=function(a,c,b){c=c[0]*b[1]-c[1]*b[0];a[0]=a[1]=0;a[2]=c;return a};a.lerp=function(a,c,b,d){var e=c[0];c=c[1];a[0]=e+d*(b[0]-e);a[1]=c+d*(b[1]-c);return a};a.random=function(a,c){c=c||1;var e=2*b.RANDOM()*Math.PI;a[0]=Math.cos(e)*c;a[1]=Math.sin(e)*c;return a};a.transformMat2=function(a,c,b){var e=c[0];c=c[1];a[0]=b[0]*e+b[2]*c;a[1]=b[1]*e+b[3]*c;return a};a.transformMat2d=function(a,
c,b){var e=c[0];c=c[1];a[0]=b[0]*e+b[2]*c+b[4];a[1]=b[1]*e+b[3]*c+b[5];return a};a.transformMat3=function(a,c,b){var e=c[0];c=c[1];a[0]=b[0]*e+b[3]*c+b[6];a[1]=b[1]*e+b[4]*c+b[7];return a};a.transformMat4=function(a,c,b){var e=c[0];c=c[1];a[0]=b[0]*e+b[4]*c+b[12];a[1]=b[1]*e+b[5]*c+b[13];return a};a.rotate=function(a,c,b,d){var e=c[0]-b[0];c=c[1]-b[1];var f=Math.sin(d);d=Math.cos(d);a[0]=e*d-c*f+b[0];a[1]=e*f+c*d+b[1];return a};a.angle=function(a,c){var b=a[0];a=a[1];var e=c[0];c=c[1];var d=b*b+a*
a;0<d&&(d=1/Math.sqrt(d));var f=e*e+c*c;0<f&&(f=1/Math.sqrt(f));b=(b*e+a*c)*d*f;return 1<b?0:-1>b?Math.PI:Math.acos(b)};a.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};a.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]};a.equals=function(a,c){var e=a[0];a=a[1];var d=c[0];c=c[1];return Math.abs(e-d)<=b.EPSILON*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(a-c)<=b.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};a.len=f;a.sub=l;a.mul=k;a.div=h;a.dist=g;a.sqrDist=d;a.sqrLen=c})},"esri/core/libs/gl-matrix-2/vec2f32":function(){define(["require",
"exports","./factories/vec2f32"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f32=void 0;a.vec2f32=b})},"esri/core/libs/gl-matrix-2/factories/vec2f32":function(){define(["require","exports"],function(m,a){function b(){return new Float32Array(2)}function l(a,b){var c=new Float32Array(2);c[0]=a;c[1]=b;return c}function k(){return l(1,1)}function h(){return l(1,0)}function g(){return l(0,1)}Object.defineProperty(a,"__esModule",{value:!0});a.UNIT_Y=a.UNIT_X=a.ONES=a.ZEROS=a.unitY=
a.unitX=a.ones=a.zeros=a.createView=a.fromValues=a.clone=a.create=void 0;a.create=b;a.clone=function(a){var b=new Float32Array(2);b[0]=a[0];b[1]=a[1];return b};a.fromValues=l;a.createView=function(a,b){return new Float32Array(a,b,2)};a.zeros=function(){return b()};a.ones=k;a.unitX=h;a.unitY=g;a.ZEROS=b();a.ONES=k();a.UNIT_X=h();a.UNIT_Y=g()})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});
a.vec2f64=void 0;a.vec2f64=b})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.UNIT_Y=a.UNIT_X=a.ONES=a.ZEROS=a.unitY=a.unitX=a.ones=a.zeros=a.createView=a.fromArray=a.fromValues=a.clone=a.create=void 0;a.create=function(){return[0,0]};a.clone=function(a){return[a[0],a[1]]};a.fromValues=function(a,l){return[a,l]};a.fromArray=function(a){for(var b=[0,0],k=Math.min(2,a.length),h=0;h<k;++h)b[h]=a[h];
return b};a.createView=function(a,l){return new Float64Array(a,l,2)};a.zeros=function(){return[0,0]};a.ones=function(){return[1,1]};a.unitX=function(){return[1,0]};a.unitY=function(){return[0,1]};a.ZEROS=[0,0];a.ONES=[1,1];a.UNIT_X=[1,0];a.UNIT_Y=[0,1]})},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["require","exports"],function(m,a){function b(a){return a instanceof Float32Array&&2<=a.length}function l(a){return Array.isArray(a)&&2<=a.length}Object.defineProperty(a,"__esModule",{value:!0});
a.isVec2=a.isVec2f64=a.isVec2f32=void 0;a.isVec2f32=b;a.isVec2f64=l;a.isVec2=function(a){return b(a)||l(a)}})},"esri/views/2d/viewpointUtils":function(){define("require exports tslib ../../Viewpoint ../../core/Collection ../../core/maybe ../../core/promiseUtils ../../core/unitUtils ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/geodesicConstants ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z){function A(a,c,b,e){return e&&b&&!e.equals(b)&&B.canProject(e,b)&&e.isWebMercator?(e.isWebMercator?(b=c[1],89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999),b=Math.sin(f.common.toRadian(b)),a=n.vec2.set(a,f.common.toRadian(c[0])*y.earthRadius,.5*y.earthRadius*Math.log((1+b)/(1-b)))):(b=f.common.toDegree(c[0]/y.earthRadius),a=n.vec2.set(a,b-360*Math.floor((b+180)/360),f.common.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*c[1]/y.earthRadius))))),a):
n.vec2.copy(a,c)}function C(a){return a.wkid?a:a.spatialReference||u.WGS84}function E(a,c){return c.type?n.vec2.set(a,c.x,c.y):n.vec2.copy(a,c)}function D(a,c){return Math.max(a.width/c[0],a.height/c[1])*S(a.spatialReference)}function F(a,c,e,d){return b.__awaiter(this,void 0,void 0,function(){var f,n,t,w,y,u,l,D,C,z,A,E,H,m,I,L,K,G,O,P,N,X,V,Q,T,W,R,r;return b.__generator(this,function(b){switch(b.label){case 0:if(!a||Array.isArray(a)&&!a.length)return[2,null];k.isCollection(a)&&(a=a.toArray());
if(!Array.isArray(a)||!a.length||"object"!==typeof a[0])return[3,7];n=a.every(function(a){return"attributes"in a});t=a.some(function(a){return!a.geometry});w=a;if(!(n&&t&&c&&c.allLayerViews))return[3,2];y=new Map;u=0;for(l=a;u<l.length;u++)D=l[u],C=D.layer,z=y.get(C)||[],A=D.attributes[C.objectIdField],null!=A&&z.push(A),y.set(C,z);E=[];y.forEach(function(a,b){var e=c.allLayerViews.find(function(a){return a.layer.id===b.id});if("queryFeatures"in e){var d=b.createQuery();d.objectIds=a;d.returnGeometry=
!0;E.push(e.queryFeatures(d))}});return[4,g.all(E)];case 1:H=b.sent();m=[];I=0;for(L=H;I<L.length;I++)if((K=L[I])&&K.features&&K.features.length)for(G=0,O=K.features;G<O.length;G++)D=O[G],h.isSome(D.geometry)&&m.push(D.geometry);w=m;b.label=2;case 2:P=0,N=w,b.label=3;case 3:if(!(P<N.length))return[3,6];X=N[P];return[4,F(X,c,e,d)];case 4:d=b.sent(),b.label=5;case 5:return P++,[3,3];case 6:return[2,d];case 7:if(!Array.isArray(a)||2!==a.length||"number"!==typeof a[0]||"number"!==typeof a[1])return[3,
8];f=new q(a);return[3,12];case 8:if(!(a instanceof p))return[3,9];f=a;return[3,12];case 9:if(!("geometry"in a))return[3,12];if(!a.geometry)return[3,10];f=a.geometry;return[3,12];case 10:if(!a.layer)return[3,12];V=a.layer;Q=c.allLayerViews.find(function(a){return a.layer.id===V.id});if(!("queryFeatures"in Q))return[3,12];T=V.createQuery();T.objectIds=[a.attributes[V.objectIdField]];T.returnGeometry=!0;return[4,Q.queryFeatures(T)];case 11:W=b.sent(),f=h.get(W,"features",0,"geometry"),b.label=12;case 12:if(h.isNone(f))return[2,
null];R="point"===f.type?new x({xmin:f.x,ymin:f.y,xmax:f.x,ymax:f.y,spatialReference:f.spatialReference}):f.extent;if(!R)return[2,null];r=B.canProject(R,e);if(!R.spatialReference.equals(e)&&r)R=B.project(R,e);else if(!r)return[2,null];d=d?d.union(R):R.clone();return[2,d]}})})}function H(a){if(a&&(!Array.isArray(a)||"number"!==typeof a[0])&&("object"===typeof a||Array.isArray(a)&&"object"===typeof a[0])){if("layer"in a&&a.layer&&a.layer.minScale&&a.layer.maxScale){var c=a.layer;return{min:c.minScale,
max:c.maxScale}}if(Array.isArray(a)&&a.length&&a.every(function(a){return"layer"in a})){for(var b=0,e=0,d=0;d<a.length;d++)(c=a[d].layer)&&c.minScale&&c.maxScale&&(b=c.minScale<b?c.minScale:b,e=c.maxScale>e?c.maxScale:e);return b&&e?{min:b,max:e}:null}}}function I(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g,p,n,h,k,w,y,u,m,I,L,K,G,O,P,N,Q;return b.__generator(this,function(b){switch(b.label){case 0:if(!a||!c)return[2,new l({targetGeometry:new q,scale:0,rotation:0})];e=c.spatialReference;
d=c.constraints;f=c.padding;g=c.viewpoint;p=c.size;n=f?p[0]-f.left-f.right:p[0];h=f?p[1]-f.top-f.bottom:p[1];k=[n,h];w=null;a instanceof l?w=a:a.viewpoint?w=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(w=a.target);y=null;if(!w||!w.targetGeometry)return[3,1];y=w.targetGeometry;return[3,10];case 1:if(!(a instanceof x))return[3,2];y=a;return[3,10];case 2:return a||a&&("center"in a||"extent"in a||"target"in a)?[4,F(a.center,c,e)]:[3,10];case 3:return(I=b.sent())?[3,5]:[4,F(a.extent,
c,e)];case 4:I=b.sent(),b.label=5;case 5:return(m=I)?[3,7]:[4,F(a.target,c,e)];case 6:m=b.sent(),b.label=7;case 7:return(u=m)?[3,9]:[4,F(a,c,e)];case 8:u=b.sent(),b.label=9;case 9:y=u,b.label=10;case 10:!y&&g&&g.targetGeometry?y=g.targetGeometry:!y&&c.extent&&(y=c.extent);L=C(y);e||(e=C(c.spatialReference||c.extent||y));if(!z.canProject(y,e)&&L&&!L.equals(e))return[2,null];K=E(t.vec2f64.create(),y.center?y.center:y);G=new q(A(K,K,L,e),e);O=null;O=w&&w.targetGeometry&&"point"===w.targetGeometry.type?
w.scale:a.hasOwnProperty("scale")&&a.scale?a.scale:a.hasOwnProperty("zoom")&&-1!==a.zoom&&d&&d.effectiveLODs?d.zoomToScale(a.zoom):Array.isArray(y)||"point"===y.type||"extent"===y.type&&0===y.width&&0===y.height?c.extent&&B.canProject(c.extent,e)?D(B.project(c.extent,e),k):c.extent?D(c.extent,k):g.scale:B.canProject(y.extent,e)?D(B.project(y.extent,e),k):D(y.extent,k);if(P=H(a))P.min&&P.min>O?O=P.min:P.max&&P.max<O&&(O=P.max);N=0;w?N=w.rotation:a.hasOwnProperty("rotation")?N=a.rotation:g&&(N=g.rotation);
Q=new l({targetGeometry:G,scale:O,rotation:N});d&&(Q=d.fit(Q),d.constrainByGeometry(Q),d.rotationEnabled||(Q.rotation=N));return[2,Q]}})})}function G(a,c){var b=a.targetGeometry,e=c.targetGeometry;b.x=e.x;b.y=e.y;b.spatialReference=e.spatialReference;a.scale=c.scale;a.rotation=c.rotation;return a}function K(a,c,b){return b?n.vec2.set(a,.5*(c[0]-b.right+b.left),.5*(c[1]-b.bottom+b.top)):n.vec2.scale(a,c,.5)}function L(b,e,d,f){a.getTransform(b,e,d,f);return c.mat2d.invert(b,b)}function O(a,c,b){var e=
N(c);c=Math.abs(Math.cos(e));e=Math.abs(Math.sin(e));return n.vec2.set(a,Math.round(b[1]*e+b[0]*c),Math.round(b[1]*c+b[0]*e))}function P(a){var c=a.scale;a=a.targetGeometry.spatialReference;a=w.isValid(a)?1/(39.37*d.getMetersPerUnitForSR(a)*96):1;return c*a}function N(a){return f.common.toRadian(a.rotation)||0}function S(a){return w.isValid(a)?39.37*d.getMetersPerUnitForSR(a)*96:1}function W(a){return a.isWrappable?(a=w.getInfo(a),a.valid[1]-a.valid[0]):0}Object.defineProperty(a,"__esModule",{value:!0});
a.translateBy=a.toScreen=a.toMap=a.padAndScaleAndRotateBy=a.scaleAndRotateBy=a.scaleTo=a.scaleBy=a.rotateTo=a.rotateBy=a.resize=a.pixelSize=a.centerAt=a.removePadding=a.addPadding=a.angleBetween=a.createAsync=a.getWorldScreenWidth=a.getWorldWidth=a.getTransformNoRotation=a.getTransform=a.getMatrix=a.getResolutionToScaleFactor=a.getResolution=a.getPaddingMapTranslation=a.getPaddingScreenTranslation=a.getOuterSize=a.getOuterExtent=a.setExtent=a.getExtent=a.getAnchor=a.copy=a.create=a.extentToScale=
void 0;var Q=180/Math.PI;a.extentToScale=D;a.create=I;a.copy=G;a.getAnchor=K;a.getExtent=function(){var a=t.vec2f64.create();return function(c,b,e){var d=b.targetGeometry;E(a,d);b=.5*P(b);c.xmin=a[0]-b*e[0];c.ymin=a[1]-b*e[1];c.xmax=a[0]+b*e[0];c.ymax=a[1]+b*e[1];c.spatialReference=d.spatialReference;return c}}();a.setExtent=function(c,b,e,d,f){a.centerAt(c,b,e.center);c.scale=D(e,d);f&&f.constraints&&f.constraints.constrain(c);return c};a.getOuterExtent=function(){var a=t.vec2f64.create(),c=t.vec2f64.create();
return function(b,e,d){E(a,e.targetGeometry);O(c,e,d);d=.5*P(e);b.set({xmin:a[0]-d*c[0],ymin:a[1]-d*c[1],xmax:a[0]+d*c[0],ymax:a[1]+d*c[1],spatialReference:e.targetGeometry.spatialReference});return b}}();a.getOuterSize=O;a.getPaddingScreenTranslation=function(){var a=t.vec2f64.create();return function(c,b,e){return n.vec2.sub(c,n.vec2.scale(c,b,.5),K(a,b,e))}}();a.getPaddingMapTranslation=function(){var b=e.mat2df64.create(),d=t.vec2f64.create();return function(e,f,g,p){var q=P(f);f=N(f);n.vec2.set(d,
q,q);c.mat2d.fromScaling(b,d);c.mat2d.rotate(b,b,f);c.mat2d.translate(b,b,a.getPaddingScreenTranslation(d,g,p));c.mat2d.translate(b,b,[0,p.top-p.bottom]);return n.vec2.set(e,b[4],b[5])}}();a.getResolution=P;a.getResolutionToScaleFactor=S;a.getMatrix=function(){var a=t.vec2f64.create(),b=t.vec2f64.create(),e=t.vec2f64.create();return function(d,f,g,p,q,h){n.vec2.negate(a,f);n.vec2.scale(b,g,.5*h);n.vec2.set(e,1/p*h,-1/p*h);c.mat2d.identity(d);c.mat2d.translate(d,d,b);q&&c.mat2d.rotate(d,d,q);c.mat2d.scale(d,
d,e);c.mat2d.translate(d,d,a);return d}}();a.getTransform=function(){var c=t.vec2f64.create();return function(b,e,d,f){var g=P(e),p=N(e);E(c,e.targetGeometry);return a.getMatrix(b,c,d,g,p,f)}}();a.getTransformNoRotation=function(){var c=t.vec2f64.create();return function(b,e,d,f){var g=P(e);E(c,e.targetGeometry);return a.getMatrix(b,c,d,g,0,f)}}();a.getWorldWidth=W;a.getWorldScreenWidth=function(a,c){return Math.round(W(a)/c)};a.createAsync=function(a,c){return I(a,c)};a.angleBetween=function(){var a=
t.vec2f64.create(),c=t.vec2f64.create(),b=[0,0,0];return function(e,d,f){n.vec2.subtract(a,e,d);n.vec2.normalize(a,a);n.vec2.subtract(c,e,f);n.vec2.normalize(c,c);n.vec2.cross(b,a,c);e=Math.acos(n.vec2.dot(a,c)/(n.vec2.length(a)*n.vec2.length(c)))*Q;0>b[2]&&(e=-e);isNaN(e)&&(e=0);return e}}();a.addPadding=function(){var c=t.vec2f64.create();return function(b,e,d,f){var g=b.targetGeometry;G(b,e);a.getPaddingMapTranslation(c,e,d,f);g.x+=c[0];g.y+=c[1];return b}}();a.removePadding=function(){var c=t.vec2f64.create();
return function(b,e,d,f){var g=b.targetGeometry;G(b,e);a.getPaddingMapTranslation(c,e,d,f);g.x-=c[0];g.y-=c[1];return b}}();a.centerAt=function(){var a=t.vec2f64.create();return function(c,b,e){G(c,b);b=c.targetGeometry;var d=C(e),f=C(b);E(a,e);A(a,a,d,f);b.x=a[0];b.y=a[1];return c}}();a.pixelSize=function(a){return P(a)};a.resize=function(){var c=t.vec2f64.create();return function(b,e,d,f,g){g||(g="center");n.vec2.sub(c,d,f);n.vec2.scale(c,c,.5);d=c[0];f=c[1];switch(g){case "center":n.vec2.set(c,
0,0);break;case "left":n.vec2.set(c,-d,0);break;case "top":n.vec2.set(c,0,f);break;case "right":n.vec2.set(c,d,0);break;case "bottom":n.vec2.set(c,0,-f);break;case "top-left":n.vec2.set(c,-d,f);break;case "bottom-left":n.vec2.set(c,-d,-f);break;case "top-right":n.vec2.set(c,d,f);break;case "bottom-right":n.vec2.set(c,d,-f)}a.translateBy(b,e,c);return b}}();a.rotateBy=function(a,c,b){G(a,c);a.rotation+=b;return a};a.rotateTo=function(a,c,b){G(a,c);a.rotation=b;return a};a.scaleBy=function(){var c=
t.vec2f64.create();return function(b,e,d,f,g){G(b,e);isNaN(d)||0===d||(a.toMap(c,f,e,g),b.scale=e.scale*d,a.toScreen(c,c,b,g),a.translateBy(b,b,n.vec2.set(c,c[0]-f[0],f[1]-c[1])));return b}}();a.scaleTo=function(a,c,b){G(a,c);a.scale=b;return a};a.scaleAndRotateBy=function(){var c=t.vec2f64.create();return function(b,e,d,f,g,p){G(b,e);isNaN(d)||0===d||(a.toMap(c,g,e,p),b.scale=e.scale*d,b.rotation+=f,a.toScreen(c,c,b,p),a.translateBy(b,b,n.vec2.set(c,c[0]-g[0],g[1]-c[1])));return b}}();a.padAndScaleAndRotateBy=
function(){var c=t.vec2f64.create(),b=t.vec2f64.create();return function(e,d,f,g,p,q,h){a.getPaddingScreenTranslation(b,q,h);n.vec2.add(c,p,b);return g?a.scaleAndRotateBy(e,d,f,g,c,q):a.scaleBy(e,d,f,c,q)}}();a.toMap=function(){var a=e.mat2df64.create();return function(c,b,e,d){return n.vec2.transformMat2d(c,b,L(a,e,d,1))}}();a.toScreen=function(){var c=e.mat2df64.create();return function(b,e,d,f){return n.vec2.transformMat2d(b,e,a.getTransform(c,d,f,1))}}();a.translateBy=function(){var a=t.vec2f64.create(),
b=e.mat2df64.create();return function(e,d,f){G(e,d);var g=P(d),p=e.targetGeometry;c.mat2d.fromRotation(b,N(d));c.mat2d.scale(b,b,t.vec2f64.fromValues(g,g));n.vec2.transformMat2d(a,f,b);p.x+=a[0];p.y+=a[1];return e}}()})},"esri/views/2d/layers/features/processors":function(){define(["require","exports","@dojo/framework/shim/Promise"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.loadProcessorModule=void 0;a.loadProcessorModule=function(a){return"heatmap"===a?new Promise(function(a,
b){m(["./processors/HeatmapProcessor"],a,b)}):new Promise(function(a,b){m(["./processors/SymbolProcessor"],a,b)})}})},"esri/views/2d/layers/features/controllers/FeatureController2D":function(){define("require exports tslib ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/promiseUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../FeatureStore2D ../Source2D ../support/AttributeStore ../support/ClusterStore ../support/ComputedAttributeStorage ../support/FeatureSetReaderJSON ../support/UpdateToken ../../../../support/QueueProcessor".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z){function A(a){if(!g.isAbortError(a)&&"worker:port-closed"!==a.name)throw a;}Object.defineProperty(a,"__esModule",{value:!0});m=function(a){function l(){var c=null!==a&&a.apply(this,arguments)||this;c._storage=new y.ComputedAttributeStorage;c._markedIdsBufId=c._storage.createBitset();c._lastCleanup=performance.now();c._cleanupNeeded=!1;c._invalidated=!1;c._tileToResolver=new Map;c.tileStore=null;c.config=null;c.processor=null;c.remoteClient=null;
c.service=null;c._editing=!1;return c}b.__extends(l,a);l.prototype.initialize=function(){var a=this;this._initAttributeStore();this._initStores();this._initQueryEngine();this._initSource();this._updateQueue=new z.QueueProcessor({concurrency:4,process:function(c,b){return a._onDisplayTilePatch(c,{signal:b})}});this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this)),this.watch("updating",function(c){return!c&&a.onIdle()})])};l.prototype.startup=function(){return b.__awaiter(this,
void 0,void 0,function(){return b.__generator(this,function(a){this._initAttributeStore();return[2]})})};l.prototype._initSource=function(){var a=this;this._source=new p.Source2D(this.service,this.spatialReference,this.tileStore.tileScheme);this._source.onDisplayTilePatch=function(c,b){a._invalidated=!0;return a._patchTile(c,b)};this._source.canAcceptPatch=function(){return 50>a._updateQueue.length};var c=this._source.sourceEvents;"geoevent"===c.type&&(c=c.events,this.handles.add([c.on("connectionStatus",
function(c){return a.remoteClient.invoke("setProperty",{propertyName:"connectionStatus",value:c}).catch(A)}),c.on("errorString",function(c){return a.remoteClient.invoke("setProperty",{propertyName:"errorString",value:c}).catch(A)}),c.on("feature",function(c){return a.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:c.attributes,centroid:c.centroid,geometry:c.geometry}}).catch(A)}),c.on("updateRate",function(c){return a.remoteClient.invoke("emitEvent",{name:"update-rate",event:b.__assign({},
c)}).catch(A)})]))};l.prototype._initAttributeStore=function(){var a=this;this.attributeStore?this.attributeStore.invalidateResources():this.attributeStore=new q.default({type:"remote",initialize:function(c,b){return d.ignoreAbortErrors(a.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",c,{signal:b}).catch(A))},update:function(c,b){return d.ignoreAbortErrors(a.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",c,{signal:b}).catch(A))},render:function(c){return d.ignoreAbortErrors(a.remoteClient.invoke("tileRenderer.featuresView.requestRender",
void 0,{signal:c}).catch(A))}})};l.prototype._initStores=function(){var a=this,c={geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields};this.featureStore=new x.FeatureStore2D(c,this._storage);this.aggregateStore=new u.ClusterStore(c,this.spatialReference,this._storage);this.handles.add(this.aggregateStore.events.on("valueRangesChanged",function(c){a.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",
event:{valueRanges:c.valueRanges}}).catch(A)}))};l.prototype._initQueryEngine=function(){var a;null===(a=this.queryEngine)||void 0===a?void 0:a.destroy();this.queryEngine=new n.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:this.featureStore,timeInfo:this.service.timeInfo})};l.prototype.destroy=
function(){this._updateQueue.destroy();this._source.destroy();this.queryEngine.destroy();this.attributeStore&&this.attributeStore.destroy()};Object.defineProperty(l.prototype,"fieldsIndex",{get:function(){return new t(this.service.fields)},enumerable:!1,configurable:!0});Object.defineProperty(l.prototype,"hasAggregates",{get:function(){return!!this.config.schema.targets.aggregate},enumerable:!1,configurable:!0});Object.defineProperty(l.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},
enumerable:!1,configurable:!0});Object.defineProperty(l.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!1,configurable:!0});l.prototype.isUpdating=function(){return this._source.updating||!!this._updateQueue.length};l.prototype.enableEvent=function(a){this._source.enableEvent(a.name,a.value)};l.prototype.invalidate=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,d,p,n,q=this;return b.__generator(this,function(b){switch(b.label){case 0:if(!a.any())return[2];
k("esri-2d-update-debug")&&a.describe();c=this.tileStore.tiles.map(function(a){a=a.key;var c=g.createResolver();q._tileToResolver.set(a.id,c);return c.promise});e=this._updateQueue.takeAll();this._updateQueue.resume();if(!(this.hasAggregates&&a.mesh&&a.targets.aggregate)||a.queryFilter)return[3,1];this._repushAggregateMeshTiles(a);return[3,3];case 1:return this._source.resubscribe(a),g.all(c).then(function(){q._source.resume()}),a.mesh?[4,f.whenFalseOnce(this,"updating")]:[3,3];case 2:b.sent(),b.label=
3;case 3:return this.notifyChange("updating"),[4,g.all(c)];case 4:b.sent();this._updateQueue.pause();d=0;for(p=e;d<p.length;d++)n=p[d],this._patchTile(n);a.source&&(this._cleanupNeeded=!0);return[2]}})})};l.prototype.resume=function(){this._updateQueue.resume();return this._source.resume()};l.prototype.update=function(a,c,e){void 0===e&&(e=!1);return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){switch(b.label){case 0:return this._editing?[4,f.whenFalseOnce(this,
"updating")]:[3,2];case 1:b.sent(),b.label=2;case 2:return e&&(this._source.pause(),this._updateQueue.pause()),this._set("config",c),this._schema=c.schema,this._initQueryEngine(),[4,g.all([this._source.update(a,c.schema.source),this.featureStore.updateSchema(a,c.schema.targets.feature),this.attributeStore.update(a,c.schema.processors[0].storage),this.attributeStore.updateFilters(a,this)])];case 3:return b.sent(),[4,this.aggregateStore.updateSchema(a,c.schema.targets.aggregate)];case 4:return b.sent(),
[2]}})})};l.prototype.refresh=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){switch(a.label){case 0:return this._source.resubscribe(B.UpdateToken.all(),!0),this._cleanupNeeded=!0,this.notifyChange("updating"),[4,f.whenFalseOnce(this,"updating",!0)];case 1:return a.sent(),[2]}})})};l.prototype.onTileUpdate=function(a){this.aggregateStore.onTileUpdate(a);for(var c=0,b=a.added;c<b.length;c++){var e=b[c];this._source.subscribe(e);this._level=e.level}c=
0;for(a=a.removed;c<a.length;c++)b=a[c],this._source.unsubscribe(b),this._cleanupNeeded=!0,this._tileToResolver.has(b.id)&&(this._tileToResolver.get(b.id).resolve(),this._tileToResolver.delete(b.id));this.notifyChange("updating")};l.prototype.onIdle=function(){this.hasAggregates&&this._invalidated&&(this._repushAggregateMeshTiles(),this._invalidated=!1);this._markAndSweep()};l.prototype.onEdits=function(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(c){switch(c.label){case 0:return this._editing?
[4,f.whenFalseOnce(this,"updating")]:[3,2];case 1:return c.sent(),[2,this.onEdits(a)];case 2:return this._editing=!0,[4,this._source.onEdits(a)];case 3:return c.sent(),[4,f.whenFalseOnce(this,"updating")];case 4:return c.sent(),this._editing=!1,[2]}})})};l.prototype.queryExtent=function(a){return this.queryEngine.executeQueryForExtent(a)};l.prototype.queryFeatures=function(a){return this.queryEngine.executeQuery(a)};l.prototype.queryFeatureCount=function(a){return this.queryEngine.executeQueryForCount(a)};
l.prototype.queryLatestObservations=function(a){return this.queryEngine.executeQueryForLatestObservations(a)};l.prototype.queryObjectIds=function(a){return this.queryEngine.executeQueryForIds(a)};l.prototype.queryStatistics=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){return[2,b.__assign(b.__assign({},this.featureStore.storeStatistics),{displayedFeatureCount:0,displayedVertexCount:0,displayPreProcessTime:0})]})})};l.prototype.getObjectId=function(a){return this.featureStore.lookupObjectId(a,
this._storage)};l.prototype.getDisplayId=function(a){if(this._schema.targets.aggregate){var c=this.aggregateStore.getDisplayId(a);return h.isNone(c)?(a=this.featureStore.lookupDisplayId(a),this.aggregateStore.getDisplayIdForReferenceId(a)):c}return this.featureStore.lookupDisplayId(a)};l.prototype.getFeature=function(a){a=this.featureStore.lookupFeatureByDisplayId(a,this._storage);if(h.isNone(a))return null;var c=a.readHydratedGeometry(),c=e.convertToGeometry(c,a.geometryType,a.hasZ,a.hasM);return{attributes:a.readAttributes(),
geometry:c}};l.prototype.getAggregate=function(a){return this.aggregateStore.getAggregate(a)};l.prototype.setHighlight=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e=this;return b.__generator(this,function(b){c=a.map(function(a){return e.getDisplayId(a)});return[2,this.attributeStore.setHighlight(a,c)]})})};l.prototype._repushAggregateMeshTiles=function(a){for(var c=0,b=this.tileStore.tiles;c<b.length;c++)this._patchTile({type:"replace",id:b[c].key.id,addOrUpdate:w.FeatureSetReaderJSON.fromOptimizedFeatures([],
this.service.geometryType),remove:[],end:!0,noData:!1,update:a||B.UpdateToken.create({mesh:!0,targets:{aggregate:!0}})})};l.prototype._maybeForceCleanup=function(){5E3<performance.now()-this._lastCleanup&&this._markAndSweep()};l.prototype._patchTile=function(a,c){var b=this;a=this._updateQueue.push(a,c).then(function(){b.notifyChange("updating")}).catch(function(a){b.notifyChange("updating")});this.notifyChange("updating");return a};l.prototype._onDisplayTilePatch=function(a,c){return b.__awaiter(this,
void 0,void 0,function(){var e,d,f,p,n,q,k,w,t;return b.__generator(this,function(y){switch(y.label){case 0:e=this.tileStore.get(a.id);d=a.update;a.remove.length&&(this._cleanupNeeded=!0);f=[];p=0;for(n=a.remove;p<n.length;p++)q=n[p],f.push(this.featureStore.lookupDisplayId(q));a.remove=f;g.throwIfAborted(c);y.label=1;case 1:y.trys.push([1,7,,8]);if(h.isNone(a.addOrUpdate))return this.processor.onTileData(e,b.__assign(b.__assign({},a),{addOrUpdate:null}),c).catch(function(a){g.throwIfNotAbortError(a)}),
this._finishedPatch(a),[2];a.addOrUpdate._storage=this._storage;k=a.addOrUpdate.hasFilter();w=a.addOrUpdate.instance;a.addOrUpdate._arcadeSpatialReference=this.spatialReference;if(!this.featureStore.hasInstance(w)||d.targets.feature&&!k)this.featureStore.onTileData(e,a,this._storage);if(!d.storage.data&&!d.storage.filters||k)return[3,4];this.attributeStore.onTileData(e,a);return this._source.isStream?[4,this.attributeStore.sendUpdates()]:[3,3];case 2:return y.sent(),[3,4];case 3:this.attributeStore.sendUpdates(),
y.label=4;case 4:return this.hasAggregates&&d.targets.aggregate&&(this.aggregateStore.onTileData(e,a,this._storage,this.featureStore,this.attributeStore,d.mesh),d.mesh&&(this.attributeStore.onTileData(e,a),this.attributeStore.sendUpdates())),d.mesh?[4,this.processor.onTileData(e,a,c)]:[3,6];case 5:y.sent(),y.label=6;case 6:return this._maybeForceCleanup(),this._finishedPatch(a),[3,8];case 7:return t=y.sent(),g.throwIfNotAbortError(t),[3,8];case 8:return[2]}})})};l.prototype._finishedPatch=function(a){(a.noData||
a.end)&&this._tileToResolver.has(a.id)&&(this._tileToResolver.get(a.id).resolve(),this._tileToResolver.delete(a.id))};l.prototype._markAndSweep=function(){var a=this;this._lastCleanup=performance.now();if(this._cleanupNeeded||this._source.isStream){this._cleanupNeeded=!1;var c=this._storage.getBitset(this._markedIdsBufId),b=new Set;c.clear();for(var e=function(e){e=a.featureStore.lookupDisplayId(e);var d=a._storage.getInstanceId(e);e&&(b.add((4294901760&d)>>>16),c.set(e))},d=0,f=this.tileStore.tiles;d<
f.length;d++)this._source.forEachRequest(f[d].key.id,function(a){if(!h.isNone(a.features))for(a=a.features.getCursor();a.next();){var c=a.getObjectId();e(c)}});this._source.forEachPendingEdit(function(a){return e(a)});this._updateQueue.forEach(function(a){var c=0;for(a=a.remove;c<a.length;c++)e(a[c])});this.config.schema.targets.aggregate&&(this.aggregateStore.sweepFeatures(c,this.featureStore),this.aggregateStore.sweepClusters(this._storage,this._level));this.featureStore.sweepFeatures(c,this._storage);
this.featureStore.sweepFeatureSets(b)}};b.__decorate([c.property({constructOnly:!0})],l.prototype,"tileStore",void 0);b.__decorate([c.property()],l.prototype,"config",void 0);b.__decorate([c.property({readOnly:!0,dependsOn:["service"]})],l.prototype,"fieldsIndex",null);b.__decorate([c.property()],l.prototype,"processor",void 0);b.__decorate([c.property({constructOnly:!0})],l.prototype,"remoteClient",void 0);b.__decorate([c.property({constructOnly:!0})],l.prototype,"service",void 0);b.__decorate([c.property({dependsOn:["tileStore"]})],
l.prototype,"spatialReference",null);b.__decorate([c.property()],l.prototype,"updating",null);return l=b.__decorate([c.subclass("esri.views.2d.layers.features.controllers.FeatureController2D")],l)}(l.HandleOwner);a.default=m})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(m,a,b,l,k,h,g,d){function f(a,c){return a?
c?4:3:c?3:2}function c(a,c,b,e){if(a){if(b)return c&&e?ea:Z;if(c&&e)return ga}else if(c&&e)return Z;return ca}function e(a,c){return Math.round((c-a.translate[0])/a.scale[0])}function n(a,c){return Math.round((a.translate[1]-c)/a.scale[1])}function t(a,c){return c*a.scale[0]+a.translate[0]}function x(a,c){return a.translate[1]-c*a.scale[1]}function p(a){a=a.coords;return{x:a[0],y:a[1]}}function q(a,c){a.coords[0]=c.x;a.coords[1]=c.y;return a}function u(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function y(a,
c){a.coords[0]=c.x;a.coords[1]=c.y;a.coords[2]=c.z;return a}function w(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function B(a,c){a.coords[0]=c.x;a.coords[1]=c.y;a.coords[2]=c.m;return a}function z(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function A(a,c){a.coords[0]=c.x;a.coords[1]=c.y;a.coords[2]=c.z;a.coords[3]=c.m;return a}function C(a,c){return a&&c?A:a?y:c?B:q}function E(a,c,b,e,f){b=C(b,e);for(e=0;e<c.length;e++){var g=c[e],p=g.geometry,g=g.attributes,n=void 0;p&&(n=b(new d.default,
p));a.push(new h.default(n,g,null,g[f]))}return a}function D(a,c,b,e){for(var d=0;d<c.length;d++){var f=c[d],g=f.geometry,f=f.attributes,p=void 0;g&&(p=F(g,b,e));a.push({attributes:f,geometry:p})}return a}function F(a,c,b){if(!a)return null;for(var e=f(c,b),d=[],g=0;g<a.coords.length;g+=e){for(var p=[],n=0;n<e;n++)p.push(a.coords[g+n]);d.push(p)}return c?b?{points:d,hasZ:c,hasM:b}:{points:d,hasZ:c}:b?{points:d,hasM:b}:{points:d}}function H(a,c,b,e,g){b=f(b,e);for(e=0;e<c.length;e++){var p=c[e],n=
p.geometry,p=p.attributes,q=void 0;n&&(q=I(new d.default,n,b));a.push(new h.default(q,p,null,p[g]))}return a}function I(a,c,b){void 0===b&&(b=f(c.hasZ,c.hasM));a.lengths[0]=c.points.length;var e=a.coords,d=0,g=0;for(c=c.points;g<c.length;g++)for(var p=c[g],n=0;n<b;n++)e[d++]=p[n];return a}function G(a,c,b){if(!a)return null;var e=f(c,b),d=a.coords,g=[],p=0,n=0;for(a=a.lengths;n<a.length;n++){for(var q=a[n],h=[],k=0;k<q;k++){for(var w=[],t=0;t<e;t++)w.push(d[p++]);h.push(w)}g.push(h)}return c?b?{paths:g,
hasZ:c,hasM:b}:{paths:g,hasZ:c}:b?{paths:g,hasM:b}:{paths:g}}function K(a,c,b,e,g){b=f(b,e);for(e=0;e<c.length;e++){var p=c[e],n=p.geometry,p=p.attributes,q=void 0;n&&(q=L(new d.default,n,b));a.push(new h.default(q,p,null,p[g]))}return a}function L(a,c,b){void 0===b&&(b=f(c.hasZ,c.hasM));var e=a.lengths,d=a.coords,g=0,p=0;for(c=c.paths;p<c.length;p++){for(var n=c[p],q=0,h=n;q<h.length;q++)for(var k=h[q],w=0;w<b;w++)d[g++]=k[w];e.push(n.length)}return a}function O(a,c,b){if(!a)return null;var e=f(c,
b),d=a.coords,g=[],p=0,n=0;for(a=a.lengths;n<a.length;n++){for(var q=a[n],h=[],k=0;k<q;k++){for(var w=[],t=0;t<e;t++)w.push(d[p++]);h.push(w)}g.push(h)}return c?b?{rings:g,hasZ:c,hasM:b}:{rings:g,hasZ:c}:b?{rings:g,hasM:b}:{rings:g}}function P(a,c,b,e,f){for(var g=0;g<c.length;g++){var p=c[g],n=p.geometry,k=p.centroid,p=p.attributes,w=void 0;n&&(w=N(new d.default,n,b,e));k?a.push(new h.default(w,p,q(new d.default,k),p[f])):a.push(new h.default(w,p,null,p[f]))}return a}function N(a,c,b,e){void 0===
b&&(b=c.hasZ);void 0===e&&(e=c.hasM);S(a,c.rings,b,e);return a}function S(a,c,b,e){b=f(b,e);e=a.lengths;for(var d=a.coords,g=0,p=e.length=d.length=0;p<c.length;p++){for(var n=c[p],q=0,h=n;q<h.length;q++)for(var k=h[q],w=0;w<b;w++)d[g++]=k[w];e.push(n.length)}return a}function W(a,c,e,d,f,g){a.length=0;if(!e){for(e=0;e<c.length;e++)d=c[e],a.push(new h.default(null,d.attributes,null,d.attributes[g]));return a}switch(e){case "esriGeometryPoint":return E(a,c,d,f,g);case "esriGeometryMultipoint":return H(a,
c,d,f,g);case "esriGeometryPolyline":return K(a,c,d,f,g);case "esriGeometryPolygon":return P(a,c,d,f,g);default:fa.error("convertToFeatureSet:unknown-geometry",new b("Unable to parse unknown geometry type '"+e+"'")),a.length=0}return a}function Q(a,c,e,d){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(c){case "esriGeometryPoint":return c=p,e&&d?c=z:e?c=u:d&&(c=w),c(a);case "esriGeometryMultipoint":return F(a,e,d);case "esriGeometryPolyline":return G(a,e,d);case "esriGeometryPolygon":return O(a,
e,d);default:fa.error("convertToGeometry:unknown-geometry",new b("Unable to parse unknown geometry type '"+c+"'"))}}function V(a,c,e,d,f){a.length=0;switch(e){case "esriGeometryPoint":e=p;d&&f?e=z:d?e=u:f&&(e=w);for(d=0;d<c.length;d++){var g=c[d];f=g.geometry;g=g.attributes;f=f?e(f):null;a.push({attributes:g,geometry:f})}break;case "esriGeometryMultipoint":return D(a,c,d,f);case "esriGeometryPolyline":for(e=0;e<c.length;e++){var n=c[e],g=n.geometry,n=n.attributes,q=void 0;g&&(q=G(g,d,f));a.push({attributes:n,
geometry:q})}break;case "esriGeometryPolygon":for(e=0;e<c.length;e++){var q=c[e],n=q.geometry,g=q.attributes,h=q.centroid,q=void 0;n&&(q=O(n,d,f));h?(n=p(h),a.push({attributes:g,centroid:n,geometry:q})):a.push({attributes:g,geometry:q})}break;default:fa.error("convertToFeatureSet:unknown-geometry",new b("Unable to parse unknown geometry type '"+e+"'"))}return a}function R(a,b,d,g,p,q,h,k){void 0===h&&(h=d);void 0===k&&(k=g);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=
0);if(!b||!b.coords.length)return null;p=aa[p];var w=b.coords;b=b.lengths;var t=f(d,g),y=f(d&&h,g&&k);d=c(d,g,h,k);if(!b.length)return d(a.coords,w,0,0,e(q,w[0]),n(q,w[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=t,a;for(var u,l=0,x,C=0,B=0;B<b.length;B++){var z=b[B];if(!(z<p)){var A=0;x=C;k=g=e(q,w[l]);u=h=n(q,w[l+1]);d(a.coords,w,x,l,k,u);A++;l+=t;x+=y;for(var D=1;D<z;D++,l+=t)if(k=e(q,w[l]),u=n(q,w[l+1]),k!==g||u!==h)d(a.coords,w,x,l,k-g,u-h),x+=y,A++,g=k,h=u;A>=p&&(a.lengths.push(A),
C=x)}}a.coords.length=C;return a.coords.length?a:null}function T(a,c,b,e,d,f,g){for(var p=e,n=0,q,h=f+b;h<g;h+=b){q=c[h];var k=c[h+1],w=c[g],t=c[g+1],y=c[f],u=c[f+1],l=w-y,x=t-u;if(0!==l||0!==x){var C=((q-y)*l+(k-u)*x)/(l*l+x*x);1<C?(y=w,u=t):0<C&&(y+=l*C,u+=x*C)}l=q-y;x=k-u;q=l*l+x*x;q>p&&(n=h,p=q)}p>e&&(n-f>b&&T(a,c,b,e,d,f,n),d(a,c,a.length,n,c[n],c[n+1]),g-n>b&&T(a,c,b,e,d,n,g))}function X(a,c,b,e,d){var g=c.coords,p=c.lengths,n=b?e?ea:Z:e?Z:ca;b=f(b,e);if(!g.length)return a!==c&&(a.lengths.length=
0,a.coords.length=0),a;if(!p.length)return n(a.coords,g,0,0,t(d,g[0]),x(d,g[1])),a!==c&&(a.lengths.length=0,a.coords.length=b),a;var q=d.scale;e=q[0];for(var q=q[1],h=0,k=0;k<p.length;k++){var w=p[k];a.lengths[k]=w;var y=t(d,g[h]),u=x(d,g[h+1]);n(a.coords,g,h,h,y,u);for(var h=h+b,l=1;l<w;l++,h+=b)y+=g[h]*e,u-=g[h+1]*q,n(a.coords,g,h,h,y,u)}a!==c&&(a.lengths.length=p.length,a.coords.length=g.length);return a}function da(a,c,b,e){for(var d=0,f=a[e*c],g=a[e*(c+1)],p=1;p<b;p++)var n=f+a[e*(c+p)],q=g+
a[e*(c+p)+1],h=(n-f)*(q+g),f=n,g=q,d=d+h;return.5*d}Object.defineProperty(a,"__esModule",{value:!0});a.deltaDecodeGeometry=a.deltaEncodeGeometry=a.getQuantizedArea=a.getSignedQuantizedRingArea=a.removeCollinearVectices=a.removeZMValues=a.unquantizeOptimizedGeometry=a.getQuantizedBoundsOptimizedGeometry=a.getBoundsOptimizedGeometry=a.generalizeOptimizedGeometry=a.quantizeOptimizedGeometry=a.quantizeOptimizedFeatureSet=a.unquantizeOptimizedFeatureSet=a.convertFromFeatureSet=a.convertToFeatureSet=a.convertToFeatures=
a.convertToGeometry=a.convertFromGeometry=a.convertToFeature=a.convertFromGraphics=a.convertFromFeatures=a.convertFromFeature=a.convertFromNestedArray=a.convertFromPolygon=a.convertToPolygon=a.convertFromPolyline=a.convertFromPolylineFeatures=a.convertToPolyline=a.convertFromMultipoint=a.convertFromMultipointFeatures=a.convertToMultipoint=a.convertToMultipointFeatures=a.convertFromPoint=a.convertFromPointFeatures=a.convertToPoint=a.unquantizeY=a.unquantizeX=a.quantizeY=a.quantizeX=void 0;var fa=l.getLogger("esri.tasks.support.optimizedFeatureSet"),
aa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},ca=function(a,c,b,e,d,f){a[b]=d;a[b+1]=f},Z=function(a,c,b,e,d,f){a[b]=d;a[b+1]=f;a[b+2]=c[e+2]},ga=function(a,c,b,e,d,f){a[b]=d;a[b+1]=f;a[b+2]=c[e+3]},ea=function(a,c,b,e,d,f){a[b]=d;a[b+1]=f;a[b+2]=c[e+2];a[b+3]=c[e+3]};a.quantizeX=e;a.quantizeY=n;a.unquantizeX=t;a.unquantizeY=x;a.convertToPoint=function(a,c,b){return a?c?b?z(a):u(a):b?w(a):p(a):null};a.convertFromPointFeatures=E;a.convertFromPoint=function(a,
c,b){void 0===b&&(b=C(null!=c.z,null!=c.m));return b(a,c)};a.convertToMultipointFeatures=D;a.convertToMultipoint=F;a.convertFromMultipointFeatures=H;a.convertFromMultipoint=I;a.convertToPolyline=G;a.convertFromPolylineFeatures=K;a.convertFromPolyline=L;a.convertToPolygon=O;a.convertFromPolygon=N;a.convertFromNestedArray=S;var la=[],ja=[];a.convertFromFeature=function(a,c,b,e,d){la[0]=a;a=W(ja,la,c,b,e,d)[0];la.length=ja.length=0;return a};a.convertFromFeatures=W;a.convertFromGraphics=function(a,c,
e,d,f,g){var p=a.length;switch(e){case "esriGeometryPoint":E(a,c,d,f,g);break;case "esriGeometryMultipoint":H(a,c,d,f,g);break;case "esriGeometryPolyline":K(a,c,d,f,g);break;case "esriGeometryPolygon":P(a,c,d,f,g);break;default:fa.error("convertToFeatureSet:unknown-geometry",new b("Unable to parse unknown geometry type '"+e+"'"))}for(d=0;d<c.length;d++)a[d+p].geometryType=e,a[d+p].insertAfter=c[d].insertAfter,a[d+p].groupId=c[d].groupId;return a};a.convertToFeature=function(a,c,b,e){ja[0]=a;V(la,
ja,c,b,e);a=la[0];la.length=ja.length=0;return a};a.convertFromGeometry=function(a,c,e){if(!a)return null;var g=new d.default;"hasZ"in a&&null==c&&(c=a.hasZ);"hasM"in a&&null==e&&(e=a.hasM);if(k.isPoint(a))return C(null!=c?c:null!=a.z,null!=e?e:null!=a.m)(g,a);if(k.isPolygon(a))return N(g,a,c,e);if(k.isPolyline(a))return L(g,a,f(c,e));if(k.isMultipoint(a))return I(g,a,f(c,e));fa.error("convertFromGeometry:unknown-geometry",new b("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=
Q;a.convertToFeatures=V;a.convertToFeatureSet=function(a){var c=a.objectIdFieldName,b=a.spatialReference,e=a.transform,d=a.fields,f=a.hasM,g=a.hasZ,p=a.geometryType,n=a.exceededTransferLimit,q=a.uniqueIdField,h=a.queryGeometry,k=a.queryGeometryType;a=V([],a.features,p,g,f);h=Q(h,k,!1,!1);c={features:a,fields:d,geometryType:p,objectIdFieldName:c,spatialReference:b,uniqueIdField:q,queryGeometry:h};e&&(c.transform=e);n&&(c.exceededTransferLimit=n);f&&(c.hasM=f);g&&(c.hasZ=g);return c};a.convertFromFeatureSet=
function(a,c){var e=new g.default,d=a.hasM,f=a.hasZ,p=a.features,n=a.objectIdFieldName,q=a.spatialReference,h=a.geometryType,k=a.exceededTransferLimit,w=a.transform;if(a=a.fields)e.fields=a;e.geometryType=h;e.objectIdFieldName=n||c;e.spatialReference=q;if(!e.objectIdFieldName)return fa.error(new b("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),e;p&&W(e.features,p,h,f,d,e.objectIdFieldName);k&&(e.exceededTransferLimit=k);d&&(e.hasM=d);f&&(e.hasZ=f);w&&(e.transform=
w);return e};a.unquantizeOptimizedFeatureSet=function(a){var c=a.transform,b=a.hasM,e=a.hasZ;if(!c)return a;for(var d=0,f=a.features;d<f.length;d++){var g=f[d];g.geometry&&X(g.geometry,g.geometry,b,e,c);g.centroid&&X(g.centroid,g.centroid,b,e,c)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,c){var b=c.geometryType,e=c.features,f=c.hasM,g=c.hasZ;if(!a)return c;for(var p=0;p<e.length;p++){var n=e[p],q=n.weakClone();q.geometry=new d.default;R(q.geometry,n.geometry,f,g,b,a);n.centroid&&
(q.centroid=new d.default,R(q.centroid,n.centroid,f,g,"esriGeometryPoint",a));e[p]=q}c.transform=a;return c};a.quantizeOptimizedGeometry=R;a.generalizeOptimizedGeometry=function(a,b,e,d,g,p,n,q){void 0===n&&(n=e);void 0===q&&(q=d);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;g=aa[g];var h=b.coords;b=b.lengths;var k=f(e,d),w=f(e&&n,d&&q);e=c(e,d,n,q);if(!b.length)return e(a.coords,h,0,0,h[0],h[1]),a.lengths.length&&(a.lengths.length=
0),a.coords.length=k,a;d=0;p*=p;for(n=0;n<b.length;n++){q=b[n];if(!(q<g)){var t=a.coords.length/w,y=d,u=d+(q-1)*k;e(a.coords,h,a.coords.length,y,h[y],h[y+1]);T(a.coords,h,k,p,e,y,u);e(a.coords,h,a.coords.length,u,h[u],h[u+1]);y=a.coords.length/w-t;y>=g?a.lengths.push(y):a.coords.length=t*w}d+=q*k}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,c,b,e){if(!c||!c.coords||!c.coords.length)return null;b=f(b,e);var d=e=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,p=Number.NEGATIVE_INFINITY;
if(c&&c.coords){c=c.coords;for(var n=0;n<c.length;n+=b){var q=c[n],h=c[n+1];e=Math.min(e,q);g=Math.max(g,q);d=Math.min(d,h);p=Math.max(p,h)}}a[0]=e;a[1]=d;a[2]=g;a[3]=p;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,c,b,e){b=f(b,e);e=c.coords;var d=Number.POSITIVE_INFINITY,g=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY,q=0,h=0;for(c=c.lengths;h<c.length;h++)for(var k=c[h],w=e[q],t=e[q+1],d=Math.min(w,d),g=Math.min(t,g),p=Math.max(w,p),n=Math.max(t,n),
q=q+b,y=1;y<k;y++,q+=b){var u=e[q],l=e[q+1],w=w+u,t=t+l;0>u&&(d=Math.min(d,w));0<u&&(p=Math.max(p,w));0>l?g=Math.min(g,t):0<l&&(n=Math.max(n,t))}a[0]=d;a[1]=g;a[2]=p;a[3]=n;return a};a.unquantizeOptimizedGeometry=X;a.removeZMValues=function(a,b,e,d,g,p){var n,q=f(e,d);e=c(e,d,g,p);d=b.coords;a.coords.length=0;a.lengths.length=0;(n=a.lengths).push.apply(n,b.lengths);for(b=0;b<d.length;b+=q)e(a.coords,d,a.coords.length,b,d[b],d[b+1]);return a};a.removeCollinearVectices=function(a,b,e,d,g){if(!b||!b.coords||
!b.coords.length)return null;e=aa[e];var p=b.coords;b=b.lengths;var n=c(d,g,d,g);d=f(d,g);for(var q=g=0,h=0,k=0,w=0;w<b.length;w++){var t=b[w],q=k;n(a.coords,p,q,g,p[g],p[g+1]);g+=d;var y=p[g],u=p[g+1],l=y,x=u,C=u/y,q=q+d;n(a.coords,p,q,g,l,x);g+=d;for(var B=2;B<t;B++){var y=p[g],u=p[g+1],z=u/y,A=C===z||!isFinite(C)&&!isFinite(z),C=A&&isFinite(z)?0<=C&&0<=z||0>=C&&0>=z:0<=x&&0<=u||0>=x&&0>=u;A&&C?(l+=y,x+=u):(l=y,x=u,q+=d);n(a.coords,p,q,g,l,x);g+=d;C=z}q+=d;t=(q-k)/d;t>=e&&(a.lengths[h]=t,k=q,h++)}a.coords.length>
k&&(a.coords.length=k);a.lengths.length>h&&(a.lengths.length=h);return a.coords.length&&a.lengths.length?a:null};a.getSignedQuantizedRingArea=da;a.getQuantizedArea=function(a,c){var b=a.coords;a=a.lengths;for(var e=0,d=0,f=0;f<a.length;f++)d+=da(b,e,a[f],c),e+=f;return Math.abs(d)};a.deltaEncodeGeometry=function(a,c){var b=a.clone(),e=a.coords;a=a.lengths;for(var d=0,f=0;f<a.length;f++){for(var g=a[f],p=e[c*d],n=e[c*d+1],q=1;q<g;q++){var h=e[c*(d+q)],k=e[c*(d+q)+1],n=k-n;b.coords[c*(d+q)]=h-p;b.coords[c*
(d+q)+1]=n;p=h;n=k}d+=g}return b};a.deltaDecodeGeometry=function(a,c){var b=a.clone(),e=a.coords;a=a.lengths;for(var d=0,f=0;f<a.length;f++){for(var g=a[f],p=e[c*d],n=e[c*d+1],q=1;q<g;q++)p+=e[c*(d+q)],n+=e[c*(d+q)+1],b.coords[c*(d+q)]=p,b.coords[c*(d+q)+1]=n;d+=g}return b}})},"esri/layers/graphics/OptimizedFeature":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a,b,h,g){void 0===a&&(a=null);void 0===b&&(b={});this.displayId=
0;this.geohashIndexed=!1;this.geohashY=this.geohashX=0;this.geometry=a;b&&(this.attributes=b);h&&(this.centroid=h);null!=g&&(this.objectId=g)}Object.defineProperty(a.prototype,"hasGeometry",{get:function(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)},enumerable:!1,configurable:!0});a.prototype.weakClone=function(){var b=new a(this.geometry,this.attributes,this.centroid,this.objectId);b.displayId=this.displayId;b.geohashIndexed=this.geohashIndexed;b.geohashX=this.geohashX;
b.geohashY=this.geohashY;return b};return a}();a.default=m})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=
this.uniqueIdField=null}a.prototype.weakClone=function(){var b=new a;b.objectIdFieldName=this.objectIdFieldName;b.globalIdFieldName=this.globalIdFieldName;b.geohashFieldName=this.geohashFieldName;b.geometryProperties=this.geometryProperties;b.geometryType=this.geometryType;b.spatialReference=this.spatialReference;b.hasZ=this.hasZ;b.hasM=this.hasM;b.features=this.features;b.fields=this.fields;b.transform=this.transform;b.exceededTransferLimit=this.exceededTransferLimit;b.uniqueIdField=this.uniqueIdField;
b.queryGeometry=this.queryGeometry;b.queryGeometryType=this.queryGeometryType;return b};return a}();a.default=m})},"esri/layers/graphics/OptimizedGeometry":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a,b,h){void 0===a&&(a=[]);void 0===b&&(b=[]);void 0===h&&(h=!1);this.lengths=a;this.coords=b;this.hasIndeterminateRingOrder=h}Object.defineProperty(a.prototype,"isPoint",{get:function(){return 0===this.lengths.length},
enumerable:!1,configurable:!0});a.prototype.forEachVertex=function(a){var b=0;this.lengths.length||a(this.coords[0],this.coords[1]);for(var h=0;h<this.lengths.length;h++){for(var g=this.lengths[h],d=0;d<g;d++)a(this.coords[2*(d+b)],this.coords[2*(d+b)+1]);b+=g}};a.prototype.clone=function(){return new a(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};return a}();a.default=m})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports tslib ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z,A,C,E){function D(a){return a.every(function(a){return"exceedslimit"!==a.statisticType})}Object.defineProperty(a,"__esModule",{value:!0});a.Feature=void 0;m=function(){return function(a,c,b,e,d){void 0===c&&(c=null);this.attributes=a;this.geometry=b;this.centroid=e;this.filterFlags=d;this.groupId=-1;this.displayId=c}}();a.Feature=m;var F=new Set,H=new g.MemCacheStorage(2E6),I=0;m=function(){function a(a){var c=this;this.capabilities={query:y.queryCapabilities};
this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return c.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new g.MemCache(I++ +"$$",H));this.fieldsIndex=new C(a.fields);a.scheduler&&a.task&&(this._frameQueue=new E.default,
this._frameTask=a.scheduler.registerTask(a.task,function(a){return c._update(a)},function(){return 0<c._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",
{get:function(){return this.featureStore.featureAdapter},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:A.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=z.getTimeExtent(this.timeInfo,
this.featureStore):null},enumerable:!1,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,c){void 0===a&&(a={});return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f=this;return b.__generator(this,function(b){switch(b.label){case 0:c=k.clone(a),b.label=1;case 1:return b.trys.push([1,8,,9]),[4,this._schedule(function(){return A.normalizeQuery(c,f.definitionExpression,
f.spatialReference)})];case 2:return c=b.sent(),[4,this._reschedule(function(){return f._checkQuerySupport(c)})];case 3:return c=b.sent(),[4,this._reschedule(function(){return f._executeGeometryQuery(c)})];case 4:return e=b.sent(),[4,this._reschedule(function(){return e.executeObjectIdsQuery(c)})];case 5:return e=b.sent(),[4,this._reschedule(function(){return e.executeTimeQuery(c)})];case 6:return e=b.sent(),[4,this._reschedule(function(){return e.executeAttributesQuery(c)})];case 7:return e=b.sent(),
[3,9];case 8:d=b.sent();if(d!==A.QUERY_ENGINE_EMPTY_RESULT)throw d;e=new w.default([],null,this);return[3,9];case 9:return[2,e.createQueryResponse(c)]}})})};a.prototype.executeQueryForCount=function(a,c){void 0===a&&(a={});return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f=this;return b.__generator(this,function(b){switch(b.label){case 0:c=k.clone(a),c.returnGeometry=!1,c.returnCentroid=!1,c.outSR=null,b.label=1;case 1:return b.trys.push([1,8,,9]),[4,this._schedule(function(){return A.normalizeQuery(c,
f.definitionExpression,f.spatialReference)})];case 2:return c=b.sent(),[4,this._reschedule(function(){return f._checkQuerySupport(c)})];case 3:return c=b.sent(),[4,this._reschedule(function(){return f._executeGeometryQuery(c)})];case 4:return e=b.sent(),[4,this._reschedule(function(){return e.executeObjectIdsQuery(c)})];case 5:return e=b.sent(),[4,this._reschedule(function(){return e.executeTimeQuery(c)})];case 6:return e=b.sent(),[4,this._reschedule(function(){return e.executeAttributesQuery(c)})];
case 7:return e=b.sent(),[3,9];case 8:d=b.sent();if(d!==A.QUERY_ENGINE_EMPTY_RESULT)throw d;return[2,0];case 9:return[2,e.createQueryResponseForCount(c)]}})})};a.prototype.executeQueryForExtent=function(a,d){void 0===a&&(a={});return b.__awaiter(this,void 0,void 0,function(){var d,f,g,p,n,q,h,w,t=this;return b.__generator(this,function(b){switch(b.label){case 0:d=k.clone(a),g=d.outSR,b.label=1;case 1:return b.trys.push([1,8,,9]),[4,this._schedule(function(){return A.normalizeQuery(d,t.definitionExpression,
t.spatialReference)})];case 2:return d=b.sent(),[4,this._reschedule(function(){return t._checkQuerySupport(d)})];case 3:return d=b.sent(),d.returnGeometry=!0,d.returnCentroid=!1,d.outSR=null,[4,this._reschedule(function(){return t._executeGeometryQuery(d)})];case 4:return f=b.sent(),[4,this._reschedule(function(){return f.executeObjectIdsQuery(d)})];case 5:return f=b.sent(),[4,this._reschedule(function(){return f.executeTimeQuery(d)})];case 6:return f=b.sent(),[4,this._reschedule(function(){return f.executeAttributesQuery(d)})];
case 7:f=b.sent();p=f.size;if(!p)return[2,{count:p,extent:null}];e.set(K,e.NEGATIVE_INFINITY);this.featureStore.forEachBounds(f.items,function(a){return e.expand(K,a)},G);n={xmin:K[0],ymin:K[1],xmax:K[3],ymax:K[4],spatialReference:A.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(K[2])&&isFinite(K[5])&&(n.zmin=K[2],n.zmax=K[5]);q=u.project(n,f.spatialReference,g);q.spatialReference=A.cleanFromGeometryEngine(g||this.spatialReference);0===q.xmax-q.xmin&&(h=c.getMetersPerUnitForSR(q.spatialReference),
q.xmin-=h,q.xmax+=h);0===q.ymax-q.ymin&&(h=c.getMetersPerUnitForSR(q.spatialReference),q.ymin-=h,q.ymax+=h);this.hasZ&&null!=q.zmin&&null!=q.zmax&&0===q.zmax-q.zmin&&(h=c.getMetersPerUnitForSR(q.spatialReference),q.zmin-=h,q.zmax+=h);return[2,{count:p,extent:q}];case 8:w=b.sent();if(w===A.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw w;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,c){void 0===a&&(a={});return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,
function(b){return[2,this.executeQueryForIdSet(a,c).then(function(a){return f.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,c){void 0===a&&(a={});return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f,g,p=this;return b.__generator(this,function(b){switch(b.label){case 0:c=k.clone(a),c.returnGeometry=!1,c.returnCentroid=!1,c.outSR=null,b.label=1;case 1:return b.trys.push([1,9,,10]),[4,this._schedule(function(){return A.normalizeQuery(c,p.definitionExpression,p.spatialReference)})];
case 2:return c=b.sent(),[4,this._reschedule(function(){return p._checkQuerySupport(c)})];case 3:return c=b.sent(),[4,this._reschedule(function(){return p._executeGeometryQuery(c)})];case 4:return e=b.sent(),[4,this._reschedule(function(){return e.executeObjectIdsQuery(c)})];case 5:return e=b.sent(),[4,this._reschedule(function(){return e.executeTimeQuery(c)})];case 6:return e=b.sent(),[4,this._reschedule(function(){return e.executeAttributesQuery(c)})];case 7:return e=b.sent(),d=e.items,f=new Set,
[4,this._reschedule(function(){for(var a=0,c=d;a<c.length;a++)f.add(e.featureAdapter.getObjectId(c[a]))})];case 8:return b.sent(),[2,f];case 9:g=b.sent();if(g===A.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw g;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,c){void 0===a&&(a={});return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f=this;return b.__generator(this,function(b){switch(b.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new l("feature-store:unsupported-query",
"Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});c=k.clone(a);b.label=1;case 1:return b.trys.push([1,9,,10]),[4,this._schedule(function(){return A.normalizeQuery(c,f.definitionExpression,f.spatialReference)})];case 2:return c=b.sent(),[4,this._reschedule(function(){return f._checkQuerySupport(c)})];case 3:return c=b.sent(),[4,this._reschedule(function(){return f._executeGeometryQuery(c)})];case 4:return e=b.sent(),[4,this._reschedule(function(){return e.executeObjectIdsQuery(c)})];
case 5:return e=b.sent(),[4,this._reschedule(function(){return e.executeTimeQuery(c)})];case 6:return e=b.sent(),[4,this._reschedule(function(){return e.executeAttributesQuery(c)})];case 7:return e=b.sent(),[4,this._reschedule(function(){return e.filterLatest()})];case 8:return e=b.sent(),[3,10];case 9:d=b.sent();if(d!==A.QUERY_ENGINE_EMPTY_RESULT)throw d;e=new w.default([],null,this);return[3,10];case 10:return[2,e.createQueryResponse(c)]}})})};a.prototype._schedule=function(a){return b.__awaiter(this,
void 0,void 0,function(){return b.__generator(this,function(c){return this._frameQueue?[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(c){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=
[];this.featureStore.forEach(function(c){return a.push(c)});this._allItems=new w.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f,g,q,n,k,t,y,u,x,l,C,z,A,D,E,F,H,m=this;return b.__generator(this,function(I){switch(I.label){case 0:c=a.geometry;e=a.outSR;d=a.spatialRel;f=p.isValid(e)&&!p.equals(this.spatialReference,e);if(g=this._geometryQueryCache?f?JSON.stringify({geometry:c,spatialRelationship:d,
outSpatialReference:e}):JSON.stringify({geometry:c,spatialRelationship:d}):null)if(q=this._geometryQueryCache.get(g),!h.isUndefined(q))return[2,q];n=function(c){return b.__awaiter(m,void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return f&&(a.returnGeometry||a.returnCentroid)?[4,c.project(e)]:[3,2];case 1:return d=b.sent(),g&&this._geometryQueryCache.put(g,d,d.size||1),[2,d];case 2:return g&&this._geometryQueryCache.put(g,c,c.size||1),[2,c]}})})};if(!c)return[2,
n(this._getAll())];k=this.featureAdapter;if("esriSpatialRelDisjoint"!==d)return[3,3];t=this._searchFeatures(this._getQueryBBoxes(c));if(!t.length)return[2,n(this._getAll())];x=new Set;l=0;for(C=t;l<C.length;l++)z=C[l],x.add(k.getObjectId(z));return[4,this._reschedule(function(){var a=0;y=Array(x.size);m.featureStore.forEach(function(c){return y[a++]=c});u=x})];case 1:return I.sent(),[4,this._reschedule(function(){return b.__awaiter(m,void 0,void 0,function(){var a,e,f;return b.__generator(this,function(b){switch(b.label){case 0:return[4,
B.getSpatialQueryOperator(d,c,this.geometryType,this.hasZ,this.hasM)];case 1:return a=b.sent(),e=function(c){return!u.has(k.getObjectId(c))||a(k.getGeometry(c))},f=w.default.bind,[4,this._runSpatialFilter(y,e)];case 2:return[2,new (f.apply(w.default,[void 0,b.sent(),c,this]))]}})})})];case 2:return A=I.sent(),[2,n(A)];case 3:return D=this._searchFeatures(this._getQueryBBoxes(c)),D.length?(E=this._canExecuteSoloPass(c,a))?[2,n(new w.default(D,c,this))]:[4,B.getSpatialQueryOperator(d,c,this.geometryType,
this.hasZ,this.hasM)]:(A=new w.default([],c,this),g&&this._geometryQueryCache.put(g,A,A.size||1),[2,A]);case 4:return F=I.sent(),[4,this._runSpatialFilter(D,function(a){return F(k.getGeometry(a))})];case 5:return H=I.sent(),[2,n(new w.default(H,c,this))]}})})};a.prototype._runSpatialFilter=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g=this;return b.__generator(this,function(p){if(!c)return[2,a];if(!this._budget)return[2,a.filter(function(a){return c(a)})];e=0;d=[];f=function(){return b.__awaiter(g,
void 0,void 0,function(){var g;return b.__generator(this,function(b){switch(b.label){case 0:if(!(e<a.length))return[3,3];g=a[e];c(g)&&d.push(g);return this._budget.done?[4,this._reschedule(function(){return f()})]:[3,2];case 1:b.sent(),b.label=2;case 2:return++e,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return f()}).then(function(){return d})]})})};a.prototype._canExecuteSoloPass=function(a,c){var b=this.geometryType;c=c.spatialRel;return B.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===
c||"esriGeometryPoint"===b&&("esriSpatialRelIntersects"===c||"esriSpatialRelContains"===c||"esriSpatialRelWithin"===c))};a.prototype._getQueryBBoxes=function(a){if(B.canQueryWithRBush(a)){if(x.isExtent(a))return[n.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(x.isPolygon(a))return a.rings.map(function(a){return n.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[t.getBoundsXY(n.create(),a)]};a.prototype._searchFeatures=function(a){for(var c=
0;c<a.length;c++)this.featureStore.forEachInBounds(a[c],function(a){F.add(a)});var b=Array(F.size),e=0;F.forEach(function(a){return b[e++]=a});F.clear();return b};a.prototype._checkQuerySupport=function(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(c){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new l("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,d.all([this._checkAttributesQuerySupport(a),
this._checkStatisticsQuerySupport(a),B.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),u.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var c=a.outFields,b=a.orderByFields,e=a.returnDistinctValues,d=a.outStatistics,f=d?d.map(function(a){return a.outStatisticFieldName&&a.outStatisticFieldName.toLowerCase()}):[];b&&0<b.length&&(b=b.map(function(a){var c=a.toLowerCase();return-1<c.indexOf(" asc")?
c.split(" asc")[0]:-1<c.indexOf(" desc")?c.split(" desc")[0]:a}).filter(function(a){return-1===f.indexOf(a)}),q.validateFields(this.fieldsIndex,b,"orderByFields contains missing fields"));if(c&&0<c.length)q.validateFields(this.fieldsIndex,c,"outFields contains missing fields");else if(e)throw new l("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});q.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return b.__awaiter(this,
void 0,void 0,function(){var c,e,d,f,g,p,n,h,k,w,t,y,u;return b.__generator(this,function(b){c=a.outStatistics;e=a.groupByFieldsForStatistics;d=a.having;f=e&&e.length;g=c&&c.length;if(d){if(!f||!g)throw new l("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});q.validateHaving(this.fieldsIndex,d,c)}if(g){if(!D(c))return[2];p=c.map(function(a){return a.onStatisticField});q.validateFields(this.fieldsIndex,p,"onStatisticFields contains missing fields");
f&&q.validateFields(this.fieldsIndex,e,"groupByFieldsForStatistics contains missing fields");n=0;for(h=c;n<h.length;n++)if(k=h[n],w=k.onStatisticField,t=k.statisticType,(y="percentile_disc"===t||"percentile_cont"===t)&&"statisticParameters"in k){if(u=k.statisticParameters,!u)throw new l("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:k,query:a});}else if("count"!==t&&w&&q.hasInvalidFieldType(w,this.fieldsIndex))throw new l("feature-store:unsupported-query",
"outStatistics contains non-numeric fields",{definition:k,query:a});}return[2]})})};return a}();a.default=m;var G=e.create(),K=e.create()})},"esri/core/MemCache":function(){define(["require","exports","./MapUtils","./PooledArray","./string"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.MemCacheStorage=a.MemCache=a.MIN_PRIORITY=void 0;a.MIN_PRIORITY=-3;m=function(){function a(a,b,f){this._namespace=a;this._storage=b;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);
this._namespace+=":";f&&(this._storage.registerRemoveFunc(this._namespace,f),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"maxSize",{get:function(){return this._storage.maxSize},enumerable:!1,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,b,f,c){void 0===c&&(c=0);this._storage.put(this._namespace+a,b,f,c)};a.prototype.get=function(a){a=this._storage.get(this._namespace+a);void 0===a?++this._miss:
++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.updateSize=function(a,b,f){this._storage.updateSize(this._namespace+a,b,f)};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=m;m=
function(){function h(a){void 0===a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new l}h.prototype.register=function(a){this._users.push(a)};h.prototype.deregister=function(a){this._users.removeUnordered(a)};h.prototype.registerRemoveFunc=function(a,b){this._removeFuncs.push([a,b])};h.prototype.deregisterRemoveFunc=function(a){this._removeFuncs=this._removeFuncs.filter(function(b){return b[0]!==a})};Object.defineProperty(h.prototype,
"size",{get:function(){return this._size},enumerable:!1,configurable:!0});Object.defineProperty(h.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._checkSizeLimit()},enumerable:!1,configurable:!0});h.prototype.put=function(b,d,f,c){var e=this._db.get(b);e&&(this._size-=e.size,this._db.delete(b),e.entry!==d&&this._notifyRemoved(b,e.entry));f>this._maxSize?this._notifyRemoved(b,d):void 0===d?console.warn("Refusing to cache undefined entry "):
!f||0>f?console.warn("Refusing to cache entry with invalid size "+f):(c=1+Math.max(c,a.MIN_PRIORITY)-a.MIN_PRIORITY,this._db.set(b,{entry:d,size:f,lifetime:c,lives:c}),this._size+=f,this._checkSizeLimit())};h.prototype.updateSize=function(a,b,f){var c=this._db.get(a);c&&c.entry===b&&(this._size-=c.size,f>this._maxSize?this._notifyRemoved(a,b):(c.size=f,this._size+=f,this._checkSizeLimit()))};h.prototype.pop=function(a){var b=this._db.get(a);if(b)return this._size-=b.size,this._db.delete(a),++this._hit,
b.entry;++this._miss};h.prototype.get=function(a){var b=this._db.get(a);if(void 0===b)++this._miss;else return this._db.delete(a),b.lives=b.lifetime,this._db.set(a,b),++this._hit,b.entry};h.prototype.getStats=function(){var b=this,d={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},f={},c=[];this._db.forEach(function(a,e){var d=a.lifetime;c[d]=(c[d]||0)+a.size;b._users.forEachSimple(function(c){c=
c.namespace;k.startsWith(e,c)&&(f[c]=(f[c]||0)+a.size)})});var e={};this._users.forEachSimple(function(a){var c=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(f[c]=f[c]||0,e[c]=Math.round(100*a.hitRate)+"%"):e[c]="0%"});var n=Object.keys(f);n.forEach(function(a){return f[a]=f[a]/b._size*100});n.sort(function(a,c){return f[c]-f[a]});n.forEach(function(a){return d[a]=Math.round(f[a])+"% / "+e[a]});for(n=c.length-1;0<=n;--n){var h=c[n];h&&(d["Priority "+(n+a.MIN_PRIORITY-1)]=Math.round(h/this.size*100)+
"%")}return d};h.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEachSimple(function(a){return a.resetHitRate()})};h.prototype.clear=function(a){var b=this;this._db.forEach(function(d,c){k.startsWith(c,a)&&(b._size-=d.size,b._db.delete(c),b._notifyRemoved(c,d.entry))})};h.prototype.clearAll=function(){var a=this;this._db.forEach(function(b,f){return a._notifyRemoved(f,b.entry)});this._size=0;this._db.clear()};h.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};
h.prototype._notifyRemoved=function(a,b){this._removeFuncs.forEach(function(d){if(k.startsWith(a,d[0]))d[1](b)})};h.prototype._checkSizeLimit=function(){var a=this;this._size<=this._maxSize||b.someMap(this._db,function(b,f){a._db.delete(f);1>=b.lives?(a._size-=b.size,a._notifyRemoved(f,b.entry)):(--b.lives,a._db.set(f,b));return a._size<=.9*a.maxSize})};return h}();a.MemCacheStorage=m})},"esri/core/MapUtils":function(){define(["require","exports","./maybe"],function(m,a,b){function l(a){if(0===a.size)throw Error("Map is empty");
return a.keys().next().value}function k(a){if(0===a.size)throw Error("Map is empty");var c=void 0,d=!1;a.forEach(function(a,b){d||(c=b,d=!0)});return b.assumeNonNull(c)}function h(a){if(0===a.size)throw Error("Map is empty");return a.values().next().value}function g(a){if(0===a.size)throw Error("Map is empty");var c=void 0,d=!1;a.forEach(function(a){d||(c=a,d=!0)});return b.assumeNonNull(c)}Object.defineProperty(a,"__esModule",{value:!0});a.test=a.firstValueOfMap=a.firstKeyOfMap=a.MapFromValues=a.keysOfMap=
a.valuesOfMap=a.pairsOfMap=a.someMap=void 0;a.someMap=Map.prototype.entries?function(a,b){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(b(c.value[1],c.value[0]))return!0;return!1}:function(a,b){var c=!0;a.forEach(function(a,e){c&&(c=!b(a,e))});return!c};m=!!Map.prototype.values;var d=!!Map.prototype.keys,f=!!Array.from;a.pairsOfMap=function(a){var c=[];a.forEach(function(a,b){return c.push([b,a])});return c};a.valuesOfMap=m&&f?function(a){return Array.from(a.values())}:function(a){var c=
Array(a.size),b=0;a.forEach(function(a){return c[b++]=a});return c};a.keysOfMap=d&&f?function(a){return Array.from(a.keys())}:function(a){var c=Array(a.size),b=0;a.forEach(function(a,e){return c[b++]=e});return c};a.MapFromValues=m?function(a){return new Map(a)}:function(a){for(var c=new Map,b=0;b<a.length;b++){var d=a[b];c.set(d[0],d[1])}return c};a.firstKeyOfMap=d?l:k;a.firstValueOfMap=m?h:g;a.test={firstKeyOfMapFallback:k,firstValueOfMapFallback:g}})},"esri/geometry/support/aaBoundingBox":function(){define(["require",
"exports","../../core/maybe","../Extent","./aaBoundingRect"],function(m,a,b,l,k){function h(c){void 0===c&&(c=a.ZERO);return[c[0],c[1],c[2],c[3],c[4],c[5]]}function g(a,c,b,e,d,f,g){void 0===g&&(g=h());g[0]=a;g[1]=c;g[2]=b;g[3]=e;g[4]=d;g[5]=f;return g}function d(a){return a[0]>=a[3]?0:a[3]-a[0]}function f(a){return a[1]>=a[4]?0:a[4]-a[1]}function c(a){return a[2]>=a[5]?0:a[5]-a[2]}function e(a,c){return Math.max(c[0],a[0])<=Math.min(c[3],a[3])&&Math.max(c[1],a[1])<=Math.min(c[4],a[4])&&Math.max(c[2],
a[2])<=Math.min(c[5],a[5])}function n(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];return a}function t(a){return 6===a.length}Object.defineProperty(a,"__esModule",{value:!0});a.ZERO=a.NEGATIVE_INFINITY=a.POSITIVE_INFINITY=a.wrap=a.equals=a.isPoint=a.is=a.fromRect=a.toRect=a.empty=a.set=a.setMax=a.setMin=a.getMax=a.getMin=a.offset=a.intersectsClippingArea=a.intersects=a.contains=a.containsPointWithMargin=a.containsPoint=a.maximumDimension=a.size=a.center=a.diameter=a.height=a.depth=
a.width=a.allFinite=a.expandWithNestedArray=a.expandWithOffset=a.expandWithBuffer=a.expand=a.expandPointInPlace=a.fromMinMax=a.toExtent=a.fromExtent=a.fromValues=a.create=void 0;a.create=h;a.fromValues=g;a.fromExtent=function(a,c){void 0===c&&(c=h());c[0]=a.xmin;c[1]=a.ymin;c[2]=a.zmin;c[3]=a.xmax;c[4]=a.ymax;c[5]=a.zmax;return c};a.toExtent=function(a,c){return isFinite(a[2])||isFinite(a[5])?new l({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:c}):new l({xmin:a[0],
xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:c})};a.fromMinMax=function(a,c,b){void 0===b&&(b=h());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=c[0];b[4]=c[1];b[5]=c[2];return b};a.expandPointInPlace=function(a,c){c[0]<a[0]&&(a[0]=c[0]);c[0]>a[3]&&(a[3]=c[0]);c[1]<a[1]&&(a[1]=c[1]);c[1]>a[4]&&(a[4]=c[1]);c[2]<a[2]&&(a[2]=c[2]);c[2]>a[5]&&(a[5]=c[2])};a.expand=function(a,c,b){void 0===b&&(b=a);t(c)?(b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],c[1]),b[2]=Math.min(a[2],c[2]),b[3]=Math.max(a[3],c[3]),b[4]=Math.max(a[4],
c[4]),b[5]=Math.max(a[5],c[5])):k.is(c)?(b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],c[1]),b[3]=Math.max(a[3],c[2]),b[4]=Math.max(a[4],c[3])):2===c.length?(b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],c[1]),b[3]=Math.max(a[3],c[0]),b[4]=Math.max(a[4],c[1])):3===c.length&&(b[0]=Math.min(a[0],c[0]),b[1]=Math.min(a[1],c[1]),b[2]=Math.min(a[2],c[2]),b[3]=Math.max(a[3],c[0]),b[4]=Math.max(a[4],c[1]),b[5]=Math.max(a[5],c[2]));return b};a.expandWithBuffer=function(a,c,b,e,d){void 0===b&&(b=0);void 0===e&&
(e=c.length/3);void 0===d&&(d=a);var f=a[0],g=a[1],p=a[2],n=a[3],q=a[4];a=a[5];for(var h=0;h<e;h++)f=Math.min(f,c[b+3*h]),g=Math.min(g,c[b+3*h+1]),p=Math.min(p,c[b+3*h+2]),n=Math.max(n,c[b+3*h]),q=Math.max(q,c[b+3*h+1]),a=Math.max(a,c[b+3*h+2]);d[0]=f;d[1]=g;d[2]=p;d[3]=n;d[4]=q;d[5]=a;return d};a.expandWithOffset=function(a,c,b,e,d){void 0===d&&(d=a);d[0]=Math.min(a[0],a[0]+c);d[3]=Math.max(a[3],a[3]+c);d[1]=Math.min(a[1],a[1]+b);d[4]=Math.max(a[4],a[4]+b);d[2]=Math.min(a[2],a[2]+e);d[5]=Math.max(a[5],
a[5]+e);return d};a.expandWithNestedArray=function(a,c,b,e){void 0===e&&(e=a);var d=c.length,f=a[0],g=a[1],p=a[2],n=a[3],q=a[4];a=a[5];if(b)for(b=0;b<d;b++){var h=c[b],f=Math.min(f,h[0]),g=Math.min(g,h[1]),p=Math.min(p,h[2]),n=Math.max(n,h[0]),q=Math.max(q,h[1]);a=Math.max(a,h[2])}else for(b=0;b<d;b++)h=c[b],f=Math.min(f,h[0]),g=Math.min(g,h[1]),n=Math.max(n,h[0]),q=Math.max(q,h[1]);e[0]=f;e[1]=g;e[2]=p;e[3]=n;e[4]=q;e[5]=a;return e};a.allFinite=function(a){for(var c=0;6>c;c++)if(!isFinite(a[c]))return!1;
return!0};a.width=d;a.depth=f;a.height=c;a.diameter=function(a){var b=d(a),e=c(a);a=f(a);return Math.sqrt(b*b+e*e+a*a)};a.center=function(a,b){void 0===b&&(b=[0,0,0]);b[0]=a[0]+d(a)/2;b[1]=a[1]+f(a)/2;b[2]=a[2]+c(a)/2;return b};a.size=function(a,b){void 0===b&&(b=[0,0,0]);b[0]=d(a);b[1]=f(a);b[2]=c(a);return b};a.maximumDimension=function(a){return Math.max(d(a),c(a),f(a))};a.containsPoint=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[2]>=a[2]&&c[0]<=a[3]&&c[1]<=a[4]&&c[2]<=a[5]};a.containsPointWithMargin=
function(a,c,b){return c[0]>=a[0]-b&&c[1]>=a[1]-b&&c[2]>=a[2]-b&&c[0]<=a[3]+b&&c[1]<=a[4]+b&&c[2]<=a[5]+b};a.contains=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[2]>=a[2]&&c[3]<=a[3]&&c[4]<=a[4]&&c[5]<=a[5]};a.intersects=e;a.intersectsClippingArea=function(a,c){return b.isNone(c)?!0:e(a,c)};a.offset=function(a,c,b,e,d){void 0===d&&(d=a);d[0]=a[0]+c;d[1]=a[1]+b;d[2]=a[2]+e;d[3]=a[3]+c;d[4]=a[4]+b;d[5]=a[5]+e;return d};a.getMin=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];return c};a.getMax=function(a,
c){c[0]=a[3];c[1]=a[4];c[2]=a[5];return c};a.setMin=function(a,c,b){void 0===b&&(b=a);b[0]=c[0];b[1]=c[1];b[2]=c[2];b!==a&&(b[3]=a[3],b[4]=a[4],b[5]=a[5]);return b};a.setMax=function(a,c,b){void 0===b&&(b=a);b[3]=c[0];b[4]=c[1];b[5]=c[2];b!==a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return a};a.set=n;a.empty=function(c){return c?n(c,a.NEGATIVE_INFINITY):h(a.NEGATIVE_INFINITY)};a.toRect=function(a,c){c||(c=k.create());c[0]=a[0];c[1]=a[1];c[2]=a[3];c[3]=a[4];return c};a.fromRect=function(a,c){a[0]=c[0];a[1]=
c[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=c[2];a[4]=c[3];a[5]=Number.POSITIVE_INFINITY;return a};a.is=t;a.isPoint=function(a){return 0===d(a)&&0===f(a)&&0===c(a)};a.equals=function(a,c,e){if(b.isNone(a)||b.isNone(c))return a===c;if(!t(a)||!t(c))return!1;if(e)for(var d=0;d<a.length;d++){if(!e(a[d],c[d]))return!1}else for(d=0;d<a.length;d++)if(a[d]!==c[d])return!1;return!0};a.wrap=function(a,c,b,e,d,f){return g(a,c,b,e,d,f,x)};a.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];
a.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0,0,0];var x=h()})},"esri/layers/graphics/data/attributeSupport":function(){define(["require","exports","../../../core/Error","../../../core/SetUtils","../../../core/sql/WhereClauseCache"],function(m,a,b,l,k){function h(a,c){return a?f.get(a,c):null}function g(a,c,f,k){void 0===k&&(k=!0);for(var e=[],n=0;n<c.length;n++){var t=c[n];if("*"!==t&&!a.has(t))if(k){var y=d(t);try{var w=h(y,a);if(!w)throw new b("feature-store:unsupported-query",
"invalid SQL expression",{where:y});if(!w.isStandardized)throw new b("feature-store:unsupported-query","expression is not standard",{clause:w});g(a,w.fieldNames,"expression contains missing fields")}catch(B){if((y=B&&B.details)&&(y.clause||y.where))throw B;y&&y.missingFields?e.push.apply(e,y.missingFields):e.push(t)}}else e.push(t)}if(e.length)throw new b("feature-store:unsupported-query",f,{missingFields:e});}function d(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});
a.hasInvalidFieldType=a.getAliasFromFieldName=a.getExpressionFromFieldName=a.validateFields=a.getWhereClause=a.validateHaving=a.validateWhere=void 0;var f=new k.WhereClauseCache(50,500),c=l.SetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,c){if(!c)return!0;var e=f.get(c,a);if(!e)throw new b("feature-store:unsupported-query","invalid SQL expression",{where:c});
if(!e.isStandardized)throw new b("feature-store:unsupported-query","where clause is not standard",{where:c});g(a,e.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,c,d){if(!c)return!0;var e=f.get(c,a);if(!e)throw new b("feature-store:unsupported-query","invalid SQL expression",{having:c});if(!e.isAggregate)throw new b("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:c});g(a,e.fieldNames,"having contains missing fields");
if(!e.getExpressions().every(function(c){var b=c.aggregateType;c=c.field;var e=a.has(c)&&a.get(c).name;return d.some(function(c){var d=c.onStatisticField;c=c.statisticType;return(a.has(d)&&a.get(d).name)===e&&c.toLowerCase().trim()===b})}))throw new b("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:c});return!0};a.getWhereClause=h;a.validateFields=g;a.getExpressionFromFieldName=d;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=
function(a,b){return(a=b.get(a))?!c.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.WhereClauseCache=void 0;m=function(){function a(a,g){this._cache=new b(a);this._invalidCache=new b(g)}a.prototype.get=function(a,b){var d=b.uid+":"+a,f=this._cache.get(d);if(f)return f;if(void 0!==this._invalidCache.get(d))return null;try{var c=l.WhereClause.create(a,b);this._cache.put(d,
c);return c}catch(e){return this._invalidCache.put(d,null),null}};return a}();a.WhereClauseCache=m})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(m,a,b){return function(){function a(a,h){this._storage=new b.MemCacheStorage;this._storage.maxSize=a;h&&this._storage.registerRemoveFunc("",h)}a.prototype.put=function(a,b){this._storage.put(a,b,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};
a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(m,a,b,l,k,h,g){function d(a,c){a+="";return a.length>=c?a:Array(c-a.length+1).join("0")+a}function f(a,c,b,e,f,g,n,p,q){void 0===b&&(b="0");void 0===e&&(e="0");void 0===f&&(f="0");void 0===g&&(g="0");void 0===n&&
(n="");void 0===p&&(p="0");void 0===q&&(q="0");return"+"===n||"-"===n?(a=d(parseInt(a,10),4)+"-"+d(parseInt(c,10),2)+"-"+d(parseInt(b,10),2),c="",10>parseFloat(g)&&(c="0"),e=d(parseInt(e,10),2)+":"+d(parseInt(f,10),2)+":"+(c+parseFloat(g).toString()),n=""+n+d(parseInt(p,10),2)+":"+d(parseInt(q,10),2),new Date(a+"T"+e+n)):new Date(parseInt(a,10),parseInt(c,10)-1,parseInt(b,10),parseInt(e,10),parseInt(f,10),parseFloat(g))}function c(a){var c=E.exec(a);if(null!==c){a=c[1];var b=c[2],e=c[3],d=c[4],g=
c[5],n=c[6];return f(a,b,e,d,g,n)}c=D.exec(a);if(null!==c){a=c[1];var b=c[2],e=c[3],d=c[4],g=c[5],n=c[6],p=c[7],q=c[8],c=c[9];return f(a,b,e,d,g,n,p,q,c)}c=F.exec(a);if(null!==c)return a=c[1],b=c[2],e=c[3],d=c[4],g=c[5],p=c[6],q=c[7],c=c[8],f(a,b,e,d,g,"0",p,q,c);c=H.exec(a);if(null!==c)return a=c[1],b=c[2],e=c[3],d=c[4],g=c[5],f(a,b,e,d,g);c=C.exec(a);if(null!==c)return a=c[1],b=c[2],e=c[3],f(a,b,e);throw Error("SQL Invalid Timestamp");}function e(a){a=C.exec(a);if(null===a)throw Error("SQL Invalid Date");
var c=a[2],b=a[3];return new Date(parseInt(a[1],10),parseInt(c,10)-1,parseInt(b,10))}function n(a){return Array.isArray(a)?a:[a]}function t(a){return null!==a?!0!==a:null}function x(a,c){return null!=a&&null!=c?!0===a&&!0===c:!1===a||!1===c?!1:null}function p(a,c){return null!=a&&null!=c?!0===a||!0===c:!0===a||!0===c?!0:null}function q(a,c){if(null==a)return null;for(var b=!1,e=0;e<c.length;e++){var d=c[e];if(null==d)b=null;else if(a===d){b=!0;break}}return b}function u(a,c,b){if(null==a)return null;
for(var e="",d=0,f=0;f<c.length;f++){var g=c.charAt(f);switch(d){case 0:g===b?d=1:e=0<="-[]/{}()*+?.\\^$|".indexOf(g)?e+("\\"+g):"%"===g?e+".*":"_"===g?e+".":e+g;break;case 1:e=0<="-[]/{}()*+?.\\^$|".indexOf(g)?e+("\\"+g):e+g,d=0}}return(new RegExp("^"+e+"$")).test(a)}function y(a){return a instanceof Date?a.valueOf():a}function w(a,c,b){if(null==c||null==b)return null;c=y(c);b=y(b);switch(a){case "\x3c\x3e":return c!==b;case "\x3d":return c===b;case "\x3e":return c>b;case "\x3c":return c<b;case "\x3e\x3d":return c>=
b;case "\x3c\x3d":return c<=b}}function B(a){for(var c=[],b={},e=0;e<a.length;e++){var d=a[e],f=d.toLowerCase();void 0===b[f]&&(c.push(d),b[f]=1)}return c}function z(a,c,b){if(c instanceof h.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+b.getTime());case "-":return c.valueInMilliseconds()-b.getTime();case "*":return c.valueInMilliseconds()*b.getTime();case "/":return c.valueInMilliseconds()/b.getTime()}else if(b instanceof h.SqlInterval)switch(a){case "+":return h.SqlInterval.createFromMilliseconds(c.valueInMilliseconds()+
b.valueInMilliseconds());case "-":return h.SqlInterval.createFromMilliseconds(c.valueInMilliseconds()-b.valueInMilliseconds());case "*":return c.valueInMilliseconds()*b.valueInMilliseconds();case "/":return c.valueInMilliseconds()/b.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(b instanceof h.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+c.getTime());case "-":return new Date(c.getTime()-b.valueInMilliseconds());case "*":return c.getTime()*
b.valueInMilliseconds();case "/":return c.getTime()/b.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(c instanceof Date&&"number"===typeof b)switch(b*=864E5,c=c.getTime(),a){case "+":return new Date(c+b);case "-":return new Date(c-b);case "*":return new Date(c*b);case "/":return new Date(c/b)}else if(b instanceof Date&&"number"===typeof c)switch(c*=864E5,b=b.getTime(),a){case "+":return new Date(c+b);case "-":return new Date(c-b);case "*":return new Date(c*b);case "/":return new Date(c/
b)}switch(a){case "+":return c+b;case "-":return c-b;case "*":return c*b;case "/":return c/b}}function A(a,c,b,e){a=e.getAttribute(a,c);return null!=a&&1===b[c]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});a.defaultAttributeAdapter=a.WhereClause=void 0;var C=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,D=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,
H=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,I=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,c,b,e){return A(a,c,b,e)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,c,b){return u(a,c,b)};a.ensureArray=function(a){return n(a)};a.applyIn=function(a,c){return q(a,c)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=function(a,c,b){return h.SqlInterval.createFromValueAndQualifer(a,c,b)};a.convertInterval=
function(a){return a instanceof h.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,c,b){return w(a,c,b)};a.calculate=function(a,c,b){return z(a,c,b)};a.makeComparable=function(a){return y(a)};a.evaluateFunction=function(a,c){return h.evaluateFunction(a,c)};a.lookup=function(a,c){a=c[a];return void 0===a?null:a};a.between=function(a,c){return null==a||null==c[0]||null==c[1]?null:a>=c[0]&&a<=c[1]};a.notbetween=function(a,c){return null==a||null==
c[0]||null==c[1]?null:a<c[0]||a>c[1]};a.ternaryNot=function(a){return t(a)};a.ternaryAnd=function(a,c){return x(a,c)};a.ternaryOr=function(a,c){return p(a,c)};return a}();m=function(){function d(a,c){this.fieldsIndex=c;this.datefields={};this.parameters={};this.parseTree=g.WhereGrammar.parse(a);a=this.extractExpressionInfo(c);c=a.isStandardized;var b=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;this.isStandardized=c;this.isAggregate=b}d.create=function(a,c){return new d(a,c)};Object.defineProperty(d.prototype,
"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!1,configurable:!0});d.prototype.testSet=function(c,b){void 0===b&&(b=a.defaultAttributeAdapter);for(var e={},d=function(a){e[a]=c.map(function(c){return b.getAttribute(c,a)})},f=0,g=this.fieldNames;f<g.length;f++)d(g[f]);return!!this.evaluateNode(this.parseTree,{attributes:e},a.defaultAttributeAdapter)};d.prototype.calculateValue=function(c,b){void 0===b&&(b=a.defaultAttributeAdapter);c=this.evaluateNode(this.parseTree,c,b);
return c instanceof h.SqlInterval?c.valueInMilliseconds()/864E5:c};d.prototype.calculateValueCompiled=function(c,e){void 0===e&&(e=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(c,this.parameters,e,this.datefields);if(b("csp-restrictions"))return this.calculateValue(c,e);this.compileMe();return this.parseTree._compiledVersion(c,this.parameters,e,this.datefields)};d.prototype.testFeature=function(c,b){void 0===b&&(b=a.defaultAttributeAdapter);
return!!this.evaluateNode(this.parseTree,c,b)};d.prototype.testFeatureCompiled=function(c,e){void 0===e&&(e=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(c,this.parameters,e,this.datefields);if(b("csp-restrictions"))return this.testFeature(c,e);this.compileMe();return!!this.parseTree._compiledVersion(c,this.parameters,e,this.datefields)};d.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(c){"function"===
c.type&&a.push(c.name.toLowerCase())});return B(a)};d.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(c){if("function"===c.type){var b=c.name.toLowerCase();c=c.args.value[0];if("column_ref"===c.type){c=c.column;var e=b+"-"+c;a.has(e)||a.set(e,{aggregateType:b,field:c})}}});return l.valuesOfMap(a)};d.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(c){"param"===c.type&&a.push(c.value.toLowerCase())});return B(a)};d.prototype.compileMe=
function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(I)};d.prototype.extractExpressionInfo=function(a){var c=this,b=[],e=!0,d=!0;this.visitAll(this.parseTree,function(f){switch(f.type){case "column_ref":var g=a.get(f.column),n=g&&g.name;!g||"date"!==g.type&&"esriFieldTypeDate"!==g.type||(c.datefields[g.name]=1);void 0!==n?(b.push(n),f.column=n):b.push(f.column);
break;case "function":g=f.name,f=f.args.value.length,e&&(e=h.isStandardized(g,f)),d&&(d=k.isAggregate(g,f))}});return{referencedFieldNames:B(b),isStandardized:e,isAggregate:d}};d.prototype.visitAll=function(a,c){if(null!=a)switch(c(a),a.type){case "when_clause":this.visitAll(a.operand,c);this.visitAll(a.value,c);break;case "case_expression":for(var b=0,e=a.clauses;b<e.length;b++){var d=e[b];this.visitAll(d,c)}"simple"===a.format&&this.visitAll(a.operand,c);null!==a.else&&this.visitAll(a.else,c);break;
case "expr_list":b=0;for(a=a.value;b<a.length;b++)d=a[b],this.visitAll(d,c);break;case "unary_expr":this.visitAll(a.expr,c);break;case "binary_expr":this.visitAll(a.left,c);this.visitAll(a.right,c);break;case "function":this.visitAll(a.args,c)}};d.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===
a.format)for(var d="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",f=0;f<a.clauses.length;f++)b+=" ("+d+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";else for(b="( ",f=0;f<a.clauses.length;f++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";b=null!==a.else?b+
this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";d=0;for(a=a.value;d<a.length;d++)f=a[d],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(f);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+
this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+
","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+
JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+e(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+c(a.value).getTime().toString()+"))";case "current_time":return"date"===a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+
JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};d.prototype.evaluateNode=function(a,b,d){switch(a.type){case "interval":return b=this.evaluateNode(a.value,b,d),h.SqlInterval.createFromValueAndQualifer(b,a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var f=y(this.evaluateNode(a.operand,b,d)),g=0;g<a.clauses.length;g++){if(f===
y(this.evaluateNode(a.clauses[g].operand,b,d)))return this.evaluateNode(a.clauses[g].value,b,d)}else for(g=0;g<a.clauses.length;g++)if(!0===this.evaluateNode(a.clauses[g].operand,b,d))return this.evaluateNode(a.clauses[g].value,b,d);return null!==a.else?this.evaluateNode(a.else,b,d):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":f=[];g=0;for(a=a.value;g<a.length;g++)f.push(this.evaluateNode(a[g],b,d));return f;case "unary_expr":return t(this.evaluateNode(a.expr,b,
d));case "binary_expr":switch(a.operator){case "AND":return x(this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d));case "OR":return p(this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,b,d);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,b,d);case "IN":return f=n(this.evaluateNode(a.right,b,d)),q(this.evaluateNode(a.left,
b,d),f);case "NOT IN":return f=n(this.evaluateNode(a.right,b,d)),t(q(this.evaluateNode(a.left,b,d),f));case "BETWEEN":return f=this.evaluateNode(a.left,b,d),a=this.evaluateNode(a.right,b,d),null==f||null==a[0]||null==a[1]?null:f>=y(a[0])&&f<=y(a[1]);case "NOTBETWEEN":return f=this.evaluateNode(a.left,b,d),a=this.evaluateNode(a.right,b,d),null==f||null==a[0]||null==a[1]?null:f<y(a[0])||f>y(a[1]);case "LIKE":return u(this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d),a.escape);case "NOT LIKE":return t(u(this.evaluateNode(a.left,
b,d),this.evaluateNode(a.right,b,d),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return w(a.operator,this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d));case "-":case "+":case "*":case "/":return z(a.operator,this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d))}case "null":case "bool":case "string":case "number":return a.value;case "date":return e(a.value);case "timestamp":return c(a.value);case "current_time":return b=new Date,
"date"===a.mode&&b.setHours(0,0,0,0),b;case "column_ref":return A(b,a.column,this.datefields,d);case "function":return b=this.evaluateNode(a.args,b,d),this.isAggregate?k.aggregateFunction(a.name,b):h.evaluateFunction(a.name,b)}throw Error("Unsupported sql syntax "+a.type);};return d}();a.WhereClause=m;a.defaultAttributeAdapter={getAttribute:function(a,c){return(a&&"object"===typeof a.attributes?a.attributes:a)[c]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(m,
a){function b(a){for(var b=0,d=0;d<a.length;d++)b+=a[d];return b/a.length}function l(a){for(var g=b(a),d=a.length,f=0,c=0;c<a.length;c++)f+=Math.pow(a[c]-g,2);return 1<d?f/(d-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.isAggregate=a.aggregateFunction=void 0;a.aggregateFunction=function(a,b){var d=k[a.toLowerCase()];if(null==d)throw Error("Function Not Recognised");if(b.length<d.minParams||b.length>d.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return d.evaluate(b)};
a.isAggregate=function(a,b){a=k[a.toLowerCase()];return null!=a&&b>=a.minParams&&b<=a.maxParams};var k={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:b(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,d=0;d<a.length;d++)b+=
a[d];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(l(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:l(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.isStandardized=a.evaluateFunction=a.SqlInterval=void 0;
m=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var g=new a;g.second=b/1E3;return g};a.createFromValueAndQualifer=function(b,g,d){var f=null,c=new a;c.op="-"===d?"-":"+";if("interval-period"===g.type){a.fixDefaults(g);if("year"===g.period||"month"===g.period)throw Error("Year-Month Intervals not supported");
if(/^[0-9]{1,}$/.test(b))c[g.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(g.start);a.fixDefaults(g.end);if("year"===g.start.period||"month"===g.start.period)throw Error("Year-Month Intervals not supported");if("year"===g.end.period||"month"===g.end.period)throw Error("Year-Month Intervals not supported");switch(g.start.period){case "day":switch(g.end.period){case "hour":f=/^[0-9]{1,} [0-9]{1,}$/;if(f.test(b))c[g.start.period]=parseFloat(b.split(" ")[0]),c[g.end.period]=
parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":f=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(f.test(b))c[g.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),c.hour=parseFloat(b[0]),c.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":f=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(f.test(b))c[g.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),c.hour=parseFloat(b[0]),c.minute=
parseFloat(b[1]),c.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(g.end.period){case "minute":f=/^[0-9]{1,}:[0-9]{1,}$/;if(f.test(b))c.hour=parseFloat(b.split(":")[0]),c.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":f=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(f.test(b))b=b.split(":"),c.hour=parseFloat(b[0]),c.minute=parseFloat(b[1]),c.second=parseFloat(b[2]);
else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(g.end.period){case "second":f=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(f.test(b))b=b.split(":"),c.minute=parseFloat(b[0]),c.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return c};a.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+
864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=m;a.evaluateFunction=function(a,b){var g=l[a.toLowerCase()];if(null==g)throw Error("Function Not Recognised");if(b.length<g.minParams||b.length>g.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return g.evaluate(b)};a.isStandardized=function(a,b){a=l[a.toLowerCase()];return null!=a&&b>=a.minParams&&b<=a.maxParams};var l={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];
a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=a[0],g=a[1];return null==b||null==g?null:b.toString().substring(g-1)}if(3===a.length)return b=
a[0],g=a[1],a=a[2],null==b||null==g||null==a?null:0>=a?"":b.toString().substring(g-1,g+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var h=3===a.length,g=h?a[1]:" ",h=h?a[2]:a[1];if(null==g||null==h)return null;g="("+b.escapeRegExpString(g)+")";switch(a[0]){case "BOTH":return h.replace(new RegExp("^"+g+"*|"+g+"*$","g"),"");case "LEADING":return h.replace(new RegExp("^"+
g+"*","g"),"");case "TRAILING":return h.replace(new RegExp(g+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?
Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",g=0;g<a.length;g++){if(null==a[g])return null;b+=a[g].toString()}return b}},lower:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.WhereGrammar=void 0;m=function(){function a(){}a.parse=function(a){return b.parse(a)};return a}();a.WhereGrammar=m})},"esri/core/sql/sql92grammar":function(){(function(m,
a){"function"===typeof define&&define.amd?define([],a):"object"===typeof module&&module.exports&&(module.exports=a())})(this,function(){function m(a,b,l,k){this.message=a;this.expected=b;this.found=l;this.location=k;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,m)}(function(a,b){function l(){this.constructor=a}l.prototype=b.prototype;a.prototype=new l})(m,Error);m.buildMessage=function(a,b){function l(a){return a.charCodeAt(0).toString(16).toUpperCase()}
function k(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+l(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+l(a)})}function h(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+
l(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+l(a)})}var g={literal:function(a){return'"'+k(a.text)+'"'},"class":function(a){var b="",c;for(c=0;c<a.parts.length;c++)b+=a.parts[c]instanceof Array?h(a.parts[c][0])+"-"+h(a.parts[c][1]):h(a.parts[c]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var e=
c,d;d=a[c];d=g[d.type](d);b[e]=d}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(b?'"'+k(b)+'"':"end of input")+" found."};return{SyntaxError:m,parse:function(a,b){function l(a,c){return{type:"literal",text:a,ignoreCase:c}}function k(a,c,b){return{type:"class",parts:a,inverted:c,ignoreCase:b}}function h(c){var b=Na[c],
e;if(!b){for(e=c-1;!Na[e];)e--;b=Na[e];for(b={line:b.line,column:b.column};e<c;)10===a.charCodeAt(e)?(b.line++,b.column=1):b.column++,e++;Na[c]=b}return b}function g(a,c){var b=h(a),e=h(c);return{start:{offset:a,line:b.line,column:b.column},end:{offset:c,line:e.line,column:e.column}}}function d(a){v<Ca||(v>Ca&&(Ca=v,cb=[]),cb.push(a))}function f(){var a,c,b;a=v;c=M();c!==r?(c=e(),c!==r?(b=M(),b!==r?a=c:(v=a,a=r)):(v=a,a=r)):(v=a,a=r);return a}function c(){var a,c,b,d,f,g,n,p;a=v;c=e();if(c!==r){b=
[];d=v;f=M();f!==r?(g=sa(),g!==r?(n=M(),n!==r?(p=e(),p!==r?d=f=[f,g,n,p]:(v=d,d=r)):(v=d,d=r)):(v=d,d=r)):(v=d,d=r);for(;d!==r;)b.push(d),d=v,f=M(),f!==r?(g=sa(),g!==r?(n=M(),n!==r?(p=e(),p!==r?d=f=[f,g,n,p]:(v=d,d=r)):(v=d,d=r)):(v=d,d=r)):(v=d,d=r);if(b!==r){a={type:"expr_list"};c=[c];for(d=0;d<b.length;d++)c.push(b[d][3]);a.value=c}else v=a,a=r}else v=a,a=r;return a}function e(){var a,c,b,e,d,f,g,p;a=v;c=n();if(c!==r){b=[];e=v;d=M();d!==r?(f=ga(),f!==r?(g=M(),g!==r?(p=n(),p!==r?e=d=[d,f,g,p]:(v=
e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r);for(;e!==r;)b.push(e),e=v,d=M(),d!==r?(f=ga(),f!==r?(g=M(),g!==r?(p=n(),p!==r?e=d=[d,f,g,p]:(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r);b!==r?a=c=Qa(c,b):(v=a,a=r)}else v=a,a=r;return a}function n(){var a,c,b,e,d,f,g,n;a=v;c=t();if(c!==r){b=[];e=v;d=M();d!==r?(f=Z(),f!==r?(g=M(),g!==r?(n=t(),n!==r?e=d=[d,f,g,n]:(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r);for(;e!==r;)b.push(e),e=v,d=M(),d!==r?(f=Z(),f!==r?(g=M(),g!==r?(n=t(),n!==r?e=d=[d,f,g,n]:(v=e,e=r)):(v=e,
e=r)):(v=e,e=r)):(v=e,e=r);b!==r?a=c=Qa(c,b):(v=a,a=r)}else v=a,a=r;return a}function t(){var b,e,f,g,n;b=v;e=ca();e===r&&(e=v,33===a.charCodeAt(v)?(f=Ta,v++):(f=r,0===J&&d(ob)),f!==r?(g=v,J++,61===a.charCodeAt(v)?(n=bb,v++):(n=r,0===J&&d(nb)),J--,n===r?g=void 0:(v=g,g=r),g!==r?e=f=[f,g]:(v=e,e=r)):(v=e,e=r));e!==r?(f=M(),f!==r?(g=t(),g!==r?b=e={type:"unary_expr",operator:"NOT",expr:g}:(v=b,b=r)):(v=b,b=r)):(v=b,b=r);if(b===r)if(b=v,e=u(),e!==r)if(f=M(),f!==r){var h,w,k;f=[];g=v;n=M();n!==r?(h=x(),
h!==r?(w=M(),w!==r?(k=u(),k!==r?g=n=[n,h,w,k]:(v=g,g=r)):(v=g,g=r)):(v=g,g=r)):(v=g,g=r);if(g!==r)for(;g!==r;)f.push(g),g=v,n=M(),n!==r?(h=x(),h!==r?(w=M(),w!==r?(k=u(),k!==r?g=n=[n,h,w,k]:(v=g,g=r)):(v=g,g=r)):(v=g,g=r)):(v=g,g=r);else f=r;f!==r&&(f={type:"arithmetic",tail:f});f===r&&(f=v,g=q(),g!==r?(n=M(),n!==r?(n=na(),n!==r?(n=M(),n!==r?(n=c(),n!==r?(h=M(),h!==r?(h=va(),h!==r?f=g={op:g,right:n}:(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r),f===r&&(f=v,g=q(),g!==r?
(n=M(),n!==r?(n=na(),n!==r?(n=M(),n!==r?(n=va(),n!==r?f=g={op:g,right:{type:"expr_list",value:[]}}:(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r),f===r&&(f=v,g=q(),g!==r?(n=M(),n!==r?(n=F(),n!==r?f=g={op:g,right:n}:(v=f,f=r)):(v=f,f=r)):(v=f,f=r))),f===r&&(f=v,n=ca(),n!==r?(g=M(),g!==r?(g=ea(),g!==r?(h=M(),h!==r?(h=u(),h!==r?(w=M(),w!==r?(w=Z(),w!==r?(n=M(),n!==r?(n=u(),n!==r?f=n={op:"NOT"+g,right:{type:"expr_list",value:[h,n]}}:(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=
r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r),f===r&&(f=v,n=ea(),n!==r?(g=M(),g!==r?(g=u(),g!==r?(h=M(),h!==r?(h=Z(),h!==r?(w=M(),w!==r?(w=u(),w!==r?f=n={op:n,right:{type:"expr_list",value:[g,w]}}:(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)),f===r&&(f=v,g=fa(),g!==r?(n=M(),n!==r?(n=ca(),n!==r?(n=M(),n!==r?(n=u(),n!==r?f=g={op:g+"NOT",right:n}:(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r),f===r&&(f=v,g=fa(),g!==r?(n=M(),n!==r?(n=u(),n!==r?f=g={op:g,right:n}:(v=f,f=r)):
(v=f,f=r)):(v=f,f=r)),f===r&&(f=v,g=p(),g!==r?(n=M(),n!==r?(n=O(),n!==r?(h=M(),h!==r?(h=v,a.substr(v,6).toLowerCase()===ad?(w=a.substr(v,6),v+=6):(w=r,0===J&&d(bd)),w!==r?(w=v,J++,k=E(),J--,k===r?w=void 0:(v=w,w=r),w!==r?h="ESCAPE":(v=h,h=r)):(v=h,h=r),h!==r?(h=M(),h!==r?(h=P(),h!==r?f=g={op:g,right:n,escape:h.value}:(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r)):(v=f,f=r),f===r&&(f=v,g=p(),g!==r?(n=M(),n!==r?(n=O(),n!==r?f=g={op:g,right:n,escape:""}:(v=f,f=r)):(v=f,f=r)):(v=f,
f=r))))));f===r&&(f=null);f!==r?(b=e,e=f,""==e||void 0==e||null==e?e=b:(f=null,e=f="arithmetic"==e.type?Qa(b,e.tail):Ma(e.op,b,e.right,e.escape)),b=e):(v=b,b=r)}else v=b,b=r;else v=b,b=r;return b}function x(){var c;a.substr(v,2)===pb?(c=pb,v+=2):(c=r,0===J&&d(cd));c===r&&(62===a.charCodeAt(v)?(c=dd,v++):(c=r,0===J&&d(ed)),c===r&&(a.substr(v,2)===qb?(c=qb,v+=2):(c=r,0===J&&d(fd)),c===r&&(a.substr(v,2)===rb?(c=rb,v+=2):(c=r,0===J&&d(gd)),c===r&&(60===a.charCodeAt(v)?(c=hd,v++):(c=r,0===J&&d(id)),c===
r&&(61===a.charCodeAt(v)?(c=bb,v++):(c=r,0===J&&d(nb)),c===r&&(a.substr(v,2)===sb?(c=sb,v+=2):(c=r,0===J&&d(jd))))))));return c}function p(){var a,c,b,e;a=a=v;c=ca();c!==r?(b=M(),b!==r?(e=aa(),e!==r?a=c=[c,b,e]:(v=a,a=r)):(v=a,a=r)):(v=a,a=r);a!==r&&(a=a[0]+" "+a[2]);a===r&&(a=aa());return a}function q(){var a,c,b,e;a=a=v;c=ca();c!==r?(b=M(),b!==r?(e=da(),e!==r?a=c=[c,b,e]:(v=a,a=r)):(v=a,a=r)):(v=a,a=r);a!==r&&(a=a[0]+" "+a[2]);a===r&&(a=da());return a}function u(){var a,c,b,e,d,f,g,n;a=v;c=w();
if(c!==r){b=[];e=v;d=M();d!==r?(f=y(),f!==r?(g=M(),g!==r?(n=w(),n!==r?e=d=[d,f,g,n]:(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r);for(;e!==r;)b.push(e),e=v,d=M(),d!==r?(f=y(),f!==r?(g=M(),g!==r?(n=w(),n!==r?e=d=[d,f,g,n]:(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r);b!==r?a=c=Qa(c,b):(v=a,a=r)}else v=a,a=r;return a}function y(){var c;43===a.charCodeAt(v)?(c=ec,v++):(c=r,0===J&&d(fc));c===r&&(45===a.charCodeAt(v)?(c=gc,v++):(c=r,0===J&&d(hc)));return c}function w(){var a,c,b,e,d,f,g,n;a=v;c=z();if(c!==r){b=
[];e=v;d=M();d!==r?(f=B(),f!==r?(g=M(),g!==r?(n=z(),n!==r?e=d=[d,f,g,n]:(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r);for(;e!==r;)b.push(e),e=v,d=M(),d!==r?(f=B(),f!==r?(g=M(),g!==r?(n=z(),n!==r?e=d=[d,f,g,n]:(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r);b!==r?a=c=Qa(c,b):(v=a,a=r)}else v=a,a=r;return a}function B(){var c;42===a.charCodeAt(v)?(c=kd,v++):(c=r,0===J&&d(ld));c===r&&(47===a.charCodeAt(v)?(c=md,v++):(c=r,0===J&&d(nd)));return c}function z(){var b,f,g,n,p,q,h;h=P();if(h===r){var w,t,k,y;w=v;
var l,u,x,B;l=v;u=Q();u!==r?(x=V(),x!==r?(B=R(),B!==r?l=u=parseFloat(u+x+B):(v=l,l=r)):(v=l,l=r)):(v=l,l=r);l===r&&(l=v,u=Q(),u!==r?(x=V(),x!==r?l=u=parseFloat(u+x):(v=l,l=r)):(v=l,l=r),l===r&&(l=v,u=Q(),u!==r?(x=R(),x!==r?l=u=parseFloat(u+x):(v=l,l=r)):(v=l,l=r),l===r&&(l=v,u=Q(),u!==r&&(u=parseFloat(u)),l=u)));t=l;t!==r?(k=v,J++,y=C(),J--,y===r?k=void 0:(v=k,k=r),k!==r?w=t={type:"number",value:t}:(v=w,w=r)):(v=w,w=r);h=w;if(h===r){var z,m;z=v;var G,L,K,X;G=v;a.substr(v,4).toLowerCase()===od?(L=
a.substr(v,4),v+=4):(L=r,0===J&&d(pd));L!==r?(K=v,J++,X=E(),J--,X===r?K=void 0:(v=K,K=r),K!==r?G=L=[L,K]:(v=G,G=r)):(v=G,G=r);m=G;m!==r&&(m={type:"bool",value:!0});z=m;if(z===r){z=v;var T,Ba,Ma,fa;T=v;a.substr(v,5).toLowerCase()===qd?(Ba=a.substr(v,5),v+=5):(Ba=r,0===J&&d(rd));Ba!==r?(Ma=v,J++,fa=E(),J--,fa===r?Ma=void 0:(v=Ma,Ma=r),Ma!==r?T=Ba=[Ba,Ma]:(v=T,T=r)):(v=T,T=r);m=T;m!==r&&(m={type:"bool",value:!1});z=m}h=z;if(h===r){var aa,ca,ga,Z,Qa;ca=v;a.substr(v,4).toLowerCase()===sd?(ga=a.substr(v,
4),v+=4):(ga=r,0===J&&d(td));ga!==r?(Z=v,J++,Qa=E(),J--,Qa===r?Z=void 0:(v=Z,Z=r),Z!==r?ca=ga=[ga,Z]:(v=ca,ca=r)):(v=ca,ca=r);aa=ca;aa!==r&&(aa={type:"null",value:null});h=aa;if(h===r){var ea,ab,mb,ra;ea=v;var qa,sa,Ta,Ca;qa=v;a.substr(v,4).toLowerCase()===ud?(sa=a.substr(v,4),v+=4):(sa=r,0===J&&d(vd));sa!==r?(Ta=v,J++,Ca=E(),J--,Ca===r?Ta=void 0:(v=Ta,Ta=r),Ta!==r?qa=sa="DATE":(v=qa,qa=r)):(v=qa,qa=r);ab=qa;ab!==r?(mb=M(),mb!==r?(ra=O(),ra!==r?ea=ab={type:"date",value:ra.value}:(v=ea,ea=r)):(v=ea,
ea=r)):(v=ea,ea=r);h=ea;if(h===r){var Oa,ob,nb,bb;Oa=v;var Ua,Na,tb,$a;Ua=v;a.substr(v,9).toLowerCase()===wd?(Na=a.substr(v,9),v+=9):(Na=r,0===J&&d(xd));Na!==r?(tb=v,J++,$a=E(),J--,$a===r?tb=void 0:(v=tb,tb=r),tb!==r?Ua=Na="TIMESTAMP":(v=Ua,Ua=r)):(v=Ua,Ua=r);ob=Ua;ob!==r?(nb=M(),nb!==r?(bb=O(),bb!==r?Oa=ob={type:"timestamp",value:bb.value}:(v=Oa,Oa=r)):(v=Oa,Oa=r)):(v=Oa,Oa=r);h=Oa;if(h===r){var ha,db,Pa,Ka,Lb,eb,cb,ic;ha=v;db=ua();db!==r?(Pa=M(),Pa!==r?(45===a.charCodeAt(v)?(Ka=gc,v++):(Ka=r,0===
J&&d(hc)),Ka===r&&(43===a.charCodeAt(v)?(Ka=ec,v++):(Ka=r,0===J&&d(fc))),Ka!==r?(Lb=M(),Lb!==r?(eb=O(),eb!==r?(cb=M(),cb!==r?(ic=I(),ic!==r?ha=db={type:"interval",value:eb,qualifier:ic,op:Ka}:(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r);ha===r&&(ha=v,db=ua(),db!==r?(Pa=M(),Pa!==r?(Ka=O(),Ka!==r?(Lb=M(),Lb!==r?(eb=I(),eb!==r?ha=db={type:"interval",value:Ka,qualifier:eb,op:""}:(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r)):(v=ha,ha=r));h=ha}}}}}}b=h;
if(b===r){var oa,jc,pb,qb,rb,kc,sb,Db,Eb,lc,Fb,Gb;oa=v;var Va,Mb,ub,Hb;Va=v;a.substr(v,7).toLowerCase()===yd?(Mb=a.substr(v,7),v+=7):(Mb=r,0===J&&d(zd));Mb!==r?(ub=v,J++,Hb=E(),J--,Hb===r?ub=void 0:(v=ub,ub=r),ub!==r?Va=Mb="EXTRACT":(v=Va,Va=r)):(v=Va,Va=r);jc=Va;if(jc!==r)if(pb=M(),pb!==r)if(qb=na(),qb!==r)if(rb=M(),rb!==r){var Fa;Fa=xa();Fa===r&&(Fa=Da(),Fa===r&&(Fa=Ea(),Fa===r&&(Fa=ta(),Fa===r&&(Fa=Aa(),Fa===r&&(Fa=U())))));kc=Fa;kc!==r?(sb=M(),sb!==r?(Db=la(),Db!==r?(Eb=M(),Eb!==r?(lc=e(),lc!==
r?(Fb=M(),Fb!==r?(Gb=va(),Gb!==r?oa=jc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:kc},lc]}}:(v=oa,oa=r)):(v=oa,oa=r)):(v=oa,oa=r)):(v=oa,oa=r)):(v=oa,oa=r)):(v=oa,oa=r)):(v=oa,oa=r)}else v=oa,oa=r;else v=oa,oa=r;else v=oa,oa=r;else v=oa,oa=r;b=oa;if(b===r){var ka,mc,Ib,Jb,Kb,Nb,wc,xc,yc,Ob,zc,za,fb,nc,oc,pc;ka=v;var Wa,Pb,vb,Ac;Wa=v;a.substr(v,9).toLowerCase()===Ad?(Pb=a.substr(v,9),v+=9):(Pb=r,0===J&&d(Bd));Pb!==r?(vb=v,J++,Ac=E(),J--,Ac===r?vb=void 0:(v=vb,
vb=r),vb!==r?Wa=Pb="SUBSTRING":(v=Wa,Wa=r)):(v=Wa,Wa=r);mc=Wa;if(mc!==r)if(Ib=M(),Ib!==r)if(Jb=na(),Jb!==r)if(Kb=M(),Kb!==r)if(Nb=e(),Nb!==r)if(wc=M(),wc!==r)if(xc=la(),xc!==r)if(yc=M(),yc!==r)if(Ob=e(),Ob!==r)if(zc=M(),zc!==r){za=v;var Xa,Qb,wb,Bc;Xa=v;a.substr(v,3).toLowerCase()===Cd?(Qb=a.substr(v,3),v+=3):(Qb=r,0===J&&d(Dd));Qb!==r?(wb=v,J++,Bc=E(),J--,Bc===r?wb=void 0:(v=wb,wb=r),wb!==r?Xa=Qb="FOR":(v=Xa,Xa=r)):(v=Xa,Xa=r);fb=Xa;fb!==r?(nc=M(),nc!==r?(oc=e(),oc!==r?(pc=M(),pc!==r?za=fb=[fb,nc,
oc,pc]:(v=za,za=r)):(v=za,za=r)):(v=za,za=r)):(v=za,za=r);za===r&&(za=null);za!==r?(fb=va(),fb!==r?ka=mc={type:"function",name:"substring",args:{type:"expr_list",value:za?[Nb,Ob,za[2]]:[Nb,Ob]}}:(v=ka,ka=r)):(v=ka,ka=r)}else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;else v=ka,ka=r;b=ka;if(b===r){var Y,gb,Rb,Sb,Tb,Ga,Ub,hb,Vb,Wb,Cc,qc,Dc,Ec;Y=v;gb=ja();gb!==r?(Rb=M(),Rb!==r?(Sb=na(),Sb!==r?(Tb=M(),Tb!==r?(Ga=H(),
Ga===r&&(Ga=null),Ga!==r?(Ub=M(),Ub!==r?(hb=e(),hb!==r?(Vb=M(),Vb!==r?(Wb=la(),Wb!==r?(Cc=M(),Cc!==r?(qc=e(),qc!==r?(Dc=M(),Dc!==r?(Ec=va(),Ec!==r?Y=gb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Ga?"BOTH":Ga},hb,qc]}}:(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r);Y===r&&(Y=v,gb=ja(),gb!==r?(Rb=M(),Rb!==r?(Sb=na(),Sb!==r?(Tb=M(),Tb!==r?(Ga=H(),Ga===r&&(Ga=null),
Ga!==r?(Ub=M(),Ub!==r?(hb=e(),hb!==r?(Vb=M(),Vb!==r?(Wb=va(),Wb!==r?Y=gb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Ga?"BOTH":Ga},hb]}}:(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r)):(v=Y,Y=r));b=Y;if(b===r){var pa,rc,Fc,Gc,Hc,sc,Ic,Jc,Kc,tc,Lc,Mc;pa=v;var Ya,Xb,xb,Nc;Ya=v;a.substr(v,8).toLowerCase()===Ed?(Xb=a.substr(v,8),v+=8):(Xb=r,0===J&&d(Fd));Xb!==r?(xb=v,J++,Nc=E(),J--,Nc===r?xb=void 0:(v=xb,xb=r),xb!==r?Ya=
Xb="POSITION":(v=Ya,Ya=r)):(v=Ya,Ya=r);rc=Ya;rc!==r?(Fc=M(),Fc!==r?(Gc=na(),Gc!==r?(Hc=M(),Hc!==r?(sc=e(),sc!==r?(Ic=M(),Ic!==r?(Jc=da(),Jc!==r?(Kc=M(),Kc!==r?(tc=e(),tc!==r?(Lc=M(),Lc!==r?(Mc=va(),Mc!==r?pa=rc={type:"function",name:"position",args:{type:"expr_list",value:[sc,tc]}}:(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r)):(v=pa,pa=r);b=pa;if(b===r){var wa,Yb,Oc,Pc,Qc,ib,Rc,Sc;wa=v;var Ha,yb,zb,La;Ha=v;Ha=yb=A();
if(Ha===r)if(Ha=v,96===a.charCodeAt(v)?(yb=Tc,v++):(yb=r,0===J&&d(Uc)),yb!==r){zb=[];Vc.test(a.charAt(v))?(La=a.charAt(v),v++):(La=r,0===J&&d(Wc));if(La!==r)for(;La!==r;)zb.push(La),Vc.test(a.charAt(v))?(La=a.charAt(v),v++):(La=r,0===J&&d(Wc));else zb=r;zb!==r?(96===a.charCodeAt(v)?(La=Tc,v++):(La=r,0===J&&d(Uc)),La!==r?Ha=yb=zb.join(""):(v=Ha,Ha=r)):(v=Ha,Ha=r)}else v=Ha,Ha=r;Yb=Ha;Yb!==r?(Oc=M(),Oc!==r?(Pc=na(),Pc!==r?(Qc=M(),Qc!==r?(ib=c(),ib===r&&(ib=null),ib!==r?(Rc=M(),Rc!==r?(Sc=va(),Sc!==
r?wa=Yb={type:"function",name:Yb,args:ib?ib:{type:"expr_list",value:[]}}:(v=wa,wa=r)):(v=wa,wa=r)):(v=wa,wa=r)):(v=wa,wa=r)):(v=wa,wa=r)):(v=wa,wa=r)):(v=wa,wa=r);b=wa;if(b===r){var Zb,ba,jb,$b,kb,ac,Ra,Ia,Ab,Xc,Yc;ba=v;jb=ma();if(jb!==r)if($b=M(),$b!==r)if(kb=e(),kb!==r)if(ac=M(),ac!==r){Ra=[];for(Ia=S();Ia!==r;)Ra.push(Ia),Ia=S();Ra!==r?(Ia=M(),Ia!==r?(Ab=ya(),Ab!==r?ba=jb={type:"case_expression",format:"simple",operand:kb,clauses:Ra,else:null}:(v=ba,ba=r)):(v=ba,ba=r)):(v=ba,ba=r)}else v=ba,ba=
r;else v=ba,ba=r;else v=ba,ba=r;else v=ba,ba=r;if(ba===r)if(ba=v,jb=ma(),jb!==r)if($b=M(),$b!==r)if(kb=e(),kb!==r)if(ac=M(),ac!==r){Ra=[];for(Ia=S();Ia!==r;)Ra.push(Ia),Ia=S();Ra!==r?(Ia=M(),Ia!==r?(Ab=W(),Ab!==r?(Xc=M(),Xc!==r?(Yc=ya(),Yc!==r?ba=jb={type:"case_expression",format:"simple",operand:kb,clauses:Ra,else:Ab.value}:(v=ba,ba=r)):(v=ba,ba=r)):(v=ba,ba=r)):(v=ba,ba=r)):(v=ba,ba=r)}else v=ba,ba=r;else v=ba,ba=r;else v=ba,ba=r;else v=ba,ba=r;Zb=ba;if(Zb===r){var ia,lb,bc,Sa,Ja,Bb,Zc,$c;ia=v;
lb=ma();if(lb!==r)if(bc=M(),bc!==r){Sa=[];for(Ja=N();Ja!==r;)Sa.push(Ja),Ja=N();Sa!==r?(Ja=M(),Ja!==r?(Bb=ya(),Bb!==r?ia=lb={type:"case_expression",format:"searched",clauses:Sa,else:null}:(v=ia,ia=r)):(v=ia,ia=r)):(v=ia,ia=r)}else v=ia,ia=r;else v=ia,ia=r;if(ia===r)if(ia=v,lb=ma(),lb!==r)if(bc=M(),bc!==r){Sa=[];for(Ja=N();Ja!==r;)Sa.push(Ja),Ja=N();Sa!==r?(Ja=M(),Ja!==r?(Bb=W(),Bb!==r?(Zc=M(),Zc!==r?($c=ya(),$c!==r?ia=lb={type:"case_expression",format:"searched",clauses:Sa,else:Bb.value}:(v=ia,ia=
r)):(v=ia,ia=r)):(v=ia,ia=r)):(v=ia,ia=r)):(v=ia,ia=r)}else v=ia,ia=r;else v=ia,ia=r;Zb=ia}b=Zb;if(b===r){var Cb,Za,uc,cc,dc;Za=v;uc=C();if(uc!==r){cc=[];for(dc=D();dc!==r;)cc.push(dc),dc=D();cc!==r?Za=uc+=cc.join(""):(v=Za,Za=r)}else v=Za,Za=r;Cb=Za;if(Cb!==r){var vc=Cb;Cb=/^CURRENT_DATE$/i.test(vc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(vc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:vc}}b=Cb;b===r&&(b=F(),b===r&&(b=v,f=na(),f!==r?(g=M(),g!==
r?(n=e(),n!==r?(p=M(),p!==r?(q=va(),q!==r?(n.paren=!0,b=f=n):(v=b,b=r)):(v=b,b=r)):(v=b,b=r)):(v=b,b=r)):(v=b,b=r)))}}}}}}}return b}function A(){var a,c,b,e;a=v;c=C();if(c!==r){b=[];for(e=E();e!==r;)b.push(e),e=E();b!==r?a=c+=b.join(""):(v=a,a=r)}else v=a,a=r;return a}function C(){var c;Gd.test(a.charAt(v))?(c=a.charAt(v),v++):(c=r,0===J&&d(Hd));return c}function E(){var c;Id.test(a.charAt(v))?(c=a.charAt(v),v++):(c=r,0===J&&d(Jd));return c}function D(){var c;Kd.test(a.charAt(v))?(c=a.charAt(v),v++):
(c=r,0===J&&d(Ld));return c}function F(){var c,b,e;c=v;64===a.charCodeAt(v)?(b=Md,v++):(b=r,0===J&&d(Nd));b!==r?(e=A(),e!==r?c=b=[b,e]:(v=c,c=r)):(v=c,c=r);c!==r&&(c={type:"param",value:c[1]});return c}function H(){var c,b,e;c=v;a.substr(v,7).toLowerCase()===Od?(b=a.substr(v,7),v+=7):(b=r,0===J&&d(Pd));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="LEADING":(v=c,c=r)):(v=c,c=r);c===r&&(c=v,a.substr(v,8).toLowerCase()===Qd?(b=a.substr(v,8),v+=8):(b=r,0===J&&d(Rd)),b!==r?(b=v,J++,e=E(),
J--,e===r?b=void 0:(v=b,b=r),b!==r?c="TRAILING":(v=c,c=r)):(v=c,c=r),c===r&&(c=v,a.substr(v,4).toLowerCase()===Sd?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(Td)),b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="BOTH":(v=c,c=r)):(v=c,c=r)));return c}function I(){var c,b,e;c=v;var f,g;b=v;e=G();e!==r?(f=M(),f!==r?(f=na(),f!==r?(f=M(),f!==r?(f=L(),f!==r?(g=M(),g!==r?(g=va(),g!==r?b=e={type:"interval-period",period:e.value,precision:f,secondary:null}:(v=b,b=r)):(v=b,b=r)):(v=b,b=r)):(v=b,b=r)):(v=
b,b=r)):(v=b,b=r)):(v=b,b=r);b===r&&(b=v,e=G(),e!==r&&(e=Db(e)),b=e);if(b!==r)if(e=M(),e!==r)if(e=v,a.substr(v,2).toLowerCase()===Ud?(f=a.substr(v,2),v+=2):(f=r,0===J&&d(Vd)),f!==r?(f=v,J++,g=E(),J--,g===r?f=void 0:(v=f,f=r),f!==r?e="TO":(v=e,e=r)):(v=e,e=r),e!==r)if(e=M(),e!==r){var n;e=v;f=G();f!==r&&(f={type:"interval-period",period:f.value,precision:null,secondary:null});e=f;e===r&&(e=v,f=U(),f!==r?(f=M(),f!==r?(f=na(),f!==r?(f=M(),f!==r?(f=L(),f!==r?(g=M(),g!==r?(g=sa(),g!==r?(g=M(),g!==r?(g=
K(),g!==r?(n=M(),n!==r?(n=va(),n!==r?e=f=Eb(f,g):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r),e===r&&(e=v,f=U(),f!==r?(f=M(),f!==r?(f=na(),f!==r?(f=M(),f!==r?(f=L(),f!==r?(g=M(),g!==r?(g=va(),g!==r?e=f={type:"interval-period",period:"second",precision:f,secondary:null}:(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r)):(v=e,e=r),e===r&&(e=v,f=U(),f!==r&&(f={type:"interval-period",period:"second",precision:null,
secondary:null}),e=f)));e!==r?c=b={type:"interval-qualifier",start:b,end:e}:(v=c,c=r)}else v=c,c=r;else v=c,c=r;else v=c,c=r;else v=c,c=r;c===r&&(c=v,e=G(),e!==r?(b=M(),b!==r?(b=na(),b!==r?(b=M(),b!==r?(b=K(),b!==r?(f=M(),f!==r?(f=va(),f!==r?c=e={type:"interval-period",period:e.value,precision:b,secondary:null}:(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r),c===r&&(c=v,e=G(),e!==r&&(e=Db(e)),c=e,c===r&&(c=v,e=U(),e!==r?(b=M(),b!==r?(b=na(),b!==r?(b=M(),b!==r?(b=L(),b!==
r?(f=M(),f!==r?(f=sa(),f!==r?(e=M(),e!==r?(e=K(),e!==r?(f=M(),f!==r?(f=va(),f!==r?c=e=Eb(b,e):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r),c===r&&(c=v,e=U(),e!==r?(b=M(),b!==r?(b=na(),b!==r?(b=M(),b!==r?(b=K(),b!==r?(f=M(),f!==r?(f=va(),f!==r?c=e={type:"interval-period",period:"second",precision:b,secondary:null}:(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r)):(v=c,c=r),c===r&&(c=v,e=U(),e!==r&&(e={type:"interval-period",
period:"second",precision:null,secondary:null}),c=e)))));return c}function G(){var a;a=v;a=Ea();a!==r&&(a={type:"string",value:"day"});a===r&&(a=v,a=ta(),a!==r&&(a={type:"string",value:"hour"}),a===r&&(a=v,a=Aa(),a!==r&&(a={type:"string",value:"minute"}),a===r&&(a=v,a=Da(),a!==r&&(a={type:"string",value:"month"}),a===r&&(a=v,a=xa(),a!==r&&(a={type:"string",value:"year"})))));return a}function K(){var a;a=T();a!==r&&(a=parseFloat(a));return a}function L(){var a;a=T();a!==r&&(a=parseFloat(a));return a}
function O(){var a;a=P();a===r&&(a=F());return a}function P(){var c,b,e;c=v;39===a.charCodeAt(v)?(b=Fb,v++):(b=r,0===J&&d(Gb));b===r&&(a.substr(v,2)===Hb?(b=Hb,v+=2):(b=r,0===J&&d(Wd)));if(b!==r){b=[];e=v;a.substr(v,2)===$a?(e=$a,v+=2):(e=r,0===J&&d(Ib));e!==r&&(e="'");e===r&&(Jb.test(a.charAt(v))?(e=a.charAt(v),v++):(e=r,0===J&&d(Kb)));for(;e!==r;)b.push(e),e=v,a.substr(v,2)===$a?(e=$a,v+=2):(e=r,0===J&&d(Ib)),e!==r&&(e="'"),e===r&&(Jb.test(a.charAt(v))?(e=a.charAt(v),v++):(e=r,0===J&&d(Kb)));b!==
r?(39===a.charCodeAt(v)?(e=Fb,v++):(e=r,0===J&&d(Gb)),e!==r?c=b={type:"string",value:b.join("")}:(v=c,c=r)):(v=c,c=r)}else v=c,c=r;return c}function N(){var a,c,b;a=v;c=ra();c!==r?(c=M(),c!==r?(c=e(),c!==r?(b=M(),b!==r?(b=qa(),b!==r?(b=M(),b!==r?(b=e(),b!==r?a=c={type:"when_clause",operand:c,value:b}:(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r);return a}function S(){var a,c,b;a=v;c=ra();c!==r?(c=M(),c!==r?(c=e(),c!==r?(b=M(),b!==r?(b=qa(),b!==r?(b=M(),b!==r?(b=e(),b!==
r?a=c={type:"when_clause",operand:c,value:b}:(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r)):(v=a,a=r);return a}function W(){var c,b;c=v;var f,g;b=v;a.substr(v,4).toLowerCase()===Xd?(f=a.substr(v,4),v+=4):(f=r,0===J&&d(Yd));f!==r?(f=v,J++,g=E(),J--,g===r?f=void 0:(v=f,f=r),f!==r?b="ELSE":(v=b,b=r)):(v=b,b=r);b!==r?(b=M(),b!==r?(b=e(),b!==r?c={type:"else_clause",value:b}:(v=c,c=r)):(v=c,c=r)):(v=c,c=r);return c}function Q(){var c,b,e;c=T();c===r&&(c=v,45===a.charCodeAt(v)?(b=gc,v++):
(b=r,0===J&&d(hc)),b===r&&(43===a.charCodeAt(v)?(b=ec,v++):(b=r,0===J&&d(fc))),b!==r?(e=T(),e!==r?c=b=b[0]+e:(v=c,c=r)):(v=c,c=r));return c}function V(){var c,b;c=v;46===a.charCodeAt(v)?(b=Zd,v++):(b=r,0===J&&d($d));b!==r?(b=T(),b===r&&(b=null),b!==r?c="."+(null!=b?b:""):(v=c,c=r)):(v=c,c=r);return c}function R(){var c,b,e;b=c=v;ae.test(a.charAt(v))?(e=a.charAt(v),v++):(e=r,0===J&&d(be));e!==r?(ce.test(a.charAt(v))?(e=a.charAt(v),v++):(e=r,0===J&&d(de)),e===r&&(e=null),e!==r?b="e"+(null===e?"":e):
(v=b,b=r)):(v=b,b=r);b!==r?(e=T(),e!==r?c=b+e:(v=c,c=r)):(v=c,c=r);return c}function T(){var a,c;a=[];c=X();if(c!==r)for(;c!==r;)a.push(c),c=X();else a=r;a!==r&&(a=a.join(""));return a}function X(){var c;ee.test(a.charAt(v))?(c=a.charAt(v),v++):(c=r,0===J&&d(fe));return c}function da(){var c,b,e;c=v;a.substr(v,2).toLowerCase()===ge?(b=a.substr(v,2),v+=2):(b=r,0===J&&d(he));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="IN":(v=c,c=r)):(v=c,c=r);return c}function fa(){var c,b,e;c=v;a.substr(v,
2).toLowerCase()===ie?(b=a.substr(v,2),v+=2):(b=r,0===J&&d(je));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="IS":(v=c,c=r)):(v=c,c=r);return c}function aa(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===ke?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(le));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="LIKE":(v=c,c=r)):(v=c,c=r);return c}function ca(){var c,b,e;c=v;a.substr(v,3).toLowerCase()===me?(b=a.substr(v,3),v+=3):(b=r,0===J&&d(ne));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=
b,b=r),b!==r?c="NOT":(v=c,c=r)):(v=c,c=r);return c}function Z(){var c,b,e;c=v;a.substr(v,3).toLowerCase()===oe?(b=a.substr(v,3),v+=3):(b=r,0===J&&d(pe));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="AND":(v=c,c=r)):(v=c,c=r);return c}function ga(){var c,b,e;c=v;a.substr(v,2).toLowerCase()===qe?(b=a.substr(v,2),v+=2):(b=r,0===J&&d(re));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="OR":(v=c,c=r)):(v=c,c=r);return c}function ea(){var c,b,e;c=v;a.substr(v,7).toLowerCase()===
se?(b=a.substr(v,7),v+=7):(b=r,0===J&&d(te));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="BETWEEN":(v=c,c=r)):(v=c,c=r);return c}function la(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===ue?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(ve));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="FROM":(v=c,c=r)):(v=c,c=r);return c}function ja(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===we?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(xe));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c=
"TRIM":(v=c,c=r)):(v=c,c=r);return c}function ua(){var c,b,e;c=v;a.substr(v,8).toLowerCase()===ye?(b=a.substr(v,8),v+=8):(b=r,0===J&&d(ze));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="INTERVAL":(v=c,c=r)):(v=c,c=r);return c}function xa(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===Ae?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(Be));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="YEAR":(v=c,c=r)):(v=c,c=r);return c}function Da(){var c,b,e;c=v;a.substr(v,5).toLowerCase()===Ce?(b=
a.substr(v,5),v+=5):(b=r,0===J&&d(De));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="MONTH":(v=c,c=r)):(v=c,c=r);return c}function Ea(){var c,b,e;c=v;a.substr(v,3).toLowerCase()===Ee?(b=a.substr(v,3),v+=3):(b=r,0===J&&d(Fe));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="DAY":(v=c,c=r)):(v=c,c=r);return c}function ta(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===Ge?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(He));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="HOUR":(v=
c,c=r)):(v=c,c=r);return c}function Aa(){var c,b,e;c=v;a.substr(v,6).toLowerCase()===Ie?(b=a.substr(v,6),v+=6):(b=r,0===J&&d(Je));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="MINUTE":(v=c,c=r)):(v=c,c=r);return c}function U(){var c,b,e;c=v;a.substr(v,6).toLowerCase()===Ke?(b=a.substr(v,6),v+=6):(b=r,0===J&&d(Le));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="SECOND":(v=c,c=r)):(v=c,c=r);return c}function ma(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===Me?(b=a.substr(v,
4),v+=4):(b=r,0===J&&d(Ne));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="CASE":(v=c,c=r)):(v=c,c=r);return c}function ya(){var c,b,e;c=v;a.substr(v,3).toLowerCase()===Oe?(b=a.substr(v,3),v+=3):(b=r,0===J&&d(Pe));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="END":(v=c,c=r)):(v=c,c=r);return c}function ra(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===Qe?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(Re));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="WHEN":(v=c,c=r)):(v=
c,c=r);return c}function qa(){var c,b,e;c=v;a.substr(v,4).toLowerCase()===Se?(b=a.substr(v,4),v+=4):(b=r,0===J&&d(Te));b!==r?(b=v,J++,e=E(),J--,e===r?b=void 0:(v=b,b=r),b!==r?c="THEN":(v=c,c=r)):(v=c,c=r);return c}function sa(){var c;44===a.charCodeAt(v)?(c=Ue,v++):(c=r,0===J&&d(Ve));return c}function na(){var c;40===a.charCodeAt(v)?(c=We,v++):(c=r,0===J&&d(Xe));return c}function va(){var c;41===a.charCodeAt(v)?(c=Ye,v++):(c=r,0===J&&d(Ze));return c}function M(){var a,c;a=[];for(c=Ba();c!==r;)a.push(c),
c=Ba();return a}function Ba(){var c;$e.test(a.charAt(v))?(c=a.charAt(v),v++):(c=r,0===J&&d(af));return c}function Ma(a,c,b,e){a={type:"binary_expr",operator:a,left:c,right:b};void 0!==e&&(a.escape=e);return a}function Qa(a,c){for(var b=0;b<c.length;b++)a=Ma(c[b][1],a,c[b][3]);return a}b=void 0!==b?b:{};var r={},ab={start:f},mb=f,Ta="!",ob=l("!",!1),bb="\x3d",nb=l("\x3d",!1),pb="\x3e\x3d",cd=l("\x3e\x3d",!1),dd="\x3e",ed=l("\x3e",!1),qb="\x3c\x3d",fd=l("\x3c\x3d",!1),rb="\x3c\x3e",gd=l("\x3c\x3e",
!1),hd="\x3c",id=l("\x3c",!1),sb="!\x3d",jd=l("!\x3d",!1),ec="+",fc=l("+",!1),gc="-",hc=l("-",!1),kd="*",ld=l("*",!1),md="/",nd=l("/",!1),Gd=/^[A-Za-z_\x80-\uFFFF]/,Hd=k([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Id=/^[A-Za-z0-9_]/,Jd=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Kd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ld=k([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Md="@",Nd=l("@",!1),Db=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},
Eb=function(a,c){return{type:"interval-period",period:"second",precision:a,secondary:c}},Fb="'",Gb=l("'",!1),Hb="N'",Wd=l("N'",!1),$a="''",Ib=l("''",!1),Jb=/^[^']/,Kb=k(["'"],!0,!1),Zd=".",$d=l(".",!1),ee=/^[0-9]/,fe=k([["0","9"]],!1,!1),ae=/^[eE]/,be=k(["e","E"],!1,!1),ce=/^[+\-]/,de=k(["+","-"],!1,!1),sd="null",td=l("NULL",!0),od="true",pd=l("TRUE",!0),qd="false",rd=l("FALSE",!0),ge="in",he=l("IN",!0),ie="is",je=l("IS",!0),ke="like",le=l("LIKE",!0),ad="escape",bd=l("ESCAPE",!0),me="not",ne=l("NOT",
!0),oe="and",pe=l("AND",!0),qe="or",re=l("OR",!0),se="between",te=l("BETWEEN",!0),ue="from",ve=l("FROM",!0),Cd="for",Dd=l("FOR",!0),Ad="substring",Bd=l("SUBSTRING",!0),yd="extract",zd=l("EXTRACT",!0),we="trim",xe=l("TRIM",!0),Ed="position",Fd=l("POSITION",!0),wd="timestamp",xd=l("TIMESTAMP",!0),ud="date",vd=l("DATE",!0),Od="leading",Pd=l("LEADING",!0),Qd="trailing",Rd=l("TRAILING",!0),Sd="both",Td=l("BOTH",!0),Ud="to",Vd=l("TO",!0),ye="interval",ze=l("INTERVAL",!0),Ae="year",Be=l("YEAR",!0),Ce="month",
De=l("MONTH",!0),Ee="day",Fe=l("DAY",!0),Ge="hour",He=l("HOUR",!0),Ie="minute",Je=l("MINUTE",!0),Ke="second",Le=l("SECOND",!0),Me="case",Ne=l("CASE",!0),Oe="end",Pe=l("END",!0),Qe="when",Re=l("WHEN",!0),Se="then",Te=l("THEN",!0),Xd="else",Yd=l("ELSE",!0),Ue=",",Ve=l(",",!1),We="(",Xe=l("(",!1),Ye=")",Ze=l(")",!1),$e=/^[ \t\n\r]/,af=k([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=l("`",!1),Vc=/^[^`]/,Wc=k(["`"],!0,!1),v=0,Na=[{line:1,column:1}],Ca=0,cb=[],J=0,Pa;if("startRule"in b){if(!(b.startRule in ab))throw Error("Can't start parsing from rule \""+
b.startRule+'".');mb=ab[b.startRule]}Pa=mb();if(Pa!==r&&v===a.length)return Pa;Pa!==r&&v<a.length&&d({type:"end"});throw function(a,c,b){return new m(m.buildMessage(a,c),a,c,b)}(cb,Ca<a.length?a.charAt(Ca):null,Ca<a.length?g(Ca,Ca+1):g(Ca,Ca));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(m,a,b,l,k,h,g,d,f){function c(a,c){var b;if(!c)return null;if("x"in c){var d={x:0,y:0};a=a(c.x,c.y,x);d.x=a[0];d.y=a[1];null!=c.z&&(d.z=c.z);null!=c.m&&(d.m=c.m);return d}if("xmin"in c)return d={xmin:0,ymin:0,xmax:0,ymax:0},b=a(c.xmin,c.ymin,x),d.xmin=b[0],d.ymin=b[1],a=a(c.xmax,c.ymax,x),d.xmax=a[0],d.ymax=a[1],c.hasZ&&(d.zmin=c.zmin,d.zmax=c.zmax,d.hasZ=!0),c.hasM&&(d.mmin=c.mmin,d.mmax=c.mmax,d.hasM=!0),d;if("rings"in c)return{rings:e(c.rings,a),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:e(c.paths,
a),hasM:c.hasM,hasZ:c.hasZ};if("points"in c)return{points:n(c.points,a),hasM:c.hasM,hasZ:c.hasZ}}function e(a,c){for(var b=[],e=0;e<a.length;e++)b.push(n(a[e],c));return b}function n(a,c){for(var b=[],e=0;e<a.length;e++){var d=a[e],f=c(d[0],d[1],[0,0]);b.push(f);2<d.length&&f.push(d[2]);3<d.length&&f.push(d[3])}return b}function t(a,c){return!d.isValid(a)||!d.isValid(c)||d.equals(a,c)||f.canProject(a,c)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});a.projectMany=a.project=a.checkProjectionSupport=
a.doesBrowserSupportProjection=void 0;var x=[0,0];a.doesBrowserSupportProjection=function(a,c){return t(a,c)?h.isSupported():!0};a.checkProjectionSupport=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f;return b.__generator(this,function(b){if(!c)return[2];if(Array.isArray(a)){e=0;for(d=a;e<d.length;e++)if(f=d[e],t(f.geometry&&f.geometry.spatialReference,c)){if(h.isSupported())return[2,h.load()];throw new l("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,
outSpatialReference:c});}return[2]}if(!t(a,c))return[2];if(h.isSupported())return[2,h.load()];throw new l("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});})})};var p=c.bind(null,f.lngLatToXY),q=c.bind(null,f.xyToLngLat);a.project=function(a,c,b){if(!a)return a;b||(b=c,c=a.spatialReference);return d.isValid(c)&&d.isValid(b)&&!d.equals(c,b)?f.canProject(c,b)?d.isWebMercator(b)?p(a):q(a):h.projectMany(g.jsonAdapter,[a],c,b,null)[0]:a};var u=
new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var f,g=this;return b.__generator(this,function(b){a&&a.length&&c&&e&&!d.equals(c,e)||k.resolve(a);f={geometries:a,inSpatialReference:c,outSpatialReference:e,resolve:null};this._jobs.push(f);return[2,k.create(function(a){f.resolve=a;null===g._timer&&(g._timer=setTimeout(g._process,10))})]})})};a.prototype._process=function(){this._timer=
null;var a=this._jobs.shift();if(a){var c=a.geometries,b=a.inSpatialReference,e=a.outSpatialReference,a=a.resolve;f.canProject(b,e)?d.isWebMercator(e)?a(c.map(p)):a(c.map(q)):a(h.projectMany(g.jsonAdapter,c,b,e,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){return[2,u.push(a,c,e)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k){function h(a,c,b,f,q){void 0===q&&(q=null);if(null===q){var n=k.cacheKey(b,f);void 0!==e[n]?q=e[n]:(q=g(b,f,null),null===q&&(q=new k),e[n]=q)}return d._project(a,c,b,f,q)}function g(a,c,b){void 0===b&&(b=null);a=d._getTransformation(f,a,c,b,null===b||void 0===b?void 0:b.spatialReference);return null!==a?k.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});a.getTransformations=a.getTransformation=a.projectMany=a.project=a.load=a.isSupported=a.isLoaded=void 0;var d=
null,f=null;a.isLoaded=function(){return!!d&&l.isLoaded()};a.isSupported=function(){return l.isSupported()};var c=null;a.load=function(){return c?c:c=b.all([l.load(),new Promise(function(a,c){m(["./geometryEngineBase"],a,c)}),new Promise(function(a,c){m(["./geometryAdapters/hydrated"],a,c)})]).then(function(a){var c=a[1];f=a[2].hydratedAdapter;d=c;d._enableProjection(l)})};a.project=function(a,c,b){void 0===b&&(b=null);return a instanceof Array?0===a.length?[]:h(f,a,a[0].spatialReference,c,b):h(f,
[a],a.spatialReference,c,b)[0]};var e={};a.projectMany=h;a.getTransformation=g;a.getTransformations=function(a,c,b){void 0===b&&(b=null);a=d._getTransformationBySuitability(f,a,c,b,null===b||void 0===b?void 0:b.spatialReference);if(null!==a){c=[];for(b=0;b<a.length;b++)c.push(k.fromGE(a[b]));return c}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h){function g(c){function d(a,
c,b){a[c]=b(a[c])}a._pe=c;t.init();x.init();p.init();q.init();u.init();a.PeGCSExtent=function(c){function e(){return null!==c&&c.apply(this,arguments)||this}b.__extends(e,c);e.prototype.destroy=function(){a._pe.destroy(this)};return e}(a._pe.PeGCSExtent);for(var f=0,g=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];f<g.length;f++)c=g[f],d(c.prototype,"getName",function(a){return function(){return a.call(this,
Array(t.PE_NAME_MAX))}});f=0;for(g=[a._pe.PeGeogtran,a._pe.PeProjcs];f<g.length;f++)c=g[f],d(c.prototype,"getParameters",function(c){return function(){for(var b=Array(t.PE_PARM_MAX),e=c.call(this),d=0;d<b.length;d++){var f=a._pe.getValue(e,"*");b[d]=f?a._pe.wrapPointer(f,a._pe.PeParameter):null;e+=Int32Array.BYTES_PER_ELEMENT}return b}});d(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var c=this.getSize();if(!c)return null;var b=[],d=a.call(this);e(b,c,d);return b}});d(a._pe.PeGTlistExtendedEntry.prototype,
"getEntries",function(c){var b=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var e=null,d=c.call(this);if(!a._pe.compare(d,a._pe.NULL)){var e=[d],f=this.getSteps();if(1<f)for(var d=a._pe.getPointer(d),g=1;g<f;g++)e.push(a._pe.wrapPointer(d+b*g,a._pe.PeGTlistExtendedGTs))}return e}});var n=a._pe._pe_getPeHorizonSize();c=function(c){return function(){var b=this._cache;b||(this._cache=b=new Map);if(b.has(c))return b.get(c);var e=null,d=c.call(this);if(!a._pe.compare(d,a._pe.NULL)){var e=[d],
f=d.getNump();if(1<f)for(var d=a._pe.getPointer(d),g=1;g<f;g++)e.push(a._pe.wrapPointer(d+n*g,a._pe.PeHorizon))}b.set(c,e);return e}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",c);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",c);a._pe.PeObject.prototype.toString=function(c){void 0===c&&(c=t.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var b=a._pe.getPointer(this),e=a._pe.ensureInt8(Array(t.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(b,c,e))}}function d(c){if(c){var b=
a._pe.getClass(c);b&&(b=a._pe.getCache(b))&&(c=a._pe.getPointer(c))&&delete b[c]}}function f(c,b){var e=[];b=Array(b);for(var d=0;d<c;d++)e.push(a._pe.ensureInt8(b));return e}function c(a){var c;Array.isArray(a[0])?(c=[],a.forEach(function(a){c.push(a[0],a[1])})):c=a;return c}function e(c,b,e,d){void 0===d&&(d=!1);if(d)for(d=0;d<2*b;d++)c[d]=a._pe.getValue(e+d*Float64Array.BYTES_PER_ELEMENT,"double");else{var f=0===c.length;for(d=0;d<b;d++)f&&(c[d]=Array(2)),c[d][0]=a._pe.getValue(e,"double"),c[d][1]=
a._pe.getValue(e+Float64Array.BYTES_PER_ELEMENT,"double"),e+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});a._init=a.PeVersion=a.PePCSInfo=a.PeNotationUtm=a.PeNotationUsng=a.PeNotationMgrs=a.PeNotationDms=a.PeGTTransformations=a.PeGTlistExtendedEntry=a.PeGTlistExtended=a.PeGCSExtent=a.PeFactory=a.PeDefs=a.PeCSTransformations=a.load=a.isSupported=a.isLoaded=a._pe=void 0;var n;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!k("esri-wasm")};
a.load=function(){return n?n:n=h.create(function(a,c){(new Promise(function(a,c){m(["./support/pe-wasm"],a,c)})).then(function(b){b({locateFile:function(a){return l.getAssetUrl("esri/geometry/support/"+a)},onAbort:function(a){c(Error(a))}}).then(function(c){g(c);a()})})})};(function(b){function d(b,d,f){a._pe.ensureCache.prepare();var g=c(f),n=f===g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),d,g))&&e(f,d,g,n);return b}function f(a,c,b){return g(a,c,b,0)}function g(b,d,
f,g){a._pe.ensureCache.prepare();var n=c(f),p=f===n,n=a._pe.ensureFloat64(n);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),d,n,g))&&e(f,d,n,p);return b}b.geogToProj=d;b.projGeog=function(a,c,b,e){switch(e){case t.PE_TRANSFORM_P_TO_G:return f(a,c,b);case t.PE_TRANSFORM_G_TO_P:return d(a,c,b)}return 0};b.projToGeog=f;b.projToGeogCenter=g})(a.PeCSTransformations||(a.PeCSTransformations={}));var t;(function(c){c.init=function(){c.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;c.PE_NAME_MAX=
a._pe.PeDefs.prototype.PE_NAME_MAX;c.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;c.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;c.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;c.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;c.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;c.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;c.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;c.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;c.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;c.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;
c.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;c.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;c.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;c.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;c.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;c.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;c.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;c.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;c.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;c.PE_TRANSFORM_1_TO_2=
a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;c.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;c.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;c.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;c.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;c.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;c.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;c.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(t=a.PeDefs||(a.PeDefs={}));(function(c){function b(c,
b){var f=null,g=d[c];g||(g={},d[c]=g);g.hasOwnProperty(String(b))?f=g[b]:(c=a._pe.PeFactory.prototype.factoryByType(c,b),a._pe.compare(c,a._pe.NULL)||(f=c,g[b]=f));return f=e(f)}function e(c){if(c){var b=c.getType();switch(b){case t.PE_TYPE_GEOGCS:c=a._pe.castObject(c,a._pe.PeGeogcs);break;case t.PE_TYPE_PROJCS:c=a._pe.castObject(c,a._pe.PeProjcs);break;case t.PE_TYPE_GEOGTRAN:c=a._pe.castObject(c,a._pe.PeGeogtran);break;default:b&t.PE_TYPE_UNIT&&(c=a._pe.castObject(c,a._pe.PeUnit))}}return c}var d=
{},f={};c.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};c.coordsys=function(a){return b(t.PE_TYPE_COORDSYS,a)};c.factoryByType=b;c.fromString=function(c,b){var d=null,g=f[c];g||(g={},f[c]=g);g.hasOwnProperty(b)?d=g[b]:(c=a._pe.PeFactory.prototype.fromString(c,b),a._pe.compare(c,a._pe.NULL)||(d=c,g[b]=d));return d=e(d)};c.geogcs=function(a){return b(t.PE_TYPE_GEOGCS,a)};c.geogtran=function(a){return b(t.PE_TYPE_GEOGTRAN,a)};c.getCode=function(c){return a._pe.PeFactory.prototype.getCode(c)};
c.projcs=function(a){return b(t.PE_TYPE_PROJCS,a)};c.unit=function(a){return b(t.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var x;(function(c){var b;c.init=function(){c.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;b=a._pe._pe_getPeGTlistExtendedEntrySize()};c.getGTlist=function(c,e,d,f,g,n){var p=null,q=new a._pe.PeInteger(n);try{var h=a._pe.PeGTlistExtended.prototype.getGTlist(c,e,d,f,g,q);if(n=q.val)if(p=[h],1<n){var t=a._pe.getPointer(h);
for(c=1;c<n;c++)p.push(a._pe.wrapPointer(t+b*c,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(q)}return p}})(x=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(c){c.destroy=function(c){if(c&&c.length){for(var b=0;b<c.length;b++){var e=c[b];d(e);e.getEntries().forEach(function(a){d(a);a=a.getGeogtran();d(a);a.getParameters().forEach(d);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){d(a);var c=a.getDatum();d(c);d(c.getSpheroid());d(a.getPrimem());d(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(c[0])}}})(a.PeGTlistExtendedEntry||
(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,d,f,g,n){a._pe.ensureCache.prepare();var p=c(f),q=f===p,p=a._pe.ensureFloat64(p),h=0;g&&(h=a._pe.ensureFloat64(g));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),d,p,h,n))&&e(f,d,p,q);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function d(b,e,d,g,n,p){a._pe.ensureCache.prepare();var q,h;switch(b){case "dd":q=a._pe._pe_geog_to_dd;h=t.PE_DD_MAX;break;case "ddm":q=a._pe._pe_geog_to_ddm;h=t.PE_DDM_MAX;break;
case "dms":q=a._pe._pe_geog_to_dms,h=t.PE_DMS_MAX}b=0;e&&(b=a._pe.getPointer(e));e=c(g);e=a._pe.ensureFloat64(e);h=f(d,h);g=a._pe.ensureInt32(h);if(n=q(b,d,e,n,g))for(q=0;q<d;q++)p[q]=a._pe.UTF8ToString(h[q]);return n}function g(c,b,d,f,g){a._pe.ensureCache.prepare();var n;switch(c){case "dd":n=a._pe._pe_dd_to_geog;break;case "ddm":n=a._pe._pe_ddm_to_geog;break;case "dms":n=a._pe._pe_dms_to_geog}c=0;b&&(c=a._pe.getPointer(b));b=f.map(function(c){return a._pe.ensureString(c)});f=a._pe.ensureInt32(b);
b=a._pe.ensureFloat64(Array(2*d));(n=n(c,d,f,b))&&e(g,d,b);return n}b.geog_to_dms=function(a,c,b,e,f){return d("dms",a,c,b,e,f)};b.dms_to_geog=function(a,c,b,e){return g("dms",a,c,b,e)};b.geog_to_ddm=function(a,c,b,e,f){return d("ddm",a,c,b,e,f)};b.ddm_to_geog=function(a,c,b,e){return g("ddm",a,c,b,e)};b.geog_to_dd=function(a,c,b,e,f){return d("dd",a,c,b,e,f)};b.dd_to_geog=function(a,c,b,e){return g("dd",a,c,b,e)}})(a.PeNotationDms||(a.PeNotationDms={}));var p;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,e,d,g,n,p,q){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=c(d);d=a._pe.ensureFloat64(b);b=f(e,t.PE_MGRS_MAX);
var k=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_mgrs_extended(h,e,d,g,n,p,k))for(n=0;n<e;n++)q[n]=a._pe.UTF8ToString(b[n]);return g};b.mgrs_to_geog_extended=function(c,b,d,f,g){a._pe.ensureCache.prepare();var n=0;c&&(n=a._pe.getPointer(c));c=d.map(function(c){return a._pe.ensureString(c)});d=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*b));(f=a._pe._pe_mgrs_to_geog_extended(n,b,d,f,c))&&e(g,b,c);return f}})(p=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,
e,d,g,n,p,q){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=c(d);d=a._pe.ensureFloat64(b);b=f(e,t.PE_MGRS_MAX);var k=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_usng(h,e,d,g,n,p,k))for(n=0;n<e;n++)q[n]=a._pe.UTF8ToString(b[n]);return g};b.usng_to_geog=function(c,b,d,f){a._pe.ensureCache.prepare();var g=0;c&&(g=a._pe.getPointer(c));c=d.map(function(c){return a._pe.ensureString(c)});d=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*b));(g=a._pe._pe_usng_to_geog(g,b,d,c))&&e(f,b,
c);return g}})(a.PeNotationUsng||(a.PeNotationUsng={}));var q;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,e,d,g,n){a._pe.ensureCache.prepare();var p=0;b&&(p=a._pe.getPointer(b));b=c(d);d=a._pe.ensureFloat64(b);b=f(e,t.PE_UTM_MAX);var q=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_utm(p,
e,d,g,q))for(p=0;p<e;p++)n[p]=a._pe.UTF8ToString(b[p]);return g};b.utm_to_geog=function(c,b,d,f,g){a._pe.ensureCache.prepare();var n=0;c&&(n=a._pe.getPointer(c));c=d.map(function(c){return a._pe.ensureString(c)});d=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*b));(f=a._pe._pe_utm_to_geog(n,b,d,f,c))&&e(g,b,c);return f}})(q=a.PeNotationUtm||(a.PeNotationUtm={}));var u;(function(c){var b=new Map;c.init=function(){c.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;c.PE_PCSINFO_OPTION_DOMAIN=
a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;c.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;c.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};c.generate=function(e,d){void 0===d&&(d=c.PE_PCSINFO_OPTION_DOMAIN);var f,g;b.has(e)&&(g=b.get(e),g[d]&&(f=g[d]));f||(f=a._pe.PePCSInfo.prototype.generate(e,d),g||(g=[],b.set(e,g)),g[d]=f);return f}})(u=a.PePCSInfo||(a.PePCSInfo={}));(function(c){c.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||
(a.PeVersion={}));a._init=g})},"esri/assets":function(){define(["require","exports","./request","./core/urlUtils"],function(m,a,b,l){function k(a){return l.join(m.toUrl("."),"../",a)}Object.defineProperty(a,"__esModule",{value:!0});a.getAssetUrl=a.fetchAsset=void 0;a.fetchAsset=function(a,g){return b(k(a),g)};a.getAssetUrl=k})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(m,a,b){return function(){function a(a){this.steps=
[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var h=0;for(a=a.steps;h<a.length;h++){var g=a[h];g instanceof b?this.steps.push(g):this.steps.push(new b({wkid:g.wkid,wkt:g.wkt,isInverse:g.isInverse}))}}}a.cacheKey=function(a,b){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==b.wkid&&null!==b.wkid?b.wkid.toString():"-1",void 0!==b.wkt&&null!==b.wkt?b.wkt.toString():""].join()};a.fromGE=function(k){var h=
new a,g="",d=0;for(k=k.steps;d<k.length;d++){var f=b.fromGE(k[d]);h.steps.push(f);g+=f.uid.toString()+","}h._cached_projection={};h._gtlistentry=null;h._chain=g;return h};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var h=this.steps.length-1;0<=h;h--)b.steps.push(this.steps[h].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",b=0,g=this.steps;b<g.length;b++)a+=g[b].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=
a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,h,g){this._cached_projection[a.cacheKey(b,h)]=g};a.prototype.getCachedGeTransformation=function(b,h){for(var g="",d=0,f=this.steps;d<f.length;d++)g+=f[d].uid.toString()+",";g!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=g);b=this._cached_projection[a.cacheKey(b,h)];return void 0===b?null:b};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(m,
a){var b=0;return function(){function a(a){void 0===a&&(a=null);this.uid=b++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var h=new a;h._wkt=b.wkt;h._wkid=b.wkid;h._isInverse=b.isInverse;return h};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=b++},enumerable:!1,configurable:!0});
Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=b++},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=b++},enumerable:!1,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;b._isInverse=!this.isInverse;return b};return a}()})},"esri/geometry/geometryAdapters/json":function(){define(["require",
"exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.jsonAdapter=void 0;a.jsonAdapter={convertToGEGeometry:function(a,b){return null==b?null:a.convertJSONToGeometry(b)},exportPoint:function(a,f,c){c=new b(a.getPointX(f),a.getPointY(f),c);var e=a.hasZ(f),d=a.hasM(f);e&&(c.z=a.getPointZ(f));d&&(c.m=a.getPointM(f));return c},exportPolygon:function(a,b,c){return new l(a.exportPaths(b),c,a.hasZ(b),a.hasM(b))},exportPolyline:function(a,b,c){return new k(a.exportPaths(b),c,a.hasZ(b),
a.hasM(b))},exportMultipoint:function(a,b,c){return new h(a.exportPoints(b),c,a.hasZ(b),a.hasM(b))},exportExtent:function(a,b,c){var e=a.hasZ(b),d=a.hasM(b);c=new g(a.getXMin(b),a.getYMin(b),a.getXMax(b),a.getYMax(b),c);e&&(e=a.getZExtent(b),c.zmin=e.vmin,c.zmax=e.vmax);d&&(a=a.getMExtent(b),c.mmin=a.vmin,c.mmax=a.vmax);return c}};var b=function(){return function(a,b,c){this.x=a;this.y=b;this.spatialReference=c;this.m=this.z=void 0}}(),l=function(){return function(a,b,c,e){this.rings=a;this.spatialReference=
b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);e&&(this.hasM=e)}}(),k=function(){return function(a,b,c,e){this.paths=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);e&&(this.hasM=e)}}(),h=function(){return function(a,b,c,e){this.points=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);e&&(this.hasM=e)}}(),g=function(){return function(a,b,c,e,g){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=e;this.spatialReference=g;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},
"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities=void 0;a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,
supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports tslib ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p){function q(a){return a.substr(24,12)+a.substr(19,4)+a.substr(16,2)+a.substr(14,2)+a.substr(11,2)+a.substr(9,2)+a.substr(6,2)+a.substr(4,2)+a.substr(2,2)+a.substr(0,2)}function u(a,c,b,e){if(b&&"esriFieldTypeDate"===b.type){var d=(new Date(a)).getTime(),f=(new Date(c)).getTime();if(!isNaN(d)&&!isNaN(f))return e?f-d:d-f}return"number"===typeof a&&"number"===typeof c?e?c-a:a-c:"string"===typeof a&&"string"===typeof c?(d=a.toUpperCase(),f=c.toUpperCase(),!b||"esriFieldTypeGUID"!==
b.type&&"esriFieldTypeGlobalID"!==b.type?e=(e?d>f:d<f)?-1:(e?d<f:d>f)?1:0:(a=q(d),f=q(f),e=(e?a>f:a<f)?-1:(e?a<f:a>f)?1:0),e):e?1:-1}Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a,c,b){this.items=a;this.queryGeometry=c;this.definitionExpression=b.definitionExpression;this.geometryType=b.geometryType;this.hasM=b.hasM;this.hasZ=b.hasZ;this.objectIdField=b.objectIdField;this.spatialReference=b.spatialReference;this.fieldsIndex=b.fieldsIndex;this.timeInfo=b.timeInfo;this.featureAdapter=
b.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!1,configurable:!0});a.prototype.createQueryResponseForCount=function(a){var c=new e.default(a,this.featureAdapter,this.fieldsIndex);if(!a.outStatistics)return c.countDistinctValues(this.items);var b=a.groupByFieldsForStatistics,d=a.having;if(null===b||void 0===b||!b.length)return 1;var f=new Map,g=new Map,n=new Set,p=0;for(a=a.outStatistics;p<a.length;p++){var q=a[p],q="exceedslimit"!==
q.statisticType?q.onStatisticField:void 0;if(!g.has(q)){for(var h=[],t=0,k=b;t<k.length;t++){var w=this._getAttributeValues(c,k[t],f);h.push(w)}g.set(q,this._calculateUniqueValues(h))}var q=g.get(q),u;for(u in q)t=q[u],h=t.items,t=t.data.join(","),d&&!c.validateItems(h,d)||n.add(t)}return n.size};a.prototype.createQueryResponse=function(a){var c;c=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):
this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(f.isValid(a.outSR)&&!f.equals(this.queryGeometry.spatialReference,a.outSR)?c.queryGeometry=p.cleanFromGeometryEngine(b.__assign({spatialReference:a.outSR},t.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):c.queryGeometry=p.cleanFromGeometryEngine(b.__assign({spatialReference:a.outSR},this.queryGeometry)));return c};a.prototype.executeAttributesQuery=function(c){var b=n.getWhereClause(c.where,this.fieldsIndex);if(!b)return h.resolve(this);
if(b.isStandardized){for(var e=0,d=[],f=0,g=this.items;f<g.length;f++){var p=g[f];b.testFeature(p,this.featureAdapter)&&(d[e++]=p)}b=new a(d,this.queryGeometry,this);b.definitionExpression=c.where;return h.resolve(b)}return h.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=function(c){if(!c.objectIds||!c.objectIds.length)return h.resolve(this);var b=g.SetFromValues(c.objectIds),e=this.featureAdapter.getObjectId;return h.resolve(new a(this.items.filter(function(a){return b.has(e(a))}),
this.queryGeometry,this))};a.prototype.executeTimeQuery=function(c){c=x.getTimeOperator(this.timeInfo,c.timeExtent,this.featureAdapter);if(!k.isSome(c))return h.resolve(this);c=this.items.filter(c);return h.resolve(new a(c,this.queryGeometry,this))};a.prototype.filterLatest=function(){for(var c=this.timeInfo,b=c.trackIdField,e=c.startTimeField,c=c.endTimeField||e,e=new Map,d=this.featureAdapter.getAttribute,f=0,g=this.items;f<g.length;f++){var n=g[f],p=d(n,b),q=d(n,c),t=e.get(p);(!t||q>d(t,c))&&e.set(p,
n)}b=l.valuesOfMap(e);return h.resolve(new a(b,this.queryGeometry,this))};a.prototype.project=function(e){return b.__awaiter(this,void 0,void 0,function(){var d,g,n,q=this;return b.__generator(this,function(b){switch(b.label){case 0:if(!e||f.equals(this.spatialReference,e))return[2,this];d=this.featureAdapter;return[4,t.projectMany(this.items.map(function(a){return p.getGeometry(q.geometryType,q.hasZ,q.hasM,d.getGeometry(a))}),this.spatialReference,e)];case 1:return g=b.sent(),n=g.map(function(a,
b){return d.cloneWithGeometry(q.items[b],c.convertFromGeometry(a,q.hasZ,q.hasM))}),[2,new a(n,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._sortFeatures=function(a,c,b){if(1<a.length&&c&&c.length){var e=function(c){c=c.split(" ");var e=c[0],f=d.fieldsIndex.get(e),
g=c[1]&&"desc"===c[1].toLowerCase();a.sort(function(a,c){a=b(a,e,f);c=b(c,e,f);return u(a,c,f,g)})},d=this,f=0;for(c=c.reverse();f<c.length;f++)e(c[f])}};a.prototype._createFeatureQueryResponse=function(a){var c=this,e=this.items,f=this.geometryType,g=this.hasM,n=this.hasZ,q=this.objectIdField,h=this.spatialReference,t=a.outFields,k=a.outSR,w=a.quantizationParameters,u=a.resultRecordCount,l=a.resultOffset,x=a.returnZ,y=a.returnM,u=null!=u?e.length>(l||0)+u:!1,t=t&&(-1<t.indexOf("*")?b.__spreadArrays(this.fieldsIndex.fields):
t.map(function(a){return c.fieldsIndex.get(a)}));return{exceededTransferLimit:u,features:this._createFeatures(a,e),fields:t,geometryType:f,hasM:g&&y,hasZ:n&&x,objectIdFieldName:q,spatialReference:p.cleanFromGeometryEngine(k?k:h),transform:w&&d.toQuantizationTransform(w)||null}};a.prototype._createFeatures=function(a,c){var f=new e.default(a,this.featureAdapter,this.fieldsIndex),g=a.orderByFields,n=a.quantizationParameters,q=a.returnGeometry,h=a.returnCentroid,t=a.maxAllowableOffset,k=a.resultOffset,
w=a.resultRecordCount,u=a.returnZ;a=a.returnM;var l=this.hasZ&&(void 0===u?!1:u),x=this.hasM&&(void 0===a?!1:a),u=[];a=0;c=b.__spreadArrays(c);this._sortFeatures(c,g,function(a,c,b){return f.getFieldValue(a,c,b)});if(q||h)if(g=d.toQuantizationTransform(n),q&&!h)for(h=0;h<c.length;h++)q=c[h],u[a++]={attributes:f.getAttributes(q),geometry:p.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(q),t,g,l,x)};else if(!q&&h)for(t=0;t<c.length;t++)q=c[t],u[a++]={attributes:f.getAttributes(q),
centroid:p.transformCentroid(this,this.featureAdapter.getCentroid(q,this),g)};else for(h=0;h<c.length;h++)q=c[h],u[a++]={attributes:f.getAttributes(q),centroid:p.transformCentroid(this,this.featureAdapter.getCentroid(q,this),g),geometry:p.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(q),t,g,l,x)};else for(t=0;t<c.length;t++)q=c[t],(l=f.getAttributes(q))&&(u[a++]={attributes:l});k=k||0;null!=w&&(u=u.slice(k,Math.min(u.length,k+w)));return u};a.prototype._createExceedsLimitQueryResponse=
function(a){var c=!1,b=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,d=0;for(a=a.outStatistics;d<a.length;d++){var f=a[d];if("exceedslimit"===f.statisticType){b=null!=f.maxPointCount?f.maxPointCount:Number.POSITIVE_INFINITY;e=null!=f.maxRecordCount?f.maxRecordCount:Number.POSITIVE_INFINITY;c=null!=f.maxVertexCount?f.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)c=this.items.length>b;else if(this.items.length>e)c=!0;else var b=
this.hasZ?this.hasM?4:3:this.hasM?3:2,g=this.featureAdapter,c=this.items.reduce(function(a,c){c=g.getGeometry(c);return a+(c&&c.coords.length||0)},0)/b>c;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(c)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var c=this,b={attributes:{}},d=[],f=new Map,g=new Map,n=new Map,p=new Map,q=new e.default(a,this.featureAdapter,
this.fieldsIndex),h=a.outStatistics,t=a.groupByFieldsForStatistics,k=a.having;a=a.orderByFields;for(var u=t&&t.length,w=!!u,x=w&&t[0],y=w&&!this.fieldsIndex.get(x),m=0;m<h.length;m++){var W=h[m],Q=W.outStatisticFieldName,V=W.statisticType,R=W,T="exceedslimit"!==V?W.onStatisticField:void 0,X="percentile_disc"===V||"percentile_cont"===V,da=w&&1===u&&(T===x||y)&&"count"===V;if(w){if(!n.has(T)){for(var W=[],V=0,fa=t;V<fa.length;V++){var aa=this._getAttributeValues(q,fa[V],f);W.push(aa)}n.set(T,this._calculateUniqueValues(W))}var ca=
n.get(T),W=function(a){var b=ca[a];a=b.count;var e=b.data,d=b.items,g=b.itemPositions,b=e.join(",");if(!k||q.validateItems(d,k)){var n=p.get(b)||{attributes:{}},d=null;if(da)d=a;else{var h=Z._getAttributeValues(q,T,f);a=g.map(function(a){return h[a]});d=X&&"statisticParameters"in R?Z._getPercentileValue(R,a):Z._getStatisticValue(R,a)}n.attributes[Q]=d;t.forEach(function(a,b){return n.attributes[c.fieldsIndex.get(a)?a:"EXPR_"+(b+1)]=e[b]});p.set(b,n)}},Z=this,ga;for(ga in ca)W(ga)}else aa=this._getAttributeValues(q,
T,f),b.attributes[Q]=X&&"statisticParameters"in R?this._getPercentileValue(R,aa):this._getStatisticValue(R,aa,g);d.push({name:Q,alias:Q,type:"esriFieldTypeDouble"})}b=w?l.valuesOfMap(p):[b];this._sortFeatures(b,a,function(a,c){return a.attributes[c]});return{fields:d,features:b}};a.prototype._getStatisticValue=function(a,c,b){var e=a.onStatisticField;a=a.statisticType;c=b&&b.has(e)?b.get(e):this._calculateStatistics(c);b&&b.set(e,c);return c["var"===a?"variance":a]};a.prototype._getPercentileValue=
function(a,c){var e=a.statisticParameters,d=a.statisticType,f=e.value,g="desc"===e.orderBy,n=this.fieldsIndex.get(a.onStatisticField);a=b.__spreadArrays(c).filter(function(a){return null!=a}).sort(function(a,c){return u(a,c,n,g)});return this._calculatePercentile(a,f,"percentile_disc"===d)};a.prototype._getAttributeValues=function(a,c,b){if(b.has(c))return b.get(c);var e=this.fieldsIndex.get(c),d=this.items.map(function(b){return a.getFieldValue(b,c,e)});b.set(c,d);return d};a.prototype._calculateStatistics=
function(a){for(var c=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,e=null,d=null,f=null,g=null,n=[],p=0,q=0;q<a.length;q++){var h=a[q];"string"===typeof h?p++:null==h||isNaN(h)||(e+=h,c=Math.min(c,h),b=Math.max(b,h),n.push(h),p++)}if(p){d=e/p;for(f=a=0;f<n.length;f++)h=n[f],a+=Math.pow(h-d,2);g=1<p?a/(p-1):0;f=Math.sqrt(g)}else b=c=null;return{avg:d,count:p,max:b,min:c,stddev:f,sum:e,variance:g}};a.prototype._calculateUniqueValues=function(a){for(var c={},b=this.items,e=b.length,d=0;d<e;d++){for(var f=
b[d],g=[],n=0,p=a;n<p.length;n++)g.push(p[n][d]);n=g.join(",");null==c[n]?c[n]={count:1,data:g,items:[f],itemPositions:[d]}:(c[n].count++,c[n].items.push(f),c[n].itemPositions.push(d))}return c};a.prototype._calculatePercentile=function(a,c,b){if(0===a.length)return null;if(0>=c)return a[0];if(1<=c)return a[a.length-1];var e=(a.length-1)*c,d=Math.floor(e);c=d+1;var e=e%1,d=a[d],f=a[c];return c>=a.length||b||"string"===typeof d||"string"===typeof f?d:d*(1-e)+f*e};return a}();a.default=m})},"esri/geometry/support/quantizationUtils":function(){define(["require",
"exports","./jsonUtils"],function(m,a,b){function l(a,c){return Math.round((c-a.translate[0])/a.scale[0])}function k(a,c){return Math.round((a.translate[1]-c)/a.scale[1])}function h(a,c,b){for(var e=[],d,f,g,n,p=0;p<b.length;p++){var q=b[p];if(0<p){if(g=l(a,q[0]),n=k(a,q[1]),g!==d||n!==f)e.push(c(q,g-d,n-f)),d=g,f=n}else d=l(a,q[0]),f=k(a,q[1]),e.push(c(q,d,f))}return 0<e.length?e:null}function g(a,c,b,e){return h(a,b?e?F:D:e?D:E,c)}function d(a,c,b,e){var d=[];b=b?e?F:D:e?D:E;for(e=0;e<c.length;e++){var f=
h(a,b,c[e]);f&&3<=f.length&&d.push(f)}return d.length?d:null}function f(a,c,b,e){var d=[];b=b?e?F:D:e?D:E;for(e=0;e<c.length;e++){var f=h(a,b,c[e]);f&&2<=f.length&&d.push(f)}return d.length?d:null}function c(a,c){return c*a.scale[0]+a.translate[0]}function e(a,c){return a.translate[1]-c*a.scale[1]}function n(a,b,d){var f=Array(d.length);if(!d.length)return f;var g=a.scale,n=g[0],g=g[1],p=c(a,d[0][0]);a=e(a,d[0][1]);f[0]=b(d[0],p,a);for(var q=1;q<d.length;q++){var h=d[q],p=p+h[0]*n;a-=h[1]*g;f[q]=
b(h,p,a)}return f}function t(a,c,b){for(var e=Array(b.length),d=0;d<b.length;d++)e[d]=n(a,c,b[d]);return e}function x(a,c,b,e){return n(a,b?e?F:D:e?D:E,c)}function p(a,c,b,e){return t(a,b?e?F:D:e?D:E,c)}function q(a,c,b,e){return t(a,b?e?F:D:e?D:E,c)}function u(a,c,b){var e=b[0],d=e[0],e=e[1],f=Math.min(d,c[0]),g=Math.min(e,c[1]),n=Math.max(d,c[2]);c=Math.max(e,c[3]);for(var p=1;p<b.length;p++){var q=b[p],h=q[0],q=q[1],d=d+h,e=e+q;0>h&&(f=Math.min(f,d));0<h&&(n=Math.max(n,d));0>q?g=Math.min(g,e):
0<q&&(c=Math.max(c,e))}a[0]=f;a[1]=g;a[2]=n;a[3]=c;return a}function y(a,c){if(!c.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(var b=0;b<c.length;b++)u(a,a,c[b]);return a}function w(a,c,b,e,d){c.xmin=l(a,b.xmin);c.ymin=k(a,b.ymin);c.xmax=l(a,b.xmax);c.ymax=k(a,b.ymax);c!==b&&(e&&(c.zmin=b.zmin,c.zmax=b.zmax),d&&(c.mmin=b.mmin,c.mmax=b.mmax));return c}function B(a,c,b,e,d){c.points=g(a,b.points,e,d);return c}function z(a,c,b,e,d){c.x=l(a,b.x);c.y=k(a,
b.y);c!==b&&(e&&(c.z=b.z),d&&(c.m=b.m));return c}function A(a,c,b,e,f){a=d(a,b.rings,e,f);if(!a)return null;c.rings=a;return c}function C(a,c,b,e,d){a=f(a,b.paths,e,d);if(!a)return null;c.paths=a;return c}Object.defineProperty(a,"__esModule",{value:!0});a.unquantizePolyline=a.unquantizePolygon=a.unquantizePoint=a.unquantizeMultipoint=a.unquantizeExtent=a.quantizeGeometry=a.quantizePolyline=a.quantizePolygon=a.quantizePoint=a.quantizeMultipoint=a.quantizeExtent=a.getQuantizedBoundsRings=a.getQuantizedBoundsPaths=
a.getQuantizedBoundsPoints=a.getQuantizedBoundsCoordsArrayArray=a.getQuantizedBoundsCoordsArray=a.unquantizeRings=a.unquantizePaths=a.unquantizePoints=a.unquantizeBounds=a.unquantizeCoordsArrayArray=a.unquantizeCoordsArray=a.unquantizeY=a.unquantizeX=a.quantizePaths=a.quantizeRings=a.quantizePoints=a.quantizeBounds=a.quantizeY=a.quantizeX=a.equals=a.toQuantizationTransform=void 0;var E=function(a,c,b){return[c,b]},D=function(a,c,b){return[c,b,a[2]]},F=function(a,c,b){return[c,b,a[2],a[3]]};a.toQuantizationTransform=
function(a){return a?{originPosition:"upper-left"===a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,c){if(a===c||null==a&&null==c)return!0;if(null==a||null==c)return!1;var b,e,d,f;a&&"upperLeft"===a.originPosition?(b=a.translate[0],e=a.translate[1],a=a.scale[0]):(b=a.extent.xmin,e=a.extent.ymax,a=a.tolerance);c&&"upperLeft"===c.originPosition?(d=c.translate[0],
f=c.translate[1],c=c.scale[0]):(d=c.extent.xmin,f=c.extent.ymax,c=c.tolerance);return b===d&&e===f&&a===c};a.quantizeX=l;a.quantizeY=k;a.quantizeBounds=function(a,c,b){c[0]=l(a,b[0]);c[3]=k(a,b[1]);c[2]=l(a,b[2]);c[1]=k(a,b[3]);return c};a.quantizePoints=g;a.quantizeRings=d;a.quantizePaths=f;a.unquantizeX=c;a.unquantizeY=e;a.unquantizeCoordsArray=n;a.unquantizeCoordsArrayArray=t;a.unquantizeBounds=function(a,b,d){return d?(b[0]=c(a,d[0]),b[1]=e(a,d[3]),b[2]=c(a,d[2]),b[3]=e(a,d[1]),b):[c(a,b[0]),
e(a,b[3]),c(a,b[2]),e(a,b[1])]};a.unquantizePoints=x;a.unquantizePaths=p;a.unquantizeRings=q;a.getQuantizedBoundsCoordsArray=u;a.getQuantizedBoundsCoordsArrayArray=y;a.getQuantizedBoundsPoints=function(a){var c=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return u(c,c,a)};a.getQuantizedBoundsPaths=function(a){return y([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return y([0,0,0,0],a)};a.quantizeExtent=w;a.quantizeMultipoint=B;a.quantizePoint=
z;a.quantizePolygon=A;a.quantizePolyline=C;a.quantizeGeometry=function(a,c){return a&&c?b.isPoint(c)?z(a,{},c,!1,!1):b.isPolyline(c)?C(a,{},c,!1,!1):b.isPolygon(c)?A(a,{},c,!1,!1):b.isMultipoint(c)?B(a,{},c,!1,!1):b.isExtent(c)?w(a,{},c,!1,!1):null:null};a.unquantizeExtent=function(a,b,d,f,g){b.xmin=c(a,d.xmin);b.ymin=e(a,d.ymin);b.xmax=c(a,d.xmax);b.ymax=e(a,d.ymax);b!==d&&(f&&(b.zmin=d.zmin,b.zmax=d.zmax),g&&(b.mmin=d.mmin,b.mmax=d.mmax));return b};a.unquantizeMultipoint=function(a,c,b,e,d){c.points=
x(a,b.points,e,d);return c};a.unquantizePoint=function(a,b,d,f,g){b.x=c(a,d.x);b.y=e(a,d.y);b!==d&&(f&&(b.z=d.z),g&&(b.m=d.m));return b};a.unquantizePolygon=function(a,c,b,e,d){c.rings=q(a,b.rings,e,d);return c};a.unquantizePolyline=function(a,c,b,e,d){c.paths=p(a,b.paths,e,d);return c}})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a,
b,d){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=d;this.featureAdapter=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var f=b=0;f<a.length;f++){var c=a[f],e=l.getExpressionFromFieldName(c),g=this.fieldsIndex.get(e),e=g?null:l.getWhereClause(e,d),g=g?g.name:l.getAliasFromFieldName(c)||"FIELD_EXP_"+b++;this._fieldDataCache.set(c,{alias:g,clause:e})}}}a.prototype.countDistinctValues=function(a){var b=
this;if(!this.returnDistinctValues)return a.length;a.forEach(function(a){return b.getAttributes(a)});return this._returnDistinctMap.size};a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,b,d){var f=d?d.name:b,c=null;this._fieldDataCache.has(f)?c=this._fieldDataCache.get(f).clause:d||(c=l.getWhereClause(b,this.fieldsIndex),this._fieldDataCache.set(f,{alias:f,clause:c}));return d?this.featureAdapter.getAttribute(a,
f):c.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:l.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:l.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=
function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var d={},f=0;f<b.length;f++){var c=this._fieldDataCache.get(b[f]),e=c.alias,c=c.clause;d[e]=c?c.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,e)}return d};a.prototype._processAttributesForDistinctValues=function(a){if(b.isNone(a)||!this.returnDistinctValues)return a;var g=this.outFields,d=[];if(g)for(var f=0;f<g.length;f++){var c=this._fieldDataCache.get(g[f]).alias;d.push(a[c])}else for(c in a)d.push(a[c]);
g=(g||["*"]).join(",")+"\x3d"+d.join(",");d=this._returnDistinctMap.get(g)||0;this._returnDistinctMap.set(g,++d);return 1<d?null:a};return a}();a.default=m})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(m,a){function b(a,b,d,f,c){if(null!=f&&null!=c)return function(e){var g=a.getAttribute(e,b);e=a.getAttribute(e,d);return(null==g||g<=c)&&(null==e||e>=f)};if(null!=f)return function(c){c=a.getAttribute(c,d);return null==c||c>=f};if(null!=c)return function(e){e=
a.getAttribute(e,b);return null==e||e<=c}}function l(a,b,d,f){if(null!=d&&null!=f&&d===f)return function(c){return a.getAttribute(c,b)===d};if(null!=d&&null!=f)return function(c){c=a.getAttribute(c,b);return c>=d&&c<=f};if(null!=d)return function(c){return a.getAttribute(c,b)>=d};if(null!=f)return function(c){return a.getAttribute(c,b)<=f}}function k(){return function(){return!1}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeOperator=a.getTimeExtent=void 0;a.getTimeExtent=function(a,b){if(!a)return null;
var d=b.featureAdapter,f=a.startTimeField,c=a.endTimeField,e=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;if(f&&c)b.forEach(function(a){var b=d.getAttribute(a,f);a=d.getAttribute(a,c);null==b||isNaN(b)||(e=Math.min(e,b));null==a||isNaN(a)||(g=Math.max(g,a))});else{var h=f||c;b.forEach(function(a){a=d.getAttribute(a,h);null==a||isNaN(a)||(e=Math.min(e,a),g=Math.max(g,a))})}return{start:e,end:g}};a.getTimeOperator=function(a,g,d){if(!g||!a)return null;var f=a.startTimeField;a=a.endTimeField;
if(!f&&!a)return null;var c=g.start;g=g.end;return null===c&&null===g?null:void 0===c&&void 0===g?k():f&&a?b(d,f,a,c,g):l(d,f||a,c,g)}})},"esri/layers/graphics/data/utils":function(){define("require exports tslib ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p){function q(a,c,b,e,d){void 0===e&&(e=a.hasZ);void 0===d&&(d=a.hasM);var f=a.hasZ&&e,g=a.hasM&&d;return b?(a=n.quantizeOptimizedGeometry(A,c,a.hasZ,a.hasM,"esriGeometryPoint",b,e,d),n.convertToPoint(a,f,g)):n.convertToPoint(c,f,g)}function u(c,e,n){return b.__awaiter(this,void 0,void 0,function(){var p,q,h,t,u,l;return b.__generator(this,function(b){switch(b.label){case 0:if(!c)return[2,null];p=c.where;c.where=p=p&&p.trim();if(!p||/^1 *= *1$/.test(p)||e&&e===
p)c.where=null;return c.geometry?[4,y(c)]:[2,c];case 1:return q=b.sent(),c.distance=0,c.units=null,"esriSpatialRelEnvelopeIntersects"===c.spatialRel&&(h=c.geometry.spatialReference,q=g.getGeometryExtent(q),q.spatialReference=h),c.geometry=q,[4,x.checkProjectionSupport(q.spatialReference,n)];case 2:return b.sent(),[4,f.normalizeCentralMeridian(d.fromJSON(q))];case 3:t=b.sent()[0];if(k.isNone(t))throw a.QUERY_ENGINE_EMPTY_RESULT;u=t.toJSON();return[4,x.project(u,u.spatialReference,n)];case 4:l=b.sent();
if(!l)throw a.QUERY_ENGINE_EMPTY_RESULT;l.spatialReference=n;c.geometry=l;return[2,c]}})})}function y(a){return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g,n,q,t,k,u;return b.__generator(this,function(b){switch(b.label){case 0:e=a.geometry;d=a.distance;f=a.units;if(null==d||"vertexAttributes"in e)return[2,e];g=e.spatialReference;n=f?w.fromJSON(f):h.getUnitString(g);q=g&&(c.isGeographic(g)||c.isWebMercator(g));if(!q)return[3,1];k=e;return[3,3];case 1:return[4,x.checkProjectionSupport(g,c.WGS84).then(function(){return x.project(e,
c.WGS84)})];case 2:k=b.sent(),b.label=3;case 3:return t=k,[4,p.getGeodesicBufferOperator()];case 4:return u=b.sent(),[2,u(t.spatialReference,t,d,n)]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.cleanFromGeometryEngine=a.normalizeQueryLike=a.normalizeFilter=a.normalizeQuery=a.getGeometry=a.getCentroid=a.transformCentroid=a.QUERY_ENGINE_EMPTY_RESULT=void 0;var w=new l.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var B=new t.default,z=new t.default,A=new t.default,C={esriGeometryPoint:n.convertToPoint,esriGeometryPolyline:n.convertToPolyline,esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};a.transformCentroid=q;a.getCentroid=function(a,c,b){if("esriGeometryPolygon"!==a.geometryType||!c||!c.centroid&&!c.geometry)return null;c.centroid||(c.centroid=
e.getCentroidOptimizedGeometry(new t.default,c.geometry,a.hasZ,a.hasM));return q(a,c.centroid,b)};a.getGeometry=function(a,c,b,e,d,f,g,p){void 0===g&&(g=c);void 0===p&&(p=b);var q=c&&g,h=b&&p;e=e?"coords"in e?e:e.geometry:null;if(!e)return null;if(d)return c=n.generalizeOptimizedGeometry(z,e,c,b,a,d,g,p),f&&(c=n.quantizeOptimizedGeometry(A,c,q,h,a,f)),C[a](c,q,h);if(f)return c=n.quantizeOptimizedGeometry(A,e,c,b,a,f,g,p),C[a](c,q,h);n.removeZMValues(B,e,c,b,g,p);return C[a](B,q,h)};a.normalizeQuery=
function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d,f,g,n,p;return b.__generator(this,function(b){d=a.outFields;f=a.orderByFields;g=a.groupByFieldsForStatistics;n=a.outStatistics;if(d)for(p=0;p<d.length;p++)d[p]=d[p].trim();if(f)for(p=0;p<f.length;p++)f[p]=f[p].trim();if(g)for(p=0;p<g.length;p++)g[p]=g[p].trim();if(n)for(p=0;p<n.length;p++)n[p].onStatisticField&&(n[p].onStatisticField=n[p].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,
u(a,c,e)]})})};a.normalizeFilter=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){return[2,u(a,c,e)]})})};a.normalizeQueryLike=u;a.cleanFromGeometryEngine=function(a){return a&&E in a?JSON.parse(JSON.stringify(a,D)):a};var E="_geVersion",D=function(a,c){return a!==E?c:void 0}})},"esri/geometry/support/normalizeUtils":function(){define("require exports tslib ../../config ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../Polygon ../Polyline ../SpatialReference ./spatialReferenceUtils ./webMercatorUtils ../../tasks/geometry/cut ../../tasks/geometry/simplify".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p){function q(a){return"polygon"===a.type?a.rings:a.paths}function u(a,c){return Math.ceil((a-c)/(2*c))}function y(a,c){for(var b=0,e=q(a);b<e.length;b++)for(var d=0,f=e[b];d<f.length;d++)f[d][0]+=c;return a}function w(a){for(var c=[],b=0,e=0,d=0;d<a.length;d++){for(var f=a[d],g=null,n=0;n<f.length;n++)g=f[n],c.push(g),0===n?e=b=g[0]:(b=Math.min(b,g[0]),e=Math.max(e,g[0]));g&&c.push([(b+e)/2,0])}return c}function B(a,b){if(!(a instanceof c||a instanceof f))throw D.error("straightLineDensify: the input geometry is neither polyline nor polygon"),
new k("straightLineDensify: the input geometry is neither polyline nor polygon");for(var e=[],d=0,g=q(a);d<g.length;d++){var n=g[d],p=[];e.push(p);p.push([n[0][0],n[0][1]]);for(var h=0;h<n.length-1;h++){var t=n[h][0],u=n[h][1],l=n[h+1][0],w=n[h+1][1],x=Math.sqrt((l-t)*(l-t)+(w-u)*(w-u)),y=(w-u)/x,C=(l-t)/x,A=x/b;if(1<A){for(var B=1;B<=A-1;B++){var z=B*b;p.push([C*z+t,y*z+u])}x=(x+Math.floor(A-1)*b)/2;p.push([C*x+t,y*x+u])}p.push([l,w])}}return"polygon"===a.type?new f({rings:e,spatialReference:a.spatialReference}):
new c({paths:e,spatialReference:a.spatialReference})}function z(a,c,b){c&&(a=B(a,1E6),a=t.webMercatorToGeographic(a,!0));b&&(a=y(a,b));return a}function A(a,c,b){if(Array.isArray(a)){var e=a[0];if(e>c){var d=u(e,c);a[0]=e+-2*d*c}else e<b&&(d=u(e,b),a[0]=e+-2*d*b)}else e=a.x,e>c?(d=u(e,c),a=a.clone().offset(-2*d*c,0)):e<b&&(d=u(e,b),a=a.clone().offset(-2*d*b,0));return a}function C(a,c){for(var b=-1,e=function(e){var d=c.cutIndexes[e],f=c.geometries[e],g=q(f);e=function(a){var c=g[a];c.some(function(b){if(180>
b[0])return!0;for(var e=b=0;e<c.length;e++){var d=c[e][0];b=d>b?d:b}b=Number(b.toFixed(9));b=-360*u(b,180);for(e=0;e<c.length;e++)d=f.getPoint(a,e),f.setPoint(a,e,d.clone().offset(b,0));return!0})};for(var n=0;n<g.length;n++)e(n);if(d===b)if("polygon"===a[0].type)for(e=0,n=q(f);e<n.length;e++)a[d]=a[d].addRing(n[e]);else{if("polyline"===a[0].type)for(e=0,n=q(f);e<n.length;e++)a[d]=a[d].addPath(n[e])}else b=d,a[d]=f},d=0;d<c.cutIndexes.length;d++)e(d);return a}function E(a,e,q){return b.__awaiter(this,
void 0,void 0,function(){var h,k,w,B,D,m,H,I,G,R,T,X,da,fa,aa,ca,Z,ga,ea,la,ja,ua,xa,Da,Ea,ta,Aa,U,ma,ya,ra,qa,sa,na,va,M,Ba;return b.__generator(this,function(b){switch(b.label){case 0:if(!Array.isArray(a))return[2,E([a],e)];h=e?e.url:l.geometryServiceUrl;R=0;T=[];X=[];da=0;for(fa=a;da<fa.length;da++)aa=fa[da],g.isNone(aa)?X.push(aa):(k||(k=aa.spatialReference,w=n.getInfo(k),H=(B=k.isWebMercator)?102100:4326,D=F[H].maxX,m=F[H].minX,I=F[H].plus180Line,G=F[H].minus180Line),w?"mesh"===aa.type?X.push(aa):
"point"===aa.type?X.push(A(aa.clone(),D,m)):"multipoint"===aa.type?(ca=aa.clone(),ca.points=ca.points.map(function(a){return A(a,D,m)}),X.push(ca)):"extent"===aa.type?(Z=aa.clone(),ga=Z._normalize(!1,!1,w),X.push(ga.rings?new f(ga):ga)):aa.extent?(Z=aa.extent,ea=u(Z.xmin,m),la=2*ea*D,ja=0===la?aa.clone():y(aa.clone(),la),Z.offset(la,0),Z.intersects(I)&&Z.xmax!==D?(R=Z.xmax>R?Z.xmax:R,ja=z(ja,B),T.push(ja),X.push("cut")):Z.intersects(G)&&Z.xmin!==m?(R=2*Z.xmax*D>R?2*Z.xmax*D:R,ja=z(ja,B,360),T.push(ja),
X.push("cut")):X.push(ja)):X.push(aa.clone()):X.push(aa));ua=u(R,D);xa=-90;Da=ua;for(Ea=new c;0<ua;)ta=-180+360*ua,Ea.addPath([[ta,xa],[ta,-1*xa]]),xa*=-1,ua--;return 0<T.length&&0<Da?[4,x.cut(h,T,Ea,q)]:[3,3];case 1:Aa=b.sent();U=C(T,Aa);ma=[];ya=[];for(ra=0;ra<X.length;ra++)qa=X[ra],"cut"!==qa?ya.push(qa):(sa=U.shift(),na=a[ra],g.isSome(na)&&"polygon"===na.type&&na.rings&&1<na.rings.length&&sa.rings.length>=na.rings.length?(ma.push(sa),ya.push("simplify")):ya.push(B?t.geographicToWebMercator(sa):
sa));return ma.length?[4,p.simplify(h,ma,q)]:[2,ya];case 2:va=b.sent();M=[];for(ra=0;ra<ya.length;ra++)qa=ya[ra],"simplify"!==qa?M.push(qa):M.push(B?t.geographicToWebMercator(va.shift()):va.shift());return[2,M];case 3:Ba=[];for(ra=0;ra<X.length;ra++)qa=X[ra],"cut"!==qa?Ba.push(qa):(sa=T.shift(),Ba.push(!0===B?t.geographicToWebMercator(sa):sa));return[2,d.resolve(Ba)]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.normalizeMapX=a.getDenormalizedExtent=a.normalizeCentralMeridian=a.straightLineDensify=
void 0;var D=h.getLogger("esri.geometry.support.normalizeUtils"),F={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new c({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:e.WebMercator}),minus180Line:new c({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:e.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new c({paths:[[[180,-180],[180,
180]]],spatialReference:e.WGS84}),minus180Line:new c({paths:[[[-180,-180],[-180,180]]],spatialReference:e.WGS84})}};a.straightLineDensify=B;a.normalizeCentralMeridian=E;a.getDenormalizedExtent=function(a){var c;if(!a)return null;var b=a.extent;if(!b)return null;var e=a.spatialReference&&n.getInfo(a.spatialReference);if(!e)return b;var e=e.valid,d=e[0],e=e[1],f=b.width,g=b.xmin;c=b.xmax;c=[c,g];g=c[0];c=c[1];if("extent"===a.type||0===f||f<=e||f>2*e||g<d||c>e)return b;var p;switch(a.type){case "polygon":if(1<
a.rings.length)p=w(a.rings);else return b;break;case "polyline":if(1<a.paths.length)p=w(a.paths);else return b;break;case "multipoint":p=a.points}a=b.clone();for(d=0;d<p.length;d++){var q=p[d][0];0>q?(q+=e,c=Math.max(q,c)):(q-=e,g=Math.min(q,g))}a.xmin=g;a.xmax=c;return a.width<f?(a.xmin-=e,a.xmax-=e,a):b};a.normalizeMapX=function(a,c){if(c=n.getInfo(c)){var b=c.valid;c=b[0];var b=b[1],e=b-c;if(a<c)for(;a<c;)a+=e;if(a>b)for(;a>b;)a-=e}return a}})},"esri/tasks/geometry/cut":function(){define("require exports tslib ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.cut=void 0;a.cut=function(a,f,c,e){return b.__awaiter(this,void 0,void 0,function(){var d,t,x,p,q,u,y,w;return b.__generator(this,function(n){switch(n.label){case 0:return d="string"===typeof a?h.urlToObject(a):a,t=f[0].spatialReference,x=b.__assign(b.__assign({},e),{query:b.__assign(b.__assign({},d.query),{f:"json",sr:JSON.stringify(t),target:JSON.stringify({geometryType:g.getJsonType(f[0]),geometries:f}),cutter:JSON.stringify(c)})}),
[4,k(d.path+"/cut",x)];case 1:return p=n.sent(),q=p.data,u=q.cutIndexes,y=q.geometries,w=void 0===y?[]:y,[2,{cutIndexes:u,geometries:w.map(function(a){a=l.fromJSON(a);a.spatialReference=t;return a})}]}})})}})},"esri/tasks/geometry/simplify":function(){define("require exports tslib ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(m,a,b,l,k,h){function g(a){return{geometryType:h.getJsonType(a[0]),geometries:a.map(function(a){return a.toJSON()})}}function d(a,c,
b){var e=h.getGeometryType(c);return a.map(function(a){a=e.fromJSON(a);a.spatialReference=b;return a})}Object.defineProperty(a,"__esModule",{value:!0});a.simplify=void 0;a.simplify=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var f,t,x,p,q;return b.__generator(this,function(n){switch(n.label){case 0:return f="string"===typeof a?k.urlToObject(a):a,t=c[0].spatialReference,x=h.getJsonType(c[0]),p=b.__assign(b.__assign({},e),{query:b.__assign(b.__assign({},f.query),{f:"json",sr:t.wkid?
t.wkid:JSON.stringify(t),geometries:JSON.stringify(g(c))})}),[4,l(f.path+"/simplify",p)];case 1:return q=n.sent(),[2,d(q.data,x,t)]}})})}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(m,a){function b(a,b,g,d,f,c,e){void 0===e&&(e=1);c=f?c?4:3:c?3:2;var n=g,h=g+c,k=0,p=0,q=g=0,u=0,l=0;for(--d;l<d;l++,n+=c,h+=c){var w=b[n],B=b[n+1],z=b[n+2],A=b[h],C=b[h+1],m=b[h+2],D=w*C-A*B,q=q+D,k=k+(w+A)*D,p=p+(B+C)*D;f&&(D=w*m-A*z,g+=(z+m)*D,u+=D);w<a[0]&&(a[0]=w);w>a[1]&&(a[1]=
w);B<a[2]&&(a[2]=B);B>a[3]&&(a[3]=B);f&&(z<a[4]&&(a[4]=z),z>a[5]&&(a[5]=z))}0<q*e&&(q*=-1);0<u*e&&(u*=-1);if(!q)return null;a=[k,p,.5*q];f&&(a[3]=g,a[4]=.5*u);return a}function l(a,b,g,d,f){f=d?f?4:3:f?3:2;for(var c=b,e=b+f,n=0,h=0,k=0,p=0,q=0,u=g-1;q<u;q++,c+=f,e+=f){var l=a[c],w=a[c+1],B=a[c+2],z=a[e],A=a[e+1],C=a[e+2],m;if(d){m=z-l;var D=A-w,F=C-B;m=Math.sqrt(m*m+D*D+F*F)}else m=z-l,D=A-w,m=Math.sqrt(m*m+D*D);m&&(n+=m,d?(l=[l+.5*(z-l),w+.5*(A-w),B+.5*(C-B)],h+=m*l[0],k+=m*l[1],p+=m*l[2]):(l=[l+
.5*(z-l),w+.5*(A-w)],h+=m*l[0],k+=m*l[1]))}return 0<n?d?[h/n,k/n,p/n]:[h/n,k/n]:0<g?d?[a[b],a[b+1],a[b+2]]:[a[b],a[b+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.lineCentroid=a.getCentroidOptimizedGeometry=void 0;a.getCentroidOptimizedGeometry=function(a,h,g,d,f){if(!h||!h.lengths.length)return null;var c="upperLeft"===(null===f||void 0===f?void 0:f.originPosition)?-1:1;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);f=a.coords;for(var e=[],n=g?[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],t=h.lengths,k=h.coords,p=g?d?4:3:d?3:2,q=0,u=0;u<t.length;u++){var y=t[u],w=b(n,k,q,y,g,d,c);w&&e.push(w);q+=y*p}e.sort(function(a,b){var e=c*a[2]-c*b[2];0===e&&g&&(e=a[4]-b[4]);return e});e.length&&(p=6*e[0][2],f[0]=e[0][0]/p,f[1]=e[0][1]/p,g&&(p=6*e[0][4],f[2]=0!==p?e[0][3]/
p:0),f[0]<n[0]||f[0]>n[1]||f[1]<n[2]||f[1]>n[3]||g&&(f[2]<n[4]||f[2]>n[5]))&&(f.length=0);if(!f.length)if(h=h.lengths[0]?l(k,0,t[0],g,d):null)f[0]=h[0],f[1]=h[1],g&&2<h.length&&(f[2]=h[2]);else return null;return a};a.lineCentroid=l})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x){function p(){return new Promise(function(a,c){m(["../../../geometry/geometryEngineJSON"],a,c)})}Object.defineProperty(a,"__esModule",{value:!0});a.canQueryWithRBush=a.checkSpatialQuerySupport=a.getSpatialQueryOperator=a.getGeodesicBufferOperator=a.importGeometryEngine=void 0;var q={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",
esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},u={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},y={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!0},w={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=p;a.getGeodesicBufferOperator=function(){return p().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,f,t,u){if(d.isPolygon(b)&&"esriGeometryPoint"===f&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var l=e.convertFromPolygon(new n.default,b,!1,!1);return k.resolve(function(a){return c.polygonContainsPoint(l,
!1,!1,a)})}if(d.isPolygon(b)&&"esriGeometryMultipoint"===f){var w=e.convertFromPolygon(new n.default,b,!1,!1);if("esriSpatialRelContains"===a)return k.resolve(function(a){return c.polygonContainsMultipoint(w,!1,!1,a,t,u)})}if(d.isExtent(b)&&"esriGeometryPoint"===f&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return k.resolve(function(a){return h.extentContainsPoint(b,x.getGeometry(f,t,u,a))});if(d.isExtent(b)&&"esriGeometryMultipoint"===f&&"esriSpatialRelContains"===a)return k.resolve(function(a){return h.extentContainsMultipoint(b,
x.getGeometry(f,t,u,a))});if(d.isExtent(b)&&"esriSpatialRelIntersects"===a){var y=g.getExtentIntersector(f);return k.resolve(function(a){return y(b,x.getGeometry(f,t,u,a))})}return p().then(function(c){var e=c[q[a]].bind(null,b.spatialReference,b);return function(a){return e(x.getGeometry(f,t,u,a))}})};a.checkSpatialQuerySupport=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var g,n;return b.__generator(this,function(b){g=a.spatialRel;n=a.geometry;if(!n)return[2];if(!0!==u[g])throw new l("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!f.isValid(n.spatialReference)||!f.isValid(e))return[2];if(!0!==y[d.getJsonType(n)])throw new l("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==w[c])throw new l("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,t.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(d.isExtent(a))return!0;if(d.isPolygon(a)){var c=
0;for(a=a.rings;c<a.length;c++){var b=a[c];if(5!==b.length||b[0][0]!==b[1][0]||b[0][0]!==b[4][0]||b[2][0]!==b[3][0]||b[0][1]!==b[3][1]||b[0][1]!==b[4][1]||b[1][1]!==b[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(m,a){function b(a,b,h,g,d){if(!a)return!1;b=b?h?4:3:h?3:2;h=a.coords;var f=!1,c=0,e=0;for(a=a.lengths;e<a.length;e++){for(var n=a[e],t=c,k=c,p=c+n*b;k<p;k+=b){t=k+b;t===p&&(t=c);var q=h[k],u=h[k+1],l=h[t],t=h[t+1];(u<
d&&t>=d||t<d&&u>=d)&&q+(d-u)/(t-u)*(l-q)<g&&(f=!f)}c+=n*b}return f}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsCoords=a.polygonContainsMultipoint=a.polygonContainsPoint=void 0;a.polygonContainsPoint=function(a,k,h,g){return b(a,k,h,g.coords[0],g.coords[1])};a.polygonContainsMultipoint=function(a,k,h,g,d,f){d=d?f?4:3:f?3:2;f=g.coords;g=g.lengths;if(!g)return!1;for(var c=0,e=0;c<g.length;c++,e+=d)if(!b(a,k,h,f[e],f[e+1]))return!1;return!0};a.polygonContainsCoords=b})},"esri/layers/support/FieldsIndex":function(){define(["require",
"exports"],function(m,a){return function(){function a(a){this.fields=a;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this.dateFields=[];if(a){for(var b=[],h=0;h<a.length;h++){var g=a[h],d=g&&g.name;if(d){var f=d.toLowerCase().trim();this._fieldsMap.set(d,g);this._fieldsMap.set(f,g);b.push(f);if("date"===g.type||"esriFieldTypeDate"===g.type)this.dateFields.push(g),this._dateFieldsSet.add(g)}}b.sort();this.uid=b.join(",")}}a.prototype.destroy=function(){this._fieldsMap.clear()};a.prototype.has=
function(a){return null!=this.get(a)};a.prototype.get=function(a){return null!=a?this._fieldsMap.get(a)||this._fieldsMap.get(a.toLowerCase().trim()):void 0};a.prototype.isDateField=function(a){return this._dateFieldsSet.has(this.get(a))};a.prototype.normalizeFieldName=function(a){if(a=this.get(a))return a.name};return a}()})},"esri/views/2d/layers/features/FeatureStore2D":function(){define("require exports tslib ../../../../core/Evented ../../../../core/maybe ../../../../core/libs/rbush/rbush ../../../../geometry/support/aaBoundingBox ./Store2D".split(" "),
function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureStore2D=a.featureAdapter=void 0;a.featureAdapter={getObjectId:function(a){return a.getObjectId()},getAttributes:function(a){return a.readAttributes()},getAttribute:function(a,c){return a.readAttribute(c)},cloneWithGeometry:function(a,c){return a},getGeometry:function(a){return a.readHydratedGeometry()},getCentroid:function(a,c){return a.readCentroid()}};m=function(d){function c(c,b){var e=d.call(this,c,b)||this;e.featureAdapter=
a.featureAdapter;e.events=new l;e._featureSetsByInstance=new Map;e._objectIdToDisplayId=new Map;e._spatialIndexInvalid=!0;e._index=h(9,function(a){return{minX:e._storage.getXMin(a),minY:e._storage.getYMin(a),maxX:e._storage.getXMax(a),maxY:e._storage.getYMax(a)}});return e}b.__extends(c,d);Object.defineProperty(c.prototype,"storeStatistics",{get:function(){return{featureCount:0,vertexCount:0}},enumerable:!1,configurable:!0});c.prototype.onTileData=function(a,c,b){if(k.isNone(c.addOrUpdate))return c;
this._featureSetsByInstance.set(c.addOrUpdate.instance,c.addOrUpdate);this._storage=b;c.addOrUpdate._storage=b;for(var e=c.addOrUpdate.getCursor();e.next();){var d=e.getObjectId(),f;f=e.getIndex();f|=e.instance<<16;var g=this._objectIdToDisplayId.get(d);g||(g=b.createDisplayId(),this._objectIdToDisplayId.set(d,g),this._spatialIndexInvalid=!0);e.setDisplayId(g);b.setInstanceId(g,f);this.setComputedAttributes(b,e,g,a.scale)}"update"===c.type&&(this._spatialIndexInvalid=!0);this.events.emit("changed");
return c};c.prototype.forEach=function(a){var c=this;this._objectIdToDisplayId.forEach(function(b){b=c._storage.getInstanceId(b);b=c._lookupFeature(b);a(b)})};c.prototype.forEachUnsafe=function(a){var c=this;this._objectIdToDisplayId.forEach(function(b){var e=c._storage.getInstanceId(b);b=65535&e;e=c._getFeatureSet((4294901760&e)>>>16);e.setIndex(b);a(e)})};c.prototype.forEachInBounds=function(a,c){var b=0;for(a=this._searchIndex(a);b<a.length;b++){var e=this.lookupFeatureByDisplayId(a[b],this._storage);
c(k.unwrap(e))}};c.prototype.forEachBounds=function(a,c,b){this._rebuildIndex();for(var e=[0,0,0,0],d=0;d<a.length;d++){var f=a[d].getDisplayId();e[0]=this._storage.getXMin(f);e[1]=this._storage.getYMin(f);e[2]=this._storage.getXMax(f);e[3]=this._storage.getYMax(f);c(g.fromRect(b,e))}};c.prototype.sweepFeatures=function(a,c){var b=this;this._objectIdToDisplayId.forEach(function(e,d){a.has(e)||(c.releaseDisplayId(e),b._objectIdToDisplayId.delete(d))});this.events.emit("changed")};c.prototype.sweepFeatureSets=
function(a){var c=this;this._featureSetsByInstance.forEach(function(b,e){a.has(e)||c._featureSetsByInstance.delete(e)})};c.prototype.lookupObjectId=function(a,c){a=this.lookupFeatureByDisplayId(a,c);return k.isNone(a)?null:a.getObjectId()};c.prototype.lookupDisplayId=function(a){return this._objectIdToDisplayId.get(a)};c.prototype.lookupFeatureByDisplayId=function(a,c){a=c.getInstanceId(a);return this._lookupFeature(a)};c.prototype.lookupByDisplayIdUnsafe=function(a){var c=this._storage.getInstanceId(a);
a=65535&c;c=this._getFeatureSet((4294901760&c)>>>16);if(!c)return null;c.setIndex(a);return c};c.prototype.hasInstance=function(a){return this._featureSetsByInstance.has(a)};c.prototype._rebuildIndex=function(){var a=this;if(this._spatialIndexInvalid){this._index.clear();var c=[];this._objectIdToDisplayId.forEach(function(b){var e=a._storage.getInstanceId(b);a._storage.setBounds(b,a._lookupFeature(e))&&c.push(b)});this._index.load(c);this._spatialIndexInvalid=!1}};c.prototype._lookupFeature=function(a){var c=
65535&a;a=this._getFeatureSet((4294901760&a)>>>16);if(!a)return null;a=a.getCursor();a.setIndex(c);return a};c.prototype._getFeatureSet=function(a){return this._featureSetsByInstance.get(a)};c.prototype._searchIndex=function(a){this._rebuildIndex();return this._index.search({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]})};return c}(d.Store2D);a.FeatureStore2D=m})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(m){function a(c,b){if(!(this instanceof a))return new a(c,
b);this._maxEntries=Math.max(4,c||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));b&&("function"===typeof b?this.toBBox=b:this._initFormat(b));this.clear()}function b(a,c){l(a,0,a.children.length,c,a)}function l(a,c,b,e,d){d||(d=n(null));d.minX=Infinity;d.minY=Infinity;d.maxX=-Infinity;d.maxY=-Infinity;for(var f;c<b;c++)f=a.children[c],k(d,a.leaf?e(f):f);return d}function k(a,c){a.minX=Math.min(a.minX,c.minX);a.minY=Math.min(a.minY,c.minY);a.maxX=Math.max(a.maxX,c.maxX);a.maxY=Math.max(a.maxY,
c.maxY);return a}function h(a,c){return a.minX-c.minX}function g(a,c){return a.minY-c.minY}function d(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function f(a){return a.maxX-a.minX+(a.maxY-a.minY)}function c(a,c){return a.minX<=c.minX&&a.minY<=c.minY&&c.maxX<=a.maxX&&c.maxY<=a.maxY}function e(a,c){return c.minX<=a.maxX&&c.minY<=a.maxY&&c.maxX>=a.minX&&c.maxY>=a.minY}function n(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function t(a,c,b,e,d){for(var f=
[c,b],g;f.length;)b=f.pop(),c=f.pop(),b-c<=e||(g=c+Math.ceil((b-c)/e/2)*e,m(a,g,c,b,d),f.push(c,g,g,b))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,d=[],f=this.toBBox;if(!e(a,b))return d;for(var g=[],n,h,t,k;b;){n=0;for(h=b.children.length;n<h;n++)t=b.children[n],k=b.leaf?f(t):t,e(a,k)&&(b.leaf?d.push(t):c(a,k)?this._all(t,d):g.push(t));b=g.pop()}return d},collides:function(a){var b=this.data,d=this.toBBox;if(!e(a,b))return!1;for(var f=[],g,n,h,t;b;){g=
0;for(n=b.children.length;g<n;g++)if(h=b.children[g],t=b.leaf?d(h):h,e(a,t)){if(b.leaf||c(a,t))return!0;f.push(h)}b=f.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var c=0,b=a.length;c<b;c++)this.insert(a[c]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(c=this.data,this.data=a,a=c),this._insert(a,this.data.height-a.height-1,!0)):this.data=
a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=n([]);return this},remove:function(a,b){if(!a)return this;for(var e=this.data,d=this.toBBox(a),f=[],g=[],n,p,h,t;e||f.length;){e||(e=f.pop(),p=f[f.length-1],n=g.pop(),t=!0);if(e.leaf){a:{h=a;var k=e.children,l=b;if(l){for(var x=0;x<k.length;x++)if(l(h,k[x])){h=x;break a}h=-1}else h=k.indexOf(h)}if(-1!==h){e.children.splice(h,1);f.push(e);this._condense(f);break}}t||e.leaf||!c(e,d)?p?(n++,
e=p.children[n],t=!1):e=null:(f.push(e),g.push(n),n=0,p=e,e=e.children[0])}return this},toBBox:function(a){return a},compareMinX:h,compareMinY:g,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,c){for(var b=[];a;)a.leaf?c.push.apply(c,a.children):b.push.apply(b,a.children),a=b.pop();return c},_build:function(a,c,e,d){var f=e-c+1,g=this._maxEntries,p;if(f<=g)return p=n(a.slice(c,e+1)),b(p,this.toBBox),p;d||(d=Math.ceil(Math.log(f)/Math.log(g)),g=Math.ceil(f/
Math.pow(g,d-1)));p=n([]);p.leaf=!1;p.height=d;var f=Math.ceil(f/g),g=f*Math.ceil(Math.sqrt(g)),q,h,k;for(t(a,c,e,g,this.compareMinX);c<=e;c+=g)for(h=Math.min(c+g-1,e),t(a,c,h,f,this.compareMinY),q=c;q<=h;q+=f)k=Math.min(q+f-1,h),p.children.push(this._build(a,q,k,d-1));b(p,this.toBBox);return p},_chooseSubtree:function(a,c,b,e){for(var f,g,n,p,q,h,t,k;;){e.push(c);if(c.leaf||e.length-1===b)break;t=k=Infinity;f=0;for(g=c.children.length;f<g;f++)n=c.children[f],q=d(n),h=(Math.max(n.maxX,a.maxX)-Math.min(n.minX,
a.minX))*(Math.max(n.maxY,a.maxY)-Math.min(n.minY,a.minY))-q,h<k?(k=h,t=q<t?q:t,p=n):h===k&&q<t&&(t=q,p=n);c=p||c.children[0]}return c},_insert:function(a,c,b){var e=this.toBBox;b=b?a:e(a);var e=[],d=this._chooseSubtree(b,this.data,c,e);d.children.push(a);for(k(d,b);0<=c;)if(e[c].children.length>this._maxEntries)this._split(e,c),c--;else break;this._adjustParentBBoxes(b,e,c)},_split:function(a,c){var e=a[c],d=e.children.length,f=this._minEntries;this._chooseSplitAxis(e,f,d);d=this._chooseSplitIndex(e,
f,d);d=n(e.children.splice(d,e.children.length-d));d.height=e.height;d.leaf=e.leaf;b(e,this.toBBox);b(d,this.toBBox);c?a[c-1].children.push(d):this._splitRoot(e,d)},_splitRoot:function(a,c){this.data=n([a,c]);this.data.height=a.height+1;this.data.leaf=!1;b(this.data,this.toBBox)},_chooseSplitIndex:function(a,c,b){var e,f,g,n,p,q,h;p=q=Infinity;for(e=c;e<=b-c;e++)f=l(a,0,e,this.toBBox),g=l(a,e,b,this.toBBox),n=Math.max(0,Math.min(f.maxX,g.maxX)-Math.max(f.minX,g.minX))*Math.max(0,Math.min(f.maxY,g.maxY)-
Math.max(f.minY,g.minY)),f=d(f)+d(g),n<p?(p=n,h=e,q=f<q?f:q):n===p&&f<q&&(q=f,h=e);return h},_chooseSplitAxis:function(a,c,b){var e=a.leaf?this.compareMinX:h,d=a.leaf?this.compareMinY:g,f=this._allDistMargin(a,c,b,e);c=this._allDistMargin(a,c,b,d);f<c&&a.children.sort(e)},_allDistMargin:function(a,c,b,e){a.children.sort(e);e=this.toBBox;var d=l(a,0,c,e),g=l(a,b-c,b,e),n=f(d)+f(g),p,q;for(p=c;p<b-c;p++)q=a.children[p],k(d,a.leaf?e(q):q),n+=f(d);for(p=b-c-1;p>=c;p--)q=a.children[p],k(g,a.leaf?e(q):
q),n+=f(g);return n},_adjustParentBBoxes:function(a,c,b){for(;0<=b;b--)k(c[b],a)},_condense:function(a){for(var c=a.length-1,e;0<=c;c--)0===a[c].children.length?0<c?(e=a[c-1].children,e.splice(e.indexOf(a[c]),1)):this.clear():b(a[c],this.toBBox)},_initFormat:function(a){var c=["return a"," - b",";"];this.compareMinX=new Function("a","b",c.join(a[0]));this.compareMinY=new Function("a","b",c.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+
a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function m(b,k,h,g,d){for(;g>h;){if(600<g-h){var f=g-h+1,c=k-h+1,e=Math.log(f),n=.5*Math.exp(2*e/3),e=.5*Math.sqrt(e*n*(f-n)/f)*(0>c-f/2?-1:1);m(b,k,Math.max(h,Math.floor(k-c*n/f+e)),Math.min(g,Math.floor(k+(f-c)*n/f+e)),d)}f=b[k];c=h;n=g;a(b,h,k);for(0<d(b[g],f)&&a(b,h,g);c<n;){a(b,c,n);c++;for(n--;0>d(b[c],f);)c++;for(;0<d(b[n],f);)n--}0===d(b[h],f)?a(b,h,n):(n++,a(b,n,g));n<=k&&(h=n+1);k<=n&&(g=n-
1)}}function a(a,b,h){var g=a[b];a[b]=a[h];a[h]=g}function b(a,b){return a<b?-1:a>b?1:0}return function(a,k,h,g,d){m(a,k,h||0,g||a.length-1,d||b)}})},"esri/views/2d/layers/features/Store2D":function(){define("require exports tslib ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/diffUtils ../../../../support/arcadeOnDemand ../../arcade/callExpressionWithCursor @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,
"__esModule",{value:!0});a.Store2D=void 0;var c=new Promise(function(a,c){m(["../../../../layers/support/labelFormatUtils"],a,c)}),e=function(){function a(a,c){this._canCacheExpressionValue=!1;this._sourceInfo=a;this._bitsets={computed:c.getBitset(c.createBitset())}}a.prototype.updateSchema=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f,n,t,x,z;return b.__generator(this,function(b){switch(b.label){case 0:e=g.diff(this._schema,c);this._schema=c;if(!c||k.isNone(e)||!g.hasDiff(e,
"attributes"))return[2];l("esri-2d-update-debug")&&console.debug("Applying Update - Store:",e);this._bitsets.computed.clear();a.targets[c.name]=!0;d=c.attributes;f=[];n=[];for(t in d)switch(x=d[t],x.type){case "expression":f.push(this._createArcadeComputedField(x));break;case "label-expression":f.push(this._createLabelArcadeComputedField(x));break;case "statistic":n.push(x)}z=this;return[4,h.all(f)];case 1:return z._computedFields=b.sent(),this._canCacheExpressionValue=!this._computedFields.some(function(a){return"expression"===
a.type&&a.expression.referencesScale()}),this._statisticFields=n,[2]}})})};a.prototype.setComputedAttributes=function(a,c,b,e){var d=this._bitsets.computed;if(!this._canCacheExpressionValue||!d.has(b)){d.set(b);for(var d=0,f=this._computedFields;d<f.length;d++){var g=f[d],n=this._evaluateField(c,g,e);switch(g.resultType){case "numeric":a.setComputedNumericAtIndex(b,g.fieldIndex,n);break;case "string":a.setComputedStringAtIndex(b,g.fieldIndex,n)}}}};a.prototype._createArcadeComputedField=function(a){return b.__awaiter(this,
void 0,void 0,function(){var c,e,f,g;return b.__generator(this,function(n){switch(n.label){case 0:return c=this._sourceInfo.spatialReference,e=this._sourceInfo.fieldsIndex,f=[b.__assign({},a)],g={},[4,d.createRendererExpression(a.valueExpression,c,e)];case 1:return[2,b.__assign.apply(void 0,f.concat([(g.expression=n.sent(),g)]))]}})})};a.prototype._createLabelArcadeComputedField=function(a){return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g;return b.__generator(this,function(n){switch(n.label){case 0:return e=
this._sourceInfo.spatialReference,d=this._sourceInfo.fields,[4,c];case 1:return f=n.sent().createLabelFunction,[4,f(a.label,d,e)];case 2:return g=n.sent(),[2,b.__assign(b.__assign({},a),{builder:g})]}})})};a.prototype._evaluateField=function(a,c,b){switch(c.type){case "label-expression":return a=a.readArcadeFeature(),c.builder.evaluate(a)||"";case "expression":return f.default(c.expression,a,{$view:{scale:b}})}};return a}();a.Store2D=e})},"esri/core/accessorSupport/diffUtils":function(){define("require exports ../Accessor ../Collection ../maybe ./utils".split(" "),
function(m,a,b,l,k,h){function g(a){return a instanceof l?Object.keys(a.items):a instanceof b?h.getProperties(a).keys():a?Object.keys(a):[]}function d(a,c){return a instanceof l?a.items[c]:a[c]}function f(a,c){return Array.isArray(a)&&Array.isArray(c)?a.length!==c.length:!1}function c(a){return a?a.declaredClass:null}function e(a,n){var p,q=a.diff;if(q&&"function"===typeof q)return q(a,n);var h=g(a),t=g(n);if(0!==h.length||0!==t.length){if(!h.length||!t.length||f(a,n))return{type:"complete",oldValue:a,
newValue:n};var l=t.filter(function(a){return-1===h.indexOf(a)}),A=h.filter(function(a){return-1===t.indexOf(a)}),l=h.filter(function(c){return-1<t.indexOf(c)&&d(a,c)!==d(n,c)}).concat(l,A).sort();if((A=c(a))&&-1<x.indexOf(A)&&l.length)return{type:"complete",oldValue:a,newValue:n};for(var C,A=a instanceof b&&n instanceof b,m=0;m<l.length;m++){var D=l[m],F=d(a,D),H=d(n,D),I=void 0;!(A||"function"!==typeof F&&"function"!==typeof H)||F===H||null==F&&null==H||(I=q&&q[D]&&"function"===typeof q[D]?q[D](F,
H):"object"===typeof F&&"object"===typeof H&&c(F)===c(H)?e(F,H):{type:"complete",oldValue:F,newValue:H},k.isSome(I)&&(k.isSome(C)?C.diff[D]=I:C={type:"partial",diff:(p={},p[D]=I,p)}))}return C}}function n(a,c){if(k.isNone(a))return!1;c=c.split(".");var b=a;for(a=0;a<c.length;a++){var e=c[a];if("complete"===b.type)break;if("partial"===b.type){if(b=b.diff[e],!b)return!1}else return!1}return!0}function t(a){if(k.isNone(a))return!0;switch(a.type){case "complete":return!1;case "collection":for(var c=0,
b=a.added;c<b.length;c++){var e=b[c];if(!t(e))return!1}c=0;for(b=a.removed;c<b.length;c++)if(e=b[c],!t(e))return!1;c=0;for(a=a.changed;c<a.length;c++)if(e=a[c],!t(e))return!1;return!0;case "partial":for(c in a.diff)if(e=a.diff[c],!t(e))return!1;return!0}}Object.defineProperty(a,"__esModule",{value:!0});a.isEmpty=a.diff=a.hasDiffAny=a.hasDiff=void 0;var x=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];a.hasDiff=n;
a.hasDiffAny=function(a,c){for(var b=0;b<c.length;b++)if(n(a,c[b]))return!0;return!1};a.diff=function(a,b){if("function"!==typeof a&&"function"!==typeof b&&(a||b))return!a||!b||"object"===typeof a&&"object"===typeof b&&c(a)!==c(b)?{type:"complete",oldValue:a,newValue:b}:e(a,b)};a.isEmpty=t})},"esri/support/arcadeOnDemand":function(){define("require exports tslib ../geometry ../core/maybe ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h){function g(){return b.__awaiter(this,
void 0,void 0,function(){var a=this;return b.__generator(this,function(c){d||(d=function(){return b.__awaiter(a,void 0,void 0,function(){var a;return b.__generator(this,function(c){switch(c.label){case 0:return[4,new Promise(function(a,c){m(["./arcadeUtils"],a,c)})];case 1:return a=c.sent(),[4,a.arcade.load()];case 2:return c.sent(),[2,{arcade:a.arcade,arcadeUtils:a,Dictionary:a.Dictionary,Feature:a.arcadeFeature}]}})})}());return[2,d]})})}Object.defineProperty(a,"__esModule",{value:!0});a.ArcadeExpression=
a.createDictionaryExpression=a.createVVExpression=a.createRendererExpression=a.createLabelExpression=a.loadArcade=void 0;var d;a.loadArcade=g;a.createLabelExpression=function(a,b,d){return f.create(a,b,d,null,["$feature"])};a.createRendererExpression=function(a,b,d){return f.create(a,b,d,null,["$feature","$view"])};a.createVVExpression=a.createRendererExpression;a.createDictionaryExpression=function(a,b,d,g){return f.create(a,b,d,g,["$feature","$view"])};var f=function(){function a(a,c,b,d,f,g,h,
k){this.script=a;this.evaluate=f;this.fields=h;this._syntaxTree=d;this._arcade=c;this._arcadeDictionary=b;this._arcadeFeature=g;this._spatialReference=k;this._referencesGeometry=c.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}a.create=function(c,d,f,x,p,q){return b.__awaiter(this,void 0,void 0,function(){var e,n,t,B,z,A,C,m,D,F,H,I,G,K,L;return b.__generator(this,function(u){switch(u.label){case 0:return[4,g()];case 1:return e=
u.sent(),n=e.arcade,t=e.Feature,B=e.Dictionary,z=l.SpatialReference.fromJSON(d),A=n.parseScript(c,q),C=p.reduce(function(a,c){var e;return b.__assign(b.__assign({},a),(e={},e[c]=null,e))},{}),m=null,k.isSome(x)&&(m=new B(x),m.immutable=!0,C.$config=null),D=n.scriptUsesGeometryEngine(A)&&n.enableGeometrySupport(),F=n.scriptUsesFeatureSet(A)&&n.enableFeatureSetSupport(),H=n.scriptIsAsync(A)&&n.enableAsyncSupport(),I={vars:C,spatialReference:z,useAsync:!!H},G=new B,G.immutable=!1,G.setField("scale",
0),K=n.compileScript(A,I),L=function(a){"$view"in a&&a.$view&&(G.setField("scale",a.$view.scale),a.$view=G);m&&(a.$config=m);return K({vars:a,spatialReference:z})},[4,h.all([D,F,H])];case 2:return u.sent(),[2,new a(c,n,B,A,L,new t,f,z)]}})})};a.prototype.repurposeFeature=function(a){a.geometry&&!a.geometry.spatialReference&&(a.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(a.geometry,a.attributes,{fields:this.fields});return this._arcadeFeature};
a.prototype.repurposeAdapter=function(a){this._arcadeFeature.repurposeFromAdapter(a,{fields:this.fields});return this._arcadeFeature};a.prototype.createDictionary=function(){return new this._arcadeDictionary};a.prototype.referencesMember=function(a){return this._arcade.referencesMember(this._syntaxTree,a)};a.prototype.referencesFunction=function(a){return this._arcade.referencesFunction(this._syntaxTree,a)};a.prototype.referencesGeometry=function(){return this._referencesGeometry};a.prototype.referencesScale=
function(){return this._referencesScale};a.prototype.extractFieldLiterals=function(a){return this._arcade.extractFieldLiterals(this._syntaxTree,a)};return a}();a.ArcadeExpression=f;a.default=f})},"esri/views/2d/arcade/callExpressionWithCursor":function(){define(["require","exports","tslib","../../../core/Logger"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a,h,g){a.referencesGeometry();h=h.readArcadeFeature();try{return a.evaluate(b.__assign(b.__assign({},
g),{$feature:h}))}catch(d){return l.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",d),null}}})},"esri/views/2d/layers/features/Source2D":function(){define("require exports tslib ../../../../TimeExtent ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/diffUtils ../../../../tasks/support/Query ../../engine/webgl/definitions ./sources/createSource ./support/UpdateToken".split(" "),function(m,a,b,l,k,
h,g,d,f,c,e,n){function t(a,b){var e=[];e.push(new q([0,0],a,null));if(0===b)return e;b=Math.min(b,c.TILE_SIZE);var d=c.TILE_SIZE;e.push(new q([-d,-d],a.neighbor(-1,-1),[d-b,d-b,d,d]));e.push(new q([0,-d],a.neighbor(0,-1),[0,d-b,d,d]));e.push(new q([d,-d],a.neighbor(1,-1),[0,d-b,b,d]));e.push(new q([-d,0],a.neighbor(-1,0),[d-b,0,d,d]));e.push(new q([d,0],a.neighbor(1,0),[0,0,b,d]));e.push(new q([-d,d],a.neighbor(-1,1),[d-b,0,d,b]));e.push(new q([0,d],a.neighbor(0,1),[0,0,d,b]));e.push(new q([d,d],
a.neighbor(1,1),[0,0,b,b]));return e}Object.defineProperty(a,"__esModule",{value:!0});a.Source2D=void 0;var x=0,p=function(){function a(a,c){this.didSend=!1;this.dataTileCount=0;this.update=n.UpdateToken.all();this._abortController=new AbortController;this.invalid=!1;this.displayTile=a;this._pixelBuffer=c;this.partitions=t(a,c)}a.prototype.setUpdate=function(a,c){this.update=a;this.dataTileCount=0;c!==this._pixelBuffer&&(this._pixelBuffer=c,this.partitions=t(this.displayTile,c));a.mesh&&(this.didSend=
!1)};Object.defineProperty(a.prototype,"signal",{get:function(){return this._abortController.signal},enumerable:!1,configurable:!0});a.prototype.abort=function(){this._abortController.abort()};return a}(),q=function(){function a(a,c,b){this.resolved=!1;this.tile=c;this.offset=a;this.extent=b}a.prototype.reset=function(){this.resolved=!1};return a}();m=function(){function a(a,c,b){var d=this;this.type="remote";this._pendingEdits=new Set;this._queryInfo=null;this._subscriptions={display:new Map};this._invalid=
{outFields:!1,queryFilterParameters:!1};var f=this._onDataTileRequest.bind(this);this._source=e.createSource(a,c,b,f,function(){return d.canAcceptPatch()});this._serviceInfo=a;this._geometryType=a.geometryType;this._outSR=c}a.prototype.destroy=function(){var a=this;this._getSubscriptions().map(function(c){return a.unsubscribe(c.displayTile)});this._source.destroy()};Object.defineProperty(a.prototype,"updating",{get:function(){return this._source.updating||this._getSubscriptions().some(function(a){return!a.didSend})},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"isStream",{get:function(){return"geoevent"===this._source.type},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"sourceEvents",{get:function(){return"geoevent"===this._source.type?{type:"geoevent",events:this._source.events}:{type:"feature",events:this._source.events}},enumerable:!1,configurable:!0});a.prototype.enableEvent=function(a,c){this._source.enableEvent(a,c)};a.prototype.setViewState=function(a){this._source.setViewState(a)};
a.prototype.update=function(a,c){var e,f,g,n,p=this._serviceInfo.fields.length,q=null!==(f=null===(e=this._schema)||void 0===e?void 0:e.outFields)&&void 0!==f?f:[];e=null!==(n=null===(g=this._schema)||void 0===g?void 0:g.pixelBuffer)&&void 0!==n?n:0;g=c.outFields.filter(function(a){return-1===q.indexOf(a)});g=b.__spreadArrays(q,g);c.pixelBuffer=0===c.pixelBuffer?0:Math.max(c.pixelBuffer,e);c.outFields=g.length>=.75*p?["*"]:g;c.outFields.sort();e=d.diff(this._schema,c);this._subscriptions.display.forEach(function(c){c.invalid&&
(a.queryFilter=!0)});e&&(p=this._schema&&d.hasDiff(e,"outFields"),g=this._schema&&d.hasDiff(e,"pixelBuffer"),n=this._schema&&d.hasDiffAny(e,["definitionExpression","gdbVersion","historicMoment"]),k("esri-2d-update-debug")&&console.debug("Applying Update - Source:",e),e={returnCentroid:"esriGeometryPolygon"===this._geometryType,returnGeometry:!0,outFields:c.outFields,outSpatialReference:this._outSR,orderByFields:[this._serviceInfo.objectIdField+" ASC"],where:c.definitionExpression||"1\x3d1",gdbVersion:c.gdbVersion,
historicMoment:c.historicMoment?new Date(c.historicMoment):null,timeExtent:l.fromJSON(c.timeExtent)},a.source=!0,g&&(a.why.mesh.push("Pixel buffer changed"),a.mesh=!0),n&&(a.why.mesh.push("Layer filter changed"),a.why.source.push("Layer filter changed"),a.mesh=!0,a.queryFilter=!0,this._invalid.queryFilterParameters=!0),p&&(a.why.source.push("Layer required fields changed"),this._invalid.outFields=!0),this._schema=c,this._source.update(e),this._queryInfo=e)};a.prototype.subscribe=function(a){this._subscriptions.display.has(a.id)||
this._subscribeDisplayTile(a)};a.prototype.unsubscribe=function(a){if(this._subscriptions.display.has(a.id)){var c=this._subscriptions.display.get(a.id);this._subscriptions.display.delete(a.id);this._source.unsubscribe(a);c.abort()}};a.prototype.forEachRequest=function(a,c){this._source.forEachRequest(a,c)};a.prototype.query=function(a){return this._source.query(a)};a.prototype.createQuery=function(){return new f(b.__assign({},this._queryInfo))};a.prototype.createTileQuery=function(a){if("stream"===
this._serviceInfo.type)throw Error("Service does not support tile  queries");var c=this.createQuery();c.quantizationParameters=a.getQuantizationParameters();c.resultType="tile";c.geometry=a.extent;"esriGeometryPolyline"===this._serviceInfo.geometryType&&(c.maxAllowableOffset=a.resolution);this._serviceInfo.capabilities.query.supportsQuantization||(c.quantizationParameters=null,c.maxAllowableOffset=a.resolution);return c};a.prototype.invalidate=function(){this._subscriptions.display.forEach(function(a){return a.invalid=
!0})};a.prototype.forEachPendingEdit=function(a){this._getSubscriptions().some(function(a){return a.invalid})?this._pendingEdits.forEach(a):this._pendingEdits.clear()};a.prototype.onEdits=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f,p,q,h,t,k=this;return b.__generator(this,function(l){switch(l.label){case 0:return c=a.addedFeatures.filter(function(a){return!a.error}).map(function(a){return a.objectId}),e=a.updatedFeatures.filter(function(a){return!a.error}).map(function(a){return a.objectId}),
d=a.deletedFeatures.filter(function(a){return!a.error}).map(function(a){return a.objectId}),f=b.__spreadArrays(c,e),d.forEach(function(a){k._pendingEdits.has(a)&&k._pendingEdits.delete(a)}),f.forEach(function(a){return k._pendingEdits.add(a)}),p=this._getSubscriptions().map(function(a){return a.displayTile}),q=p.map(function(a){var c=k.createTileQuery(a);c.objectIds=f;return{tile:a,query:c}}),h=q.map(function(a){var c=a.tile,e=a.query;return b.__awaiter(k,void 0,void 0,function(){var a;return b.__generator(this,
function(b){switch(b.label){case 0:return a={tile:c},[4,this._source.query(e)];case 1:return[2,(a.result=b.sent(),a)]}})})}),[4,g.all(h)];case 1:return t=l.sent(),t.forEach(function(a){var c=a.tile;a=a.result;var f=k._subscriptions.display.get(c.key.id);if(f){var f=f.signal,g=n.UpdateToken.all();k.onDisplayTilePatch({type:"update",id:c.key.id,version:x++,update:g,addOrUpdate:a,remove:b.__spreadArrays(e,d),end:!0,noData:!1},{signal:f})}}),this.invalidate(),[2]}})})};a.prototype.resubscribe=function(a,
c){void 0===c&&(c=!1);return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g=this;return b.__generator(this,function(b){switch(b.label){case 0:e=this._schema.pixelBuffer;this._subscriptions.display.forEach(function(c){return c.setUpdate(a,e)});d=!1;this._subscriptions.display.forEach(function(a){a.invalid&&(d=!0)});this._invalid.outFields&&(this._invalid.outFields=!1);if(!(c||this._invalid.queryFilterParameters||d))return[3,1];f=this._getSubscriptions().map(function(a){return a.displayTile});
f.forEach(function(a){return g.unsubscribe(a)});f.forEach(function(a){return g.subscribe(a)});this._source.resume();this._invalid.queryFilterParameters=!1;return[3,5];case 1:return a.mesh?[4,this._source.resend({dataTileOnly:!1})]:[3,3];case 2:return b.sent(),[3,5];case 3:return[4,this._source.resend({dataTileOnly:!0})];case 4:b.sent(),b.label=5;case 5:return[2]}})})};a.prototype.pause=function(){this._source.pause()};a.prototype.resume=function(){this._source.resume()};a.prototype._getSubscriptions=
function(){var a=[];this._subscriptions.display.forEach(function(c){a.push(c)});return a};a.prototype._subscribeDisplayTile=function(a){var c=new p(a,this._schema.pixelBuffer);this._subscriptions.display.set(a.id,c);this._source.subscribe(a);for(var b=0,c=c.partitions;b<c.length;b++){var e=c[b],d=this._source.get(e.tile.id);if(h.isSome(d))for(var f=0,d=d.requests.done;f<d.length;f++)this._onPartitionMessage(a.id,e,d[f].request,"new")}};a.prototype._onDataTileRequest=function(a,c,b){var e=this,d=this._subscriptions.display.get(a.id);
if(b&&b.dataTileOnly){b=0;for(var f=d.partitions;b<f.length;b++)if(d=f[b],d.tile.id===a.id){this._onPartitionMessage(a.id,d,a,c);break}}else{b=0;for(f=d.partitions;b<f.length;b++)if(d=f[b],d.tile.id===a.id){this._onPartitionMessage(a.id,d,a,c);break}this._subscriptions.display.forEach(function(b,d){if(d!==a.id){var f=0;for(b=b.partitions;f<b.length;f++){var g=b[f];if(g.tile.id===a.id){e._onPartitionMessage(d,g,a,c);break}}}})}};a.prototype._onPartitionMessage=function(a,c,b,e){var d=h.andThen(b.features,
function(a){if(!h.isNone(c.extent)){var b=c.offset,e=c.extent,d=b[0],b=b[1];a=a.extent(e[0],e[1],e[2],e[3]).transform(d,b)}return a}),f=this._subscriptions.display.get(a),g=f.signal;f.didSend||(e="replace");var n=!1;b.end&&(c.resolved=!0,n=a===c.tile.id);f.didSend=!0;this.onDisplayTilePatch({type:e,id:a,version:x++,update:f.update,addOrUpdate:d,remove:b.remove||[],noData:b.noData,end:n},{signal:g})};return a}();a.Source2D=m})},"esri/TimeExtent":function(){define("require exports tslib ./core/JSONSupport ./core/accessorSupport/decorators ./layers/support/timeUtils".split(" "),
function(m,a,b,l,k,h){m=function(a){function c(c){c=a.call(this,c)||this;c.end=null;c.start=null;return c}b.__extends(c,a);e=c;Object.defineProperty(c,"allTime",{get:function(){return g},enumerable:!1,configurable:!0});Object.defineProperty(c,"empty",{get:function(){return d},enumerable:!1,configurable:!0});c.prototype.readEnd=function(a,c){return null!=c.end?new Date(c.end):null};c.prototype.writeEnd=function(a,c){c.end=a?a.getTime():null};Object.defineProperty(c.prototype,"isAllTime",{get:function(){return this.equals(e.allTime)},
enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"isEmpty",{get:function(){return this.equals(e.empty)},enumerable:!1,configurable:!0});c.prototype.readStart=function(a,c){return null!=c.start?new Date(c.start):null};c.prototype.writeStart=function(a,c){c.start=a?a.getTime():null};c.prototype.clone=function(){return new e({end:this.end,start:this.start})};c.prototype.intersection=function(a){var c,b,d,f,g,n,h,k;if(!a)return this.clone();if(this.isEmpty||a.isEmpty)return e.empty;if(this.isAllTime)return a.clone();
if(a.isAllTime)return this.clone();var l=null!==(b=null===(c=this.start)||void 0===c?void 0:c.getTime())&&void 0!==b?b:-Infinity;c=null!==(f=null===(d=this.end)||void 0===d?void 0:d.getTime())&&void 0!==f?f:Infinity;d=null!==(n=null===(g=a.start)||void 0===g?void 0:g.getTime())&&void 0!==n?n:-Infinity;a=null!==(k=null===(h=a.end)||void 0===h?void 0:h.getTime())&&void 0!==k?k:Infinity;var A,C;d>=l&&d<=c?A=d:l>=d&&l<=a&&(A=l);c>=d&&c<=a?C=c:a>=l&&a<=c&&(C=a);return isNaN(A)||isNaN(C)?e.empty:(h=new e,
h.start=-Infinity===A?null:new Date(A),h.end=Infinity===C?null:new Date(C),h)};c.prototype.offset=function(a,c){if(this.isEmpty||this.isAllTime)return this.clone();var b=new e,d=this.start,f=this.end;d&&(b.start=h.offsetDate(d,a,c));f&&(b.end=h.offsetDate(f,a,c));return b};c.prototype.equals=function(a){if(!a)return!1;var c=this.start?this.start.getTime():this.start,b=this.end?this.end.getTime():this.end,e=a.start?a.start.getTime():a.start;a=a.end?a.end.getTime():a.end;return c===e&&b===a};var e;
b.__decorate([k.property({type:Date,json:{write:{allowNull:!0}}})],c.prototype,"end",void 0);b.__decorate([k.reader("end")],c.prototype,"readEnd",null);b.__decorate([k.writer("end")],c.prototype,"writeEnd",null);b.__decorate([k.property({dependsOn:["start","end"],readOnly:!0,json:{read:!1}})],c.prototype,"isAllTime",null);b.__decorate([k.property({dependsOn:["start","end"],readOnly:!0,json:{read:!1}})],c.prototype,"isEmpty",null);b.__decorate([k.property({type:Date,json:{write:{allowNull:!0}}})],
c.prototype,"start",void 0);b.__decorate([k.reader("start")],c.prototype,"readStart",null);b.__decorate([k.writer("start")],c.prototype,"writeStart",null);return c=e=b.__decorate([k.subclass("esri.TimeExtent")],c)}(l.JSONSupport);var g=new m,d=new m({start:void 0,end:void 0});return m})},"esri/layers/support/timeUtils":function(){define(["require","exports","../../core/compilerUtils","../../core/jsonMap"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.truncateDate=a.millisecondsPerTimeUnit=
a.offsetDate=a.timeUnitKebabDictionary=a.Milliseconds=void 0;a.Milliseconds=function(a){return a};var k={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",
setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};a.timeUnitKebabDictionary=l.strict()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",
esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:null});a.offsetDate=function(a,b,d){a=new Date(a.getTime());if(b&&d){d=k[d];var f=d.multiplier;a[d.setter](a[d.getter]()+b*f)}return a};a.millisecondsPerTimeUnit={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};a.truncateDate=function(a,g){switch(g){case "milliseconds":return new Date(a.getTime());case "seconds":return new Date(a.getFullYear(),
a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());case "minutes":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes());case "hours":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours());case "days":return new Date(a.getFullYear(),a.getMonth(),a.getDate());case "weeks":return new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay());case "months":return new Date(a.getFullYear(),a.getMonth(),1);case "years":return new Date(a.getFullYear(),
0,1);case "decades":return new Date(a.getFullYear()-a.getFullYear()%10,0,1);case "centuries":return new Date(a.getFullYear()-a.getFullYear()%100,0,1);default:return b.neverReached(g),null}}})},"esri/tasks/support/Query":function(){define("require exports tslib ../../geometry ../../geometry ../../symbols ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./QuantizationParameters ./StatisticDefinition".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q){var u=new d.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),y=new d.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function d(c){c=a.call(this,c)||this;c.cacheHint=void 0;c.datumTransformation=null;c.distance=void 0;c.dynamicDataSource=void 0;c.gdbVersion=null;c.geometry=null;c.geometryPrecision=void 0;c.groupByFieldsForStatistics=null;c.having=null;c.historicMoment=null;c.maxAllowableOffset=void 0;c.maxRecordCountFactor=1;c.multipatchOption=null;c.num=
void 0;c.objectIds=null;c.orderByFields=null;c.outFields=null;c.outSpatialReference=null;c.outStatistics=null;c.parameterValues=null;c.pixelSize=null;c.quantizationParameters=null;c.rangeValues=null;c.relationParameter=null;c.resultType=null;c.returnCentroid=!1;c.returnDistinctValues=!1;c.returnExceededLimitFeatures=!0;c.returnGeometry=!1;c.returnQueryGeometry=!1;c.returnM=void 0;c.returnZ=void 0;c.spatialRelationship="intersects";c.start=void 0;c.sqlFormat=null;c.text=null;c.timeExtent=null;c.units=
null;c.where=null;return c}b.__extends(d,a);f=d;d.from=function(a){return n.ensureClass(f,a)};d.prototype.castDatumTransformation=function(a){return"number"===typeof a||"object"===typeof a?a:null};d.prototype.writeHistoricMoment=function(a,c){c.historicMoment=a&&a.getTime()};d.prototype.writeParameterValues=function(a,c){if(a){var b={},e;for(e in a){var d=a[e];Array.isArray(d)?b[e]=d.map(function(a){return a instanceof Date?a.getTime():a}):b[e]=d instanceof Date?d.getTime():d}c.parameterValues=b}};
d.prototype.writeStart=function(a,c){c.resultOffset=this.start;c.resultRecordCount=this.num||10;c.where="1\x3d1"};d.prototype.writeWhere=function(a,c){c.where=a||"1\x3d1"};d.prototype.clone=function(){return new f(c.clone({cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment?
new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,
resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))};var f;
d.MAX_MAX_RECORD_COUNT_FACTOR=5;b.__decorate([e.property({type:Boolean,json:{write:{writer:function(a,c){null!=a&&(c.cacheHint=a)}}}})],d.prototype,"cacheHint",void 0);b.__decorate([e.property({json:{write:!0}})],d.prototype,"datumTransformation",void 0);b.__decorate([e.cast("datumTransformation")],d.prototype,"castDatumTransformation",null);b.__decorate([e.property({type:Number,json:{write:{overridePolicy:function(a){return{enabled:0<a}}}}})],d.prototype,"distance",void 0);b.__decorate([e.property({type:x.DataLayerSource,
json:{write:!0}})],d.prototype,"dynamicDataSource",void 0);b.__decorate([e.property({type:String,json:{write:!0}})],d.prototype,"gdbVersion",void 0);b.__decorate([e.property({types:k.geometryTypes,json:{read:t.fromJSON,write:!0}})],d.prototype,"geometry",void 0);b.__decorate([e.property({type:Number,json:{write:!0}})],d.prototype,"geometryPrecision",void 0);b.__decorate([e.property({type:[String],json:{write:!0}})],d.prototype,"groupByFieldsForStatistics",void 0);b.__decorate([e.property({type:String,
json:{write:!0}})],d.prototype,"having",void 0);b.__decorate([e.property({type:Date})],d.prototype,"historicMoment",void 0);b.__decorate([e.writer("historicMoment")],d.prototype,"writeHistoricMoment",null);b.__decorate([e.property({type:Number,json:{write:!0}})],d.prototype,"maxAllowableOffset",void 0);b.__decorate([e.property({type:Number,cast:function(a){return 1>a?1:a>f.MAX_MAX_RECORD_COUNT_FACTOR?f.MAX_MAX_RECORD_COUNT_FACTOR:a},json:{write:{overridePolicy:function(a){return{enabled:1<a}}}}})],
d.prototype,"maxRecordCountFactor",void 0);b.__decorate([e.property({type:String,json:{write:!0}})],d.prototype,"multipatchOption",void 0);b.__decorate([e.property({type:Number,json:{read:{source:"resultRecordCount"}}})],d.prototype,"num",void 0);b.__decorate([e.property({type:[Number],json:{write:!0}})],d.prototype,"objectIds",void 0);b.__decorate([e.property({type:[String],json:{write:!0}})],d.prototype,"orderByFields",void 0);b.__decorate([e.property({type:[String],json:{write:!0}})],d.prototype,
"outFields",void 0);b.__decorate([e.property({type:l.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],d.prototype,"outSpatialReference",void 0);b.__decorate([e.property({type:[q],json:{write:{enabled:!0,overridePolicy:function(){var a;return{enabled:0<(null===(a=this.outStatistics)||void 0===a?void 0:a.length)}}}}})],d.prototype,"outStatistics",void 0);b.__decorate([e.property({json:{write:!0}})],d.prototype,"parameterValues",void 0);b.__decorate([e.writer("parameterValues")],
d.prototype,"writeParameterValues",null);b.__decorate([e.property({types:h.symbolTypes,json:{write:!0}})],d.prototype,"pixelSize",void 0);b.__decorate([e.property({type:p.default,json:{write:!0}})],d.prototype,"quantizationParameters",void 0);b.__decorate([e.property({type:[Object],json:{write:!0}})],d.prototype,"rangeValues",void 0);b.__decorate([e.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(){return{enabled:"relation"===this.spatialRelationship}}}}})],
d.prototype,"relationParameter",void 0);b.__decorate([e.property({type:String,json:{write:!0}})],d.prototype,"resultType",void 0);b.__decorate([e.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],d.prototype,"returnCentroid",void 0);b.__decorate([e.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],d.prototype,"returnDistinctValues",void 0);b.__decorate([e.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:!a}}}}})],
d.prototype,"returnExceededLimitFeatures",void 0);b.__decorate([e.property({type:Boolean,json:{write:!0}})],d.prototype,"returnGeometry",void 0);b.__decorate([e.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],d.prototype,"returnQueryGeometry",void 0);b.__decorate([e.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],d.prototype,"returnM",void 0);b.__decorate([e.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],
d.prototype,"returnZ",void 0);b.__decorate([e.property({type:String,json:{read:{source:"spatialRel",reader:u.read},write:{target:"spatialRel",writer:u.write}}})],d.prototype,"spatialRelationship",void 0);b.__decorate([e.property({type:Number,json:{read:{source:"resultOffset"}}})],d.prototype,"start",void 0);b.__decorate([e.writer("start"),e.writer("num")],d.prototype,"writeStart",null);b.__decorate([e.property({type:String,json:{write:!0}})],d.prototype,"sqlFormat",void 0);b.__decorate([e.property({type:String,
json:{write:!0}})],d.prototype,"text",void 0);b.__decorate([e.property({type:g,json:{write:!0}})],d.prototype,"timeExtent",void 0);b.__decorate([e.property({type:String,json:{read:y.read,write:{writer:y.write,overridePolicy:function(a){return{enabled:a&&0<this.distance}}}}})],d.prototype,"units",void 0);b.__decorate([e.property({type:String,json:{write:{overridePolicy:function(a){return{enabled:null!=a||0<this.start}}}}})],d.prototype,"where",void 0);b.__decorate([e.writer("where")],d.prototype,"writeWhere",
null);return d=f=b.__decorate([e.subclass("esri.tasks.support.Query")],d)}(f.JSONSupport)})},"esri/symbols":function(){define("require exports ./core/accessorSupport/ensureType ./core/accessorSupport/extensions/serializableProperty/reader ./symbols/CIMSymbol ./symbols/ExtrudeSymbol3DLayer ./symbols/FillSymbol ./symbols/FillSymbol3DLayer ./symbols/Font ./symbols/IconSymbol3DLayer ./symbols/LabelSymbol3D ./symbols/LineSymbol3D ./symbols/LineSymbol3DLayer ./symbols/MarkerSymbol ./symbols/MeshSymbol3D ./symbols/ObjectSymbol3DLayer ./symbols/PathSymbol3DLayer ./symbols/PictureFillSymbol ./symbols/PictureMarkerSymbol ./symbols/PointSymbol3D ./symbols/PolygonSymbol3D ./symbols/SimpleFillSymbol ./symbols/SimpleLineSymbol ./symbols/SimpleMarkerSymbol ./symbols/Symbol ./symbols/Symbol3D ./symbols/Symbol3DLayer ./symbols/TextSymbol ./symbols/TextSymbol3DLayer ./symbols/WaterSymbol3DLayer ./symbols/WebStyleSymbol ./symbols/callouts/LineCallout3D ./symbols/callouts/LineCallout3DBorder ./symbols/support/Symbol3DVerticalOffset ./symbols/support/jsonUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z,A,C,E,D,F,H,I,G,K,L,O,P,N,S){Object.defineProperty(a,"__esModule",{value:!0});a.ensureType=a.symbolTypesLabel3D=a.symbolTypesRenderer3D=a.symbolTypes3D=a.symbolTypesLabel=a.symbolTypesRenderer=a.readSymbol=a.symbolTypes=a.isSymbol3D=a.isSymbol2D=a.isSymbol=a.WebStyleSymbol=a.WaterSymbol3DLayer=a.TextSymbol3DLayer=a.TextSymbol=a.SimpleMarkerSymbol=a.SimpleLineSymbol=a.SimpleFillSymbol=a.PolygonSymbol3D=a.PointSymbol3D=a.PictureMarkerSymbol=a.PictureFillSymbol=
a.PathSymbol3DLayer=a.ObjectSymbol3DLayer=a.MeshSymbol3D=a.LineSymbol3DLayer=a.LineSymbol3D=a.LineCallout3DBorder=a.LineCallout3D=a.LabelSymbol3D=a.IconSymbol3DLayer=a.Font=a.FillSymbol3DLayer=a.ExtrudeSymbol3DLayer=a.CIMSymbol=a.BaseSymbol3DLayer=a.BaseSymbol3D=a.BaseSymbol=a.BaseMarkerSymbol=a.BaseFillSymbol=void 0;a.CIMSymbol=k;a.ExtrudeSymbol3DLayer=h;a.BaseFillSymbol=g;a.FillSymbol3DLayer=d;a.Font=f;a.IconSymbol3DLayer=c;a.LabelSymbol3D=e;a.LineSymbol3D=n;a.LineSymbol3DLayer=t;a.BaseMarkerSymbol=
x;a.MeshSymbol3D=p;a.ObjectSymbol3DLayer=q;a.PathSymbol3DLayer=u;a.PictureFillSymbol=y;a.PictureMarkerSymbol=w;a.PointSymbol3D=B;a.PolygonSymbol3D=z;a.SimpleFillSymbol=A;a.SimpleLineSymbol=C;a.SimpleMarkerSymbol=E;a.BaseSymbol=D;a.BaseSymbol3D=F;a.BaseSymbol3DLayer=H;a.TextSymbol=I;a.TextSymbol3DLayer=G;a.WaterSymbol3DLayer=K;a.WebStyleSymbol=L;a.LineCallout3D=O;a.LineCallout3DBorder=P;Object.defineProperty(a,"Symbol3DVerticalOffset",{enumerable:!0,get:function(){return N.Symbol3DVerticalOffset}});
Object.defineProperty(a,"fromJSON",{enumerable:!0,get:function(){return S.fromJSON}});a.isSymbol=function(a){return a instanceof D};a.isSymbol2D=function(a){if(!a)return!1;switch(a.type){case "picture-fill":case "picture-marker":case "simple-fill":case "simple-line":case "simple-marker":case "text":case "cim":return!0;default:return!1}};a.isSymbol3D=function(a){if(!a)return!1;switch(a.type){case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return!0;default:return!1}};
a.symbolTypes={base:D,key:"type",typeMap:{"simple-fill":A,"picture-fill":y,"picture-marker":w,"simple-line":C,"simple-marker":E,text:I,"label-3d":e,"line-3d":n,"mesh-3d":p,"point-3d":B,"polygon-3d":z,"web-style":L,cim:k},errorContext:"symbol"};a.readSymbol=l.createTypeReader({types:a.symbolTypes});a.symbolTypesRenderer={base:D,key:"type",typeMap:{"simple-fill":A,"picture-fill":y,"picture-marker":w,"simple-line":C,"simple-marker":E,text:I,"line-3d":n,"mesh-3d":p,"point-3d":B,"polygon-3d":z,"web-style":L,
cim:k},errorContext:"symbol"};a.symbolTypesLabel={base:D,key:"type",typeMap:{text:I,"label-3d":e},errorContext:"symbol"};a.symbolTypes3D={base:D,key:"type",typeMap:{"label-3d":e,"line-3d":n,"mesh-3d":p,"point-3d":B,"polygon-3d":z,"web-style":L},errorContext:"symbol"};a.symbolTypesRenderer3D={base:D,key:"type",typeMap:{"line-3d":n,"mesh-3d":p,"point-3d":B,"polygon-3d":z,"web-style":L},errorContext:"symbol"};a.symbolTypesLabel3D={base:D,key:"type",typeMap:{"label-3d":e},errorContext:"symbol"};a.ensureType=
b.ensureOneOfType(a.symbolTypes)})},"esri/symbols/CIMSymbol":function(){define("require exports tslib ../core/lang ../core/promiseUtils ../core/string ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Symbol".split(" "),function(m,a,b,l,k,h,g,d,f){return function(a){function c(c){c=a.call(this,c)||this;c.data=null;c.type="cim";return c}b.__extends(c,a);f=c;c.prototype.readData=function(a,c){return c};c.prototype.writeData=function(a,c){if(a)for(var b in a)c[b]=a[b]};c.prototype.collectRequiredFields=
function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,f,g;return b.__generator(this,function(b){switch(b.label){case 0:if("CIMSymbolReference"!==this.data.type)return[3,2];e=this.data;f=e.primitiveOverrides;if(!f)return[3,2];g=f.map(function(b){return d.collectArcadeFieldNames(a,c,b.valueExpressionInfo.expression)});return[4,k.all(g)];case 1:b.sent(),b.label=2;case 2:return[2]}})})};c.prototype.clone=function(){return new f({data:l.clone(this.data)})};c.prototype.hash=function(){return h.numericHash(JSON.stringify(this.data)).toString()};
var f;b.__decorate([g.property({json:{write:!1}})],c.prototype,"color",void 0);b.__decorate([g.property({json:{write:!0}})],c.prototype,"data",void 0);b.__decorate([g.reader("data",["symbol"])],c.prototype,"readData",null);b.__decorate([g.writer("data")],c.prototype,"writeData",null);b.__decorate([g.enumeration({CIMSymbolReference:"cim"},{readOnly:!0})],c.prototype,"type",void 0);return c=f=b.__decorate([g.subclass("esri.symbols.CIMSymbol")],c)}(f)})},"esri/layers/support/fieldUtils":function(){define("require exports tslib @dojo/framework/shim/array ../../core/Error ../../core/maybe ../../core/object ../../core/promiseUtils ../../core/SetUtils ./domains ../../support/arcadeOnDemand @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){function n(a,c,b){if(a)for(var e=0;e<a.length;e++){var d=a[e],f=g.getDeepValue(d,c);(f=f&&"function"!==typeof f&&q(b,f))&&g.setDeepValue(d,f.name,c)}}function t(a,c){if(!a||!c)return[];S.clear();x(S,a,c);return f.valuesOfSet(S).sort()}function x(a,c,b){if(b)if(c&&c.length)if(l.includes(b,"*"))for(b=0;b<c.length;b++)a.add(c[b].name);else for(var e=0;e<b.length;e++)d=b[e],p(a,c,d);else if(l.includes(b,"*"))a.clear(),a.add("*");else for(c=0;c<b.length;c++){var d=b[c];
a.add(d)}}function p(a,c,b){c&&c.length?(c=q(c,b))&&a.add(c.name):"string"===typeof b&&a.add(b)}function q(a,c){if("string"!==typeof c)return null;if(null!=a){c=c.toLowerCase();for(var b=0;b<a.length;b++){var e=a[b];if(e&&e.name.toLowerCase()===c)return e}}return null}function u(a,c,d){return b.__awaiter(this,void 0,void 0,function(){var f,g,n,q,h;return b.__generator(this,function(b){switch(b.label){case 0:return d?[4,e.loadArcade()]:[2];case 1:f=b.sent().arcadeUtils;g=f.extractFieldNames(d);n=0;
for(q=g;n<q.length;n++)h=q[n],p(a,c,h);return[2]}})})}function y(a,c){for(var b=0;b<a.length;b++){var e=a[b];if(e&&e.valueType&&e.valueType===c)return e.name}return null}function w(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d;return b.__generator(this,function(b){if(!c)return[2];e=c.fields;return(d=g.getDeepValue("elevationInfo.featureExpressionInfo",c))?[2,d.collectRequiredFields(a,e)]:[2]})})}function B(a,c,e){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,
function(b){e.outStatistic.onStatisticValueExpression?u(a,c,e.outStatistic.onStatisticValueExpression):a.add(e.outStatistic.onStatisticField);return[2]})})}function z(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,f;return b.__generator(this,function(b){switch(b.label){case 0:return e=c.labelingInfo,f=c.fields,e&&e.length?[4,d.all(e.map(function(c){return A(a,f,c)}))]:[2];case 1:return b.sent(),[2]}})})}function A(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d,f,g,n,q;
return b.__generator(this,function(b){switch(b.label){case 0:if(!e)return[2];d=e.getLabelExpression();f=e.where;return"arcade"!==d.type?[3,2]:[4,u(a,c,d.expression)];case 1:return b.sent(),[3,3];case 2:(g=d.expression.match(/{[^}]*}/g))&&g.forEach(function(b){p(a,c,b.slice(1,-1))}),b.label=3;case 3:return n=/['"]+/g,f&&(q=f.split(" "),3===q.length&&p(a,c,q[0].replace(n,"")),7===q.length&&(p(a,c,q[0].replace(n,"")),p(a,c,q[4].replace(n,"")))),[2]}})})}function C(a){return"number"===typeof a&&!isNaN(a)&&
isFinite(a)}function E(a){return null===a||C(a)}function D(a){return null===a||W(a)}function F(a){return null!=a&&"string"===typeof a}function H(a){return null===a||F(a)}function I(){return!0}function G(a,c){var b;switch(a.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":b=a.nullable?D:W;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":b=
a.nullable?E:C;break;case "string":case "esriFieldTypeString":b=a.nullable?H:F;break;default:b=I}return 1===arguments.length?b:b(c)}function K(a){return null!=a&&Q.has(a.type)}function L(a,b){return a.nullable&&null===b?null:K(a)&&!O(a.type,Number(b))?V.OUT_OF_RANGE:G(a,b)?a.domain?c.validateDomainValue(a.domain,b):null:R.INVALID_TYPE}function O(a,c){return(a="string"===typeof a?P(a):a)?a.isInteger?W(c)&&c>=a.min&&c<=a.max:c>=a.min&&c<=a.max:!1}function P(c){switch(c){case "esriFieldTypeSmallInteger":case "small-integer":return a.smallIntegerRange;
case "esriFieldTypeInteger":case "integer":return a.integerRange;case "esriFieldTypeSingle":case "single":return a.singleRange;case "esriFieldTypeDouble":case "double":return a.doubleRange}}function N(a,c,b){if(!c||!c.attributes||!a){if(h.isSome(b))for(var e=0;e<a.length;e++)c=a[e],b.add(c);return!0}for(var e=c.attributes,d=!1,f=0;f<a.length;f++)if(c=a[f],!(c in e))if(d=!0,h.isSome(b))b.add(c);else break;return d}Object.defineProperty(a,"__esModule",{value:!0});a.getExpressionFields=a.populateMissingFields=
a.featureHasFields=a.validationErrorToString=a.doubleRange=a.singleRange=a.integerRange=a.smallIntegerRange=a.getNumericTypeForValue=a.getFieldRange=a.isNumberInRange=a.validateFieldValue=a.sanitizeNullFieldValue=a.TypeValidationError=a.NumericRangeValidationError=a.isValidFieldValue=a.isDateField=a.isStringField=a.isNumericField=a.numericTypes=a.isValueMatchingFieldType=a.getFieldDefaultValue=a.collectLabelingFields=a.getLabelingFields=a.getFeatureGeometryFields=a.getFeatureEditFields=a.getTimeFields=
a.collectFilterFields=a.collectFeatureReductionFields=a.collectElevationFields=a.getElevationFields=a.getDisplayFieldName=a.collectArcadeFieldNames=a.hasField=a.getField=a.packFields=a.unpackFieldNames=a.collectField=a.collectFields=a.fixFields=a.fixTimeInfoFields=a.fixRendererFields=a.visualVariableFields=a.rendererFields=void 0;a.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");
a.visualVariableFields=["field","normalizationField"];a.fixRendererFields=function(c,b){if(null!=c&&null!=b){var e=0;for(c=Array.isArray(c)?c:[c];e<c.length;e++){var d=c[e];n(a.rendererFields,d,b);if("visualVariables"in d&&d.visualVariables)for(var f=0,d=d.visualVariables;f<d.length;f++)n(a.visualVariableFields,d[f],b)}}};a.fixTimeInfoFields=function(a,c){if(null!=a&&null!=c)if("startField"in a){var b=q(c,a.startField);c=q(c,a.endField);a.startField=b&&b.name||null;a.endField=c&&c.name||null}else b=
q(c,a.startTimeField),c=q(c,a.endTimeField),a.startTimeField=b&&b.name||null,a.endTimeField=c&&c.name||null};var S=new Set;a.fixFields=t;a.collectFields=x;a.collectField=p;a.unpackFieldNames=function(a,c){return c&&a?l.includes(c,"*")?a.map(function(a){return a.name}):c:[]};a.packFields=function(a,c,b){void 0===b&&(b=1);if(!c||!a)return[];if(l.includes(c,"*"))return["*"];c=t(a,c);return c.length/a.length>=b?["*"]:c};a.getField=q;a.hasField=function(a,c){if(!a||!c||"string"!==typeof c)return!1;c=c.toLowerCase();
for(var b=0;b<a.length;b++){var e=a[b];if(e&&e.name.toLowerCase()===c)return!0}return!1};a.collectArcadeFieldNames=u;a.getDisplayFieldName=function(a){var c=a.displayField;a=a.fields;if(c)return c;if(!a||!a.length)return null;if(!(c=y(a,"name-or-title")||y(a,"unique-identifier")||y(a,"type-or-category")))a:{for(c=0;c<a.length;c++){var b=a[c];if(b&&b.name){var e=b.name.toLowerCase();if(-1<e.indexOf("name")||-1<e.indexOf("title")){c=b.name;break a}}}c=null}return c};a.getElevationFields=function(a){return b.__awaiter(this,
void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:if(!a)return[2,[]];c=new Set;return[4,w(c,a)];case 1:return b.sent(),[2,f.valuesOfSet(c).sort()]}})})};a.collectElevationFields=w;a.collectFeatureReductionFields=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){switch(b.label){case 0:return c&&e&&"cluster"===e.type&&e.fields?[4,d.all(e.fields.map(function(b){return B(a,c.fields,b)}))]:[2];case 1:return b.sent(),
[2]}})})};a.collectFilterFields=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d,f;return b.__generator(this,function(b){switch(b.label){case 0:if(!c||!e||!(e.where&&"1\x3d1"!==e.where||e.timeExtent))return[2];c.timeInfo&&e.timeExtent&&x(a,c.fields,[c.timeInfo.startField,c.timeInfo.endField]);return e.where?[4,new Promise(function(a,c){m(["../../core/sql/WhereClause"],a,c)})]:[3,2];case 1:d=b.sent();f=d.WhereClause.create(e.where,c.fieldsIndex);if(!f.isStandardized)throw new k("fieldUtils:collectFilterFields",
"Where clause is not standardized");x(a,c.fields,f.fieldNames);b.label=2;case 2:return[2]}})})};a.getTimeFields=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){return a?(c="timeInfo"in a&&a.timeInfo)?[2,t(a.fields,[a.trackIdField,c.startField,c.endField])]:[2,[]]:[2,[]]})})};a.getFeatureEditFields=function(a){if(!a)return[];var c="editFieldsInfo"in a&&a.editFieldsInfo;return c?t(a.fields,[c&&c.creatorField,c&&c.creationDateField,c&&c.editorField,
c&&c.editDateField]):[]};a.getFeatureGeometryFields=function(a){if(!a)return[];var c="geometryProperties"in a&&a.geometryProperties;return c?t(a.fields,[c&&c.shapeAreaFieldName,c&&c.shapeLengthFieldName]):[]};a.getLabelingFields=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:if(!a)return[2,[]];c=new Set;return[4,z(c,a)];case 1:return b.sent(),[2,f.valuesOfSet(c).sort()]}})})};a.collectLabelingFields=z;a.getFieldDefaultValue=
function(a){var c=a.defaultValue;if(void 0!==c&&G(a,c))return c;if(a.nullable)return null};var W=function(){return"isInteger"in Number?Number.isInteger:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}}();a.isValueMatchingFieldType=G;a.numericTypes=["integer","small-integer","single","double"];var Q=f.SetFromValues(b.__spreadArrays(a.numericTypes,["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));a.isNumericField=K;a.isStringField=
function(a){return null!=a&&("string"===a.type||"esriFieldTypeString"===a.type)};a.isDateField=function(a){return null!=a&&("date"===a.type||"esriFieldTypeDate"===a.type)};a.isValidFieldValue=function(a,c){return null===L(a,c)};var V;(V=a.NumericRangeValidationError||(a.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";var R;(R=a.TypeValidationError||(a.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";a.sanitizeNullFieldValue=function(a){return null==
a||"number"===typeof a&&isNaN(a)?null:a};a.validateFieldValue=L;a.isNumberInRange=O;a.getFieldRange=function(a){var b=c.getDomainRange(a.domain);if(b)return b;if(K(a))return P(a.type)};a.getNumericTypeForValue=function(c){if(!C(c))return null;if(W(c)){if(c>=a.smallIntegerRange.min&&c<=a.smallIntegerRange.max)return"esriFieldTypeSmallInteger";if(c>=a.integerRange.min&&c<=a.integerRange.max)return"esriFieldTypeInteger"}return c>=a.singleRange.min&&c<=a.singleRange.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};
a.smallIntegerRange={min:-32768,max:32767,isInteger:!0};a.integerRange={min:-2147483648,max:2147483647,isInteger:!0};a.singleRange={min:-3.4E38,max:1.2E38,isInteger:!1};a.doubleRange={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};a.validationErrorToString=function(a,b,e){switch(a){case c.DomainValidationError.INVALID_CODED_VALUE:return"Value "+e+" is not in the coded domain - field: "+b.name+", domain: "+JSON.stringify(b.domain);case c.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+
e+" is out of the range of valid values - field: "+b.name+", domain: "+JSON.stringify(b.domain);case R.INVALID_TYPE:return"Value "+e+" is not a valid value for the field type - field: "+b.name+", type: "+b.type+", nullable: "+b.nullable;case V.OUT_OF_RANGE:return a=P(b.type),"Value "+e+" is out of range for the number type - field: "+b.name+", type: "+b.type+", value range is "+a.min+" to "+a.max}};a.featureHasFields=function(a,c){return!N(a,c,null)};a.populateMissingFields=N;a.getExpressionFields=
function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,g,n;return b.__generator(this,function(b){switch(b.label){case 0:e=new Set,d=0,g=c,b.label=1;case 1:if(!(d<g.length))return[3,4];n=g[d];return[4,u(e,a.fields,n)];case 2:b.sent(),b.label=3;case 3:return d++,[3,1];case 4:return[2,f.valuesOfSet(e).sort()]}})})}})},"esri/layers/support/domains":function(){define("require exports ../../core/compilerUtils ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(m,
a,b,l,k,h,g){function d(a,b){switch(a.type){case "range":var c="range"in a?a.range[1]:a.maxValue;if(+b<("range"in a?a.range[0]:a.minValue)||+b>c)return f.VALUE_OUT_OF_RANGE;break;case "coded-value":case "codedValue":if(null==a.codedValues||a.codedValues.every(function(a){return null==a||a.code!==b}))return f.INVALID_CODED_VALUE}return null}Object.defineProperty(a,"__esModule",{value:!0});a.fromJSON=a.getDomainRange=a.types=a.validateDomainValue=a.isValidDomainValue=a.DomainValidationError=a.RangeDomain=
a.InheritedDomain=a.DomainBase=a.CodedValueDomain=void 0;a.CodedValueDomain=l;a.DomainBase=k;a.InheritedDomain=h;a.RangeDomain=g;var f;(function(a){a.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";a.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(f=a.DomainValidationError||(a.DomainValidationError={}));a.isValidDomainValue=function(a,b){return null===d(a,b)};a.validateDomainValue=d;a.types={key:"type",base:k,typeMap:{range:g,"coded-value":l,inherited:h}};a.getDomainRange=
function(a){if(a&&"range"===a.type)return{min:"range"in a?a.range[0]:a.minValue,max:"range"in a?a.range[1]:a.maxValue}};a.fromJSON=function(a){if(!a||!a.type)return null;switch(a.type){case "range":return g.fromJSON(a);case "codedValue":return l.fromJSON(a);case "inherited":return h.fromJSON(a);default:b.neverReached(a)}return null}})},"esri/layers/support/CodedValueDomain":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./CodedValue ./Domain".split(" "),
function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.codedValues=null;c.type="coded-value";return c}b.__extends(d,a);c=d;d.prototype.getName=function(a){var c=null;if(this.codedValues){var b=String(a);this.codedValues.some(function(a){String(a.code)===b&&(c=a.name);return!!c})}return c};d.prototype.clone=function(){return new c({codedValues:l.clone(this.codedValues),name:this.name})};var c;b.__decorate([k.property({type:[h.default],json:{write:!0}})],d.prototype,"codedValues",
void 0);b.__decorate([k.enumeration({codedValue:"coded-value"})],d.prototype,"type",void 0);return d=c=b.__decorate([k.subclass("esri.layers.support.CodedValueDomain")],d)}(g)})},"esri/layers/support/CodedValue":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.CodedValue=void 0;m=function(a){function g(b){b=a.call(this,b)||this;b.name=null;b.code=null;return b}b.__extends(g,
a);d=g;g.prototype.clone=function(){return new d({name:this.name,code:this.code})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"name",void 0);b.__decorate([k.property({type:[String,Number],json:{write:!0}})],g.prototype,"code",void 0);return g=d=b.__decorate([k.subclass("esri.layers.support.CodedValue")],g)}(l.JSONSupport);a.CodedValue=m;a.default=m})},"esri/layers/support/Domain":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(m,a,b,l,k,h){var g=new l.default({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(a){function d(c){c=a.call(this,c)||this;c.name=null;c.type=null;return c}b.__extends(d,a);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);b.__decorate([h.enumeration(g)],d.prototype,"type",void 0);return d=b.__decorate([h.subclass("esri.layers.support.Domain")],d)}(k.JSONSupport)})},"esri/layers/support/InheritedDomain":function(){define(["require",
"exports","tslib","../../core/accessorSupport/decorators","./Domain"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="inherited";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d};var d;b.__decorate([l.enumeration({inherited:"inherited"})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.layers.support.InheritedDomain")],g)}(k)})},"esri/layers/support/RangeDomain":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators",
"./Domain"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.maxValue=null;b.minValue=null;b.type="range";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};var d;b.__decorate([l.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(a,c){return c.range&&c.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},
target:"range",writer:function(a,c,b){c[b]=[this.minValue||0,a]}}}})],g.prototype,"maxValue",void 0);b.__decorate([l.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(a,c){return c.range&&c.range[0]}},write:{target:"range",writer:function(a,c,b){c[b]=[a,this.maxValue||0]}}}})],g.prototype,"minValue",void 0);b.__decorate([l.enumeration({range:"range"})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.layers.support.RangeDomain")],g)}(k)})},"esri/symbols/Symbol":function(){define("require exports tslib ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(m,a,b,l,k,h,g){var d=new k.default({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"}),f=0;return function(a){function c(c){c=a.call(this,c)||this;c.id="sym"+f++;c.type=null;return c}b.__extends(c,a);Object.defineProperty(c.prototype,
"color",{set:function(a){this._set("color",a)},enumerable:!1,configurable:!0});c.prototype.readColor=function(a){return a&&null!=a[0]?[a[0],a[1],a[2],a[3]/255]:a};c.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){return[2]})})};c.prototype.hash=function(){return JSON.stringify(this.toJSON())};c.prototype.clone=function(){};b.__decorate([g.property({type:d.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,
writer:d.write}}})],c.prototype,"type",void 0);b.__decorate([g.property({type:l,value:new l([0,0,0,1]),json:{write:{allowNull:!0}}})],c.prototype,"color",null);b.__decorate([g.reader("color")],c.prototype,"readColor",null);return c=b.__decorate([g.subclass("esri.symbols.Symbol")],c)}(h.JSONSupport)})},"esri/symbols/ExtrudeSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./support/Symbol3DMaterial".split(" "),function(m,
a,b,l,k,h,g,d){return function(a){function c(c){c=a.call(this,c)||this;c.type="extrude";c.size=1;c.material=null;c.castShadows=!0;c.edges=null;return c}b.__extends(c,a);e=c;c.prototype.clone=function(){return new e({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:l.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})};var e;b.__decorate([k.enumeration({Extrude:"extrude"},{readOnly:!0})],c.prototype,"type",void 0);b.__decorate([k.property({type:Number,
json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],c.prototype,"size",void 0);b.__decorate([k.property({type:d.default,json:{write:!0}})],c.prototype,"material",void 0);b.__decorate([k.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],c.prototype,"castShadows",void 0);b.__decorate([k.property(g.symbol3dEdgesProperty)],c.prototype,"edges",void 0);return c=e=b.__decorate([k.subclass("esri.symbols.ExtrudeSymbol3DLayer")],c)}(h)})},"esri/symbols/Symbol3DLayer":function(){define(["require",
"exports","tslib","../core/JSONSupport","../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.enabled=!0;b.type=null;return b}b.__extends(g,a);g.prototype.writeEnabled=function(a,b,c){a||(b[c]=a)};b.__decorate([k.property({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],g.prototype,"enabled",void 0);b.__decorate([k.writer("enabled")],g.prototype,"writeEnabled",null);b.__decorate([k.property({type:"icon object line path fill water extrude text".split(" "),
readOnly:!0})],g.prototype,"type",void 0);return g=b.__decorate([k.subclass("esri.symbols.Symbol3DLayer")],g)}(l.JSONSupport)})},"esri/symbols/edges/utils":function(){define(["require","exports","./Edges3D","./SketchEdges3D","./SolidEdges3D"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.symbol3dEdgesProperty=void 0;a.symbol3dEdgesProperty={types:{key:"type",base:b,typeMap:{solid:k,sketch:l}},json:{write:!0}}})},"esri/symbols/edges/Edges3D":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/lang ../../core/screenUtils ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),
function(m,a,b,l,k,h,g,d,f){return function(a){function c(c){c=a.call(this,c)||this;c.color=new l([0,0,0,1]);c.extensionLength=0;c.size=g.px2pt(1);return c}b.__extends(c,a);c.prototype.clone=function(){};c.prototype.cloneProperties=function(){return{color:h.clone(this.color),size:this.size,extensionLength:this.extensionLength}};b.__decorate([d.property({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],c.prototype,"type",void 0);b.__decorate([d.property(f.colorAndTransparencyProperty)],
c.prototype,"color",void 0);b.__decorate([d.property(b.__assign(b.__assign({},f.screenSizeProperty),{json:{write:{overridePolicy:function(a){return{enabled:!!a}}}}}))],c.prototype,"extensionLength",void 0);b.__decorate([d.property(f.screenSizeProperty)],c.prototype,"size",void 0);return c=b.__decorate([d.subclass("esri.symbols.edges.Edges3D")],c)}(k.JSONSupport)})},"esri/core/screenUtils":function(){define(["require","exports","./compilerUtils"],function(m,a,b){function l(a){return a?72*a/96:0}function k(a,
c){void 0===a&&(a=0);void 0===c&&(c=0);return{x:a,y:c}}function h(a,c){void 0===a&&(a=0);void 0===c&&(c=0);return[a,c]}function g(a,c){void 0===a&&(a=0);void 0===c&&(c=0);return{x:a,y:c}}function d(a,c){void 0===a&&(a=0);void 0===c&&(c=0);return[a,c]}function f(a,c){return c?(c[0]=a.x,c[1]=a.y,2<c.length&&(c[2]=0),c):[a.x,a.y]}function c(a){return k(a.x,a.y)}function e(a,c){a=(a instanceof HTMLElement?a:a.surface).getBoundingClientRect();return k(c.clientX-a.left,c.clientY-a.top)}Object.defineProperty(a,
"__esModule",{value:!0});a.isSupportedScreenPointEvent=a.createScreenPointFromSupportedEvent=a.createScreenPointFromNativeEvent=a.createScreenPointFromEvent=a.screenPointObjectToArray=a.screenPointArrayToObject=a.renderArrayToScreen=a.screenArrayToRender=a.renderToScreen=a.screenToRender=a.castScreenPointArray=a.castRenderScreenPointArray3=a.castRenderScreenPointArray=a.createRenderScreenPointArray3=a.createRenderScreenPointArray=a.createRenderScreenPoint=a.createScreenPointArray=a.createScreenPoint=
a.toPt=a.px2pt=a.pt2px=void 0;var n=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;a.pt2px=function(a){return a?a/72*96:0};a.px2pt=l;a.toPt=function(a){if("string"===typeof a){if(n.test(a)){var c=a.match(n),b=Number(c[1]),c=c[3]&&c[3].toLowerCase();a="-"===a.charAt(0);b="px"===c?l(b):b;return a?-b:b}console.warn("screenUtils.toPt: input not recognized!");return null}return a};a.createScreenPoint=k;a.createScreenPointArray=h;a.createRenderScreenPoint=g;a.createRenderScreenPointArray=d;a.createRenderScreenPointArray3=
function(a,c,b){void 0===a&&(a=0);void 0===c&&(c=0);void 0===b&&(b=0);return[a,c,b]};a.castRenderScreenPointArray=function(a){return a};a.castRenderScreenPointArray3=function(a){return a};a.castScreenPointArray=function(a){return a};a.screenToRender=function(a,c,b){var e,d;switch(a.type){case "2d":a=window.devicePixelRatio||1;e=c.x*a;d=c.y*a;break;case "3d":f(c,x),a.state.camera.screenToRender(x,t),e=t[0],d=t[1]}return b?(b.x=e,b.y=d,b):g(e,d)};a.renderToScreen=function(a,c,b){var e,d;switch(a.type){case "2d":a=
window.devicePixelRatio||1;e=c.x/a;d=c.y/a;break;case "3d":f(c,t),a.state.camera.renderToScreen(t,x),e=x[0],d=x[1]}return b?(b.x=e,b.y=d,b):k(e,d)};a.screenArrayToRender=function(a,c,b){var e,f;switch(a.type){case "2d":a=window.devicePixelRatio||1;e=c[0]*a;f=c[1]*a;break;case "3d":a.state.camera.screenToRender(c,t),e=t[0],f=t[1]}return b?(b[0]=e,b[1]=f,2<b.length&&(b[2]=0),b):d(e,f)};a.renderArrayToScreen=function(a,c,b){var e,d;switch(a.type){case "2d":a=window.devicePixelRatio||1;e=c[0]/a;d=c[0]/
a;break;case "3d":a.state.camera.renderToScreen(c,x),e=x[0],d=x[1]}return b?(b[0]=e,b[1]=d,b):h(e,d)};a.screenPointArrayToObject=function(a,c){return c?(c.x=a[0],c.y=a[1],c):{x:a[0],y:a[1]}};a.screenPointObjectToArray=f;a.createScreenPointFromEvent=c;a.createScreenPointFromNativeEvent=e;a.createScreenPointFromSupportedEvent=function(a,b){return b instanceof Event?e(a,b):c(b)};a.isSupportedScreenPointEvent=function(a){if(a instanceof Event)return!0;if("object"===typeof a&&"type"in a)switch(a=a.type,
a){case "click":case "double-click":case "pointer-down":case "pointer-drag":case "pointer-enter":case "pointer-leave":case "pointer-up":case "pointer-move":case "immediate-click":case "immediate-double-click":case "hold":case "drag":case "mouse-wheel":return!0;case "key-down":case "key-up":case "gamepad":case "focus":case "blur":break;default:b.neverReachedSilent(a)}return!1};var t=d(),x=h()})},"esri/symbols/support/materialUtils":function(){define("require exports ../../Color ../../core/screenUtils ../../core/accessorSupport/ensureType ../../webdoc/support/opacityUtils".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.stipplePatternProperty=a.screenSizeProperty=a.colorAndTransparencyProperty=void 0;a.colorAndTransparencyProperty={type:b,json:{type:[k.Integer],default:null,read:{source:["color","transparency"],reader:function(a,d){a=null!=d.transparency?h.transparencyToOpacity(d.transparency):1;return(d=d.color)&&Array.isArray(d)?new b([d[0]||0,d[1]||0,d[2]||0,a]):null}},write:{target:{color:{type:[k.Integer]},transparency:{type:k.Integer}},
writer:function(a,b){b.color=a.toJSON().slice(0,3);a=h.opacityToTransparency(a.a);0!==a&&(b.transparency=a)}}}};a.screenSizeProperty={type:Number,cast:l.toPt,json:{write:!0}};a.stipplePatternProperty={type:[Number],cast:function(a){return null!=a?a:Array.isArray(a)?a.map(l.toPt):null},json:{read:!1,write:!1}}})},"esri/webdoc/support/opacityUtils":function(){define(["require","exports","../../core/accessorSupport/ensureType"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.transparencyToOpacity=
a.opacityToTransparency=void 0;a.opacityToTransparency=function(a){a=b.ensureInteger(100*(1-a));return Math.max(0,Math.min(a,100))};a.transparencyToOpacity=function(a){return Math.max(0,Math.min(1-a/100,1))}})},"esri/symbols/edges/SketchEdges3D":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Edges3D"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="sketch";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d(this.cloneProperties())};
var d;b.__decorate([l.enumeration({sketch:"sketch"},{readOnly:!0})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.symbols.edges.SketchEdges3D")],g)}(k)})},"esri/symbols/edges/SolidEdges3D":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Edges3D"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="solid";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d(this.cloneProperties())};var d;
b.__decorate([l.enumeration({solid:"solid"},{readOnly:!0})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.symbols.support.SolidEdges3D")],g)}(k)})},"esri/symbols/support/Symbol3DMaterial":function(){define("require exports tslib ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators ./materialUtils".split(" "),function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.Symbol3DMaterial=void 0;m=function(a){function d(){var c=null!==a&&a.apply(this,
arguments)||this;c.color=null;return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({color:k.isSome(this.color)?this.color.clone():null})};var c;b.__decorate([h.property(g.colorAndTransparencyProperty)],d.prototype,"color",void 0);return d=c=b.__decorate([h.subclass("esri.symbols.support.Symbol3DMaterial")],d)}(l.JSONSupport);a.Symbol3DMaterial=m;a.default=m})},"esri/symbols/FillSymbol":function(){define("require exports tslib ../core/accessorSupport/decorators ./SimpleLineSymbol ./Symbol".split(" "),
function(m,a,b,l,k,h){return function(a){function d(b){b=a.call(this,b)||this;b.outline=null;b.type=null;return b}b.__extends(d,a);d.prototype.hash=function(){return this.type+"."+(this.outline&&this.outline.hash())};b.__decorate([l.property({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":k}},json:{default:null,write:!0}})],d.prototype,"outline",void 0);b.__decorate([l.property({type:["simple-fill","picture-fill"],readOnly:!0})],d.prototype,"type",void 0);return d=
b.__decorate([l.subclass("esri.symbols.FillSymbol")],d)}(h)})},"esri/symbols/SimpleLineSymbol":function(){define("require exports tslib ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./LineSymbol ./LineSymbolMarker".split(" "),function(m,a,b,l,k,h,g,d,f){var c=new l.default({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",
esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});return function(a){function e(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c.type="simple-line";c.style="solid";c.cap="round";c.join="round";c.marker=null;c.miterLimit=2;return c}b.__extends(e,a);d=e;e.prototype.normalizeCtorArgs=function(a,c,b,e,d,f){if(a&&"string"!==typeof a)return a;var g=
{};null!=a&&(g.style=a);null!=c&&(g.color=c);null!=b&&(g.width=h.toPt(b));null!=e&&(g.cap=e);null!=d&&(g.join=d);null!=f&&(g.miterLimit=h.toPt(f));return g};e.prototype.clone=function(){var a;return new d({color:k.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null===(a=this.marker)||void 0===a?void 0:a.clone()})};e.prototype.hash=function(){var c,b;return a.prototype.hash.call(this)+"."+(null===(c=this.color)||void 0===c?void 0:c.hash())+
"."+this.style+"."+this.cap+"."+this.join+"."+this.miterLimit+"."+(null===(b=this.marker)||void 0===b?void 0:b.hash())};var d;b.__decorate([g.enumeration({esriSLS:"simple-line"},{readOnly:!0})],e.prototype,"type",void 0);b.__decorate([g.property({type:c.apiValues,json:{read:c.read,write:c.write}})],e.prototype,"style",void 0);b.__decorate([g.property({type:["butt","round","square"],json:{write:{overridePolicy:function(a,c,b){return{enabled:"round"!==a&&(null==b||null==b.origin)}}}}})],e.prototype,
"cap",void 0);b.__decorate([g.property({type:["miter","round","bevel"],json:{write:{overridePolicy:function(a,c,b){return{enabled:"round"!==a&&(null==b||null==b.origin)}}}}})],e.prototype,"join",void 0);b.__decorate([g.property({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":f}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],e.prototype,"marker",void 0);b.__decorate([g.property({type:Number,json:{read:!1,write:!1}})],e.prototype,"miterLimit",void 0);return e=
d=b.__decorate([g.subclass("esri.symbols.SimpleLineSymbol")],e)}(d)})},"esri/symbols/LineSymbol":function(){define("require exports tslib ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),function(m,a,b,l,k,h){return function(a){function d(b){b=a.call(this,b)||this;b.type="simple-line";b.width=.75;return b}b.__extends(d,a);d.prototype.hash=function(){return this.type+"."+this.width};b.__decorate([k.enumeration({esriSLS:"simple-line"},{readOnly:!0})],d.prototype,"type",void 0);
b.__decorate([k.property({type:Number,cast:l.toPt,json:{write:!0}})],d.prototype,"width",void 0);return d=b.__decorate([k.subclass("esri.symbols.LineSymbol")],d)}(h)})},"esri/symbols/LineSymbolMarker":function(){define("require exports tslib ../Color ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.placement="begin-end";c.type="line-marker";c.style="arrow";return c}b.__extends(d,a);c=d;
d.prototype.writeStyle=function(a,c,b,d){c[b]="web-map"===(null===d||void 0===d?void 0:d.origin)?"arrow":a};Object.defineProperty(d.prototype,"color",{set:function(a){this._set("color",a)},enumerable:!1,configurable:!0});d.prototype.readColor=function(a){return a&&null!=a[0]?[a[0],a[1],a[2],a[3]/255]:a};d.prototype.writeColor=function(a,c,b,d){"web-map"!==(null===d||void 0===d?void 0:d.origin)&&(c[b]=a)};d.prototype.clone=function(){return new c({color:h.clone(this.color),placement:this.placement,
style:this.style})};d.prototype.hash=function(){var a;return this.placement+"."+(null===(a=this.color)||void 0===a?void 0:a.hash())+"."+this.style};var c;b.__decorate([g.property({type:["begin","end","begin-end"],json:{default:"begin-end",write:!0}})],d.prototype,"placement",void 0);b.__decorate([g.enumeration({"line-marker":"line-marker"},{readOnly:!0}),g.property({json:{origins:{"web-map":{write:!1}}}})],d.prototype,"type",void 0);b.__decorate([g.property({type:"arrow circle square diamond cross x".split(" ")})],
d.prototype,"style",void 0);b.__decorate([g.writer("style")],d.prototype,"writeStyle",null);b.__decorate([g.property({type:l,value:null,json:{write:{allowNull:!0}}})],d.prototype,"color",null);b.__decorate([g.reader("color")],d.prototype,"readColor",null);b.__decorate([g.writer("color")],d.prototype,"writeColor",null);return d=c=b.__decorate([g.subclass("esri.symbols.LineSymbolMarker")],d)}(k.JSONSupport)})},"esri/symbols/FillSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./patterns/StylePattern3D ./patterns/utils ./support/colors ./support/Symbol3DFillMaterial ./support/Symbol3DOutline".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){return function(a){function h(c){c=a.call(this,c)||this;c.type="fill";c.material=null;c.pattern=null;c.castShadows=!0;c.outline=null;c.edges=null;return c}b.__extends(h,a);p=h;h.prototype.clone=function(){return new p({edges:l.isSome(this.edges)?this.edges.clone():null,enabled:this.enabled,material:l.isSome(this.material)?this.material.clone():null,pattern:l.isSome(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:l.isSome(this.outline)?
this.outline.clone():null})};h.fromSimpleFillSymbol=function(a){return new p({material:{color:(a.color||c.transparentWhite).clone()},pattern:a.style&&"solid"!==a.style?new d({style:a.style}):null,outline:a.outline?new n.default({size:a.outline.width||0,color:(a.outline.color||c.white).clone()}):null})};var p;b.__decorate([k.enumeration({Fill:"fill"},{readOnly:!0})],h.prototype,"type",void 0);b.__decorate([k.property({type:e.default,json:{write:!0}})],h.prototype,"material",void 0);b.__decorate([k.property(f.symbol3dPatternProperty)],
h.prototype,"pattern",void 0);b.__decorate([k.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],h.prototype,"castShadows",void 0);b.__decorate([k.property({type:n.default,json:{write:!0}})],h.prototype,"outline",void 0);b.__decorate([k.property(g.symbol3dEdgesProperty)],h.prototype,"edges",void 0);return h=p=b.__decorate([k.subclass("esri.symbols.FillSymbol3DLayer")],h)}(h)})},"esri/symbols/patterns/StylePattern3D":function(){define("require exports tslib ../../core/accessorSupport/decorators ./Pattern3D ./styles".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.type="style";c.style="solid";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({style:this.style})};var f;b.__decorate([l.property({type:["style"]})],d.prototype,"type",void 0);b.__decorate([l.property({type:h,json:{read:!0,write:!0}})],d.prototype,"style",void 0);return d=f=b.__decorate([l.subclass("esri.symbols.patterns.StylePattern3D")],d)}(k)})},"esri/symbols/patterns/Pattern3D":function(){define(["require",
"exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){return a.call(this,b)||this}b.__extends(g,a);g.prototype.clone=function(){};b.__decorate([k.property({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],g.prototype,"type",void 0);return g=b.__decorate([k.subclass("esri.symbols.patterns.Pattern3D")],g)}(l.JSONSupport)})},"esri/symbols/patterns/styles":function(){define(["require","exports"],function(m,
a){return"backward-diagonal cross diagonal-cross forward-diagonal horizontal none solid vertical".split(" ")})},"esri/symbols/patterns/utils":function(){define(["require","exports","./Pattern3D","./StylePattern3D"],function(m,a,b,l){function k(a,b,d){if(!a)return a;switch(a.type){case "style":return b=new l,b.read(a,d),b}}Object.defineProperty(a,"__esModule",{value:!0});a.symbol3dPatternProperty=a.read=void 0;a.read=k;a.symbol3dPatternProperty={types:{key:"type",base:b,typeMap:{style:l}},json:{read:k,
write:!0}}})},"esri/symbols/support/colors":function(){define(["require","exports","../../Color"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.isBlack=a.transparentWhite=a.black=a.white=void 0;a.white=new b("white");a.black=new b("black");a.transparentWhite=new b([255,255,255,0]);a.isBlack=function(a){return 0===a.r&&0===a.g&&0===a.b}})},"esri/symbols/support/Symbol3DFillMaterial":function(){define("require exports tslib ../../core/maybe ../../core/accessorSupport/decorators ./Symbol3DMaterial".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.Symbol3DFillMaterial=void 0;m=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({color:l.isSome(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})};var f;b.__decorate([k.enumeration({multiply:"multiply",replace:"replace",tint:"tint"})],d.prototype,"colorMixMode",void 0);return d=f=b.__decorate([k.subclass("esri.symbols.support.Symbol3DFillMaterial")],
d)}(h.default);a.Symbol3DFillMaterial=m;a.default=m})},"esri/symbols/support/Symbol3DOutline":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./materialUtils".split(" "),function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.Symbol3DOutline=void 0;m=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.color=new l([0,0,0,1]);c.size=g.px2pt(1);c.stipplePattern=
null;c.stippleOffColor=null;return c}b.__extends(c,a);n=c;c.prototype.clone=function(){return new n({color:h.isSome(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})};var n;b.__decorate([d.property(f.colorAndTransparencyProperty)],c.prototype,"color",void 0);b.__decorate([d.property(f.screenSizeProperty)],c.prototype,"size",void 0);b.__decorate([d.property(f.stipplePatternProperty)],
c.prototype,"stipplePattern",void 0);b.__decorate([d.property({type:l})],c.prototype,"stippleOffColor",void 0);return c=n=b.__decorate([d.subclass("esri.symbols.support.Symbol3DOutline")],c)}(k.JSONSupport);a.Symbol3DOutline=m;a.default=m})},"esri/symbols/Font":function(){define("require exports tslib ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.decoration="none";c.family="sans-serif";
c.size=9;c.style="normal";c.weight="normal";return c}b.__extends(d,a);f=d;d.prototype.castSize=function(a){return k.toPt(a)};d.prototype.clone=function(){return new f({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})};d.prototype.hash=function(){return this.decoration+"."+this.family+"."+this.size+"."+this.style+"."+this.weight};var f;b.__decorate([h.property({type:["underline","line-through","none"],json:{default:"none",write:!0}})],d.prototype,"decoration",
void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"family",void 0);b.__decorate([h.property({type:Number,json:{write:{overridePolicy:function(a,b,d){return{enabled:!d||!d.textSymbol3D}}}}})],d.prototype,"size",void 0);b.__decorate([h.cast("size")],d.prototype,"castSize",null);b.__decorate([h.property({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],d.prototype,"style",void 0);b.__decorate([h.property({type:["normal","bold","bolder","lighter"],json:{default:"normal",
write:!0}})],d.prototype,"weight",void 0);return d=f=b.__decorate([h.subclass("esri.symbols.Font")],d)}(l.JSONSupport)})},"esri/symbols/IconSymbol3DLayer":function(){define("require exports tslib ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/IconSymbol3DLayerResource ./support/materialUtils ./support/Symbol3DAnchorPosition2D ./support/Symbol3DMaterial ./support/Symbol3DOutline".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,
n,t,x){function p(a){var c="width"in a?a.width:a.size,b="height"in a?a.height:a.size,e=q(a.xoffset);a=q(a.yoffset);return(e||a)&&c&&b?{x:-e/c,y:a/b}:null}function q(a){return isFinite(a)?a:0}var u=l.getLogger("esri.symbols.IconSymbol3DLayer"),y={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};return function(a){function d(c){c=a.call(this,c)||this;c.material=null;c.resource=null;c.type="icon";c.size=12;c.anchor="center";c.anchorPosition=void 0;c.outline=
void 0;return c}b.__extends(d,a);q=d;d.prototype.clone=function(){return new q({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:k.isSome(this.material)?this.material.clone():null,outline:k.isSome(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})};d.fromSimpleMarkerSymbol=function(a){var c=a.color||f.white,b=p(a),e=a.outline&&0<a.outline.width?{size:a.outline.width,color:(a.outline.color||
f.white).clone()}:null,d=q,g=a.size;a=a.style;var n=y[a];n?a=n:(u.warn(a+' cannot be mapped to Icon symbol. Fallback to "circle"'),a="circle");return new d({size:g,resource:{primitive:a},material:{color:c},outline:e,anchor:b?"relative":void 0,anchorPosition:b})};d.fromPictureMarkerSymbol=function(a){var c=!a.color||f.isBlack(a.color)?f.white:a.color,b=p(a);return new q({size:a.width<=a.height?a.height:a.width,resource:{href:a.url},material:{color:c.clone()},anchor:b?"relative":void 0,anchorPosition:b})};
d.fromCIMSymbol=function(a){return new q({resource:{href:h.makeData({mediaType:"application/json",data:JSON.stringify(a.data)})}})};var q;b.__decorate([g.property({type:t.default,json:{write:!0}})],d.prototype,"material",void 0);b.__decorate([g.property({type:c.default,json:{write:!0}})],d.prototype,"resource",void 0);b.__decorate([g.enumeration({Icon:"icon"},{readOnly:!0})],d.prototype,"type",void 0);b.__decorate([g.property(e.screenSizeProperty)],d.prototype,"size",void 0);b.__decorate([g.enumeration({center:"center",
left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),g.property({json:{default:"center"}})],d.prototype,"anchor",void 0);b.__decorate([g.property({type:n.Symbol3DAnchorPosition2D,json:{type:[Number],read:{reader:function(a){return new n.Symbol3DAnchorPosition2D({x:a[0],y:a[1]})}},write:{writer:function(a,c){c.anchorPosition=[a.x,a.y]},overridePolicy:function(){return{enabled:"relative"===
this.anchor}}}}})],d.prototype,"anchorPosition",void 0);b.__decorate([g.property({type:x.default,json:{write:!0}})],d.prototype,"outline",void 0);return d=q=b.__decorate([g.subclass("esri.symbols.IconSymbol3DLayer")],d)}(d)})},"esri/symbols/support/IconSymbol3DLayerResource":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/urlUtils ../../core/accessorSupport/decorators ../../support/persistableUrlUtils".split(" "),function(m,a,b,l,k,h,g,d){Object.defineProperty(a,
"__esModule",{value:!0});a.defaultPrimitive=a.IconSymbol3DLayerResource=void 0;var f=l.strict()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});m=function(a){function c(c){return a.call(this,c)||this}b.__extends(c,a);n=c;c.prototype.readHref=function(a,c,b){return a?d.fromJSON(a,b):c.dataURI};c.prototype.writeHref=function(a,c,b,e){a&&(h.isDataProtocol(a)?c.dataURI=a:(c.href=d.toJSON(a,e),h.isAbsolute(c.href)&&(c.href=h.normalize(c.href))))};c.prototype.clone=
function(){return new n({href:this.href,primitive:this.primitive})};var n;b.__decorate([g.property({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],c.prototype,"href",void 0);b.__decorate([g.reader("href")],c.prototype,"readHref",null);b.__decorate([g.writer("href",{href:{type:String},dataURI:{type:String}})],c.prototype,"writeHref",null);b.__decorate([g.enumeration(f)],c.prototype,"primitive",void 0);return c=n=b.__decorate([g.subclass("esri.symbols.support.IconSymbol3DLayerResource")],
c)}(k.JSONSupport);a.IconSymbol3DLayerResource=m;a.defaultPrimitive="circle";a.default=m})},"esri/symbols/support/Symbol3DAnchorPosition2D":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.Symbol3DAnchorPosition2D=void 0;m=function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.x=0;b.y=0;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({x:this.x,
y:this.y})};var d;b.__decorate([k.property({type:Number})],g.prototype,"x",void 0);b.__decorate([k.property({type:Number})],g.prototype,"y",void 0);return g=d=b.__decorate([k.subclass("esri.symbols.support.Symbol3DAnchorPosition2D")],g)}(l);a.Symbol3DAnchorPosition2D=m;a.default=m})},"esri/symbols/LabelSymbol3D":function(){define("require exports tslib ../core/Collection ../core/lang ../core/accessorSupport/decorators ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),
function(m,a,b,l,k,h,g,d,f,c){var e=l.ofType({base:null,key:"type",typeMap:{text:d}});return function(a){function g(c){c=a.call(this,c)||this;c.verticalOffset=null;c.callout=null;c.styleOrigin=null;c.symbolLayers=new e;c.type="label-3d";return c}b.__extends(g,a);n=g;g.prototype.supportsCallout=function(){return!0};g.prototype.hasVisibleCallout=function(){return f.hasVisibleCallout(this)};g.prototype.hasVisibleVerticalOffset=function(){return f.hasVisibleVerticalOffset(this)};g.prototype.clone=function(){return new n({styleOrigin:k.clone(this.styleOrigin),
symbolLayers:k.clone(this.symbolLayers),thumbnail:k.clone(this.thumbnail),callout:k.clone(this.callout),verticalOffset:k.clone(this.verticalOffset)})};g.fromTextSymbol=function(a){return new n({symbolLayers:[d.fromTextSymbol(a)]})};var n;b.__decorate([h.property({type:c.default,json:{write:!0}})],g.prototype,"verticalOffset",void 0);b.__decorate([h.property(f.calloutProperty)],g.prototype,"callout",void 0);b.__decorate([h.property({json:{read:!1,write:!1}})],g.prototype,"styleOrigin",void 0);b.__decorate([h.property({type:e})],
g.prototype,"symbolLayers",void 0);b.__decorate([h.enumeration({LabelSymbol3D:"label-3d"},{readOnly:!0})],g.prototype,"type",void 0);return g=n=b.__decorate([h.subclass("esri.symbols.LabelSymbol3D")],g)}(g)})},"esri/symbols/Symbol3D":function(){define("require exports tslib ../core/Collection ../core/collectionUtils ../core/Logger ../core/urlUtils ../core/Warning ../core/accessorSupport/decorators ../portal/Portal ../support/persistableUrlUtils ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./PathSymbol3DLayer ./Symbol ./Symbol3DLayer ./TextSymbol3DLayer ./WaterSymbol3DLayer ./support/StyleOrigin ./support/Thumbnail".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z,A,C){var E={icon:x,object:q,line:p,path:u,fill:t,extrude:n,text:B,water:z},D=l.ofType({base:w,key:"type",typeMap:E,errorContext:"symbol-layer"}),F=h.getLogger("esri.symbols.Symbol3D");return function(a){function n(c){c=a.call(this,c)||this;c.styleOrigin=null;c.thumbnail=null;c.type=null;var b=c.__accessor__&&c.__accessor__.metadatas&&c.__accessor__.metadatas.symbolLayers;c._set("symbolLayers",new (b&&b.type||l));return c}b.__extends(n,a);Object.defineProperty(n.prototype,
"color",{get:function(){return null},set:function(a){F.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")},enumerable:!1,configurable:!0});Object.defineProperty(n.prototype,"symbolLayers",{set:function(a){k.referenceSetter(a,this._get("symbolLayers"))},enumerable:!1,configurable:!0});n.prototype.readStyleOrigin=function(a,b,f){if(a.styleUrl&&a.name)return b=e.fromJSON(a.styleUrl,f),new A({styleUrl:b,name:a.name});if(a.styleName&&
a.name)return new A({portal:f&&f.portal||c.getDefault(),styleName:a.styleName,name:a.name});f&&f.messages&&f.messages.push(new d("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:f,definition:a}))};n.prototype.writeStyleOrigin=function(a,c,b,f){a.styleUrl&&a.name?(b=e.toJSON(a.styleUrl,f),g.isAbsolute(b)&&(b=g.normalize(b)),c.styleOrigin={styleUrl:b,name:a.name}):a.styleName&&a.name&&(a.portal&&f&&f.portal&&!g.hasSamePortal(a.portal.restUrl,
f.portal.restUrl)?f&&f.messages&&f.messages.push(new d("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):c.styleOrigin={styleName:a.styleName,name:a.name})};n.prototype.normalizeCtorArgs=function(a){return a instanceof w||a&&E[a.type]?{symbolLayers:[a]}:Array.isArray(a)?{symbolLayers:a}:a};b.__decorate([f.property({json:{read:!1,write:!1}})],n.prototype,"color",null);b.__decorate([f.property({type:D,
nonNullable:!0,json:{write:!0}}),f.cast(k.castForReferenceSetter)],n.prototype,"symbolLayers",null);b.__decorate([f.property({type:A})],n.prototype,"styleOrigin",void 0);b.__decorate([f.reader("styleOrigin")],n.prototype,"readStyleOrigin",null);b.__decorate([f.writer("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],n.prototype,"writeStyleOrigin",null);b.__decorate([f.property({type:C.default,json:{read:!1}})],n.prototype,
"thumbnail",void 0);b.__decorate([f.property({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],n.prototype,"type",void 0);return n=b.__decorate([f.subclass("esri.symbols.Symbol3D")],n)}(y)})},"esri/core/collectionUtils":function(){define(["require","exports","./Collection"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.castForReferenceSetter=a.referenceSetter=void 0;a.referenceSetter=function(a,k,h){void 0===h&&(h=b);k||(k=new h);if(k===a)return k;
k.removeAll();a&&(Array.isArray(a)||"items"in a&&Array.isArray(a.items))?k.addMany(a):a&&k.add(a);return k};a.castForReferenceSetter=function(a){return a}})},"esri/portal/Portal":function(){define("require exports tslib ../config ../intl ../kernel ../request ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../geometry/Extent ./PortalQueryParams ./PortalQueryResult ./PortalUser @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w){var B,z={PortalGroup:function(){return new Promise(function(a,c){m(["./PortalGroup"],a,c)})},PortalItem:function(){return new Promise(function(a,c){m(["./PortalItem"],a,c)})},PortalUser:function(){return new Promise(function(a,c){m(["./PortalUser"],a,c)})}};return function(a){function e(c){c=a.call(this,c)||this;c.access=null;c.allSSL=!1;c.authMode="auto";c.authorizedCrossOriginDomains=null;c.basemapGalleryGroupQuery=null;c.bingKey=null;c.canListApps=
!1;c.canListData=!1;c.canListPreProvisionedItems=!1;c.canProvisionDirectPurchase=!1;c.canSearchPublic=!0;c.canShareBingPublic=!1;c.canSharePublic=!1;c.canSignInArcGIS=!1;c.canSignInIDP=!1;c.colorSetsGroupQuery=null;c.commentsEnabled=!1;c.created=null;c.culture=null;c.customBaseUrl=null;c.defaultBasemap=null;c.defaultExtent=null;c.defaultVectorBasemap=null;c.description=null;c.eueiEnabled=null;c.featuredGroups=null;c.featuredItemsGroupQuery=null;c.galleryTemplatesGroupQuery=null;c.livingAtlasGroupQuery=
null;c.hasCategorySchema=!1;c.helperServices=null;c.homePageFeaturedContent=null;c.homePageFeaturedContentCount=null;c.httpPort=null;c.httpsPort=null;c.id=null;c.ipCntryCode=null;c.isPortal=!1;c.isReadOnly=!1;c.layerTemplatesGroupQuery=null;c.maxTokenExpirationMinutes=null;c.modified=null;c.name=null;c.portalHostname=null;c.portalMode=null;c.portalProperties=null;c.region=null;c.rotatorPanels=null;c.showHomePageDescription=!1;c.sourceJSON=null;c.supportsHostedServices=!1;c.symbolSetsGroupQuery=null;
c.templatesGroupQuery=null;c.units=null;c.url=l.portalUrl;c.urlKey=null;c.user=null;c.useStandardizedQuery=!1;c.useVectorBasemaps=!1;c.vectorBasemapGalleryGroupQuery=null;return c}b.__extends(e,a);f=e;e.prototype.normalizeCtorArgs=function(a){return"string"===typeof a?{url:a}:a};e.prototype.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)};e.prototype.readAuthorizedCrossOriginDomains=function(a){if(a)for(var c=
0;c<a.length;c++){var b=a[c];-1===l.request.trustedServers.indexOf(b)&&l.request.trustedServers.push(b)}return a};e.prototype.readDefaultBasemap=function(a){return a?(a=B.fromJSON(a),a.portalItem={portal:this},a):null};e.prototype.readDefaultVectorBasemap=function(a){return a?(a=B.fromJSON(a),a.portalItem={portal:this},a):null};Object.defineProperty(e.prototype,"extraQuery",{get:function(){var a=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!a?" AND orgid:"+this.id:null},enumerable:!1,
configurable:!0});Object.defineProperty(e.prototype,"isOrganization",{get:function(){return!!this.access},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"restUrl",{get:function(){var a=this.url;if(a)var c=a.indexOf("/sharing"),a=0<c?a.substring(0,c):this.url.replace(/\/+$/,""),a=a+"/sharing/rest";return a},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"thumbnailUrl",{get:function(){var a=this.restUrl,c=this.thumbnail;return a&&c?this._normalizeSSL(a+"/portals/self/resources/"+
c):null},enumerable:!1,configurable:!0});e.prototype.readUrlKey=function(a){return a?a.toLowerCase():a};e.prototype.readUser=function(a){var c=null;a&&(c=w.fromJSON(a),c.portal=this);return c};e.prototype.load=function(a){var c=this,b=(new Promise(function(a,c){m(["../Basemap"],a,c)})).then(function(c){t.throwIfAborted(a);B=c}).then(function(){return c.sourceJSON?c.sourceJSON:c._fetchSelf(c.authMode,!1,a)}).then(function(a){if(h.id){var b=h.id;c.credential=b.findCredential(c.restUrl);c.credential||
c.authMode!==f.AUTH_MODE_AUTO||(c._esriId_credentialCreateHandle=b.on("credential-create",function(){b.findCredential(c.restUrl)&&c._signIn()}))}c.sourceJSON=a;c.read(a)});this.addResolvingPromise(b);return t.resolve(this)};e.prototype.createClosestFacilityTask=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.load()];case 1:return b.sent(),a=this._getHelperServiceUrl("closestFacility"),[4,new Promise(function(a,
c){m(["../tasks/ClosestFacilityTask"],a,c)})];case 2:return c=b.sent(),[2,new c(a)]}})})};e.prototype.createElevationLayers=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.load()];case 1:return b.sent(),a=this._getHelperService("defaultElevationLayers"),[4,new Promise(function(a,c){m(["../layers/ElevationLayer"],a,c)})];case 2:return c=b.sent(),[2,a?a.map(function(a){return new c({id:a.id,url:a.url})}):
[]]}})})};e.prototype.createGeometryService=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.load()];case 1:return b.sent(),a=this._getHelperServiceUrl("geometry"),[4,new Promise(function(a,c){m(["../tasks/GeometryService"],a,c)})];case 2:return c=b.sent(),[2,new c({url:a})]}})})};e.prototype.createPrintTask=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,
this.load()];case 1:return b.sent(),a=this._getHelperServiceUrl("printTask"),[4,new Promise(function(a,c){m(["../tasks/PrintTask"],a,c)})];case 2:return c=b.sent(),[2,new c(a)]}})})};e.prototype.createRouteTask=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.load()];case 1:return b.sent(),a=this._getHelperServiceUrl("route"),[4,new Promise(function(a,c){m(["../tasks/RouteTask"],a,c)})];case 2:return c=b.sent(),
[2,new c(a)]}})})};e.prototype.createServiceAreaTask=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.load()];case 1:return b.sent(),a=this._getHelperServiceUrl("serviceArea"),[4,new Promise(function(a,c){m(["../tasks/ServiceAreaTask"],a,c)})];case 2:return c=b.sent(),[2,new c(a)]}})})};e.prototype.fetchBasemaps=function(a,c){var b=new u;b.query=a||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:
this.basemapGalleryGroupQuery);b.disableExtraQuery=!0;return this.queryGroups(b,c).then(function(a){b.num=100;b.query='type:"Web Map" -type:"Web Application"';return a.total?(a=a.results[0],b.sortField=a.sortField||"name",b.sortOrder=a.sortOrder||"desc",a.queryItems(b,c)):null}).then(function(a){return a&&a.total?a.results.filter(function(a){return"Web Map"===a.type}).map(function(a){return new B({portalItem:a})}):[]})};e.prototype.fetchCategorySchema=function(a){return this.hasCategorySchema?this._request(this.restUrl+
"/portals/self/categorySchema",a).then(function(a){return a.categorySchema}):t.isAborted(a)?t.reject(t.createAbortError()):t.resolve([])};e.prototype.fetchFeaturedGroups=function(a){var c=this.featuredGroups,b=new u;b.num=100;b.sortField="title";if(c&&c.length){for(var e=[],d=0;d<c.length;d++){var f=c[d];e.push('(title:"'+f.title+'" AND owner:'+f.owner+")")}b.query=e.join(" OR ");return this.queryGroups(b,a).then(function(a){return a.results})}return t.isAborted(a)?t.reject(t.createAbortError()):
t.resolve([])};e.prototype.fetchRegions=function(a){var c=this.user&&this.user.culture||this.culture||k.getLocale();return this._request(this.restUrl+"/portals/regions",b.__assign(b.__assign({},a),{query:{culture:c}}))};e.getDefault=function(){if(!f._default||f._default.destroyed)f._default=new f;return f._default};e.prototype.queryGroups=function(a,c){return this._queryPortal("/community/groups",a,"PortalGroup",c)};e.prototype.queryItems=function(a,c){return this._queryPortal("/search",a,"PortalItem",
c)};e.prototype.queryUsers=function(a,c){a.sortField||(a.sortField="username");return this._queryPortal("/community/users",a,"PortalUser",c)};e.prototype.toJSON=function(){throw new d("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};e.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");return new f({sourceJSON:a})};e.prototype._getHelperService=function(a){var c=this.helperServices&&this.helperServices[a];if(!c)throw new d("portal:service-not-found",
'The `helperServices` do not include an entry named "'+a+'"');return c};e.prototype._getHelperServiceUrl=function(a){var c=this._getHelperService(a);if(!c.url)throw new d("portal:service-url-not-found",'The `helperServices` entry "'+a+'" does not include a `url` value');return c.url};e.prototype._fetchSelf=function(a,c,e){void 0===a&&(a=this.authMode);void 0===c&&(c=!1);var d=this.restUrl+"/portals/self";a=b.__assign({authMode:a,query:{culture:k.getLocale().toLowerCase()}},e);"auto"===a.authMode&&
(a.authMode="no-prompt");c&&(a.query.default=!0);return this._request(d,a)};e.prototype._queryPortal=function(a,c,e,d){var g=this,n=p.ensureType(u,c),h=function(c){return g._request(g.restUrl+a,b.__assign(b.__assign({},n.toRequestOptions(g)),d)).then(function(a){var b=n.clone();b.start=a.nextStart;return new y({nextQueryParams:b,queryParams:n,total:a.total,results:f._resultsToTypedArray(c,{portal:g},a,d)})}).then(function(a){return t.all(a.results.map(function(c){return"function"===typeof c.when?
c.when():a})).then(function(){return a},function(c){t.throwIfAbortError(c);return a})})};return e&&z[e]?z[e]().then(function(a){t.throwIfAborted(d);return h(a)}):h()};e.prototype._signIn=function(){var a=this;if(this.authMode===f.AUTH_MODE_ANONYMOUS)return t.reject(new d("portal:invalid-auth-mode",'Current "authMode"\' is "'+this.authMode+'"'));if("failed"===this.loadStatus)return t.reject(this.loadError);var c=function(c){return t.resolve().then(function(){if("not-loaded"===a.loadStatus)return c||
(a.authMode="immediate"),a.load().then(function(){return null});if("loading"===a.loadStatus)return a.load().then(function(){if(a.credential)return null;a.credential=c;return a._fetchSelf("immediate")});if(a.user&&a.credential===c)return null;a.credential=c;return a._fetchSelf("immediate")}).then(function(c){c&&(a.sourceJSON=c,a.read(c))})};return h.id?h.id.getCredential(this.restUrl).then(function(a){return c(a)}):c(this.credential)};e.prototype._normalizeSSL=function(a){return a.replace(/^http:/i,
"https:").replace(":7080",":7443")};e.prototype._normalizeUrl=function(a){var c=this.credential&&this.credential.token;return this._normalizeSSL(c?a+(-1<a.indexOf("?")?"\x26":"?")+"token\x3d"+c:a)};e.prototype._requestToTypedArray=function(a,c,b){var e=this;return this._request(a,c).then(function(a){var c=f._resultsToTypedArray(b,{portal:e},a);return t.all(c.map(function(c){return"function"===typeof c.when?c.when():a})).then(function(){return c},function(){return c})})};e.prototype._request=function(a,
c){void 0===c&&(c={});var e=b.__assign({f:"json"},c.query),d=c.authMode,n=c.body,h=c.cacheBust,p=c.method,q=c.responseType;c={authMode:void 0===d?this.authMode===f.AUTH_MODE_ANONYMOUS?"anonymous":"auto":d,body:void 0===n?null:n,cacheBust:void 0===h?!1:h,method:void 0===p?"auto":p,query:e,responseType:void 0===q?"json":q,timeout:0,signal:c.signal};return g(this._normalizeSSL(a),c).then(function(a){return a.data})};e._resultsToTypedArray=function(a,b,e,d){if(e){var f=n.isSome(d)?d.signal:null;e=e.listings||
e.notifications||e.userInvitations||e.tags||e.items||e.groups||e.comments||e.provisions||e.results||e.relatedItems||e;if(a||b)e=e.map(function(e){e=c.mixin(a?a.fromJSON(e):e,b);"function"===typeof e.load&&e.load(f);return e})}else e=[];return e};var f;e.AUTH_MODE_ANONYMOUS="anonymous";e.AUTH_MODE_AUTO="auto";e.AUTH_MODE_IMMEDIATE="immediate";b.__decorate([x.property()],e.prototype,"access",void 0);b.__decorate([x.property()],e.prototype,"allSSL",void 0);b.__decorate([x.property()],e.prototype,"authMode",
void 0);b.__decorate([x.property()],e.prototype,"authorizedCrossOriginDomains",void 0);b.__decorate([x.reader("authorizedCrossOriginDomains")],e.prototype,"readAuthorizedCrossOriginDomains",null);b.__decorate([x.property()],e.prototype,"basemapGalleryGroupQuery",void 0);b.__decorate([x.property()],e.prototype,"bingKey",void 0);b.__decorate([x.property()],e.prototype,"canListApps",void 0);b.__decorate([x.property()],e.prototype,"canListData",void 0);b.__decorate([x.property()],e.prototype,"canListPreProvisionedItems",
void 0);b.__decorate([x.property()],e.prototype,"canProvisionDirectPurchase",void 0);b.__decorate([x.property()],e.prototype,"canSearchPublic",void 0);b.__decorate([x.property()],e.prototype,"canShareBingPublic",void 0);b.__decorate([x.property()],e.prototype,"canSharePublic",void 0);b.__decorate([x.property()],e.prototype,"canSignInArcGIS",void 0);b.__decorate([x.property()],e.prototype,"canSignInIDP",void 0);b.__decorate([x.property()],e.prototype,"colorSetsGroupQuery",void 0);b.__decorate([x.property()],
e.prototype,"commentsEnabled",void 0);b.__decorate([x.property({type:Date})],e.prototype,"created",void 0);b.__decorate([x.property()],e.prototype,"credential",void 0);b.__decorate([x.property()],e.prototype,"culture",void 0);b.__decorate([x.property()],e.prototype,"currentVersion",void 0);b.__decorate([x.property()],e.prototype,"customBaseUrl",void 0);b.__decorate([x.property()],e.prototype,"defaultBasemap",void 0);b.__decorate([x.reader("defaultBasemap")],e.prototype,"readDefaultBasemap",null);
b.__decorate([x.property({type:q})],e.prototype,"defaultExtent",void 0);b.__decorate([x.property()],e.prototype,"defaultVectorBasemap",void 0);b.__decorate([x.reader("defaultVectorBasemap")],e.prototype,"readDefaultVectorBasemap",null);b.__decorate([x.property()],e.prototype,"description",void 0);b.__decorate([x.property()],e.prototype,"eueiEnabled",void 0);b.__decorate([x.property({dependsOn:["user","id","canSearchPublic"],readOnly:!0})],e.prototype,"extraQuery",null);b.__decorate([x.property()],
e.prototype,"featuredGroups",void 0);b.__decorate([x.property()],e.prototype,"featuredItemsGroupQuery",void 0);b.__decorate([x.property()],e.prototype,"galleryTemplatesGroupQuery",void 0);b.__decorate([x.property()],e.prototype,"livingAtlasGroupQuery",void 0);b.__decorate([x.property()],e.prototype,"hasCategorySchema",void 0);b.__decorate([x.property()],e.prototype,"helpBase",void 0);b.__decorate([x.property()],e.prototype,"helperServices",void 0);b.__decorate([x.property()],e.prototype,"helpMap",
void 0);b.__decorate([x.property()],e.prototype,"homePageFeaturedContent",void 0);b.__decorate([x.property()],e.prototype,"homePageFeaturedContentCount",void 0);b.__decorate([x.property()],e.prototype,"httpPort",void 0);b.__decorate([x.property()],e.prototype,"httpsPort",void 0);b.__decorate([x.property()],e.prototype,"id",void 0);b.__decorate([x.property()],e.prototype,"ipCntryCode",void 0);b.__decorate([x.property({dependsOn:["access"],readOnly:!0})],e.prototype,"isOrganization",null);b.__decorate([x.property()],
e.prototype,"isPortal",void 0);b.__decorate([x.property()],e.prototype,"isReadOnly",void 0);b.__decorate([x.property()],e.prototype,"layerTemplatesGroupQuery",void 0);b.__decorate([x.property()],e.prototype,"maxTokenExpirationMinutes",void 0);b.__decorate([x.property({type:Date})],e.prototype,"modified",void 0);b.__decorate([x.property()],e.prototype,"name",void 0);b.__decorate([x.property()],e.prototype,"portalHostname",void 0);b.__decorate([x.property()],e.prototype,"portalMode",void 0);b.__decorate([x.property()],
e.prototype,"portalProperties",void 0);b.__decorate([x.property()],e.prototype,"region",void 0);b.__decorate([x.property({dependsOn:["url"],readOnly:!0})],e.prototype,"restUrl",null);b.__decorate([x.property()],e.prototype,"rotatorPanels",void 0);b.__decorate([x.property()],e.prototype,"showHomePageDescription",void 0);b.__decorate([x.property()],e.prototype,"sourceJSON",void 0);b.__decorate([x.property()],e.prototype,"staticImagesUrl",void 0);b.__decorate([x.property()],e.prototype,"stylesGroupQuery",
void 0);b.__decorate([x.property()],e.prototype,"supportsHostedServices",void 0);b.__decorate([x.property()],e.prototype,"symbolSetsGroupQuery",void 0);b.__decorate([x.property()],e.prototype,"templatesGroupQuery",void 0);b.__decorate([x.property()],e.prototype,"thumbnail",void 0);b.__decorate([x.property({dependsOn:["restUrl","thumbnail"],readOnly:!0})],e.prototype,"thumbnailUrl",null);b.__decorate([x.property()],e.prototype,"units",void 0);b.__decorate([x.property()],e.prototype,"url",void 0);b.__decorate([x.property()],
e.prototype,"urlKey",void 0);b.__decorate([x.reader("urlKey")],e.prototype,"readUrlKey",null);b.__decorate([x.property()],e.prototype,"user",void 0);b.__decorate([x.reader("user")],e.prototype,"readUser",null);b.__decorate([x.property()],e.prototype,"useStandardizedQuery",void 0);b.__decorate([x.property()],e.prototype,"useVectorBasemaps",void 0);b.__decorate([x.property()],e.prototype,"vectorBasemapGalleryGroupQuery",void 0);return e=f=b.__decorate([x.subclass("esri.portal.Portal")],e)}(f.JSONSupportMixin(e))})},
"esri/intl":function(){define("require exports ./intl/date ./intl/number ./intl/substitute ./intl/locale ./intl/messages".split(" "),function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"formatDate",{enumerable:!0,get:function(){return b.formatDate}});Object.defineProperty(a,"convertDateFormatToIntlOptions",{enumerable:!0,get:function(){return b.convertDateFormatToIntlOptions}});Object.defineProperty(a,"formatNumber",{enumerable:!0,get:function(){return l.formatNumber}});
Object.defineProperty(a,"convertNumberFormatToIntlOptions",{enumerable:!0,get:function(){return l.convertNumberFormatToIntlOptions}});Object.defineProperty(a,"substitute",{enumerable:!0,get:function(){return k.substitute}});Object.defineProperty(a,"getLocale",{enumerable:!0,get:function(){return h.getLocale}});Object.defineProperty(a,"setLocale",{enumerable:!0,get:function(){return h.setLocale}});Object.defineProperty(a,"onLocaleChange",{enumerable:!0,get:function(){return h.onLocaleChange}});Object.defineProperty(a,
"prefersRTL",{enumerable:!0,get:function(){return h.prefersRTL}});Object.defineProperty(a,"loadMessageBundle",{enumerable:!0,get:function(){return g.loadMessageBundle}});Object.defineProperty(a,"getKnownMessageBundleLocale",{enumerable:!0,get:function(){return g.getKnownMessageBundleLocale}})})},"esri/intl/date":function(){define("require exports tslib @dojo/framework/shim/WeakMap ../core/jsonMap ./locale".split(" "),function(m,a,b,l,k,h){function g(a){a=a||q;if(!p.has(a)){var c=h.getLocale(),c=x[h.getLocale()]||
c;p.set(a,new Intl.DateTimeFormat(c,a))}return p.get(a)}Object.defineProperty(a,"__esModule",{value:!0});a.formatDate=a.convertDateFormatToIntlOptions=a.getDateTimeFormatter=a.fromJSON=a.toJSON=a.dateFormats=a.dictionary=void 0;m={year:"numeric",month:"numeric",day:"numeric"};var d={year:"numeric",month:"long",day:"numeric"},f={year:"numeric",month:"short",day:"numeric"},c={year:"numeric",month:"long",weekday:"long",day:"numeric"},e={hour:"numeric",minute:"numeric"},n=b.__assign(b.__assign({},e),
{second:"numeric"}),t={"short-date":m,"short-date-short-time":b.__assign(b.__assign({},m),e),"short-date-short-time-24":b.__assign(b.__assign(b.__assign({},m),e),{hour12:!1}),"short-date-long-time":b.__assign(b.__assign({},m),n),"short-date-long-time-24":b.__assign(b.__assign(b.__assign({},m),n),{hour12:!1}),"short-date-le":m,"short-date-le-short-time":b.__assign(b.__assign({},m),e),"short-date-le-short-time-24":b.__assign(b.__assign(b.__assign({},m),e),{hour12:!1}),"short-date-le-long-time":b.__assign(b.__assign({},
m),n),"short-date-le-long-time-24":b.__assign(b.__assign(b.__assign({},m),n),{hour12:!1}),"long-month-day-year":d,"long-month-day-year-short-time":b.__assign(b.__assign({},d),e),"long-month-day-year-short-time-24":b.__assign(b.__assign(b.__assign({},d),e),{hour12:!1}),"long-month-day-year-long-time":b.__assign(b.__assign({},d),n),"long-month-day-year-long-time-24":b.__assign(b.__assign(b.__assign({},d),n),{hour12:!1}),"day-short-month-year":f,"day-short-month-year-short-time":b.__assign(b.__assign({},
f),e),"day-short-month-year-short-time-24":b.__assign(b.__assign(b.__assign({},f),e),{hour12:!1}),"day-short-month-year-long-time":b.__assign(b.__assign({},f),n),"day-short-month-year-long-time-24":b.__assign(b.__assign(b.__assign({},f),n),{hour12:!1}),"long-date":c,"long-date-short-time":b.__assign(b.__assign({},c),e),"long-date-short-time-24":b.__assign(b.__assign(b.__assign({},c),e),{hour12:!1}),"long-date-long-time":b.__assign(b.__assign({},c),n),"long-date-long-time-24":b.__assign(b.__assign(b.__assign({},
c),n),{hour12:!1}),"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":e,"long-time":n};a.dictionary=k.strict()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",
shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",
dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a.dateFormats=a.dictionary.apiValues;a.toJSON=a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);
var x={ar:"ar-u-nu-latn-ca-gregory"},p=new l.default,q=t["short-date-short-time"];h.beforeLocaleChange(function(){p=new l.default;q=t["short-date-short-time"]});a.getDateTimeFormatter=g;a.convertDateFormatToIntlOptions=function(a){return t[a]||null};a.formatDate=function(a,c){return g(c).format(a)}})},"@dojo/framework/shim/WeakMap":function(){(function(m){"object"===typeof module&&"object"===typeof module.exports?(m=m(require,exports),void 0!==m&&(module.exports=m)):"function"===typeof define&&define.amd&&
define("require exports tslib ./global ./iterator ../has/has ./Symbol".split(" "),m)})(function(m,a){Object.defineProperty(a,"__esModule",{value:!0});var b=m("tslib"),l=m("./global"),k=m("./iterator"),h=m("../has/has");m("./Symbol");a.WeakMap=l.default.WeakMap;if(!h.default("es6-weakmap")){var g={},d=function(){var a=Math.floor(Date.now()%1E8);return function(){return"__wm"+Math.floor(1E8*Math.random())+(a++ +"__")}}();a.WeakMap=function(){function a(a){this[Symbol.toStringTag]="WeakMap";this._name=
d();this._frozenEntries=[];if(a)if(k.isArrayLike(a))for(var c=0;c<a.length;c++){var f=a[c];this.set(f[0],f[1])}else try{for(c=b.__values(a),f=c.next();!f.done;f=c.next()){var g=b.__read(f.value,2);this.set(g[0],g[1])}}catch(q){h={error:q}}finally{try{f&&!f.done&&(p=c.return)&&p.call(c)}finally{if(h)throw h.error;}}var h,p}a.prototype._getFrozenEntryIndex=function(a){for(var c=0;c<this._frozenEntries.length;c++)if(this._frozenEntries[c].key===a)return c;return-1};a.prototype.delete=function(a){if(void 0===
a||null===a)return!1;var c=a[this._name];if(c&&c.key===a&&c.value!==g)return c.value=g,!0;a=this._getFrozenEntryIndex(a);return 0<=a?(this._frozenEntries.splice(a,1),!0):!1};a.prototype.get=function(a){if(void 0!==a&&null!==a){var c=a[this._name];if(c&&c.key===a&&c.value!==g)return c.value;a=this._getFrozenEntryIndex(a);if(0<=a)return this._frozenEntries[a].value}};a.prototype.has=function(a){if(void 0===a||null===a)return!1;var c=a[this._name];return c&&c.key===a&&c.value!==g||0<=this._getFrozenEntryIndex(a)?
!0:!1};a.prototype.set=function(a,b){if(!a||"object"!==typeof a&&"function"!==typeof a)throw new TypeError("Invalid value used as weak map key");var c=a[this._name];c&&c.key===a||(c=Object.create(null,{key:{value:a}}),Object.isFrozen(a)?this._frozenEntries.push(c):Object.defineProperty(a,this._name,{value:c}));c.value=b;return this};return a}()}a.default=a.WeakMap})},"esri/intl/locale":function(){define(["require","exports","tslib","../core/global"],function(m,a,b,l){function k(){var a,c;return null!==
(c=null!==x&&void 0!==x?x:null===(a=l.navigator)||void 0===a?void 0:a.language)&&void 0!==c?c:"en"}function h(){void 0===t&&(t=k());return t}function g(){var a=null!==n&&void 0!==n?n:k();t!==a&&(t=a,b.__spreadArrays(u).forEach(function(c){c.call(null,a)}),b.__spreadArrays(q).forEach(function(c){c.call(null,a)}))}var d,f,c,e;Object.defineProperty(a,"__esModule",{value:!0});var n=a.beforeLocaleChange=a.onLocaleChange=a.prefersRTL=a.setLocale=a.getLocale=a.getDefaultLocale=void 0,t=void 0,x=null!==(f=
null===(d=l.esriConfig)||void 0===d?void 0:d.locale)&&void 0!==f?f:null===(c=l.dojoConfig)||void 0===c?void 0:c.locale;a.getDefaultLocale=k;a.getLocale=h;a.setLocale=function(a){n=a?a:void 0;g()};var p={he:!0,ar:!0};a.prefersRTL=function(a){void 0===a&&(a=h());a=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(a);a=null===a||void 0===a?void 0:a[1].toLowerCase();return void 0!==a&&(p[a]||!1)};var q=[];a.onLocaleChange=function(a){q.push(a);return{remove:function(){q.splice(q.indexOf(a),1)}}};var u=[];a.beforeLocaleChange=
function(a){u.push(a);return{remove:function(){q.splice(u.indexOf(a),1)}}};null===(e=l.addEventListener)||void 0===e?void 0:e.call(l,"languagechange",g)})},"esri/intl/number":function(){define(["require","exports","@dojo/framework/shim/WeakMap","../core/maybe","./locale"],function(m,a,b,l,k){function h(a){var c=a||f;if(!d.has(c)){var b=k.getLocale(),b=g[k.getLocale()]||b;d.set(c,new Intl.NumberFormat(b,a))}return l.assumeNonNull(d.get(c))}Object.defineProperty(a,"__esModule",{value:!0});a.formatNumber=
a.convertNumberFormatToIntlOptions=a.getFormatter=void 0;var g={ar:"ar-u-nu-latn"},d=new b.default,f={};k.beforeLocaleChange(function(){d=new b.default;f={}});a.getFormatter=h;a.convertNumberFormatToIntlOptions=function(a){void 0===a&&(a={});var c={};null!=a.digitSeparator&&(c.useGrouping=a.digitSeparator);null!=a.places&&(c.minimumFractionDigits=c.maximumFractionDigits=a.places);return c};a.formatNumber=function(a,b){return h(b).format(a)}})},"esri/intl/substitute":function(){define("require exports ../core/Logger ../core/object ../core/string ./date ./number".split(" "),
function(m,a,b,l,k,h,g){function d(a){switch(typeof a){case "string":return a;case "number":return g.formatNumber(a);case "boolean":return""+a;default:return a instanceof Date?h.formatDate(a):""}}Object.defineProperty(a,"__esModule",{value:!0});a.substitute=void 0;var f=b.getLogger("esri.intl");a.substitute=function(a,b,n){void 0===n&&(n={});n=n.format;var c=void 0===n?{}:n;return k.replace(a,function(a){var e;var n,t=a.indexOf(":");-1===t?n=a.trim():(n=a.slice(0,t).trim(),e=a.slice(t+1).trim());
if(n)if(a=l.getDeepValue(n,b),null==a)e="";else if(n=c[e]||c[n])b:switch(n.type){case "date":e=h.formatDate(a,n.intlOptions);break b;case "number":e=g.formatNumber(a,n.intlOptions);break b;default:f.warn("missing format descriptor for key {key}"),e=d(a)}else if(e)b:switch(e.toLowerCase()){case "dateformat":e=h.formatDate(a);break b;case "numberformat":e=g.formatNumber(a);break b;default:f.warn("inline format is unsupported since 4.12: "+e),e=/^(dateformat|datestring)/i.test(e)?h.formatDate(a):/^numberformat/i.test(e)?
g.formatNumber(a):d(a)}else e=d(a);else e="";return e})}})},"esri/intl/messages":function(){define("require exports tslib ../assets ../core/Error ../core/maybe ../core/promiseUtils ../core/SetUtils ./locale @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h,g,d,f){function c(a){if(!t.test(a))return null;var c=t.exec(a);a=c[1];c=c[2];c=a+(c?"-"+c.toUpperCase():"");return x.has(c)?c:x.has(a)?a:null}function e(a){return b.__awaiter(this,void 0,void 0,function(){var e,d,g,h,p,q,t,l,u;return b.__generator(this,
function(b){switch(b.label){case 0:e=/^(.*)\/t9n\/(.*)$/g.exec(a);if(!e)throw new k("esri-intl:invalid-bundle",'Missing "t9n" folder in locale bundle path "'+a+'"');d=e[1]+"/t9n/";g=e[2];h=f.getLocale();p=c(h);q=""+d+g+".json";t=p?""+d+g+"_"+p+".json":q;b.label=1;case 1:return b.trys.push([1,3,,8]),[4,n(t)];case 2:return l=b.sent(),[3,8];case 3:u=b.sent();if(t===q)throw u;b.label=4;case 4:return b.trys.push([4,6,,7]),[4,n(q)];case 5:return l=b.sent(),[3,7];case 6:throw b.sent(),new k("esri-intl:unknown-bundle",
'Bundle "'+a+'" cannot be loaded',{error:u});case 7:return[3,8];case 8:return[2,l]}})})}function n(c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return h.isSome(a.test.fetchBundleAsset)?[2,a.test.fetchBundleAsset(c)]:[4,l.fetchAsset(c,{responseType:"json"})];case 1:return e=b.sent(),[2,e.data]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.test=a.getKnownMessageBundleLocale=a.loadMessageBundle=void 0;var t=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,
x=d.SetFromValues("ar bs ca cs da de el en es et fi fr he hi hr hu id it ja ko lt lv nb nl pl pt-BR pt-PT ro ru sl sr sv th tr uk vi zh-CN zh-HK zh-TW".split(" ")),p=new Map;f.beforeLocaleChange(function(){p.clear()});a.loadMessageBundle=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return p.has(a)||p.set(a,e(a)),c=p.get(a),[4,q.add(c)];case 1:return b.sent(),[2,c]}})})};a.getKnownMessageBundleLocale=c;var q=new (function(){function a(){this._numLoading=
0}a.prototype.waitForAll=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){switch(a.label){case 0:return this._dfd?[4,this._dfd.promise]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})};a.prototype.add=function(a){var c=this;this._increase();a.then(function(){return c._decrease()},function(){return c._decrease()});return this.waitForAll()};a.prototype._increase=function(){this._numLoading++;this._dfd||(this._dfd=g.createDeferred())};a.prototype._decrease=
function(){this._numLoading=Math.max(this._numLoading-1,0);this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)};return a}());a.test={cache:p}})},"esri/core/Loadable":function(){define("require exports tslib ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(m,a,b,l,k,h,g,d,f){var c=function(a){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];var e=a.apply(this,
c)||this;e._loadController=null;e.loadError=null;e.loadStatus="not-loaded";e._set("loadWarnings",[]);e.addResolvingPromise(h.create(function(a){var c=e.load.bind(e);e.load=function(b){var d=h.create(function(a,c){h.onAbortOrThrow(b,c);e.destroyed&&c(new l("load:instance-destroyed","Instance of '"+(e.declaredClass||e.constructor.name)+"' is already destroyed",{instance:e}));e._promiseProps.when(a,c)});if("not-loaded"===e.loadStatus){e._set("loadStatus","loading");var f=e._loadController=h.createAbortController();
c({signal:f.signal});h.onAbort(f.signal,function(){e._promiseProps.abort()})}a();return d}}));e.when(function(){e._set("loadStatus","loaded");e._loadController=null},function(a){e._set("loadStatus","failed");e._set("loadError",a);e._loadController=null});return e}b.__extends(c,a);Object.defineProperty(c.prototype,"loaded",{get:function(){return"loaded"===this.loadStatus},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"loadWarnings",{get:function(){return this._get("loadWarnings")},
enumerable:!1,configurable:!0});c.prototype.load=function(){return null};c.prototype.cancelLoad=function(){var a;if(this.isFulfilled())return this;this._set("loadError",new l("load:cancelled","Cancelled"));null===(a=this._loadController)||void 0===a?void 0:a.abort();return this};b.__decorate([d.property({readOnly:!0,dependsOn:["loadStatus"]})],c.prototype,"loaded",null);b.__decorate([d.property({readOnly:!0})],c.prototype,"loadError",void 0);b.__decorate([d.property()],c.prototype,"loadStatus",void 0);
b.__decorate([d.property({type:[g],readOnly:!0})],c.prototype,"loadWarnings",null);return c=b.__decorate([f.subclass("esri.core.Loadable")],c)}(a)};m=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);return c=b.__decorate([f.subclass("esri.core.Loadable")],c)}(c(k.EsriPromise));(function(a){a.LoadableMixin=c;a.isLoadable=function(a){return!(!a||!a.load)}})(m||(m={}));return m})},"esri/core/Promise":function(){define("require exports tslib ./Accessor ./maybe ./promiseUtils ./accessorSupport/decorators/subclass".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.EsriPromise=a.EsriPromiseMixin=void 0;var d=function(){function a(a){var c=this;this.instance=a;this._resolver=h.createDeferred();this._status=0;this._resolvingPromises=[];this._resolver.promise.then(function(){c._status=1;c._cleanUp()},function(){c._status=2;c._cleanUp()})}a.prototype.addResolvingPromise=function(a){this._resolvingPromises.push(a);this._tryResolve()};a.prototype.isResolved=function(){return 1===this._status};
a.prototype.isRejected=function(){return 2===this._status};a.prototype.isFulfilled=function(){return 0!==this._status};a.prototype.abort=function(){this._resolver.reject(h.createAbortError())};a.prototype.when=function(a,b){return this._resolver.promise.then(a,b)};a.prototype._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};a.prototype._tryResolve=function(){var a=this;if(!this.isFulfilled()){var e=h.createDeferred(),d=b.__spreadArrays(this._resolvingPromises,[k.assumeNonNull(e.promise)]),
f=this._allPromise=h.all(d);f.then(function(){a.isFulfilled()||a._allPromise!==f||a._resolver.resolve(a.instance)},function(c){a.isFulfilled()||a._allPromise!==f||h.isAbortError(c)||a._resolver.reject(c)});e.resolve()}};return a}();a.EsriPromiseMixin=function(a){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c._promiseProps=new d(c);c.addResolvingPromise(h.resolve());return c}b.__extends(c,a);c.prototype.isResolved=function(){return this._promiseProps.isResolved()};
c.prototype.isRejected=function(){return this._promiseProps.isRejected()};c.prototype.isFulfilled=function(){return this._promiseProps.isFulfilled()};c.prototype.when=function(a,c){var b=this;return h.create(function(a,c){b._promiseProps.when(a,c)}).then(a,c)};c.prototype.catch=function(a){return this.when(null,a)};c.prototype.addResolvingPromise=function(a){a&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in a?a.when():a)};return c=b.__decorate([g.subclass("esri.core.Promise")],
c)}(a)};m=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);return c=b.__decorate([g.subclass("esri.core.Promise")],c)}(a.EsriPromiseMixin(l));a.EsriPromise=m})},"esri/portal/PortalQueryParams":function(){define("require exports tslib ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(m,a,b,l,k,h,g,d,f,c){var e=new k.default({avgRating:"avg-rating",
numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});return function(a){function n(c){c=a.call(this,c)||this;c.categories=null;c.disableExtraQuery=!1;c.extent=null;c.num=10;c.query=null;c.sortField=null;c.start=1;return c}b.__extends(n,a);k=n;Object.defineProperty(n.prototype,"sortOrder",{get:function(){return this._get("sortOrder")||"asc"},set:function(a){"asc"!==a&&"desc"!==a||this._set("sortOrder",a)},enumerable:!1,configurable:!0});n.prototype.clone=function(){return new k({categories:this.categories?
h.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};n.prototype.toRequestOptions=function(a,d){var g;this.categories&&(g=this.categories.map(function(a){return Array.isArray(a)?JSON.stringify(a):a}));var n;if(this.extent){var h=c.project(this.extent,f.WGS84);h&&(n=h.xmin+","+h.ymin+","+h.xmax+","+h.ymax)}h=this.query;!this.disableExtraQuery&&
a.extraQuery&&(h="("+h+")"+a.extraQuery);a={categories:g,bbox:n,q:h,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(a.sortField=this.sortField.split(",").map(function(a){return e.toJSON(a.trim())}).join(","),a.sortOrder=this.sortOrder);return{query:b.__assign(b.__assign({},d),a)}};var k;b.__decorate([g.property()],n.prototype,"categories",void 0);b.__decorate([g.property()],n.prototype,"disableExtraQuery",void 0);b.__decorate([g.property({type:d})],n.prototype,"extent",
void 0);b.__decorate([g.property()],n.prototype,"num",void 0);b.__decorate([g.property()],n.prototype,"query",void 0);b.__decorate([g.property()],n.prototype,"sortField",void 0);b.__decorate([g.property()],n.prototype,"sortOrder",null);b.__decorate([g.property()],n.prototype,"start",void 0);return n=k=b.__decorate([g.subclass("esri.portal.PortalQueryParams")],n)}(l)})},"esri/portal/PortalQueryResult":function(){define(["require","exports","tslib","../core/Accessor","../core/accessorSupport/decorators"],
function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.nextQueryParams=null;b.queryParams=null;b.results=null;b.total=null;return b}b.__extends(g,a);b.__decorate([k.property()],g.prototype,"nextQueryParams",void 0);b.__decorate([k.property()],g.prototype,"queryParams",void 0);b.__decorate([k.property()],g.prototype,"results",void 0);b.__decorate([k.property()],g.prototype,"total",void 0);return g=b.__decorate([k.subclass("esri.portal.PortalQueryResult")],g)}(l)})},"esri/portal/PortalUser":function(){define("require exports tslib ../core/Error ../core/JSONSupport ../core/promiseUtils ../core/accessorSupport/decorators ./PortalFolder ./PortalGroup @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c.access=null;c.created=null;c.culture=null;c.description=null;c.email=null;c.fullName=null;c.modified=null;c.orgId=null;c.portal=null;c.preferredView=null;c.privileges=null;c.region=null;c.role=null;c.roleId=null;c.sourceJSON=null;c.units=null;c.username=null;c.userType=null;return c}b.__extends(c,a);n=c;Object.defineProperty(c.prototype,"thumbnailUrl",{get:function(){var a=
this.url,c=this.thumbnail;return a&&c?this.portal._normalizeUrl(a+"/info/"+c+"?f\x3djson"):null},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"userContentUrl",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/users/"+this.username:null},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/community/users/"+this.username:null},enumerable:!1,configurable:!0});c.prototype.addItem=
function(a){var c=this,b=a&&a.item,e=a&&a.data;a=a&&a.folder;var d={method:"post"};b&&(d.query=b.createPostQuery(),null!=e&&("string"===typeof e?d.query.text=e:"object"===typeof e&&(d.query.text=JSON.stringify(e))));e=this.userContentUrl;a&&(e+="/"+("string"===typeof a?a:a.id));return this.portal._request(e+"/addItem",d).then(function(a){b.id=a.id;b.portal=c.portal;return b.loaded?b.reload():b.load()})};c.prototype.deleteItem=function(a){var c=this.userContentUrl;a.ownerFolder&&(c+="/"+a.ownerFolder);
return this.portal._request(c+("/items/"+a.id+"/delete"),{method:"post"}).then(function(){a.id=null;a.portal=null})};c.prototype.deleteItems=function(a){var c=this.userContentUrl+"/deleteItems",b=a.map(function(a){return a.id});return b.length?(b={method:"post",query:{items:b.join(",")}},this.portal._request(c,b).then(function(){a.forEach(function(a){a.id=null;a.portal=null})})):h.resolve(void 0)};c.prototype.fetchFolders=function(){var a=this;return this.portal._request(this.userContentUrl,{query:{num:1}}).then(function(c){return c&&
c.folders?c.folders.map(function(c){c=d.fromJSON(c);c.portal=a.portal;return c}):[]})};c.prototype.fetchGroups=function(){var a=this;return this.portal._request(this.url).then(function(c){return c&&c.groups?c.groups.map(function(c){c=f.fromJSON(c);c.portal=a.portal;return c}):[]})};c.prototype.fetchItems=function(a){var c=this;a||(a={});var b=this.userContentUrl;a.folder&&(b+="/"+a.folder.id);var e;return(new Promise(function(a,c){m(["./PortalItem"],a,c)})).then(function(d){e=d;return c.portal._request(b,
{query:{folders:!1,num:a.num||10,start:a.start||1,sortField:a.sortField||"created",sortOrder:a.sortOrder||"asc"}})}).then(function(a){var b;return a&&a.items?(b=a.items.map(function(a){a=e.fromJSON(a);a.portal=c.portal;return a}),h.all(b.map(function(a){return a.load()})).catch(function(a){return a}).then(function(){return{items:b,nextStart:a.nextStart,total:a.total}})):{items:[],nextStart:-1,total:0}})};c.prototype.fetchTags=function(){return this.portal._request(this.url+"/tags").then(function(a){return a.tags})};
c.prototype.getThumbnailUrl=function(a){var c=this.thumbnailUrl;c&&a&&(c+="\x26w\x3d"+a);return c};c.prototype.queryFavorites=function(a){return this.favGroupId?(this._favGroup||(this._favGroup=new f({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(a)):h.reject(new l("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};c.prototype.toJSON=function(){throw new l("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};c.fromJSON=
function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");var c=new n;c.sourceJSON=a;c.read(a);return c};var n;b.__decorate([g.property()],c.prototype,"access",void 0);b.__decorate([g.property({type:Date})],c.prototype,"created",void 0);b.__decorate([g.property()],c.prototype,"culture",void 0);b.__decorate([g.property()],c.prototype,"description",void 0);b.__decorate([g.property()],c.prototype,"email",void 0);b.__decorate([g.property()],c.prototype,"favGroupId",
void 0);b.__decorate([g.property()],c.prototype,"fullName",void 0);b.__decorate([g.property({type:Date})],c.prototype,"modified",void 0);b.__decorate([g.property()],c.prototype,"orgId",void 0);b.__decorate([g.property()],c.prototype,"portal",void 0);b.__decorate([g.property()],c.prototype,"preferredView",void 0);b.__decorate([g.property()],c.prototype,"privileges",void 0);b.__decorate([g.property()],c.prototype,"region",void 0);b.__decorate([g.property()],c.prototype,"role",void 0);b.__decorate([g.property()],
c.prototype,"roleId",void 0);b.__decorate([g.property()],c.prototype,"sourceJSON",void 0);b.__decorate([g.property()],c.prototype,"thumbnail",void 0);b.__decorate([g.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],c.prototype,"thumbnailUrl",null);b.__decorate([g.property()],c.prototype,"units",void 0);b.__decorate([g.property({dependsOn:["portal.restUrl"],readOnly:!0})],c.prototype,"userContentUrl",null);b.__decorate([g.property({dependsOn:["portal.restUrl"],readOnly:!0})],
c.prototype,"url",null);b.__decorate([g.property()],c.prototype,"username",void 0);b.__decorate([g.property()],c.prototype,"userType",void 0);return c=n=b.__decorate([g.subclass("esri.portal.PortalUser")],c)}(k.JSONSupport)})},"esri/portal/PortalFolder":function(){define("require exports tslib ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h){return function(a){function d(b){b=a.call(this,b)||this;b.created=null;b.id=null;b.portal=null;b.title=
null;b.username=null;return b}b.__extends(d,a);Object.defineProperty(d.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/users/"+this.username+"/"+this.id:null},enumerable:!1,configurable:!0});d.prototype.toJSON=function(){throw new l("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};b.__decorate([h.property({type:Date})],d.prototype,"created",void 0);b.__decorate([h.property()],d.prototype,"id",void 0);b.__decorate([h.property()],d.prototype,
"portal",void 0);b.__decorate([h.property()],d.prototype,"title",void 0);b.__decorate([h.property({dependsOn:["portal.restUrl"],readOnly:!0})],d.prototype,"url",null);b.__decorate([h.property()],d.prototype,"username",void 0);return d=b.__decorate([h.subclass("esri.portal.PortalFolder")],d)}(k.JSONSupport)})},"esri/portal/PortalGroup":function(){define("require exports tslib ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./PortalQueryParams".split(" "),
function(m,a,b,l,k,h,g,d){return function(a){function c(c){c=a.call(this,c)||this;c.access=null;c.created=null;c.description=null;c.id=null;c.isInvitationOnly=!1;c.modified=null;c.owner=null;c.portal=null;c.snippet=null;c.sortField=null;c.sortOrder=null;c.tags=null;c.title=null;return c}b.__extends(c,a);Object.defineProperty(c.prototype,"thumbnailUrl",{get:function(){var a=this.url,c=this.thumbnail;return a&&c?this.portal._normalizeUrl(a+"/info/"+c+"?f\x3djson"):null},enumerable:!1,configurable:!0});
Object.defineProperty(c.prototype,"url",{get:function(){var a=this.get("portal.restUrl");return a?a+"/community/groups/"+this.id:null},enumerable:!1,configurable:!0});c.prototype.fetchCategorySchema=function(a){var c=this;return this.portal._request(this.url+"/categorySchema",a).then(function(b){b=b.categorySchema||[];return b.some(function(a){return"contentCategorySetsGroupQuery.LivingAtlas"===a.source})?c._fetchCategorySchemaSet("LivingAtlas",a):b})};c.prototype.fetchMembers=function(a){return this.portal._request(this.url+
"/users",a)};c.prototype.getThumbnailUrl=function(a){var c=this.thumbnailUrl;c&&a&&(c+="\x26w\x3d"+a);return c};c.prototype.toJSON=function(){throw new l("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};c.prototype.queryItems=function(a,c){a=g.ensureType(d,a);if(5<parseFloat(this.portal.currentVersion))return a=a||new d,this.portal._queryPortal("/content/groups/"+this.id+"/search",a,"PortalItem",c);a=a?a.clone():new d;a.query="group:"+this.id+(a.query?" "+a.query:"");
return this.portal.queryItems(a,c)};c.prototype._fetchCategorySchemaSet=function(a,c){var b=this;return this.portal._fetchSelf(this.portal.authMode,!0,c).then(function(a){if(a=a.contentCategorySetsGroupQuery){var e=new d;e.disableExtraQuery=!0;e.num=1;e.query=a;return b.portal.queryGroups(e,c)}throw new l("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(function(b){if(b.total){b=b.results[0];var e=new d;e.num=1;e.query='typekeywords:"'+a+'"';return b.queryItems(e,
c)}throw new l("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(function(a){return a.total?a.results[0].fetchData("json",c).then(function(a){return(a=a&&a.categorySchema)&&a.length?a:[]}):[]})};b.__decorate([h.property()],c.prototype,"access",void 0);b.__decorate([h.property({type:Date})],c.prototype,"created",void 0);b.__decorate([h.property()],c.prototype,"description",void 0);b.__decorate([h.property()],c.prototype,"id",void 0);b.__decorate([h.property()],
c.prototype,"isInvitationOnly",void 0);b.__decorate([h.property({type:Date})],c.prototype,"modified",void 0);b.__decorate([h.property()],c.prototype,"owner",void 0);b.__decorate([h.property()],c.prototype,"portal",void 0);b.__decorate([h.property()],c.prototype,"snippet",void 0);b.__decorate([h.property()],c.prototype,"sortField",void 0);b.__decorate([h.property()],c.prototype,"sortOrder",void 0);b.__decorate([h.property()],c.prototype,"tags",void 0);b.__decorate([h.property()],c.prototype,"thumbnail",
void 0);b.__decorate([h.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],c.prototype,"thumbnailUrl",null);b.__decorate([h.property()],c.prototype,"title",void 0);b.__decorate([h.property({dependsOn:["portal.restUrl"],readOnly:!0})],c.prototype,"url",null);return c=b.__decorate([h.subclass("esri.portal.PortalGroup")],c)}(k.JSONSupport)})},"esri/symbols/LineSymbol3DLayer":function(){define("require exports tslib ../Color ../core/maybe ../core/screenUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/materialUtils ./support/Symbol3DMaterial".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){return function(a){function d(c){c=a.call(this,c)||this;c.material=null;c.type="line";c.join="miter";c.cap="butt";c.size=h.px2pt(1);c.stipplePattern=null;c.stippleOffColor=null;return c}b.__extends(d,a);n=d;d.prototype.clone=function(){return new n({enabled:this.enabled,material:k.isSome(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?
this.stippleOffColor.clone():null})};d.fromSimpleLineSymbol=function(a){return new n({size:a.width||1,cap:a.cap||"butt",join:a.join||"miter",material:{color:(a.color||f.white).clone()}})};var n;b.__decorate([g.property({type:e.default,json:{write:!0}})],d.prototype,"material",void 0);b.__decorate([g.enumeration({Line:"line"},{readOnly:!0})],d.prototype,"type",void 0);b.__decorate([g.property({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],d.prototype,"join",void 0);b.__decorate([g.property({type:["butt",
"square","round"],json:{write:!0,default:"butt"}})],d.prototype,"cap",void 0);b.__decorate([g.property(c.screenSizeProperty)],d.prototype,"size",void 0);b.__decorate([g.property(c.stipplePatternProperty)],d.prototype,"stipplePattern",void 0);b.__decorate([g.property({type:l})],d.prototype,"stippleOffColor",void 0);return d=n=b.__decorate([g.subclass("esri.symbols.LineSymbol3DLayer")],d)}(d)})},"esri/symbols/ObjectSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/ObjectSymbol3DLayerResource ./support/Symbol3DAnchorPosition3D ./support/Symbol3DMaterial".split(" "),
function(m,a,b,l,k,h,g,d,f){return function(a){function c(c){c=a.call(this,c)||this;c.material=null;c.castShadows=!0;c.resource=null;c.type="object";c.width=void 0;c.height=void 0;c.depth=void 0;c.anchor=void 0;c.anchorPosition=void 0;c.heading=void 0;c.tilt=void 0;c.roll=void 0;return c}b.__extends(c,a);n=c;c.prototype.clone=function(){return new n({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,
enabled:this.enabled,height:this.height,material:l.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})};Object.defineProperty(c.prototype,"isPrimitive",{get:function(){return!this.resource||"string"!==typeof this.resource.href},enumerable:!1,configurable:!0});var n;b.__decorate([k.property({type:f.default,json:{write:!0}})],c.prototype,"material",void 0);b.__decorate([k.property({type:Boolean,nonNullable:!0,
json:{write:!0,default:!0}})],c.prototype,"castShadows",void 0);b.__decorate([k.property({type:g.default,json:{write:!0}})],c.prototype,"resource",void 0);b.__decorate([k.enumeration({Object:"object"},{readOnly:!0})],c.prototype,"type",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"width",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"height",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"depth",void 0);b.__decorate([k.enumeration({center:"center",
top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),k.property({json:{default:"origin"}})],c.prototype,"anchor",void 0);b.__decorate([k.property({type:d.Symbol3DAnchorPosition3D,json:{type:[Number],read:{reader:function(a){return new d.Symbol3DAnchorPosition3D({x:a[0],y:a[1],z:a[2]})}},write:{writer:function(a,c){c.anchorPosition=[a.x,a.y,a.z]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],c.prototype,"anchorPosition",void 0);b.__decorate([k.property({type:Number,
json:{write:!0}})],c.prototype,"heading",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"tilt",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],c.prototype,"roll",void 0);b.__decorate([k.property({readOnly:!0,dependsOn:["resource","resource.href"]})],c.prototype,"isPrimitive",null);return c=n=b.__decorate([k.subclass("esri.symbols.ObjectSymbol3DLayer")],c)}(h)})},"esri/symbols/support/ObjectSymbol3DLayerResource":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../support/persistableUrlUtils".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.defaultPrimitive=a.ObjectSymbol3DLayerResource=void 0;var d=l.strict()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});m=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);e=c;c.prototype.clone=function(){return new e({href:this.href,primitive:this.primitive})};var e;b.__decorate([h.property({type:String,
json:{read:g.read,write:g.write}})],c.prototype,"href",void 0);b.__decorate([h.enumeration(d)],c.prototype,"primitive",void 0);return c=e=b.__decorate([h.subclass("esri.symbols.support.ObjectSymbol3DLayerResource")],c)}(k.JSONSupport);a.ObjectSymbol3DLayerResource=m;a.defaultPrimitive="sphere";a.default=m})},"esri/symbols/support/Symbol3DAnchorPosition3D":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,
"__esModule",{value:!0});a.Symbol3DAnchorPosition3D=void 0;m=function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.x=0;b.y=0;b.z=0;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({x:this.x,y:this.y,z:this.z})};var d;b.__decorate([k.property({type:Number})],g.prototype,"x",void 0);b.__decorate([k.property({type:Number})],g.prototype,"y",void 0);b.__decorate([k.property({type:Number})],g.prototype,"z",void 0);return g=d=b.__decorate([k.subclass("esri.symbols.support.Symbol3DAnchorPosition3D")],
g)}(l);a.Symbol3DAnchorPosition3D=m;a.default=m})},"esri/symbols/PathSymbol3DLayer":function(){define("require exports tslib ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/Symbol3DMaterial".split(" "),function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.material=null;c.castShadows=!0;c.type="path";c.profile="circle";c.join="miter";c.cap="butt";c.width=void 0;c.height=void 0;c.anchor="center";c.profileRotation="all";return c}b.__extends(d,a);
c=d;Object.defineProperty(d.prototype,"size",{get:function(){if(this.width&&this.height){if(this.width===this.height)return this.width}else{if(this.width)return this.width;if(this.height)return this.height}},set:function(a){this.height=this.width=a},enumerable:!1,configurable:!0});d.prototype.readSize=function(a,c){return c.height||c.width?a:c.size};d.prototype.clone=function(){return new c({enabled:this.enabled,material:l.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,
size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})};var c;b.__decorate([k.property({type:g.default,json:{write:!0}})],d.prototype,"material",void 0);b.__decorate([k.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],d.prototype,"castShadows",void 0);b.__decorate([k.enumeration({Path:"path"},{readOnly:!0})],d.prototype,"type",void 0);b.__decorate([k.property({type:Number})],d.prototype,
"size",null);b.__decorate([k.reader("size")],d.prototype,"readSize",null);b.__decorate([k.property({type:["circle","quad"],json:{write:!0,default:"circle"}})],d.prototype,"profile",void 0);b.__decorate([k.property({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],d.prototype,"join",void 0);b.__decorate([k.property({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],d.prototype,"cap",void 0);b.__decorate([k.property({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},
size:{type:Number}}}}})],d.prototype,"width",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],d.prototype,"height",void 0);b.__decorate([k.property({type:["center","bottom","top"],json:{write:!0,default:"center"}})],d.prototype,"anchor",void 0);b.__decorate([k.property({type:["heading","all"],json:{write:!0,default:"all"}})],d.prototype,"profileRotation",void 0);return d=c=b.__decorate([k.subclass("esri.symbols.PathSymbol3DLayer")],d)}(h)})},"esri/symbols/TextSymbol3DLayer":function(){define("require exports tslib ../core/lang ../core/maybe ../core/accessorSupport/decorators ./Font ./Symbol3DLayer ./support/materialUtils ./support/Symbol3DHalo ./support/Symbol3DMaterial".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){return function(a){function d(c){c=a.call(this,c)||this;c._userSize=void 0;c.halo=null;c.material=null;c.text=void 0;c.type="text";return c}b.__extends(d,a);n=d;Object.defineProperty(d.prototype,"font",{get:function(){return this._get("font")||null},set:function(a){a&&this._userSize&&(a.size=this._userSize);this._set("font",a)},enumerable:!1,configurable:!0});d.prototype.writeFont=function(a,c,e,d){e=b.__assign(b.__assign({},d),{textSymbol3D:!0});c.font=a.write({},
e);delete c.font.size};Object.defineProperty(d.prototype,"size",{get:function(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9},set:function(a){this._userSize=a;this.font&&(this.font.size=this._userSize);this.notifyChange("size")},enumerable:!1,configurable:!0});d.prototype.clone=function(){return new n({enabled:this.enabled,font:this.font&&l.clone(this.font),halo:this.halo&&l.clone(this.halo),material:k.isSome(this.material)?this.material.clone():null,
size:this.size,text:this.text})};d.fromTextSymbol=function(a){var c;c=a.haloColor;var b=a.haloSize;c=c&&0<b?{color:l.clone(c),size:b}:null;b=a.font?a.font.clone():new g;return new n({size:b.size,font:b,halo:c,material:a.color?{color:a.color.clone()}:null,text:a.text})};var n;b.__decorate([h.property({type:g,json:{write:!0}})],d.prototype,"font",null);b.__decorate([h.writer("font")],d.prototype,"writeFont",null);b.__decorate([h.property({type:c.default,json:{write:!0}})],d.prototype,"halo",void 0);
b.__decorate([h.property({type:e.default,json:{write:!0}})],d.prototype,"material",void 0);b.__decorate([h.property(f.screenSizeProperty),h.property({dependsOn:["font.size"]})],d.prototype,"size",null);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"text",void 0);b.__decorate([h.enumeration({Text:"text"},{readOnly:!0})],d.prototype,"type",void 0);return d=n=b.__decorate([h.subclass("esri.symbols.TextSymbol3DLayer")],d)}(d)})},"esri/symbols/support/Symbol3DHalo":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.Symbol3DHalo=void 0;m=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.color=new l([0,0,0,1]);c.size=0;return c}b.__extends(c,a);e=c;c.prototype.clone=function(){return new e({color:h.clone(this.color),size:this.size})};var e;b.__decorate([g.property(d.colorAndTransparencyProperty)],c.prototype,"color",void 0);b.__decorate([g.property(d.screenSizeProperty)],c.prototype,"size",void 0);return c=e=b.__decorate([g.subclass("esri.symbols.support.Symbol3DHalo")],
c)}(k.JSONSupport);a.Symbol3DHalo=m;a.default=m})},"esri/symbols/WaterSymbol3DLayer":function(){define("require exports tslib ../Color ../core/lang ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Symbol3DLayer".split(" "),function(m,a,b,l,k,h,g,d){m=function(a){function c(c){c=a.call(this,c)||this;c.color=f.clone();c.type="water";c.waterbodySize="medium";c.waveDirection=null;c.waveStrength="moderate";return c}b.__extends(c,a);d=c;c.prototype.clone=function(){return new d({color:k.clone(this.color),
waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})};var d;b.__decorate([h.property({type:l,nonNullable:!0,json:{type:[g.Integer],write:function(a,c,b){return c[b]=a.toArray(1)},default:function(){return f.clone()},defaultEquals:function(a){return a.toCss(!0)===f.toCss(!0)}}})],c.prototype,"color",void 0);b.__decorate([h.enumeration({Water:"water"},{readOnly:!0})],c.prototype,"type",void 0);b.__decorate([h.property({type:["small","medium","large"],json:{write:!0,
default:"medium"}})],c.prototype,"waterbodySize",void 0);b.__decorate([h.property({type:Number,json:{write:!0,default:null}})],c.prototype,"waveDirection",void 0);b.__decorate([h.property({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],c.prototype,"waveStrength",void 0);return c=d=b.__decorate([h.subclass("esri.symbols.WaterSymbol3DLayer")],c)}(d);var f=new l([0,119,190]);return m})},"esri/symbols/support/StyleOrigin":function(){define("require exports tslib ../../core/Accessor ../../core/accessorSupport/decorators ../../portal/Portal".split(" "),
function(m,a,b,l,k,h){return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.portal=null;return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};var f;b.__decorate([k.property({type:String})],d.prototype,"name",void 0);b.__decorate([k.property({type:String})],d.prototype,"styleUrl",void 0);b.__decorate([k.property({type:String})],d.prototype,"styleName",void 0);b.__decorate([k.property({type:h})],
d.prototype,"portal",void 0);return d=f=b.__decorate([k.subclass("esri.symbols.support.StyleOrigin")],d)}(l)})},"esri/symbols/support/Thumbnail":function(){define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.Thumbnail=void 0;m=function(a){function g(){return null!==a&&a.apply(this,arguments)||this}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({url:this.url})};var d;
b.__decorate([k.property({type:String})],g.prototype,"url",void 0);return g=d=b.__decorate([k.subclass("esri.symbols.support.Thumbnail")],g)}(l);a.Thumbnail=m;a.default=m})},"esri/symbols/callouts/calloutUtils":function(){define(["require","exports","./Callout3D","./LineCallout3D"],function(m,a,b,l){function k(a){if(!a)return!1;a=a.verticalOffset;return!a||0>=a.screenLength||0>=a.maxWorldLength?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});a.calloutProperty=a.isCalloutSupport=a.hasVisibleCallout=
a.hasVisibleVerticalOffset=void 0;a.hasVisibleVerticalOffset=k;a.hasVisibleCallout=function(a){if(!a||!a.supportsCallout||!a.supportsCallout())return!1;var b=a.callout;return b&&b.visible?k(a)?!0:!1:!1};a.isCalloutSupport=function(a){return"point-3d"===a.type||"label-3d"===a.type};a.calloutProperty={types:{key:"type",base:b,typeMap:{line:l}},json:{write:!0}}})},"esri/symbols/callouts/Callout3D":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],
function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.visible=!0;return b}b.__extends(g,a);g.prototype.clone=function(){};b.__decorate([k.property({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],g.prototype,"type",void 0);b.__decorate([k.property({readOnly:!0})],g.prototype,"visible",void 0);return g=b.__decorate([k.subclass("esri.symbols.callouts.Callout3D")],g)}(l.JSONSupport)})},"esri/symbols/callouts/LineCallout3D":function(){define("require exports tslib ../../Color ../../core/lang ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./Callout3D ./LineCallout3DBorder ../support/materialUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){return function(a){function f(c){c=a.call(this,c)||this;c.type="line";c.color=new l([0,0,0,1]);c.size=g.px2pt(1);c.border=null;return c}b.__extends(f,a);n=f;Object.defineProperty(f.prototype,"visible",{get:function(){return 0<this.size&&h.isSome(this.color)&&0<this.color.a},enumerable:!1,configurable:!0});f.prototype.clone=function(){return new n({color:k.clone(this.color),size:this.size,border:k.clone(this.border)})};var n;b.__decorate([d.enumeration({line:"line"},
{readOnly:!0})],f.prototype,"type",void 0);b.__decorate([d.property(e.colorAndTransparencyProperty)],f.prototype,"color",void 0);b.__decorate([d.property(e.screenSizeProperty)],f.prototype,"size",void 0);b.__decorate([d.property({type:c.default,json:{write:!0}})],f.prototype,"border",void 0);b.__decorate([d.property({dependsOn:["size","color"],readOnly:!0})],f.prototype,"visible",null);return f=n=b.__decorate([d.subclass("esri.symbols.callouts.LineCallout3D")],f)}(f)})},"esri/symbols/callouts/LineCallout3DBorder":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),
function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.LineCallout3DBorder=void 0;m=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.color=new l("white");return c}b.__extends(c,a);e=c;c.prototype.clone=function(){return new e({color:h.clone(this.color)})};var e;b.__decorate([g.property(d.colorAndTransparencyProperty)],c.prototype,"color",void 0);return c=e=b.__decorate([g.subclass("esri.symbols.callouts.LineCallout3DBorder")],c)}(k.JSONSupport);a.LineCallout3DBorder=
m;a.default=m})},"esri/symbols/support/Symbol3DVerticalOffset":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ./materialUtils".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.Symbol3DVerticalOffset=void 0;m=function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.screenLength=0;c.minWorldLength=0;return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({screenLength:this.screenLength,
minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})};var f;b.__decorate([k.property(h.screenSizeProperty)],d.prototype,"screenLength",void 0);b.__decorate([k.property({type:Number,json:{write:!0,default:0}})],d.prototype,"minWorldLength",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],d.prototype,"maxWorldLength",void 0);return d=f=b.__decorate([k.subclass("esri.symbols.support.Symbol3DVerticalOffset")],d)}(l.JSONSupport);a.Symbol3DVerticalOffset=m;a.default=m})},
"esri/symbols/LineSymbol3D":function(){define("require exports tslib ../core/Collection ../core/lang ../core/accessorSupport/decorators ./LineSymbol3DLayer ./PathSymbol3DLayer ./Symbol3D".split(" "),function(m,a,b,l,k,h,g,d,f){var c=l.ofType({base:null,key:"type",typeMap:{line:g,path:d}}),e=l.ofType({base:null,key:"type",typeMap:{line:g,path:d}});return function(a){function d(b){b=a.call(this,b)||this;b.symbolLayers=new c;b.type="line-3d";return b}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({styleOrigin:k.clone(this.styleOrigin),
symbolLayers:k.clone(this.symbolLayers),thumbnail:k.clone(this.thumbnail)})};d.fromSimpleLineSymbol=function(a){return new f({symbolLayers:[g.fromSimpleLineSymbol(a)]})};var f;b.__decorate([h.property({type:c,json:{type:e}})],d.prototype,"symbolLayers",void 0);b.__decorate([h.enumeration({LineSymbol3D:"line-3d"},{readOnly:!0})],d.prototype,"type",void 0);return d=f=b.__decorate([h.subclass("esri.symbols.LineSymbol3D")],d)}(f)})},"esri/symbols/MarkerSymbol":function(){define("require exports tslib ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),
function(m,a,b,l,k,h){return function(a){function d(b){b=a.call(this,b)||this;b.angle=0;b.type=null;b.xoffset=0;b.yoffset=0;b.size=9;return b}b.__extends(d,a);d.prototype.hash=function(){return this.type+"."+this.angle+"."+this.size+"."+this.xoffset+"."+this.yoffset};b.__decorate([k.property({type:Number,json:{read:function(a){return a&&-1*a},write:function(a,c){return c.angle=a&&-1*a}}})],d.prototype,"angle",void 0);b.__decorate([k.property({type:["simple-marker","picture-marker"],readOnly:!0})],
d.prototype,"type",void 0);b.__decorate([k.property({type:Number,cast:l.toPt,json:{write:!0}})],d.prototype,"xoffset",void 0);b.__decorate([k.property({type:Number,cast:l.toPt,json:{write:!0}})],d.prototype,"yoffset",void 0);b.__decorate([k.property({type:Number,cast:function(a){return"auto"===a?a:l.toPt(a)},json:{write:!0}})],d.prototype,"size",void 0);return d=b.__decorate([k.subclass("esri.symbols.MarkerSymbol")],d)}(h)})},"esri/symbols/MeshSymbol3D":function(){define("require exports tslib ../core/Collection ../core/lang ../core/accessorSupport/decorators ./FillSymbol3DLayer ./Symbol3D".split(" "),
function(m,a,b,l,k,h,g,d){var f=l.ofType({base:null,key:"type",typeMap:{fill:g}});return function(a){function c(c){c=a.call(this,c)||this;c.symbolLayers=new f;c.type="mesh-3d";return c}b.__extends(c,a);d=c;c.prototype.clone=function(){return new d({styleOrigin:k.clone(this.styleOrigin),symbolLayers:k.clone(this.symbolLayers),thumbnail:k.clone(this.thumbnail)})};var d;b.__decorate([h.property({type:f})],c.prototype,"symbolLayers",void 0);b.__decorate([h.enumeration({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],
c.prototype,"type",void 0);return c=d=b.__decorate([h.subclass("esri.symbols.MeshSymbol3D")],c)}(d)})},"esri/symbols/PictureFillSymbol":function(){define("require exports tslib ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./FillSymbol ./support/urlUtils".split(" "),function(m,a,b,l,k,h,g,d){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c.type="picture-fill";c.url=null;c.xscale=1;c.yscale=1;c.width=12;c.height=
12;c.xoffset=0;c.yoffset=0;c.source=null;return c}b.__extends(c,a);e=c;c.prototype.normalizeCtorArgs=function(a,c,b,e){if(a&&"string"!==typeof a&&null==a.imageData)return a;var d={};a&&(d.url=a);c&&(d.outline=c);null!=b&&(d.width=k.toPt(b));null!=e&&(d.height=k.toPt(e));return d};c.prototype.clone=function(){var a=new e({color:l.clone(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,
yscale:this.yscale});a._set("source",l.clone(this.source));return a};c.prototype.hash=function(){return a.prototype.hash.call(this)+"."+this.color.hash()+"."+this.height+"."+this.url+"."+this.width+"."+this.xoffset+"."+this.xscale+"."+this.yoffset+"."+this.yscale};var e;b.__decorate([h.enumeration({esriPFS:"picture-fill"},{readOnly:!0})],c.prototype,"type",void 0);b.__decorate([h.property(d.urlPropertyDefinition)],c.prototype,"url",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],
c.prototype,"xscale",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],c.prototype,"yscale",void 0);b.__decorate([h.property({type:Number,cast:k.toPt,json:{write:!0}})],c.prototype,"width",void 0);b.__decorate([h.property({type:Number,cast:k.toPt,json:{write:!0}})],c.prototype,"height",void 0);b.__decorate([h.property({type:Number,cast:k.toPt,json:{write:!0}})],c.prototype,"xoffset",void 0);b.__decorate([h.property({type:Number,cast:k.toPt,json:{write:!0}})],c.prototype,"yoffset",void 0);
b.__decorate([h.property(d.sourcePropertyDefinition)],c.prototype,"source",void 0);return c=e=b.__decorate([h.subclass("esri.symbols.PictureFillSymbol")],c)}(g)})},"esri/symbols/support/urlUtils":function(){define(["require","exports","../../core/urlUtils","../../support/persistableUrlUtils"],function(m,a,b,l){function k(a,f,c){return f.imageData?b.makeData({mediaType:f.contentType||"image/png",isBase64:!0,data:f.imageData}):h(f.url,c)}function h(a,f){return!f||"service"!==f.origin&&"portal-item"!==
f.origin||!f.layer||"feature"!==f.layer.type&&"stream"!==f.layer.type||b.isAbsolute(a)||!f.layer.parsedUrl?l.fromJSON(a,f):b.join(f.layer.parsedUrl.path,"images",a)}function g(a,f,c,e){b.isDataProtocol(a)?(a=b.dataComponents(a),f.contentType=a.mediaType,f.imageData=a.data,c&&c.imageData===f.imageData&&c.url&&l.write(c.url,f,"url",e)):l.write(a,f,"url",e)}Object.defineProperty(a,"__esModule",{value:!0});a.sourcePropertyDefinition=a.urlPropertyDefinition=a.writeImageDataAndUrl=a.read=a.readImageDataOrUrl=
void 0;a.readImageDataOrUrl=k;a.read=h;a.writeImageDataAndUrl=g;a.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:k},write:{writer:function(a,b,c,e){g(a,b,this.source,e)}}}};a.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(a,b,c){a={};b.imageData&&(a.imageData=b.imageData);b.contentType&&(a.contentType=b.contentType);b.url&&(a.url=h(b.url,c));return a}}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("require exports tslib ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./support/urlUtils".split(" "),
function(m,a,b,l,k,h,g,d){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c.color=null;c.type="picture-marker";c.url=null;c.source=null;c.height=12;c.width=12;c.size=null;return c}b.__extends(c,a);e=c;c.prototype.normalizeCtorArgs=function(a,c,b){if(a&&"string"!==typeof a&&null==a.imageData)return a;var e={};a&&(e.url=a);null!=c&&(e.width=k.toPt(c));null!=b&&(e.height=k.toPt(b));return e};c.prototype.readHeight=function(a,c){return c.size||
a};c.prototype.readWidth=function(a,c){return c.size||a};c.prototype.clone=function(){var a=new e({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});a._set("source",l.clone(this.source));return a};c.prototype.hash=function(){return a.prototype.hash.call(this)+"."+this.height+"."+this.url+"."+this.width};var e;b.__decorate([h.property({json:{write:!1}})],c.prototype,"color",void 0);b.__decorate([h.enumeration({esriPMS:"picture-marker"},{readOnly:!0})],
c.prototype,"type",void 0);b.__decorate([h.property(d.urlPropertyDefinition)],c.prototype,"url",void 0);b.__decorate([h.property(d.sourcePropertyDefinition)],c.prototype,"source",void 0);b.__decorate([h.property({type:Number,cast:k.toPt,json:{write:!0}})],c.prototype,"height",void 0);b.__decorate([h.reader("height",["height","size"])],c.prototype,"readHeight",null);b.__decorate([h.property({type:Number,cast:k.toPt,json:{write:!0}})],c.prototype,"width",void 0);b.__decorate([h.property({json:{write:!1}})],
c.prototype,"size",void 0);return c=e=b.__decorate([h.subclass("esri.symbols.PictureMarkerSymbol")],c)}(g)})},"esri/symbols/PointSymbol3D":function(){define("require exports tslib ../core/Collection ../core/Error ../core/lang ../core/accessorSupport/decorators ./IconSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n,t){var x=l.ofType({base:null,key:"type",typeMap:{icon:d,object:f,
text:e}}),p=l.ofType({base:null,key:"type",typeMap:{icon:d,object:f}});return function(a){function c(c){c=a.call(this,c)||this;c.verticalOffset=null;c.callout=null;c.symbolLayers=new x;c.type="point-3d";return c}b.__extends(c,a);f=c;c.prototype.writeSymbolLayers=function(a,c,b,e){var d=a.filter(function(a){return"text"!==a.type});e&&e.messages&&d.length<a.length&&(a=a.find(function(a){return"text"===a.type}),e.messages.push(new k("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",
{symbolLayer:a})));c[b]=d.map(function(a){return a.write({},e)}).toArray()};c.prototype.supportsCallout=function(){if(1>(this.symbolLayers?this.symbolLayers.length:0))return!1;for(var a=0,c=this.symbolLayers.items;a<c.length;a++)switch(c[a].type){case "icon":case "text":case "object":continue;default:return!1}return!0};c.prototype.hasVisibleCallout=function(){return n.hasVisibleCallout(this)};c.prototype.hasVisibleVerticalOffset=function(){return n.hasVisibleVerticalOffset(this)};c.prototype.clone=
function(){return new f({verticalOffset:h.clone(this.verticalOffset),callout:h.clone(this.callout),styleOrigin:h.clone(this.styleOrigin),symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail)})};c.fromSimpleMarkerSymbol=function(a){return new f({symbolLayers:[d.fromSimpleMarkerSymbol(a)]})};c.fromPictureMarkerSymbol=function(a){return new f({symbolLayers:[d.fromPictureMarkerSymbol(a)]})};c.fromCIMSymbol=function(a){return new f({symbolLayers:[d.fromCIMSymbol(a)],callout:{type:"line",
size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})};c.fromTextSymbol=function(a){return new f({symbolLayers:[e.fromTextSymbol(a)]})};var f;b.__decorate([g.property({type:t.default,json:{write:!0}})],c.prototype,"verticalOffset",void 0);b.__decorate([g.property(n.calloutProperty)],c.prototype,"callout",void 0);b.__decorate([g.property({type:x,json:{type:p,origins:{"web-scene":{type:p}}}})],c.prototype,"symbolLayers",void 0);b.__decorate([g.writer("web-scene","symbolLayers")],c.prototype,"writeSymbolLayers",
null);b.__decorate([g.enumeration({PointSymbol3D:"point-3d"},{readOnly:!0})],c.prototype,"type",void 0);return c=f=b.__decorate([g.subclass("esri.symbols.PointSymbol3D")],c)}(c)})},"esri/symbols/PolygonSymbol3D":function(){define("require exports tslib ../core/Collection ../core/Error ../core/lang ../core/maybe ../core/accessorSupport/decorators ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./WaterSymbol3DLayer".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q){var u=l.ofType({base:null,key:"type",typeMap:{extrude:f,fill:c,icon:e,line:n,object:t,text:p,water:q}}),y=l.ofType({base:null,key:"type",typeMap:{extrude:f,fill:c,icon:e,line:n,object:t,water:q}});return function(a){function e(c){c=a.call(this,c)||this;c.type="polygon-3d";return c}b.__extends(e,a);f=e;e.prototype.writeSymbolLayers=function(a,c,b,e){var d=a.filter(function(a){return"text"!==a.type});e&&e.messages&&d.length<a.length&&(a=a.find(function(a){return"text"===
a.type}),e.messages.push(new k("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:a})));c[b]=d.map(function(a){return a.write({},e)}).toArray()};e.prototype.clone=function(){return new f({styleOrigin:h.clone(this.styleOrigin),symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail)})};e.fromJSON=function(a){var c=new f;c.read(a);if(2===c.symbolLayers.length&&"fill"===c.symbolLayers.getItemAt(0).type&&"line"===c.symbolLayers.getItemAt(1).type){var b=
c.symbolLayers.getItemAt(0),e=c.symbolLayers.getItemAt(1);!e.enabled||a.symbolLayers&&a.symbolLayers[1]&&!1===a.symbolLayers[1].enable||(b.outline={size:e.size,color:g.isSome(e.material)?e.material.color:null});c.symbolLayers.removeAt(1)}return c};e.fromSimpleFillSymbol=function(a){return new f({symbolLayers:[c.fromSimpleFillSymbol(a)]})};var f;b.__decorate([d.property({type:u,json:{type:y}})],e.prototype,"symbolLayers",void 0);b.__decorate([d.writer("web-scene","symbolLayers")],e.prototype,"writeSymbolLayers",
null);b.__decorate([d.enumeration({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],e.prototype,"type",void 0);return e=f=b.__decorate([d.subclass("esri.symbols.PolygonSymbol3D")],e)}(x)})},"esri/symbols/SimpleFillSymbol":function(){define("require exports tslib ../Color ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ./FillSymbol ./SimpleLineSymbol".split(" "),function(m,a,b,l,k,h,g,d,f){var c=new k.default({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",
esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});return function(a){function e(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c.color=new l([0,0,0,.25]);c.outline=new f;c.type="simple-fill";c.style="solid";return c}b.__extends(e,a);d=e;e.prototype.normalizeCtorArgs=function(a,c,b){if(a&&"string"!==typeof a)return a;var e={};a&&(e.style=a);c&&(e.outline=c);b&&(e.color=
b);return e};e.prototype.clone=function(){return new d({color:h.clone(this.color),outline:this.outline&&this.outline.clone(),style:this.style})};e.prototype.hash=function(){return""+a.prototype.hash.call(this)+this.style+"."+(this.color&&this.color.hash())};var d;b.__decorate([g.property()],e.prototype,"color",void 0);b.__decorate([g.property()],e.prototype,"outline",void 0);b.__decorate([g.enumeration({esriSFS:"simple-fill"},{readOnly:!0})],e.prototype,"type",void 0);b.__decorate([g.property({type:c.apiValues,
json:{read:c.read,write:c.write}})],e.prototype,"style",void 0);return e=d=b.__decorate([g.subclass("esri.symbols.SimpleFillSymbol")],e)}(d)})},"esri/symbols/SimpleMarkerSymbol":function(){define("require exports tslib ../Color ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(m,a,b,l,k,h,g,d,f,c){var e=new k.default({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",
esriSMSTriangle:"triangle",esriSMSPath:"path"});return function(a){function f(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];b=a.apply(this,b)||this;b.color=new l([255,255,255,.25]);b.type="simple-marker";b.size=12;b.style="circle";b.outline=new c;return b}b.__extends(f,a);n=f;f.prototype.normalizeCtorArgs=function(a,c,b,e){if(a&&"string"!==typeof a)return a;var d={};a&&(d.style=a);null!=c&&(d.size=g.toPt(c));b&&(d.outline=b);e&&(d.color=e);return d};f.prototype.writeColor=function(a,
c){a&&"x"!==this.style&&"cross"!==this.style&&(c.color=a.toJSON());null===a&&(c.color=null)};Object.defineProperty(f.prototype,"path",{set:function(a){this.style="path";this._set("path",a)},enumerable:!1,configurable:!0});f.prototype.clone=function(){return new n({angle:this.angle,color:h.clone(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})};f.prototype.hash=function(){var c;return a.prototype.hash.call(this)+
"."+(this.color&&this.color.hash())+"."+this.path+"."+this.style+"."+(null===(c=this.outline)||void 0===c?void 0:c.hash())};var n;b.__decorate([d.property()],f.prototype,"color",void 0);b.__decorate([d.writer("color")],f.prototype,"writeColor",null);b.__decorate([d.enumeration({esriSMS:"simple-marker"},{readOnly:!0})],f.prototype,"type",void 0);b.__decorate([d.property()],f.prototype,"size",void 0);b.__decorate([d.property({type:e.apiValues,json:{read:e.read,write:e.write}})],f.prototype,"style",
void 0);b.__decorate([d.property({type:String,json:{write:!0}})],f.prototype,"path",null);b.__decorate([d.property({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":c}},json:{default:null,write:!0}})],f.prototype,"outline",void 0);return f=n=b.__decorate([d.subclass("esri.symbols.SimpleMarkerSymbol")],f)}(f)})},"esri/symbols/TextSymbol":function(){define("require exports tslib ../Color ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./Font ./Symbol".split(" "),
function(m,a,b,l,k,h,g,d,f){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c.backgroundColor=null;c.borderLineColor=null;c.borderLineSize=null;c.font=new d;c.horizontalAlignment="center";c.kerning=!0;c.haloColor=null;c.haloSize=null;c.rightToLeft=null;c.rotated=!1;c.text="";c.type="text";c.verticalAlignment=null;c.xoffset=0;c.yoffset=0;c.angle=0;c.width=null;c.lineWidth=192;c.lineHeight=1;return c}b.__extends(c,a);f=c;c.prototype.normalizeCtorArgs=
function(a,c,b){if(a&&"string"!==typeof a)return a;var e={};a&&(e.text=a);c&&(e.font=c);b&&(e.color=b);return e};c.prototype.writeLineWidth=function(a,c,b,e){e&&"string"!==typeof e||(c[b]=a)};c.prototype.castLineWidth=function(a){return h.toPt(a)};c.prototype.writeLineHeight=function(a,c,b,e){e&&"string"!==typeof e||(c[b]=a)};c.prototype.clone=function(){return new f({angle:this.angle,backgroundColor:k.clone(this.backgroundColor),borderLineColor:k.clone(this.borderLineColor),borderLineSize:this.borderLineSize,
color:k.clone(this.color),font:this.font&&this.font.clone(),haloColor:k.clone(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})};c.prototype.hash=function(){return(this.backgroundColor&&this.backgroundColor.hash())+"."+this.borderLineColor+
"."+this.borderLineSize+"."+this.color.hash()+"."+(this.font&&this.font.hash())+"."+(this.haloColor&&this.haloColor.hash())+"."+this.haloSize+"."+this.horizontalAlignment+"."+this.kerning+"."+this.rightToLeft+"."+this.rotated+"."+this.text+"."+this.verticalAlignment+"."+this.width+"."+this.xoffset+"."+this.yoffset+"."+this.lineHeight+"."+this.lineWidth+"."+this.angle};var f;b.__decorate([g.property({type:l,json:{write:!0}})],c.prototype,"backgroundColor",void 0);b.__decorate([g.property({type:l,json:{write:!0}})],
c.prototype,"borderLineColor",void 0);b.__decorate([g.property({type:Number,json:{write:!0}})],c.prototype,"borderLineSize",void 0);b.__decorate([g.property({type:d,json:{write:!0}})],c.prototype,"font",void 0);b.__decorate([g.property({type:["left","right","center","justify"],json:{write:!0}})],c.prototype,"horizontalAlignment",void 0);b.__decorate([g.property({type:Boolean,json:{write:!0}})],c.prototype,"kerning",void 0);b.__decorate([g.property({type:l,json:{write:!0}})],c.prototype,"haloColor",
void 0);b.__decorate([g.property({type:Number,cast:h.toPt,json:{write:!0}})],c.prototype,"haloSize",void 0);b.__decorate([g.property({type:Boolean,json:{write:!0}})],c.prototype,"rightToLeft",void 0);b.__decorate([g.property({type:Boolean,json:{write:!0}})],c.prototype,"rotated",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"text",void 0);b.__decorate([g.enumeration({esriTS:"text"},{readOnly:!0})],c.prototype,"type",void 0);b.__decorate([g.property({type:["baseline",
"top","middle","bottom"],json:{write:!0}})],c.prototype,"verticalAlignment",void 0);b.__decorate([g.property({type:Number,cast:h.toPt,json:{write:!0}})],c.prototype,"xoffset",void 0);b.__decorate([g.property({type:Number,cast:h.toPt,json:{write:!0}})],c.prototype,"yoffset",void 0);b.__decorate([g.property({type:Number,json:{read:function(a){return a&&-1*a},write:function(a,c){return c.angle=a&&-1*a}}})],c.prototype,"angle",void 0);b.__decorate([g.property({type:Number,json:{write:!0}})],c.prototype,
"width",void 0);b.__decorate([g.property({type:Number})],c.prototype,"lineWidth",void 0);b.__decorate([g.writer("lineWidth")],c.prototype,"writeLineWidth",null);b.__decorate([g.cast("lineWidth")],c.prototype,"castLineWidth",null);b.__decorate([g.property({type:Number})],c.prototype,"lineHeight",void 0);b.__decorate([g.writer("lineHeight")],c.prototype,"writeLineHeight",null);return c=f=b.__decorate([g.subclass("esri.symbols.TextSymbol")],c)}(f)})},"esri/symbols/WebStyleSymbol":function(){define("require exports tslib ../core/Logger ../core/promiseUtils ../core/accessorSupport/decorators ../portal/Portal ../support/persistableUrlUtils ./Symbol ./support/Thumbnail @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c){function e(){return new Promise(function(a,c){m(["./support/styleUtils"],a,c)})}var n=l.getLogger("esri.symbols.WebStyleSymbol");return function(a){function f(c){c=a.call(this,c)||this;c.styleName=null;c.portal=null;c.styleUrl=null;c.thumbnail=null;c.name=null;c.type="web-style";return c}b.__extends(f,a);p=f;f.prototype.read=function(c,b){this.portal=b?b.portal:void 0;a.prototype.read.call(this,c,b)};f.prototype.clone=function(){return new p({name:this.name,styleUrl:this.styleUrl,
styleName:this.styleName,portal:this.portal})};f.prototype.fetchSymbol=function(a){return this._fetchSymbol("webRef",a)};f.prototype.fetchCIMSymbol=function(a){return this._fetchSymbol("cimRef",a)};f.prototype._fetchSymbol=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var d,f;return b.__generator(this,function(b){switch(b.label){case 0:return[4,e()];case 1:return d=b.sent(),k.throwIfAborted(c),f=d.resolveWebStyleSymbol(this,{portal:this.portal},a,c),f.catch(function(a){n.error("#fetchSymbol()",
"Failed to create symbol from style",a)}),[2,f]}})})};var p;b.__decorate([h.property({json:{write:!1}})],f.prototype,"color",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],f.prototype,"styleName",void 0);b.__decorate([h.property({type:g,json:{write:!1}})],f.prototype,"portal",void 0);b.__decorate([h.property({type:String,json:{read:d.read,write:d.write}})],f.prototype,"styleUrl",void 0);b.__decorate([h.property({type:c.default,json:{read:!1}})],f.prototype,"thumbnail",void 0);b.__decorate([h.property({type:String,
json:{write:!0}})],f.prototype,"name",void 0);b.__decorate([h.enumeration({styleSymbolReference:"web-style"},{readOnly:!0})],f.prototype,"type",void 0);return f=p=b.__decorate([h.subclass("esri.symbols.WebStyleSymbol")],f)}(f)})},"esri/symbols/support/jsonUtils":function(){define("require exports ../../symbols ../../core/Error ../Symbol3D ../WebStyleSymbol ./symbolConversion".split(" "),function(m,a,b,l,k,h,g){function d(a,c,b){if(!a)return null;if(!(!b||"web-scene"!==b.origin||a instanceof k||a instanceof
h)){var e="cim"!==a.type?g.to3D(a):{symbol:null,error:new l("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",{symbol:a})};if(e.symbol)return e.symbol.write(c,b);b.messages&&b.messages.push(new l("symbol:unsupported","Symbols of type '"+a.declaredClass+"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView",{symbol:a,context:b,error:e.error}));return null}return b&&"web-map"===b.origin&&"web-style"===a.type?(b.messages&&
b.messages.push(new l("symbol:unsupported","Symbols of type '"+a.declaredClass+"' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.",{symbol:a,context:b})),null):a.write(c,b)}Object.defineProperty(a,"__esModule",{value:!0});a.fromJSON=a.write=void 0;a.write=function(a,c,b,g){(a=d(a,{},g))&&(c[b]=a)};a.fromJSON=function(a,c){return b.readSymbol(a,null,c)}})},"esri/symbols/support/symbolConversion":function(){define(["require","exports","../../symbols","../../core/Error"],
function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.to3D=void 0;a.to3D=function(a,h,g,d){void 0===h&&(h=!1);void 0===g&&(g=!1);void 0===d&&(d=!0);if(!a)return{symbol:null};if(b.isSymbol3D(a)||a instanceof b.WebStyleSymbol)d=a.clone();else if("cim"===a.type)d=b.PointSymbol3D.fromCIMSymbol(a);else if(a instanceof b.SimpleLineSymbol)d=b.LineSymbol3D.fromSimpleLineSymbol(a);else if(a instanceof b.SimpleMarkerSymbol)d=b.PointSymbol3D.fromSimpleMarkerSymbol(a);else if(a instanceof b.PictureMarkerSymbol)d=
b.PointSymbol3D.fromPictureMarkerSymbol(a);else if(a instanceof b.SimpleFillSymbol)d=b.PolygonSymbol3D.fromSimpleFillSymbol(a);else if(a instanceof b.TextSymbol)d=d?b.LabelSymbol3D.fromTextSymbol(a):b.PointSymbol3D.fromTextSymbol(a);else return{error:new l("symbol-conversion:unsupported-2d-symbol","2D symbol of type '"+(a.type||a.declaredClass)+"' is unsupported in 3D",{symbol:a})};h&&(d.id=a.id);if(g&&b.isSymbol3D(d))for(a=0;a<d.symbolLayers.length;++a)d.symbolLayers.getItemAt(a)._ignoreDrivers=
!0;return{symbol:d}}})},"esri/layers/support/source/DataLayerSource":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../Field ./JoinTableDataSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),function(m,a,b,l,k,h,g,d,f,c,e){Object.defineProperty(a,"__esModule",{value:!0});a.DataLayerSource=void 0;var n={key:"type",base:null,typeMap:{"join-table":d.JoinTableDataSource,"query-table":f.QueryTableDataSource,
raster:c.RasterDataSource,table:e.TableDataSource}};m=function(a){function c(c){c=a.call(this,c)||this;c.type="data-layer";return c}b.__extends(c,a);e=c;c.prototype.clone=function(){return new e({fields:this.fields,dataSource:this.dataSource})};var e;b.__decorate([k.enumeration({dataLayer:"data-layer"})],c.prototype,"type",void 0);b.__decorate([k.property({type:[g],json:{write:!0}})],c.prototype,"fields",void 0);b.__decorate([k.property({types:n,json:{write:!0}})],c.prototype,"dataSource",void 0);
return c=e=b.__decorate([k.subclass("esri.layers.support.source.DataLayerSource")],c)}(l.JSONSupport);a.DataLayerSource=m;m.from=h.default(m)})},"esri/layers/support/Field":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./domains ./fieldType".split(" "),function(m,a,b,l,k,h,g,d,f){var c=new l.default({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",
description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});return function(a){function e(c){c=a.call(this,c)||this;c.alias=null;c.defaultValue=void 0;c.description=null;c.domain=null;c.editable=!0;c.length=-1;c.name=null;c.nullable=!0;c.type=null;c.valueType=null;return c}b.__extends(e,
a);k=e;e.prototype.readDescription=function(a,c){a=c.description;var b;try{b=JSON.parse(a)}catch(u){}return b?b.value:null};e.prototype.readValueType=function(a,b){a=b.description;var e;try{e=JSON.parse(a)}catch(u){}return e?c.fromJSON(e.fieldValueType):null};e.prototype.clone=function(){return new k({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,
type:this.type,valueType:this.valueType})};var k;b.__decorate([h.property({type:String,json:{write:!0}})],e.prototype,"alias",void 0);b.__decorate([h.property({type:[String,Number],json:{write:{allowNull:!0}}})],e.prototype,"defaultValue",void 0);b.__decorate([h.property()],e.prototype,"description",void 0);b.__decorate([h.reader("description")],e.prototype,"readDescription",null);b.__decorate([h.property({types:d.types,json:{read:{reader:d.fromJSON},write:!0}})],e.prototype,"domain",void 0);b.__decorate([h.property({type:Boolean,
json:{write:!0}})],e.prototype,"editable",void 0);b.__decorate([h.property({type:g.Integer,json:{write:!0}})],e.prototype,"length",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],e.prototype,"name",void 0);b.__decorate([h.property({type:Boolean,json:{write:!0}})],e.prototype,"nullable",void 0);b.__decorate([h.enumeration(f.kebabDict)],e.prototype,"type",void 0);b.__decorate([h.property()],e.prototype,"valueType",void 0);b.__decorate([h.reader("valueType",["description"])],e.prototype,
"readValueType",null);return e=k=b.__decorate([h.subclass("esri.layers.support.Field")],e)}(k.JSONSupport)})},"esri/layers/support/fieldType":function(){define(["require","exports","../../core/jsonMap"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.kebabDict=void 0;a.kebabDict=new b.default({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",
esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})})},"esri/layers/support/source/JoinTableDataSource":function(){define("require exports tslib ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ./DataLayerSource ./MapLayerSource".split(" "),
function(m,a,b,l,k,h,g,d,f,c){function e(){x||(x=d.createTypeReader({types:n()}));return x}function n(){p||(p={key:"type",base:null,typeMap:{"data-layer":f.DataLayerSource,"map-layer":c.MapLayerSource}});return p}Object.defineProperty(a,"__esModule",{value:!0});a.JoinTableDataSource=void 0;var t=l.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});m=function(a){function c(c){c=a.call(this,c)||this;c.type="join-table";return c}b.__extends(c,a);d=c;c.prototype.readLeftTableSource=
function(a,c,b){return e()(a,c,b)};c.prototype.castLeftTableSource=function(a){return g.ensureOneOfType(n(),a)};c.prototype.readRightTableSource=function(a,c,b){return e()(a,c,b)};c.prototype.castRightTableSource=function(a){return g.ensureOneOfType(n(),a)};c.prototype.clone=function(){var a,c,b=this.leftTableSource,e=this.rightTableSource,f=this.joinType,b={leftTableKey:this.leftTableKey,rightTableKey:this.rightTableKey,leftTableSource:null!==(a=null===b||void 0===b?void 0:b.clone())&&void 0!==a?
a:void 0,rightTableSource:null!==(c=null===e||void 0===e?void 0:e.clone())&&void 0!==c?c:void 0,joinType:f};return new d(b)};var d;b.__decorate([h.enumeration({joinTable:"join-table"})],c.prototype,"type",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"leftTableKey",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"rightTableKey",void 0);b.__decorate([h.property({json:{write:!0}})],c.prototype,"leftTableSource",void 0);b.__decorate([h.reader("leftTableSource")],
c.prototype,"readLeftTableSource",null);b.__decorate([h.cast("leftTableSource")],c.prototype,"castLeftTableSource",null);b.__decorate([h.property({json:{write:!0}})],c.prototype,"rightTableSource",void 0);b.__decorate([h.reader("rightTableSource")],c.prototype,"readRightTableSource",null);b.__decorate([h.cast("rightTableSource")],c.prototype,"castRightTableSource",null);b.__decorate([h.enumeration(t)],c.prototype,"joinType",void 0);return c=d=b.__decorate([h.subclass("esri.layers.support.source.JoinTableDataSource")],
c)}(k.JSONSupport);a.JoinTableDataSource=m;var x=null,p=null})},"esri/layers/support/source/MapLayerSource":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.MapLayerSource=void 0;m=function(a){function d(c){c=a.call(this,c)||this;c.type="map-layer";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({mapLayerId:this.mapLayerId,
gdbVersion:this.gdbVersion})};var f;b.__decorate([k.enumeration({mapLayer:"map-layer"})],d.prototype,"type",void 0);b.__decorate([k.property({type:h.Integer,json:{write:!0}})],d.prototype,"mapLayerId",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,"gdbVersion",void 0);return d=f=b.__decorate([k.subclass("esri.layers.support.source.MapLayerSource")],d)}(l.JSONSupport);a.MapLayerSource=m})},"esri/layers/support/source/QueryTableDataSource":function(){define("require exports tslib ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.QueryTableDataSource=void 0;m=function(a){function d(c){c=a.call(this,c)||this;c.type="query-table";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){var a,b=this.spatialReference,d=this.geometryType,b={workspaceId:this.workspaceId,query:this.query,oidFields:this.oidFields,spatialReference:null!==(a=null===b||void 0===b?void 0:b.clone())&&void 0!==a?a:void 0,geometryType:d};return new f(b)};var f;b.__decorate([h.enumeration({queryTable:"query-table"})],
d.prototype,"type",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"workspaceId",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"query",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"oidFields",void 0);b.__decorate([h.property({type:l.SpatialReference,json:{write:!0}})],d.prototype,"spatialReference",void 0);b.__decorate([h.enumeration(l.featureGeometryTypeKebabDictionary)],d.prototype,"geometryType",void 0);
return d=f=b.__decorate([h.subclass("esri.layers.support.source.QueryTableDataSource")],d)}(k.JSONSupport);a.QueryTableDataSource=m})},"esri/layers/support/source/RasterDataSource":function(){define(["require","exports","tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.RasterDataSource=void 0;m=function(a){function g(b){b=a.call(this,b)||this;b.type="raster";return b}b.__extends(g,a);d=g;g.prototype.clone=
function(){return new d({workspaceId:this.workspaceId,dataSourceName:this.dataSourceName})};var d;b.__decorate([k.enumeration({raster:"raster"})],g.prototype,"type",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"dataSourceName",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"workspaceId",void 0);return g=d=b.__decorate([k.subclass("esri.layers.support.source.RasterDataSource")],g)}(l.JSONSupport);a.RasterDataSource=m})},"esri/layers/support/source/TableDataSource":function(){define(["require",
"exports","tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.TableDataSource=void 0;m=function(a){function g(b){b=a.call(this,b)||this;b.type="table";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({workspaceId:this.workspaceId,gdbVersion:this.gdbVersion,dataSourceName:this.dataSourceName})};var d;b.__decorate([k.enumeration({table:"table"})],g.prototype,"type",void 0);b.__decorate([k.property({type:String,
json:{write:!0}})],g.prototype,"workspaceId",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"gdbVersion",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"dataSourceName",void 0);return g=d=b.__decorate([k.subclass("esri.layers.support.source.TableDataSource")],g)}(l.JSONSupport);a.TableDataSource=m})},"esri/tasks/support/QuantizationParameters":function(){define("require exports tslib ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),
function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});var f=new k.default({upperLeft:"upper-left",lowerLeft:"lower-left"});m=function(a){function c(c){c=a.call(this,c)||this;c.extent=null;c.mode="view";c.originPosition="upper-left";c.tolerance=1;return c}b.__extends(c,a);n=c;c.prototype.clone=function(){return new n(g.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};var n;b.__decorate([d.property({type:l.Extent,json:{write:{overridePolicy:function(){return{enabled:"view"===
this.mode}}}}})],c.prototype,"extent",void 0);b.__decorate([d.property({type:["view","edit"],json:{write:!0}})],c.prototype,"mode",void 0);b.__decorate([d.property({type:String,json:{read:f.read,write:f.write}})],c.prototype,"originPosition",void 0);b.__decorate([d.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:"view"===this.mode}}}}})],c.prototype,"tolerance",void 0);return c=n=b.__decorate([d.subclass("esri.tasks.support.QuantizationParameters")],c)}(h.JSONSupport);
a.default=m})},"esri/tasks/support/StatisticDefinition":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h,g){var d=new l.default({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"});return function(a){function c(c){c=a.call(this,c)||this;c.maxPointCount=
void 0;c.maxRecordCount=void 0;c.maxVertexCount=void 0;c.onStatisticField=null;c.outStatisticFieldName=null;c.statisticType=null;c.statisticParameters=null;return c}b.__extends(c,a);e=c;c.prototype.writeStatisticParameters=function(a,c){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)c.statisticParameters=h.clone(a)};c.prototype.clone=function(){return new e({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,
onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:h.clone(this.statisticParameters)})};var e;b.__decorate([g.property({type:Number,json:{write:!0}})],c.prototype,"maxPointCount",void 0);b.__decorate([g.property({type:Number,json:{write:!0}})],c.prototype,"maxRecordCount",void 0);b.__decorate([g.property({type:Number,json:{write:!0}})],c.prototype,"maxVertexCount",void 0);b.__decorate([g.property({type:String,
json:{write:!0}})],c.prototype,"onStatisticField",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"outStatisticFieldName",void 0);b.__decorate([g.property({type:String,json:{read:{source:"statisticType",reader:d.read},write:{target:"statisticType",writer:d.write}}})],c.prototype,"statisticType",void 0);b.__decorate([g.property({type:Object})],c.prototype,"statisticParameters",void 0);b.__decorate([g.writer("statisticParameters")],c.prototype,"writeStatisticParameters",
null);return c=e=b.__decorate([g.subclass("esri.tasks.support.StatisticDefinition")],c)}(k.JSONSupport)})},"esri/views/2d/layers/features/sources/createSource":function(){define("require exports ../../../../../layers/support/arcgisLayerUrl ./DrillDownFeatureSource ./GeoEventSource ./PagedFeatureSource".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.createSource=void 0;a.createSource=function(a,d,f,c,e){a:{switch(a.type){case "stream":a={type:"geoevent",serviceInfo:a,
onRequest:c,outSR:d,canAcceptRequest:e};break a;case "memory":case "on-demand":var g;g=a.source;g=Array.isArray(g)?"local":"path"in g&&b.isHostedAgolService(g.path)?"hosted":"unknown";a={type:"feature",serviceInfo:a,onRequest:c,outSR:d,origin:g,tileInfoView:f,canAcceptRequest:e};break a}a=void 0}switch(a.type){case "feature":switch(a.origin){case "hosted":case "local":return new h.PagedFeatureSource(a);case "unknown":return new l.DrillDownFeatureSource(a)}case "geoevent":return new k.GeoEventSource(a)}}})},
"esri/layers/support/arcgisLayerUrl":function(){define(["require","exports","../../core/urlUtils","../../support/persistableUrlUtils"],function(m,a,b,l){function k(a){a=b.urlToObject(a);var c=a.path.match(g)||a.path.match(d);if(!c)return null;a=c[1];var e=c[2],f=c[3],c=c[4],k=e.indexOf("/");return{title:h(-1!==k?e.slice(k+1):e),serverType:f,sublayer:null!=c&&""!==c?parseInt(c,10):null,url:{path:a}}}function h(a){a=a.replace(/\s*[/_]+\s*/g," ");return a[0].toUpperCase()+a.slice(1)}Object.defineProperty(a,
"__esModule",{value:!0});a.isServerOrServicesAGOLUrl=a.isWmsServer=a.writeUrlWithLayerId=a.sanitizeUrlWithLayerId=a.sanitizeUrl=a.isHostedSecuredProxyService=a.isHostedAgolService=a.titleFromUrlAndName=a.cleanTitle=a.parse=a.isArcGISUrl=a.serverTypes=void 0;a.serverTypes="MapServer ImageServer FeatureServer SceneServer StreamServer VectorTileServer".split(" ");var g=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/("+a.serverTypes.join("|")+"))(?:\\/(?:layers\\/)?(\\d+))?","i"),d=
new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/("+a.serverTypes.join("|")+"))(?:\\/(?:layers\\/)?(\\d+))?","i");a.isArcGISUrl=function(a){return!!g.test(a)};a.parse=k;a.cleanTitle=h;a.titleFromUrlAndName=function(a,c){var b=[];a&&(a=k(a))&&a.title&&b.push(a.title);c&&(c=h(c),b.push(c));if(2===b.length){if(-1!==b[0].toLowerCase().indexOf(b[1].toLowerCase()))return b[0];if(-1!==b[1].toLowerCase().indexOf(b[0].toLowerCase()))return b[1]}return b.join(" - ")};a.isHostedAgolService=function(a){if(!a)return!1;
a=a.toLowerCase();var c=-1!==a.indexOf(".arcgis.com/");a=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||-1!==a.indexOf("//features");return c&&a};a.isHostedSecuredProxyService=function(a,c){return c&&a&&-1!==a.toLowerCase().indexOf(c.toLowerCase())};a.sanitizeUrl=function(a,c){return a?b.removeTrailingSlash(b.removeQueryParameters(a,c)):a};a.sanitizeUrlWithLayerId=function(a,c,e){if(!c)return{url:c};c=b.removeQueryParameters(c,e);e=b.urlToObject(c);e=k(e.path);var d;e&&null!=e.sublayer&&
(null==a.layerId&&(d=e.sublayer),c=e.url.path);return{url:b.removeTrailingSlash(c),layerId:d}};a.writeUrlWithLayerId=function(a,c,e,d,g){l.write(c,d,"url",g);d.url&&null!=a.layerId&&(d.url=b.join(d.url,e,a.layerId.toString()))};a.isWmsServer=function(a){if(!a)return!1;var c=a.toLowerCase();a=-1!==c.indexOf("/services/");var b=-1!==c.indexOf("/mapserver/wmsserver"),d=-1!==c.indexOf("/imageserver/wmsserver"),c=-1!==c.indexOf("/wmsserver");return a&&(b||d||c)};a.isServerOrServicesAGOLUrl=function(a){if(!a)return!1;
a=(new b.Url(b.makeAbsolute(a))).authority.toLowerCase();return"server.arcgisonline.com"===a||"services.arcgisonline.com"===a}})},"esri/views/2d/layers/features/sources/DrillDownFeatureSource":function(){define("require exports tslib ../../../../../core/has ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.DrillDownFeatureSource=void 0;m=l("esri-featurelayer-webgl");l=l("esri-mobile");var g=m&&"object"===typeof m&&
null!=m.maxDrillLevel?m.maxDrillLevel:l?1:4,d=m&&"object"===typeof m&&null!=m.maxRecordCountFactor?m.maxRecordCountFactor:l?1:3;h=function(a){function c(c){return a.call(this,c)||this}b.__extends(c,a);c.prototype._fetchDataTile=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,f,h,q,l,y=this;return b.__generator(this,function(n){c=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor;e=this._subscriptions.get(a.key.id);f=e.signal;h=a.getQuantizationParameters();q=0;
l=function(n,p){return b.__awaiter(y,void 0,void 0,function(){var t,u,w,y,x,z,m,B;return b.__generator(this,function(b){switch(b.label){case 0:t=this._sourceQueryInfo,u=this._createQuery(n,{maxRecordCountFactor:c?d:void 0,returnExceededLimitFeatures:!1,quantizationParameters:h}),q++,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this._queue.push({tile:a,query:u,signal:f,depth:p})];case 2:w=b.sent();q--;k.throwIfAborted(f);if(!w)return[2];if(t!==this._sourceQueryInfo)return l(n,p),[2];if(w.exceededTransferLimit&&
p<g){y=0;for(x=n.createChildTiles();y<x.length;y++)z=x[y],l(z,p+1);return[2]}m={tile:a,id:a.id,features:w,end:0===q};e.requests.done.push({query:u,request:m});this._onRequest(m,"new");return[3,4];case 3:return B=b.sent(),k.isAbortError(B)||this._onRequest({tile:a,id:a.id,features:null,end:!0},"new"),[3,4];case 4:return[2]}})})};l(a,0);return[2]})})};return c}(h.BaseFeatureSource);a.DrillDownFeatureSource=h})},"esri/views/2d/layers/features/sources/BaseFeatureSource":function(){define("require exports tslib ../../../../../request ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../tasks/support/Query ../controllers/support/sources ./DataTileSource ../../../../support/QueueProcessor".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){Object.defineProperty(a,"__esModule",{value:!0});a.BaseFeatureSource=void 0;var x=g.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource");m=function(a){function g(c){var d=a.call(this,c)||this;d.type="feature";d._adapter=e.createSourceAdapter(c.serviceInfo);d._queue=new t.QueueProcessor({concurrency:8,process:function(a){return b.__awaiter(d,void 0,void 0,function(){var c,e,d,g,n;return b.__generator(this,function(b){f.throwIfAborted(a);c=a.tile.key.id;
e=a.tile;d=a.signal;g=h("esri-tiles-debug")?{tile:c.replace(/\//g,"."),depth:a.depth}:void 0;n={query:g,signal:d,transform:e.transform};return[2,this._adapter.executeQuery(a.query,n)]})})}});d._patchQueue=new t.QueueProcessor({concurrency:8,process:function(a){return b.__awaiter(d,void 0,void 0,function(){var c,e,d,g,n;return b.__generator(this,function(b){f.throwIfAborted(a);c=a.tile.key.id;e=a.tile;d=a.signal;g=h("esri-tiles-debug")?{tile:c.replace(/\//g,"."),depth:a.depth}:void 0;n={query:g,signal:d,
transform:e.transform};return[2,this._adapter.executeQuery(a.query,n)]})})}});return d}b.__extends(g,a);g.prototype.destroy=function(){this._adapter.destroy();this._queue.destroy();this._patchQueue.destroy()};g.prototype.setViewState=function(a){};Object.defineProperty(g.prototype,"updating",{get:function(){return!!this._queue.length},enumerable:!1,configurable:!0});g.prototype.subscribe=function(c){a.prototype.subscribe.call(this,c);this._fetchDataTile(c).catch(function(a){f.isAbortError(a)||x.error(new k("mapview-query-error",
"Encountered error when fetching tile",{tile:c,error:a}))})};g.prototype.unsubscribe=function(c){a.prototype.unsubscribe.call(this,c)};g.prototype.pause=function(){this._queue.pause()};g.prototype.resume=function(){this._queue.resume()};g.prototype.query=function(a,c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){return[2,this._adapter.executeQuery(a,c)]})})};g.prototype.queryLastEditDate=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c,
e,d;return b.__generator(this,function(f){switch(f.label){case 0:return a=this._serviceInfo.source,c=b.__assign(b.__assign({},a.query),{f:"json"}),[4,l(a.path,{query:c,responseType:"json"})];case 1:return e=f.sent(),d=e.data,[2,d.editingInfo.lastEditDate]}})})};g.prototype.forEachRequest=function(a,c){var b=this._subscriptions.get(a);a=b.signal;for(var e=0,b=b.requests.done;e<b.length;e++)c(b[e].request,{signal:a})};g.prototype._executePatchQuery=function(a,c,e,d){return b.__awaiter(this,void 0,void 0,
function(){var f,g,n;return b.__generator(this,function(h){f=c.clone();f.outFields=b.__spreadArrays([this._serviceInfo.objectIdField],e);f.returnCentroid=!1;f.returnGeometry=!1;g=f.start/8E3;n=d.signal;return[2,this._patchQueue.push({tile:a,query:f,signal:n,depth:g})]})})};g.prototype._resendRequest=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,g,n,h,q,k;return b.__generator(this,function(p){switch(p.label){case 0:e=a.query;g=a.request;n=e.outFields;h=this._sourceQueryInfo.outFields;
q=h.filter(function(a){return-1===n.indexOf(a)});if(d.isNone(g.features))return[2];if(!q.length)return this._onRequest(b.__assign(b.__assign({},g),{end:g.end||c.end}),"new",c),[2];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this._executePatchQuery(g.tile,e,q,c)];case 2:return k=p.sent(),f.throwIfAborted(c),e.outFields=h,g.features.joinAttributes(k),this._onRequest(b.__assign(b.__assign({},g),{end:g.end||c.end}),"new",c),[3,4];case 3:return p.sent(),[3,4];case 4:return[2]}})})};g.prototype.resend=
function(a){var c=a.dataTileOnly;return b.__awaiter(this,void 0,void 0,function(){var a,e,d,g=this;return b.__generator(this,function(b){switch(b.label){case 0:a=0;e=!1;d=[];for(this._subscriptions.forEach(function(a){a.requests.done.length||(a=a.tile,g._onRequest({tile:a,id:a.id,features:null,noData:!0,end:!1},"new",{dataTileOnly:!0}))});!e;)e=!0,this._subscriptions.forEach(function(b){var f=b.requests;b=b.signal;f.done.length>a&&(e=!1,d.push(g._resendRequest(f.done[a],{signal:b,dataTileOnly:c,end:f.done.length===
a+1})))}),a++;return[4,f.all(d)];case 1:return b.sent(),[2]}})})};g.prototype._createQuery=function(a,e){var d=new c(b.__assign(b.__assign(b.__assign({},this._serviceQueryInfo),this._sourceQueryInfo),e));this._serviceInfo.capabilities.query.supportsQuantization||(e.quantizationParameters=null,d.maxAllowableOffset=a.resolution);e.quantizationParameters&&"esriGeometryPolyline"===this.geometryType&&(d.maxAllowableOffset=a.resolution);d.resultType="tile";d.geometry=a.extent;return d};return g}(n.DataTileSource);
a.BaseFeatureSource=m})},"esri/views/2d/layers/features/controllers/support/sources":function(){define("require exports tslib ../../../../../../core/workers ../../../../../../layers/graphics/featureConversionUtils ../../../../../../layers/ogc/ogcFeatureUtils ../../../../../../tasks/operations/query ../../support/FeatureSetReaderJSON ../../support/FeatureSetReaderPBF".split(" "),function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.createSourceAdapter=a.SourceAdapter=void 0;
m=function(){function a(a){this.service=a}a.prototype.destroy=function(){};return a}();a.SourceAdapter=m;a.createSourceAdapter=function(a){var b=a.capabilities,d=a.source;return d&&d.capabilities&&d.collectionId&&d.layerDefinition&&d.url?new t(a):Array.isArray(a.source)?new c(a):b.query.supportsFormatPBF?new e(a):new n(a)};var c=function(a){function c(c){var b=a.call(this,c)||this;b._portsOpen=l.openWithPorts(c.source).then(function(a){return b.client=a});return b}b.__extends(c,a);c.prototype.destroy=
function(){this.client.close();this.client=null};c.prototype.executeQuery=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this._portsOpen];case 1:return b.sent(),[4,this.client.invoke("queryFeatures",a.toJSON(),c)];case 2:return e=b.sent(),[2,d.FeatureSetReaderJSON.fromFeatureSet(e,this.service.objectIdField)]}})})};return c}(m),e=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,
a);c.prototype.executeQuery=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return[4,g.executeQueryPBFBuffer(this.service.source,a,c)];case 1:return e=b.sent().data,[2,f.FeatureSetReaderPBF.fromBuffer(e,this.service.geometryType)]}})})};return c}(m),n=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.prototype.executeQuery=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,
f,n,h,q,p,l,t,u;return b.__generator(this,function(b){switch(b.label){case 0:e=this.service;f=e.source;n=e.capabilities;h=e.spatialReference;q=e.objectIdField;if(!a.quantizationParameters||n.query.supportsQuantization)return[3,2];p=a.clone();p.quantizationParameters=null;return[4,g.executeQuery(f,p,h,c)];case 1:return l=b.sent().data,t=k.convertFromFeatureSet(l,q),k.quantizeOptimizedFeatureSet(c.transform,t),[2,d.FeatureSetReaderJSON.fromOptimizedFeatureSet(t)];case 2:return[4,g.executeQuery(f,a,
this.service.spatialReference,c)];case 3:return u=b.sent().data,[2,d.FeatureSetReaderJSON.fromFeatureSet(u,this.service.objectIdField)]}})})};return c}(m),t=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.prototype.executeQuery=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,f,g,n;return b.__generator(this,function(b){switch(b.label){case 0:e=this.service.capabilities;if(!a.quantizationParameters||e.query.supportsQuantization)return[3,
2];f=a.clone();f.quantizationParameters=null;return[4,h.queryOptimizedFeatureSet(this.service.source,a,c)];case 1:return g=b.sent(),k.quantizeOptimizedFeatureSet(c.transform,g),[2,d.FeatureSetReaderJSON.fromOptimizedFeatureSet(g)];case 2:return[4,h.queryOptimizedFeatureSet(this.service.source,a,c)];case 3:return n=b.sent(),[2,d.FeatureSetReaderJSON.fromOptimizedFeatureSet(n)]}})})};return c}(m)})},"esri/core/workers":function(){define(["require","exports","tslib","./workers/workers"],function(m,a,
b,l){Object.defineProperty(a,"__esModule",{value:!0});b.__exportStar(l,a)})},"esri/core/workers/workers":function(){define("require exports tslib ../Error ../has ../promiseUtils ./Connection ./RemoteClient ./WorkerOwner @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h,g,d,f){function c(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return e=new g,[4,e.open(a,c)];case 1:return b.sent(),[2,e]}})})}function e(){return b.__awaiter(this,
void 0,void 0,function(){var a,c,e;return b.__generator(this,function(b){if(p)return[2,p];q=h.createAbortController();a=[];c=function(c){var b=f.create(c).then(function(a){return x[c]=a});a.push(b)};for(e=0;e<n;e++)c(e);p=h.all(a);return[2,p]})})}Object.defineProperty(a,"__esModule",{value:!0});a.terminate=a.open=a.openWithPorts=a.initialize=a.RemoteClient=a.Connection=void 0;a.Connection=g;a.RemoteClient=d;var n=k("esri-workers-debug")?1:k("host-browser")?navigator.hardwareConcurrency-1:0;n||(n=
k("safari")&&k("mac")||k("trident")?7:2);var t=0,x=[];a.initialize=function(){e()};a.openWithPorts=function(a,b){return c(a,{client:b})};a.open=function(a,f){void 0===f&&(f={});return b.__awaiter(this,void 0,void 0,function(){var g,q,p,u,y,E,D,F,H;return b.__generator(this,function(w){switch(w.label){case 0:if("string"!==typeof a)throw new l("workers:undefined-module","modulePath is missing");g=f.strategy||"distributed";k("host-webworker")&&!k("esri-workers")&&(g="local");return"local"!==g?[3,4]:
[4,d.loadWorker(a)];case 1:return(q=w.sent())?[3,3]:[4,new Promise(function(c,b){m([a],c,b)})];case 2:q=w.sent(),w.label=3;case 3:return h.throwIfAborted(f.signal),p=f.client||q,u=d.connect(q),[2,c([u],b.__assign(b.__assign({},f),{client:p}))];case 4:return[4,e()];case 5:w.sent();h.throwIfAborted(f.signal);if("dedicated"!==g)return[3,7];y=t++%n;return[4,x[y].open(a,f)];case 6:return u=w.sent(),[2,c([u],f)];case 7:if(f.maxNumWorkers&&0<f.maxNumWorkers&&(E=Math.min(f.maxNumWorkers,n),E<n)){D=Array(E);
for(F=0;F<E;++F)y=t++%n,D[F]=x[y].open(a,f);return[2,c(D,f)]}H=x.map(function(c){return c.open(a,f)});return[2,c(H,f)]}})})};a.terminate=function(){p&&(q.abort(),p=null);for(var a=0;a<x.length;a++)x[a]&&x[a].terminate();x.length=0};var p=null,q})},"esri/core/workers/Connection":function(){define("require exports ../handleUtils ../Logger ../promiseUtils ./RemoteClient".split(" "),function(m,a,b,l,k,h){var g=l.getLogger("esri.core.workers.Connection");return function(){function a(){this._clients=[];
this._clientPromises=[];this._clientIdx=0}a.prototype.destroy=function(){this.close()};Object.defineProperty(a.prototype,"closed",{get:function(){return!this._clients||!this._clients.length},enumerable:!1,configurable:!0});a.prototype.open=function(a,c){var b=this;return k.create(function(e,d){var f=!0,g=function(a){k.throwIfAborted(c.signal);f&&(f=!1,a())};b._clients.length=a.length;b._clientPromises.length=a.length;for(var n=function(f){var n=a[f];if(k.isThenable(n))return b._clientPromises[f]=
n.then(function(a){b._clients[f]=new h(a,c);g(e);return b._clients[f]},function(){g(d);return null}),"continue";b._clients[f]=new h(n,c);b._clientPromises[f]=k.resolve(b._clients[f]);g(e)},l=0;l<a.length;++l)n(l)})};a.prototype.broadcast=function(a,c,b){for(var e=Array(this._clientPromises.length),d=0;d<this._clientPromises.length;++d)e[d]=this._clientPromises[d].then(function(e){return e.invoke(a,c,b)});return e};a.prototype.close=function(){for(var a=0,c=this._clientPromises;a<c.length;a++)c[a].then(function(a){return a.close()});
this._clients.length=0;this._clientPromises.length=0};a.prototype.getAvailableClient=function(){for(var a,c=0;c<this._clients.length;++c){var b=this._clients[c];if(!b)a=a||[],a.push(this._clientPromises[c]);else if(!b.isBusy())return k.resolve(b)}return a?k.first(a):(this._clientIdx=(this._clientIdx+1)%this._clients.length,k.resolve(this._clients[this._clientIdx]))};a.prototype.invoke=function(a,c,b){var e=null;Array.isArray(b)?(g.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),
e={transferList:b}):e=b;return this.closed?k.reject(Error("Connection closed")):this.getAvailableClient().then(function(b){return b.invoke(a,c,e)})};a.prototype.on=function(a,c){var e=this;return k.all(this._clientPromises).then(function(){return b.handlesGroup(e._clients.map(function(b){return b.on(a,c)}))})};a.prototype.openPorts=function(){var a=this;return k.create(function(c){for(var b=Array(a._clientPromises.length),d=b.length,f=function(e){a._clientPromises[e].then(function(a){b[e]=a.openPort();
0===--d&&c(b)})},g=0;g<a._clientPromises.length;++g)f(g)})};Object.defineProperty(a.prototype,"test",{get:function(){return{numClients:this._clients.length}},enumerable:!1,configurable:!0});return a}()})},"esri/core/workers/WorkerOwner":function(){define("require exports tslib ../../kernel ../Error ../Logger ../promiseUtils ./utils ./workerFactory".split(" "),function(m,a,b,l,k,h,g,d,f){var c=h.getLogger("esri.core.workers"),e=d.MessageType.ABORT,n=d.MessageType.INVOKE,t=d.MessageType.OPEN,x=d.MessageType.OPENED,
p=d.MessageType.RESPONSE;return function(){function a(a,b){this._outJobs=new Map;this._inJobs=new Map;this.worker=a;this.id=b;a.addEventListener("message",this._onMessage.bind(this));a.addEventListener("error",function(a){a.preventDefault();c.error(a)})}a.create=function(c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return[4,f.createWorker()];case 1:return e=b.sent(),[2,new a(e,c)]}})})};a.prototype.terminate=function(){this.worker.terminate()};
a.prototype.open=function(a,c){void 0===c&&(c={});return b.__awaiter(this,void 0,void 0,function(){var f,n,h=this;return b.__generator(this,function(b){f=c.signal;n=d.newJobId();return[2,g.create(function(c,b){var d=g.onAbortOrThrow(f,function(){h._outJobs.delete(n);h._post({type:e,jobId:n})});h._outJobs.set(n,{resolve:c,reject:b,abortHandle:d});h._post({type:t,jobId:n,modulePath:a})})]})})};a.prototype._onMessage=function(a){if(a=d.receiveMessage(a))switch(a.type){case x:this._onOpenedMessage(a);
break;case p:this._onResponseMessage(a);break;case e:this._onAbortMessage(a);break;case n:this._onInvokeMessage(a)}};a.prototype._onAbortMessage=function(a){var c=this._inJobs;a=a.jobId;var b=c.get(a);b&&(b.controller&&b.controller.abort(),c.delete(a))};a.prototype._onInvokeMessage=function(a){var c=this,b=a.methodName,e=a.jobId,f=a.data;a=a.abortable?g.createAbortController():null;var n=this._inJobs,h=l.workerMessages[b],q;try{if("function"!==typeof h)throw new TypeError(b+" is not a function");
q=h.call(null,f,{signal:a?a.signal:null})}catch(D){this._post({type:p,jobId:e,error:d.toInvokeError(D)});return}g.isPromiseLike(q)?(n.set(e,{controller:a,promise:q}),q.then(function(a){n.has(e)&&(n.delete(e),c._post({type:p,jobId:e},a))},function(a){n.has(e)&&(n.delete(e),a||(a={message:"Error encountered at method"+b}),g.isAbortError(a)||c._post({type:p,jobId:e,error:d.toInvokeError(a||{message:"Error encountered at method "+b})}))})):this._post({type:p,jobId:e},q)};a.prototype._onOpenedMessage=
function(a){var c,b=a.jobId;a=a.data;var e=this._outJobs.get(b);e&&(this._outJobs.delete(b),null===(c=e.abortHandle)||void 0===c?void 0:c.remove(),e.resolve(a))};a.prototype._onResponseMessage=function(a){var c,b=a.jobId,e=a.error;a=a.data;var d=this._outJobs.get(b);d&&(this._outJobs.delete(b),null===(c=d.abortHandle)||void 0===c?void 0:c.remove(),e?d.reject(k.fromJSON(JSON.parse(e))):d.resolve(a))};a.prototype._post=function(a,c,b){return d.postMessage(this.worker,a,c,b)};return a}()})},"esri/core/workers/workerFactory":function(){define("require exports tslib ../../config ../../intl ../has ../Logger ../promiseUtils ./loaderConfig ./utils ./WorkerFallback".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){function n(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(g){return[2,d.create(function(d){function g(e){if(e=c.receiveMessage(e))switch(e.type){case q:e=a;var t=l.workers.loaderUrl||f.DEFAULT_LOADER_URL,u;null!=l["default"]?(u=b.__assign({},l),delete u["default"],u=JSON.parse(JSON.stringify(u))):u=JSON.parse(JSON.stringify(l));u.locale=k.getLocale();u.has={"csp-restrictions":h("csp-restrictions"),"esri-2d-debug":0,"esri-2d-update-debug":h("esri-2d-update-debug"),
"esri-atomics":h("esri-atomics"),"esri-secure-context":h("esri-secure-context"),"esri-shared-array-buffer":h("esri-shared-array-buffer"),"esri-tiles-debug":h("esri-tiles-debug"),"esri-webgl-max-texture-size":h("esri-webgl-max-texture-size"),"esri-webgl-texture-float":h("esri-webgl-texture-float"),"esri-workers-arraybuffer-transfer":h("esri-workers-arraybuffer-transfer"),"host-webworker":1};var w=l.workers.loaderConfig,w=f.default({baseUrl:w.baseUrl,locale:k.getLocale(),has:b.__assign({"csp-restrictions":h("csp-restrictions"),
"dojo-test-sniff":0,"host-webworker":1},w.has),map:b.__assign({},w.map),paths:b.__assign({},w.paths),packages:w.packages||[]});e.postMessage({type:p,configure:{esriConfig:u,loaderUrl:t,loaderConfig:w}});break;case x:a.removeEventListener("message",g),a.removeEventListener("error",n),d(a)}}function n(c){c.preventDefault();a.removeEventListener("message",g);a.removeEventListener("error",n);t.warn("Failed to create Worker. Fallback to execute module in main thread",c);a=new e;a.addEventListener("message",
g);a.addEventListener("error",n)}a.addEventListener("message",g);a.addEventListener("error",n)})]})})}Object.defineProperty(a,"__esModule",{value:!0});a.createWorker=void 0;var t=g.getLogger("esri.core.workers");h.add("esri-workers-arraybuffer-transfer",!h("safari")||12<=h("safari"));var x=c.MessageType.CONFIGURED,p=c.MessageType.CONFIGURE,q=c.MessageType.HANDSHAKE,u;try{u=URL.createObjectURL(new Blob(['var globalId\x3d0,outgoing\x3dnew Map,configured\x3d!1,HANDSHAKE\x3d0,CONFIGURE\x3d1,CONFIGURED\x3d2,OPEN\x3d3,OPENED\x3d4,RESPONSE\x3d5,INVOKE\x3d6,ABORT\x3d7;function createAbortError(){var error\x3dnew Error("Aborted");return error.name\x3d"AbortError",error}function receiveMessage(event){return event\x26\x26event.data?"string"\x3d\x3dtypeof event.data?JSON.parse(event.data):event.data:null}function invokeStaticMessage(methodName,data,options){var signal\x3doptions\x26\x26options.signal,jobId\x3dglobalId++;return new Promise((function(resolve,reject){if(signal){if(signal.aborted)return reject(createAbortError());signal.addEventListener("abort",(function(){outgoing.get(jobId)\x26\x26(outgoing.delete(jobId),self.postMessage({type:ABORT,jobId:jobId}),reject(createAbortError()))}))}outgoing.set(jobId,{resolve:resolve,reject:reject}),self.postMessage({type:INVOKE,jobId:jobId,methodName:methodName,abortable:null!\x3dsignal,data:data})}))}function messageHandler(event){var message\x3dreceiveMessage(event);if(message){var jobId\x3dmessage.jobId;switch(message.type){case CONFIGURE:var configuration\x3dmessage.configure;if(configured)return;configured\x3d!0,self.dojoConfig\x3dconfiguration.loaderConfig,self.importScripts(configuration.loaderUrl),"function"\x3d\x3dtypeof require.config\x26\x26require.config(configuration.loaderConfig),self.esriConfig\x3dconfiguration.esriConfig,self.postMessage({type:CONFIGURED});break;case OPEN:var modulePath\x3dmessage.modulePath;require(["esri/core/workers/RemoteClient"],(function(RemoteClient){RemoteClient.loadWorker(modulePath).then((function(Module){return Module||new Promise((function(resolve){require([modulePath],resolve)}))})).then((function(Module){var port\x3dRemoteClient.connect(Module);self.postMessage({type:OPENED,jobId:jobId,data:port},[port])}))}));break;case RESPONSE:if(outgoing.has(jobId)){var deferred\x3doutgoing.get(jobId);outgoing.delete(jobId),message.error?deferred.reject(JSON.parse(message.error)):deferred.resolve(message.data)}}}}self.addEventListener("message",messageHandler),self.postMessage({type:HANDSHAKE});'],
{type:"text/javascript"}))}catch(y){}a.createWorker=function(){return b.__awaiter(this,void 0,void 0,function(){var a;return b.__generator(this,function(c){if(!h("esri-workers"))return[2,n(new e)];if(u)try{a=new Worker(u)}catch(B){t.warn("Failed to create Worker. Fallback to execute module in main thread",event),a=new e}else t.warn("Failed to create Worker. Fallback to execute module in main thread",event),a=new e;return[2,n(a)]})})}})},"esri/core/workers/loaderConfig":function(){define(["require",
"exports","tslib","../has","../urlUtils"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.DEFAULT_CONFIG=a.DEFAULT_LOADER_URL=void 0;a.DEFAULT_LOADER_URL=k.makeAbsolute(k.removeQueryParameters(m.toUrl("dojo/dojo-lite.js")));a.DEFAULT_CONFIG={baseUrl:function(){var a=k.removeQueryParameters(m.toUrl("dojo/x.js"));return k.makeAbsolute(a.slice(0,a.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",
main:"dist/cldr"},{name:"globalize",main:"dist/globalize"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental","cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}};a.default=function(h){var g={async:h.async,isDebug:h.isDebug,locale:h.locale,baseUrl:h.baseUrl,has:b.__assign({},
h.has),map:b.__assign({},h.map),packages:h.packages&&h.packages.concat()||[],paths:b.__assign({},h.paths)};h.hasOwnProperty("async")||(g.async=!0);h.hasOwnProperty("isDebug")||(g.isDebug=!1);h.baseUrl||(g.baseUrl=a.DEFAULT_CONFIG.baseUrl);a.DEFAULT_CONFIG.packages.forEach(function(a){a:{for(var c=g.packages,e=0;e<c.length;e++)if(c[e].name===a.name)break a;a=b.__assign({},a);e=k.removeQueryParameters(m.toUrl(a.name+"/x.js"));e=e.slice(0,e.length-5);a.location=k.makeAbsolute(e);c.push(a)}});h=g.map=
g.map||{};for(var d=0,f=Object.keys(a.DEFAULT_CONFIG.map);d<f.length;d++){var c=f[d];h[c]||(h[c]=a.DEFAULT_CONFIG.map[c])}return g}})},"esri/core/workers/WorkerFallback":function(){define("require exports tslib ../global ./RemoteClient ./utils @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h){var g=function(){return function(){var a=this,c=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(b){a[b]=function(){for(var a=[],e=0;e<
arguments.length;e++)a[e]=arguments[e];return c[b].apply(c,a)}})}}(),d=l.MutationObserver||l.WebKitMutationObserver,f=function(){var a;if(l.process&&l.process.nextTick)a=function(a){l.process.nextTick(a)};else if(l.Promise)a=function(a){l.Promise.resolve().then(a)};else if(d){var c=[],b=document.createElement("div");(new d(function(){for(;0<c.length;)c.shift()()})).observe(b,{attributes:!0});a=function(a){c.push(a);b.setAttribute("queueStatus","1")}}return a}(),c=function(){var a=l.MessageEvent;try{new a("message",
{data:null})}catch(n){return function(a,c){void 0===c&&(c={});var b=c.data,e=c.bubbles,e=void 0===e?!1:e;c=c.cancelable;c=void 0===c?!1:c;var d=document.createEvent("Event");d.initEvent(a,e,c);d.data=b;return d}}return function(c,b){return new a(c,b)}}();return function(){function a(){this._dispatcher=new g;this._isInitialized=!1;this._workerPostMessage({type:h.MessageType.HANDSHAKE})}a.prototype.terminate=function(){};Object.defineProperty(a.prototype,"onmessage",{get:function(){return this._onmessageHandler},
set:function(a){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=a)&&this.addEventListener("message",a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"onmessageerror",{get:function(){return this._onmessageerrorHandler},set:function(a){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler);(this._onmessageerrorHandler=a)&&this.addEventListener("messageerror",a)},enumerable:!1,configurable:!0});
Object.defineProperty(a.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(a){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);(this._onerrorHandler=a)&&this.addEventListener("error",a)},enumerable:!1,configurable:!0});a.prototype.postMessage=function(a){var b=this;f(function(){b._workerMessageHandler(c("message",{data:a}))})};a.prototype.dispatchEvent=function(a){return this._dispatcher.dispatchEvent(a)};a.prototype.addEventListener=function(a,
c,b){this._dispatcher.addEventListener(a,c,b)};a.prototype.removeEventListener=function(a,c,b){this._dispatcher.removeEventListener(a,c,b)};a.prototype._workerPostMessage=function(a){var b=this;f(function(){b.dispatchEvent(c("message",{data:a}))})};a.prototype._workerMessageHandler=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f,g,n;return b.__generator(this,function(b){switch(b.label){case 0:c=h.receiveMessage(a);if(!c)return[2];e=c.type;switch(e){case h.MessageType.CONFIGURE:return[3,
1];case h.MessageType.OPEN:return[3,2]}return[3,6];case 1:return this._isInitialized||this._workerPostMessage({type:h.MessageType.CONFIGURED}),[3,6];case 2:return d=c.modulePath,f=c.jobId,[4,k.loadWorker(d)];case 3:return(g=b.sent())?[3,5]:[4,new Promise(function(a,c){m([d],a,c)})];case 4:g=b.sent(),b.label=5;case 5:return n=k.connect(g),this._workerPostMessage({type:h.MessageType.OPENED,jobId:f,data:n}),[3,6];case 6:return[2]}})})};return a}()})},"esri/layers/ogc/ogcFeatureUtils":function(){define("require exports tslib ../../request ../../core/arrayUtils ../../core/Error ../../core/Logger ../../geometry/support/spatialReferenceUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/data/projectionSupport ../graphics/data/projectionSupport ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../tasks/support/FeatureSet".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u){function y(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return[4,w(a,c,e)];case 1:return d=b.sent(),[2,f.convertToFeatureSet(d)]}})})}function w(a,g,h){var q;return b.__awaiter(this,void 0,void 0,function(){var k,p,u,w,y,x,m,C,z,D,A,E,V,R,T,X,da,fa,aa,ca,Z,ga,ea,la,ja,ua,xa,Da,Ea,ta,Aa,U,ma;return b.__generator(this,function(F){switch(F.label){case 0:return k=a.capabilities.query.maxRecordCount,
p=a.collectionId,u=a.layerDefinition,w=a.url,y=w+"/collections/"+p+"/items",x=g.geometry,m=g.num,C=g.outSpatialReference,z=g.start,D=g.timeExtent,A=g.where,V=(E=n.project(x,d.WGS84))?E.xmin+","+E.ymin+","+E.xmax+","+E.ymax:null,R=B(D),T=A&&"1\x3d1"!==A?A:null,X=null!==z&&void 0!==z?z:0,da=null!==m&&void 0!==m?m:null!=z&&void 0!==z?10:k,[4,l(y,b.__assign(b.__assign({},h),{query:{bbox:V,datetime:R,query:T,limit:da,startindex:X,f:"application/geo+json"}}))];case 1:fa=F.sent().data;aa=null===(q=fa.links)||
void 0===q?void 0:q.filter(function(a){return"next"===a.rel});ca=0!==(null===aa||void 0===aa?void 0:aa.length);Z=u.fields;ga=u.globalIdField;ea=u.hasM;la=u.hasZ;ja=u.objectIdField;ua=u.geometryType;xa=t.createOptimizedFeatures(fa,{geometryType:ua,hasZ:la,objectIdFieldName:ja});if(!d.equals(C,d.WGS84))for(Da=0,Ea=xa;Da<Ea.length;Da++)ta=Ea[Da],ta.geometry&&(ta.geometry=f.convertFromGeometry(e.project(f.convertToGeometry(ta.geometry,ua,la,!1),d.WGS84,C)));Aa=0;for(U=xa;Aa<U.length;Aa++)ta=U[Aa],ta.objectId=
ta.attributes[ja];ma=new c.default;ma.exceededTransferLimit=ca;ma.features=xa;ma.fields=Z;ma.geometryType=ua;ma.globalIdFieldName=ga;ma.hasM=ea;ma.hasZ=la;ma.objectIdFieldName=ja;ma.spatialReference=C||d.WGS84;return[2,ma]}})})}function B(a){if(!a)return null;var c=a.start;a=a.end;return(c?c.toISOString():"..")+"/"+(a?a.toISOString():"..")}Object.defineProperty(a,"__esModule",{value:!0});a.queryOptimizedFeatureSet=a.queryFeatureSetJSON=a.queryFeatureSet=a.getServerLandingPage=a.getServerConformance=
a.getServerCollections=a.getServerCollection=a.getCollectionDefinition=void 0;var z=g.getLogger("esri.layers.graphics.sources.ogcfeature");a.getCollectionDefinition=function(a,c,f,g,n){void 0===n&&(n=5);return b.__awaiter(this,void 0,void 0,function(){var u,w,y,m,C,D,A,B,E,F,Q,V,R,T,X,da,fa;return b.__generator(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,e.checkProjectionSupport(d.WGS84,f.spatialReference)];case 1:return b.sent(),[3,3];case 2:throw b.sent(),new h("ogc-feature-layer:projection-not-supported",
"Projection not supported");case 3:return u=a+"/collections/"+c+"/items",[4,l(u,{signal:g,query:{limit:n,f:"application/geo+json"}})];case 4:return w=b.sent().data,[4,t.validateGeoJSON(w)];case 5:b.sent();y=t.inferLayerProperties(w,{geometryType:f.geometryType});m=f.fields||y.fields||[];C=null!=f.hasZ?f.hasZ:y.hasZ;D=y.geometryType;A=f.objectIdField||y.objectIdFieldName||"OBJECTID";B=f.timeInfo;E=k.find(m,function(a){return a.name===A});if(F=!E){if(!y.objectIdFieldType)throw new h("ogc-feature-layer:missing-feature-id",
"Collection geojson require a feature id as a unique identifier");m.unshift({name:A,alias:A,type:"esriFieldTypeOID",editable:!1,nullable:!1})}else E.type="esriFieldTypeOID",E.editable=!1,E.nullable=!1;A!==y.objectIdFieldName&&(Q=k.find(m,function(a){return a.name===y.objectIdFieldName}))&&(Q.type="esriFieldTypeInteger");if(!D)throw new h("ogc-feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");m===y.fields&&0<y.unknownFields.length&&z.warn({name:"ogc-feature-layer:unknown-field-types",
message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:y.unknownFields}});V=0;for(R=m;V<R.length;V++){Q=R[V];null==Q.name&&(Q.name=Q.alias);null==Q.alias&&(Q.alias=Q.name);"esriFieldTypeOID"!==Q.type&&"esriFieldTypeGlobalID"!==Q.type&&(Q.editable=null==Q.editable?!0:!!Q.editable,Q.nullable=null==Q.nullable?!0:!!Q.nullable);if(!Q.name)throw new h("ogc-feature-layer:invalid-field-name","field name is missing",{field:Q});if(-1===q.kebabDict.jsonValues.indexOf(Q.type))throw new h("ogc-feature-layer:invalid-field-type",
'invalid type for field "'+Q.name+'"',{field:Q});}B&&(T=new p(m),B.startTimeField&&((X=T.get(B.startTimeField))?(B.startTimeField=X.name,X.type="esriFieldTypeDate"):B.startTimeField=null),B.endTimeField&&((da=T.get(B.endTimeField))?(B.endTimeField=da.name,da.type="esriFieldTypeDate"):B.endTimeField=null),B.trackIdField&&((fa=T.get(B.trackIdField))?B.trackIdField=fa.name:(B.trackIdField=null,z.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:B}}))),
B.startTimeField||B.endTimeField||(z.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:B}}),B=null));return[2,{drawingInfo:x.createDrawingInfo(D),geometryType:D,fields:m,hasZ:!!C,objectIdField:A,timeInfo:B}]}})})};a.getServerCollection=function(a,c,e,d){return b.__awaiter(this,void 0,void 0,function(){var f,g;return b.__generator(this,function(b){switch(b.label){case 0:return f=a+"/collections/"+c,[4,l(f,{signal:d,query:{f:e}})];
case 1:return g=b.sent().data,[2,g]}})})};a.getServerCollections=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d,f;return b.__generator(this,function(b){switch(b.label){case 0:return d=a+"/collections",[4,l(d,{signal:e,query:{f:c}})];case 1:return f=b.sent().data,[2,f]}})})};a.getServerConformance=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d,f;return b.__generator(this,function(b){switch(b.label){case 0:return d=a+"/conformance",[4,l(d,{signal:e,query:{f:c}})];
case 1:return f=b.sent().data,[2,f]}})})};a.getServerLandingPage=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return[4,l(a,{signal:e,query:{f:c}})];case 1:return d=b.sent().data,[2,d]}})})};a.queryFeatureSet=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return[4,y(a,c,e)];case 1:return d=b.sent(),[2,u.fromJSON(d)]}})})};a.queryFeatureSetJSON=
y;a.queryOptimizedFeatureSet=w})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports tslib ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),function(m,a,b,l,k,h){function g(a){var c=[];a.forEach(function(a){return c.push(a)});return c}function d(a){var c,e,d,f;return b.__generator(this,function(b){switch(b.label){case 0:c=a.type;switch(c){case "Feature":return[3,1];case "FeatureCollection":return[3,3]}return[3,7];case 1:return[4,a];case 2:return b.sent(),
[3,7];case 3:e=0,d=a.features,b.label=4;case 4:return e<d.length?(f=d[e])?[4,f]:[3,6]:[3,7];case 5:b.sent(),b.label=6;case 6:return e++,[3,4];case 7:return[2]}})}function f(a){var c,e,d,f,g,n,h,q,k,p;return b.__generator(this,function(l){switch(l.label){case 0:if(!a)return[2,null];c=a.type;switch(c){case "Point":return[3,1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,
a.coordinates];case 2:return l.sent(),[3,17];case 3:return[5,b.__values(a.coordinates)];case 4:return l.sent(),[3,17];case 5:e=0,d=a.coordinates,l.label=6;case 6:if(!(e<d.length))return[3,9];f=d[e];return[5,b.__values(f)];case 7:l.sent(),l.label=8;case 8:return e++,[3,6];case 9:return[3,17];case 10:g=0,n=a.coordinates,l.label=11;case 11:if(!(g<n.length))return[3,16];h=n[g];q=0;k=h;l.label=12;case 12:if(!(q<k.length))return[3,15];p=k[q];return[5,b.__values(p)];case 13:l.sent(),l.label=14;case 14:return q++,
[3,12];case 15:return g++,[3,11];case 16:return[3,17];case 17:return[2]}})}function c(a,c){var e,d,f,g,n,q,p,l,t,u;void 0===c&&(c={});return b.__generator(this,function(b){switch(b.label){case 0:e=c.geometryType,d=c.objectIdFieldName,b.label=1;case 1:f=a.next();g=f.value;if(n=f.done)return[2];q=g.geometry;p=g.properties;l=g.id;if(q&&y[q.type]!==e)return[3,1];t=p||{};d&&null!=l&&!t[d]&&(t[d]=l);u=new k.default(q?x(new h.default,q,c):null,t);return[4,u];case 2:return b.sent(),[3,1];case 3:return[2]}})}
function e(a){for(;;){var c=a.next();if(c.done)return!1;if(2<c.value.length)return!0}}function n(a){for(var c=0,b=0;b<a.length;b++)var e=a[b],d=a[(b+1)%a.length],c=c+(e[0]*d[1]-d[0]*e[1]);return 0>=c}function t(a){var c=a[0],b=a[a.length-1];c[0]===b[0]&&c[1]===b[1]&&c[2]===b[2]||a.push(c);return a}function x(a,c,b){switch(c.type){case "LineString":return p(a,c.coordinates,b),a;case "MultiLineString":var e=0;for(c=c.coordinates;e<c.length;e++)p(a,c[e],b);return a;case "MultiPoint":return p(a,c.coordinates,
b),a;case "MultiPolygon":e=0;for(c=c.coordinates;e<c.length;e++){var d=c[e],f=a,g=b,h=t(d[0]);n(h)?p(f,h,g):q(f,h,g);for(f=1;f<d.length;f++){var g=a,h=b,k=t(d[f]);n(k)?q(g,k,h):p(g,k,h)}}return a;case "Point":return u(a,c.coordinates,b),a;case "Polygon":e=c.coordinates;c=t(e[0]);n(c)?p(a,c,b):q(a,c,b);for(c=1;c<e.length;c++)d=a,f=b,g=t(e[c]),n(g)?q(d,g,f):p(d,g,f);return a}}function p(a,c,b){for(var e=0;e<c.length;e++)u(a,c[e],b);a.lengths.push(c.length)}function q(a,c,b){for(var e=c.length-1;0<=
e;e--)u(a,c[e],b);a.lengths.push(c.length)}function u(a,c,b){var e=c[2];a.coords.push(c[0],c[1]);b.hasZ&&a.coords.push(e||0)}Object.defineProperty(a,"__esModule",{value:!0});a.createOptimizedFeatures=a.inferLayerProperties=a.validateGeoJSON=void 0;var y={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};a.validateGeoJSON=function(a){if(!a)throw new l("geojson-layer:empty",
"GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new l("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});if(a=a.crs){var c="string"===typeof a?a:"name"===a.type?a.properties.name:null,b=/.*(CRS84H?|4326)$/i;if(!c||!b.test(c))throw new l("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:a});}};a.inferLayerProperties=function(a,c){void 0===c&&(c={});var b=d(a),n=[],h=new Set,q=new Set,k=!1,p=Number.NEGATIVE_INFINITY,
l=null,t=!1,u=void 0;a=c.geometryType;var w=void 0===a?null:a,x=!1;for(a=function(){var a=b.next(),c=a.value;if(a.done){var d=l&&1===l.length&&l[0]||null;if(d)for(c=0;c<n.length;c++)a=n[c],a.name===d&&(a.type="esriFieldTypeOID");return{value:{fields:n,geometryType:w,hasZ:k,maxObjectId:Math.max(0,p),objectIdFieldName:d,objectIdFieldType:u,unknownFields:g(q)}}}var a=c.geometry,m=c.properties,C=c.id;if(a&&(w||(w=y[a.type]),y[a.type]!==w))return"continue";k||(c=f(a),k=e(c));!t&&(t=null!=C)&&(u=typeof C,
"number"===u&&(l=Object.keys(m).filter(function(a){return m[a]===C})));t&&"number"===u&&null!=C&&(p=Math.max(p,C),1<l.length?l=l.filter(function(a){return m[a]===C}):1===l.length&&(l=m[l[0]]===C?l:[]));if(!x&&m){c=!0;for(d in m)if(!h.has(d))if(a=m[d],null==a)c=!1,q.add(d);else{a:switch(typeof a){case "string":a="esriFieldTypeString";break a;case "number":a="esriFieldTypeDouble";break a;default:a="unknown"}"unknown"===a?q.add(d):(q.delete(d),h.add(d),n.push({name:d,alias:d,type:a}))}x=c}};;)if(c=a(),
"object"===typeof c)return c.value};a.createOptimizedFeatures=function(a,b){a:for(a=c(d(a),b),b=[];;){var e=a.next(),f=e.value;if(e.done)break a;b.push(f)}return b}})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports tslib ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.createDefaultTemplate=a.createDefaultAttributesFunction=a.createDrawingInfo=
void 0;a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?h.defaultPointSymbolJSON:"esriGeometryPolyline"===a?h.defaultPolylineSymbolJSON:h.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,d){if(l("csp-restrictions"))return function(){var c;return b.__assign((c={},c[d]=null,c),a)};try{var f="this."+d+" \x3d null;",c;for(c in a)var e=c.indexOf(".")?'["'+c+'"]':"."+c,f=f+("this"+e+" \x3d "+JSON.stringify(a[c])+
";");var g=new Function(f);return function(){return new g}}catch(t){return function(){var c;return b.__assign((c={},c[d]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:k.clone(a)}}]}})},"esri/symbols/support/defaultsJSON":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.errorPolygonSymbolJSON=a.errorPolylineSymbolJSON=a.errorPointSymbolJSON=a.defaultTextSymbolJSON=
a.defaultPolygonSymbolJSON=a.defaultPolylineSymbolJSON=a.defaultPointSymbolJSON=a.defaultOutlineColor=a.defaultColor=void 0;a.defaultColor=[252,146,31,255];a.defaultOutlineColor=[153,153,153,255];a.defaultPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",size:6,color:a.defaultColor,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}};a.defaultPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",width:.75,color:a.defaultColor};a.defaultPolygonSymbolJSON={type:"esriSFS",
style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};a.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};a.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};a.errorPolylineSymbolJSON={type:"esriSLS",
style:"esriSLSSolid",color:[0,0,0,255],width:1.5};a.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}})},"esri/tasks/support/FeatureSet":function(){define("require exports tslib ../../geometry ../../Graphic ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators ../../geometry/SpatialReference ../../geometry/support/jsonUtils ../../layers/support/Field".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n){var t=new h.default({esriGeometryPoint:"point",
esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});m=function(a){function g(c){c=a.call(this,c)||this;c.displayFieldName=null;c.exceededTransferLimit=!1;c.features=[];c.fields=null;c.geometryType=null;c.hasM=!1;c.hasZ=!1;c.queryGeometry=null;c.spatialReference=null;return c}b.__extends(g,a);g.prototype.readFeatures=function(a,b){b=c.fromJSON(b.spatialReference);for(var e=[],f=0;f<a.length;f++){var g=
a[f],n=k.fromJSON(g),g=g.geometry&&g.geometry.spatialReference;d.isSome(n.geometry)&&!g&&(n.geometry.spatialReference=b);e.push(n)}return e};g.prototype.writeGeometryType=function(a,c,b,e){if(a)t.write(a,c,b,e);else if(a=this.features)for(var f=0;f<a.length;f++){var g=a[f];if(g&&d.isSome(g.geometry)){t.write(g.geometry.type,c,b,e);break}}};g.prototype.writeSpatialReference=function(a,c){if(a)c.spatialReference=a.toJSON();else if(a=this.features)for(var b=0;b<a.length;b++){var e=a[b];e&&d.isSome(e.geometry)&&
e.geometry.spatialReference&&(c.spatialReference=e.geometry.spatialReference.toJSON())}};g.prototype.toJSON=function(a){var c=this.write(null);if(c.features&&Array.isArray(a)&&0<a.length)for(var b=0;b<c.features.length;b++){var e=c.features[b];if(e.geometry){var d=a&&a[b];e.geometry=d&&d.toJSON()||e.geometry}}return c};g.prototype.quantize=function(a){for(var c=a.scale,b=c[0],e=c[1],c=a.translate,f=c[0],g=c[1],c=this.features,n=this._getQuantizationFunction(this.geometryType,function(a){return Math.round((a-
f)/b)},function(a){return Math.round((g-a)/e)}),h=0,k=c.length;h<k;h++)n(d.unwrap(c[h].geometry))||(c.splice(h,1),h--,k--);this.transform=a;return this};g.prototype.unquantize=function(){var a=this.features,c=this.transform;if(!c)return this;for(var b=c.translate,e=b[0],f=b[1],c=c.scale,g=c[0],n=c[1],c=this._getHydrationFunction(this.geometryType,function(a){return a*g+e},function(a){return f-a*n}),b=0;b<a.length;b++){var h=a[b].geometry;d.isSome(h)&&c(h)}this.transform=null;return this};g.prototype._quantizePoints=
function(a,c,b){for(var e,d,f=[],g=0,n=a.length;g<n;g++){var h=a[g];if(0<g){var k=c(h[0]),h=b(h[1]);if(k!==e||h!==d)f.push([k-e,h-d]),e=k,d=h}else e=c(h[0]),d=b(h[1]),f.push([e,d])}return 0<f.length?f:null};g.prototype._getQuantizationFunction=function(a,c,b){var d=this;return"point"===a?function(a){a.x=c(a.x);a.y=b(a.y);return a}:"polyline"===a||"polygon"===a?function(a){for(var f=e.isPolygon(a)?a.rings:a.paths,g=[],n=0,h=f.length;n<h;n++){var k=d._quantizePoints(f[n],c,b);k&&g.push(k)}return 0<
g.length?(e.isPolygon(a)?a.rings=g:a.paths=g,a):null}:"multipoint"===a?function(a){var e;e=d._quantizePoints(a.points,c,b);return 0<e.length?(a.points=e,a):null}:"extent"===a?function(a){return a}:null};g.prototype._getHydrationFunction=function(a,c,b){if("point"===a)return function(a){a.x=c(a.x);a.y=b(a.y)};if("polyline"===a||"polygon"===a)return function(a){a=e.isPolygon(a)?a.rings:a.paths;for(var d,f,g=0,n=a.length;g<n;g++)for(var h=a[g],k=0,q=h.length;k<q;k++){var p=h[k];0<k?(d+=p[0],f+=p[1]):
(d=p[0],f=p[1]);p[0]=c(d);p[1]=b(f)}};if("extent"===a)return function(a){a.xmin=c(a.xmin);a.ymin=b(a.ymin);a.xmax=c(a.xmax);a.ymax=b(a.ymax)};if("multipoint"===a)return function(a){a=a.points;for(var e,d,f=0,g=a.length;f<g;f++){var n=a[f];0<f?(e+=n[0],d+=n[1]):(e=n[0],d=n[1]);n[0]=c(e);n[1]=b(d)}}};b.__decorate([f.property({type:String,json:{write:!0}})],g.prototype,"displayFieldName",void 0);b.__decorate([f.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],g.prototype,
"exceededTransferLimit",void 0);b.__decorate([f.property({type:[k],json:{write:!0}})],g.prototype,"features",void 0);b.__decorate([f.reader("features")],g.prototype,"readFeatures",null);b.__decorate([f.property({type:[n],json:{write:!0}})],g.prototype,"fields",void 0);b.__decorate([f.property({type:"point multipoint polyline polygon extent mesh".split(" "),json:{read:{reader:t.read}}})],g.prototype,"geometryType",void 0);b.__decorate([f.writer("geometryType")],g.prototype,"writeGeometryType",null);
b.__decorate([f.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],g.prototype,"hasM",void 0);b.__decorate([f.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],g.prototype,"hasZ",void 0);b.__decorate([f.property({types:l.geometryTypes,json:{read:e.fromJSON,write:!0}})],g.prototype,"queryGeometry",void 0);b.__decorate([f.property({type:c,json:{write:!0}})],g.prototype,"spatialReference",void 0);b.__decorate([f.writer("spatialReference")],
g.prototype,"writeSpatialReference",null);b.__decorate([f.property({json:{write:!0}})],g.prototype,"transform",void 0);return g=b.__decorate([f.subclass("esri.tasks.support.FeatureSet")],g)}(g.JSONSupport);m.prototype.toJSON.isDefaultToJSON=!0;(function(a){})(m||(m={}));return m})},"esri/Graphic":function(){define("require exports tslib ./geometry ./PopupTemplate ./symbols ./core/JSONSupport ./core/lang ./core/maybe ./core/uid ./core/accessorSupport/decorators ./geometry/support/jsonUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){m=function(a){function g(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];b=a.apply(this,b)||this;b.layer=null;b.popupTemplate=null;b.sourceLayer=null;Object.defineProperty(b,"uid",{value:c.generateUID(),configurable:!0});return b}b.__extends(g,a);p=g;g.prototype.normalizeCtorArgs=function(a,c,b,e){return a&&!a.declaredClass?a:{geometry:a,symbol:c,attributes:b,popupTemplate:e}};Object.defineProperty(g.prototype,"attributes",{set:function(a){var c=this._get("attributes");
c!==a&&(this._set("attributes",a),this._notifyLayer("attributes",c,a))},enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,"geometry",{set:function(a){var c=this._get("geometry");c!==a&&(this._set("geometry",a),this._notifyLayer("geometry",c,a))},enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,"symbol",{set:function(a){var c=this._get("symbol");c!==a&&(this._set("symbol",a),this._notifyLayer("symbol",c,a))},enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,
"visible",{set:function(a){var c=this._get("visible");c!==a&&(this._set("visible",a),this._notifyLayer("visible",c,a))},enumerable:!1,configurable:!0});g.prototype.getEffectivePopupTemplate=function(a){void 0===a&&(a=!1);return this.popupTemplate?this.popupTemplate:this.sourceLayer?"popupTemplate"in this.sourceLayer&&this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:a&&"defaultPopupTemplate"in this.sourceLayer&&f.isSome(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:
null:null};g.prototype.getAttribute=function(a){return this.attributes&&this.attributes[a]};g.prototype.setAttribute=function(a,c){var b;this.attributes?(b=this.getAttribute(a),this.attributes[a]=c,this._notifyLayer("attributes",b,c,a)):(this.attributes=(b={},b[a]=c,b),this._notifyLayer("attributes",void 0,c,a))};g.prototype.getObjectId=function(){return this.sourceLayer?"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null:null};
g.prototype.toJSON=function(){return{geometry:f.isSome(this.geometry)?this.geometry.toJSON():null,symbol:f.isSome(this.symbol)?this.symbol.toJSON():null,attributes:b.__assign({},this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}};g.prototype.clone=function(){return new p(this.cloneProperties())};g.prototype.cloneProperties=function(){return{attributes:d.clone(this.attributes),geometry:d.clone(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),
sourceLayer:this.sourceLayer,symbol:d.clone(this.symbol),visible:this.visible}};g.prototype._notifyLayer=function(a,c,b,e){this.layer&&"graphicChanged"in this.layer&&(c={graphic:this,property:a,oldValue:c,newValue:b},"attributes"===a&&(c.attributeName=e),this.layer.graphicChanged(c))};var p;b.__decorate([e.property({value:null})],g.prototype,"attributes",null);b.__decorate([e.property({value:null,types:l.geometryTypes,json:{read:n.fromJSON}})],g.prototype,"geometry",null);b.__decorate([e.property()],
g.prototype,"layer",void 0);b.__decorate([e.property({type:k})],g.prototype,"popupTemplate",void 0);b.__decorate([e.property()],g.prototype,"sourceLayer",void 0);b.__decorate([e.property({value:null,types:h.symbolTypes})],g.prototype,"symbol",null);b.__decorate([e.property({type:Boolean,value:!0})],g.prototype,"visible",null);return g=p=b.__decorate([e.subclass("esri.Graphic")],g)}(g.JSONSupport);(m||(m={})).generateUID=c.generateUID;return m})},"esri/PopupTemplate":function(){define("require exports tslib ./core/arrayUtils ./core/Collection ./core/JSONSupport ./core/lang ./core/Logger ./core/promiseUtils ./core/SetUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./layers/support/fieldUtils ./popup/content ./popup/ExpressionInfo ./popup/FieldInfo ./popup/LayerOptions ./popup/RelatedRecordsInfo ./popup/content/AttachmentsContent ./popup/content/Content ./popup/content/CustomContent ./popup/content/FieldsContent ./popup/content/MediaContent ./popup/content/TextContent ./popup/content/support/mediaInfoTypes ./support/actions/ActionBase ./support/actions/ActionButton ./support/actions/ActionToggle".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z,A,C,E,D,F,H,I){var G=k.ofType({key:"type",defaultKeyValue:"button",base:F,typeMap:{button:H,toggle:I}}),K={base:B,key:"type",typeMap:{media:C,custom:z,text:E,attachments:w,fields:A}},L=d.getLogger("esri.PopupTemplate"),O=["attachments","fields","media","text"];return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.actions=null;c.content="";c.expressionInfos=null;c.fieldInfos=null;c.layerOptions=null;c.lastEditInfoEnabled=
!0;c.outFields=null;c.overwriteActions=!1;c.title="";c.relatedRecordsInfo=null;return c}b.__extends(d,a);h=d;d.prototype.castContent=function(a){if(Array.isArray(a))return a.map(function(a){return n.ensureOneOfType(K,a)});if("string"===typeof a||"function"===typeof a||a instanceof HTMLElement||f.isPromiseLike(a))return a;L.error("content error","unsupported content value",{value:a});return null};d.prototype.readContent=function(a,c){a=c.popupElements;return Array.isArray(a)&&0<a.length?this._readPopupInfoElements(c):
this._readPopupInfo(c)};d.prototype.writeContent=function(a,c){var b=this;"string"===typeof a?c.description=a:Array.isArray(a)&&(c.popupElements=a.filter(function(a){return-1!==O.indexOf(a.type)}).map(function(a){return a&&a.toJSON()}),c.popupElements.forEach(function(a){"attachments"===a.type?b._writeAttachmentContent(c):"media"===a.type?b._writeMediaContent(a,c):"text"===a.type&&b._writeTextContent(a,c)}))};d.prototype.writeFieldInfos=function(a,c){var b=this.content,b=Array.isArray(b)?b:null;if(a){var e=
b?b.some(function(a){return"fields"===a.type&&(!a.fieldInfos||0===a.fieldInfos.length)}):!1;c.fieldInfos=a.filter(Boolean).map(function(a){a=a.toJSON();e||(a.visible=!1);return a})}if(b)for(a=0;a<b.length;a++){var d=b[a];"fields"===d.type&&this._writeFieldsContent(d,c)}};d.prototype.writeLayerOptions=function(a,c){c.layerOptions=!a||null===a.showNoDataRecords&&null===a.returnTopmostRaster?null:a.toJSON()};d.prototype.writeTitle=function(a,c){c.title=a||""};d.prototype.clone=function(){var a=this.actions,
a=a?g.clone(a.toArray()):[];return new h({actions:a,content:Array.isArray(this.content)?g.clone(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?g.clone(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?g.clone(this.fieldInfos):null,layerOptions:this.layerOptions?g.clone(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?g.clone(this.outFields):null,overwriteActions:this.overwriteActions,title:this.title,
relatedRecordsInfo:this.relatedRecordsInfo?g.clone(this.relatedRecordsInfo):null})};d.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(e){switch(e.label){case 0:return[4,this._collectExpressionInfoFields(a,c,this.expressionInfos)];case 1:return e.sent(),t.collectFields(a,c,b.__spreadArrays(this.outFields||[],this._getActionsFields(this.actions),this._getTitleFields(this.title),this._getContentFields(this.content))),[2]}})})};
d.prototype.getRequiredFields=function(a){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return e=new Set,[4,this.collectRequiredFields(e,a)];case 1:return b.sent(),[2,c.valuesOfSet(e).sort()]}})})};d.prototype._writeFieldsContent=function(a,c){Array.isArray(a.fieldInfos)&&a.fieldInfos.length&&(a=g.clone(a.fieldInfos),Array.isArray(c.fieldInfos)?a.forEach(function(a){var b=l.find(c.fieldInfos,function(c){return c.fieldName.toLowerCase()===
a.fieldName.toLowerCase()});b?b.visible=!0:c.fieldInfos.push(a)}):c.fieldInfos=a)};d.prototype._writeAttachmentContent=function(a){a.showAttachments||(a.showAttachments=!0)};d.prototype._writeTextContent=function(a,c){!c.description&&a.text&&(c.description=a.text)};d.prototype._writeMediaContent=function(a,c){Array.isArray(a.mediaInfos)&&a.mediaInfos.length&&(a=g.clone(a.mediaInfos),Array.isArray(c.mediaInfos)?c.mediaInfos=b.__spreadArrays(c.mediaInfos,a):c.mediaInfos=a)};d.prototype._readPopupInfoElements=
function(a){var c=a.description,b=a.mediaInfos,e=!1,d=!1;return a.popupElements.map(function(a){if("media"===a.type)return a.mediaInfos||!b||d||(a.mediaInfos=b,d=!0),C.fromJSON(a);if("text"===a.type)return a.text||!c||e||(a.text=c,e=!0),E.fromJSON(a);if("attachments"===a.type)return w.fromJSON(a);if("fields"===a.type)return A.fromJSON(a)}).filter(Boolean)};d.prototype._readPopupInfo=function(a){var c=a.description,b=a.mediaInfos;a=a.showAttachments;var e=[];c?e.push(new E({text:c})):e.push(new A);
Array.isArray(b)&&b.length&&e.push(C.fromJSON({mediaInfos:b}));a&&e.push(w.fromJSON({displayType:"list"}));return e.length?e:c};d.prototype._getContentElementFields=function(a){var c=this;if(!a||"attachments"===a.type)return[];if("custom"===a.type)return a.outFields||[];if("fields"===a.type)return this._getFieldInfoFields(a.fieldInfos||this.fieldInfos);if("media"===a.type)return(a.mediaInfos||[]).reduce(function(a,e){return b.__spreadArrays(a,c._getMediaInfoFields(e))},[]);if("text"===a.type)return this._extractFieldNames(a.text)};
d.prototype._getMediaInfoFields=function(a){var c=a.caption,e=a.value||{},d=e.fields,f=void 0===d?[]:d,d=e.normalizeField,g=e.tooltipField,n=e.sourceURL,e=e.linkURL;a=b.__spreadArrays(this._extractFieldNames(a.title),this._extractFieldNames(c),this._extractFieldNames(n),this._extractFieldNames(e),f);d&&a.push(d);g&&a.push(g);return a};d.prototype._getContentFields=function(a){var c=this;return"string"===typeof a?this._extractFieldNames(a):Array.isArray(a)?a.reduce(function(a,e){return b.__spreadArrays(a,
c._getContentElementFields(e))},[]):[]};d.prototype._collectExpressionInfoFields=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){switch(b.label){case 0:return e?[4,f.all(e.map(function(b){return t.collectArcadeFieldNames(a,c,b.expression)}))]:[2];case 1:return b.sent(),[2]}})})};d.prototype._getFieldInfoFields=function(a){return a?a.filter(function(a){return"undefined"===typeof a.visible?!0:!!a.visible}).map(function(a){return a.fieldName}).filter(function(a){return-1===
a.indexOf("relationships/")&&-1===a.indexOf("expression/")}):[]};d.prototype._getActionsFields=function(a){var c=this;return a?a.toArray().reduce(function(a,e){return b.__spreadArrays(a,c._getActionFields(e))},[]):[]};d.prototype._getActionFields=function(a){var c=a.className,e=a.type,e="button"===e||"toggle"===e?a.image:"";return b.__spreadArrays(this._extractFieldNames(a.title),this._extractFieldNames(c),this._extractFieldNames(e))};d.prototype._getTitleFields=function(a){return"string"===typeof a?
this._extractFieldNames(a):[]};d.prototype._extractFieldNames=function(a){if(!a||"string"!==typeof a)return[];a=a.match(/{[^}]*}/g);if(!a)return[];var c=/\{(\w+):.+\}/;return(a=a.filter(function(a){return!(0===a.indexOf("{relationships/")||0===a.indexOf("{expression/"))}).map(function(a){return a.replace(c,"{$1}")}))?a.map(function(a){return a.slice(1,-1)}):[]};var h;b.__decorate([e.property({type:G})],d.prototype,"actions",void 0);b.__decorate([e.property()],d.prototype,"content",void 0);b.__decorate([e.cast("content")],
d.prototype,"castContent",null);b.__decorate([e.reader("content",["description","popupElements","mediaInfos","showAttachments"])],d.prototype,"readContent",null);b.__decorate([e.writer("content",{popupElements:{type:k.ofType(x.persistableTypes)},showAttachments:{type:Boolean},mediaInfos:{type:k.ofType(D.types)},description:{type:String}})],d.prototype,"writeContent",null);b.__decorate([e.property({type:[p],json:{write:!0}})],d.prototype,"expressionInfos",void 0);b.__decorate([e.property({type:[q]})],
d.prototype,"fieldInfos",void 0);b.__decorate([e.writer("fieldInfos")],d.prototype,"writeFieldInfos",null);b.__decorate([e.property({type:u})],d.prototype,"layerOptions",void 0);b.__decorate([e.writer("layerOptions")],d.prototype,"writeLayerOptions",null);b.__decorate([e.property({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],d.prototype,"lastEditInfoEnabled",void 0);b.__decorate([e.property()],d.prototype,"outFields",void 0);b.__decorate([e.property()],
d.prototype,"overwriteActions",void 0);b.__decorate([e.property({json:{type:String}})],d.prototype,"title",void 0);b.__decorate([e.writer("title")],d.prototype,"writeTitle",null);b.__decorate([e.property({type:y,json:{write:!0}})],d.prototype,"relatedRecordsInfo",void 0);return d=h=b.__decorate([e.subclass("esri.PopupTemplate")],d)}(h.JSONSupport)})},"esri/popup/content":function(){define("require exports ./content/AttachmentsContent ./content/Content ./content/CustomContent ./content/FieldsContent ./content/MediaContent ./content/TextContent".split(" "),
function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.persistableTypes=a.isContent=a.TextContent=a.MediaContent=a.FieldsContent=a.CustomContent=a.BaseContent=a.AttachmentsContent=void 0;a.AttachmentsContent=b;a.BaseContent=l;a.CustomContent=k;a.FieldsContent=h;a.MediaContent=g;a.TextContent=d;a.isContent=function(a){return a instanceof l};a.persistableTypes={base:null,key:"type",typeMap:{attachment:b,media:g,text:d,field:h}}})},"esri/popup/content/AttachmentsContent":function(){define(["require",
"exports","tslib","../../core/accessorSupport/decorators","./Content"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.displayType=null;b.type="attachments";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({displayType:this.displayType})};var d;b.__decorate([l.property({type:["preview","list"],json:{write:!0}})],g.prototype,"displayType",void 0);b.__decorate([l.property({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",
void 0);return g=d=b.__decorate([l.subclass("esri.popup.content.AttachmentsContent")],g)}(k)})},"esri/popup/content/Content":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type=null;return b}b.__extends(g,a);b.__decorate([k.property({type:["attachments","custom","fields","media","text"],readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=
b.__decorate([k.subclass("esri.popup.content.Content")],g)}(l.JSONSupport)})},"esri/popup/content/CustomContent":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./Content".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.creator=null;c.destroyer=null;c.outFields=null;c.type="custom";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?
l.clone(this.outFields):null})};var f;b.__decorate([k.property()],d.prototype,"creator",void 0);b.__decorate([k.property()],d.prototype,"destroyer",void 0);b.__decorate([k.property()],d.prototype,"outFields",void 0);b.__decorate([k.property({type:["custom"],readOnly:!0})],d.prototype,"type",void 0);return d=f=b.__decorate([k.subclass("esri.popup.content.CustomContent")],d)}(h)})},"esri/popup/content/FieldsContent":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ../FieldInfo ./Content".split(" "),
function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.fieldInfos=null;c.type="fields";return c}b.__extends(d,a);c=d;d.prototype.writeFieldInfos=function(a,c){c.fieldInfos=a&&a.map(function(a){return a.toJSON()})};d.prototype.clone=function(){return new c({fieldInfos:Array.isArray(this.fieldInfos)?l.clone(this.fieldInfos):null})};var c;b.__decorate([k.property({type:[h]})],d.prototype,"fieldInfos",void 0);b.__decorate([k.writer("fieldInfos")],d.prototype,"writeFieldInfos",
null);b.__decorate([k.property({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=c=b.__decorate([k.subclass("esri.popup.content.FieldsContent")],d)}(g)})},"esri/popup/FieldInfo":function(){define("require exports tslib ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/FieldInfoFormat".split(" "),function(m,a,b,l,k,h,g,d){var f=new l.default({richtext:"rich-text",textarea:"text-area",textbox:"text-box"});return function(a){function c(c){c=
a.call(this,c)||this;c.fieldName=null;c.format=null;c.isEditable=!1;c.label=null;c.stringFieldOption="text-box";c.statisticType=null;c.tooltip=null;c.visible=!0;return c}b.__extends(c,a);n=c;c.prototype.writeStringFieldOption=function(a,c){c.stringFieldOption=f.toJSON(a)};c.prototype.readStringFieldOption=function(a){if(a)return f.fromJSON(a)};c.prototype.clone=function(){return new n({fieldName:this.fieldName,format:this.format?h.clone(this.format):null,isEditable:this.isEditable,label:this.label,
stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})};var n;b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"fieldName",void 0);b.__decorate([g.property({type:d,json:{write:!0}})],c.prototype,"format",void 0);b.__decorate([g.property({type:Boolean,json:{write:!0,default:!1}})],c.prototype,"isEditable",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);b.__decorate([g.property({type:f.apiValues,
json:{write:!0,default:"text-box",type:f.jsonValues}})],c.prototype,"stringFieldOption",void 0);b.__decorate([g.writer("stringFieldOption")],c.prototype,"writeStringFieldOption",null);b.__decorate([g.reader("stringFieldOption")],c.prototype,"readStringFieldOption",null);b.__decorate([g.property({type:"count sum min max avg stddev var".split(" "),json:{write:!0}})],c.prototype,"statisticType",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"tooltip",void 0);b.__decorate([g.property({type:Boolean,
json:{write:!0}})],c.prototype,"visible",void 0);return c=n=b.__decorate([g.subclass("esri.popup.FieldInfo")],c)}(k.JSONSupport)})},"esri/popup/support/FieldInfoFormat":function(){define("require exports tslib ../../core/date ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../intl/date ../../intl/number".split(" "),function(m,a,b,l,k,h,g,d,f){return function(a){function c(c){c=a.call(this,c)||this;c.dateFormat=null;c.digitSeparator=!1;c.places=
null;return c}b.__extends(c,a);n=c;c.prototype.clone=function(){return new n({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})};c.prototype.format=function(a){return this.dateFormat?d.formatDate(a,d.convertDateFormatToIntlOptions(this.dateFormat)):f.formatNumber(a,f.convertNumberFormatToIntlOptions(this))};var n;b.__decorate([h.enumeration(l.dictionary)],c.prototype,"dateFormat",void 0);b.__decorate([h.property({type:Boolean,json:{write:!0}})],c.prototype,"digitSeparator",
void 0);b.__decorate([h.property({type:g.Integer,json:{write:!0}})],c.prototype,"places",void 0);return c=n=b.__decorate([h.subclass("esri.popup.support.FieldInfoFormat")],c)}(k.JSONSupport)})},"esri/core/date":function(){define(["require","exports","./jsonMap"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.getFormat=a.fromJSON=a.toJSON=a.dictionary=a.formats=void 0;a.formats={"short-date":"(datePattern: 'M/d/y', selector: 'date')","short-date-short-time":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
"short-date-short-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","short-date-long-time":"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-long-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')","short-date-le":"(datePattern: 'd/M/y', selector: 'date')","short-date-le-short-time":"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-le-short-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",
"short-date-le-long-time":"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-le-long-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-day-year":"(datePattern: 'MMMM d, y', selector: 'date')","long-month-day-year-short-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-month-day-year-short-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",
"long-month-day-year-long-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')","long-month-day-year-long-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","day-short-month-year":"(datePattern: 'd MMM y', selector: 'date')","day-short-month-year-short-time":"(datePattern: 'd MMM y', timePattern: 'h:mm a', selector: 'date and time')","day-short-month-year-short-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm', selector: 'date and time')",
"day-short-month-year-long-time":"(datePattern: 'd MMM y', timePattern: 'h:mm:ss a', selector: 'date and time')","day-short-month-year-long-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm:ss', selector: 'date and time')","long-date":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","long-date-short-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-date-short-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",
"long-date-long-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')","long-date-long-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-year":"(datePattern: 'MMMM y', selector: 'date')","short-month-year":"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"};a.dictionary=b.strict()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",
shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",
longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",
longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a.toJSON=a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);a.getFormat=function(b){return a.formats[b]}})},"esri/popup/content/MediaContent":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./BarChartMediaInfo ./ColumnChartMediaInfo ./Content ./ImageMediaInfo ./LineChartMediaInfo ./PieChartMediaInfo ./support/mediaInfoTypes".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){return function(a){function d(c){c=a.call(this,c)||this;c.activeMediaInfoIndex=null;c.mediaInfos=null;c.type="media";return c}b.__extends(d,a);p=d;d.prototype.readMediaInfos=function(a){return a&&a.map(function(a){if("image"===a.type)return f.fromJSON(a);if("barchart"===a.type)return h.fromJSON(a);if("columnchart"===a.type)return g.fromJSON(a);if("linechart"===a.type)return c.fromJSON(a);if("piechart"===a.type)return e.fromJSON(a)}).filter(Boolean)};d.prototype.writeMediaInfos=
function(a,c){c.mediaInfos=a&&a.map(function(a){return a.toJSON()})};d.prototype.clone=function(){return new p({activeMediaInfoIndex:this.activeMediaInfoIndex,mediaInfos:this.mediaInfos?l.clone(this.mediaInfos):null})};var p;b.__decorate([k.property()],d.prototype,"activeMediaInfoIndex",void 0);b.__decorate([k.property({types:[n.types]})],d.prototype,"mediaInfos",void 0);b.__decorate([k.reader("mediaInfos")],d.prototype,"readMediaInfos",null);b.__decorate([k.writer("mediaInfos")],d.prototype,"writeMediaInfos",
null);b.__decorate([k.property({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=p=b.__decorate([k.subclass("esri.popup.content.MediaContent")],d)}(d)})},"esri/popup/content/BarChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.type="bar-chart";return c}b.__extends(d,a);
f=d;d.prototype.clone=function(){return new f({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var f;b.__decorate([l.property({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:h.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=f=b.__decorate([l.subclass("esri.popup.content.BarChartMediaInfo")],d)}(k)})},"esri/popup/content/mixins/ChartMediaInfo":function(){define("require exports tslib ../../../core/accessorSupport/decorators ./MediaInfo ../support/ChartMediaInfoValue".split(" "),
function(m,a,b,l,k,h){return function(a){function d(b){b=a.call(this,b)||this;b.type=null;b.value=null;return b}b.__extends(d,a);b.__decorate([l.property({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);b.__decorate([l.property({type:h,json:{write:!0}})],d.prototype,"value",void 0);return d=b.__decorate([l.subclass("esri.popup.content.mixins.ChartMediaInfo")],d)}(k)})},"esri/popup/content/mixins/MediaInfo":function(){define(["require",
"exports","tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.altText=null;b.caption="";b.title="";b.type=null;return b}b.__extends(g,a);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"altText",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"caption",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"title",void 0);
b.__decorate([k.property({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=b.__decorate([k.subclass("esri.popup.content.mixins.MediaInfo")],g)}(l.JSONSupport)})},"esri/popup/content/support/ChartMediaInfoValue":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/lang ../../../core/accessorSupport/decorators ./ChartMediaInfoValueSeries".split(" "),function(m,a,b,l,k,h,g){return function(a){function d(c){c=
a.call(this,c)||this;c.fields=[];c.normalizeField=null;c.series=[];c.tooltipField=null;return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({fields:k.clone(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})};var c;b.__decorate([h.property({type:[String],json:{write:!0}})],d.prototype,"fields",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"normalizeField",void 0);b.__decorate([h.property({type:[g],json:{read:!1}})],d.prototype,
"series",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"tooltipField",void 0);return d=c=b.__decorate([h.subclass("esri.popup.content.support.ChartMediaInfoValue")],d)}(l.JSONSupport)})},"esri/popup/content/support/ChartMediaInfoValueSeries":function(){define(["require","exports","tslib","../../../core/Accessor","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.tooltip=null;b.value=null;b.x=null;
b.y=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({tooltip:this.tooltip,value:this.value})};var d;b.__decorate([k.property()],g.prototype,"tooltip",void 0);b.__decorate([k.property()],g.prototype,"value",void 0);b.__decorate([k.aliasOf("value")],g.prototype,"x",void 0);b.__decorate([k.aliasOf("tooltip")],g.prototype,"y",void 0);return g=d=b.__decorate([k.subclass("esri.popup.content.support.ChartMediaInfoValueSeries")],g)}(l)})},"esri/popup/content/support/chartMediaInfoUtils":function(){define(["require",
"exports","../../../core/jsonMap"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.chartTypeKebabDict=void 0;a.chartTypeKebabDict=b.strict()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"})})},"esri/popup/content/ColumnChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=
a.call(this,c)||this;c.type="column-chart";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var f;b.__decorate([l.property({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:h.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=f=b.__decorate([l.subclass("esri.popup.content.ColumnChartMediaInfo")],d)}(k)})},"esri/popup/content/ImageMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/MediaInfo ./support/ImageMediaInfoValue".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.refreshInterval=null;c.type="image";c.value=null;return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})};var f;b.__decorate([l.property({type:Number,json:{write:!0}})],d.prototype,"refreshInterval",void 0);b.__decorate([l.property({type:["image"],readOnly:!0,json:{read:!1,
write:!0}})],d.prototype,"type",void 0);b.__decorate([l.property({type:h,json:{write:!0}})],d.prototype,"value",void 0);return d=f=b.__decorate([l.subclass("esri.popup.content.ImageMediaInfo")],d)}(k)})},"esri/popup/content/support/ImageMediaInfoValue":function(){define(["require","exports","tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.linkURL=null;b.sourceURL=null;return b}b.__extends(g,
a);d=g;g.prototype.clone=function(){return new d({linkURL:this.linkURL,sourceURL:this.sourceURL})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"linkURL",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"sourceURL",void 0);return g=d=b.__decorate([k.subclass("esri.popup.content.support.ImageMediaInfoValue")],g)}(l.JSONSupport)})},"esri/popup/content/LineChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.type="line-chart";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var f;b.__decorate([l.property({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:h.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=f=b.__decorate([l.subclass("esri.popup.content.LineChartMediaInfo")],
d)}(k)})},"esri/popup/content/PieChartMediaInfo":function(){define("require exports tslib ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.type="pie-chart";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var f;b.__decorate([l.property({type:["pie-chart"],
readOnly:!0,json:{type:["piechart"],read:!1,write:h.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=f=b.__decorate([l.subclass("esri.popup.content.PieChartMediaInfo")],d)}(k)})},"esri/popup/content/support/mediaInfoTypes":function(){define("require exports ../BarChartMediaInfo ../ColumnChartMediaInfo ../ImageMediaInfo ../LineChartMediaInfo ../PieChartMediaInfo ../mixins/MediaInfo".split(" "),function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.types=void 0;
a.types={base:d,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":b,"column-chart":l,"line-chart":h,"pie-chart":g,image:k}};a.default=a.types})},"esri/popup/content/TextContent":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Content"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.text=null;b.type="text";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({text:this.text})};var d;b.__decorate([l.property({type:String,
json:{write:!0}})],g.prototype,"text",void 0);b.__decorate([l.property({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.popup.content.TextContent")],g)}(k)})},"esri/popup/ExpressionInfo":function(){define(["require","exports","tslib","../core/JSONSupport","../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.name=null;b.title=null;b.expression=null;b.returnType=null;
return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"name",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"title",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"expression",void 0);b.__decorate([k.property({type:["string","number"],json:{write:!0}})],g.prototype,
"returnType",void 0);return g=d=b.__decorate([k.subclass("esri.popup.ExpressionInfo")],g)}(l.JSONSupport)})},"esri/popup/LayerOptions":function(){define(["require","exports","tslib","../core/JSONSupport","../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.returnTopmostRaster=null;b.showNoDataRecords=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})};
var d;b.__decorate([k.property({type:Boolean,json:{write:!0}})],g.prototype,"returnTopmostRaster",void 0);b.__decorate([k.property({type:Boolean,json:{write:!0}})],g.prototype,"showNoDataRecords",void 0);return g=d=b.__decorate([k.subclass("esri.popup.LayerOptions")],g)}(l.JSONSupport)})},"esri/popup/RelatedRecordsInfo":function(){define("require exports tslib ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/RelatedRecordsInfoFieldOrder".split(" "),function(m,a,b,l,k,
h,g){return function(a){function d(c){c=a.call(this,c)||this;c.showRelatedRecords=null;c.orderByFields=null;return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?k.clone(this.orderByFields):null})};var c;b.__decorate([h.property({type:Boolean,json:{write:!0}})],d.prototype,"showRelatedRecords",void 0);b.__decorate([h.property({type:[g],json:{write:!0}})],d.prototype,"orderByFields",void 0);return d=c=b.__decorate([h.subclass("esri.popup.RelatedRecordsInfo")],
d)}(l.JSONSupport)})},"esri/popup/support/RelatedRecordsInfoFieldOrder":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.field=null;b.order=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({field:this.field,order:this.order})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"field",void 0);b.__decorate([k.property({type:["asc",
"desc"],json:{write:!0}})],g.prototype,"order",void 0);return g=d=b.__decorate([k.subclass("esri.popup.support.RelatedRecordsInfoFieldOrder")],g)}(l.JSONSupport)})},"esri/support/actions/ActionBase":function(){define("require exports tslib ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.active=!1;c.className=null;c.disabled=!1;c.id=null;c.indicator=!1;c.title=null;c.type=null;
c.visible=!0;return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})};var f;b.__decorate([h.property()],d.prototype,"active",void 0);b.__decorate([h.property()],d.prototype,"className",void 0);b.__decorate([h.property()],d.prototype,"disabled",void 0);b.__decorate([h.property()],d.prototype,"id",void 0);b.__decorate([h.property()],d.prototype,
"indicator",void 0);b.__decorate([h.property()],d.prototype,"title",void 0);b.__decorate([h.property()],d.prototype,"type",void 0);b.__decorate([h.property()],d.prototype,"visible",void 0);return d=f=b.__decorate([h.subclass("esri.support.actions.ActionBase")],d)}(k.IdentifiableMixin(l))})},"esri/core/Identifiable":function(){define(["require","exports","tslib","./accessorSupport/decorators/subclass"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.Identifiable=a.IdentifiableMixin=
void 0;var k=0;a.IdentifiableMixin=function(a){return function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;Object.defineProperty(b,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+k++});return b}b.__extends(d,a);return d=b.__decorate([l.subclass("esri.core.Identifiable")],d)}(a)};m=function(a){function g(){return null!==a&&a.apply(this,arguments)||this}b.__extends(g,a);return g=b.__decorate([l.subclass("esri.core.Identifiable")],
g)}(a.IdentifiableMixin(function(){return function(){}}()));a.Identifiable=m})},"esri/support/actions/ActionButton":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./ActionBase"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.image=null;b.type="button";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,
visible:this.visible,image:this.image})};var d;b.__decorate([l.property()],g.prototype,"image",void 0);return g=d=b.__decorate([l.subclass("esri.support.Action.ActionButton")],g)}(k)})},"esri/support/actions/ActionToggle":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./ActionBase"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.image=null;b.type="toggle";b.value=!1;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({active:this.active,
className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})};var d;b.__decorate([l.property()],g.prototype,"image",void 0);b.__decorate([l.property()],g.prototype,"value",void 0);return g=d=b.__decorate([l.subclass("esri.support.Action.ActionToggle")],g)}(k)})},"esri/core/uid":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.generateUID=void 0;var b=
0;a.generateUID=function(){return b++}})},"esri/tasks/operations/query":function(){define("require exports tslib ../../request ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/normalizeUtils ./pbfQueryUtils ./queryZScale ./urlUtils @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n){function t(a,c){var b=a.geometry;a=a.toJSON();b&&(a.geometry=JSON.stringify(b),a.geometryType=d.getJsonType(b),a.inSR=b.spatialReference.wkid||
JSON.stringify(b.spatialReference));a.groupByFieldsForStatistics&&(a.groupByFieldsForStatistics=a.groupByFieldsForStatistics.join(","));a.objectIds&&(a.objectIds=a.objectIds.join(","));a.orderByFields&&(a.orderByFields=a.orderByFields.join(","));!a.outFields||!a.returnDistinctValues&&((null===c||void 0===c?0:c.returnCountOnly)||(null===c||void 0===c?0:c.returnExtentOnly)||(null===c||void 0===c?0:c.returnIdsOnly))?delete a.outFields:-1!==a.outFields.indexOf("*")?a.outFields="*":a.outFields=a.outFields.join(",");
a.outSR?a.outSR=a.outSR.wkid||JSON.stringify(a.outSR):b&&(a.returnGeometry||a.returnCentroid)&&(a.outSR=a.inSR);a.returnGeometry&&delete a.returnGeometry;a.outStatistics&&(a.outStatistics=JSON.stringify(a.outStatistics));a.pixelSize&&(a.pixelSize=JSON.stringify(a.pixelSize));a.quantizationParameters&&(a.quantizationParameters=JSON.stringify(a.quantizationParameters));a.parameterValues&&(a.parameterValues=JSON.stringify(a.parameterValues));a.rangeValues&&(a.rangeValues=JSON.stringify(a.rangeValues));
a.dynamicDataSource&&(a.layer=JSON.stringify({source:a.dynamicDataSource}),delete a.dynamicDataSource);if(a.timeExtent){b=a.timeExtent;c=b.start;b=b.end;if(null!=c||null!=b)a.time=c===b?c:(null==c?"null":c)+","+(null==b?"null":b);delete a.timeExtent}return a}function x(a,c,b){return p(a,c,"pbf",b)}function p(a,c,e,d,h){void 0===d&&(d={});var p="string"===typeof a?g.urlToObject(a):a;a=c.geometry?[c.geometry]:[];d.responseType="pbf"===e?"array-buffer":"json";return f.normalizeCentralMeridian(a,null,
d).then(function(a){a=a&&a[0];k.isSome(a)&&(c=c.clone(),c.geometry=a);a=n.mapParameters(b.__assign(b.__assign(b.__assign(b.__assign({},p.query),{f:e}),h),t(c,h)));return l(g.join(p.path,"query"),b.__assign(b.__assign({},d),{query:b.__assign(b.__assign({},d.query),a)}))})}Object.defineProperty(a,"__esModule",{value:!0});a.runQuery=a.executeQueryForExtent=a.executeQueryForCount=a.executeQueryForIds=a.executeQueryPBFBuffer=a.executeQueryPBF=a.executeQuery=a.queryToQueryStringParameters=void 0;a.queryToQueryStringParameters=
t;a.executeQuery=function(a,c,d,f){var g;return b.__awaiter(this,void 0,void 0,function(){var n,h;return b.__generator(this,function(b){switch(b.label){case 0:if(null===(g=c.timeExtent)||void 0===g||!g.isEmpty)return[3,1];h={data:{features:[]}};return[3,3];case 1:return[4,p(a,c,"json",f)];case 2:h=b.sent(),b.label=3;case 3:return n=h,e.applyFeatureSetZUnitScaling(c,d,n.data),[2,n]}})})};a.executeQueryPBF=function(a,e,d,f){var g;return b.__awaiter(this,void 0,void 0,function(){var n,k;return b.__generator(this,
function(b){switch(b.label){case 0:return(null===(g=e.timeExtent)||void 0===g?0:g.isEmpty)?[2,h.resolve({data:d.createFeatureResult()})]:[4,x(a,e,f)];case 1:return k=n=b.sent(),k.data=c.parsePBFFeatureQuery(n.data,d),[2,k]}})})};a.executeQueryPBFBuffer=x;a.executeQueryForIds=function(a,c,b){var e;return(null===(e=c.timeExtent)||void 0===e?0:e.isEmpty)?h.resolve({data:{objectIds:[]}}):p(a,c,"json",b,{returnIdsOnly:!0})};a.executeQueryForCount=function(a,c,b){var e;return(null===(e=c.timeExtent)||void 0===
e?0:e.isEmpty)?h.resolve({data:{count:0}}):p(a,c,"json",b,{returnIdsOnly:!0,returnCountOnly:!0})};a.executeQueryForExtent=function(a,c,b){var e;return(null===(e=c.timeExtent)||void 0===e?0:e.isEmpty)?h.resolve({data:{count:0,extent:null}}):p(a,c,"json",b,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(a){var c=a.data;if(c.hasOwnProperty("extent"))return a;if(c.features)throw Error("Layer does not support extent calculation.");if(c.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");
return a})};a.runQuery=p})},"esri/tasks/operations/pbfQueryUtils":function(){define(["require","exports","./pbfFeatureServiceParser"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.parsePBFFeatureQuery=void 0;a.parsePBFFeatureQuery=function(a,k){var h=b.parseFeatureQuery(a,k);a=h.queryResult.featureResult;k=h.queryResult.queryGeometry;h=h.queryResult.queryGeometryType;if(a&&a.features&&a.features.length&&a.objectIdFieldName)for(var g=a.objectIdFieldName,d=0,f=a.features;d<f.length;d++){var c=
f[d];c.attributes&&(c.objectId=c.attributes[g])}a&&(a.queryGeometry=k,a.queryGeometryType=h);return a}})},"esri/tasks/operations/pbfFeatureServiceParser":function(){define(["require","exports","../../core/Error","../../core/Logger","../../core/pbf"],function(m,a,b,l,k){function h(a){return a>=C.length?null:C[a]}function g(a,c){return c>=a.geometryTypes.length?null:a.geometryTypes[c]}function d(a,c,b){for(b=c.createPointGeometry(b);a.next();)switch(a.tag()){case 3:for(var e=a.getUInt32(),e=a.pos()+
e,d=0;a.pos()<e;)c.addCoordinatePoint(b,a.getSInt64(),d++);break;default:a.skip()}return b}function f(a,c,b){var e=c.createGeometry(b);for(b=2+(b.hasZ?1:0)+(b.hasM?1:0);a.next();)switch(a.tag()){case 2:for(var d=a.getUInt32(),d=a.pos()+d,f=0;a.pos()<d;)c.addLength(e,a.getUInt32(),f++);break;case 3:d=a.getUInt32();d=a.pos()+d;for(f=0;a.pos()<d;)c.addCoordinate(e,a.getSInt64(),f),f++,f===b&&(f=0);break;default:a.skip()}return e}function c(a,c,b){var e;b.queryGeometry=c.createGeometry(b);b.queryGeometryType=
g(c,0);for(var d=!1;a.next();)switch(a.tag()){case 2:for(var f=a.getUInt32(),f=a.pos()+f,n=0;a.pos()<f;)c.addLength(b.queryGeometry,a.getUInt32(),n++);break;case 3:f=a.getUInt32();f=a.pos()+f;for(n=0;a.pos()<f;)c.addCoordinate(b.queryGeometry,a.getSInt64(),n),n++,2===n&&(n=0);break;case 1:b.queryGeometryType=g(c,a.getEnum());d=!0;break;default:a.skip()}a=null===(e=b.queryGeometry)||void 0===e?void 0:e.lengths;!d&&a&&a.length&&1<a[0]&&(b.queryGeometryType=g(c,3))}function e(a){for(;a.next();)switch(a.tag()){case 1:return a.getString();
case 2:return a.getFloat();case 3:return a.getDouble();case 4:return a.getSInt32();case 5:return a.getUInt32();case 6:return a.getInt64();case 7:return a.getUInt64();case 8:return a.getSInt64();case 9:return a.getBool();default:return a.skip(),null}return null}function n(a){for(var c={type:h(0)};a.next();)switch(a.tag()){case 1:c.name=a.getString();break;case 2:c.type=h(a.getEnum());break;case 3:c.alias=a.getString();break;case 4:var e;e=a.getEnum();e=e>=E.length?null:E[e];c.sqlType=e;break;case 5:try{c.domain=
JSON.parse(a.getString())}catch(G){A.error(new b("query:parsing-pbf","Failed to parse domain",{error:G})),c.domain=null}break;case 6:c.defaultValue=a.getString();break;default:a.skip()}return c}function t(a){for(var c={};a.next();)switch(a.tag()){case 1:c.name=a.getString();break;case 2:c.isSystemMaintained=a.getBool();break;default:a.skip()}return c}function x(a,c,b,g){for(var n=c.createFeature(b),h=0;a.next();)switch(a.tag()){case 1:var k=g[h++].name;n.attributes[k]=a.processMessage(e);break;case 2:n.geometry=
a.processMessageWithArgs(f,c,b);break;case 4:n.centroid=a.processMessageWithArgs(d,c,b);break;default:a.skip()}return n}function p(a){for(var c=[1,1,1,1];a.next();)switch(a.tag()){case 1:c[0]=a.getDouble();break;case 2:c[1]=a.getDouble();break;case 4:c[2]=a.getDouble();break;case 3:c[3]=a.getDouble();break;default:a.skip()}return c}function q(a){for(var c=[0,0,0,0];a.next();)switch(a.tag()){case 1:c[0]=a.getDouble();break;case 2:c[1]=a.getDouble();break;case 4:c[2]=a.getDouble();break;case 3:c[3]=
a.getDouble();break;default:a.skip()}return c}function u(a){for(var c={originPosition:0>=D.length?null:D[0]};a.next();)switch(a.tag()){case 1:var b=a.getEnum();c.originPosition=b>=D.length?null:D[b];break;case 2:c.scale=a.processMessage(p);break;case 3:c.translate=a.processMessage(q);break;default:a.skip()}return c}function y(a){for(var c={};a.next();)switch(a.tag()){case 1:c.shapeAreaFieldName=a.getString();break;case 2:c.shapeLengthFieldName=a.getString();break;case 3:c.units=a.getString();break;
default:a.skip()}return c}function w(a,c){for(c=c.createSpatialReference();a.next();)switch(a.tag()){case 1:c.wkid=a.getUInt32();break;case 5:c.wkt=a.getString();break;case 2:c.latestWkid=a.getUInt32();break;case 3:c.vcsWkid=a.getUInt32();break;case 4:c.latestVcsWkid=a.getUInt32();break;default:a.skip()}return c}function B(a,c){var b=c.createFeatureResult();b.geometryType=g(c,0);for(var e=!1;a.next();)switch(a.tag()){case 1:b.objectIdFieldName=a.getString();break;case 3:b.globalIdFieldName=a.getString();
break;case 4:b.geohashFieldName=a.getString();break;case 5:b.geometryProperties=a.processMessage(y);break;case 7:b.geometryType=g(c,a.getEnum());break;case 8:b.spatialReference=a.processMessageWithArgs(w,c);break;case 10:b.hasZ=a.getBool();break;case 11:b.hasM=a.getBool();break;case 12:b.transform=a.processMessage(u);break;case 9:var d=a.getBool();b.exceededTransferLimit=d;break;case 13:c.addField(b,a.processMessage(n));break;case 15:e||(c.prepareFeatures(b),e=!0);c.addFeature(b,a.processMessageWithArgs(x,
c,b,b.fields));break;case 2:b.uniqueIdField=a.processMessage(t);break;default:a.skip()}c.finishFeatureResult(b);return b}function z(a,b){for(var e={};a.next();)switch(a.tag()){case 4:a.processMessageWithArgs(c,b,e);break;case 1:e.featureResult=a.processMessageWithArgs(B,b);break;default:a.skip()}return e}Object.defineProperty(a,"__esModule",{value:!0});a.parseFeatureQuery=a.parseTransform=a.parseFieldType=void 0;var A=l.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),C="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),
E="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),D=["upperLeft","lowerLeft"];a.parseFieldType=h;a.parseTransform=u;a.parseFeatureQuery=function(a,c){try{var e=
new k(new Uint8Array(a),new DataView(a));for(a={};e.next();)switch(e.tag()){case 2:a.queryResult=e.processMessageWithArgs(z,c);break;default:e.skip()}return a}catch(G){return e=new b("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:G}),A.error(e),{queryResult:{featureResult:c.createFeatureResult()}}}}})},"esri/tasks/operations/queryZScale":function(){define(["require","exports","./zscale"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.applyFeatureSetZUnitScaling=
void 0;a.applyFeatureSetZUnitScaling=function(a,k,h){if(h&&h.features&&h.hasZ&&(a=b.getGeometryZScaler(h.geometryType,k,a.outSpatialReference)))for(k=0,h=h.features;k<h.length;k++)a(h[k].geometry)}})},"esri/tasks/operations/zscale":function(){define(["require","exports","../../core/unitUtils","../../geometry/support/spatialReferenceUtils"],function(m,a,b,l){function k(a,b,f){if(null==a.hasM||a.hasZ)for(a=0;a<b.length;a++)for(var c=0,e=b[a];c<e.length;c++){var d=e[c];2<d.length&&(d[2]*=f)}}function h(a,
d,f){if(a)for(var c=0;c<a.length;c++){var e=a[c].geometry,g=f;if(e&&e.spatialReference&&!l.equals(e.spatialReference,d)&&(g=b.getMetersPerVerticalUnitForSR(e.spatialReference)/g,1!==g))if("x"in e)null!=e.z&&(e.z*=g);else if("rings"in e)k(e,e.rings,g);else if("paths"in e)k(e,e.paths,g);else if("points"in e&&(null==e.hasM||e.hasZ))for(var h=0,e=e.points;h<e.length;h++){var x=e[h];2<x.length&&(x[2]*=g)}}}Object.defineProperty(a,"__esModule",{value:!0});a.unapplyEditsZUnitScaling=a.getGeometryZScaler=
void 0;a.getGeometryZScaler=function(a,d,f){if(!d||!f||f.vcsWkid||l.equals(d,f))return null;d=b.getMetersPerVerticalUnitForSR(d);f=b.getMetersPerVerticalUnitForSR(f);var c=d/f;if(1===c)return null;switch(a){case "point":case "esriGeometryPoint":return function(a){a&&null!=a.z&&(a.z*=c)};case "polyline":case "esriGeometryPolyline":return function(a){if(a){var b=0;for(a=a.paths;b<a.length;b++)for(var e=0,d=a[b];e<d.length;e++){var f=d[e];2<f.length&&(f[2]*=c)}}};case "polygon":case "esriGeometryPolygon":return function(a){if(a){var b=
0;for(a=a.rings;b<a.length;b++)for(var e=0,d=a[b];e<d.length;e++){var f=d[e];2<f.length&&(f[2]*=c)}}};case "multipoint":case "esriGeometryMultipoint":return function(a){if(a){var b=0;for(a=a.points;b<a.length;b++){var e=a[b];2<e.length&&(e[2]*=c)}}};default:return null}};a.unapplyEditsZUnitScaling=function(a,d,f){if((a||d)&&f){var c=b.getMetersPerVerticalUnitForSR(f);h(a,f,c);h(d,f,c)}}})},"esri/tasks/operations/urlUtils":function(){define(["require","exports"],function(m,a){function b(a){var k={},
h;for(h in a)if("declaredClass"!==h){var g=a[h];if(null!=g&&"function"!==typeof g)if(Array.isArray(g)){k[h]=[];for(var d=0;d<g.length;d++)k[h][d]=b(g[d])}else"object"===typeof g?g.toJSON&&(k[h]=JSON.stringify(g)):k[h]=g}return k}Object.defineProperty(a,"__esModule",{value:!0});a.mapParameters=void 0;a.mapParameters=b})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("require exports tslib ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureSetReaderJSON=void 0;m=function(a){function d(b,c,e){b=a.call(this,b)||this;b._featureIndex=-1;b._dateFields=new Set;b._geometryType=e;b._features=c;return b}b.__extends(d,a);d.fromFeatures=function(a,c,b){b=k.convertFromFeatures([],a,c,!1,!1,b);for(var e=0;e<b.length;e++)b[e].displayId=a[e].displayId;return d.fromOptimizedFeatures(b,c)};d.fromFeatureSet=function(a,c){a=l.convertFromFeatureSet(a,c);return d.fromOptimizedFeatureSet(a)};
d.fromOptimizedFeatureSet=function(a){var c=d.fromOptimizedFeatures(a.features,a.geometryType);c._exceededTransferLimit=a.exceededTransferLimit;c._transform=a.transform;var b=0;for(a=a.fields;b<a.length;b++){var f=a[b];"esriFieldTypeDate"===f.type&&c._dateFields.add(f.name)}return c};d.fromOptimizedFeatures=function(a,c,b){var e=h.FeatureSetReader.createInstance();a=new d(e,a,c);a._transform=b;return a};Object.defineProperty(d.prototype,"_current",{get:function(){return this._features[this._featureIndex]},
enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"geometryType",{get:function(){return this._geometryType},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasFeatures",{get:function(){return!!this._features.length},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasNext",{get:function(){return this._featureIndex+1<this._features.length},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"exceededTransferLimit",{get:function(){return this._exceededTransferLimit},
enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasZ",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasM",{get:function(){return!1},enumerable:!1,configurable:!0});d.prototype.getApproximateSize=function(){return this._features.length};d.prototype.getCursor=function(){return this.copy()};d.prototype.getQuantizationTransform=function(){return this._transform};d.prototype.getAttributeHash=function(){var a="",c;for(c in this._current.attributes)a+=
this._current.attributes[c];return a};d.prototype.getIndex=function(){return this._featureIndex};d.prototype.setIndex=function(a){this._featureIndex=a};d.prototype.getObjectId=function(){return this._current.objectId};d.prototype.getDisplayId=function(){return this._current.displayId};d.prototype.setDisplayId=function(a){this._current.displayId=a};d.prototype.getGroupId=function(){return this._current.groupId};d.prototype.setGroupId=function(a){this._current.groupId=a};d.prototype.copy=function(){var a=
new d(this.instance,this._features,this.geometryType);this.copyInto(a);return a};d.prototype.next=function(){if(!this._hasFilter)return++this._featureIndex<this._features.length;for(;++this._featureIndex<this._features.length&&!this._passesFilter(););return this._featureIndex<this._features.length};d.prototype.readLegacyFeature=function(){return l.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};d.prototype.readOptimizedFeature=function(){return this._current};d.prototype.readLegacyPointGeometry=
function(){var a=this.readGeometry();return a?{x:a.coords[0],y:a.coords[1]}:null};d.prototype.readLegacyGeometry=function(){var a=this.readGeometry();return l.convertToGeometry(a,this.geometryType,this.hasZ,this.hasM)};d.prototype.readLegacyCentroid=function(){var a=this.readCentroid();return a?{x:a.coords[0],y:a.coords[1]}:null};d.prototype.readGeometryArea=function(){return l.getQuantizedArea(this._current.geometry,2)};d.prototype.readUnquantizedGeometry=function(){var a=this.readGeometry();if("esriGeometryPoint"===
this.geometryType||!a)return a;for(var a=a.clone(),c=a.coords,b=0,d=0,g=a.lengths;d<g.length;d++){for(var h=g[d],k=1;k<h;k++)c[2*(b+k)]+=c[2*(b+k)-2],c[2*(b+k)+1]+=c[2*(b+k)-1];b+=h}return a};d.prototype.readHydratedGeometry=function(){var a=this._current.geometry;if(!a)return null;a=a.clone();l.unquantizeOptimizedGeometry(a,a,this.hasZ,this.hasM,this._transform);return a};d.prototype.getXHydrate=function(){var a=this._current.geometry.coords[0]+this._tx,c=this.getQuantizationTransform();return a*
c.scale[0]+c.translate[0]};d.prototype.getYHydrate=function(){var a=this._current.geometry.coords[1]+this._ty,c=this.getQuantizationTransform();return c.translate[1]-a*c.scale[1]};d.prototype.readGeometry=function(){if(!this._current.hasGeometry)return null;var a=this._current.geometry.clone();if(a.isPoint)return a.coords[0]+=this._tx,a.coords[1]+=this._ty,a;for(var c=0,b=0,d=a.lengths;b<d.length;b++){var g=d[b];a.coords[2*c]+=this._tx;a.coords[2*c+1]+=this._ty;c+=g}return a};d.prototype.readCentroid=
function(){if(!this._current.hasGeometry)return null;if(!this._current.centroid){var a=this._computeCentroid();if(!a)return null;a.coords[0]-=this._tx;a.coords[1]-=this._ty;this._current.centroid=a}a=this._current.centroid.clone();a.coords[0]+=this._tx;a.coords[1]+=this._ty;return a};d.prototype._readAttribute=function(a,c){var b=this._current.attributes[a];if(void 0!==b)return c&&this._dateFields.has(a)?new Date(b):b;c=this.readAttributes();a=a.toLocaleLowerCase().trim();for(var d in c)if(d.toLocaleLowerCase().trim()===
a)return a=this._current.attributes[d],this._dateFields.has(d)?new Date(a):a};d.prototype.copyInto=function(b){a.prototype.copyInto.call(this,b);b._featureIndex=this._featureIndex;b._transform=this._transform;b._dateFields=this._dateFields};d.prototype._readAttributes=function(){return this._current.attributes};d.prototype._passesFilter=function(){var a;if(!this._hasFilter)return!0;var c=0;a=0;switch(this.geometryType){case "esriGeometryPoint":c=this._current.geometry;if(!c)return!1;a=c.coords;c=
a[0];a=a[1];break;case "esriGeometryPolygon":c=this.readCentroid();if(!c)return!1;a=c.coords;c=a[0];a=a[1];c-=this._tx;a-=this._ty;break;default:return!1}return c>=this._xmin&&c<=this._xmax&&a>=this._ymin&&a<=this._ymax?!0:!1};return d}(h.FeatureSetReader);a.FeatureSetReaderJSON=m})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("require exports ../../../../../geometry ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureSetReader=void 0;var g=0;m=function(){function a(a){this.type="FeatureSetReader";this._ty=this._tx=this.instance=0;this._xmin=-1;this._ymax=this._ymin=this._xmax=0;this._joined=[];this.instance=a}a.createInstance=function(){g++;return g=65535<g?0:g};Object.defineProperty(a.prototype,"_hasFilter",{get:function(){return-1!==this._xmin},enumerable:!1,configurable:!0});a.prototype.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");
};a.prototype.getStorage=function(){return this._storage};a.prototype.getComputedNumeric=function(a){return this.getComputedNumericAtIndex(0)};a.prototype.setComputedNumeric=function(a,c){return this.setComputedNumericAtIndex(c,0)};a.prototype.getComputedString=function(a){return this.getComputedStringAtIndex(0)};a.prototype.setComputedString=function(a,c){return this.setComputedStringAtIndex(0,c)};a.prototype.getComputedNumericAtIndex=function(a){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),
a)};a.prototype.setComputedNumericAtIndex=function(a,c){this._storage.setComputedNumericAtIndex(this.getDisplayId(),a,c)};a.prototype.getComputedStringAtIndex=function(a){return this._storage.getComputedStringAtIndex(this.getDisplayId(),a)};a.prototype.setComputedStringAtIndex=function(a,c){return this._storage.setComputedStringAtIndex(this.getDisplayId(),a,c)};a.prototype.transform=function(a,c){var b=this.copy();b._tx=a;b._ty=c;return b};a.prototype.extent=function(a,c,b,d){var e=this.copy();e._xmin=
a;e._xmax=b;e._ymin=c;e._ymax=d;return e};a.prototype.hasFilter=function(){return this._hasFilter};a.prototype.readAttribute=function(a,c){void 0===c&&(c=!1);var b=this._readAttribute(a,c);if(void 0!==b)return b;for(var b=0,d=this._joined;b<d.length;b++){var f=d[b];f.setIndex(this.getIndex());f=f._readAttribute(a,c);if(void 0!==f)return f}};a.prototype.readAttributes=function(){return this._readAttributes()};a.prototype.joinAttributes=function(a){this._joined.push(a)};a.prototype.readArcadeFeature=
function(){return this};a.prototype.geometry=function(){var a=this.readHydratedGeometry(),a=k.convertToGeometry(a,this.geometryType,this.hasZ,this.hasM),a=b.fromJSON(a);a.spatialReference=this._arcadeSpatialReference;return a};a.prototype.field=function(a){return this.readAttribute(a,!0)};a.prototype.hasField=function(a){return!0};a.prototype.setField=function(a,c){};a.prototype.keys=function(){return[]};a.prototype.castToText=function(){return""};a.prototype._computeCentroid=function(){if("esriGeometryPolygon"!==
this.geometryType)return null;var a=this.readUnquantizedGeometry();if(!a||a.hasIndeterminateRingOrder)return null;var c=this.getQuantizationTransform();return l.getCentroidOptimizedGeometry(new h.default,a,this.hasM,this.hasZ,c)};a.prototype.copyInto=function(a){a._storage=this._storage;a._arcadeSpatialReference=this._arcadeSpatialReference;a._joined=this._joined;a._tx=this._tx;a._ty=this._ty;a._xmin=this._xmin;a._xmax=this._xmax;a._ymin=this._ymin;a._ymax=this._ymax};return a}();a.FeatureSetReader=
m})},"esri/views/2d/layers/features/support/FeatureSetReaderPBF":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/Logger ../../../../../core/pbf ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ./FeatureSetReader ./FeatureSetReaderPBFHeader".split(" "),function(m,a,b,l,k,h,g,d,f,c,e){function n(a){for(var c=a.getLength(),c=a.pos()+c;a.pos()<c&&a.next();)switch(a.tag()){case 1:return a=
a.getString(),""===a?null:a;case 2:return a.getFloat();case 3:return a.getDouble();case 4:return a.getSInt32();case 5:return a.getUInt32();case 6:return a.getInt64();case 7:return a.getUInt64();case 8:return a.getSInt64();case 9:return a.getBool();default:return a.skip(),null}return null}Object.defineProperty(a,"__esModule",{value:!0});a.FeatureSetReaderPBF=void 0;var t=k.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF");m=function(a){function k(c,b,e,d){c=a.call(this,c)||this;
c._hasNext=!1;c._isPoints=!1;c._isPolygons=!1;c._featureIndex=-1;c._featureOffset=0;c._cache={area:0,unquantGeometry:void 0,geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0};c._geometryType=d;c._reader=b;c._header=e;c._hasNext=e.hasFeatures;c._isPoints="esriGeometryPoint"===d;c._isPolygons="esriGeometryPolygon"===d;return c}b.__extends(k,a);k.fromBuffer=function(a,b){var d;a:{try{for(var f=new h(new Uint8Array(a),new DataView(a));f.next();)switch(f.tag()){case 2:b:{for(var g=
f.getMessage();g.next();)switch(g.tag()){case 1:d=g.getMessage();break b;default:g.skip()}d=null}break a;default:f.skip()}}catch(z){d=new l("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:z}),t.error(d)}d=null}a=e.parseHeader(d,"esriGeometryPoint"===b);f=c.FeatureSetReader.createInstance();return new k(f,d,a,b)};Object.defineProperty(k.prototype,"geometryType",{get:function(){return this._geometryType},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"size",
{get:function(){return this._header.featureCount},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"hasZ",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"hasM",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"stride",{get:function(){return 2+(this.hasZ?1:0)+(this.hasM?1:0)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"hasFeatures",{get:function(){return this._header.hasFeatures},
enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"exceededTransferLimit",{get:function(){return this._header.exceededTransferLimit},enumerable:!1,configurable:!0});k.prototype.getApproximateSize=function(){return this._hasFilter?Math.max(Math.round(this.size*Math.abs(this._xmax-this._xmin)*Math.abs(this._ymax-this._ymin)/262144),0):this.size};k.prototype.getQuantizationTransform=
function(){return this._header.transform};k.prototype.getCursor=function(){return this.copy()};k.prototype.getIndex=function(){return this._featureIndex};k.prototype.setIndex=function(a){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;this._featureIndex=a};k.prototype.getAttributeHash=function(){var a=this,c="";this._header.fieldIndexMap.forEach(function(b){c+=a._readAttributeAtIndex(b)+
"."});return c};k.prototype.getObjectId=function(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)};k.prototype.getDisplayId=function(){return this._header.displayIds[this._featureIndex]};k.prototype.setDisplayId=function(a){this._header.displayIds[this._featureIndex]=a};k.prototype.getGroupId=function(){return this._header.groupIds[this._featureIndex]};k.prototype.setGroupId=function(a){this._header.groupIds[this._featureIndex]=a};k.prototype.readLegacyFeature=function(){var a;
if(void 0===this._cache.legacyFeature){var c=this.readCentroid(),c={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),centroid:null!==(a=c&&{x:c.coords[0],y:c.coords[1]})&&void 0!==a?a:null};return this._cache.legacyFeature=c}return this._cache.legacyFeature};k.prototype.readOptimizedFeature=function(){if(void 0===this._cache.optFeature){var a=new d.default(this.readGeometry(),this.readAttributes(),this.readCentroid());return this._cache.optFeature=
a}return this._cache.optFeature};k.prototype.getXHydrate=function(){var a=this._header.centroid[2*this._featureIndex],c=this.getQuantizationTransform();return a*c.scale[0]+c.translate[0]};k.prototype.getYHydrate=function(){var a=this._header.centroid[2*this._featureIndex+1],c=this.getQuantizationTransform();return c.translate[1]-a*c.scale[1]};k.prototype.readLegacyPointGeometry=function(){return{x:this._header.centroid[2*this._featureIndex]+this._tx,y:this._header.centroid[2*this._featureIndex+1]+
this._ty}};k.prototype.readLegacyGeometry=function(){var a=this.readGeometry();return g.convertToGeometry(a,this.geometryType,!1,!1)};k.prototype.readLegacyCentroid=function(){var a=this.readCentroid();if(!a)return null;a=a.coords;return{x:a[0],y:a[1]}};k.prototype.readGeometryArea=function(){this._cache.area||this.readGeometry();return this._cache.area};k.prototype.readUnquantizedGeometry=function(){if(void 0===this._cache.unquantGeometry){var a=this.readGeometry();if(!a)return this._cache.unquantGeometry=
null;for(var a=a.clone(),c=a.lengths,b=a.coords,e=0,d=2;e<c.length;e++,d+=2)for(var f=c[e],g=1;g<f;g+=1,d+=2)b[d]+=b[d-2],b[d+1]+=b[d-1];return this._cache.unquantGeometry=a}return this._cache.unquantGeometry};k.prototype.readHydratedGeometry=function(){var a=this.readGeometry();if(!a)return null;a=a.clone();this._isPoints&&(a.coords[0]-=this._tx,a.coords[1]-=this._ty);g.unquantizeOptimizedGeometry(a,a,this.hasZ,this.hasM,this.getQuantizationTransform());return a};k.prototype.readGeometry=function(){if(void 0===
this._cache.geometry){var a=null;if(this._isPoints)a=new f.default([],[this._header.centroid[2*this._featureIndex]+this._tx,this._header.centroid[2*this._featureIndex+1]+this._ty]);else{var c=this._header.offsets.geometry[this._featureIndex],b=this._reader;if(0===c)return null;b.move(c);try{a=this._parseGeometry(b)}catch(w){return console.error("Failed to parse geometry!",w),null}}return this._cache.geometry=a}return this._cache.geometry};k.prototype.readCentroid=function(){if(void 0===this._cache.centroid){var a=
null,a=this._header.centroid[2*this._featureIndex]+this._tx,c=this._header.centroid[2*this._featureIndex+1]+this._ty;if(268435455===a){if(a=this._computeCentroid())this._header.centroid[2*this._featureIndex]=a.coords[0]-this._tx,this._header.centroid[2*this._featureIndex+1]=a.coords[1]-this._ty}else a=new f.default([],[a,c]);return this._cache.centroid=a}return this._cache.centroid};k.prototype.copy=function(){var a=this._reader.clone(),a=new k(this.instance,a,this._header,this.geometryType);this.copyInto(a);
return a};k.prototype.next=function(){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;if(!this._hasFilter)return++this._featureIndex<this.size;for(;++this._featureIndex<this.size&&!this._passesFilter(););return this._featureIndex<this.size};k.prototype._readAttribute=function(a,c){a=this._header.hasFieldIndex(a)?a:a.toLowerCase().trim();var b=this._header.getFieldIndex(a);if(null!=
b)return b=this._readAttributeAtIndex(b),c?this._header.isDateField(a)?new Date(b):b:b};k.prototype._readAttributes=function(){var a=this,c={};this._header.fieldIndexMap.forEach(function(b,e){c[e]=a._readAttributeAtIndex(b)});return c};k.prototype.copyInto=function(c){a.prototype.copyInto.call(this,c);c._featureIndex=this._featureIndex;c._featureOffset=this._featureOffset;c._hasNext=this._hasNext};k.prototype._passesFilter=function(){if(!this._hasFilter)return!0;var a=this._header.centroid[2*this._featureIndex],
c=this._header.centroid[2*this._featureIndex+1];if(268435455===a){if(this._isPolygons&&!this.readCentroid())return!1;a=this._header.centroid[2*this._featureIndex];c=this._header.centroid[2*this._featureIndex+1]}return a>=this._xmin&&a<=this._xmax&&c>=this._ymin&&c<=this._ymax?!0:!1};k.prototype._readAttributeAtIndex=function(a){var c=this._reader;c.move(this._header.offsets.attributes[this._featureIndex*this._header.fieldCount+a]);return n(c)};k.prototype._preprocessPolygon=function(a,c){for(var b=
0,e=0,d=0,g=!1,n=!1,h=!1,k=-1,p=[],l=0,q=!1,t=0;t<c.length;t++){for(var u=c[t],x=a[2*b],m=a[2*b+1],O=0,P=1;P<u;P++)var N=x+a[2*(b+P)],S=m+a[2*(b+P)+1],W=(N-x)*(S+m),x=N,m=S,O=O+.5*W;(P=0<O)&&q&&(e+=u);P||(k++,q=!1);if(1E6<=k)break;l+=O;g&&P&&n&&(h=!0);a[2*d]=a[2*e];a[2*d++ +1]=a[2*e++ +1];g=1;n=a[2*e];O=a[2*e++ +1];for(P=2;P<u;P++)x=a[2*e],m=a[2*e++ +1],0===n*m-x*O?(n+=x,O+=m):(a[2*d]=n,a[2*d++ +1]=O,g++,n=x,O=m);a[2*d]=n;a[2*d++ +1]=O;g++;p.push(g);g=!1;n=!0;b+=u}return p.length?(this._cache.area=
Math.abs(l),new f.default(p,a,h)):null};k.prototype._parseGeometry=function(a){for(var c=a.getLength(),b=a.pos()+c,c=[],e=[];a.pos()<b&&a.next();)switch(a.tag()){case 2:for(var d=a.getUInt32(),d=a.pos()+d;a.pos()<d;)e.push(a.getUInt32());break;case 3:d=a.getUInt32();for(d=a.pos()+d;a.pos()<d;)c.push(a.getSInt32()),c.push(a.getSInt32()),this.hasZ&&a.getSInt32(),this.hasM&&a.getSInt32();break;default:a.skip()}for(b=a=0;b<e.length;b++)d=e[b],c[2*a]+=this._tx,c[2*a+1]+=this._ty,a+=d;return this._isPolygons?
this._preprocessPolygon(c,e):new f.default(e,c)};return k}(c.FeatureSetReader);a.FeatureSetReaderPBF=m})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFHeader":function(){define(["require","exports","../../../../../core/Error","../../../../../tasks/operations/pbfFeatureServiceParser"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.parseHeader=a.FeatureSetHeader=void 0;var k=function(){function a(){this.hasFeatures=!1;this.fieldIndexMap=new Map;this.objectIdFieldIndex=
this.featureCount=this.fieldCount=0;this.dateFields=new Set;this.offsets={attributes:[],geometry:[]};this.centroid=[]}a.prototype.hasFieldIndex=function(a){return this.fieldIndexMap.has(a)};a.prototype.isDateField=function(a){return this.dateFields.has(a)};a.prototype.getFieldIndex=function(a){return this.fieldIndexMap.get(a)};return a}();a.FeatureSetHeader=k;a.parseHeader=function(a,g){for(var d=a.pos(),f=new k,c=0,e=0,n=null,h=null,x=null,p=!1;a.next();)switch(a.tag()){case 1:n=a.getString();break;
case 3:h=a.getString();break;case 12:x=a.processMessage(l.parseTransform);break;case 9:f.exceededTransferLimit=a.getBool();f.exceededTransferLimit&&(f.offsets.geometry=new Int32Array(8E3),f.centroid=new Int32Array(16E3));break;case 13:var q;q=a;for(var u=q.getLength(),u=q.pos()+u,y={name:"",isDate:!1};q.pos()<u&&q.next();)switch(q.tag()){case 1:y.name=q.getString();break;case 2:"esriFieldTypeDate"===l.parseFieldType(q.getEnum())&&(y.isDate=!0);break;default:q.skip()}q=y;u=q.name.toLowerCase().trim();
y=c++;f.fieldIndexMap.set(q.name,y);f.fieldIndexMap.set(u,y);q.isDate&&(f.dateFields.add(q.name),f.dateFields.add(u));break;case 15:q=a.getLength();q=a.pos()+q;f.exceededTransferLimit||(u=f.centroid,f.offsets.geometry.push(0),u.push(268435455),u.push(268435455));!p&&f.exceededTransferLimit&&(p=!0,f.offsets.attributes=new Uint32Array(8E3*c));for(u=e*c;a.pos()<q&&a.next();)switch(a.tag()){case 1:p?f.offsets.attributes[u++]=a.pos():f.offsets.attributes.push(a.pos());y=a.getLength();a.skipLen(y);break;
case 2:if(g)for(var y=a.getLength(),w=a.pos()+y;a.pos()<w&&a.next();)switch(a.tag()){case 3:a.getUInt32();var y=a.getSInt32(),m=a.getSInt32();f.centroid[2*e]=y;f.centroid[2*e+1]=m;break;default:a.skip()}else f.offsets.geometry[e]=a.pos(),y=a.getLength(),a.skipLen(y);break;case 4:y=a.getLength();for(w=a.pos()+y;a.pos()<w&&a.next();)switch(a.tag()){case 3:a.getUInt32();y=a.getSInt32();m=a.getSInt32();f.centroid[2*e]=y;f.centroid[2*e+1]=m;break;default:a.skip()}break;default:a.skip()}e++;f.hasFeatures=
!0;break;default:a.skip()}g=n||h;if(!g)throw new b("FeatureSet has no objectId or globalId field name");f.featureCount=e;f.fieldCount=c;f.objectIdFieldIndex=f.getFieldIndex(g);f.transform=x;f.displayIds=new Uint32Array(f.featureCount);f.groupIds=new Uint16Array(f.featureCount);a.move(d);return f}})},"esri/views/2d/layers/features/sources/DataTileSource":function(){define("require exports tslib ../../../../../core/Evented ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.DataTileSource=a.DataTileSubscription=void 0;var g=function(){function a(a){this._abortController=new AbortController;this.requests={pending:[],done:[]};this.tile=a}Object.defineProperty(a.prototype,"signal",{get:function(){return this._abortController.signal},enumerable:!1,configurable:!0});a.prototype.add=function(a){this.requests.done.push(a);a.request.end&&(this.resolved=!0)};a.prototype.abort=function(){this._abortController.abort()};
return a}();a.DataTileSubscription=g;m=function(){function a(a){this.events=new l;this._subscriptions=new Map;this._serviceQueryInfo={outSpatialReference:a.outSR};this._serviceInfo=a.serviceInfo;this._onRequest=a.onRequest}a.prototype.queryLastEditDate=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){throw Error("Service does not support query type");})})};a.prototype.query=function(a,c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,
function(a){throw Error("Service does not support query");})})};Object.defineProperty(a.prototype,"geometryType",{get:function(){return this._serviceInfo.geometryType},enumerable:!1,configurable:!0});a.prototype.update=function(a){h.diff(a,this._sourceQueryInfo)&&(this._sourceQueryInfo=a)};a.prototype.updateSubscriptions=function(){};a.prototype.setViewState=function(a){};a.prototype.subscribe=function(a){var c=new g(a);this._subscriptions.set(a.id,c)};a.prototype.unsubscribe=function(a){var c=this.get(a.id);
k.isSome(c)&&c.abort();this._subscriptions.delete(a.id)};a.prototype.pause=function(){};a.prototype.resume=function(){};a.prototype.get=function(a){return this._subscriptions.has(a)?this._subscriptions.get(a):null};a.prototype.enableEvent=function(a,c){};return a}();a.DataTileSource=m})},"esri/views/support/QueueProcessor":function(){define("require exports ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",
{value:!0});a.QueueProcessor=void 0;var g=function(){return function(a,b){this.item=a;this.controller=b;this.promise=null}}();m=function(){function a(a){var c=this;this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;a.concurrency&&(this.concurrency=a.concurrency);this._queue=new k.default(a.peeker);this.process=a.process;var e=a.scheduler;a.task&&b.isSome(e)&&(this._task=e.registerTask(a.task,function(a){return c.update(a)},
function(){return c.needsUpdate()}))}a.prototype.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};Object.defineProperty(a.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!1,configurable:!0});a.prototype.abort=function(a){(a=this._controllers.get(a))&&a.abort()};a.prototype.clear=function(){this._queue.clear();var a=[];this._controllers.forEach(function(c){return a.push(c)});
this._controllers.clear();a.forEach(function(a){return a.abort()});this._processingItems.clear();this._cancelNext()};a.prototype.forEach=function(a){this._deferreds.forEach(function(c,b){return a(b)})};a.prototype.get=function(a){return(a=this._deferreds.get(a))?a.promise:void 0};a.prototype.isOngoing=function(a){return this._processingItems.has(a)};a.prototype.has=function(a){return this._deferreds.has(a)};a.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};a.prototype.push=
function(a,c){var e=this,d=this.get(a);if(d)return d;var f,g=l.createAbortController(),h=null;c&&(h=l.onAbort(c,function(){return g.abort()}));var k=function(){u.remove();b.isSome(h)&&h.remove();e._deferreds.delete(a);e._controllers.delete(a);e._queue.remove(a);e._processingItems.delete(a);e._scheduleNext()},u=l.onAbortOrThrow(g.signal,function(){var c=e._processingItems.get(a);c&&c.controller.abort();k();f.reject(l.createAbortError())});f=l.createDeferred();this._deferreds.set(a,f);this._controllers.set(a,
g);f.promise.then(k,k);this._queue.push(a);this._scheduleNext();return f.promise};a.prototype.reset=function(){var a=[];this._processingItems.forEach(function(c){return a.push(c)});this._processingItems.clear();for(var c=0;c<a.length;c++){var b=a[c];this._queue.push(b.item);b.controller.abort()}this._scheduleNext()};a.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};a.prototype.takeAll=function(){for(var a=[];this._queue.length;)a.push(this._queue.pop());this.clear();
return a};a.prototype.needsUpdate=function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency};a.prototype.update=function(a){for(;!a.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),a.madeProgress()};a.prototype._scheduleNext=function(){var a=this;this._task||this._isPaused||this._schedule||(this._schedule=h.schedule(function(){a._schedule=null;a._next()}))};a.prototype._next=function(){for(;0<this._queue.length&&
this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};a.prototype._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};a.prototype._processResult=function(a,c){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).resolve(c))};a.prototype._processError=function(a,c){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).reject(c))};a.prototype._canProcessFulfillment=function(a){return this._deferreds.get(a.item)&&
this._processingItems.get(a.item)===a?!0:!1};a.prototype._process=function(a){var c=this;if(!b.isNone(a)){var e,d=l.createAbortController(),f=new g(a,d);this._processingItems.set(a,f);try{e=this.process(a,d.signal)}catch(x){this._processError(f,x)}e&&"function"===typeof e.then?(f.promise=e,e.then(function(a){return c._processResult(f,a)},function(a){return c._processError(f,a)})):this._processResult(f,e)}};Object.defineProperty(a.prototype,"test",{get:function(){var a=this;return{update:function(c){return a.update(c)}}},
enumerable:!1,configurable:!0});return a}();a.QueueProcessor=m})},"esri/core/Queue":function(){define(["require","exports","./maybe","./SetUtils"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a){void 0===a&&(a=function(a){return l.firstOfSet(a)});this._peeker=a;this._items=new Set}Object.defineProperty(a.prototype,"length",{get:function(){return this._items.size},enumerable:!1,configurable:!0});a.prototype.clear=function(){this._items.clear()};a.prototype.peek=
function(){if(0!==this._items.size)return this._peeker(this._items)};a.prototype.push=function(a){this.contains(a)||this._items.add(a)};a.prototype.contains=function(a){return this._items.has(a)};a.prototype.pop=function(){if(0!==this.length){var a=this.peek();this._items.delete(b.assumeNonNull(a));return a}};a.prototype.remove=function(a){this._items.delete(a)};a.prototype.filter=function(a){var b=this;this._items.forEach(function(d){a(d)||b._items.delete(d)});return this};return a}();a.default=
m})},"esri/views/2d/layers/features/sources/GeoEventSource":function(){define("require exports tslib ../../../../../core/has ../../../../../core/maybe ../../../../../core/libs/rbush/rbush ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/StreamFeatureManager ../../../../../layers/graphics/sources/connections/GeoEventConnection ../../../../../layers/graphics/sources/connections/WebSocketConnection ./DataTileSource ../support/FeatureSetReaderJSON".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){function x(a,b,d,f,g,n,h){var k=0===a.path.indexOf("wss://")||0===a.path.indexOf("ws://");a={source:a,sourceSpatialReference:b,spatialReference:d,geometryType:f,filter:g,maxReconnectionAttempts:n,maxReconnectionInterval:h};return k?new e.WebSocketConnection(a):new c.default(a)}function p(a,c){var b=a.weakClone(),e=g.quantizeX(c,a.geometry.coords[0]);a=g.quantizeY(c,a.geometry.coords[1]);b.geometry=new d.default([],[e,a]);return b}function q(a){switch(a){case "esriGeometryPoint":return p;
default:return function(c,b){var e=c.weakClone(),f=new d.default;c=g.quantizeOptimizedGeometry(f,c.geometry,!1,!1,a,b,!1,!1);e.geometry=c;return e}}}function u(a){switch(a){case "esriGeometryPoint":return function(a){return{minX:a.geometry.coords[0],minY:a.geometry.coords[1],maxX:a.geometry.coords[0],maxY:a.geometry.coords[1]}};default:return function(a){var c=Infinity,b=Infinity,e=-Infinity,d=-Infinity;a.geometry.forEachVertex(function(a,f){c=Math.min(c,a);b=Math.min(b,f);e=Math.max(e,a);d=Math.max(d,
f)});return{minX:c,minY:b,maxX:e,maxY:d}}}}function y(a,c){c=h(9,u(c));c.load(a);return c}function w(a,c){return a.search({minX:c.bounds[0],minY:c.bounds[1],maxX:c.bounds[2],maxY:c.bounds[3]})}Object.defineProperty(a,"__esModule",{value:!0});a.GeoEventSource=void 0;var B=function(){function a(a,c){this.onUpdate=a;this._geometryType=c;this._objectIdToFeature=new Map}Object.defineProperty(a.prototype,"_features",{get:function(){var a=[];this._objectIdToFeature.forEach(function(c){return a.push(c)});
return a},enumerable:!1,configurable:!0});a.prototype.add=function(a){this._objectIdToFeature.set(a.objectId,a);this._index=null};a.prototype.get=function(a){return this._objectIdToFeature.has(a)?this._objectIdToFeature.get(a):null};a.prototype.forEach=function(a){this._objectIdToFeature.forEach(a)};a.prototype.search=function(a){this._index||(this._index=y(this._features,this._geometryType));return w(this._index,a)};a.prototype.removeById=function(a){var c=this._objectIdToFeature.get(a);return c?
(this._objectIdToFeature.delete(a),this._index=null,c):null};a.prototype.update=function(a,c){this.onUpdate(a,c)};Object.defineProperty(a.prototype,"size",{get:function(){return this._objectIdToFeature.size},enumerable:!1,configurable:!0});return a}();m=function(a){function c(c){var b=a.call(this,c)||this;b.type="geoevent";b._dataReceiveEventEnabled=!1;b._updateInfo={websocket:0,client:0};var e=c.outSR,d=c.serviceInfo,g=d.geometryType,n=d.objectIdField,h=d.timeInfo,k=d.purgeOptions,p=d.source,l=d.spatialReference,
t=d.serviceFilter,u=d.maxReconnectionAttempts,w=d.maxReconnectionInterval,d=new B(b._onUpdate.bind(b),g),n=new f.default(d,n,h,k),e=x(p,l,e,g,t,u,w);b._store=d;b._manager=n;b._connection=e;b._quantize=q(g);b._handles=[b._connection.on("feature",function(a){return b._onFeature(a)}),b._connection.watch("connectionStatus",function(a){return b.events.emit("connectionStatus",a)}),b._connection.watch("errorString",function(a){return b.events.emit("errorString",a)})];var y=performance.now();b._updateIntervalId=
setInterval(function(){var a=performance.now(),e=a-y;2500<e&&(y=a,a=Math.round(b._updateInfo.client/(e/1E3)),e=Math.round(b._updateInfo.websocket/(e/1E3)),b._updateInfo.client=0,b._updateInfo.websocket=0,b.events.emit("updateRate",{client:a,websocket:e}));c.canAcceptRequest()&&b._manager.checkForUpdates()},16);return b}b.__extends(c,a);c.prototype.destroy=function(){clearInterval(this._updateIntervalId);this._handles.forEach(function(a){return a.remove()});this._connection.destroy()};c.prototype._fetchDataTile=
function(){};c.prototype.enableEvent=function(a,c){"data-received"===a&&(this._dataReceiveEventEnabled=c)};Object.defineProperty(c.prototype,"updating",{get:function(){return!1},enumerable:!1,configurable:!0});c.prototype.subscribe=function(c){a.prototype.subscribe.call(this,c);var b=this._getTileFeatures(c);this._onRequest({tile:c,id:c.key.id,features:b,end:!0},"new")};c.prototype.unsubscribe=function(c){a.prototype.unsubscribe.call(this,c)};c.prototype.forEachRequest=function(a,c){var b=this._subscriptions.get(a),
e=b.tile,b=b.signal;a={tile:e,id:a,features:this._getTileFeatures(e),end:!0};c(a,{signal:b})};c.prototype.resend=function(a){return b.__awaiter(this,void 0,void 0,function(){var c=this;return b.__generator(this,function(b){this._subscriptions.forEach(function(b){b=b.tile;b={tile:b,id:b.id,features:c._getTileFeatures(b),end:!0};c._onRequest(b,"update",a)});return[2]})})};c.prototype._getTileFeatures=function(a){var c=this,b=this._store.search(a).map(function(b){return c._quantize(b,a.transform)});
return t.FeatureSetReaderJSON.fromOptimizedFeatures(b,this.geometryType,a.transform)};c.prototype._onFeature=function(a){this._updateInfo.websocket++;try{this._dataReceiveEventEnabled&&this.events.emit("feature",a);var c=g.convertFromFeature(a,this.geometryType,!1,!1,this._serviceInfo.objectIdField);this._manager.add(c)}catch(D){}};c.prototype._onUpdate=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f=this;return b.__generator(this,function(b){e=k.andThen(a,function(a){return y(a,
f.geometryType)});d=k.andThen(c,function(a){return y(a,f.geometryType)});k.isSome(a)&&(this._updateInfo.client+=a.length);this._subscriptions.forEach(function(a,c){var b=a.tile;a=k.andThen(e,function(a){return w(a,b)});a=k.andThen(a,function(a){return a.map(function(a){return f._quantize(a,b.transform)})});a=k.andThen(a,function(a){return t.FeatureSetReaderJSON.fromOptimizedFeatures(a,f.geometryType,b.transform)});var g=k.andThen(d,function(a){return w(a,b)}),g=k.andThen(g,function(a){return a.map(function(a){return a.objectId})});
f._onRequest({tile:b,id:c,features:a,remove:k.unwrapOr(g,[]),end:!0},"update")});return[2]})})};return c}(n.DataTileSource);a.GeoEventSource=m})},"esri/layers/graphics/data/StreamFeatureManager":function(){define(["require","exports","../../../core/CircularArray","../../../core/mathUtils","../../../core/maybe"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.ESRI_TIMESTAMP=a.DEFAULT_STREAM_ID_FIELD=void 0;a.DEFAULT_STREAM_ID_FIELD="__esri_stream_id__";a.ESRI_TIMESTAMP="__esri_timestamp__";
m=function(){function h(b,d,f,c,e){void 0===e&&(e=128);this._trackIdToObservations=new Map;this._idCounter=0;this._lastPurge=performance.now();this._addOrUpdated=new Map;this._removed=[];this._maxAge=0;this._timeInfo=f;this._purgeOptions=c;this.store=b;this.objectIdField=d;this.purgeInterval=e;this._useGeneratedIds=this.objectIdField===a.DEFAULT_STREAM_ID_FIELD}h.prototype.add=function(a){if(this._useGeneratedIds){var d=this._nextId();a.attributes[this.objectIdField]=d;a.objectId=d}this._addOrUpdated.set(a.objectId,
a);this._maxAge=Math.max(this._maxAge,a.attributes[this._timeInfo.startTimeField]);if(this._timeInfo.trackIdField){d=a.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(d)){var f=k.isSome(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:1E3,f=l.clamp(f,0,1E3);this._trackIdToObservations.set(d,new b.default(f))}a=this._trackIdToObservations.get(d).enqueue(a.objectId);k.isSome(a)&&(this._addOrUpdated.has(a)?this._addOrUpdated.delete(a):
this._removed.push(a))}};h.prototype.checkForUpdates=function(){var b=this._getToAdd(),d=this._getToRemove(),f=performance.now();f-this._lastPurge>=this.purgeInterval&&(this._purge(f),this._lastPurge=f);var c=[];if(k.isSome(d))for(var e=0;e<d.length;e++){var n=this.store.removeById(d[e]);k.isSome(n)&&c.push(n)}if(k.isSome(b))for(d=0;d<b.length;d++)n=b[d],n.attributes[a.ESRI_TIMESTAMP]=f,this.store.add(n);(b||c)&&this.store.update(b,c)};h.prototype._getToAdd=function(){if(!this._addOrUpdated.size)return null;
var a=Array(this._addOrUpdated.size),b=0;this._addOrUpdated.forEach(function(d){return a[b++]=d});this._addOrUpdated.clear();return a};h.prototype._getToRemove=function(){var a=this._removed;if(!this._removed.length)return null;this._removed=[];return a};h.prototype._nextId=function(){var a=this._idCounter;this._idCounter=(this._idCounter+1)%4294967294+1;return a};h.prototype._purge=function(a){var b=this._purgeOptions;k.isSome(b)&&(this._purgeSomeByDisplayCount(b),this._purgeByAge(b),this._purgeByAgeReceived(a,
b),this._purgeTracks())};h.prototype._purgeSomeByDisplayCount=function(a){var b=this;if(a.displayCount){var f=this.store.size;f>a.displayCount&&this._trackIdToObservations.forEach(function(c){f>a.displayCount&&c.size&&(c=k.unwrap(c.dequeue()),b._removed.push(c),f--)})}};h.prototype._purgeByAge=function(a){var b=this,f;if(a.age&&null!==(f=this._timeInfo)&&void 0!==f&&f.startTimeField){var c=this._maxAge-6E4*a.age;this.store.forEach(function(a){a.attributes[b._timeInfo.startTimeField]<c&&b._removed.push(a.objectId)})}};
h.prototype._purgeByAgeReceived=function(b,d){var f=this;if(d.ageReceived){var c=b+6E4*d.ageReceived;this.store.forEach(function(b){b.attributes[a.ESRI_TIMESTAMP]<c&&f._removed.push(b.objectId)})}};h.prototype._purgeTracks=function(){var a=this;this._trackIdToObservations.forEach(function(b,f){0===b.size&&a._trackIdToObservations.delete(f)})};return h}();a.default=m})},"esri/core/CircularArray":function(){define(["require","exports","./maybe"],function(m,a,b){Object.defineProperty(a,"__esModule",
{value:!0});m=function(){function a(a){void 0===a&&(a=Number.POSITIVE_INFINITY);this._start=this.size=0;this.maxSize=a;this._buffer=isFinite(a)?Array(a):[]}Object.defineProperty(a.prototype,"entries",{get:function(){return this._buffer},enumerable:!1,configurable:!0});a.prototype.enqueue=function(a){if(this.size===this.maxSize){var b=this._buffer[this._start];this._buffer[this._start]=a;this._start=(this._start+1)%this.maxSize;return b}isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%
this.maxSize]=a:this._buffer[this._start+this.size++]=a;return null};a.prototype.dequeue=function(){if(0===this.size)return null;var a=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return a};a.prototype.clear=function(){for(;b.isSome(this.dequeue()););};return a}();a.default=m})},"esri/layers/graphics/sources/connections/GeoEventConnection":function(){define("require exports tslib ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../../FeatureLayer ./WebSocketConnection ../../../../tasks/operations/query ../../../../tasks/support/Query".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x){Object.defineProperty(a,"__esModule",{value:!0});var p=g.getLogger("esri.layers.graphics.sources.connections.GeoEventConnection"),q={maxQueryDepth:5,maxRecordCountFactor:3};m=function(a){function g(c){return a.call(this,b.__assign(b.__assign({},q),c))||this}b.__extends(g,a);g.prototype._open=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c,e,d,f;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this._fetchServiceDefinition(this._config.source)];
case 1:return a=b.sent(),a.timeInfo.trackIdField||p.warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect."),[4,this._fetchWebSocketUrl(a.streamUrls,this._config.spatialReference)];case 2:return c=b.sent(),this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),[4,this._buddyServicesQuery];case 3:return b.sent(),[4,this._tryCreateWebSocket(c)];case 4:return b.sent(),
e=this._config,d=e.filter,f=e.outFields,this.destroyed||this._setFilter(d,f),[2]}})})};g.prototype._onMessage=function(a){var c;try{c=this._enrich(JSON.parse(a.data)),this._featureZScaler&&this._featureZScaler(c.geometry)}catch(z){p.error(new h("geoevent-connection","Failed to parse message",z));return}this.onFeature(c)};g.prototype._fetchServiceDefinition=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f;return b.__generator(this,function(b){switch(b.label){case 0:return c=
{f:"json"},e=k(a.path,{query:c,responseType:"json"}),[4,e];case 1:return d=b.sent(),this._serviceDefinition=f=d.data,[2,f]}})})};g.prototype._fetchWebSocketUrl=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g;return b.__generator(this,function(b){e=a[0];d=e.urls;f=e.token;g=this._inferWebSocketBaseUrl(d);return[2,g+"/subscribe?outSR\x3d"+c.wkid+(f?"\x26token\x3d"+f:"")]})})};g.prototype._inferWebSocketBaseUrl=function(a){if(1===a.length)return a[0];for(var c=0;c<a.length;c++){var b=
a[c];if(-1!==b.indexOf("wss"))return b}p.error(new h("geoevent-connection","Unable to infer WebSocket url",a));return null};g.prototype._setFilter=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,g,n,k,l,q,t=this;return b.__generator(this,function(b){e=this._websocket;if(d.isNone(e)||d.isNone(a)&&d.isNone(c))return[2];g=JSON.stringify({filter:this._serializeFilter(a,c)});n=!1;k=f.createResolver();l=function(){n||(t.destroyed||t._websocket!==e||p.error(new h("geoevent-connection",
"Server timed out when setting filter")),k.reject())};q=function(a){a=JSON.parse(a.data);a.filter&&(a.error&&(p.error(new h("geoevent-connection","Failed to set service filter",a.error)),t._set("errorString","Could not set service filter - "+a.error),k.reject(a.error)),e.onmessage=t._onMessage.bind(t),n=!0,k.resolve())};e.onmessage=q;e.send(g);setTimeout(l,1E4);return[2,k.promise]})})};g.prototype._serializeFilter=function(a,c){var b={};if(d.isNone(a)&&d.isNone(c))return b;if(d.isSome(a)&&a.geometry)try{var e=
l.fromJSON(a.geometry);if("extent"!==e.type)throw new h("Expected extent but found type "+e.type);b.geometry=JSON.stringify(e.shiftCentralMeridian())}catch(C){p.error(new h("geoevent-connection","Encountered an error when setting connection geometryDefinition",C))}d.isSome(a)&&a.where&&"1 \x3d 1"!==a.where&&(b.where=a.where);d.isSome(c)&&(b.outFields=c.join(","));return b};g.prototype._enrich=function(a){if(!this._relatedFeatures)return a;var c=a.attributes[this._serviceDefinition.relatedFeatures.joinField];
if(!this._relatedFeatures.has(c))return p.warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",a),a;var b=this._relatedFeatures.get(c),c=b.attributes,b=b.geometry,e;for(e in c)a.attributes[e]=c[e];b&&(a.geometry=b);a.geometry||a.centroid||p.error(new h("geoevent-connection","Found malformed feature - no geometry found",a));return a};g.prototype._queryBuddyServices=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c,e,d,f,g,n,k,l,q;return b.__generator(this,
function(b){switch(b.label){case 0:return b.trys.push([0,3,,4]),a=this._serviceDefinition,c=a.relatedFeatures,e=a.keepLatestArchive,d=this._queryRelatedFeatures(c),f=this._queryArchive(e),[4,d];case 1:return b.sent(),[4,f];case 2:g=b.sent();if(!g)return[2];n=0;for(k=g.features;n<k.length;n++)l=k[n],this.onFeature(this._enrich(l));return[3,4];case 3:return q=b.sent(),p.error(new h("geoevent-connection","Encountered an error when querying buddy services",{error:q})),[3,4];case 4:return[2]}})})};g.prototype._queryRelatedFeatures=
function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return a?[4,this._queryBuddy(a.featuresUrl)]:[2];case 1:return c=b.sent(),this._addRelatedFeatures(c),[2]}})})};g.prototype._queryArchive=function(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(c){return a?[2,this._queryBuddy(a.featuresUrl)]:[2,void 0]})})};g.prototype._queryBuddy=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,
f,g,n,h,k,p,q,u,w;return b.__generator(this,function(b){switch(b.label){case 0:return c=new e({url:a}),[4,c.load()];case 1:return f=b.sent().capabilities,g=f.query.supportsMaxRecordCountFactor,n=f.query.supportsPagination,h=f.query.supportsCentroid,k=this._config.maxRecordCountFactor,p=c.capabilities.query.maxRecordCount,q=g?p*k:p,u=new x,u.outFields=d.unwrapOr(this._config.outFields,["*"]),u.where=d.unwrapOr(d.get(this._config.filter,"where"),"1\x3d1"),u.returnGeometry=!0,u.returnExceededLimitFeatures=
!0,u.outSpatialReference=l.SpatialReference.fromJSON(this._config.spatialReference),h&&(u.returnCentroid=!0),g&&(u.maxRecordCountFactor=k),n?(u.num=q,c.destroy(),[2,this._queryPages(a,u)]):[4,t.executeQuery(a,u,this._config.sourceSpatialReference)];case 2:return w=b.sent(),c.destroy(),[2,w.data]}})})};g.prototype._queryPages=function(a,c,e,d){void 0===e&&(e=[]);void 0===d&&(d=0);return b.__awaiter(this,void 0,void 0,function(){var f;return b.__generator(this,function(b){switch(b.label){case 0:return c.start=
d*c.num,[4,t.executeQuery(a,c,this._config.sourceSpatialReference)];case 1:f=b.sent().data;if(f.exceededTransferLimit&&d<this._config.maxQueryDepth)return f.features.forEach(function(a){return e.push(a)}),[2,this._queryPages(a,c,e,d+1)];e.forEach(function(a){return f.features.push(a)});return[2,f]}})})};g.prototype._addRelatedFeatures=function(a){var c=new Map,b=this._serviceDefinition.relatedFeatures.joinField,e=0;for(a=a.features;e<a.length;e++){var d=a[e];c.set(d.attributes[b],d)}this._relatedFeatures=
c};return g=b.__decorate([c.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],g)}(n.WebSocketConnection);a.default=m})},"esri/layers/FeatureLayer":function(){define("require exports tslib ../PopupTemplate ../renderers ../renderers ../request ../symbols ../core/Collection ../core/Error ../core/Handles ../core/jsonMap ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/object ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ../core/accessorSupport/extensions/serializableProperty/reader ../form/FormTemplate ../geometry/Extent ../geometry/HeightModelInfo ../geometry/SpatialReference ./Layer ./graphics/sources/MemorySource ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/arcgisLayerUrl ./support/commonProperties ./support/FeatureIndex ./support/FeatureReduction ./support/FeatureReductionCluster ./support/FeatureReductionSelection ./support/featureReductionUtils ./support/FeatureTemplate ./support/FeatureType ./support/fieldProperties ./support/FieldsIndex ./support/fieldUtils ./support/LabelClass ./support/labelingInfo ./support/Relationship ./support/TimeInfo ./support/source/DataLayerSource ../renderers/support/styleUtils ../support/popupUtils ../tasks/support/AttachmentQuery ../tasks/support/FeatureSet ../tasks/support/Query ../tasks/support/RelationshipQuery @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z,A,C,E,D,F,H,I,G,K,L,O,P,N,S,W,Q,V,R,T,X,da,fa,aa,ca,Z,ga,ea,la,ja,ua,xa,Da,Ea,ta,Aa){function U(a,c,b){return!(a&&a.hasOwnProperty(c)?!a[c]:!b)}function ma(a,c,b){return a&&a.hasOwnProperty(c)?a[c]:b}var ya=new n.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),ra={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",
keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},qa=t.getLogger("esri.layers.FeatureLayer"),sa=fa.defineFieldProperties();a=function(a){function n(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c._handles=new e;c.capabilities=null;c.copyright=null;c.displayField=null;c.definitionExpression=null;c.dynamicDataSource=null;c.editFieldsInfo=null;c.editingEnabled=!0;c.editingInfo=null;c.elevationInfo=null;c.featureReduction=null;c.fields=null;c.formTemplate=
null;c.fullExtent=null;c.gdbVersion=null;c.geometryProperties=null;c.geometryType=null;c.hasM=void 0;c.hasZ=void 0;c.heightModelInfo=null;c.historicMoment=null;c.isTable=!1;c.labelsVisible=!0;c.labelingInfo=null;c.layerId=void 0;c.legendEnabled=!0;c.minScale=0;c.maxScale=0;c.globalIdField=null;c.objectIdField=null;c.outFields=null;c.path=null;c.popupEnabled=!0;c.popupTemplate=null;c.relationships=null;c.sourceJSON=null;c.returnM=void 0;c.returnZ=void 0;c.screenSizePerspectiveEnabled=!0;c.serviceDefinitionExpression=
null;c.spatialReference=E.WGS84;c.templates=null;c.timeInfo=null;c.title=null;c.sublayerTitleMode="item-title";c.trackIdField=null;c.type="feature";c.typeIdField=null;c.types=null;c.indexes=new (f.ofType(W.FeatureIndex));c.userIsAdmin=!1;c.version=void 0;c.visible=!0;return c}b.__extends(n,a);n.prototype.destroy=function(){var a;null===(a=this.source)||void 0===a?void 0:a.destroy();this._handles&&(this._handles.destroy(),this._handles=null)};n.prototype.normalizeCtorArgs=function(a,c){return"string"===
typeof a?b.__assign({url:a},c):a};n.prototype.load=function(a){var e=this,d=x.isSome(a)?a.signal:null;if(this.portalItem&&this.portalItem.loaded&&this.source)this.addResolvingPromise(this.createGraphicsSource(d).then(function(a){return e._initLayerProperties(a)}));else return a=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},a).catch(function(a){return a}).then(function(){return b.__awaiter(e,void 0,void 0,function(){var a,e;return b.__generator(this,function(b){switch(b.label){case 0:return this.url&&
null==this.layerId&&/FeatureServer|MapServer\/*$/i.test(this.url)?[4,this._fetchFirstLayerId(d)]:[3,2];case 1:a=b.sent(),null!=a&&(this.layerId=a),b.label=2;case 2:if(!this.url&&!this._hasMemorySource())throw new c("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");e=this._initLayerProperties;return[4,this.createGraphicsSource(d)];case 3:return[2,e.apply(this,[b.sent()])]}})})}),this.addResolvingPromise(a),u.resolve(this)};n.prototype.readCapabilities=
function(a,c){c=c.layerDefinition||c;return{attachment:this._readAttachmentCapabilities(c.attachmentProperties),data:this._readDataCapabilities(c),metadata:this._readMetadataCapabilities(c),operations:this._readOperationsCapabilities(c.capabilities||a,c),query:this._readQueryCapabilities(c),queryRelated:this._readQueryRelatedCapabilities(c),editing:this._readEditingCapabilities(c)}};Object.defineProperty(n.prototype,"createQueryVersion",{get:function(){this.definitionExpression;this.dynamicDataSource;
this.timeExtent;this.timeOffset;this.geometryType;this.gdbVersion;this.historicMoment;this.returnZ;this.capabilities;this.returnM;return(this._get("createQueryVersion")||0)+1},enumerable:!1,configurable:!0});n.prototype.readEditingEnabled=function(a,c){return c.layerDefinition&&"Query"===c.layerDefinition.capabilities?!1:!0};n.prototype.writeEditingEnabled=function(a,c){a||q.setDeepValue("layerDefinition.capabilities","Query",c)};n.prototype.readEditingInfo=function(a,c){return(a=c.editingInfo)?{lastEditDate:null!=
a.lastEditDate?new Date(a.lastEditDate):null}:null};n.prototype.readFeatureReduction=function(a,c){return T.read(a,c)};n.prototype.writeWebSceneFeatureReduction=function(a,c,b,e){T.writeTarget(a,c,"layerDefinition.featureReduction",e)};Object.defineProperty(n.prototype,"fieldsIndex",{get:function(){return new aa(this.fields||[])},enumerable:!1,configurable:!0});n.prototype.readIsTable=function(a,c){c=c&&c.layerDefinition||c;return"Table"===c.type||!c.geometryType};Object.defineProperty(n.prototype,
"hasService",{get:function(){return!this._hasMemorySource()},enumerable:!1,configurable:!0});n.prototype.readMinScale=function(a,c){return c.effectiveMinScale||a||0};n.prototype.readMaxScale=function(a,c){return c.effectiveMaxScale||a||0};n.prototype.readGlobalIdFieldFromService=function(a,c){c=c.layerDefinition||c;if(c.globalIdField)return c.globalIdField;if(c.fields)for(a=0,c=c.fields;a<c.length;a++){var b=c[a];if("esriFieldTypeGlobalID"===b.type)return b.name}};n.prototype.readObjectIdFieldFromService=
function(a,c){c=c.layerDefinition||c;if(c.objectIdField)return c.objectIdField;if(c.fields)for(a=0,c=c.fields;a<c.length;a++){var b=c[a];if("esriFieldTypeOID"===b.type)return b.name}};Object.defineProperty(n.prototype,"parsedUrl",{get:function(){var a=this.url?y.urlToObject(this.url):null;null!=a&&(null!=this.dynamicDataSource?a.path=y.join(a.path,"dynamicLayer"):null!=this.layerId&&(a.path=y.join(a.path,this.layerId.toString())));return a},enumerable:!1,configurable:!0});Object.defineProperty(n.prototype,
"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!1,configurable:!0});Object.defineProperty(n.prototype,"renderer",{set:function(a){ca.fixRendererFields(a,this.fields);this._set("renderer",a)},enumerable:!1,configurable:!0});n.prototype.readRenderer=function(a,c,b){c=c.layerDefinition||c;if(a=c.drawingInfo&&c.drawingInfo.renderer||void 0)return(a=h.read(a,c,b)||void 0)||qa.error("Failed to create renderer",{rendererDefinition:c.drawingInfo.renderer,layer:this,context:b}),
a;if(c.defaultSymbol)return c.types&&c.types.length?new k.UniqueValueRenderer({defaultSymbol:na(c.defaultSymbol,c,b),field:c.typeIdField,uniqueValueInfos:c.types.map(function(a){return{id:a.id,symbol:na(a.symbol,a,b)}})}):new k.SimpleRenderer({symbol:na(c.defaultSymbol,c,b)})};Object.defineProperty(n.prototype,"source",{set:function(a){var c=this._get("source");c!==a&&(c&&c instanceof f&&this._resetMemorySource(c),a&&a instanceof f&&this._initMemorySource(a),this._set("source",a))},enumerable:!1,
configurable:!0});n.prototype.castSource=function(a){return a?Array.isArray(a)||a instanceof f?new F.default({layer:this,items:a}):a:null};n.prototype.readSource=function(a,c){a=Ea.fromJSON(c.featureSet);return new F.default({layer:this,items:a&&a.features||[]})};n.prototype.readServiceDefinitionExpression=function(a,c){return c.definitionQuery||c.definitionExpression};n.prototype.readTemplates=function(a,c){var b=c.editFieldsInfo;c=b&&b.creatorField;b=b&&b.editorField;a=a&&a.map(function(a){return X.fromJSON(a)});
this._fixTemplates(a,c);this._fixTemplates(a,b);return a};n.prototype.readTitle=function(a,c){a=c.layerDefinition&&c.layerDefinition.name||c.name;c=c.title||c.layerDefinition&&c.layerDefinition.title;if(a){c=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?N.titleFromUrlAndName(this.url,a):a;a=a||this.url&&N.parse(this.url).title;if(!a)return;"item-title-and-service-name"===this.sublayerTitleMode&&c&&c!==a&&(a=c+" - "+a);return N.cleanTitle(a)}if("item-title"===
this.sublayerTitleMode&&c)return c};n.prototype.readTitleFromWebMap=function(a,c){return c.title||c.layerDefinition&&c.layerDefinition.name};n.prototype.readTypeIdField=function(a,c){c=c.layerDefinition||c;if(a=c.typeIdField)if(c=ca.getField(c.fields,a))a=c.name;return a};n.prototype.readTypes=function(a,c){var b=this;c=c.layerDefinition||c;a=c.types;var e=(c=c.editFieldsInfo)&&c.creatorField,d=c&&c.editorField;return a&&a.map(function(a){a=da.fromJSON(a);b._fixTemplates(a.templates,e);b._fixTemplates(a.templates,
d);return a})};Object.defineProperty(n.prototype,"url",{set:function(a){a=N.sanitizeUrlWithLayerId(this,a,qa);this._set("url",a.url);null!=a.layerId&&this._set("layerId",a.layerId)},enumerable:!1,configurable:!0});n.prototype.writeUrl=function(a,c,b,e){N.writeUrlWithLayerId(this,a,null,c,e)};n.prototype.readVersion=function(a,c){return c.currentVersion?c.currentVersion:c.hasOwnProperty("capabilities")||c.hasOwnProperty("drawingInfo")||c.hasOwnProperty("hasAttachments")||c.hasOwnProperty("htmlPopupType")||
c.hasOwnProperty("relationships")||c.hasOwnProperty("timeInfo")||c.hasOwnProperty("typeIdField")||c.hasOwnProperty("types")?10:9.3};n.prototype.readVisible=function(a,c){if(c.layerDefinition&&null!=c.layerDefinition.defaultVisibility)return!!c.layerDefinition.defaultVisibility;if(null!=c.visibility)return!!c.visibility};n.prototype.addAttachment=function(a,b){var e=this;return this.load().then(function(){return e._checkAttachmentSupport(a)}).then(function(){if(!("addAttachment"in e.source))throw new c("FeatureLayer",
"Layer source does not support addAttachment capability");return e.source.addAttachment(a,b)})};n.prototype.updateAttachment=function(a,b,e){var d=this;return this.load().then(function(){return d._checkAttachmentSupport(a)}).then(function(){if(!("updateAttachment"in d.source))throw new c("FeatureLayer","Layer source does not support updateAttachment capability");return d.source.updateAttachment(a,b,e)})};n.prototype.applyEdits=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,
function(b){switch(b.label){case 0:return[4,new Promise(function(a,c){m(["./graphics/editingSupport"],a,c)})];case 1:return e=b.sent(),[2,e.applyEdits(this,a,c)]}})})};n.prototype.on=function(c,b){return a.prototype.on.call(this,c,b)};n.prototype.createPopupTemplate=function(a){return xa.createPopupTemplate(this,a)};n.prototype.createGraphicsSource=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e;return b.__generator(this,function(b){switch(b.label){case 0:return this._hasMemorySource()?
(this.emit("graphics-source-create",{graphicsSource:this.source}),[2,this.source.load({signal:a})]):[4,new Promise(function(a,c){m(["./graphics/sources/FeatureLayerSource"],a,c)})];case 1:return c=b.sent(),u.throwIfAborted(a),[4,(new c.default({layer:this})).load({signal:a})];case 2:return e=b.sent(),this.emit("graphics-source-create",{graphicsSource:e}),[2,e]}})})};n.prototype.createQuery=function(){var a=new ta,c=this.get("capabilities.data");a.dynamicDataSource=this.dynamicDataSource;a.gdbVersion=
this.gdbVersion;a.historicMoment=this.historicMoment;a.returnGeometry=!0;c&&(c.supportsZ&&null!=this.returnZ&&(a.returnZ=this.returnZ),c.supportsM&&null!=this.returnM&&(a.returnM=this.returnM));a.outFields=["*"];a.where=this.definitionExpression||"1\x3d1";var c=this.timeOffset,b=this.timeExtent;a.timeExtent=null!=c&&null!=b?b.offset(-c.value,c.unit):b||null;a.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null;return a};n.prototype.deleteAttachments=function(a,b){var e=this;return this.load().then(function(){return e._checkAttachmentSupport(a)}).then(function(){if(!("deleteAttachments"in
e.source))throw new c("FeatureLayer","Layer source does not support deleteAttachments capability");return e.source.deleteAttachments(a,b)})};n.prototype.getFeatureType=function(a){var c=this.typeIdField;if(!c||!a)return null;var b=a.attributes?a.attributes[c]:void 0;if(null==b)return null;var e=null;this.types.some(function(a){var c=a.id;if(null==c)return!1;c.toString()===b.toString()&&(e=a);return!!e});return e};n.prototype.getFieldDomain=function(a,c){return(c=this.getFeatureType(c&&c.feature))&&
(c=c.domains&&c.domains[a])&&"inherited"!==c.type?c:this._getLayerDomain(a)};n.prototype.getField=function(a){return this.fieldsIndex.get(a)};n.prototype.queryAttachments=function(a,b){var e=this;a=Da.from(a);return this.load().then(function(){if(!e.get("capabilities.data.supportsAttachment"))throw new c("FeatureLayer","this layer doesn't support attachments");var b=a.attachmentTypes,d=a.objectIds,f=a.globalIds,g=a.num,n=a.size,h=a.start,k=a.where;if(!e.get("capabilities.operations.supportsQueryAttachments")&&
(b=b&&b.length,f=f&&f.length,n=n&&n.length,d&&1<d.length||b||f||n||g||h||k))throw new c("FeatureLayer","when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",a);if(!(d&&d.length||k))throw new c("FeatureLayer","'objectIds' or 'where' are required to perform attachment query",a);if(!("queryAttachments"in e.source))throw new c("FeatureLayer","Layer source does not support queryAttachments capability",a);return e.source.queryAttachments(a)})};n.prototype.queryFeatures=function(a,
c){var b=this;return this.load().then(function(){return b.source.queryFeatures(ta.from(a)||b.createQuery(),c)}).then(function(a){if(a&&a.features)for(var c=0,e=a.features;c<e.length;c++){var d=e[c];d.layer=d.sourceLayer=b}return a})};n.prototype.queryObjectIds=function(a,b){var e=this;return this.load().then(function(){if(e.source.queryObjectIds)return e.source.queryObjectIds(ta.from(a)||e.createQuery(),b);throw new c("FeatureLayer","Layer source does not support queryObjectIds capability");})};n.prototype.queryFeatureCount=
function(a,b){var e=this;return this.load().then(function(){if(e.source.queryFeatureCount)return e.source.queryFeatureCount(ta.from(a)||e.createQuery(),b);throw new c("FeatureLayer","Layer source does not support queryFeatureCount capability");})};n.prototype.queryExtent=function(a,b){var e=this;return this.load().then(function(){if(e.source.queryExtent)return e.source.queryExtent(ta.from(a)||e.createQuery(),b);throw new c("FeatureLayer","Layer source does not support queryExtent capability");})};
n.prototype.queryRelatedFeatures=function(a,b){var e=this;return this.load().then(function(){if("queryRelatedFeatures"in e.source)return e.source.queryRelatedFeatures(Aa.from(a),b);throw new c("FeatureLayer","Layer source does not support queryRelatedFeatures capability");})};n.prototype.queryRelatedFeaturesCount=function(a,b){var e=this;return this.load().then(function(){if("queryRelatedFeaturesCount"in e.source)return e.source.queryRelatedFeaturesCount(Aa.from(a),b);throw new c("FeatureLayer","Layer source does not support queryRelatedFeaturesCount capability");
})};n.prototype.read=function(c,b){var e=c.featureCollection;if(e){var d=e.layers;d&&1===d.length&&(a.prototype.read.call(this,d[0],b),null!=e.showLegend&&a.prototype.read.call(this,{showLegend:e.showLegend},b))}a.prototype.read.call(this,c,b);b&&"service"===b.origin&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")};n.prototype.write=function(b,e){if(e){var d=e.origin,f=e.layerContainerType,g=e.messages;if(this.isTable){if("web-scene"===d||"web-map"===d&&"tables"!==
f)return g&&g.push(new c("layer:unsupported","Layer ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a Table source cannot be written to web scenes and web maps",{layer:this})),null;if(this._hasMemorySource())return g&&g.push(new c("layer:unsupported","Layer ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using an in-memory Table source cannot be written to web scenes and web maps",{layer:this})),null}else if(this.loaded&&"web-map"===d&&"tables"===f)return g&&g.push(new c("layer:unsupported",
"Layer ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' using a non-table source cannot be written to tables in web maps",{layer:this})),null}return a.prototype.write.call(this,b,e)};n.prototype._checkAttachmentSupport=function(a){var b=a.attributes,e=this.objectIdField;if(!this.get("capabilities.data.supportsAttachment"))return u.reject(new c("FeatureLayer","this layer doesn't support attachments"));if(!a)return u.reject(new c("FeatureLayer","A feature is required to add/delete/update attachments"));
if(!b)return u.reject(new c("FeatureLayer","'attributes' are required on a feature to query attachments"));if(!b[e])return u.reject(new c("FeatureLayer","feature is missing the identifying attribute "+e))};n.prototype._getLayerDomain=function(a){return(a=this.fieldsIndex.get(a))?a.domain:null};n.prototype._fetchFirstLayerId=function(a){return g(this.url,{query:{f:"json"},responseType:"json",signal:a}).then(function(a){if(a=a.data){if(Array.isArray(a.layers)&&0<a.layers.length)return a.layers[0].id;
if(Array.isArray(a.tables)&&0<a.tables.length)return a.tables[0].id}})};n.prototype._initLayerProperties=function(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(c){this._set("source",a);a.sourceJSON&&(this.sourceJSON=a.sourceJSON,this.read(a.sourceJSON,{origin:"service",url:this.parsedUrl}));this._verifySource();this._verifyFields();ca.fixRendererFields(this.renderer,this.fields);ca.fixTimeInfoFields(this.timeInfo,this.fields);return[2,ua.loadStyleRenderer(this,
{origin:"service"})]})})};n.prototype._verifyFields=function(){var a=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+a+")");this.isTable||this._hasMemorySource()||-1!==a.search(/\/FeatureServer\//i)||this.fields&&this.fields.some(function(a){return"geometry"===a.type})||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+
a+")")};n.prototype._fixTemplates=function(a,c){a&&a.forEach(function(a){(a=a.prototype&&a.prototype.attributes)&&c&&delete a[c]})};n.prototype._verifySource=function(){if(this._hasMemorySource()){if(this.url)throw new c("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url");}else if(!this.url)throw new c("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source");};n.prototype._initMemorySource=
function(a){var c=this;a.forEach(function(a){a.layer=c;a.sourceLayer=c});this._handles.add([a.on("after-add",function(a){a.item.layer=c;a.item.sourceLayer=c}),a.on("after-remove",function(a){a.item.layer=null;a.item.sourceLayer=null})],"fl-source")};n.prototype._resetMemorySource=function(a){a.forEach(function(a){a.layer=null;a.sourceLayer=null});this._handles.remove("fl-source")};n.prototype._hasMemorySource=function(){return!(this.url||!this.source)};n.prototype._readAttachmentCapabilities=function(a){var c=
{supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};a&&Array.isArray(a)&&a.forEach(function(a){var b=ra[a.name];b&&(c[b]=!!a.isEnabled)});return c};n.prototype._readDataCapabilities=function(a){return{isVersioned:U(a,"isDataVersioned",!1),supportsAttachment:U(a,"hasAttachments",!1),supportsM:U(a,"hasM",!1),supportsZ:U(a,"hasZ",!1)}};n.prototype._readMetadataCapabilities=function(a){return{supportsAdvancedFieldProperties:U(a,"supportsFieldDescriptionProperty",
!1)}};n.prototype._readOperationsCapabilities=function(a,c){a=a?a.toLowerCase().split(",").map(function(a){return a.trim()}):[];var b=-1!==a.indexOf("editing"),e=b&&-1!==a.indexOf("create"),d=b&&-1!==a.indexOf("delete"),f=b&&-1!==a.indexOf("update");!b||e||d||f||(e=d=f=!0);return{supportsCalculate:U(c,"supportsCalculate",!1),supportsTruncate:U(c,"supportsTruncate",!1),supportsValidateSql:U(c,"supportsValidateSql",!1),supportsAdd:e,supportsDelete:d,supportsEditing:b,supportsQuery:-1!==a.indexOf("query"),
supportsQueryAttachments:U(c.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:U(c,"supportsAttachmentsResizing",!1),supportsSync:-1!==a.indexOf("sync"),supportsUpdate:f,supportsExceedsLimitStatistics:U(c,"supportsExceedsLimitStatistics",!1)}};n.prototype._readQueryCapabilities=function(a){var c=a.advancedQueryCapabilities,b=a.ownershipBasedAccessControlForFeatures,e=a.archivingInfo,d=(a.supportedQueryFormats||"").split(",").reduce(function(a,c){(c=c.toLowerCase().trim())&&
a.add(c);return a},new Set);return{supportsStatistics:U(c,"supportsStatistics",a.supportsStatistics),supportsPercentileStatistics:U(c,"supportsPercentileStatistics",!1),supportsCentroid:U(c,"supportsReturningGeometryCentroid",!1),supportsDistance:U(c,"supportsQueryWithDistance",!1),supportsDistinct:U(c,"supportsDistinct",a.supportsAdvancedQueries),supportsExtent:U(c,"supportsReturningQueryExtent",!1),supportsGeometryProperties:U(c,"supportsReturningGeometryProperties",!1),supportsHavingClause:U(c,
"supportsHavingClause",!1),supportsOrderBy:U(c,"supportsOrderBy",a.supportsAdvancedQueries),supportsPagination:U(c,"supportsPagination",!1),supportsQuantization:U(a,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:U(a,"supportsQuantizationEditMode",!1),supportsQueryGeometry:U(a,"supportsReturningQueryGeometry",!1),supportsResultType:U(c,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:U(c,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:U(c,"supportsSqlExpression",
!1),supportsStandardizedQueriesOnly:U(a,"useStandardizedQueries",!1),supportsQueryByOthers:U(b,"allowOthersToQuery",!0),supportsHistoricMoment:U(e,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:d.has("pbf"),supportsDisjointSpatialRelationship:U(c,"supportsDisjointSpatialRel",!1),supportsCacheHint:U(c,"supportsQueryWithCacheHint",!1),maxRecordCountFactor:ma(a,"maxRecordCountFactor",void 0),maxRecordCount:ma(a,"maxRecordCount",void 0),standardMaxRecordCount:ma(a,"standardMaxRecordCount",void 0),
tileMaxRecordCount:ma(a,"tileMaxRecordCount",void 0)}};n.prototype._readQueryRelatedCapabilities=function(a){a=a.advancedQueryCapabilities;var c=U(a,"supportsAdvancedQueryRelated",!1);return{supportsPagination:U(a,"supportsQueryRelatedPagination",!1),supportsCount:c,supportsOrderBy:c}};n.prototype._readEditingCapabilities=function(a){var c=a.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:U(a,"allowGeometryUpdates",!0),supportsGlobalId:U(a,"supportsApplyEditsWithGlobalIds",!1),
supportsRollbackOnFailure:U(a,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:U(a,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:U(a,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:U(c,"allowAnonymousToDelete",!0),supportsDeleteByOthers:U(c,"allowOthersToDelete",!0),supportsUpdateByAnonymous:U(c,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:U(c,"allowOthersToUpdate",!0)}};b.__decorate([w.property({readOnly:!0,json:{read:!1}})],n.prototype,"capabilities",
void 0);b.__decorate([w.reader("service","capabilities","advancedQueryCapabilities allowGeometryUpdates allowUpdateWithoutMValues archivingInfo capabilities hasAttachments hasM hasZ maxRecordCount maxRecordCountFactor ownershipBasedAccessControlForFeatures standardMaxRecordCount supportedQueryFormats supportsAdvancedQueries supportsApplyEditsWithGlobalIds supportsAttachmentsByUploadId supportsAttachmentsResizing supportsCalculate supportsCoordinatesQuantization supportsExceedsLimitStatistics supportsFieldDescriptionProperty supportsQuantizationEditMode supportsRollbackOnFailureParameter supportsStatistics supportsTruncate supportsValidateSql tileMaxRecordCount useStandardizedQueries".split(" "))],
n.prototype,"readCapabilities",null);b.__decorate([w.property({readOnly:!0,dependsOn:"definitionExpression dynamicDataSource timeExtent timeOffset geometryType gdbVersion historicMoment returnZ capabilities returnM".split(" ")})],n.prototype,"createQueryVersion",null);b.__decorate([w.property({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],n.prototype,"copyright",void 0);b.__decorate([w.property({type:String,json:{read:{source:"layerDefinition.displayField"},
origins:{service:{read:{source:"displayField"}}}}})],n.prototype,"displayField",void 0);b.__decorate([w.property({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],n.prototype,"definitionExpression",void 0);b.__decorate([w.property({types:d.symbolTypes,readOnly:!0})],n.prototype,"defaultSymbol",void 0);b.__decorate([w.property({type:ja.DataLayerSource})],n.prototype,"dynamicDataSource",
void 0);b.__decorate([w.property({readOnly:!0})],n.prototype,"editFieldsInfo",void 0);b.__decorate([w.property({type:Boolean})],n.prototype,"editingEnabled",void 0);b.__decorate([w.reader(["portal-item","web-map","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],n.prototype,"readEditingEnabled",null);b.__decorate([w.writer(["portal-item","web-map","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],n.prototype,"writeEditingEnabled",null);b.__decorate([w.property({readOnly:!0})],
n.prototype,"editingInfo",void 0);b.__decorate([w.reader("editingInfo")],n.prototype,"readEditingInfo",null);b.__decorate([w.property(S.elevationInfo)],n.prototype,"elevationInfo",void 0);b.__decorate([w.property({types:{key:"type",base:Q.default,typeMap:{selection:R,cluster:V}},json:{write:{target:"layerDefinition.featureReduction"}}})],n.prototype,"featureReduction",void 0);b.__decorate([w.reader("featureReduction",["layerDefinition.featureReduction"])],n.prototype,"readFeatureReduction",null);
b.__decorate([w.writer("web-scene","featureReduction",{"layerDefinition.featureReduction":{types:T.webSceneFeatureReductionTypes}})],n.prototype,"writeWebSceneFeatureReduction",null);b.__decorate([w.property(b.__assign(b.__assign({},sa.fields),{json:{origins:{service:{read:!0}},read:{source:"layerDefinition.fields"}}}))],n.prototype,"fields",void 0);b.__decorate([w.property({readOnly:!0,dependsOn:["fields"]})],n.prototype,"fieldsIndex",null);b.__decorate([w.property({type:z,json:{name:"formInfo",
write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],n.prototype,"formTemplate",void 0);b.__decorate([w.property({type:A,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],n.prototype,"fullExtent",void 0);b.__decorate([w.property()],n.prototype,"gdbVersion",void 0);b.__decorate([w.property({readOnly:!0})],n.prototype,"geometryProperties",void 0);b.__decorate([w.property({type:"point polygon polyline multipoint multipatch mesh".split(" "),json:{origins:{service:{read:ya.read}},
read:{source:"layerDefinition.geometryType",reader:ya.read}}})],n.prototype,"geometryType",void 0);b.__decorate([w.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],n.prototype,"hasM",void 0);b.__decorate([w.property({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],n.prototype,"hasZ",void 0);b.__decorate([w.property({readOnly:!0,type:C})],n.prototype,"heightModelInfo",void 0);b.__decorate([w.property({type:Date})],
n.prototype,"historicMoment",void 0);b.__decorate([w.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],n.prototype,"id",void 0);b.__decorate([w.property({readOnly:!0})],n.prototype,"isTable",void 0);b.__decorate([w.reader("service","isTable",["type","geometryType"]),w.reader("isTable",["layerDefinition.type","layerDefinition.geometryType"])],n.prototype,"readIsTable",null);b.__decorate([w.property({dependsOn:["loaded","url","source"],readOnly:!0})],n.prototype,"hasService",null);
b.__decorate([w.property(S.labelsVisible)],n.prototype,"labelsVisible",void 0);b.__decorate([w.property({type:[Z],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:ga.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:ga.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],n.prototype,"labelingInfo",void 0);b.__decorate([w.property(S.opacityDrawingInfo)],n.prototype,"opacity",void 0);b.__decorate([w.property({type:Number,
json:{origins:{service:{read:{source:"id"}}},read:!1}})],n.prototype,"layerId",void 0);b.__decorate([w.property(S.legendEnabled)],n.prototype,"legendEnabled",void 0);b.__decorate([w.property({type:["show","hide"]})],n.prototype,"listMode",void 0);b.__decorate([w.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}})],n.prototype,"minScale",void 0);b.__decorate([w.reader("service","minScale",["minScale",
"effectiveMinScale"])],n.prototype,"readMinScale",null);b.__decorate([w.property({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}})],n.prototype,"maxScale",void 0);b.__decorate([w.reader("service","maxScale",["maxScale","effectiveMaxScale"])],n.prototype,"readMaxScale",null);b.__decorate([w.property({type:String})],n.prototype,"globalIdField",void 0);b.__decorate([w.reader("globalIdField",["layerDefinition.globalIdField",
"layerDefinition.fields"]),w.reader("service","globalIdField",["globalIdField","fields"])],n.prototype,"readGlobalIdFieldFromService",null);b.__decorate([w.property({type:String})],n.prototype,"objectIdField",void 0);b.__decorate([w.reader("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),w.reader("service","objectIdField",["objectIdField","fields"])],n.prototype,"readObjectIdFieldFromService",null);b.__decorate([w.property({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],
n.prototype,"operationalLayerType",void 0);b.__decorate([w.property(sa.outFields)],n.prototype,"outFields",void 0);b.__decorate([w.property({readOnly:!0,dependsOn:["layerId","dynamicDataSource"]})],n.prototype,"parsedUrl",null);b.__decorate([w.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],n.prototype,"path",void 0);b.__decorate([w.property(S.popupEnabled)],n.prototype,"popupEnabled",void 0);b.__decorate([w.property({type:l,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],
n.prototype,"popupTemplate",void 0);b.__decorate([w.property({readOnly:!0,dependsOn:["fields","title"]})],n.prototype,"defaultPopupTemplate",null);b.__decorate([w.property({type:[ea],readOnly:!0})],n.prototype,"relationships",void 0);b.__decorate([w.property({types:k.rendererTypes,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:k.webSceneRendererTypes,write:{target:"layerDefinition.drawingInfo.renderer",writer:h.write}}},write:{target:"layerDefinition.drawingInfo.renderer",
writer:h.write}}})],n.prototype,"renderer",null);b.__decorate([w.reader("service","renderer",["drawingInfo.renderer","defaultSymbol","type"]),w.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol","layerDefinition.type"])],n.prototype,"readRenderer",null);b.__decorate([w.property()],n.prototype,"sourceJSON",void 0);b.__decorate([w.property({type:Boolean})],n.prototype,"returnM",void 0);b.__decorate([w.property({type:Boolean})],n.prototype,"returnZ",void 0);b.__decorate([w.property(S.screenSizePerspectiveEnabled)],
n.prototype,"screenSizePerspectiveEnabled",void 0);b.__decorate([w.property()],n.prototype,"source",null);b.__decorate([w.cast("source")],n.prototype,"castSource",null);b.__decorate([w.reader("portal-item","source",["featureSet"]),w.reader("web-map","source",["featureSet"])],n.prototype,"readSource",null);b.__decorate([w.property({readOnly:!0})],n.prototype,"serviceDefinitionExpression",void 0);b.__decorate([w.reader("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],
n.prototype,"readServiceDefinitionExpression",null);b.__decorate([w.property({type:E,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],n.prototype,"spatialReference",void 0);b.__decorate([w.property({type:[X]})],n.prototype,"templates",void 0);b.__decorate([w.reader("templates",["editFieldsInfo","creatorField","editorField","templates"])],n.prototype,"readTemplates",null);b.__decorate([w.property({type:la})],n.prototype,"timeInfo",
void 0);b.__decorate([w.property()],n.prototype,"title",void 0);b.__decorate([w.reader("service","title",["name"]),w.reader("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],n.prototype,"readTitle",null);b.__decorate([w.reader("web-map","title",["layerDefinition.name","title"])],n.prototype,"readTitleFromWebMap",null);b.__decorate([w.property({type:String})],n.prototype,"sublayerTitleMode",void 0);b.__decorate([w.property({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],
n.prototype,"trackIdField",void 0);b.__decorate([w.property({json:{read:!1}})],n.prototype,"type",void 0);b.__decorate([w.property({type:String})],n.prototype,"typeIdField",void 0);b.__decorate([w.reader("service","typeIdField"),w.reader("typeIdField",["layerDefinition.typeIdField"])],n.prototype,"readTypeIdField",null);b.__decorate([w.property({type:[da]})],n.prototype,"types",void 0);b.__decorate([w.reader("service","types",["types"]),w.reader("types",["layerDefinition.types"])],n.prototype,"readTypes",
null);b.__decorate([w.property({type:f.ofType(W.FeatureIndex),readOnly:!0})],n.prototype,"indexes",void 0);b.__decorate([w.property(S.url)],n.prototype,"url",null);b.__decorate([w.writer("url")],n.prototype,"writeUrl",null);b.__decorate([w.property({readOnly:!0})],n.prototype,"userIsAdmin",void 0);b.__decorate([w.property({json:{origins:{service:{read:!0}},read:!1}})],n.prototype,"version",void 0);b.__decorate([w.reader("service","version","currentVersion capabilities drawingInfo hasAttachments htmlPopupType relationships timeInfo typeIdField types".split(" "))],
n.prototype,"readVersion",null);b.__decorate([w.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],n.prototype,"visible",void 0);b.__decorate([w.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],n.prototype,"readVisible",null);return n=b.__decorate([w.subclass("esri.layers.FeatureLayer")],n)}(I.BlendLayer(P.TemporalLayer(O.ScaleRangeLayer(L.RefreshableLayer(H.ArcGISService(G.OperationalLayer(K.PortalLayer(p.MultiOriginJSONMixin(D)))))))));
var na=B.createTypeReader({types:d.symbolTypesRenderer});return a})},"esri/renderers":function(){define("require exports ./renderers/ClassBreaksRenderer ./renderers/DictionaryRenderer ./renderers/DotDensityRenderer ./renderers/HeatmapRenderer ./renderers/Renderer ./renderers/SimpleRenderer ./renderers/UniqueValueRenderer ./renderers/support/jsonUtils ./renderers/support/types".split(" "),function(m,a,b,l,k,h,g,d,f,c,e){Object.defineProperty(a,"__esModule",{value:!0});a.isRenderer=a.UniqueValueRenderer=
a.SimpleRenderer=a.BaseRenderer=a.HeatmapRenderer=a.DotDensityRenderer=a.DictionaryRenderer=a.ClassBreaksRenderer=void 0;a.ClassBreaksRenderer=b;a.DictionaryRenderer=l;a.DotDensityRenderer=k;a.HeatmapRenderer=h;a.BaseRenderer=g;a.SimpleRenderer=d;a.UniqueValueRenderer=f;a.isRenderer=function(a){return a instanceof g};Object.defineProperty(a,"read",{enumerable:!0,get:function(){return c.read}});Object.defineProperty(a,"write",{enumerable:!0,get:function(){return c.write}});Object.defineProperty(a,
"fromJSON",{enumerable:!0,get:function(){return c.fromJSON}});Object.defineProperty(a,"rendererTypes",{enumerable:!0,get:function(){return e.rendererTypes}});Object.defineProperty(a,"webSceneRendererTypes",{enumerable:!0,get:function(){return e.webSceneRendererTypes}})})},"esri/renderers/ClassBreaksRenderer":function(){define("require exports tslib ../symbols ../core/jsonMap ../core/lang ../core/Logger ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./support/commonProperties ./support/LegendOptions ../support/arcadeOnDemand".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y){var w=g.getLogger("esri.renderers.ClassBreaksRenderer"),B=new k.default({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),z=e.ensureType(p);return function(a){function g(c){c=a.call(this,c)||this;c.backgroundFillSymbol=null;c.classBreakInfos=null;c.defaultLabel=null;c.defaultSymbol=null;c.field=null;c.isMaxInclusive=!0;c.legendOptions=null;c.normalizationField=null;c.normalizationTotal=null;c.type=
"class-breaks";c.valueExpression=null;c.valueExpressionTitle=null;c._set("classBreakInfos",[]);return c}b.__extends(g,a);k=g;Object.defineProperty(g.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!1,configurable:!0});g.prototype.readClassBreakInfos=function(a,c,b){if(Array.isArray(a)){var e=c.minValue;return a.map(function(a){var c=new p;c.read(a,b);null==c.minValue&&(c.minValue=e);null==c.maxValue&&(c.maxValue=c.minValue);e=c.maxValue;return c})}};g.prototype.writeClassBreakInfos=
function(a,c,b,e){a=a.map(function(a){return a.write({},e)});this._areClassBreaksConsecutive()&&a.forEach(function(a){return delete a.classMinValue});c[b]=a};g.prototype.castField=function(a){return null==a?a:"function"===typeof a?(w.error(".field: field must be a string value"),null):e.ensureString(a)};Object.defineProperty(g.prototype,"minValue",{get:function(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,
"normalizationType",{get:function(){var a=this._get("normalizationType"),c=!!this.normalizationField,b=null!=this.normalizationTotal;if(c||b)a=c&&"field"||b&&"percent-of-total"||null,c&&b&&w.warn("warning: both normalizationField and normalizationTotal are set!");else if("field"===a||"percent-of-total"===a)a=null;return a},set:function(a){this._set("normalizationType",a)},enumerable:!1,configurable:!0});g.prototype.addClassBreakInfo=function(a,c,b){var e=null,e="number"===typeof a?new p({minValue:a,
maxValue:c,symbol:l.ensureType(b)}):z(h.clone(a));this.classBreakInfos.push(e);1===this.classBreakInfos.length&&this.notifyChange("minValue")};g.prototype.removeClassBreakInfo=function(a,c){for(var b=this.classBreakInfos.length,e=0;e<b;e++){var d=[this.classBreakInfos[e].minValue,this.classBreakInfos[e].maxValue];if(d[0]===a&&d[1]===c){this.classBreakInfos.splice(e,1);break}}};g.prototype.getBreakIndex=function(a,c){this.valueExpression&&(d.isNone(c)||d.isNone(c.arcade))&&w.warn("");return this.valueExpression?
this._getBreakIndexForExpression(a,c):this._getBreakIndexForField(a)};g.prototype.getClassBreakInfo=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,f,g,n;return b.__generator(this,function(h){switch(h.label){case 0:e=c;if(!this.valueExpression||!d.isNone(c)&&!d.isNone(c.arcade))return[3,2];f=[b.__assign({},e)];g={};return[4,y.loadArcade()];case 1:e=b.__assign.apply(void 0,f.concat([(g.arcade=h.sent(),g)])),h.label=2;case 2:return n=this.getBreakIndex(a,e),[2,-1!==n?this.classBreakInfos[n]:
null]}})})};g.prototype.getSymbol=function(a,c){if(this.valueExpression&&(d.isNone(c)||d.isNone(c.arcade)))w.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");else return a=this.getBreakIndex(a,c),-1<a?this.classBreakInfos[a].symbol:this.defaultSymbol};g.prototype.getSymbolAsync=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,f,g,n;return b.__generator(this,function(h){switch(h.label){case 0:e=c;if(!this.valueExpression||!d.isNone(c)&&!d.isNone(c.arcade))return[3,
2];f=[b.__assign({},e)];g={};return[4,y.loadArcade()];case 1:e=b.__assign.apply(void 0,f.concat([(g.arcade=h.sent(),g)])),h.label=2;case 2:return n=this.getBreakIndex(a,e),[2,-1<n?this.classBreakInfos[n].symbol:this.defaultSymbol]}})})};g.prototype.getSymbols=function(){var a=[];this.classBreakInfos.forEach(function(c){c.symbol&&a.push(c.symbol)});this.defaultSymbol&&a.push(this.defaultSymbol);return a};g.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,
c){return a+c.getAttributeHash()},"")};g.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),c=JSON.stringify(this.defaultSymbol),b=this.normalizationField+"."+this.normalizationType+"."+this.normalizationTotal,e=this.classBreakInfos.reduce(function(a,c){return a+c.getMeshHash()},"");return a+"."+c+"."+e+"."+b+"."+this.field+"."+this.valueExpression};Object.defineProperty(g.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression},
enumerable:!1,configurable:!0});g.prototype.clone=function(){return new k({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:h.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,
normalizationType:this.normalizationType,visualVariables:h.clone(this.visualVariables),legendOptions:h.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};g.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return e=[this.collectVVRequiredFields(a,c),this.collectSymbolFields(a,c)],[4,f.all(e)];case 1:return b.sent(),[2]}})})};g.prototype.collectSymbolFields=
function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(d){switch(d.label){case 0:return e=b.__spreadArrays(this.getSymbols().map(function(b){return b.collectRequiredFields(a,c)}),[n.collectArcadeFieldNames(a,c,this.valueExpression)]),n.collectField(a,c,this.field),n.collectField(a,c,this.normalizationField),[4,f.all(e)];case 1:return d.sent(),[2]}})})};g.prototype._getBreakIndexForExpression=function(a,c){var b=d.unwrapOr(c,{});c=b.viewingMode;var e=
b.scale,f=b.spatialReference,g=this._cache.compiledFunc,b=d.unwrap(b.arcade).arcadeUtils;g||(g=b.createSyntaxTree(this.valueExpression),g=b.createFunction(g),this._cache.compiledFunc=g);a=b.executeFunction(g,b.createExecContext(a,b.getViewInfo({viewingMode:c,scale:e,spatialReference:f})));return this._getBreakIndexfromInfos(a)};g.prototype._getBreakIndexForField=function(a){var c=a.attributes;a=this.normalizationType;var b=parseFloat(c[this.field]);if(a){var e=this.normalizationTotal,c=parseFloat(c[this.normalizationField]);
if("log"===a)b=Math.log(b)*Math.LOG10E;else if("percent-of-total"===a&&!isNaN(e))b=b/e*100;else if("field"===a&&!isNaN(c)){if(isNaN(b)||isNaN(c))return-1;b/=c}}return this._getBreakIndexfromInfos(b)};g.prototype._getBreakIndexfromInfos=function(a){var c=this.isMaxInclusive;if(null!=a&&"number"===typeof a&&!isNaN(a))for(var b=0;b<this.classBreakInfos.length;b++){var e=[this.classBreakInfos[b].minValue,this.classBreakInfos[b].maxValue];if(e[0]<=a&&(c?a<=e[1]:a<e[1]))return b}return-1};g.prototype._areClassBreaksConsecutive=
function(){for(var a=this.classBreakInfos,c=a.length,b=1;b<c;b++)if(a[b-1].maxValue!==a[b].minValue)return!1;return!0};var k;b.__decorate([c.property({readOnly:!0,dependsOn:["valueExpression"]})],g.prototype,"_cache",null);b.__decorate([c.property(q.rendererBackgroundFillSymbolProperty)],g.prototype,"backgroundFillSymbol",void 0);b.__decorate([c.property({type:[p]})],g.prototype,"classBreakInfos",void 0);b.__decorate([c.reader("classBreakInfos")],g.prototype,"readClassBreakInfos",null);b.__decorate([c.writer("classBreakInfos")],
g.prototype,"writeClassBreakInfos",null);b.__decorate([c.property({type:String,json:{write:!0}})],g.prototype,"defaultLabel",void 0);b.__decorate([c.property(q.rendererSymbolProperty)],g.prototype,"defaultSymbol",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],g.prototype,"field",void 0);b.__decorate([c.cast("field")],g.prototype,"castField",null);b.__decorate([c.property({type:Boolean})],g.prototype,"isMaxInclusive",void 0);b.__decorate([c.property({type:u.default,json:{write:!0}})],
g.prototype,"legendOptions",void 0);b.__decorate([c.property({type:Number,readOnly:!0,value:null,dependsOn:["classBreakInfos"],json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],g.prototype,"minValue",null);b.__decorate([c.property({type:String,json:{write:!0}})],g.prototype,"normalizationField",void 0);b.__decorate([c.property({type:Number,cast:function(a){return e.ensureNumber(a)},json:{write:!0}})],
g.prototype,"normalizationTotal",void 0);b.__decorate([c.property({type:B.apiValues,value:null,dependsOn:["normalizationField","normalizationTotal"],json:{type:B.jsonValues,read:B.read,write:B.write}})],g.prototype,"normalizationType",null);b.__decorate([c.enumeration({classBreaks:"class-breaks"})],g.prototype,"type",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],g.prototype,"valueExpression",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],g.prototype,"valueExpressionTitle",
void 0);return g=k=b.__decorate([c.subclass("esri.renderers.ClassBreaksRenderer")],g)}(x.VisualVariablesMixin(t))})},"esri/renderers/Renderer":function(){define("require exports tslib ../core/jsonMap ../core/JSONSupport ../core/SetUtils ../core/accessorSupport/decorators ./support/AuthoringInfo".split(" "),function(m,a,b,l,k,h,g,d){var f=new l.default({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});
return function(a){function c(c){c=a.call(this,c)||this;c.authoringInfo=null;c.type=null;return c}b.__extends(c,a);c.prototype.getRequiredFields=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:if(!this.collectRequiredFields)return[2,[]];c=new Set;return[4,this.collectRequiredFields(c,a)];case 1:return b.sent(),[2,h.valuesOfSet(c).sort()]}})})};c.prototype.getSymbol=function(a,c){};c.prototype.getSymbolAsync=function(a,
c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){return[2]})})};c.prototype.getSymbols=function(){return[]};c.prototype.getAttributeHash=function(){return JSON.stringify(this)};c.prototype.getMeshHash=function(){return JSON.stringify(this)};b.__decorate([g.property({type:d,json:{write:!0}})],c.prototype,"authoringInfo",void 0);b.__decorate([g.property({type:f.apiValues,readOnly:!0,json:{type:f.jsonValues,read:!1,write:{writer:f.write,ignoreOrigin:!0}}})],c.prototype,
"type",void 0);return c=b.__decorate([g.subclass("esri.renderers.Renderer")],c)}(k.JSONSupport)})},"esri/renderers/support/AuthoringInfo":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./AuthoringInfoFieldInfo ./AuthoringInfoVisualVariable ../../tasks/support/colorRamps".split(" "),function(m,a,b,l,k,h,g,d,f,c,e){var n=new l.default({esriClassifyDefinedInterval:"defined-interval",
esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),t=new l.default({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),x="inches feet yards miles nautical-miles millimeters centimeters decimeters meters kilometers decimal-degrees".split(" ");
return function(a){function k(c){c=a.call(this,c)||this;c.colorRamp=null;c.lengthUnit=null;c.maxSliderValue=null;c.minSliderValue=null;c.visualVariables=null;return c}b.__extends(k,a);p=k;Object.defineProperty(k.prototype,"classificationMethod",{get:function(){var a=this._get("classificationMethod"),c=this.type;return c&&"relationship"!==c?"class-breaks-size"===c||"class-breaks-color"===c?a||"manual":null:a},set:function(a){this._set("classificationMethod",a)},enumerable:!1,configurable:!0});k.prototype.readColorRamp=
function(a){if(a)return e.fromJSON(a)};Object.defineProperty(k.prototype,"fields",{get:function(){return this.type&&"predominance"!==this.type?null:this._get("fields")},set:function(a){this._set("fields",a)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"field1",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field1")},set:function(a){this._set("field1",a)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"field2",{get:function(){return this.type&&
"relationship"!==this.type?null:this._get("field2")},set:function(a){this._set("field2",a)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"focus",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("focus")},set:function(a){this._set("focus",a)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"numClasses",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")},set:function(a){this._set("numClasses",a)},
enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"standardDeviationInterval",{get:function(){var a=this.type;return a&&"relationship"!==a&&"class-breaks-size"!==a&&"class-breaks-color"!==a?null:this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")},set:function(a){this._set("standardDeviationInterval",a)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"type",{get:function(){return this._get("type")},
set:function(a){var c=a;"classed-size"===a?c="class-breaks-size":"classed-color"===a&&(c="class-breaks-color");this._set("type",c)},enumerable:!1,configurable:!0});k.prototype.clone=function(){return new p({classificationMethod:this.classificationMethod,colorRamp:h.clone(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:h.clone(this.field1),field2:h.clone(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,
standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(a){return a.clone()})})};var p;b.__decorate([g.property({type:n.apiValues,value:null,dependsOn:["type"],json:{type:n.jsonValues,read:n.read,write:n.write,origins:{"web-document":{default:"manual",type:n.jsonValues,read:n.read,write:n.write}}}})],k.prototype,"classificationMethod",null);b.__decorate([g.property({types:e.types,json:{write:!0}})],k.prototype,
"colorRamp",void 0);b.__decorate([g.reader("colorRamp")],k.prototype,"readColorRamp",null);b.__decorate([g.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],k.prototype,"fields",null);b.__decorate([g.property({type:f.default,value:null,dependsOn:["type"],json:{write:!0}})],k.prototype,"field1",null);b.__decorate([g.property({type:f.default,value:null,dependsOn:["type"],json:{write:!0}})],k.prototype,"field2",null);b.__decorate([g.property({type:["HH","HL","LH","LL"],value:null,
dependsOn:["type"],json:{write:!0}})],k.prototype,"focus",null);b.__decorate([g.property({type:Number,value:null,dependsOn:["type"],json:{type:d.Integer,write:!0}})],k.prototype,"numClasses",null);b.__decorate([g.property({type:x,json:{type:x,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],k.prototype,"lengthUnit",void 0);b.__decorate([g.property({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],k.prototype,"maxSliderValue",void 0);b.__decorate([g.property({type:Number,
json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],k.prototype,"minSliderValue",void 0);b.__decorate([g.property({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],k.prototype,"standardDeviationInterval",null);b.__decorate([g.property({type:String,value:null,json:{type:t.jsonValues,read:t.read,write:t.write}})],k.prototype,"type",null);b.__decorate([g.property({type:[c],json:{write:!0}})],k.prototype,"visualVariables",void 0);
return k=p=b.__decorate([g.subclass("esri.renderers.support.AuthoringInfo")],k)}(k.JSONSupport)})},"esri/renderers/support/AuthoringInfoFieldInfo":function(){define("require exports tslib ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./AuthoringInfoClassBreakInfo".split(" "),function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.AuthoringInfoFieldInfo=void 0;m=function(a){function d(c){c=a.call(this,c)||this;c.field="";c.normalizationField="";c.label=
"";c.classBreakInfos=[];return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:k.clone(this.classBreakInfos)})};var c;b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"field",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"normalizationField",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);b.__decorate([h.property({type:[g.default],
json:{write:!0}})],d.prototype,"classBreakInfos",void 0);return d=c=b.__decorate([h.subclass("esri.renderers.support.AuthoringInfoFieldInfo")],d)}(l.JSONSupport);a.AuthoringInfoFieldInfo=m;a.default=m})},"esri/renderers/support/AuthoringInfoClassBreakInfo":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.AuthoringInfoClassBreakInfo=void 0;m=function(a){function g(b){b=
a.call(this,b)||this;b.minValue=0;b.maxValue=0;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({minValue:this.minValue,maxValue:this.maxValue})};var d;b.__decorate([k.property({type:Number,json:{write:!0}})],g.prototype,"minValue",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],g.prototype,"maxValue",void 0);return g=d=b.__decorate([k.subclass("esri.renderer.support.AuthoringInfoClassBreakInfo")],g)}(l.JSONSupport);a.AuthoringInfoClassBreakInfo=m;a.default=
m})},"esri/renderers/support/AuthoringInfoVisualVariable":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast".split(" "),function(m,a,b,l,k,h,g){var d=new l.default({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),f=new l.default({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),c={key:function(a){return"number"===typeof a?"number":
"string"},typeMap:{number:Number,string:String},base:null},e=["high-to-low","above-and-below","centered-on","extremes"],n="seconds minutes hours days months years".split(" ");return function(a){function k(c){c=a.call(this,c)||this;c.endTime=null;c.field=null;c.maxSliderValue=null;c.minSliderValue=null;c.startTime=null;c.type=null;c.units=null;return c}b.__extends(k,a);p=k;k.prototype.castEndTime=function(a){return"string"===typeof a||"number"===typeof a?a:null};k.prototype.castStartTime=function(a){return"string"===
typeof a||"number"===typeof a?a:null};Object.defineProperty(k.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(a){this._set("style",a)},enumerable:!1,configurable:!0});Object.defineProperty(k.prototype,"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(a){this._set("theme",a)},enumerable:!1,configurable:!0});k.prototype.clone=function(){return new p({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,
minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})};var p;b.__decorate([h.property({types:c,json:{write:!0}})],k.prototype,"endTime",void 0);b.__decorate([g.cast("endTime")],k.prototype,"castEndTime",null);b.__decorate([h.property({type:String,json:{write:!0}})],k.prototype,"field",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],k.prototype,"maxSliderValue",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],
k.prototype,"minSliderValue",void 0);b.__decorate([h.property({types:c,json:{write:!0}})],k.prototype,"startTime",void 0);b.__decorate([g.cast("startTime")],k.prototype,"castStartTime",null);b.__decorate([h.property({type:d.apiValues,value:null,dependsOn:["type"],json:{type:d.jsonValues,read:d.read,write:d.write}})],k.prototype,"style",null);b.__decorate([h.property({type:e,value:null,dependsOn:["type"],json:{type:e,write:!0}})],k.prototype,"theme",null);b.__decorate([h.property({type:f.apiValues,
json:{type:f.jsonValues,read:f.read,write:f.write}})],k.prototype,"type",void 0);b.__decorate([h.property({type:n,json:{type:n,write:!0}})],k.prototype,"units",void 0);return k=p=b.__decorate([h.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],k)}(k.JSONSupport)})},"esri/tasks/support/colorRamps":function(){define(["require","exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.fromJSON=a.types=
void 0;a.types={key:"type",base:l,typeMap:{algorithmic:b,multipart:k}};a.fromJSON=function(a){return a&&a.type?"algorithmic"===a.type?b.fromJSON(a):"multipart"===a.type?k.fromJSON(a):null:null}})},"esri/tasks/support/AlgorithmicColorRamp":function(){define("require exports tslib ../../Color ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./ColorRamp".split(" "),function(m,a,b,l,k,h,g,d){return function(a){function c(c){c=a.call(this,c)||this;c.algorithm=
null;c.fromColor=null;c.toColor=null;c.type="algorithmic";return c}b.__extends(c,a);e=c;c.prototype.clone=function(){return new e({fromColor:k.clone(this.fromColor),toColor:k.clone(this.toColor),algorithm:this.algorithm})};var e;b.__decorate([h.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],c.prototype,"algorithm",void 0);b.__decorate([h.property({type:l,json:{type:[g.Integer],write:!0}})],c.prototype,"fromColor",void 0);b.__decorate([h.property({type:l,
json:{type:[g.Integer],write:!0}})],c.prototype,"toColor",void 0);b.__decorate([h.property({type:["algorithmic"]})],c.prototype,"type",void 0);return c=e=b.__decorate([h.subclass("esri.tasks.support.AlgorithmicColorRamp")],c)}(d)})},"esri/tasks/support/ColorRamp":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type=null;return b}b.__extends(g,a);b.__decorate([k.property({readOnly:!0,
json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=b.__decorate([k.subclass("esri.tasks.support.ColorRamp")],g)}(l.JSONSupport)})},"esri/tasks/support/MultipartColorRamp":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./AlgorithmicColorRamp ./ColorRamp".split(" "),function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.colorRamps=null;c.type="multipart";return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({colorRamps:l.clone(this.colorRamps)})};
var c;b.__decorate([k.property({type:[h],json:{write:!0}})],d.prototype,"colorRamps",void 0);b.__decorate([k.property({type:["multipart"]})],d.prototype,"type",void 0);return d=c=b.__decorate([k.subclass("esri.tasks.support.MultipartColorRamp")],d)}(g)})},"esri/renderers/mixins/VisualVariablesMixin":function(){define("require exports tslib ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../visualVariables/ColorVariable ../visualVariables/OpacityVariable ../visualVariables/RotationVariable ../visualVariables/SizeVariable ../visualVariables/VisualVariable ../visualVariables/VisualVariableFactory".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){Object.defineProperty(a,"__esModule",{value:!0});a.VisualVariablesMixin=void 0;var n={base:c,key:"type",typeMap:{opacity:g,color:h,rotation:d,size:f}};a.VisualVariablesMixin=function(a){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._vvFactory=new e;return c}b.__extends(c,a);Object.defineProperty(c.prototype,"visualVariables",{set:function(a){this._vvFactory.visualVariables=a;this._set("visualVariables",this._vvFactory.visualVariables)},
enumerable:!1,configurable:!0});c.prototype.readVisualVariables=function(a,c,b){return this._vvFactory.readVariables(a,c,b)};c.prototype.writeVisualVariables=function(a,c,b,e){c[b]=this._vvFactory.writeVariables(a,e)};Object.defineProperty(c.prototype,"arcadeRequiredForVisualVariables",{get:function(){if(!this.visualVariables)return!1;for(var a=0,c=this.visualVariables;a<c.length;a++)if(c[a].arcadeRequired)return!0;return!1},enumerable:!1,configurable:!0});c.prototype.hasVisualVariables=function(a,
c){return a?!!this.getVisualVariablesForType(a,c):!!(this.getVisualVariablesForType("size",c)||this.getVisualVariablesForType("color",c)||this.getVisualVariablesForType("opacity",c)||this.getVisualVariablesForType("rotation",c))};c.prototype.getVisualVariablesForType=function(a,c){var b=this.visualVariables;if(b&&(b=b.filter(function(b){return b.type===a&&("string"===typeof c?b.target===c:!1===c?!b.target:!0)}),!b||0!==b.length))return b};c.prototype.collectVVRequiredFields=function(a,c){return b.__awaiter(this,
void 0,void 0,function(){var e,d,f,g;return b.__generator(this,function(b){switch(b.label){case 0:e=[],this.visualVariables&&(e=e.concat(this.visualVariables)),d=0,f=e,b.label=1;case 1:if(!(d<f.length))return[3,4];g=f[d];if(!g)return[3,3];g.field&&k.collectField(a,c,g.field);g.normalizationField&&k.collectField(a,c,g.normalizationField);return g.valueExpression?[4,k.collectArcadeFieldNames(a,c,g.valueExpression)]:[3,3];case 2:b.sent(),b.label=3;case 3:return d++,[3,1];case 4:return[2]}})})};b.__decorate([l.property({types:[n],
value:null,json:{write:!0}})],c.prototype,"visualVariables",null);b.__decorate([l.reader("visualVariables",["visualVariables","rotationType","rotationExpression"])],c.prototype,"readVisualVariables",null);b.__decorate([l.writer("visualVariables")],c.prototype,"writeVisualVariables",null);return c=b.__decorate([l.subclass("esri.renderers.mixins.VisualVariablesMixin")],c)}(a)}})},"esri/renderers/visualVariables/ColorVariable":function(){define("require exports tslib ../../core/accessorSupport/decorators ./VisualVariable ./support/ColorStop".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.type="color";c.normalizationField=null;return c}b.__extends(d,a);f=d;Object.defineProperty(d.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,c){return a.value-c.value}));this._set("stops",
a)},enumerable:!1,configurable:!0});d.prototype.clone=function(){return new f({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&this.legendOptions.clone()})};d.prototype.getAttributeHash=function(){return a.prototype.getAttributeHash.call(this)+"-"+this.normalizationField};d.prototype._interpolateData=function(){return this.stops&&
this.stops.map(function(a){return a.value||0})};var f;b.__decorate([l.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],d.prototype,"cache",null);b.__decorate([l.property({type:["color"],json:{type:["colorInfo"]}})],d.prototype,"type",void 0);b.__decorate([l.property({type:String,json:{write:!0}})],d.prototype,"normalizationField",void 0);b.__decorate([l.property({type:[h],json:{write:!0}})],d.prototype,"stops",null);return d=f=b.__decorate([l.subclass("esri.renderers.visualVariables.ColorVariable")],
d)}(k)})},"esri/renderers/visualVariables/VisualVariable":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./support/VisualVariableLegendOptions".split(" "),function(m,a,b,l,k,h,g,d,f){var c=h.getLogger("esri.renderers.visualVariables.VisualVariable"),e=new l.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});return function(a){function n(c){c=
a.call(this,c)||this;c.index=null;c.type=null;c.field=null;c.valueExpression=null;c.valueExpressionTitle=null;c.legendOptions=null;return c}b.__extends(n,a);n.prototype.castField=function(a){return null==a?a:"function"===typeof a?(c.error(".field: field must be a string value"),null):d.ensureString(a)};Object.defineProperty(n.prototype,"arcadeRequired",{get:function(){return!!this.valueExpression},enumerable:!1,configurable:!0});n.prototype.clone=function(){};n.prototype.getAttributeHash=function(){return this.type+
"-"+this.field+"-"+this.valueExpression};b.__decorate([g.property()],n.prototype,"index",void 0);b.__decorate([g.property({type:e.apiValues,readOnly:!0,json:{read:e.read,write:e.write}})],n.prototype,"type",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],n.prototype,"field",void 0);b.__decorate([g.cast("field")],n.prototype,"castField",null);b.__decorate([g.property({type:String,json:{write:!0}})],n.prototype,"valueExpression",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],
n.prototype,"valueExpressionTitle",void 0);b.__decorate([g.property({readOnly:!0,dependsOn:["valueExpression"]})],n.prototype,"arcadeRequired",null);b.__decorate([g.property({type:f,json:{write:!0}})],n.prototype,"legendOptions",void 0);return n=b.__decorate([g.subclass("esri.renderers.visualVariables.VisualVariable")],n)}(k.JSONSupport)})},"esri/renderers/visualVariables/support/VisualVariableLegendOptions":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators",
"../../support/LegendOptions"],function(m,a,b,l,k){return function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.showLegend=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({title:this.title,showLegend:this.showLegend})};var d;b.__decorate([l.property({type:Boolean,json:{write:!0}})],g.prototype,"showLegend",void 0);return g=d=b.__decorate([l.subclass("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],g)}(k.default)})},"esri/renderers/support/LegendOptions":function(){define(["require",
"exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.LegendOptions=void 0;m=function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.title=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({title:this.title})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"title",void 0);return g=d=b.__decorate([k.subclass("esri.renderers.support.LegendOptions")],
g)}(l.JSONSupport);a.LegendOptions=m;a.default=m})},"esri/renderers/visualVariables/support/ColorStop":function(){define("require exports tslib ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType".split(" "),function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.color=null;c.label=null;c.value=null;return c}b.__extends(d,a);c=d;d.prototype.writeValue=function(a,c,b){c[b]=null==a?0:a};d.prototype.clone=
function(){return new c({color:this.color&&this.color.clone(),label:this.label,value:this.value})};var c;b.__decorate([h.property({type:l,json:{type:[g.Integer],write:!0}})],d.prototype,"color",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);b.__decorate([h.property({type:Number,json:{write:{allowNull:!0}}})],d.prototype,"value",void 0);b.__decorate([h.writer("value")],d.prototype,"writeValue",null);return d=c=b.__decorate([h.subclass("esri.renderers.visualVariables.support.ColorStop")],
d)}(k.JSONSupport)})},"esri/renderers/visualVariables/OpacityVariable":function(){define("require exports tslib ../../core/accessorSupport/decorators ./VisualVariable ./support/OpacityStop".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.type="opacity";c.normalizationField=null;return c}b.__extends(d,a);f=d;Object.defineProperty(d.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},
enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,c){return a.value-c.value}));this._set("stops",a)},enumerable:!1,configurable:!0});d.prototype.clone=function(){return new f({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&
this.legendOptions.clone()})};d.prototype.getAttributeHash=function(){return a.prototype.getAttributeHash.call(this)+"-"+this.normalizationField};d.prototype._interpolateData=function(){return this.stops&&this.stops.map(function(a){return a.value||0})};var f;b.__decorate([l.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],d.prototype,"cache",null);b.__decorate([l.property({type:["opacity"],json:{type:["transparencyInfo"]}})],d.prototype,"type",void 0);b.__decorate([l.property({type:String,
json:{write:!0}})],d.prototype,"normalizationField",void 0);b.__decorate([l.property({type:[h],json:{write:!0}})],d.prototype,"stops",null);return d=f=b.__decorate([l.subclass("esri.renderers.visualVariables.OpacityVariable")],d)}(k)})},"esri/renderers/visualVariables/support/OpacityStop":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../../../webdoc/support/opacityUtils".split(" "),function(m,a,
b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.label=null;c.opacity=null;c.value=null;return c}b.__extends(d,a);c=d;d.prototype.readOpacity=function(a,c){return g.transparencyToOpacity(c.transparency)};d.prototype.writeOpacity=function(a,c,b){c[b]=g.opacityToTransparency(a)};d.prototype.clone=function(){return new c({label:this.label,opacity:this.opacity,value:this.value})};var c;b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);b.__decorate([k.property({type:Number,
json:{type:h.Integer,write:{target:"transparency"}}})],d.prototype,"opacity",void 0);b.__decorate([k.reader("opacity",["transparency"])],d.prototype,"readOpacity",null);b.__decorate([k.writer("opacity")],d.prototype,"writeOpacity",null);b.__decorate([k.property({type:Number,json:{write:!0}})],d.prototype,"value",void 0);return d=c=b.__decorate([k.subclass("esri.renderers.visualVariables.support.OpacityStop")],d)}(l.JSONSupport)})},"esri/renderers/visualVariables/RotationVariable":function(){define("require exports tslib ../../core/Error ../../core/accessorSupport/decorators ./VisualVariable".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.axis=null;c.type="rotation";c.rotationType="geographic";c.valueExpressionTitle=null;return c}b.__extends(d,a);f=d;Object.defineProperty(d.prototype,"cache",{get:function(){return{hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!1,configurable:!0});d.prototype.writeValueExpressionTitleWebScene=function(a,b,d,f){f&&f.messages&&f.messages.push(new l("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:"visualVariables["+this.index+"].valueExpressionTitle",context:f}))};d.prototype.clone=function(){return new f({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})};var f;b.__decorate([k.property({readOnly:!0,dependsOn:["valueExpression"]})],d.prototype,"cache",null);b.__decorate([k.property({type:["heading","tilt",
"roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],d.prototype,"axis",void 0);b.__decorate([k.property({type:["rotation"],json:{type:["rotationInfo"]}})],d.prototype,"type",void 0);b.__decorate([k.property({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],d.prototype,"rotationType",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,"valueExpressionTitle",void 0);b.__decorate([k.writer("web-scene",
"valueExpressionTitle")],d.prototype,"writeValueExpressionTitleWebScene",null);return d=f=b.__decorate([k.subclass("esri.renderers.visualVariables.RotationVariable")],d)}(h)})},"esri/renderers/visualVariables/SizeVariable":function(){define("require exports tslib ../../core/Error ../../core/jsonMap ../../core/Logger ../../core/screenUtils ../../core/accessorSupport/decorators ./VisualVariable ./support/SizeStop ./support/SizeVariableLegendOptions ./support/sizeVariableUtils ./support/visualVariableUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){function x(a){if(null!=a){if("string"===typeof a||"number"===typeof a)return g.toPt(a);if("size"===a.type){if(n.isSizeVariable(a))return a;a=b.__assign({},a);delete a.type;return new w(a)}}}function p(a,c,b){if("object"!==typeof a)return a;c=new w;c.read(a,b);return c}var q=h.getLogger("esri.renderers.visualVariables.SizeVariable"),u=new k.default({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),y=new k.default({unknown:"unknown",
inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"}),w=function(a){function f(c){c=a.call(this,c)||this;c.axis=null;c.legendOptions=null;c.normalizationField=null;c.scaleBy=null;c.target=null;c.type="size";c.useSymbolValue=null;c.valueExpression=null;c.valueRepresentation=null;c.valueUnit=null;return c}b.__extends(f,a);
g=f;Object.defineProperty(f.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:t.viewScaleRE.test(this.valueExpression)}},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"expression",{set:function(a){q.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'.");"view.scale"===a?(this.valueExpression="$view.scale",this._set("expression",
a)):this._set("expression",null)},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"index",{set:function(a){n.isSizeVariable(this.maxSize)&&(this.maxSize.index="visualVariables["+a+"].maxSize");n.isSizeVariable(this.minSize)&&(this.minSize.index="visualVariables["+a+"].minSize");this._set("index",a)},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"inputValueType",{get:function(){return n.getInputValueType(this)},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,
"maxDataValue",{set:function(a){a&&this.stops&&(q.warn("cannot set maxDataValue when stops is not null."),a=null);this._set("maxDataValue",a)},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"maxSize",{set:function(a){a&&this.stops&&(q.warn("cannot set maxSize when stops is not null."),a=null);this._set("maxSize",a)},enumerable:!1,configurable:!0});f.prototype.castMaxSize=function(a){return x(a)};f.prototype.readMaxSize=function(a,c,b){return p(a,c,b)};Object.defineProperty(f.prototype,
"minDataValue",{set:function(a){a&&this.stops&&(q.warn("cannot set minDataValue when stops is not null."),a=null);this._set("minDataValue",a)},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"minSize",{set:function(a){a&&this.stops&&(q.warn("cannot set minSize when stops is not null."),a=null);this._set("minSize",a)},enumerable:!1,configurable:!0});f.prototype.castMinSize=function(a){return x(a)};f.prototype.readMinSize=function(a,c,b){return p(a,c,b)};Object.defineProperty(f.prototype,
"arcadeRequired",{get:function(){return this.valueExpression?!0:this.minSize&&"object"===typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"===typeof this.maxSize&&this.maxSize.arcadeRequired},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"stops",{set:function(a){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,c){return a.value-c.value})):a&&
(q.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),a=null);this._set("stops",a)},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"transformationType",{get:function(){return n.getTransformationType(this,this.inputValueType)},enumerable:!1,configurable:!0});f.prototype.readValueExpression=function(a,c){return a||c.expression&&"$view.scale"};f.prototype.writeValueExpressionWebScene=function(a,c,b,e){"$view.scale"===a?e&&e.messages&&(a=
this.index,e.messages.push(new l("property:unsupported",this.type+"VisualVariable.valueExpression \x3d '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:("string"===typeof a?a:"visualVariables["+a+"]")+".valueExpression",context:e}))):c[b]=a};f.prototype.readValueUnit=function(a){return a?y.read(a):null};f.prototype.clone=function(){return new g({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
maxDataValue:this.maxDataValue,maxSize:n.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:n.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})};
f.prototype.flipSizes=function(){if("clamped-linear"===this.transformationType){var a=this.minSize;this.minSize=this.maxSize;this.maxSize=a;return this}if("stops"===this.transformationType)for(var a=this.stops,c=a.map(function(a){return a.size}).reverse(),b=a.length,e=0;e<b;e++)a[e].size=c[e];return this};f.prototype.getAttributeHash=function(){return a.prototype.getAttributeHash.call(this)+"-"+this.target+"-"+this.normalizationField};f.prototype._interpolateData=function(){return this.stops&&this.stops.map(function(a){return a.value||
0})};var g;b.__decorate([d.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],f.prototype,"cache",null);b.__decorate([d.property({type:u.apiValues,json:{type:u.jsonValues,origins:{"web-map":{read:!1}},read:u.read,write:u.write}})],f.prototype,"axis",void 0);b.__decorate([d.property({type:String,value:null,json:{read:!1}})],f.prototype,"expression",null);b.__decorate([d.property()],f.prototype,"index",null);b.__decorate([d.property({type:String,readOnly:!0,dependsOn:["field","valueExpression"]})],
f.prototype,"inputValueType",null);b.__decorate([d.property({type:e,json:{write:!0}})],f.prototype,"legendOptions",void 0);b.__decorate([d.property({type:Number,value:null,json:{write:!0}})],f.prototype,"maxDataValue",null);b.__decorate([d.property({type:Number,value:null,json:{write:!0}})],f.prototype,"maxSize",null);b.__decorate([d.cast("maxSize")],f.prototype,"castMaxSize",null);b.__decorate([d.reader("maxSize")],f.prototype,"readMaxSize",null);b.__decorate([d.property({type:Number,value:null,
json:{write:!0}})],f.prototype,"minDataValue",null);b.__decorate([d.property({type:Number,value:null,json:{write:!0}})],f.prototype,"minSize",null);b.__decorate([d.cast("minSize")],f.prototype,"castMinSize",null);b.__decorate([d.reader("minSize")],f.prototype,"readMinSize",null);b.__decorate([d.property({type:String,json:{write:!0}})],f.prototype,"normalizationField",void 0);b.__decorate([d.property({readOnly:!0,dependsOn:["valueExpression","minSize.arcadeRequired","maxSize.arcadeRequired"]})],f.prototype,
"arcadeRequired",null);b.__decorate([d.property({type:String})],f.prototype,"scaleBy",void 0);b.__decorate([d.property({type:[c],value:null,json:{write:!0}})],f.prototype,"stops",null);b.__decorate([d.property({type:["outline"],json:{write:!0}})],f.prototype,"target",void 0);b.__decorate([d.property({type:String,readOnly:!0,dependsOn:"minDataValue maxDataValue minSize maxSize valueUnit inputValueType stops".split(" ")})],f.prototype,"transformationType",null);b.__decorate([d.property({type:["size"],
json:{type:["sizeInfo"]}})],f.prototype,"type",void 0);b.__decorate([d.property({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],f.prototype,"useSymbolValue",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],f.prototype,"valueExpression",void 0);b.__decorate([d.reader("valueExpression",["valueExpression","expression"])],f.prototype,"readValueExpression",null);b.__decorate([d.writer("web-scene","valueExpression")],f.prototype,"writeValueExpressionWebScene",null);b.__decorate([d.property({type:["radius",
"diameter","area","width","distance"],json:{write:!0}})],f.prototype,"valueRepresentation",void 0);b.__decorate([d.property({type:y.apiValues,json:{write:y.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],f.prototype,"valueUnit",void 0);b.__decorate([d.reader("valueUnit")],f.prototype,"readValueUnit",null);return f=g=b.__decorate([d.subclass("esri.renderers.visualVariables.SizeVariable")],f)}(f);return w})},"esri/renderers/visualVariables/support/SizeStop":function(){define("require exports tslib ../../../core/JSONSupport ../../../core/screenUtils ../../../core/accessorSupport/decorators".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.label=null;c.size=null;c.value=null;return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({label:this.label,size:this.size,value:this.value})};var f;b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);b.__decorate([h.property({type:Number,cast:k.toPt,json:{write:!0}})],d.prototype,"size",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],d.prototype,"value",
void 0);return d=f=b.__decorate([h.subclass("esri.renderers.visualVariables.support.SizeStop")],d)}(l.JSONSupport)})},"esri/renderers/visualVariables/support/SizeVariableLegendOptions":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./VisualVariableLegendOptions"],function(m,a,b,l,k){return function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.customValues=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({title:this.title,
showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})};var d;b.__decorate([l.property({type:[Number],json:{write:!0}})],g.prototype,"customValues",void 0);return g=d=b.__decorate([l.subclass("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],g)}(k)})},"esri/renderers/visualVariables/support/sizeVariableUtils":function(){define(["require","exports"],function(m,a){function b(a){return a.valueExpression?"expression":a.field&&"string"===typeof a.field?
"field":"unknown"}Object.defineProperty(a,"__esModule",{value:!0});a.getTransformationType=a.getInputValueType=a.isValidNumber=a.isSizeVariable=void 0;a.isSizeVariable=function(a){return a&&"esri.renderers.visualVariables.SizeVariable"===a.declaredClass};a.isValidNumber=function(a){return null!=a&&!isNaN(a)&&isFinite(a)};a.getInputValueType=b;a.getTransformationType=function(a,k){return"unknown"===(k||b(a))?"constant":a.stops?"stops":null!=a.minSize&&null!=a.maxSize&&null!=a.minDataValue&&null!=a.maxDataValue?
"clamped-linear":"unknown"===(a.valueUnit||"unknown")?null!=a.minSize&&null!=a.minDataValue?a.minSize&&a.minDataValue?"proportional":"additive":"identity":"real-world-size"}})},"esri/renderers/visualVariables/support/visualVariableUtils":function(){define("require exports ../../../Color ../../../Graphic ../../../core/compilerUtils ../../../core/Logger ../../../core/maybe ../../support/utils ./sizeVariableUtils".split(" "),function(m,a,b,l,k,h,g,d,f){function c(a,c,e){if(a="visualVariables"in a&&a.visualVariables?
a.visualVariables.filter(function(a){return"color"===a.type})[0]:a)if("esri.renderers.visualVariables.ColorVariable"!==a.declaredClass)w.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");else{var d="number"===typeof c,f=d?null:c,n=f&&f.attributes,h=d?c:null,k=a.field,p=a.cache;c=p.ipData;var l=p.hasExpression,p=a.cache.compiledFunc;if(!k&&!l)return(e=a.stops)&&e[0]&&e[0].color;if("number"!==typeof h)if(l){if(!g.isSome(e)||!g.isSome(e.arcade)){w.error("Use of arcade expressions requires an arcade context");
return}h=e.arcade.arcadeUtils;k=h.getViewInfo({viewingMode:e.viewingMode,scale:e.scale,spatialReference:e.spatialReference});f=h.createExecContext(f,k);p||(p=h.createSyntaxTree(a.valueExpression),p=h.createFunction(p),a.cache.compiledFunc=p);h=h.executeFunction(p,f)}else n&&(h=n[k]);f=a.normalizationField;n=n?parseFloat(n[f]):void 0;if(null!=h&&(!f||d||!isNaN(n)&&0!==n)&&(isNaN(n)||d||(h/=n),d=y(h,c)))return n=d[0],c=d[1],e=n===c?a.stops[n].color:b.blendColors(a.stops[n].color,a.stops[c].color,d[2],
g.isSome(e)?e.color:void 0),new b(e)}}function e(a,c,b){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"opacity"===a.type})[0]:a)if("esri.renderers.visualVariables.OpacityVariable"!==a.declaredClass)w.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");else{var e="number"===typeof c,d=e?null:c,f=d&&d.attributes,n=e?c:null,h=a.field,k=a.cache;c=k.ipData;var p=k.hasExpression,k=a.cache.compiledFunc;if(!h&&!p)return(a=
a.stops)&&a[0]&&a[0].opacity;if("number"!==typeof n)if(p){if(g.isNone(b)||g.isNone(b.arcade)){w.error("Use of arcade expressions requires an arcade context");return}n=b.arcade.arcadeUtils;b=n.getViewInfo({viewingMode:b.viewingMode,scale:b.scale,spatialReference:b.spatialReference});b=n.createExecContext(d,b);k||(d=n.createSyntaxTree(a.valueExpression),k=n.createFunction(d),a.cache.compiledFunc=k);n=n.executeFunction(k,b)}else f&&(n=f[h]);b=a.normalizationField;f=f?parseFloat(f[b]):void 0;if(null!=
n&&(!b||e||!isNaN(f)&&0!==f)&&(isNaN(f)||e||(n/=f),e=y(n,c))){c=e[0];f=e[1];if(c===f)return a.stops[c].opacity;c=a.stops[c].opacity;return c+(a.stops[f].opacity-c)*e[2]}}}function n(a,c,b){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"rotation"===a.type})[0]:a)if("esri.renderers.visualVariables.RotationVariable"!==a.declaredClass)w.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");else{var e=a.axis||"heading",
d="heading"===e&&"arithmetic"===a.rotationType?90:0,e="heading"===e&&"arithmetic"===a.rotationType?-1:1,f="number"===typeof c?null:c,n=f&&f.attributes,h=a.field,k=a.cache.hasExpression;c=a.cache.compiledFunc;var p=0;if(!h&&!k)return p;if(k){if(g.isNone(b)||g.isNone(b.arcade)){w.error("Use of arcade expressions requires an arcade context");return}n=b.arcade.arcadeUtils;b=n.getViewInfo({viewingMode:b.viewingMode,scale:b.scale,spatialReference:b.spatialReference});b=n.createExecContext(f,b);c||(c=n.createSyntaxTree(a.valueExpression),
c=n.createFunction(c),a.cache.compiledFunc=c);p=n.executeFunction(c,b)}else n&&(p=n[h]||0);return p="number"!==typeof p||isNaN(p)?null:d+e*p}}function t(a,c,b){var e="number"===typeof c,d=e?null:c,n=d&&d.attributes,h=e?c:null;c=a.cache.compiledFunc;if(a.cache.isScaleDriven)d=g.isSome(b)?b.scale:void 0,b=g.isSome(b)?b.view:void 0,null==d||b&&"3d"===b.type?(d=b=null,(d=a.stops)?(b=d[0].value,d=d[d.length-1].value):(b=a.minDataValue||0,d=a.maxDataValue||0),b=(b+d)/2):b=d,h=b;else if(!e)switch(a.inputValueType){case "expression":if(g.isNone(b)||
g.isNone(b.arcade)){w.error("Use of arcade expressions requires an arcade context");return}h=b.arcade.arcadeUtils;b=h.getViewInfo({viewingMode:b.viewingMode,scale:b.scale,spatialReference:b.spatialReference});b=h.createExecContext(d,b);c||(d=h.createSyntaxTree(a.valueExpression),c=h.createFunction(d),a.cache.compiledFunc=c);h=h.executeFunction(c,b);break;case "field":n&&(h=n[a.field]);break;case "unknown":h=null}if(!f.isValidNumber(h))return null;if(e||!a.normalizationField)return h;a=n?parseFloat(n[a.normalizationField]):
null;return f.isValidNumber(a)&&0!==a?h/a:null}function x(a,c,b){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"size"===a.type})[0]:a)if("esri.renderers.visualVariables.SizeVariable"!==a.declaredClass)w.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");else{var e=t(a,c,b);c=u(e,a,c,b,a.cache.ipData);return null===c||void 0===c||isNaN(c)?0:c}}function p(a,c,b){return null==a?null:f.isSizeVariable(a)?x(a,c,b):f.isValidNumber(a)?
a:null}function q(a,c,b){return f.isValidNumber(b)&&a>b?b:f.isValidNumber(c)&&a<c?c:a}function u(a,c,b,e,f){switch(c.transformationType){case "additive":return e=p(c.minSize,b,e),a+(e||c.minDataValue);case "constant":return a=(a=c.stops)&&a.length&&a[0].size,null==a&&(a=c.minSize),p(a,b,e);case "clamped-linear":f=(a-c.minDataValue)/(c.maxDataValue-c.minDataValue);var n=p(c.minSize,b,e);b=p(c.maxSize,b,e);e=g.isSome(e)?e.shape:void 0;a<=c.minDataValue?c=n:a>=c.maxDataValue?c=b:"area"===c.scaleBy&&
e?(e=(c="circle"===e)?z*Math.pow(n/2,2):n*n,e+=f*((c?z*Math.pow(b/2,2):b*b)-e),c=c?2*Math.sqrt(e/z):Math.sqrt(e)):c=n+f*(b-n);return c;case "proportional":return f=g.isSome(e)?e.shape:void 0,a/=c.minDataValue,n=p(c.minSize,b,e),c=p(c.maxSize,b,e),e=null,e="circle"===f?2*Math.sqrt(a*Math.pow(n/2,2)):"square"===f||"diamond"===f||"image"===f?Math.sqrt(a*Math.pow(n,2)):a*n,q(e,n,c);case "stops":return f=y(a,f),n=f[0],a=f[1],f=f[2],n===a?c=p(c.stops[n].size,b,e):(n=p(c.stops[n].size,b,e),c=p(c.stops[a].size,
b,e),c=n+(c-n)*f),c;case "real-world-size":return f=(g.isSome(e)&&e.resolution?e.resolution:1)*d.meterIn[c.valueUnit],n=p(c.minSize,b,e),e=p(c.maxSize,b,e),c=c.valueRepresentation,b=null,b="area"===c?2*Math.sqrt(a/z)/f:"radius"===c||"distance"===c?2*a/f:a/f,q(b,n,e);case "identity":return a;case "unknown":return null}}function y(a,c){if(c){var b=0,e=c.length-1;c.some(function(c,d){if(a<c)return e=d,!0;b=d;return!1});return[b,e,(a-c[b])/(c[e]-c[b])]}}Object.defineProperty(a,"__esModule",{value:!0});
a.getAllSizes=a.getVisualVariableValues=a.getSizeRangeAtScale=a.getSizeForValue=a.getSizeFromNumberOrVariable=a.getSize=a.getRotationAngle=a.getOpacity=a.getColor=a.viewScaleRE=void 0;var w=h.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),B=new l,z=Math.PI;a.viewScaleRE=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;a.getColor=c;a.getOpacity=e;a.getRotationAngle=n;a.getSize=x;a.getSizeFromNumberOrVariable=p;a.getSizeForValue=u;a.getSizeRangeAtScale=function(a,c,b){var e=b&&"3d"===
b.type;if(!(a.cache.isScaleDriven&&e||c))return null;b={scale:c,view:b};c=p(a.minSize,B,b);a=p(a.maxSize,B,b);if(null!=c||null!=a)return c>a&&(b=a,a=c,c=b),{minSize:c,maxSize:a}};a.getVisualVariableValues=function(a,b,d){if(a.visualVariables){var f=[],g=[],h=[],k=[],p=[],l=0;for(a=a.visualVariables;l<a.length;l++){var q=a[l];switch(q.type){case "color":g.push(q);break;case "opacity":h.push(q);break;case "rotation":p.push(q);break;case "size":k.push(q)}}g.forEach(function(a){var e=c(a,b,d);f.push({variable:a,
value:e})});h.forEach(function(a){var c=e(a,b,d);f.push({variable:a,value:c})});p.forEach(function(a){var c=n(a,b,d);f.push({variable:a,value:c})});k.forEach(function(a){var c=x(a,b,d);f.push({variable:a,value:c})});return f.filter(function(a){return null!=a.value})}};a.getAllSizes=function(a,c,b){for(var e=["proportional","proportional","proportional"],d=0;d<a.length;d++){var f=a[d],g=f.useSymbolValue?"symbol-value":x(f,c,b);switch(f.axis){case "width":e[0]=g;break;case "depth":e[1]=g;break;case "height":e[2]=
g;break;case "width-and-depth":e[0]=g;e[1]=g;break;case "all":case void 0:case null:e[0]=g;e[1]=g;e[2]=g;break;default:k.neverReached(f.axis)}}return e}})},"esri/renderers/support/utils":function(){define("require exports ../../core/arrayUtils ../../core/Logger ../../core/unitUtils ../../intl/date ./numberUtils ../visualVariables/support/ColorStop".split(" "),function(m,a,b,l,k,h,g,d){function f(a,c,b){var e="";0===c?e=t.lt+" ":c===b&&(e=t.gt+" ");return e+a}function c(a){var c=a.minValue,b=a.maxValue,
e=a.isFirstBreak?"":t.gt+" ";a="percent-of-total"===a.normalizationType?t.pct:"";c=null==c?"":g.format(c);b=null==b?"":g.format(b);return e+c+a+" "+t.ld+" "+b+a}function e(a,c){return"normalizationField"in a&&a.normalizationField?{type:"normalized-field",field:a.field,normalizationField:a.normalizationField}:"field"in a&&a.field?{type:"field",field:a.field}:"valueExpression"in a&&a.valueExpression?{type:"expression",expression:a.valueExpression,title:a.valueExpressionTitle,returnType:c}:null}Object.defineProperty(a,
"__esModule",{value:!0});a.getAttributes=a.getAttribute=a.createUniqueValueLabel=a.calculateDateFormatInterval=a.updateClassBreak=a.setLabelsForClassBreaks=a.createClassBreakLabel=a.updateColorStops=a.createColorStops=a.timelineDateFormatOptions=a.meterIn=void 0;var n=l.getLogger("esri.renderers.support.utils"),t={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},x={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},p={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",
minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};a.meterIn={inches:k.convertUnit(1,"meters","inches"),feet:k.convertUnit(1,"meters","feet"),"us-feet":k.convertUnit(1,"meters","us-feet"),yards:k.convertUnit(1,"meters","yards"),miles:k.convertUnit(1,"meters","miles"),"nautical-miles":k.convertUnit(1,"meters","nautical-miles"),millimeters:k.convertUnit(1,"meters","millimeters"),centimeters:k.convertUnit(1,
"meters","centimeters"),decimeters:k.convertUnit(1,"meters","decimeters"),meters:k.convertUnit(1,"meters","meters"),kilometers:k.convertUnit(1,"meters","kilometers"),"decimal-degrees":1/k.lengthToDegrees(1,"meters")};a.timelineDateFormatOptions=h.convertDateFormatToIntlOptions("short-date");a.createColorStops=function(a){var c=a.values,b=a.colors,e=a.labelIndexes,n=a.isDate,k=a.dateFormatOptions;return c.map(function(a,p){var l=null;if(!e||-1<e.indexOf(p)){var q=void 0;(q=n?h.formatDate(a,k):g.format(a))&&
(l=f(q,p,c.length-1))}return new d({value:a,color:b[p],label:l})})};a.updateColorStops=function(a){var c=a.stops,b=a.changes,e=a.isDate,d=a.dateFormatOptions,n=c.map(function(a){return a.value});a=[];for(var k=0;k<b.length;k++){var p=b[k];a.push(p.index);n[p.index]=p.value}var l=g.round(n,{indexes:a});c.forEach(function(a,b){a.value=n[b];if(null!=a.label){var k=void 0,p=null;(k=e?h.formatDate(l[b],d):g.format(l[b]))&&(p=f(k,b,c.length-1));a.label=p}})};a.createClassBreakLabel=c;a.setLabelsForClassBreaks=
function(a){var b=a.classBreakInfos,e=a.normalizationType,d=[];if(b&&b.length)if("standard-deviation"===a.classificationMethod)n.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(a.round){d.push(b[0].minValue);for(a=0;a<b.length;a++)d.push(b[a].maxValue);d=g.round(d);b.forEach(function(a,b){a.label=c({minValue:0===b?d[0]:d[b],maxValue:d[b+1],isFirstBreak:0===b,normalizationType:e})})}else b.forEach(function(a,b){a.label=c({minValue:a.minValue,
maxValue:a.maxValue,isFirstBreak:0===b,normalizationType:e})})};a.updateClassBreak=function(a){if("standard-deviation"===a.classificationMethod)n.warn("updateClassBreak","cannot update labels for class breaks generated using 'standard-deviation' method.");else{var b=a.classBreaks,e=a.change,d=e.index,e=e.value,f=b.length,g=-1,h=-1;0===d?g=d:d===f?h=d-1:(h=d-1,g=d);a=a.normalizationType;d=null;-1<g&&g<f&&(d=b[g],d.minValue=e,d.label=c({minValue:d.minValue,maxValue:d.maxValue,isFirstBreak:0===g,normalizationType:a}));
-1<h&&h<f&&(d=b[h],d.maxValue=e,d.label=c({minValue:d.minValue,maxValue:d.maxValue,isFirstBreak:0===h,normalizationType:a}))}};a.calculateDateFormatInterval=function(a){a=a.map(function(a){return new Date(a)});for(var c=a.length,b=Infinity,e=null,d=0;d<c-1;d++){for(var f=a[d],g=[],n=Infinity,h=null,k=d+1;k<c;k++){var p=a[k],p=f.getFullYear()!==p.getFullYear()&&"year"||f.getMonth()!==p.getMonth()&&"month"||f.getDate()!==p.getDate()&&"day"||f.getHours()!==p.getHours()&&"hour"||f.getMinutes()!==p.getMinutes()&&
"minute"||f.getSeconds()!==p.getSeconds()&&"second"||"millisecond",l=x[p];l<n&&(n=l,h=p);g.push(p)}n<b&&(b=n,e=h)}return e};a.createUniqueValueLabel=function(a){var c=a.value,b=a.domain,e=a.fieldInfo;a=a.dateFormatInterval;var d=String(c);(b=b&&"codedValues"in b&&b.codedValues?b.getName(c):null)?d=b:"number"===typeof c&&(d=e&&"date"===e.type?h.formatDate(c,a&&h.convertDateFormatToIntlOptions(p[a])):g.format(c));return d};a.getAttribute=e;a.getAttributes=function(a,c){var d=[];if("class-breaks"===
a.type||"heatmap"===a.type)d.push(e(a,"number"));else if("unique-value"===a.type){var f=a.authoringInfo;if(f&&"relationship"===f.type){if(f.field1&&f.field2){var g=f.field2.field,n=f.field2.normalizationField;d.push(e({field:f.field1.field,normalizationField:f.field1.normalizationField}));d.push(e({field:g,normalizationField:n}))}}else g=a.uniqueValueInfos[0],f=null,g&&g.value&&(g=typeof a.uniqueValueInfos[0].value,"string"===g||"number"===g)&&(f=g),d.push(e(a,f)),[a.field2,a.field3].forEach(function(a){return a&&
d.push({type:"field",field:a})})}else"dot-density"===a.type&&a.attributes.forEach(function(a){return d.push(e(a,"number"))});(a=c?c(a):"visualVariables"in a?a.visualVariables:null)&&a.forEach(function(a){return d.push(e(a,"number"))});return b.unique(d.filter(Boolean),function(a,c){return"field"===a.type&&"field"===c.type?a.field===c.field:"normalized-field"===a.type&&"normalized-field"===c.type?a.field===c.field&&a.normalizationField===c.normalizationField:"expression"===a.type&&"expression"===c.type?
a.expression===c.expression:!1})}})},"esri/renderers/support/numberUtils":function(){define(["require","exports","../../intl"],function(m,a,b){function l(a,c){return a-c}function k(a,c){var b;b=Number(a.toFixed(c));b<a?a=b+1/Math.pow(10,c):(a=b,b-=1/Math.pow(10,c));b=Number(b.toFixed(c));a=Number(a.toFixed(c));return[b,a]}function h(a,c,b,f,g){a=d(a,c,b,f);c=null==a.next||a.next<=g;return(null==a.previous||a.previous<=g)&&c||a.previous+a.next<=2*g}function g(a){a=String(a);var c=a.match(f);if(c&&
c[1])return{integer:c[1].split("").length,fractional:c[3]?c[3].split("").length:0};if(-1<a.toLowerCase().indexOf("e")&&(c=a.split("e"),a=c[0],c=c[1],a&&c)){a=Number(a);var c=Number(c),b=0<c;b||(c=Math.abs(c));a=g(a);b?(a.integer+=c,a.fractional=c>a.fractional?0:a.fractional-c):(a.fractional+=c,a.integer=c>a.integer?1:a.integer-c);return a}return{integer:0,fractional:0}}function d(a,c,b,d){var e={previous:null,next:null};if(null!=b){var f=a-b;e.previous=Math.floor(Math.abs(100*(c-b-f)/f))}null!=d&&
(f=d-a,e.next=Math.floor(Math.abs(100*(d-c-f)/f)));return e}Object.defineProperty(a,"__esModule",{value:!0});a.format=a.round=a.percentChange=a.numDigits=void 0;var f=/^-?(\d+)(\.(\d+))?$/i;a.numDigits=g;a.percentChange=d;a.round=function(a,c){void 0===c&&(c={});a=a.slice(0);var b=c.tolerance,b=void 0===b?2:b,e=c.strictBounds,e=void 0===e?!1:e;c=c.indexes;c=void 0===c?a.map(function(a,c){return c}):c;c.sort(l);for(var d=0;d<c.length;d++){var f=c[d],n=a[f],y=0===f?null:a[f-1],w=f===a.length-1?null:
a[f+1],m=g(n).fractional;if(m){for(var z=0,A=!1,C=void 0;z<=m&&!A;)A=k(n,z),C=e&&0===d?A[1]:A[0],A=h(n,C,y,w,b),z++;A&&(a[f]=C)}}return a};var c={maximumFractionDigits:20};a.format=function(a){return b.formatNumber(a,c)}})},"esri/renderers/visualVariables/VisualVariableFactory":function(){define("require exports tslib ../../core/Accessor ../../core/jsonMap ../../core/Logger ../../core/Warning ../../core/accessorSupport/decorators ./ColorVariable ./OpacityVariable ./RotationVariable ./SizeVariable".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){var t=h.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),x={color:f,size:n,opacity:c,rotation:e},p=new k.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),q=/^\[([^\]]+)\]$/i;return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.colorVariables=null;c.opacityVariables=null;c.rotationVariables=null;c.sizeVariables=null;return c}b.__extends(c,a);Object.defineProperty(c.prototype,
"visualVariables",{set:function(a){this._resetVariables();if((a=a&&a.filter(function(a){return!!a}))&&a.length){for(var c=0,b=a;c<b.length;c++){var e=b[c];switch(e.type){case "color":this.colorVariables.push(e);break;case "opacity":this.opacityVariables.push(e);break;case "rotation":this.rotationVariables.push(e);break;case "size":this.sizeVariables.push(e)}}this.sizeVariables.length&&this.sizeVariables.some(function(a){return!!a.target})&&a.sort(function(a,c){var b=null;return b=a.target===c.target?
0:a.target?1:-1});for(c=0;c<a.length;c++)e=a[c],e.index=c}this._set("visualVariables",a)},enumerable:!1,configurable:!0});c.prototype.readVariables=function(a,c,b){var e=c.rotationExpression;c=c.rotationType;if(e=(e=e&&e.match(q))&&e[1])a||(a=[]),a.push({type:"rotationInfo",rotationType:c,field:e});if(a)return a.map(function(a){var c=p.read(a.type),e=x[c];e||(t.warn("Unknown variable type: "+c),b&&b.messages&&b.messages.push(new g("visual-variable:unsupported","visualVariable of type '"+c+"' is not supported",
{definition:a,context:b})));c=new e;c.read(a,b);return c})};c.prototype.writeVariables=function(a,c){for(var b=[],e=0;e<a.length;e++){var d=a[e].toJSON(c);d&&b.push(d)}return b};c.prototype._resetVariables=function(){this.colorVariables=[];this.opacityVariables=[];this.rotationVariables=[];this.sizeVariables=[]};b.__decorate([d.property()],c.prototype,"visualVariables",null);return c=b.__decorate([d.subclass("esri.renderers.visualVariables.VisualVariableFactory")],c)}(l)})},"esri/renderers/support/ClassBreakInfo":function(){define("require exports tslib ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),
function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.description=null;c.label=null;c.minValue=null;c.maxValue=0;c.symbol=null;return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})};d.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol);return this.minValue+"."+this.maxValue+"."+a};var c;b.__decorate([h.property({type:String,
json:{write:!0}})],d.prototype,"description",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);b.__decorate([h.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],d.prototype,"minValue",void 0);b.__decorate([h.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],d.prototype,"maxValue",void 0);b.__decorate([h.property({types:l.symbolTypesRenderer,json:{origins:{"web-scene":{types:l.symbolTypesRenderer3D,
write:g.write}},write:g.write}})],d.prototype,"symbol",void 0);return d=c=b.__decorate([h.subclass("esri.renderers.support.ClassBreakInfo")],d)}(k.JSONSupport)})},"esri/renderers/support/commonProperties":function(){define(["require","exports","../../symbols","../../symbols/support/jsonUtils"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.rendererBackgroundFillSymbolProperty=a.rendererSymbolProperty=void 0;a.rendererSymbolProperty={types:b.symbolTypesRenderer,json:{write:{writer:l.write},
origins:{"web-scene":{types:b.symbolTypesRenderer3D,write:{writer:l.write}}}}};a.rendererBackgroundFillSymbolProperty={types:{base:b.BaseSymbol,key:"type",typeMap:{"simple-fill":b.symbolTypes.typeMap["simple-fill"],"picture-fill":b.symbolTypes.typeMap["picture-fill"],"polygon-3d":b.symbolTypes.typeMap["polygon-3d"]}},json:{write:{writer:l.write},origins:{"web-scene":{type:b.PolygonSymbol3D,write:{writer:l.write}}}}}})},"esri/renderers/DictionaryRenderer":function(){define("require exports tslib ../Color ../request ../core/Error ../core/lang ../core/Logger ../core/LRUCache ../core/maybe ../core/promiseUtils ../core/SetUtils ../core/string ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ../support/arcadeOnDemand ../symbols/CIMSymbol".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w){var B=d.getLogger("esri.renderers.DictionaryRenderer");return function(a){function d(c){c=a.call(this,c)||this;c._ongoingRequests=new Map;c._symbolCache=new f(100);c.config=null;c.fieldMap=null;c.scaleExpression=null;c.scaleExpressionTitle=null;c.url=null;c.type="dictionary";return c}b.__extends(d,a);q=d;d.prototype.writeData=function(a,c){a&&(c.scalingExpressionInfo={expression:a,returnType:"number"})};d.prototype.writeVisualVariables=function(c,b,
e,d){(null===d||void 0===d?0:d.origin)||a.prototype.writeVisualVariables.call(this,c,b,e,d)};d.prototype.clone=function(){return new q({config:g.clone(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:g.clone(this.fieldMap),url:g.clone(this.url),visualVariables:g.clone(this.visualVariables)})};d.prototype.getSymbolAsync=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var d,f,g,n,h,k,p,q,u,x,w,y,m,z,D,B,C,A,E,ca,Z,ga,ea,la,ja,ua,
xa=this;return b.__generator(this,function(b){switch(b.label){case 0:this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(c)),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,this._dictionaryPromise];case 2:return d=b.sent(),[3,4];case 3:return f=b.sent(),e.isAbortError(f)?(this._dictionaryPromise=null,[2,null]):[3,4];case 4:g={};if(this.fieldMap)for(n=0,h=this._symbolFields;n<h.length;n++)k=h[n],(p=this.fieldMap[k])&&null!==a.attributes[p]&&void 0!==a.attributes[p]?(q=""+a.attributes[p],
g[k]=q):g[k]="";u=d(g,c);if(!u||"string"!==typeof u)return[2,null];x=t.numericHash(u).toString();if(w=this._symbolCache.get(x))return w.catch(function(){xa._symbolCache.pop(x)}),[2,w];y=u.split(";");m=[];z=[];D=0;for(B=y;D<B.length;D++)if((C=B[D])&&0!==C.length)if(-1!==C.indexOf("po:"))A=C.substr(3).split("|"),3===A.length&&(E=A[0],ca=A[1],Z=A[2],"DashTemplate"===ca?Z=Z.split(" ").map(function(a){return Number(a)}):"Color"===ca?(ga=(new l(Z)).toRgba(),Z=[ga[0],ga[1],ga[2],255*ga[3]]):Z=Number(Z),
z.push({primitiveName:E,propertyName:ca,value:Z}));else if(-1!==C.indexOf("|"))for(ea=0,la=C.split("|");ea<la.length;ea++)ja=la[ea],this._itemNames.has(ja)&&m.push(ja);else this._itemNames.has(C)&&m.push(C);ua=this._cimPartsToCIMSymbol(m,z,c);this._symbolCache.put(x,ua,1);return[2,ua]}})})};d.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.collectVVRequiredFields(a,c)];
case 1:return b.sent(),this.scaleExpression?[4,p.collectArcadeFieldNames(a,c,this.scaleExpression)]:[3,3];case 2:b.sent(),b.label=3;case 3:e=c.map(function(a){return a.name});for(d in this.fieldMap)0>e.indexOf(this.fieldMap[d])||a.add(this.fieldMap[d]);return[2]}})})};Object.defineProperty(d.prototype,"arcadeRequired",{get:function(){return!0},enumerable:!1,configurable:!0});d.prototype.fetchResources=function(a){return b.__awaiter(this,void 0,void 0,function(){var d,f,g,p,l,q,t,u,x,w,m,z,C,A,E;return b.__generator(this,
function(D){switch(D.label){case 0:if(this._dictionaryPromise)return[2,this._dictionaryPromise];if(!this.url)return B.error("no valid URL!"),[2,void 0];d=c.isSome(a)?a.abortOptions:null;f=k(this.url+"/resources/styles/dictionary-info.json",b.__assign({responseType:"json",query:{f:"json"}},d));return[4,e.all([f,y.loadArcade()])];case 1:g=D.sent()[0].data;if(!g)throw this._dictionaryPromise=null,new h("esri.renderers.DictionaryRenderer","Bad dictionary data!");p=g.expression;l=g.authoringInfo;this._refSymbolUrlTemplate=
this.url+"/"+g.cimRefTemplateUrl;this._itemNames=n.SetFromValues(g.itemsNames);this._symbolFields=l.symbol;q={};if(this.config)for(u in t=this.config,t)q[u]=t[u];x=0;for(w=l.configuration;x<w.length;x++)u=w[x],q.hasOwnProperty(u.name)||(q[u.name]=u.value);m=[];if(c.isSome(a)&&a.fields&&this.fieldMap)for(z=function(c){var e=C.fieldMap[c],d=a.fields.filter(function(a){return a.name===e});0<d.length&&m.push(b.__assign(b.__assign({},d[0]),{name:c}))},C=this,A=0,E=this._symbolFields;A<E.length;A++)u=E[A],
z(u);this._dictionaryPromise=y.createDictionaryExpression(p,c.isSome(a)?a.spatialReference:null,m,q).then(function(a){var b={scale:0};return function(e,d){e=a.repurposeFeature({geometry:null,attributes:e});b.scale=c.isSome(d)?d.scale:void 0;return a.evaluate({$feature:e,$view:b})}}).catch(function(a){B.error("Creating dictinoary expression failed:",a);return null});return[2,this._dictionaryPromise]}})})};d.prototype.getSymbol=function(){return null};d.prototype.getSymbols=function(){return[]};d.prototype.getAttributeHash=
function(){return this.visualVariables&&this.visualVariables.reduce(function(a,c){return a+c.getAttributeHash()},"")};d.prototype.getMeshHash=function(){return this.url+"-"+JSON.stringify(this.fieldMap)};d.prototype.getSymbolFields=function(){return this._symbolFields};d.prototype._getSymbolPart=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var d,f,g,n;return b.__generator(this,function(h){switch(h.label){case 0:if(this._ongoingRequests.has(a))return[2,this._ongoingRequests.get(a).then(function(a){return a.data})];
d=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,a);f=k(d,b.__assign({responseType:"json",query:{f:"json"}},c));this._ongoingRequests.set(a,f);h.label=1;case 1:return h.trys.push([1,3,,4]),[4,f];case 2:return g=h.sent(),[2,g.data];case 3:return n=h.sent(),this._ongoingRequests.delete(a),[2,e.reject(n)];case 4:return[2]}})})};d.prototype._combineSymbolParts=function(a,c){var e;if(!a||0===a.length)return null;if(1===a.length)return{type:"CIMSymbolReference",symbol:a[0],primitiveOverrides:c};var d=
b.__assign({},a[0]);d.symbolLayers=[];for(var f=0;f<a.length;f++){var g=a[f];(e=d.symbolLayers).unshift.apply(e,g.symbolLayers)}return{type:"CIMSymbolReference",symbol:d,primitiveOverrides:c}};d.prototype._cimPartsToCIMSymbol=function(a,c,d){return b.__awaiter(this,void 0,void 0,function(){var f,g,n;return b.__generator(this,function(b){switch(b.label){case 0:f=Array(a.length);for(g=0;g<a.length;g++)f[g]=this._getSymbolPart(a[g],d);return[4,e.all(f)];case 1:return n=b.sent(),[2,new w({data:this._combineSymbolParts(n,
c)})]}})})};var q;b.__decorate([x.property({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],d.prototype,"config",void 0);b.__decorate([x.property({type:Object,json:{write:!0}})],d.prototype,"fieldMap",void 0);b.__decorate([x.property({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],d.prototype,"scaleExpression",void 0);b.__decorate([x.writer("scaleExpression")],d.prototype,"writeData",null);b.__decorate([x.property({type:String,json:{read:{source:"scalingExpressionInfo.title"},
write:{target:"scalingExpressionInfo.title",overridePolicy:function(a){return{enabled:!!a&&!!this.scaleExpression}}}}})],d.prototype,"scaleExpressionTitle",void 0);b.__decorate([x.property({type:String,json:{write:!0}})],d.prototype,"url",void 0);b.__decorate([x.writer("visualVariables")],d.prototype,"writeVisualVariables",null);return d=q=b.__decorate([x.subclass("esri.renderers.DictionaryRenderer")],d)}(u.VisualVariablesMixin(q))})},"esri/core/LRUCache":function(){define(["require","exports","./MemCache"],
function(m,a,b){return function(){function a(a,h){this._storage=new b.MemCacheStorage;this._storage.maxSize=a;h&&this._storage.registerRemoveFunc("",h)}a.prototype.put=function(a,b,g){this._storage.put(a,b,g,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},
set:function(a){this._storage.maxSize=a},enumerable:!1,configurable:!0});return a}()})},"esri/renderers/DotDensityRenderer":function(){define("require exports tslib ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/AttributeColorInfo ./support/DotDensityLegendOptions ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n,t){return function(a){function d(c){c=a.call(this,
c)||this;c.attributes=null;c.backgroundColor=new l([0,0,0,0]);c.blendDots=!0;c.dotBlendingEnabled=!0;c.dotShape="square";c.dotSize=1;c.legendOptions=null;c.outline=new t;c.dotValue=null;c.referenceDotValue=null;c.referenceScale=null;c.seed=1;c.type="dot-density";return c}b.__extends(d,a);f=d;d.prototype.calculateDotValue=function(a){if(null==this.referenceScale)return this.dotValue;a=a/this.referenceScale*this.dotValue;return 1>a?1:a};d.prototype.getSymbol=function(){return new n({outline:this.outline})};
d.prototype.getSymbolAsync=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){return[2,this.getSymbol()]})})};d.prototype.getSymbols=function(){return[this.getSymbol()]};d.prototype.getAttributeHash=function(){return this.attributes&&this.attributes.reduce(function(a,c){return a+c.getAttributeHash()},"")};d.prototype.getMeshHash=function(){return JSON.stringify(this.outline)};d.prototype.clone=function(){return new f({attributes:k.clone(this.attributes),
backgroundColor:k.clone(this.backgroundColor),dotBlendingEnabled:k.clone(this.dotBlendingEnabled),dotShape:k.clone(this.dotShape),dotSize:k.clone(this.dotSize),dotValue:k.clone(this.dotValue),legendOptions:k.clone(this.legendOptions),outline:k.clone(this.outline),referenceScale:k.clone(this.referenceScale),visualVariables:k.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};d.prototype.getControllerHash=function(){var a=this.attributes.map(function(a){return a.field||
a.valueExpression||""}),c=this.outline&&JSON.stringify(this.outline.toJSON())||"";return a+"-"+c};d.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.collectVVRequiredFields(a,c)];case 1:b.sent(),e=0,d=this.attributes,b.label=2;case 2:if(!(e<d.length))return[3,6];f=d[e];return f.valueExpression?[4,g.collectArcadeFieldNames(a,c,f.valueExpression)]:[3,4];case 3:b.sent(),
b.label=4;case 4:f.field&&a.add(f.field),b.label=5;case 5:return e++,[3,2];case 6:return[2]}})})};var f;b.__decorate([h.property({type:[c],json:{write:!0}})],d.prototype,"attributes",void 0);b.__decorate([h.property({type:l,json:{write:!0}})],d.prototype,"backgroundColor",void 0);b.__decorate([h.property({type:Boolean}),h.aliasOf("dotBlendingEnabled")],d.prototype,"blendDots",void 0);b.__decorate([h.property({type:Boolean,json:{write:!0}})],d.prototype,"dotBlendingEnabled",void 0);b.__decorate([h.property({type:String,
json:{write:!0}})],d.prototype,"dotShape",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],d.prototype,"dotSize",void 0);b.__decorate([h.property({type:e,json:{write:!0}})],d.prototype,"legendOptions",void 0);b.__decorate([h.property({type:t,json:{default:null,write:!0}})],d.prototype,"outline",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],d.prototype,"dotValue",void 0);b.__decorate([h.property({type:Number}),h.aliasOf("dotValue")],d.prototype,"referenceDotValue",
void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],d.prototype,"referenceScale",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],d.prototype,"seed",void 0);b.__decorate([h.enumeration({dotDensity:"dot-density"})],d.prototype,"type",void 0);return d=f=b.__decorate([h.subclass("esri.renderers.DotDensityRenderer")],d)}(f.VisualVariablesMixin(d))})},"esri/renderers/support/AttributeColorInfo":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(m,a,b,l,k,h,g,d){var f=h.getLogger("esri.renderers.support.AttributeColorInfo");return function(a){function c(c){c=a.call(this,c)||this;c.color=null;c.field=null;c.label=null;c.valueExpression=null;c.valueExpressionTitle=null;return c}b.__extends(c,a);n=c;c.prototype.castField=function(a){return null==a?a:"function"===typeof a?(f.error(".field: field must be a string value"),null):d.ensureString(a)};c.prototype.getAttributeHash=function(){return this.field+"-"+this.valueExpression};c.prototype.clone=
function(){return new n({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})};var n;b.__decorate([g.property({type:l,json:{type:[Number],write:!0}})],c.prototype,"color",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"field",void 0);b.__decorate([g.cast("field")],c.prototype,"castField",null);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"label",
void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"valueExpression",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0);return c=n=b.__decorate([g.subclass("esri.renderers.support.AttributeColorInfo")],c)}(k.JSONSupport)})},"esri/renderers/support/DotDensityLegendOptions":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(){var b=
null!==a&&a.apply(this,arguments)||this;b.unit=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({unit:this.unit})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"unit",void 0);return g=d=b.__decorate([k.subclass("esri.renderers.support.DotDensityLegendOptions")],g)}(l.JSONSupport)})},"esri/renderers/HeatmapRenderer":function(){define("require exports tslib ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./support/HeatmapColorStop".split(" "),
function(m,a,b,l,k,h,g,d,f){return function(a){function c(c){c=a.call(this,c)||this;c.blurRadius=10;c.colorStops=[new f({ratio:0,color:new l("rgba(255, 140, 0, 0)")}),new f({ratio:.75,color:new l("rgba(255, 140, 0, 1)")}),new f({ratio:.9,color:new l("rgba(255, 0,   0, 1)")})];c.field=null;c.fieldOffset=0;c.maxPixelIntensity=100;c.minPixelIntensity=0;c.type="heatmap";return c}b.__extends(c,a);d=c;c.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;
return b.__generator(this,function(b){(e=this.field)&&"string"===typeof e&&g.collectField(a,c,e);return[2]})})};c.prototype.getAttributeHash=function(){return null};c.prototype.getMeshHash=function(){return JSON.stringify(this.colorStops)+"."+this.blurRadius+"."+this.field};c.prototype.clone=function(){return new d({blurRadius:this.blurRadius,colorStops:k.clone(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})};var d;b.__decorate([h.property({type:Number,
json:{write:!0}})],c.prototype,"blurRadius",void 0);b.__decorate([h.property({type:[f],json:{write:!0}})],c.prototype,"colorStops",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"field",void 0);b.__decorate([h.property({type:Number,json:{write:{overridePolicy:function(a,c,b){return{enabled:null==b}}}}})],c.prototype,"fieldOffset",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],c.prototype,"maxPixelIntensity",void 0);b.__decorate([h.property({type:Number,
json:{write:!0}})],c.prototype,"minPixelIntensity",void 0);b.__decorate([h.enumeration({heatmap:"heatmap"})],c.prototype,"type",void 0);return c=d=b.__decorate([h.subclass("esri.renderers.HeatmapRenderer")],c)}(d)})},"esri/renderers/support/HeatmapColorStop":function(){define("require exports tslib ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.color=null;c.ratio=null;return c}b.__extends(d,
a);f=d;d.prototype.clone=function(){return new f({color:this.color,ratio:this.ratio})};var f;b.__decorate([h.property({type:l,json:{write:!0}})],d.prototype,"color",void 0);b.__decorate([h.property({type:Number,json:{write:!0}})],d.prototype,"ratio",void 0);return d=f=b.__decorate([h.subclass("esri.renderers.support.HeatmapColorStop")],d)}(k.JSONSupport)})},"esri/renderers/SimpleRenderer":function(){define("require exports tslib ../core/lang ../core/promiseUtils ../core/accessorSupport/decorators ./Renderer ./mixins/VisualVariablesMixin ./support/commonProperties".split(" "),
function(m,a,b,l,k,h,g,d,f){return function(a){function c(c){c=a.call(this,c)||this;c.description=null;c.label=null;c.symbol=null;c.type="simple";return c}b.__extends(c,a);d=c;c.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){switch(b.label){case 0:return[4,k.all([this.collectSymbolFields(a,c),this.collectVVRequiredFields(a,c)])];case 1:return b.sent(),[2]}})})};c.prototype.collectSymbolFields=function(a,c){return b.__awaiter(this,
void 0,void 0,function(){return b.__generator(this,function(b){switch(b.label){case 0:return[4,k.all(this.getSymbols().map(function(b){return b.collectRequiredFields(a,c)}))];case 1:return b.sent(),[2]}})})};c.prototype.getSymbol=function(a,c){return this.symbol};c.prototype.getSymbolAsync=function(a,c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){return[2,this.symbol]})})};c.prototype.getSymbols=function(){return this.symbol?[this.symbol]:[]};c.prototype.getAttributeHash=
function(){return this.visualVariables&&this.visualVariables.reduce(function(a,c){return a+c.getAttributeHash()},"")};c.prototype.getMeshHash=function(){return this.getSymbols().reduce(function(a,c){return a+=JSON.stringify(c)},"")};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables},enumerable:!1,configurable:!0});c.prototype.clone=function(){return new d({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),
visualVariables:l.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};var d;b.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"description",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);b.__decorate([h.property(f.rendererSymbolProperty)],c.prototype,"symbol",void 0);b.__decorate([h.enumeration({simple:"simple"})],c.prototype,"type",void 0);return c=d=b.__decorate([h.subclass("esri.renderers.SimpleRenderer")],
c)}(d.VisualVariablesMixin(g))})},"esri/renderers/UniqueValueRenderer":function(){define("require exports tslib ../symbols ../symbols ../core/arrayUtils ../core/Error ../core/lang ../core/Logger ../core/maybe ../core/object ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/diffUtils ../core/accessorSupport/ensureType ../layers/support/fieldUtils ../portal/Portal ./Renderer ./mixins/VisualVariablesMixin ./support/commonProperties ./support/LegendOptions ./support/UniqueValueInfo ../support/arcadeOnDemand ../support/persistableUrlUtils ../symbols/support/styleUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z,A,C,E,D){var F=f.getLogger("esri.renderers.UniqueValueRenderer"),H=p.ensureType(A);return function(a){function f(c){c=a.call(this,c)||this;c._valueInfoMap={};c._isDefaultSymbolDerived=!1;c.type="unique-value";c.backgroundFillSymbol=null;c.field=null;c.field2=null;c.field3=null;c.valueExpression=null;c.valueExpressionTitle=null;c.legendOptions=null;c.defaultLabel=null;c.fieldDelimiter=null;c.portal=null;c.styleOrigin=null;c.diff={uniqueValueInfos:function(a,
c){if(a||c){if(!a||!c)return{type:"complete",oldValue:a,newValue:c};for(var b=!1,e={type:"collection",added:[],removed:[],changed:[],unchanged:[]},d=function(d){var f=h.find(a,function(a){return a.value===c[d].value});f?x.diff(f,c[d])?(e.changed.push({type:"complete",oldValue:f,newValue:c[d]}),b=!0):e.unchanged.push({oldValue:f,newValue:c[d]}):(e.added.push(c[d]),b=!0)},f=0;f<c.length;f++)d(f);d=function(d){h.find(c,function(c){return c.value===a[d].value})||(e.removed.push(a[d]),b=!0)};for(f=0;f<
a.length;f++)d(f);return b?e:void 0}}};c._set("uniqueValueInfos",[]);return c}b.__extends(f,a);w=f;Object.defineProperty(f.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!1,configurable:!0});f.prototype.castField=function(a){return null==a||"function"===typeof a?a:p.ensureString(a)};f.prototype.writeField=function(a,c,b,e){"string"===typeof a?c[b]=a:e&&e.messages?e.messages.push(new g("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):
F.error(".field: cannot write field to JSON since it's not a string value")};Object.defineProperty(f.prototype,"defaultSymbol",{set:function(a){this._isDefaultSymbolDerived=!1;this._set("defaultSymbol",a)},enumerable:!1,configurable:!0});f.prototype.readPortal=function(a,c,b){return b.portal||u.getDefault()};f.prototype.readStyleOrigin=function(a,c,b){if(c.styleName)return Object.freeze({styleName:c.styleName});if(c.styleUrl)return a=E.fromJSON(c.styleUrl,b),Object.freeze({styleUrl:a})};f.prototype.writeStyleOrigin=
function(a,c,b,e){a.styleName?c.styleName=a.styleName:a.styleUrl&&(c.styleUrl=E.toJSON(a.styleUrl,e))};Object.defineProperty(f.prototype,"uniqueValueInfos",{set:function(a){this.styleOrigin?F.error("#uniqueValueInfos\x3d","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",a),this._updateValueInfoMap())},enumerable:!1,configurable:!0});f.prototype.addUniqueValueInfo=function(a,c){this.styleOrigin?F.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):
(a="object"===typeof a?H(a):new A({value:a,symbol:k.ensureType(c)}),this.uniqueValueInfos.push(a),this._valueInfoMap[a.value]=a)};f.prototype.removeUniqueValueInfo=function(a){if(this.styleOrigin)F.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var c=0;c<this.uniqueValueInfos.length;c++)if(this.uniqueValueInfos[c].value===a+""){delete this._valueInfoMap[a];this.uniqueValueInfos.splice(c,1);break}};f.prototype.getUniqueValueInfo=
function(a,e){return b.__awaiter(this,void 0,void 0,function(){var d,f,g;return b.__generator(this,function(n){switch(n.label){case 0:d=e;if(!this.valueExpression||!c.isNone(e)&&!c.isNone(e.arcade))return[3,2];f=[b.__assign({},d)];g={};return[4,C.loadArcade()];case 1:d=b.__assign.apply(void 0,f.concat([(g.arcade=n.sent(),g)])),n.label=2;case 2:return[2,this._getUniqueValueInfo(a,d)]}})})};f.prototype.getSymbol=function(a,b){if(this.valueExpression&&(c.isNone(b)||c.isNone(b.arcade)))F.error("#getSymbol()",
"Please use getSymbolAsync if valueExpression is used");else return(a=this._getUniqueValueInfo(a,b))&&a.symbol||this.defaultSymbol};f.prototype.getSymbolAsync=function(a,e){return b.__awaiter(this,void 0,void 0,function(){var d,f,g,n;return b.__generator(this,function(h){switch(h.label){case 0:d=e;if(!this.valueExpression||!c.isNone(d)&&!c.isNone(d.arcade))return[3,2];f=[b.__assign({},d)];g={};return[4,C.loadArcade()];case 1:d=b.__assign.apply(void 0,f.concat([(g.arcade=h.sent(),g)])),h.label=2;case 2:return n=
this._getUniqueValueInfo(a,d),[2,n&&n.symbol||this.defaultSymbol]}})})};f.prototype.getSymbols=function(){for(var a=[],c=0,b=this.uniqueValueInfos;c<b.length;c++){var e=b[c];e.symbol&&a.push(e.symbol)}this.defaultSymbol&&a.push(this.defaultSymbol);return a};f.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,c){return a+c.getAttributeHash()},"")};f.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),c=JSON.stringify(this.defaultSymbol),
b=this.uniqueValueInfos.reduce(function(a,c){return a+c.getMeshHash()},"");return a+"."+c+"."+b+"."+(this.field+"."+this.field2+"."+this.field3+"."+this.fieldDelimiter)+"."+this.valueExpression};f.prototype.clone=function(){var a=new w({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:d.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:d.clone(this.visualVariables),
legendOptions:d.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:d.clone(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(a._isDefaultSymbolDerived=!0);a._set("portal",this.portal);var c=d.clone(this.uniqueValueInfos);this.styleOrigin&&(a._set("styleOrigin",Object.freeze(d.clone(this.styleOrigin))),Object.freeze(c));a._set("uniqueValueInfos",c);a._updateValueInfoMap();return a};Object.defineProperty(f.prototype,"arcadeRequired",
{get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression},enumerable:!1,configurable:!0});f.prototype.collectRequiredFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return e=[this.collectVVRequiredFields(a,c),this.collectSymbolFields(a,c)],[4,n.all(e)];case 1:return b.sent(),[2]}})})};f.prototype.collectSymbolFields=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;
return b.__generator(this,function(d){switch(d.label){case 0:return e=b.__spreadArrays(this.getSymbols().map(function(b){return b.collectRequiredFields(a,c)}),[q.collectArcadeFieldNames(a,c,this.valueExpression)]),q.collectField(a,c,this.field),q.collectField(a,c,this.field2),q.collectField(a,c,this.field3),[4,n.all(e)];case 1:return d.sent(),[2]}})})};f.prototype.populateFromStyle=function(){var a=this;return D.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(c){var b=[];a._valueInfoMap=
{};c&&c.data&&Array.isArray(c.data.items)&&c.data.items.forEach(function(e){var d=new l.WebStyleSymbol({styleUrl:c.styleUrl,styleName:c.styleName,portal:a.portal,name:e.name});a.defaultSymbol||e.name!==c.data.defaultItem||(a.defaultSymbol=d,a._isDefaultSymbolDerived=!0);d=new A({value:e.name,symbol:d});b.push(d);a._valueInfoMap[e.name]=d});a._set("uniqueValueInfos",Object.freeze(b));!a.defaultSymbol&&a.uniqueValueInfos.length&&(a.defaultSymbol=a.uniqueValueInfos[0].symbol,a._isDefaultSymbolDerived=
!0);return a})};f.prototype._updateValueInfoMap=function(){var a=this;this._valueInfoMap={};this.uniqueValueInfos.forEach(function(c){return a._valueInfoMap[c.value+""]=c})};f.prototype._getUniqueValueInfo=function(a,c){return this.valueExpression?this._getUnqiueValueInfoForExpression(a,c):this._getUnqiueValueInfoForFields(a)};f.prototype._getUnqiueValueInfoForExpression=function(a,b){var e=c.unwrapOr(b,{});b=e.viewingMode;var d=e.scale,f=e.spatialReference,g=this._cache.compiledFunc,e=c.unwrap(e.arcade).arcadeUtils;
g||(g=e.createSyntaxTree(this.valueExpression),g=e.createFunction(g),this._cache.compiledFunc=g);a=e.executeFunction(g,e.createExecContext(a,e.getViewInfo({viewingMode:b,scale:d,spatialReference:f})));return this._valueInfoMap[a+""]};f.prototype._getUnqiueValueInfoForFields=function(a){var c=this.field,b=a.attributes,e;if("function"!==typeof c&&this.field2){a=this.field2;e=this.field3;var d=[];c&&d.push(b[c]);a&&d.push(b[a]);e&&d.push(b[e]);e=d.join(this.fieldDelimiter||"")}else"function"===typeof c?
e=c(a):c&&(e=b[c]);return this._valueInfoMap[e+""]};f.fromPortalStyle=function(a,c){var b=new w(c&&c.properties);b._set("styleOrigin",Object.freeze({styleName:a}));b._set("portal",c&&c.portal||u.getDefault());c=b.populateFromStyle();c.catch(function(c){F.error("#fromPortalStyle('"+a+"'[, ...])","Failed to create unique value renderer from style name",c)});return c};f.fromStyleUrl=function(a,c){c=new w(c&&c.properties);c._set("styleOrigin",Object.freeze({styleUrl:a}));c=c.populateFromStyle();c.catch(function(c){F.error("#fromStyleUrl('"+
a+"'[, ...])","Failed to create unique value renderer from style URL",c)});return c};var w;b.__decorate([t.property({readOnly:!0,dependsOn:["valueExpression"]})],f.prototype,"_cache",null);b.__decorate([t.enumeration({uniqueValue:"unique-value"})],f.prototype,"type",void 0);b.__decorate([t.property(B.rendererBackgroundFillSymbolProperty)],f.prototype,"backgroundFillSymbol",void 0);b.__decorate([t.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],f.prototype,"field",void 0);
b.__decorate([t.cast("field")],f.prototype,"castField",null);b.__decorate([t.writer("field")],f.prototype,"writeField",null);b.__decorate([t.property({type:String,json:{write:!0}})],f.prototype,"field2",void 0);b.__decorate([t.property({type:String,json:{write:!0}})],f.prototype,"field3",void 0);b.__decorate([t.property({type:String,json:{write:!0}})],f.prototype,"valueExpression",void 0);b.__decorate([t.property({type:String,json:{write:!0}})],f.prototype,"valueExpressionTitle",void 0);b.__decorate([t.property({type:z.default,
json:{write:!0}})],f.prototype,"legendOptions",void 0);b.__decorate([t.property({type:String,json:{write:!0}})],f.prototype,"defaultLabel",void 0);b.__decorate([t.property(e.deepMerge(b.__assign({},B.rendererSymbolProperty),{json:{write:{overridePolicy:function(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy:function(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],f.prototype,"defaultSymbol",null);b.__decorate([t.property({type:String,json:{write:!0}})],
f.prototype,"fieldDelimiter",void 0);b.__decorate([t.property({type:u,readOnly:!0})],f.prototype,"portal",void 0);b.__decorate([t.reader("portal",["styleName"])],f.prototype,"readPortal",null);b.__decorate([t.property({readOnly:!0,json:{write:{enabled:!1,overridePolicy:function(){return{enabled:!0}}}}})],f.prototype,"styleOrigin",void 0);b.__decorate([t.reader("styleOrigin",["styleName","styleUrl"])],f.prototype,"readStyleOrigin",null);b.__decorate([t.writer("styleOrigin",{styleName:{type:String},
styleUrl:{type:String}})],f.prototype,"writeStyleOrigin",null);b.__decorate([t.property({type:[A],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],f.prototype,"uniqueValueInfos",null);return f=w=b.__decorate([t.subclass("esri.renderers.UniqueValueRenderer")],f)}(w.VisualVariablesMixin(y))})},"esri/renderers/support/UniqueValueInfo":function(){define("require exports tslib ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),
function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.description=null;c.label=null;c.symbol=null;c.value=null;return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})};d.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol&&this.symbol.toJSON());return this.value+"."+a};var c;b.__decorate([h.property({type:String,json:{write:!0}})],
d.prototype,"description",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);b.__decorate([h.property({types:l.symbolTypesRenderer,json:{origins:{"web-scene":{types:l.symbolTypesRenderer3D,write:g.write}},write:g.write}})],d.prototype,"symbol",void 0);b.__decorate([h.property({type:String,json:{write:!0}})],d.prototype,"value",void 0);return d=c=b.__decorate([h.subclass("esri.renderers.support.UniqueValueInfo")],d)}(k.JSONSupport)})},"esri/symbols/support/styleUtils":function(){define("require exports tslib ../../request ../../symbols ../../core/arrayUtils ../../core/devEnvironmentUtils ../../core/Error ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags ../../support/persistableUrlUtils ./jsonUtils ./StyleOrigin ./Thumbnail".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u){function y(a,b){return F(a,b).then(function(b){return{data:b.data,baseUrl:c.removeFile(a),styleUrl:a}})}function w(a,c,b){c=c.portal||e.getDefault();var d,f=c.url+" - "+(c.user&&c.user.username)+" - "+a;H[f]||(H[f]=B(a,c,b).then(function(a){d=a;return a.fetchData()}).then(function(c){return{data:c,baseUrl:d.itemUrl,styleName:a}}));return H[f]}function B(a,c,b){return c.load(b).then(function(){var e=new n({disableExtraQuery:!0,query:"owner:"+I+" AND type:"+
G+' AND typekeywords:"'+a+'"'});return c.queryItems(e,b)}).then(function(c){c=c.results;var e=null,f=a.toLowerCase();if(c&&Array.isArray(c))for(var g=0;g<c.length;g++){var n=c[g];if(n.typeKeywords.some(function(a){return a.toLowerCase()===f})&&n.type===G&&n.owner===I){e=n;break}}if(!e)throw new d("symbolstyleutils:style-not-found","The style '"+a+"' could not be found",{styleName:a});return e.load(b)})}function z(a,c,b){return a.styleUrl?y(a.styleUrl,b):a.styleName?w(a.styleName,c,b):f.reject(new d("symbolstyleutils:style-url-and-name-missing",
"Either styleUrl or styleName is required to resolve a style"))}function A(a,b,e,n,l){var t=a.data,w={portal:e.portal,url:c.urlToObject(a.baseUrl),origin:"portal-item"},t=h.find(t.items,function(a){return a.name===b});if(!t)return f.reject(new d("symbolstyleutils:symbol-name-not-found","The symbol name '"+b+"' could not be found",{symbolName:b}));var y=x.fromJSON(E(t,n),w),m=t.thumbnail&&t.thumbnail.href,z=t.thumbnail&&t.thumbnail.imageData;g.isDevEnvironment()&&(y=g.adjustStaticAGOUrl(y),m=g.adjustStaticAGOUrl(m));
var D={portal:e.portal,url:c.urlToObject(c.removeFile(y)),origin:"portal-item"};return F(y,l).then(function(c){c="cimRef"===n?C(c.data):c.data;if((c=p.fromJSON(c,D))&&k.isSymbol3D(c)){if(m){var d=x.fromJSON(m,w);c.thumbnail=new u.default({url:d})}else z&&(c.thumbnail=new u.default({url:"data:image/png;base64,"+z}));a.styleUrl?c.styleOrigin=new q({portal:e.portal,styleUrl:a.styleUrl,name:b}):a.styleName&&(c.styleOrigin=new q({portal:e.portal,styleName:a.styleName,name:b}))}return c})}function C(a){return null===
a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}}function E(a,c){if("cimRef"===c)return a.cimRef;if(a.formatInfos&&!t.enableWebStyleForceWOSR()){c=0;for(var b=a.formatInfos;c<b.length;c++){var e=b[c];if("gltf"===e.type)return e.href}}return a.webRef}function D(a,b,e){var d=K.replace(/\{SymbolName\}/gi,a.name);return F(d,e).then(function(a){a=C(a.data);return p.fromJSON(a,{portal:b.portal,url:c.urlToObject(c.removeFile(d)),origin:"portal-item"})})}function F(a,e){e=b.__assign({responseType:"json",
query:{f:"json"}},e);return l(c.normalize(a),e)}Object.defineProperty(a,"__esModule",{value:!0});a.styleNameFromItem=a.fetchSymbolFromStyle=a.resolveWebStyleSymbol=a.fetchStyle=void 0;var H={};a.fetchStyle=z;a.resolveWebStyleSymbol=function(a,c,b,e){return a.name?a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?D(a,c,e):z(a,c,e).then(function(d){return A(d,a.name,c,b,e)}):f.reject(new d("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};a.fetchSymbolFromStyle=
A;a.styleNameFromItem=function(a){var c=0;for(a=a.typeKeywords;c<a.length;c++){var b=a[c];if(/^Esri.*Style$/.test(b)&&"Esri Style"!==b)return b}};var I="esri_en",G="Style",K="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson"})},"esri/core/devEnvironmentUtils":function(){define(["require","exports","./global"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.isTelemetryDevEnvironment=a.adjustStaticAGOUrl=
a.isDevEnvironment=void 0;a.isDevEnvironment=function(a){a=a||b.location.hostname;return d.some(function(c){return null!=(null===a||void 0===a?void 0:a.match(c))})};a.adjustStaticAGOUrl=function(a,c){return a?(c=c||b.location.hostname)?null!=c.match(l)||null!=c.match(h)?a.replace("static.arcgis.com","staticdev.arcgis.com"):null!=c.match(k)||null!=c.match(g)?a.replace("static.arcgis.com","staticqa.arcgis.com"):a:a:a};a.isTelemetryDevEnvironment=function(a){a=a||b.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(d).some(function(c){return null!=
(null===a||void 0===a?void 0:a.match(c))})};var l=/^devext.arcgis.com$/,k=/^qaext.arcgis.com$/,h=/^[\w-]*\.mapsdevext.arcgis.com$/,g=/^[\w-]*\.mapsqa.arcgis.com$/,d=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,l,k,/^jsapps.esri.com$/,h,g]})},"esri/support/featureFlags":function(){define(["require","exports","../core/has"],function(m,a,b){function l(a,h){return!!b("enable-feature:"+a+"/"+h)}Object.defineProperty(a,"__esModule",{value:!0});a.enableWebStyleForceWOSR=a.hasEnableFeature=void 0;a.hasEnableFeature=
l;a.enableWebStyleForceWOSR=function(){return l("jschmid","force-wosr")}})},"esri/renderers/support/jsonUtils":function(){define("require exports ../../core/compilerUtils ../../core/Error ../../core/object ../../core/Warning ../../core/accessorSupport/extensions/serializableProperty/reader ./types".split(" "),function(m,a,b,l,k,h,g,d){function f(a,c){if(!c||"web-scene"!==c.origin)return!0;switch(a.type){case "simple":case "unique-value":case "class-breaks":return!0;case "heatmap":case "dictionary":case "dot-density":return!1;
default:return b.neverReached(a),!1}}function c(a,c,b){return a?a&&(a.styleName||a.styleUrl)&&"uniqueValue"!==a.type?(b&&b.messages&&b.messages.push(new h("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+a.type+"'",{definition:a,context:b})),null):e(a,c,b):null}Object.defineProperty(a,"__esModule",{value:!0});a.read=a.fromJSON=a.write=void 0;a.write=function(a,c,b,e){a?f(a,e)?a=a.write({},e):(e.messages&&e.messages.push(new l("renderer:unsupported",
"Renderer of type '"+a.declaredClass+"' are not supported in scenes.",{renderer:a,context:e})),a=null):a=null;a&&k.setDeepValue(b,a,c)};a.fromJSON=function(a,b){return c(a,null,b)};var e=g.createTypeReader({types:d.rendererTypes});a.read=c})},"esri/renderers/support/types":function(){define("require exports ../ClassBreaksRenderer ../DictionaryRenderer ../DotDensityRenderer ../HeatmapRenderer ../Renderer ../SimpleRenderer ../UniqueValueRenderer".split(" "),function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,
"__esModule",{value:!0});a.webSceneRendererTypes=a.rendererTypes=void 0;a.rendererTypes={key:"type",base:g,typeMap:{heatmap:h,simple:d,"unique-value":f,"class-breaks":b,"dot-density":k,dictionary:l},errorContext:"renderer"};a.webSceneRendererTypes={key:"type",base:g,typeMap:{simple:d,"unique-value":f,"class-breaks":b},errorContext:"renderer"}})},"esri/core/MultiOriginJSONSupport":function(){define("require exports tslib ./Accessor ./ReadOnlyMultiOriginJSONSupport ./accessorSupport/PropertyOrigin ./accessorSupport/utils ./accessorSupport/write ./accessorSupport/decorators/subclass".split(" "),
function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.MultiOriginJSONSupport=a.MultiOriginJSONMixin=void 0;var c=function(a){a=function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];return a.apply(this,c)||this}b.__extends(c,a);c.prototype.clear=function(a,c){void 0===c&&(c="user");return g.getProperties(this).store.delete(a,h.nameToId(c))};c.prototype.write=function(a,c){void 0===a&&(a={});a=a||{};d.default(this,a,c);return a};c.prototype.setAtOrigin=
function(a,c,b){g.getProperties(this).setAtOrigin(a,c,h.nameToId(b))};c.prototype.removeOrigin=function(a){var c=g.getProperties(this).store;a=h.nameToId(a);for(var b=0,e=c.keys(a);b<e.length;b++){var d=e[b];c.originOf(d)===a&&c.set(d,c.get(d,a),6)}};c.prototype.updateOrigin=function(a,c){var b=g.getProperties(this).store;c=h.nameToId(c);for(var e=this.get(a),d=c+1;d<h.OriginIdNum;++d)b.delete(a,d);b.set(a,e,c)};c.prototype.toJSON=function(a){return this.write({},a)};return c=b.__decorate([f.subclass("esri.core.WriteableMultiOriginJSONSupport")],
c)}(a);a.prototype.toJSON.isDefaultToJSON=!0;return a};a.MultiOriginJSONMixin=function(a){return function(a){function c(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];return a.apply(this,c)||this}b.__extends(c,a);return c=b.__decorate([f.subclass("esri.core.MultiOriginJSONSupport")],c)}(c(k.ReadOnlyMultiOriginJSONMixin(a)))};m=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);return c=b.__decorate([f.subclass("esri.core.MultiOriginJSONSupport")],
c)}(a.MultiOriginJSONMixin(l));a.MultiOriginJSONSupport=m})},"esri/core/ReadOnlyMultiOriginJSONSupport":function(){define("require exports tslib ./Accessor ./maybe ./accessorSupport/MultiOriginStore ./accessorSupport/PropertyOrigin ./accessorSupport/read ./accessorSupport/utils ./accessorSupport/decorators/subclass".split(" "),function(m,a,b,l,k,h,g,d,f,c){Object.defineProperty(a,"__esModule",{value:!0});a.ReadOnlyMultiOriginJSONSupport=a.ReadOnlyMultiOriginJSONMixin=void 0;a.ReadOnlyMultiOriginJSONMixin=
function(a){return function(a){function e(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];var c=a.apply(this,c)||this,e=k.assumeNonNull(f.getProperties(c)),b=e.metadatas,d=e.store,g=new h.default;e.store=g;d.keys().forEach(function(a){g.set(a,d.get(a),0)});Object.keys(b).forEach(function(a){e.internalGet(a)&&g.set(a,e.internalGet(a),0)});return c}b.__extends(e,a);e.prototype.read=function(a,c){d.default(this,a,c)};e.prototype.getAtOrigin=function(a,c){var b=f.getProperties(this).store,
e=g.nameToId(c);if("string"===typeof a)return b.get(a,e);var d={};a.forEach(function(a){d[a]=b.get(a,e)});return d};e.prototype.originOf=function(a){return g.idToName(this.originIdOf(a))};e.prototype.originIdOf=function(a){return f.getProperties(this).store.originOf(a)};e.prototype.revert=function(a,c){var b=f.getProperties(this).store,e=g.nameToId(c),d=f.getProperties(this);("string"===typeof a?"*"===a?b.keys(e):[a]:a).forEach(function(a){d.propertyInvalidated(a);b.revert(a,e);d.propertyCommitted(a)})};
return e=b.__decorate([c.subclass("esri.core.ReadOnlyMultiOriginJSONSupport")],e)}(a)};m=function(a){function e(){return null!==a&&a.apply(this,arguments)||this}b.__extends(e,a);return e=b.__decorate([c.subclass("esri.core.ReadOnlyMultiOriginJSONSupport")],e)}(a.ReadOnlyMultiOriginJSONMixin(l));a.ReadOnlyMultiOriginJSONSupport=m})},"esri/core/accessorSupport/MultiOriginStore":function(){define("require exports ../arrayUtils ../lang ../maybe ./PropertyOrigin".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,
"__esModule",{value:!0});m=function(){function a(){this._propertyOriginMap=new Map;this._originStores=Array(h.OriginIdNum);this._values=new Map}a.prototype.clone=function(b){var d=new a,c=this._originStores[0];c&&c.forEach(function(a,c){d.set(c,l.clone(a),0)});for(var c=function(a){var c=e._originStores[a];c&&c.forEach(function(c,e){b&&b.has(e)||d.set(e,l.clone(c),a)})},e=this,g=2;g<h.OriginIdNum;g++)c(g);return d};a.prototype.get=function(a,b){return(b=void 0===b?this._values:this._originStores[b])?
b.get(a):void 0};a.prototype.keys=function(a){return(a=null==a?this._values:this._originStores[a])?b.keysOfMap(a):[]};a.prototype.set=function(a,b,c){void 0===c&&(c=6);var e=this._originStores[c];e||(e=new Map,this._originStores[c]=e);e.set(a,b);return!this._values.has(a)||k.assumeNonNull(this._propertyOriginMap.get(a))<=c?(e=this._values.get(a),this._values.set(a,b),this._propertyOriginMap.set(a,c),e!==b):!1};a.prototype.delete=function(a,b){void 0===b&&(b=6);var c=this._originStores[b];if(c){var e=
c.get(a);c.delete(a);if(this._values.has(a)&&this._propertyOriginMap.get(a)===b)for(this._values.delete(a),--b;0<=b;b--)if((c=this._originStores[b])&&c.has(a)){this._values.set(a,c.get(a));this._propertyOriginMap.set(a,b);break}return e}};a.prototype.has=function(a,b){return(b=void 0===b?this._values:this._originStores[b])?b.has(a):!1};a.prototype.revert=function(a,b){for(;0<b&&!this.has(a,b);)--b;var c=this._originStores[b],c=c&&c.get(a),e=this._values.get(a);this._values.set(a,c);this._propertyOriginMap.set(a,
b);return e!==c};a.prototype.originOf=function(a){return this._propertyOriginMap.get(a)||0};a.prototype.forEach=function(a){this._values.forEach(a)};return a}();a.default=m})},"esri/form/FormTemplate":function(){define("require exports tslib ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ../core/accessorSupport/decorators/reader ./ExpressionInfo ./elements/GroupElement ./support/elements".split(" "),function(m,a,b,l,k,h,g,d,f,c){var e=c.buildTypeMaps(f);return function(a){function f(c){c=
a.call(this,c)||this;c.description=null;c.elements=null;c.expressionInfos=null;c.title=null;return c}b.__extends(f,a);n=f;f.prototype.castElements=function(a){return c.ensureType(a,e)};f.prototype.readElements=function(a,b){return c.fromJSON(b.formElements,e)};f.prototype.writeElements=function(a,b){b.formElements=c.toJSON(a,e)};f.prototype.clone=function(){return new n({description:this.description,expressionInfos:k.clone(this.expressionInfos),elements:k.clone(this.elements),title:this.title})};
var n;b.__decorate([h.property({type:String,json:{write:!0}})],f.prototype,"description",void 0);b.__decorate([h.property({json:{write:!0}})],f.prototype,"elements",void 0);b.__decorate([h.cast("elements")],f.prototype,"castElements",null);b.__decorate([g.reader("elements",["formElements"])],f.prototype,"readElements",null);b.__decorate([h.writer("elements")],f.prototype,"writeElements",null);b.__decorate([h.property({type:[d],json:{write:!0}})],f.prototype,"expressionInfos",void 0);b.__decorate([h.property({type:String,
json:{write:!0}})],f.prototype,"title",void 0);return f=n=b.__decorate([h.subclass("esri.form.FormTemplate")],f)}(l.JSONSupport)})},"esri/form/ExpressionInfo":function(){define(["require","exports","tslib","../core/JSONSupport","../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.expression=null;b.name=null;b.returnType="boolean";b.title=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({name:this.name,title:this.title,
expression:this.expression,returnType:this.returnType})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"expression",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"name",void 0);b.__decorate([k.property({type:["boolean"],json:{write:!0}})],g.prototype,"returnType",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"title",void 0);return g=d=b.__decorate([k.subclass("esri.form.ExpressionInfo")],g)}(l.JSONSupport)})},
"esri/form/elements/GroupElement":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/writer ./Element ../support/elements".split(" "),function(m,a,b,l,k,h,g,d,f){m=function(a){function e(c){c=a.call(this,c)||this;c.elements=null;c.initialState="expanded";c.type="group";return c}b.__extends(e,a);d=e;e.prototype.castElements=function(a){return f.ensureType(a,c,!1)};e.prototype.readElements=
function(a,b){return f.fromJSON(b.formElements,c,!1)};e.prototype.writeElements=function(a,b){b.formElements=f.toJSON(a,c,!1)};e.prototype.clone=function(){return new d({description:this.description,elements:l.clone(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})};var d;b.__decorate([k.property({json:{write:!0}})],e.prototype,"elements",void 0);b.__decorate([h.cast("elements")],e.prototype,"castElements",null);b.__decorate([k.reader("elements",
["formElements"])],e.prototype,"readElements",null);b.__decorate([g.writer("elements")],e.prototype,"writeElements",null);b.__decorate([k.property({type:["collapsed","expanded"],json:{default:"expanded",write:!0}})],e.prototype,"initialState",void 0);b.__decorate([k.property({type:String,json:{read:!1,write:!0}})],e.prototype,"type",void 0);return e=d=b.__decorate([k.subclass("esri.form.elements.GroupElement")],e)}(d.Element);var c=f.buildTypeMaps(m);return m})},"esri/form/elements/Element":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.Element=a.ElementMixin=void 0;a.ElementMixin=function(a){return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.description=null;c.label=null;c.visibilityExpression=null;return c}b.__extends(d,a);b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,"description",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);b.__decorate([k.property({type:String,
json:{write:!0}})],d.prototype,"visibilityExpression",void 0);return d=b.__decorate([h.subclass("esri.form.elements.ElementMixin")],d)}(a)};m=function(a){function d(b){b=a.call(this,b)||this;b.type=null;return b}b.__extends(d,a);b.__decorate([k.property()],d.prototype,"type",void 0);return d=b.__decorate([h.subclass("esri.form.elements.Element")],d)}(a.ElementMixin(l.JSONSupport));a.Element=m})},"esri/form/support/elements":function(){define("require exports ../../core/accessorSupport/ensureType ../elements/AttachmentElement ../elements/Element ../elements/FieldElement ../elements/RelationshipElement".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.ensureType=a.toJSON=a.fromJSON=a.buildTypeMaps=void 0;a.buildTypeMaps=function(a){return{typesWithGroup:{base:k.Element,key:"type",typeMap:{attachment:l,field:h,group:a,relationship:g}},typesWithoutGroup:{base:k.Element,key:"type",typeMap:{attachment:l,field:h,relationship:g}}}};a.fromJSON=function(a,b,c){void 0===c&&(c=!0);if(!a)return null;var e=c?b.typesWithGroup.typeMap:b.typesWithoutGroup.typeMap;return a.filter(function(a){return e[a.type]}).map(function(a){return e[a.type].fromJSON(a)})};
a.toJSON=function(a,b,c){void 0===c&&(c=!0);if(!a)return null;var e=c?b.typesWithGroup.typeMap:b.typesWithoutGroup.typeMap;return a.filter(function(a){return e[a.type]}).map(function(a){return a.toJSON()})};a.ensureType=function(a,f,c){void 0===c&&(c=!0);return a?a.map(function(a){return b.ensureOneOfType(c?f.typesWithGroup:f.typesWithoutGroup,a)}):null}})},"esri/form/elements/AttachmentElement":function(){define("require exports tslib ../../core/accessorSupport/decorators ./Element ./inputs/AttachmentInput".split(" "),
function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.attachmentKeyword=null;c.editable=!0;c.input=null;c.type="attachment";return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})};var f;b.__decorate([l.property({type:String,json:{write:!0}})],d.prototype,"attachmentKeyword",void 0);
b.__decorate([l.property({type:Boolean,json:{default:!0,write:!0}})],d.prototype,"editable",void 0);b.__decorate([l.property({type:h,json:{read:{source:"inputType"},write:{target:"inputType"}}})],d.prototype,"input",void 0);b.__decorate([l.property({type:["attachment"],json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=f=b.__decorate([l.subclass("esri.form.elements.AttachmentElement")],d)}(k.Element)})},"esri/form/elements/inputs/AttachmentInput":function(){define(["require","exports",
"tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({type:this.type})};var d;b.__decorate([k.property({type:"attachment audio document image signature video".split(" "),json:{write:!0}})],g.prototype,"type",void 0);return g=d=b.__decorate([k.subclass("esri.form.elements.inputs.AttachmentInput")],g)}(l.JSONSupport)})},
"esri/form/elements/FieldElement":function(){define("require exports tslib ../../core/accessorSupport/decorators ./Element ./support/inputs ../../layers/support/domains".split(" "),function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.domain=null;c.editable=!0;c.fieldName=null;c.hint=null;c.input=null;c.requiredExpression=null;c.type="field";return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({description:this.description,domain:this.domain,editable:this.editable,
fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,visibilityExpression:this.visibilityExpression})};var c;b.__decorate([l.property({types:g.types,json:{read:{reader:g.fromJSON},write:!0}})],d.prototype,"domain",void 0);b.__decorate([l.property({type:Boolean,json:{default:!0,write:!0}})],d.prototype,"editable",void 0);b.__decorate([l.property({type:String,json:{write:!0}})],d.prototype,"fieldName",void 0);b.__decorate([l.property({type:String,
json:{write:!0}})],d.prototype,"hint",void 0);b.__decorate([l.property({types:h.types,json:{read:{source:"inputType"},write:{target:"inputType"}}})],d.prototype,"input",void 0);b.__decorate([l.property({type:String,json:{write:!0}})],d.prototype,"requiredExpression",void 0);b.__decorate([l.property({type:String,json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=c=b.__decorate([l.subclass("esri.form.elements.FieldElement")],d)}(k.Element)})},"esri/form/elements/support/inputs":function(){define("require exports ../inputs/BarcodeScannerInput ../inputs/ComboBoxInput ../inputs/DateTimePickerInput ../inputs/Input ../inputs/RadioButtonsInput ../inputs/TextAreaInput ../inputs/TextBoxInput".split(" "),
function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.types=void 0;a.types={base:h,key:"type",typeMap:{"barcode-scanner":b,"combo-box":l,"datetime-picker":k,"radio-buttons":g,"text-area":d,"text-box":f}}})},"esri/form/elements/inputs/BarcodeScannerInput":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./Input"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="barcode-scanner";return b}b.__extends(g,
a);d=g;g.prototype.clone=function(){return new d};var d;b.__decorate([l.property({type:["barcode-scanner"],json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.form.elements.inputs.BarcodeScannerInput")],g)}(k)})},"esri/form/elements/inputs/Input":function(){define(["require","exports","tslib","../../../core/JSONSupport","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type=null;return b}
b.__extends(g,a);b.__decorate([k.property()],g.prototype,"type",void 0);return g=b.__decorate([k.subclass("esri.form.elements.inputs.Input")],g)}(l.JSONSupport)})},"esri/form/elements/inputs/ComboBoxInput":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./Input"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="combo-box";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d};var d;b.__decorate([l.property({type:["combo-box"],
json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.form.elements.inputs.ComboBoxInput")],g)}(k)})},"esri/form/elements/inputs/DateTimePickerInput":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./Input"],function(m,a,b,l,k){function h(a){return null!=a?new Date(a):null}return function(a){function d(c){c=a.call(this,c)||this;c.includeTime=!1;c.max=null;c.min=null;c.type="datetime-picker";return c}b.__extends(d,
a);f=d;d.prototype.readMax=function(a,b){return h(b.max)};d.prototype.writeMax=function(a,b){b.max=a?a.getTime():null};d.prototype.readMin=function(a,b){return h(b.min)};d.prototype.writeMin=function(a,b){b.min=a?a.getTime():null};d.prototype.clone=function(){return new f({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})};var f;b.__decorate([l.property({type:Boolean,json:{write:!0,default:!1}})],d.prototype,"includeTime",void 0);b.__decorate([l.property({type:Date,json:{type:Number,
write:!0}})],d.prototype,"max",void 0);b.__decorate([l.reader("max")],d.prototype,"readMax",null);b.__decorate([l.writer("max")],d.prototype,"writeMax",null);b.__decorate([l.property({type:Date,json:{type:Number,write:!0}})],d.prototype,"min",void 0);b.__decorate([l.reader("min")],d.prototype,"readMin",null);b.__decorate([l.writer("min")],d.prototype,"writeMin",null);b.__decorate([l.property({type:["datetime-picker"],json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=f=b.__decorate([l.subclass("esri.form.elements.inputs.DateTimePickerInput")],
d)}(k)})},"esri/form/elements/inputs/RadioButtonsInput":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./Input"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="radio-buttons";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d};var d;b.__decorate([l.property({type:["radio-buttons"],json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.form.elements.inputs.RadioButtonsInput")],
g)}(k)})},"esri/form/elements/inputs/TextAreaInput":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./TextInput"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="text-area";return b}b.__extends(g,a);b.__decorate([l.property({type:["text-area"],json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=b.__decorate([l.subclass("esri.form.elements.inputs.TextAreaInput")],g)}(k)})},"esri/form/elements/inputs/TextInput":function(){define(["require",
"exports","tslib","../../../core/accessorSupport/decorators","./Input"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.maxLength=null;b.minLength=0;b.type=null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({maxLength:this.maxLength,minLength:this.minLength,type:this.type})};var d;b.__decorate([l.property({type:Number,json:{write:!0}})],g.prototype,"maxLength",void 0);b.__decorate([l.property({type:Number,json:{default:0,write:!0}})],g.prototype,
"minLength",void 0);b.__decorate([l.property()],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.form.elements.inputs.support.TextInput")],g)}(k)})},"esri/form/elements/inputs/TextBoxInput":function(){define(["require","exports","tslib","../../../core/accessorSupport/decorators","./TextInput"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="text-box";return b}b.__extends(g,a);b.__decorate([l.property({type:["text-box"],json:{read:!1,write:!0}})],
g.prototype,"type",void 0);return g=b.__decorate([l.subclass("esri.form.elements.inputs.TextBoxInput")],g)}(k)})},"esri/form/elements/RelationshipElement":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./Element ../../popup/support/RelatedRecordsInfoFieldOrder".split(" "),function(m,a,b,l,k,h,g){return function(a){function d(c){c=a.call(this,c)||this;c.displayCount=null;c.displayType="list";c.editable=!0;c.orderByFields=null;c.relationshipId=null;c.type=
"relationship";return c}b.__extends(d,a);c=d;d.prototype.clone=function(){return new c({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:l.clone(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})};var c;b.__decorate([k.property({type:Number,json:{write:!0}})],d.prototype,"displayCount",void 0);b.__decorate([k.property({type:["list"],json:{write:!0}})],
d.prototype,"displayType",void 0);b.__decorate([k.property({type:Boolean,json:{default:!0,write:!0}})],d.prototype,"editable",void 0);b.__decorate([k.property({type:[g],json:{write:!0}})],d.prototype,"orderByFields",void 0);b.__decorate([k.property({type:Number,json:{write:!0}})],d.prototype,"relationshipId",void 0);b.__decorate([k.property({type:["relationship"],json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=c=b.__decorate([k.subclass("esri.form.elements.RelationshipElement")],d)}(h.Element)})},
"esri/geometry/HeightModelInfo":function(){define("require exports tslib ../core/arrayUtils ../core/jsonMap ../core/JSONSupport ../core/unitUtils ../core/Warning ../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h,g,d,f){function c(a,c){return new d("height-unit:unsupported","Height unit of value '"+a+"' is not supported",c)}function e(a,c){return new d("height-model:unsupported","Height model of value '"+a+"' is not supported",c)}var n=k.strict()({orthometric:"gravity-related-height",
gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),t=n.jsonValues.slice();l.removeUnordered(t,"orthometric");var x=k.strict()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet",
"sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});return function(a){function d(c){c=a.call(this,c)||this;c.heightModel="gravity-related-height";c.heightUnit="meters";c.vertCRS=null;return c}b.__extends(d,a);h=d;d.prototype.writeHeightModel=function(a,c,b){return n.write(a,c,b)};d.prototype.readHeightModel=function(a,c,b){if(c=n.read(a))return c;b&&b.messages&&b.messages.push(e(a,{context:b}));return null};d.prototype.readHeightUnit=
function(a,b,e){if(b=x.read(a))return b;e&&e.messages&&e.messages.push(c(a,{context:e}));return null};d.prototype.readHeightUnitService=function(a,b,e){if(b=g.unitFromRESTJSON(a)||x.read(a))return b;e&&e.messages&&e.messages.push(c(a,{context:e}));return null};d.prototype.readVertCRS=function(a,c){return c.vertCRS||c.ellipsoid||c.geoid};d.prototype.clone=function(){return new h({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})};d.prototype.equals=function(a){return a?
this===a?!0:this.heightModel===a.heightModel&&this.heightUnit===a.heightUnit&&this.vertCRS===a.vertCRS:!1};d.deriveUnitFromSR=function(a,c){c=g.getVerticalUnitStringForSR(c);return new h({heightModel:a.heightModel,heightUnit:c,vertCRS:a.vertCRS})};d.prototype.write=function(c,e){e=b.__assign({origin:"web-scene"},e);return a.prototype.write.call(this,c,e)};d.fromJSON=function(a){if(!a)return null;var c=new h;c.read(a,{origin:"web-scene"});return c};var h;b.__decorate([f.property({type:n.apiValues,
constructOnly:!0,json:{origins:{"web-scene":{type:t,default:"ellipsoidal"}}}})],d.prototype,"heightModel",void 0);b.__decorate([f.writer("web-scene","heightModel")],d.prototype,"writeHeightModel",null);b.__decorate([f.reader(["web-scene","service"],"heightModel")],d.prototype,"readHeightModel",null);b.__decorate([f.property({type:x.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:x.jsonValues,write:x.write}}}})],d.prototype,"heightUnit",void 0);b.__decorate([f.reader("web-scene","heightUnit")],
d.prototype,"readHeightUnit",null);b.__decorate([f.reader("service","heightUnit")],d.prototype,"readHeightUnitService",null);b.__decorate([f.property({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],d.prototype,"vertCRS",void 0);b.__decorate([f.reader("service","vertCRS",["vertCRS","ellipsoid","geoid"])],d.prototype,"readVertCRS",null);return d=h=b.__decorate([f.subclass("esri.geometry.HeightModelInfo")],d)}(h.JSONSupport)})},"esri/layers/Layer":function(){define("require exports tslib ../config ../geometry ../request ../core/Error ../core/Evented ../core/Identifiable ../core/Loadable ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){var x=0,p=e.getLogger("esri.layers.Layer");return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.attributionDataUrl=null;c.fullExtent=new k.Extent(-180,-90,180,90,k.SpatialReference.WGS84);c.id=Date.now().toString(16)+"-layer-"+x++;c.legendEnabled=!0;c.listMode="show";c.opacity=1;c.parent=null;c.popupEnabled=!0;c.attributionVisible=!0;c.spatialReference=k.SpatialReference.WGS84;c.title=null;c.type=null;c.url=null;c.visible=!0;return c}
b.__extends(c,a);c.fromArcGISServerUrl=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,d;return b.__generator(this,function(b){switch(b.label){case 0:return c="string"===typeof a?{url:a}:a,[4,new Promise(function(a,c){m(["./support/arcgisLayers"],a,c)})];case 1:e=b.sent(),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,e.fromUrl(c)];case 3:return[2,b.sent()];case 4:throw d=b.sent(),p.error("#fromArcGISServerUrl({ url: '"+c.url+"'})","Failed to create layer from arcgis server url",
d),d;case 5:return[2]}})})};c.fromPortalItem=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,d,f,g,n;return b.__generator(this,function(b){switch(b.label){case 0:return c="portalItem"in a?a:{portalItem:a},[4,new Promise(function(a,c){m(["../portal/support/portalLayers"],a,c)})];case 1:e=b.sent(),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,e.fromItem(c)];case 3:return[2,b.sent()];case 4:throw d=b.sent(),g=(f=c&&c.portalItem)&&f.id||"unset",n=f&&f.portal&&f.portal.url||l.portalUrl,
p.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+n+"', id: '"+g+"')",d),d;case 5:return[2]}})})};c.prototype.initialize=function(){var a=this;this.when().catch(function(c){var b,d;e.getLogger(a.declaredClass).error("#load()","Failed to load layer (title: '"+(null!==(b=a.title)&&void 0!==b?b:"no title")+"', id: '"+(null!==(d=a.id)&&void 0!==d?d:"no id")+"')",{error:c})})};c.prototype.destroy=function(){if(this.parent){var a=this.parent;"layers"in a&&a.layers.includes(this)?
a.layers.remove(this):"tables"in a&&a.tables.includes(this)?a.tables.remove(this):"baseLayers"in a&&a.baseLayers.includes(this)?a.baseLayers.remove(this):"baseLayers"in a&&a.referenceLayers.includes(this)&&a.referenceLayers.remove(this)}};Object.defineProperty(c.prototype,"hasAttributionData",{get:function(){return null!=this.attributionDataUrl},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"parsedUrl",{get:function(){var a=this._get("url");return a?n.urlToObject(a):null},enumerable:!1,
configurable:!0});c.prototype.fetchAttributionData=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return a=this.attributionDataUrl,this.hasAttributionData&&a?[4,h(a,{query:{f:"json"},responseType:"json"})]:[3,2];case 1:return c=b.sent(),[2,c.data];case 2:throw new g("layer:no-attribution-data","Layer does not have attribution data");}})})};b.__decorate([t.property({type:String})],c.prototype,"attributionDataUrl",void 0);
b.__decorate([t.property({type:k.Extent})],c.prototype,"fullExtent",void 0);b.__decorate([t.property({readOnly:!0,dependsOn:["attributionDataUrl"]})],c.prototype,"hasAttributionData",null);b.__decorate([t.property({type:String})],c.prototype,"id",void 0);b.__decorate([t.property({type:Boolean,nonNullable:!0})],c.prototype,"legendEnabled",void 0);b.__decorate([t.property({type:["show","hide","hide-children"]})],c.prototype,"listMode",void 0);b.__decorate([t.property({type:Number,range:{min:0,max:1},
nonNullable:!0})],c.prototype,"opacity",void 0);b.__decorate([t.property()],c.prototype,"parent",void 0);b.__decorate([t.property({readOnly:!0,dependsOn:["url"]})],c.prototype,"parsedUrl",null);b.__decorate([t.property({type:Boolean})],c.prototype,"popupEnabled",void 0);b.__decorate([t.property({type:Boolean})],c.prototype,"attributionVisible",void 0);b.__decorate([t.property({type:k.SpatialReference})],c.prototype,"spatialReference",void 0);b.__decorate([t.property({type:String})],c.prototype,"title",
void 0);b.__decorate([t.property({type:String,readOnly:!0,json:{read:!1}})],c.prototype,"type",void 0);b.__decorate([t.property()],c.prototype,"url",void 0);b.__decorate([t.property({type:Boolean,nonNullable:!0})],c.prototype,"visible",void 0);return c=b.__decorate([t.subclass("esri.layers.Layer")],c)}(d.EventedMixin(f.IdentifiableMixin(c)))})},"esri/layers/graphics/sources/MemorySource":function(){define("require exports tslib ../../../geometry ../../../Graphic ../../../core/Collection ../../../core/Error ../../../core/has ../../../core/Loadable ../../../core/Logger ../../../core/maybe ../../../core/Promise ../../../core/promiseUtils ../../../core/workers ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../../../tasks/operations/queryZScale ../../../tasks/operations/zscale ../../../tasks/support/FeatureSet".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w){Object.defineProperty(a,"__esModule",{value:!0});a.MemorySource=void 0;var B=0,z=c.getLogger("esri.layers.graphics.sources.MemorySource");m=function(a){function c(c){c=a.call(this,c)||this;c._idToClientGraphic=null;c.type="memory";return c}b.__extends(c,a);c.prototype.load=function(a){a=e.isSome(a)?a.signal:null;this.addResolvingPromise(this._startWorker(a));return t.resolve(this)};c.prototype.destroy=function(){var a;null===(a=this._connection)||void 0===
a?void 0:a.close();this._connection=null};Object.defineProperty(c.prototype,"workerGeometryType",{get:function(){var a=this.layer&&this.layer.geometryType;return a?this._geometryTypeRequiresClientGraphicMapping(a)?"polygon":a:null},enumerable:!1,configurable:!0});c.prototype.applyEdits=function(a){var c=this;return this.load().then(function(){return c._applyEdits(a)})};c.prototype.openPorts=function(){var a=this;return this.load().then(function(){return a._connection.openPorts()})};c.prototype.queryFeatures=
function(a,c){void 0===c&&(c={});return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g,n,h,k,l;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.load(c)];case 1:return b.sent(),[4,this._connection.invoke("queryFeatures",a?a.toJSON():null,c)];case 2:e=b.sent();u.applyFeatureSetZUnitScaling(a,this.layer.spatialReference,e);d=w.fromJSON(e);if(!this._requiresClientGraphicMapping())return[2,d];f=this.layer.objectIdField;g=0;for(n=d.features;g<n.length;g++)if(h=n[g],k=h.attributes[f],
l=this._idToClientGraphic.get(k))h.geometry=l.geometry;d.geometryType=this.layer.geometryType;return[2,d]}})})};c.prototype.queryFeaturesJSON=function(a,c){void 0===c&&(c={});return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return this._requiresClientGraphicMapping()?[2,t.reject(new g("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)"))]:[4,this.load(c)];case 1:return b.sent(),
[4,this._connection.invoke("queryFeatures",a?a.toJSON():null,c)];case 2:return e=b.sent(),u.applyFeatureSetZUnitScaling(a,this.layer.spatialReference,e),[2,e]}})})};c.prototype.queryFeatureCount=function(a,c){var b=this;void 0===c&&(c={});return this.load(c).then(function(){return b._connection.invoke("queryFeatureCount",a?a.toJSON():null,c)})};c.prototype.queryObjectIds=function(a,c){var b=this;void 0===c&&(c={});return this.load(c).then(function(){return b._connection.invoke("queryObjectIds",a?
a.toJSON():null,c)})};c.prototype.queryExtent=function(a,c){var b=this;void 0===c&&(c={});return this.load(c).then(function(){return b._connection.invoke("queryExtent",a?a.toJSON():null,c)}).then(function(a){return{count:a.count,extent:l.Extent.fromJSON(a.extent)}})};c.prototype._applyEdits=function(a){var c=this;if(!this._connection)throw new g("feature-layer-source:edit-failure","Memory source not loaded");var b=this.layer.objectIdField,e=null,d=[],f=[],n=function(a){return"objectId"in a&&null!=
a.objectId?a.objectId:"attributes"in a&&null!=a.attributes[b]?a.attributes[b]:null};a.addFeatures&&(e=this._prepareAddFeatures(a.addFeatures));if(a.deleteFeatures)for(var h=0,k=a.deleteFeatures;h<k.length;h++){var l=k[h],p=n(l);null!=p&&d.push(p)}var q=a.updateFeatures&&this._idToClientGraphic?new Map:null;if(a.updateFeatures)for(h=0,a=a.updateFeatures;h<a.length;h++)l=a[h],f.push(this._serializeFeature(l)),q&&(p=n(l),null!=p&&q.set(p,l));y.unapplyEditsZUnitScaling(e?e.features:null,f,this.layer.spatialReference);
return this._connection.invoke("applyEdits",{adds:e?e.features:[],updates:f,deletes:d}).then(function(a){var b=a.featureEditResults;c.fullExtent=a.fullExtent;e&&e.finish(b.uidToObjectId);if(c._idToClientGraphic){if(q){a=0;for(var d=b.updateResults;a<d.length;a++){var f=d[a];f.success&&(f=q.get(f.objectId),null!=f&&c._addIdToClientGraphic(f))}}a=0;for(d=b.deleteResults;a<d.length;a++)f=d[a],f.success&&c._idToClientGraphic.delete(f.objectId)}return c._createEditsResult(b)})};c.prototype._createEditsResult=
function(a){return{addFeatureResults:a.addResults?a.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:a.updateResults?a.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:a.deleteResults?a.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}};c.prototype._createFeatureEditResult=function(a){var c=!0===a.success?null:a.error||{code:void 0,description:void 0};return{objectId:a.objectId,
globalId:a.globalId,error:c?new g("feature-layer-source:edit-failure",c.description,{code:c.code}):null}};c.prototype._prepareAddFeatures=function(a){for(var c=new Map,b=Array(a.length),d=null,f=0;f<a.length;f++){var g=a[f],n=this._serializeFeature(g);!d&&e.isSome(g.geometry)&&(d=g.geometry.type);b[f]=n;c.set(""+n.uid,g)}var h=this;return{features:b,inferredGeometryType:d,finish:function(a){var b=h.sourceJSON.objectIdField,e;for(e in a){var d=a[e],f=c.get(e);f&&(f.attributes||(f.attributes={}),-1===
d?delete f.attributes[b]:f.attributes[b]=d,h._addIdToClientGraphic(f))}}}};c.prototype._addIdToClientGraphic=function(a){if(this._idToClientGraphic){var c=this.sourceJSON.objectIdField,c=a.attributes&&a.attributes[c];null!=c&&this._idToClientGraphic.set(c,a)}};c.prototype._requiresClientGraphicMapping=function(){return this._geometryTypeRequiresClientGraphicMapping(this.layer.geometryType||this.sourceJSON.geometryType)};c.prototype._geometryRequiresClientGraphicMapping=function(a){return this._geometryTypeRequiresClientGraphicMapping(a.type)};
c.prototype._geometryTypeRequiresClientGraphicMapping=function(a){return"mesh"===a||"multipatch"===a||"extent"===a};c.prototype._serializeFeature=function(a){var c=a.attributes;a=this._geometryForSerialization(a);var b=(B++).toString();return a?{uid:b,geometry:a.toJSON(),attributes:c}:{uid:b,attributes:c}};c.prototype._geometryForSerialization=function(a){a=a.geometry;return e.isNone(a)?null:this._geometryRequiresClientGraphicMapping(a)?a.extent?l.Polygon.fromExtent(a.extent):null:a};c.prototype._startWorker=
function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,f,g,n,h,k,p,q,t,u,w,y,m,B,C;return b.__generator(this,function(b){switch(b.label){case 0:return c=this,[4,x.open("MemorySourceWorker",{strategy:d("feature-layers-workers")?"dedicated":"local",signal:a})];case 1:return c._connection=b.sent(),e=this.layer,f=e.fields,g=e.spatialReference,n=e.objectIdField,h=e.hasM,k=e.hasZ,p=e.timeInfo,q="defaults"===this.layer.originOf("spatialReference"),t=this._prepareAddFeatures(this.items),this.on("before-changes",
function(a){z.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead");a.preventDefault()}),u={features:t.features,fields:f&&f.map(function(a){return a.toJSON()}),geometryType:l.typeKebabDictionary.toJSON(this.workerGeometryType),hasM:h,hasZ:k,objectIdField:n,spatialReference:q?null:g&&g.toJSON(),timeInfo:p?p.toJSON():null},[4,this._connection.invoke("load",u,{signal:a})];case 2:w=b.sent();y=0;for(m=w.warnings;y<m.length;y++)B=m[y],z.warn(B.message,
{layer:this.layer,warning:B});w.featureErrors.length&&z.warn("Encountered "+w.featureErrors.length+" validation errors while loading features",w.featureErrors);C=w.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(t.inferredGeometryType)&&(C.geometryType=l.typeKebabDictionary.toJSON(t.inferredGeometryType));if("mesh"===C.geometryType||"mesh"===this.layer.geometryType)C.hasZ=!0;this.sourceJSON=C;this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map);t.finish(w.assignedObjectIds);
return[2]}})})};b.__decorate([p.shared({Type:k,ensureType:q.ensureType(k)})],c.prototype,"itemType",void 0);b.__decorate([p.property()],c.prototype,"type",void 0);b.__decorate([p.property({constructOnly:!0})],c.prototype,"layer",void 0);b.__decorate([p.property({readOnly:!0,dependsOn:["layer.geometryType"]})],c.prototype,"workerGeometryType",null);b.__decorate([p.property()],c.prototype,"sourceJSON",void 0);return c=b.__decorate([p.subclass("esri.layers.graphics.sources.MemorySource")],c)}(f.LoadableMixin(n.EsriPromiseMixin(h)));
a.MemorySource=m;a.default=m})},"esri/layers/mixins/ArcGISService":function(){define("require exports tslib ../../core/Logger ../../core/accessorSupport/decorators ../support/arcgisLayerUrl".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.ArcGISService=void 0;a.ArcGISService=function(a){return function(a){function d(){return null!==a&&a.apply(this,arguments)||this}b.__extends(d,a);Object.defineProperty(d.prototype,"title",{get:function(){if(this._get("title")&&
"defaults"!==this.originOf("title"))return this._get("title");if(this.url){var a=h.parse(this.url);if(a&&a.title)return a.title}return this._get("title")||""},set:function(a){this._set("title",a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"url",{set:function(a){this._set("url",h.sanitizeUrl(a,l.getLogger(this.declaredClass)))},enumerable:!1,configurable:!0});b.__decorate([k.property({dependsOn:["url"]})],d.prototype,"title",null);b.__decorate([k.property({type:String})],d.prototype,
"url",null);return d=b.__decorate([k.subclass("esri.layers.mixins.ArcGISService")],d)}(a)}})},"esri/layers/mixins/BlendLayer":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.BlendLayer=void 0;a.BlendLayer=function(a){return function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.blendMode="normal";b.effect=null;return b}b.__extends(g,a);b.__decorate([l.property({type:"average color-burn color-dodge color darken destination-atop destination-in destination-out destination-over difference exclusion hard-light hue invert lighten lighter luminosity minus multiply normal overlay plus reflect saturation screen soft-light source-atop source-in source-out vivid-light xor".split(" "),
nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{default:"normal",read:!0,write:!0}}}})],g.prototype,"blendMode",void 0);b.__decorate([l.property({type:String})],g.prototype,"effect",void 0);return g=b.__decorate([l.subclass("esri.layers.mixins.BlendLayer")],g)}(a)}})},"esri/layers/mixins/OperationalLayer":function(){define("require exports tslib ../../core/Error ../../core/accessorSupport/decorators ../../core/accessorSupport/read ../../core/accessorSupport/write ./operationalLayers ../support/commonProperties @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.OperationalLayer=void 0;a.OperationalLayer=function(a){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.title="Layer";return c}b.__extends(c,a);c.prototype.writeListMode=function(a,c,b,e){e&&"ground"===e.layerContainerType?c[b]=a:a&&g.willPropertyWrite(this,b,{},e)&&(c[b]=a)};c.prototype.writeOperationalLayerType=function(a,c,b,e){!a||e&&"tables"===e.layerContainerType||(c.layerType=a)};c.prototype.writeTitle=
function(a,c){c.title=a||"Layer"};c.prototype.read=function(c,b){var e=this;b&&(b.layer=this);h.readLoadable(this,c,function(b){return a.prototype.read.call(e,c,b)},b)};c.prototype.write=function(c,e){if(e&&e.origin){var f=e.origin+"/"+(e.layerContainerType||"operational-layers"),g=d.supportedTypes[f],g=g&&g[this.operationalLayerType];"ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===f&&(g=!1);if(!g)return e.messages&&e.messages.push(new l("layer:unsupported",
"Layers ("+this.title+", "+this.id+") of type '"+this.declaredClass+"' are not supported in the context of '"+f+"'",{layer:this})),null}c=a.prototype.write.call(this,c,b.__assign(b.__assign({},e),{layer:this}));e=!!e&&!!e.messages&&!!e.messages.filter(function(a){return a instanceof l&&"web-document-write:property-required"===a.name}).length;return!this.url&&e?null:c};c.prototype.beforeSave=function(){};b.__decorate([k.property({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,
ignoreOrigin:!0}},"portal-item":{write:!1}}}})],c.prototype,"id",void 0);b.__decorate([k.property({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],c.prototype,"listMode",void 0);b.__decorate([k.writer("listMode")],c.prototype,"writeListMode",null);b.__decorate([k.property({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],c.prototype,"operationalLayerType",void 0);b.__decorate([k.writer("operationalLayerType")],
c.prototype,"writeOperationalLayerType",null);b.__decorate([k.property(f.opacity)],c.prototype,"opacity",void 0);b.__decorate([k.property({type:String,json:{write:{ignoreOrigin:!0,allowNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,allowNull:!0}},"portal-item":{write:!1}}}})],c.prototype,"title",void 0);b.__decorate([k.writer("title")],c.prototype,"writeTitle",null);b.__decorate([k.property({type:Boolean,json:{name:"visibility",origins:{"web-document":{name:"visibility",default:!0},
"portal-item":{name:"visibility",read:{source:["visible","visibility"]}}}}})],c.prototype,"visible",void 0);return c=b.__decorate([k.subclass("esri.layers.mixins.OperationalLayer")],c)}(a)}})},"esri/layers/mixins/operationalLayers":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.supportedTypes=void 0;a.supportedTypes={"web-scene/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,
ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,VectorTileLayer:!0,WMS:!0,KML:!0,RasterDataLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,
RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGISFeatureLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0,CSV:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,VectorTileLayer:!0,WFS:!0,SubtypeGroupLayer:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,
ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0}}})},"esri/layers/support/commonProperties":function(){define("require exports tslib ../../TimeExtent ../../core/accessorSupport/utils ../../core/accessorSupport/write ../../support/persistableUrlUtils ../../symbols/support/ElevationInfo ../../webdoc/support/opacityUtils".split(" "),
function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.combinedViewLayerTimeExtentProperty=a.opacityDrawingInfo=a.opacity=a.readOnlyService=a.elevationInfo=a.legendEnabled=a.url=a.labelsVisible=a.popupEnabled=a.screenSizePerspectiveEnabled=void 0;a.screenSizePerspectiveEnabled={type:Boolean,value:!0,json:{origins:{"web-scene":{read:{source:["id","url","layerType"],reader:function(a,b){if(null==b.screenSizePerspective&&"defaults"===this.originOf("screenSizePerspectiveEnabled"))k.getProperties(this).store.set("screenSizePerspectiveEnabled",
!1,0);else return b.screenSizePerspective}},write:{ignoreOrigin:!0,target:"screenSizePerspective",writer:function(a,b,d,f){"defaults"===this.originOf("screenSizePerspectiveEnabled")&&a?b[d]=a:h.willPropertyWrite(this,"screenSizePerspectiveEnabled",{},f)&&(b[d]=a)}}}}}};a.popupEnabled={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:function(a,b){return!b.disablePopup}},write:{enabled:!0,writer:function(a,b,d){b[d]=!a}}}};a.labelsVisible={type:Boolean,value:!0,json:{name:"showLabels",
write:!0}};a.url={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:g.write}}};a.legendEnabled={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}};a.elevationInfo={value:null,type:d,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};a.readOnlyService=function(a){return{type:a,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}};a.opacity={type:Number,
json:{origins:{"web-document":{default:1,write:!0,read:!0},"portal-item":{write:!0}}}};a.opacityDrawingInfo=b.__assign(b.__assign({},a.opacity),{json:b.__assign(b.__assign({},a.opacity.json),{origins:{"web-document":b.__assign(b.__assign({},a.opacity.json.origins["web-document"]),{write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}})},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:function(a,b,d){if((!d||
"service"===d.origin)&&b.drawingInfo&&void 0!==b.drawingInfo.transparency)return f.transparencyToOpacity(b.drawingInfo.transparency);if(b.layerDefinition&&b.layerDefinition.drawingInfo&&void 0!==b.layerDefinition.drawingInfo.transparency)return f.transparencyToOpacity(b.layerDefinition.drawingInfo.transparency)}}})});a.combinedViewLayerTimeExtentProperty={type:l,dependsOn:"view.timeExtent layer.timeExtent layer.timeInfo layer.timeOffset layer.timeOffset.value layer.timeOffset.unit layer.useViewTime".split(" "),
readOnly:!0,get:function(){var a,b;if(null===(a=this.layer)||void 0===a||!a.timeInfo)return null;a=null===(b=this.view)||void 0===b?void 0:b.timeExtent;b=this.layer.timeExtent;b=this.layer.useViewTime?a&&b?a.intersection(b):a||b:b;if(!b||b.isEmpty)return b;b=(a=this.layer.timeOffset)?b.offset(-a.value,a.unit):b;a=this._get("timeExtent");return b.equals(a)?a:b}}})},"esri/symbols/support/ElevationInfo":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators ./FeatureExpressionInfo ./unitConversionUtils".split(" "),
function(m,a,b,l,k,h,g,d,f){var c=l.strict()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),e=new l.JSONMap({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});return function(a){function n(){var c=null!==a&&a.apply(this,arguments)||this;c.offset=null;return c}b.__extends(n,a);k=n;n.prototype.readFeatureExpressionInfo=function(a,c){if(null!=a)return a;if(c.featureExpression&&
0===c.featureExpression.value)return{expression:"0"}};n.prototype.writeFeatureExpressionInfo=function(a,c,b,e){c[b]=a.write(null,e);"0"===a.expression&&(c.featureExpression={value:0})};Object.defineProperty(n.prototype,"mode",{get:function(){return this._isOverridden("mode")?this._get("mode"):h.isSome(this.offset)||this.featureExpressionInfo?"relative-to-ground":"on-the-ground"},set:function(a){this._override("mode",a)},enumerable:!1,configurable:!0});Object.defineProperty(n.prototype,"unit",{set:function(a){this._set("unit",
a)},enumerable:!1,configurable:!0});n.prototype.write=function(c,b){return this.offset||this.mode||this.featureExpressionInfo||this.unit?a.prototype.write.call(this,c,b):null};n.prototype.clone=function(){return new k({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})};var k;b.__decorate([g.property({type:d,json:{write:!0}})],n.prototype,"featureExpressionInfo",void 0);b.__decorate([g.reader("featureExpressionInfo",
["featureExpressionInfo","featureExpression"])],n.prototype,"readFeatureExpressionInfo",null);b.__decorate([g.writer("featureExpressionInfo",{featureExpressionInfo:{type:d},"featureExpression.value":{type:[0]}})],n.prototype,"writeFeatureExpressionInfo",null);b.__decorate([g.property({type:c.apiValues,dependsOn:["offset","featureExpressionInfo"],nonNullable:!0,json:{type:c.jsonValues,read:c.read,write:{writer:c.write,isRequired:!0}}})],n.prototype,"mode",null);b.__decorate([g.property({type:Number,
json:{write:!0}})],n.prototype,"offset",void 0);b.__decorate([g.property({type:f.supportedUnits,json:{type:String,read:e.read,write:e.write}})],n.prototype,"unit",null);return n=k=b.__decorate([g.subclass("esri.layers.support.ElevationInfo")],n)}(k.JSONSupport)})},"esri/symbols/support/FeatureExpressionInfo":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ../../layers/support/fieldUtils".split(" "),function(m,a,b,l,k,h){return function(a){function d(){return null!==
a&&a.apply(this,arguments)||this}b.__extends(d,a);f=d;d.prototype.collectRequiredFields=function(a,e){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(c){return[2,h.collectArcadeFieldNames(a,e,this.expression)]})})};d.prototype.clone=function(){return new f({expression:this.expression,title:this.title})};var f;b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,"expression",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,
"title",void 0);return d=f=b.__decorate([k.subclass("esri.layers.support.FeatureExpressionInfo")],d)}(l.JSONSupport)})},"esri/symbols/support/unitConversionUtils":function(){define(["require","exports","../../renderers/support/utils"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.supportedUnits=a.getMetersPerUnit=a.supportsUnit=void 0;a.supportsUnit=function(a){return null!=b.meterIn[a]};a.getMetersPerUnit=function(a){return 1/(b.meterIn[a]||1)};a.supportedUnits=function(){var a=
Object.keys(b.meterIn);a.sort();return a}()})},"esri/layers/mixins/PortalLayer":function(){define("require exports tslib ../../core/Error ../../core/Logger ../../core/promiseUtils ../../core/urlUtils ../../core/accessorSupport/decorators ../../portal/Portal ../../portal/PortalItem @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h,g,d,f,c){Object.defineProperty(a,"__esModule",{value:!0});a.PortalLayer=void 0;var e=k.getLogger("esri.layers.mixins.PortalLayer");a.PortalLayer=function(a){return function(a){function n(){var c=
null!==a&&a.apply(this,arguments)||this;c.resourceReferences={portalItem:null,paths:[]};return c}b.__extends(n,a);n.prototype.destroy=function(){var a;null===(a=this.portalItem)||void 0===a?void 0:a.destroy();this.portalItem=null};Object.defineProperty(n.prototype,"portalItem",{set:function(a){a!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",a))},enumerable:!1,configurable:!0});n.prototype.readPortalItem=function(a,b,e){if(b.itemId)return new c({id:b.itemId,portal:e&&
e.portal})};n.prototype.writePortalItem=function(a,c){a&&a.id&&(c.itemId=a.id)};n.prototype.loadFromPortal=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var d,f;return b.__generator(this,function(b){switch(b.label){case 0:if(!this.portalItem||!this.portalItem.id)return[2];b.label=1;case 1:return b.trys.push([1,4,,5]),[4,new Promise(function(a,c){m(["../../portal/support/layersLoader"],a,c)})];case 2:return d=b.sent(),h.throwIfAborted(c),[4,d.load({instance:this,supportedTypes:a.supportedTypes,
validateItem:a.validateItem,supportsData:a.supportsData},c)];case 3:return[2,b.sent()];case 4:throw f=b.sent(),e.warn("Failed to load layer ("+this.title+", "+this.id+") portal item ("+this.portalItem.id+")\n  "+f),f;case 5:return[2]}})})};n.prototype.read=function(c,b){b&&(b.layer=this);a.prototype.read.call(this,c,b)};n.prototype.write=function(c,e){var d=e&&e.portal,n=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||f.getDefault());return d&&n&&!g.hasSamePortal(n.restUrl,d.restUrl)?
(e.messages&&e.messages.push(new l("layer:cross-portal","The layer '"+this.title+" ("+this.id+")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer",{layer:this})),null):a.prototype.write.call(this,c,b.__assign(b.__assign({},e),{layer:this}))};b.__decorate([d.property({type:c})],n.prototype,"portalItem",null);b.__decorate([d.reader("web-document",
"portalItem",["itemId"])],n.prototype,"readPortalItem",null);b.__decorate([d.writer("web-document","portalItem",{itemId:{type:String}})],n.prototype,"writePortalItem",null);b.__decorate([d.property()],n.prototype,"resourceReferences",void 0);return n=b.__decorate([d.subclass("esri.layers.mixins.PortalLayer")],n)}(a)}})},"esri/portal/PortalItem":function(){define("require exports tslib ../assets ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/maybe ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u){return function(a){function d(c){c=a.call(this,c)||this;c.access=null;c.accessInformation=null;c.applicationProxies=null;c.avgRating=null;c.categories=null;c.created=null;c.culture=null;c.description=null;c.extent=null;c.groupCategories=null;c.id=null;c.itemControl=null;c.licenseInfo=null;c.modified=null;c.name=null;c.numComments=null;c.numRatings=null;c.numViews=null;c.owner=null;c.ownerFolder=null;c.portal=null;c.screenshots=null;c.size=null;c.snippet=
null;c.sourceJSON=null;c.tags=null;c.title=null;c.type=null;c.typeKeywords=null;c.url=null;return c}b.__extends(d,a);h=d;d.from=function(a){return t.ensureClass(h,a)};d.prototype.destroy=function(){this.portal=null};Object.defineProperty(d.prototype,"displayName",{get:function(){var a=this.type,c=this.typeKeywords||[],b=a;"Feature Service"===a||"Feature Collection"===a?b=-1<c.indexOf("Table")?"Table":-1<c.indexOf("Route Layer")?"Route Layer":-1<c.indexOf("Markup")?"Markup":"Feature Layer":"Image Service"===
a?b=-1<c.indexOf("Elevation 3D Layer")?"Elevation Layer":-1<c.indexOf("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===a?b="Scene Layer":"Scene Package"===a?b="Scene Layer Package":"Stream Service"===a?b="Feature Layer":"Geoprocessing Service"===a&&this.portal&&this.portal.isPortal?b=-1<c.indexOf("Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===a?b="Locator":"Microsoft Powerpoint"===a?b="Microsoft PowerPoint":"GeoJson"===a?b="GeoJSON":"Globe Service"===a?b=
"Globe Layer":"Vector Tile Service"===a?b="Tile Layer":"netCDF"===a?b="NetCDF":"Map Service"===a?b=-1===c.indexOf("Spatiotemporal")&&(-1<c.indexOf("Hosted Service")||-1<c.indexOf("Tiled"))&&-1===c.indexOf("Relational")?"Tile Layer":"Map Image Layer":a&&-1<a.toLowerCase().indexOf("add in")?b=a.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===a?b="Big Data File Share":"Compact Tile Package"===a&&(b="Tile Package (tpkx)");return b},enumerable:!1,configurable:!0});d.prototype.readExtent=function(a){return a&&
a.length?new x(a[0][0],a[0][1],a[1][0],a[1][1]):null};Object.defineProperty(d.prototype,"iconUrl",{get:function(){var a=this.type&&this.type.toLowerCase()||"",c=this.typeKeywords||[],b=!1,e=!1,d=!1,f=!1,g=!1;0<a.indexOf("service")||"feature collection"===a||"kml"===a||"wms"===a||"wmts"===a||"wfs"===a?(b=-1<c.indexOf("Hosted Service"),"feature service"===a||"feature collection"===a||"kml"===a||"wfs"===a?(e=-1<c.indexOf("Table"),d=-1<c.indexOf("Route Layer"),f=-1<c.indexOf("Markup"),a=(g=-1!==c.indexOf("Spatiotemporal"))&&
e?"spatiotemporaltable":e?"table":d?"routelayer":f?"markup":g?"spatiotemporal":b?"featureshosted":"features"):a="map service"===a||"wms"===a||"wmts"===a?b||-1<c.indexOf("Tiled")||"wmts"===a?"maptiles":"mapimages":"scene service"===a?-1<c.indexOf("Line")?"sceneweblayerline":-1<c.indexOf("3DObject")?"sceneweblayermultipatch":-1<c.indexOf("Point")?"sceneweblayerpoint":-1<c.indexOf("IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf("PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf("Polygon")?"sceneweblayerpolygon":
-1<c.indexOf("Building")?"sceneweblayerbuilding":"sceneweblayer":"image service"===a?-1<c.indexOf("Elevation 3D Layer")?"elevationlayer":-1<c.indexOf("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===a?"streamlayer":"vector tile service"===a?"vectortile":"datastore catalog service"===a?"datastorecollection":"geocoding service"===a?"geocodeservice":"geoprocessing service"===a?-1<c.indexOf("Web Tool")&&this.portal&&this.portal.isPortal?"tool":"layers":"layers"):a="web map"===a||"cityengine web scene"===
a?"maps":"web scene"===a?-1<c.indexOf("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===a||"mobile application"===a||"application"===a||"operation view"===a||"desktop application"===a?"apps":"map document"===a||"map package"===a||"published map"===a||"scene document"===a||"globe document"===a||"basemap package"===a||"mobile basemap package"===a||"mobile map package"===a||"project package"===a||"project template"===a||"pro map"===a||"layout"===a||"layer"===a&&-1<c.indexOf("ArcGIS Pro")||
"explorer map"===a&&c.indexOf("Explorer Document")?"mapsgray":"service definition"===a||"csv"===a||"shapefile"===a||"cad drawing"===a||"geojson"===a||"360 vr experience"===a||"netcdf"===a||"administrative report"===a?"datafiles":"explorer add in"===a||"desktop add in"===a||"windows viewer add in"===a||"windows viewer configuration"===a?"appsgray":"arcgis pro add in"===a||"arcgis pro configuration"===a?"addindesktop":"rule package"===a||"file geodatabase"===a||"sqlite geodatabase"===a||"csv collection"===
a||"kml collection"===a||"windows mobile package"===a||"map template"===a||"desktop application template"===a||"gml"===a||"arcpad package"===a||"code sample"===a||"form"===a||"document link"===a||"operations dashboard add in"===a||"rules package"===a||"image"===a||"workflow manager package"===a||"explorer map"===a&&-1<c.indexOf("Explorer Mapping Application")||-1<c.indexOf("Document")?"datafilesgray":"network analysis service"===a||"geoprocessing service"===a||"geodata service"===a||"geometry service"===
a||"geoprocessing package"===a||"locator package"===a||"geoprocessing sample"===a||"workflow manager service"===a?"toolsgray":"layer"===a||"layer package"===a||"explorer layer"===a?"layersgray":"scene package"===a?"scenepackage":"mobile scene package"===a?"mobilescenepackage":"tile package"===a||"compact tile package"===a?"tilepackage":"task file"===a?"taskfile":"report template"===a?"report-template":"statistical data collection"===a?"statisticaldatacollection":"insights workbook"===a?"workbook":
"insights model"===a?"insightsmodel":"insights page"===a?"insightspage":"insights theme"===a?"insightstheme":"hub initiative"===a?"hubinitiative":"hubpage"===a?"hubpage":"hub event"===a?"hubevent":"hub site application"===a?"hubsite":"relational database connection"===a?"relationaldatabaseconnection":"big data file share"===a?"datastorecollection":"image collection"===a?"imagecollection":"style"===a?"style":"desktop style"===a?"desktopstyle":"dashboard"===a?"dashboard":"raster function template"===
a?"rasterprocessingtemplate":"vector tile package"===a?"vectortilepackage":"ortho mapping project"===a?"orthomappingproject":"ortho mapping template"===a?"orthomappingtemplate":"solution"===a?"solutions":"geopackage"===a?"geopackage":"deep learning package"===a?"deeplearningpackage":"real time analytic"===a?"realtimeanalytics":"big data analytic"===a?"bigdataanalytics":"feed"===a?"feed":"excalibur imagery project"===a?"excaliburimageryproject":"notebook"===a?"notebook":"storymap"===a?"storymap":"survey123 add in"===
a?"survey123addin":"mission"===a?"mission":"mission report"===a?"missionreport":"quickcapture project"===a?"quickcaptureproject":"pro report"===a?"proreport":"urban model"===a?"urbanmodel":"web experience"===a?"experiencebuilder":"web experience template"===a?"webexperiencetemplate":"workflow"===a?"workflow":"insights script"===a?"insightsscript":"kernel gateway connection"===a?"kernelgatewayconnection":"hub initiative template"===a?"hubinitiativetemplate":"storymap theme"===a?"storymaptheme":"maps";
return a?l.getAssetUrl("esri/images/portal/"+a+"16.png"):null},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"isLayer",{get:function(){return-1<"Map Service;Feature Service;Feature Collection;Scene Service;Image Service;Stream Service;Vector Tile Service;WMTS;WMS".split(";").indexOf(this.type)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"itemUrl",{get:function(){var a=this.get("portal.restUrl");return a?a+"/content/items/"+this.id:null},enumerable:!1,configurable:!0});
Object.defineProperty(d.prototype,"thumbnailUrl",{get:function(){var a=this.itemUrl,c=this.thumbnail;return a&&c?this.portal._normalizeUrl(a+"/info/"+c+"?f\x3djson"):null},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"userItemUrl",{get:function(){var a=this.get("portal.restUrl");if(!a)return null;var c=this.owner||this.get("portal.user.username");return c?a+"/content/users/"+(this.ownerFolder?c+"/"+this.ownerFolder:c)+"/items/"+this.id:null},enumerable:!1,configurable:!0});d.prototype.load=
function(a){var b=this;this.portal||(this.portal=p.getDefault());var e=this.portal.load(a).then(function(){return b.sourceJSON?b.sourceJSON:b.id&&b.itemUrl?b.portal._request(b.itemUrl,{signal:f.isSome(a)?a.signal:null}):{}}).then(function(a){b.sourceJSON=a;b.read(a)});this.addResolvingPromise(e);return c.resolve(this)};d.prototype.addRating=function(a){var c={method:"post",query:{}};a instanceof u&&(a=a.rating);isNaN(a)||"number"!==typeof a||(c.query.rating=a);return this.portal._request(this.itemUrl+
"/addRating",c).then(function(){return new u({rating:a,created:new Date})})};d.prototype.clone=function(){var a={access:this.access,accessInformation:this.accessInformation,applicationProxies:g.clone(this.applicationProxies),avgRating:this.avgRating,categories:g.clone(this.categories),created:g.clone(this.created),culture:this.culture,description:this.description,extent:g.clone(this.extent),groupCategories:g.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,
modified:g.clone(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:g.clone(this.screenshots),size:this.size,snippet:this.snippet,tags:g.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:g.clone(this.typeKeywords),url:this.url};this.loaded&&(a.loadStatus="loaded");return(new h({sourceJSON:this.sourceJSON})).set(a)};d.prototype.createPostQuery=
function(){var a=this.toJSON(),c;for(c in a)"tags"===c&&null!==a[c]&&(a[c]=a[c].join(", ")),"typeKeywords"===c&&null!==a[c]&&(a[c]=a[c].join(", ")),"extent"===c&&a[c]&&(a[c]=JSON.stringify(a[c]));return a};d.prototype.deleteRating=function(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then(function(){})};d.prototype.fetchData=function(a,c){void 0===a&&(a="json");return this.portal._request(this.itemUrl+"/data",b.__assign({responseType:a},c))};d.prototype.fetchRating=
function(a){return this.portal._request(this.itemUrl+"/rating",a).then(function(a){return null!=a.rating?(a.created=new Date(a.created),new u(a)):null})};d.prototype.fetchRelatedItems=function(a,c){return this.portal._requestToTypedArray(this.itemUrl+"/relatedItems",b.__assign({query:a},c),h)};d.prototype.getThumbnailUrl=function(a){var c=this.thumbnailUrl;c&&a&&(c+="\x26w\x3d"+a);return c};d.prototype.reload=function(){var a=this;return this.portal._request(this.itemUrl,{cacheBust:!0}).then(function(c){a.sourceJSON=
c;a.read(c);return a})};d.prototype.update=function(a){var b=this;return this.id?this.load().then(function(){return b.portal._signIn()}).then(function(){var c=a&&a.data,e={method:"post"};e.query=b.createPostQuery();for(var d in e.query)null===e.query[d]&&(e.query[d]="");e.query.clearEmptyFields=!0;null!=c&&("string"===typeof c?e.query.text=c:"object"===typeof c&&(e.query.text=JSON.stringify(c)));return b.portal._request(b.userItemUrl+"/update",e).then(function(){return b.reload()})}):c.reject(new k("portal:item-does-not-exist",
"The item does not exist yet and cannot be updated"))};d.prototype.updateThumbnail=function(a){var b=this;return this.id?this.load().then(function(){return b.portal._signIn()}).then(function(){var c=a.thumbnail,d=a.filename,g={method:"post"};if("string"===typeof c)e.isDataProtocol(c)?g.query={data:c}:g.query={url:e.makeAbsolute(c)},f.isSome(d)&&(g.query.filename=d);else{var n=new FormData;f.isSome(d)?n.append("file",c,d):n.append("file",c);g.body=n}return b.portal._request(b.userItemUrl+"/updateThumbnail",
g).then(function(){return b.reload()})}):c.reject(new k("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))};d.prototype.fetchResources=function(a,c){void 0===a&&(a={});return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,c){m(["./support/resourceUtils"],a,c)})];case 1:return e=b.sent(),[2,e.fetchResources(this,a,c)]}})})};d.prototype.addResource=function(a,c,e){return b.__awaiter(this,
void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,c){m(["./support/resourceUtils"],a,c)})];case 1:return d=b.sent(),a.portalItem=this,[2,d.addOrUpdateResource(a,"add",c,e)]}})})};d.prototype.removeResource=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,c){m(["./support/resourceUtils"],a,c)})];case 1:e=b.sent();
if(a.portalItem&&a.portalItem.itemUrl!==this.itemUrl)throw new k("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return[2,e.removeResource(this,a,c)]}})})};d.prototype.removeAllResources=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,c){m(["./support/resourceUtils"],a,c)})];case 1:return c=b.sent(),[2,c.removeAllResources(this,
a)]}})})};d.prototype.resourceFromPath=function(a){return new q({portalItem:this,path:a})};d.prototype.toJSON=function(){var a=this.extent,a={created:this.created&&this.created.getTime(),description:this.description,extent:a&&[[a.xmin,a.ymin],[a.xmax,a.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,
url:this.url};return g.fixJson(a)};d.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");return new h({sourceJSON:a})};d.prototype._getPostQuery=function(){var a=this.toJSON(),c;for(c in a)"tags"===c&&null!==a[c]&&(a[c]=a[c].join(", ")),"typeKeywords"===c&&null!==a[c]&&(a[c]=a[c].join(", ")),"extent"===c&&a[c]&&(a[c]=JSON.stringify(a[c]));return a};var h;b.__decorate([n.property({type:["private","shared","org","public"]})],d.prototype,"access",
void 0);b.__decorate([n.property()],d.prototype,"accessInformation",void 0);b.__decorate([n.property({json:{read:{source:"appProxies"}}})],d.prototype,"applicationProxies",void 0);b.__decorate([n.property()],d.prototype,"avgRating",void 0);b.__decorate([n.property()],d.prototype,"categories",void 0);b.__decorate([n.property({type:Date})],d.prototype,"created",void 0);b.__decorate([n.property()],d.prototype,"culture",void 0);b.__decorate([n.property()],d.prototype,"description",void 0);b.__decorate([n.property({dependsOn:["type",
"typeKeywords"],readOnly:!0})],d.prototype,"displayName",null);b.__decorate([n.property({type:x})],d.prototype,"extent",void 0);b.__decorate([n.reader("extent")],d.prototype,"readExtent",null);b.__decorate([n.property()],d.prototype,"groupCategories",void 0);b.__decorate([n.property({dependsOn:["type","typeKeywords"],readOnly:!0})],d.prototype,"iconUrl",null);b.__decorate([n.property()],d.prototype,"id",void 0);b.__decorate([n.property({dependsOn:["type"],readOnly:!0})],d.prototype,"isLayer",null);
b.__decorate([n.property()],d.prototype,"itemControl",void 0);b.__decorate([n.property({dependsOn:["portal.restUrl","id"],readOnly:!0})],d.prototype,"itemUrl",null);b.__decorate([n.property()],d.prototype,"licenseInfo",void 0);b.__decorate([n.property({type:Date})],d.prototype,"modified",void 0);b.__decorate([n.property()],d.prototype,"name",void 0);b.__decorate([n.property()],d.prototype,"numComments",void 0);b.__decorate([n.property()],d.prototype,"numRatings",void 0);b.__decorate([n.property()],
d.prototype,"numViews",void 0);b.__decorate([n.property()],d.prototype,"owner",void 0);b.__decorate([n.property()],d.prototype,"ownerFolder",void 0);b.__decorate([n.property({type:p})],d.prototype,"portal",void 0);b.__decorate([n.property()],d.prototype,"screenshots",void 0);b.__decorate([n.property()],d.prototype,"size",void 0);b.__decorate([n.property()],d.prototype,"snippet",void 0);b.__decorate([n.property()],d.prototype,"sourceJSON",void 0);b.__decorate([n.property()],d.prototype,"tags",void 0);
b.__decorate([n.property()],d.prototype,"thumbnail",void 0);b.__decorate([n.property({dependsOn:["itemUrl","thumbnail","portal.credential.token"],readOnly:!0})],d.prototype,"thumbnailUrl",null);b.__decorate([n.property()],d.prototype,"title",void 0);b.__decorate([n.property()],d.prototype,"type",void 0);b.__decorate([n.property()],d.prototype,"typeKeywords",void 0);b.__decorate([n.property()],d.prototype,"url",void 0);b.__decorate([n.property({dependsOn:["portal.restUrl","portal.user.username","owner",
"ownerFolder","id"],readOnly:!0})],d.prototype,"userItemUrl",null);return d=h=b.__decorate([n.subclass("esri.portal.PortalItem")],d)}(h.JSONSupportMixin(d))})},"esri/portal/PortalItemResource":function(){define("require exports tslib ../core/Accessor ../core/Error ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/decorators @dojo/framework/shim/Promise".split(" "),function(m,a,b,l,k,h,g,d,f){var c=h.getLogger("esri.portal.PortalItemResource");return function(a){function e(c){c=
a.call(this,c)||this;c.portalItem=null;return c}b.__extends(e,a);e.prototype.normalizeCtorArgs=function(a){return a&&a.portalItem&&a.path?b.__assign(b.__assign({},a),{path:this.normalizePath(a.path,a.portalItem)}):a};Object.defineProperty(e.prototype,"path",{set:function(a){g.isSome(a)&&d.isAbsolute(a)?c.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",a)},enumerable:!1,configurable:!0});e.prototype._castPath=function(a){return this.normalizePath(a,
this.portalItem)};Object.defineProperty(e.prototype,"url",{get:function(){return this.portalItem&&this.path?this.portalItem.itemUrl+"/resources/"+this.path:null},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"itemRelativeUrl",{get:function(){return this.portalItem&&this.path?"./resources/"+this.path:null},enumerable:!1,configurable:!0});e.prototype.fetch=function(a,c){void 0===a&&(a="json");var b=this.url;if(g.isNone(b))throw new k("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");
return this.portalItem.portal._request(b,{responseType:a,signal:g.get(c,"signal")})};e.prototype.update=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e;return b.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,c){m(["./support/resourceUtils"],a,c)})];case 1:return e=b.sent(),[2,e.addOrUpdateResource(this,"update",a,c)]}})})};e.prototype.hasPath=function(){return g.isSome(this.path)};e.prototype.normalizePath=function(a,c){if(g.isNone(a))return a;
a=a.replace(/^\/+/,"");g.isSome(c)&&d.isAbsolute(a)&&(a=d.makeRelative(a,c.itemUrl));return a.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")};b.__decorate([f.property()],e.prototype,"portalItem",void 0);b.__decorate([f.property({type:String,value:null})],e.prototype,"path",null);b.__decorate([f.cast("path")],e.prototype,"_castPath",null);b.__decorate([f.property({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],e.prototype,"url",null);b.__decorate([f.property({type:String,readOnly:!0,
dependsOn:["portalItem","path"]})],e.prototype,"itemRelativeUrl",null);return e=b.__decorate([f.subclass("esri.portal.PortalItemResource")],e)}(l)})},"esri/portal/PortalRating":function(){define(["require","exports","tslib","../core/Accessor","../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.created=null;b.rating=null;return b}b.__extends(g,a);b.__decorate([k.property()],g.prototype,"created",void 0);b.__decorate([k.property()],g.prototype,
"rating",void 0);return g=b.__decorate([k.subclass("esri.portal.PortalRating")],g)}(l)})},"esri/layers/mixins/RefreshableLayer":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.RefreshableLayer=void 0;a.RefreshableLayer=function(a){return function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.refreshInterval=0;return b}b.__extends(g,a);g.prototype.refresh=function(){this.emit("refresh")};
b.__decorate([l.property({type:Number,cast:function(a){return.1<=a?a:0>=a?0:.1},json:{write:!0,origins:{"web-document":{write:!0}}}})],g.prototype,"refreshInterval",void 0);return g=b.__decorate([l.subclass("esri.layers.mixins.RefreshableLayer")],g)}(a)}})},"esri/layers/mixins/ScaleRangeLayer":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.ScaleRangeLayer=void 0;a.ScaleRangeLayer=function(a){return function(a){function g(){var b=
null!==a&&a.apply(this,arguments)||this;b.minScale=0;b.maxScale=0;return b}b.__extends(g,a);Object.defineProperty(g.prototype,"scaleRangeId",{get:function(){return this.minScale+","+this.maxScale},enumerable:!1,configurable:!0});b.__decorate([l.property({type:Number,nonNullable:!0,json:{write:!0}})],g.prototype,"minScale",void 0);b.__decorate([l.property({type:Number,nonNullable:!0,json:{write:!0}})],g.prototype,"maxScale",void 0);b.__decorate([l.property({readOnly:!0,dependsOn:["minScale","maxScale"]})],
g.prototype,"scaleRangeId",null);return g=b.__decorate([l.subclass("esri.layers.mixins.ScaleRangeLayer")],g)}(a)}})},"esri/layers/mixins/TemporalLayer":function(){define("require exports tslib ../../TimeExtent ../../TimeInterval ../../core/accessorSupport/decorators ../../layers/support/TimeInfo ../support/fieldUtils ../support/timeUtils".split(" "),function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.TemporalLayer=void 0;a.TemporalLayer=function(a){return function(a){function c(){var c=
null!==a&&a.apply(this,arguments)||this;c.timeExtent=null;c.timeOffset=null;c.useViewTime=!0;return c}b.__extends(c,a);c.prototype.readOffset=function(a,c){c=c.timeInfo.exportOptions;if(!c)return null;a=c.timeOffset;c=f.timeUnitKebabDictionary.fromJSON(c.timeOffsetUnits);return a&&c?new k({value:a,unit:c}):null};Object.defineProperty(c.prototype,"timeInfo",{set:function(a){d.fixTimeInfoFields(a,this.fields);this._set("timeInfo",a)},enumerable:!1,configurable:!0});b.__decorate([h.property({type:l,
json:{write:!1}})],c.prototype,"timeExtent",void 0);b.__decorate([h.property({type:k})],c.prototype,"timeOffset",void 0);b.__decorate([h.reader("service","timeOffset",["timeInfo.exportOptions"])],c.prototype,"readOffset",null);b.__decorate([h.property({value:null,type:g,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],c.prototype,"timeInfo",null);b.__decorate([h.property({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],
c.prototype,"useViewTime",void 0);return c=b.__decorate([h.subclass("esri.layers.mixins.TemporalLayer")],c)}(a)}})},"esri/TimeInterval":function(){define("require exports tslib ./core/JSONSupport ./core/accessorSupport/decorators ./layers/support/timeUtils".split(" "),function(m,a,b,l,k,h){return function(a){function d(c){c=a.call(this,c)||this;c.value=0;c.unit="milliseconds";return c}b.__extends(d,a);f=d;d.prototype.toMilliseconds=function(){return this.value*h.millisecondsPerTimeUnit[this.unit]};
d.prototype.clone=function(){return new f({value:this.value,unit:this.unit})};var f;b.__decorate([k.property({type:Number,json:{write:!0},nonNullable:!0})],d.prototype,"value",void 0);b.__decorate([k.property({type:h.timeUnitKebabDictionary.apiValues,json:{type:h.timeUnitKebabDictionary.jsonValues,read:h.timeUnitKebabDictionary.read,write:h.timeUnitKebabDictionary.write},nonNullable:!0})],d.prototype,"unit",void 0);return d=f=b.__decorate([k.subclass("esri.TimeInterval")],d)}(l.JSONSupport)})},"esri/layers/support/TimeInfo":function(){define("require exports tslib ../../TimeExtent ../../TimeInterval ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./TimeReference ./timeUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c){return function(a){function e(c){c=a.call(this,c)||this;c.cumulative=!1;c.endField=null;c.fullTimeExtent=null;c.hasLiveData=!1;c.interval=null;c.startField=null;c.timeReference=null;c.trackIdField=null;c.useTime=!0;return c}b.__extends(e,a);h=e;e.prototype.readFullTimeExtent=function(a,c){return c.timeExtent&&Array.isArray(c.timeExtent)&&2===c.timeExtent.length?new l({start:new Date(c.timeExtent[0]),end:new Date(c.timeExtent[1])}):null};e.prototype.writeFullTimeExtent=
function(a,c){c.timeExtent=a&&a.start&&a.end?[a.start.getTime(),a.end.getTime()]:null};e.prototype.readInterval=function(a,b){return b.timeInterval&&b.timeIntervalUnits?new k({value:b.timeInterval,unit:c.timeUnitKebabDictionary.fromJSON(b.timeIntervalUnits)}):b.defaultTimeInterval&&b.defaultTimeIntervalUnits?new k({value:b.defaultTimeInterval,unit:c.timeUnitKebabDictionary.fromJSON(b.defaultTimeIntervalUnits)}):null};e.prototype.writeInterval=function(a,c){a?(a=a.toJSON(),c.timeInterval=a.value,c.timeIntervalUnits=
a.unit):(c.timeInterval=null,c.timeIntervalUnits=null)};e.prototype.clone=function(){var a=this.fullTimeExtent,c=this.trackIdField,b=this.useTime;return new h({cumulative:this.cumulative,endField:this.endField,hasLiveData:this.hasLiveData,interval:this.interval,startField:this.startField,timeReference:g.clone(this.timeReference),fullTimeExtent:g.clone(a),trackIdField:c,useTime:b})};var h;b.__decorate([d.property({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],
e.prototype,"cumulative",void 0);b.__decorate([d.property({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],e.prototype,"endField",void 0);b.__decorate([d.property({type:l,json:{write:{enabled:!0,allowNull:!0}}})],e.prototype,"fullTimeExtent",void 0);b.__decorate([d.reader("fullTimeExtent",["timeExtent"])],e.prototype,"readFullTimeExtent",null);b.__decorate([d.writer("fullTimeExtent")],e.prototype,"writeFullTimeExtent",null);b.__decorate([d.property({type:Boolean,
json:{write:!0}})],e.prototype,"hasLiveData",void 0);b.__decorate([d.property({type:k,json:{write:{enabled:!0,allowNull:!0}}})],e.prototype,"interval",void 0);b.__decorate([d.reader("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],e.prototype,"readInterval",null);b.__decorate([d.writer("interval")],e.prototype,"writeInterval",null);b.__decorate([d.property({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],
e.prototype,"startField",void 0);b.__decorate([d.property({type:f,json:{write:{enabled:!0,allowNull:!0}}})],e.prototype,"timeReference",void 0);b.__decorate([d.property({type:String,json:{write:{enabled:!0,allowNull:!0}}})],e.prototype,"trackIdField",void 0);b.__decorate([d.property({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],e.prototype,"useTime",void 0);return e=h=b.__decorate([d.subclass("esri.layers.support.TimeInfo")],e)}(h.JSONSupport)})},
"esri/layers/support/TimeReference":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.respectsDaylightSaving=!1;b.timezone=null;return b}b.__extends(g,a);d=g;g.prototype.readRespectsDaylightSaving=function(a,c){return void 0!==c.respectsDaylightSaving?c.respectsDaylightSaving:void 0!==c.respectDaylightSaving?c.respectDaylightSaving:!1};g.prototype.clone=function(){return new d({respectsDaylightSaving:this.respectsDaylightSaving,
timezone:this.timezone})};var d;b.__decorate([k.property({type:Boolean,json:{write:!0}})],g.prototype,"respectsDaylightSaving",void 0);b.__decorate([k.reader("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],g.prototype,"readRespectsDaylightSaving",null);b.__decorate([k.property({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],g.prototype,"timezone",void 0);return g=d=b.__decorate([k.subclass("esri.layers.support.TimeReference")],g)}(l.JSONSupport)})},
"esri/layers/support/FeatureIndex":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureIndex=void 0;m=function(a){function g(b){return a.call(this,b)||this}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({name:this.name,fields:this.fields,isAscending:this.isAscending,isUnique:this.isUnique,description:this.description})};var d;b.__decorate([k.property({constructOnly:!0})],
g.prototype,"name",void 0);b.__decorate([k.property({constructOnly:!0})],g.prototype,"fields",void 0);b.__decorate([k.property({constructOnly:!0})],g.prototype,"isAscending",void 0);b.__decorate([k.property({constructOnly:!0})],g.prototype,"isUnique",void 0);b.__decorate([k.property({constructOnly:!0})],g.prototype,"description",void 0);return g=d=b.__decorate([k.subclass("esri.layers.support.FeatureIndex")],g)}(l.JSONSupport);a.FeatureIndex=m;a.default=m})},"esri/layers/support/FeatureReduction":function(){define(["require",
"exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureReduction=void 0;m=function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.type=null;return b}b.__extends(g,a);b.__decorate([k.property({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],g.prototype,"type",void 0);return g=b.__decorate([k.subclass("esri.layers.support.FeatureReduction")],g)}(l.JSONSupport);
a.FeatureReduction=m;a.default=m})},"esri/layers/support/FeatureReductionCluster":function(){define("require exports tslib ../../PopupTemplate ../../core/JSONSupport ../../core/lang ../../core/screenUtils ../../core/accessorSupport/decorators ./AggregateField ./commonProperties ./LabelClass".split(" "),function(m,a,b,l,k,h,g,d,f,c,e){return function(a){function n(c){c=a.call(this,c)||this;c.type="cluster";c.clusterRadius=g.toPt("80px");c.clusterMinSize=g.toPt("12px");c.clusterMaxSize=g.toPt("50px");
c.popupEnabled=!0;c.popupTemplate=null;c.labelingInfo=null;c.labelsVisible=!0;c.fields=null;return c}b.__extends(n,a);k=n;n.prototype.clone=function(){return new k({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:h.clone(this.labelingInfo),labelsVisible:this.labelsVisible,fields:h.clone(this.fields),popupEnabled:this.popupEnabled,popupTemplate:h.clone(this.popupTemplate)})};var k;b.__decorate([d.property({type:["cluster"],readOnly:!0,
json:{write:!0}})],n.prototype,"type",void 0);b.__decorate([d.property({type:Number,cast:function(a){return"auto"===a?a:g.toPt(a)},json:{write:!0}})],n.prototype,"clusterRadius",void 0);b.__decorate([d.property({type:Number,cast:g.toPt,json:{write:!0}})],n.prototype,"clusterMinSize",void 0);b.__decorate([d.property({type:Number,cast:g.toPt,json:{write:!0}})],n.prototype,"clusterMaxSize",void 0);b.__decorate([d.property(c.popupEnabled)],n.prototype,"popupEnabled",void 0);b.__decorate([d.property({type:l,
json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],n.prototype,"popupTemplate",void 0);b.__decorate([d.property({type:[e],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],n.prototype,"labelingInfo",void 0);b.__decorate([d.property(c.labelsVisible)],n.prototype,"labelsVisible",void 0);b.__decorate([d.property({type:[f],json:{write:!0}})],n.prototype,"fields",void 0);return n=k=b.__decorate([d.subclass("esri.layers.support.FeatureReductionCluster")],
n)}(k.JSONSupport)})},"esri/layers/support/AggregateField":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ./OutStatistic".split(" "),function(m,a,b,l,k,h){return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.name=null;return c}b.__extends(d,a);f=d;d.prototype.clone=function(){return new f({name:this.name,outStatistic:this.outStatistic.clone()})};var f;b.__decorate([k.property({type:String,json:{write:!0}})],d.prototype,
"name",void 0);b.__decorate([k.property({type:h,json:{write:!0}})],d.prototype,"outStatistic",void 0);return d=f=b.__decorate([k.subclass("esri.layers.support.AggregateField")],d)}(l.JSONSupport)})},"esri/layers/support/OutStatistic":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(m,a,b,l,k){return function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.statisticType=null;b.onStatisticField=null;b.onStatisticValueExpression=
null;return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d({statisticType:this.statisticType,onStatisticField:this.onStatisticField,onStatisticValueExpression:this.onStatisticValueExpression})};var d;b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"statisticType",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"onStatisticField",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],g.prototype,"onStatisticValueExpression",
void 0);return g=d=b.__decorate([k.subclass("esri.layers.support.OutStatistic")],g)}(l.JSONSupport)})},"esri/layers/support/LabelClass":function(){define("require exports tslib ../../symbols ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./LabelExpressionInfo ./labelUtils ../../symbols/support/defaults ../../symbols/support/jsonUtils".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n){function t(a){return a?"service"===a.origin?!1:!a.layer||"map-image"!==
a.layer.type:!0}var x=new k.default({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",
esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",
esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});return function(a){function h(c){c=a.call(this,c)||this;c.type="label";c.name=null;c.deconflictionStrategy="static";c.labelExpression=null;c.labelExpressionInfo=null;c.labelPlacement=null;c.maxScale=0;c.minScale=0;c.symbol=
e.defaultTextSymbol2D;c.useCodedValues=void 0;c.where=null;return c}b.__extends(h,a);k=h;h.evaluateWhere=function(a,c){var b=function(a,c,b){switch(c){case "\x3d":return a==b?!0:!1;case "\x3c\x3e":return a!=b?!0:!1;case "\x3e":return a>b?!0:!1;case "\x3e\x3d":return a>=b?!0:!1;case "\x3c":return a<b?!0:!1;case "\x3c\x3d":return a<=b?!0:!1}return!1};try{if(null==a)return!0;var e=a.split(" ");if(3===e.length)return b(c[e[0]],e[1],e[2]);if(7===e.length){var d=b(c[e[0]],e[1],e[2]),f=e[3],g=b(c[e[4]],
e[5],e[6]);switch(f){case "AND":return d&&g;case "OR":return d||g}}return!1}catch(D){console.log("Error.: can't parse \x3d "+a)}};h.prototype.readLabelExpression=function(a,c){c=c.labelExpressionInfo;if(!c||!c.value&&!c.expression)return a};h.prototype.writeLabelExpression=function(a,b,e,d){this.labelExpressionInfo&&(t(d)||d&&"service"===d.origin)&&(null!=this.labelExpressionInfo.value?a=c.templateStringToSql(this.labelExpressionInfo.value):null!=this.labelExpressionInfo.expression&&(d=c.getSingleFieldArcadeExpression(this.labelExpressionInfo.expression))&&
(a="["+d+"]"));null!=a&&(b[e]=a)};h.prototype.writeLabelExpressionInfo=function(a,c,b,e){if(null==a&&null!=this.labelExpression&&t(e))a=new f({expression:this.getLabelExpressionArcade()});else if(!a)return;a=a.toJSON(e);a.expression&&(c[b]=a)};h.prototype.writeMaxScale=function(a,c){if(a||this.minScale)c.maxScale=a};h.prototype.writeMinScale=function(a,c){if(a||this.maxScale)c.minScale=a};h.prototype.getLabelExpression=function(){return c.getLabelExpression(this)};h.prototype.getLabelExpressionArcade=
function(){return c.getLabelExpressionArcade(this)};h.prototype.getLabelExpressionSingleField=function(){return c.getLabelExpressionSingleField(this)};h.prototype.hash=function(){return JSON.stringify(this)};h.prototype.clone=function(){return new k({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:g.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:g.clone(this.symbol),
where:this.where,useCodedValues:this.useCodedValues})};var k;b.__decorate([d.property({type:String,json:{write:!0}})],h.prototype,"name",void 0);b.__decorate([d.property({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],h.prototype,"deconflictionStrategy",void 0);b.__decorate([d.property({type:String,json:{write:{allowNull:!0}}})],h.prototype,"labelExpression",void 0);b.__decorate([d.reader("labelExpression")],h.prototype,"readLabelExpression",null);b.__decorate([d.writer("labelExpression")],
h.prototype,"writeLabelExpression",null);b.__decorate([d.property({type:f,json:{write:{overridePolicy:function(a,c,b){return t(b)?{allowNull:!0}:{enabled:!1}}}}})],h.prototype,"labelExpressionInfo",void 0);b.__decorate([d.writer("labelExpressionInfo")],h.prototype,"writeLabelExpressionInfo",null);b.__decorate([d.property({type:x.apiValues,json:{type:x.jsonValues,read:x.read,write:x.write}})],h.prototype,"labelPlacement",void 0);b.__decorate([d.property({type:Number})],h.prototype,"maxScale",void 0);
b.__decorate([d.writer("maxScale")],h.prototype,"writeMaxScale",null);b.__decorate([d.property({type:Number})],h.prototype,"minScale",void 0);b.__decorate([d.writer("minScale")],h.prototype,"writeMinScale",null);b.__decorate([d.property({types:l.symbolTypesLabel,json:{origins:{"web-scene":{types:l.symbolTypesLabel3D,write:n.write,default:null}},write:n.write,default:null}})],h.prototype,"symbol",void 0);b.__decorate([d.property({type:Boolean,json:{write:!0}})],h.prototype,"useCodedValues",void 0);
b.__decorate([d.property({type:String,json:{write:!0}})],h.prototype,"where",void 0);return h=k=b.__decorate([d.subclass("esri.layers.support.LabelClass")],h)}(h.JSONSupport)})},"esri/layers/support/LabelExpressionInfo":function(){define("require exports tslib ../../core/JSONSupport ../../core/accessorSupport/decorators ./labelUtils".split(" "),function(m,a,b,l,k,h){return function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c.value=null;c.expression=null;return c}b.__extends(d,
a);f=d;d.prototype.readExpression=function(a,b){return b.value?h.convertTemplatedStringToArcade(b.value):a};d.prototype.writeExpression=function(a,b,d){null!=this.value&&(a=h.convertTemplatedStringToArcade(this.value));b[d]=a};d.prototype.clone=function(){return new f({value:this.value,expression:this.expression})};var f;b.__decorate([k.property({json:{read:!1,write:!1}})],d.prototype,"value",void 0);b.__decorate([k.property({type:String,json:{write:{allowNull:!0}}})],d.prototype,"expression",void 0);
b.__decorate([k.reader("expression",["expression","value"])],d.prototype,"readExpression",null);b.__decorate([k.writer("expression")],d.prototype,"writeExpression",null);return d=f=b.__decorate([k.subclass("esri.layers.support.LabelExpressionInfo")],d)}(l.JSONSupport)})},"esri/layers/support/labelUtils":function(){define(["require","exports","../../core/string"],function(m,a,b){function l(a){return a.replace(/\[/g,"{").replace(/\]/g,"}")}function k(a){var c={expression:"",type:"none"};a.labelExpressionInfo?
a.labelExpressionInfo.value?(c.expression=a.labelExpressionInfo.value,c.type="conventional"):a.labelExpressionInfo.expression&&(c.expression=a.labelExpressionInfo.expression,c.type="arcade"):null!=a.labelExpression&&(c.expression=l(a.labelExpression),c.type="conventional");return c}function h(a){a?(a=b.replace(a,function(a){return'__begin__$feature["'+a+'"]__end__'}),a=e.test(a)?a.replace(e,""):'"'+a,a=n.test(a)?a.replace(n,""):a+'"',a=a.replace(f,'" + ').replace(c,' + "')):a='""';return a}function g(a){return(a=
a.match(t))&&a[1].trim()||null}function d(a){if(!a)return null;var c=x.exec(a)||p.exec(a);return c?c[1]||c[3]:(c=q.exec(a))?c[2]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getSingleFieldArcadeExpression=a.getSingleFieldTemplatedString=a.convertTemplatedStringToArcade=a.getLabelExpressionSingleField=a.getLabelExpressionArcade=a.getLabelExpression=a.templateStringToSql=a.sqlToTemplateString=void 0;var f=/__begin__/ig,c=/__end__/ig,e=/^__begin__/i,n=/__end__$/i;a.sqlToTemplateString=l;a.templateStringToSql=
function(a){return a.replace(/\{/g,"[").replace(/\}/g,"]")};a.getLabelExpression=k;a.getLabelExpressionArcade=function(a){a=k(a);if(!a)return null;switch(a.type){case "conventional":return h(a.expression);case "arcade":return a.expression}return null};a.getLabelExpressionSingleField=function(a){a=k(a);if(!a)return null;switch(a.type){case "conventional":return g(a.expression);case "arcade":return d(a.expression)}return null};a.convertTemplatedStringToArcade=h;var t=/^\s*\{([^}]+)\}\s*$/i;a.getSingleFieldTemplatedString=
g;var x=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,p=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,q=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;a.getSingleFieldArcadeExpression=d})},"esri/symbols/support/defaults":function(){define("require exports ../../core/compilerUtils ../../core/maybe ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../TextSymbol ./defaultsJSON".split(" "),
function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});a.errorPolygonSymbol2D=a.errorPolylineSymbol2D=a.errorPointSymbol2D=a.getDefaultSymbol2D=a.defaultTextSymbol2D=a.defaultPolygonSymbol2D=a.defaultPolylineSymbol2D=a.defaultPointSymbol2D=void 0;a.defaultPointSymbol2D=g.fromJSON(f.defaultPointSymbolJSON);a.defaultPolylineSymbol2D=h.fromJSON(f.defaultPolylineSymbolJSON);a.defaultPolygonSymbol2D=k.fromJSON(f.defaultPolygonSymbolJSON);a.defaultTextSymbol2D=d.fromJSON(f.defaultTextSymbolJSON);
a.getDefaultSymbol2D=function(c){if(l.isNone(c))return null;switch(c.type){case "mesh":break;case "point":case "multipoint":return a.defaultPointSymbol2D;case "polyline":return a.defaultPolylineSymbol2D;case "polygon":case "extent":return a.defaultPolygonSymbol2D;default:b.neverReached(c)}return null};a.errorPointSymbol2D=g.fromJSON(f.errorPointSymbolJSON);a.errorPolylineSymbol2D=h.fromJSON(f.errorPolylineSymbolJSON);a.errorPolygonSymbol2D=k.fromJSON(f.errorPolygonSymbolJSON)})},"esri/layers/support/FeatureReductionSelection":function(){define(["require",
"exports","tslib","../../core/accessorSupport/decorators","./FeatureReduction"],function(m,a,b,l,k){return function(a){function g(b){b=a.call(this,b)||this;b.type="selection";return b}b.__extends(g,a);d=g;g.prototype.clone=function(){return new d};var d;b.__decorate([l.property({type:["selection"]})],g.prototype,"type",void 0);return g=d=b.__decorate([l.subclass("esri.layers.support.FeatureReductionSelection")],g)}(k.default)})},"esri/layers/support/featureReductionUtils":function(){define("require exports ../../core/Error ../../core/object ./FeatureReduction ./FeatureReductionCluster ./FeatureReductionSelection".split(" "),
function(m,a,b,l,k,h,g){function d(a,c,e){return a?"selection"!==a.type?(e.messages&&e.messages.push(new b("featureReduction:unsupported","FeatureReduction of type '"+a.declaredClass+"' are not supported in scenes.",{featureReduction:a,context:e})),null):a.write(c,e):null}Object.defineProperty(a,"__esModule",{value:!0});a.write=a.writeTarget=a.read=a.webSceneFeatureReductionTypes=void 0;a.webSceneFeatureReductionTypes={key:"type",base:k.default,typeMap:{selection:g}};a.read=function(a,c){c=c.layerDefinition||
c;if(a=c.featureReduction)switch(a.type){case "selection":return g.fromJSON(a);case "cluster":return h.fromJSON(a)}return null};a.writeTarget=function(a,c,b,g){(a=d(a,{},g))&&l.setDeepValue(b,a,c)};a.write=d})},"esri/layers/support/FeatureTemplate":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h,g){var d=new l.default({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",
esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});
return function(a){function c(c){c=a.call(this,c)||this;c.name=null;c.description=null;c.drawingTool=null;c.prototype=null;c.thumbnail=null;return c}b.__extends(c,a);c.prototype.writeDrawingTool=function(a,c){c.drawingTool=d.toJSON(a)};c.prototype.writePrototype=function(a,c){c.prototype=h.fixJson(h.clone(a),!0)};c.prototype.writeThumbnail=function(a,c){c.thumbnail=h.fixJson(h.clone(a))};b.__decorate([g.property({json:{write:!0}})],c.prototype,"name",void 0);b.__decorate([g.property({json:{write:!0}})],
c.prototype,"description",void 0);b.__decorate([g.property({json:{read:d.read,write:d.write}})],c.prototype,"drawingTool",void 0);b.__decorate([g.writer("drawingTool")],c.prototype,"writeDrawingTool",null);b.__decorate([g.property({json:{write:!0}})],c.prototype,"prototype",void 0);b.__decorate([g.writer("prototype")],c.prototype,"writePrototype",null);b.__decorate([g.property({json:{write:!0}})],c.prototype,"thumbnail",void 0);b.__decorate([g.writer("thumbnail")],c.prototype,"writeThumbnail",null);
return c=b.__decorate([g.subclass("esri.layers.support.FeatureTemplate")],c)}(k.JSONSupport)})},"esri/layers/support/FeatureType":function(){define("require exports tslib ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./domains ./FeatureTemplate".split(" "),function(m,a,b,l,k,h,g,d){return function(a){function c(c){c=a.call(this,c)||this;c.id=null;c.name=null;c.domains=null;c.templates=null;return c}b.__extends(c,a);c.prototype.readDomains=function(a){var c={},b;for(b in a)if(a.hasOwnProperty(b)){var e=
a[b];switch(e.type){case "range":c[b]=g.RangeDomain.fromJSON(e);break;case "codedValue":c[b]=g.CodedValueDomain.fromJSON(e);break;case "inherited":c[b]=g.InheritedDomain.fromJSON(e)}}return c};c.prototype.writeDomains=function(a,c){var b={},e;for(e in a)a.hasOwnProperty(e)&&(b[e]=a[e]&&a[e].toJSON());k.fixJson(b);c.domains=b};c.prototype.readTemplates=function(a){return a&&a.map(function(a){return new d(a)})};c.prototype.writeTemplates=function(a,c){c.templates=a&&a.map(function(a){return a.toJSON()})};
b.__decorate([h.property({json:{write:!0}})],c.prototype,"id",void 0);b.__decorate([h.property({json:{write:!0}})],c.prototype,"name",void 0);b.__decorate([h.property({json:{write:!0}})],c.prototype,"domains",void 0);b.__decorate([h.reader("domains")],c.prototype,"readDomains",null);b.__decorate([h.writer("domains")],c.prototype,"writeDomains",null);b.__decorate([h.property({json:{write:!0}})],c.prototype,"templates",void 0);b.__decorate([h.reader("templates")],c.prototype,"readTemplates",null);b.__decorate([h.writer("templates")],
c.prototype,"writeTemplates",null);return c=b.__decorate([h.subclass("esri.layers.support.FeatureType")],c)}(l.JSONSupport)})},"esri/layers/support/fieldProperties":function(){define("require exports @dojo/framework/shim/array ../../core/Logger ./Field ./fieldUtils".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.defineFieldProperties=void 0;var g=l.getLogger("esri.layers.support.fieldProperties");a.defineFieldProperties=function(){return{fields:{type:[k],value:null},
outFields:{type:[String],dependsOn:["fields"],json:{read:!1},set:function(a){this._userOutFields=a;this.notifyChange("outFields")},get:function(){var a=this._userOutFields;if(!a||!a.length)return null;if(b.includes(a,"*"))return["*"];if(!this.fields)return a;for(var f=0;f<a.length;f++){var c=a[f];h.hasField(this.fields,c)||g.error("field-attributes-layer:invalid-field","Invalid field "+c+" found in outFields",{layer:this,outFields:a})}return h.fixFields(this.fields,a)}}}}})},"esri/layers/support/labelingInfo":function(){define(["require",
"exports","./LabelClass"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.reader=void 0;var l=/\[([^\[\]]+)\]/gi;a.reader=function(a,h,g){var d=this;return a?a.map(function(a){var c=new b;c.read(a,g);if(c.labelExpression){var e=h.fields||h.layerDefinition&&h.layerDefinition.fields||d.fields;c.labelExpression=c.labelExpression.replace(l,function(a,c){a:if(e){a=c.toLowerCase();for(var b=0;b<e.length;b++){var d=e[b].name;if(d.toLowerCase()===a){c=d;break a}}}return"["+c+"]"})}return c}):
null}})},"esri/layers/support/Relationship":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(m,a,b,l,k,h){var g=new l.default({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),d=new l.default({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});return function(a){function c(c){c=a.call(this,c)||this;c.cardinality=
null;c.composite=null;c.id=null;c.keyField=null;c.keyFieldInRelationshipTable=null;c.name=null;c.relatedTableId=null;c.relationshipTableId=null;c.role=null;return c}b.__extends(c,a);b.__decorate([h.property({json:{read:g.read,write:g.write}})],c.prototype,"cardinality",void 0);b.__decorate([h.property({json:{read:!0,write:!0}})],c.prototype,"composite",void 0);b.__decorate([h.property({json:{read:!0,write:!0}})],c.prototype,"id",void 0);b.__decorate([h.property({json:{read:!0,write:!0}})],c.prototype,
"keyField",void 0);b.__decorate([h.property({json:{read:!0,write:!0}})],c.prototype,"keyFieldInRelationshipTable",void 0);b.__decorate([h.property({json:{read:!0,write:!0}})],c.prototype,"name",void 0);b.__decorate([h.property({json:{read:!0,write:!0}})],c.prototype,"relatedTableId",void 0);b.__decorate([h.property({json:{read:!0,write:!0}})],c.prototype,"relationshipTableId",void 0);b.__decorate([h.property({json:{read:d.read,write:d.write}})],c.prototype,"role",void 0);return c=b.__decorate([h.subclass("esri.layers.support.Relationship")],
c)}(k.JSONSupport)})},"esri/renderers/support/styleUtils":function(){define("require exports tslib ../../core/asyncUtils ../../core/promiseUtils ../../core/Warning".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.loadStyleRenderer=void 0;a.loadStyleRenderer=function(a,d,f){return b.__awaiter(this,void 0,void 0,function(){var c,e,g;return b.__generator(this,function(b){switch(b.label){case 0:return(c=a&&a.getAtOrigin&&a.getAtOrigin("renderer",d.origin))&&"unique-value"===
c.type&&c.styleOrigin?[4,l.result(c.populateFromStyle())]:[3,2];case 1:e=b.sent(),k.throwIfAborted(f),!1===e.ok&&(g=e.error,d&&d.messages&&d.messages.push(new h("renderer:style-reference","Failed to create unique value renderer from style reference: "+g.message,{error:g,context:d})),a.clear("renderer",d.origin)),b.label=2;case 2:return[2]}})})}})},"esri/core/asyncUtils":function(){define(["require","exports","./promiseUtils"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.assertResult=
a.result=a.map=a.forEach=void 0;a.forEach=function(a,k,h){return b.eachAlways(a.map(function(a,b){return k.apply(h,[a,b])}))};a.map=function(a,k,h){return b.eachAlways(a.map(function(a,b){return k.apply(h,[a,b])})).then(function(a){return a.map(function(a){return a.value})})};a.result=function(a){return a.then(function(a){return{ok:!0,value:a}}).catch(function(a){return{ok:!1,error:a}})};a.assertResult=function(a){if(!0===a.ok)return a.value;throw a.error;}})},"esri/support/popupUtils":function(){define("require exports ../PopupTemplate ../layers/support/fieldUtils ../popup/content ../popup/FieldInfo ../popup/support/FieldInfoFormat".split(" "),
function(m,a,b,l,k,h,g){function d(a,c){var b=a;c&&(a=a.filter(function(a){return-1===c.indexOf(a.type)}));a===b&&(a=a.slice());a.sort(f);return a}function f(a,c){return"oid"===a.type?-1:"oid"===c.type?1:t(a)?-1:t(c)?1:(a.alias||a.name).toLocaleLowerCase().localeCompare((c.alias||c.name).toLocaleLowerCase())}function c(a,c){if(!a||!c)return!1;var b=c.creationDateField,e=c.creatorField,d=c.editDateField;c=c.editorField;return-1!==[b&&b.toLowerCase(),e&&e.toLowerCase(),d&&d.toLowerCase(),c&&c.toLowerCase()].indexOf(a.toLowerCase())}
function e(a,b){var e=a.editFieldsInfo,f=a.objectIdField;return d(a.fields,(null===b||void 0===b?void 0:b.ignoreFieldTypes)||y).map(function(a){var d=a.name,g;g=a.editable&&-1===p.indexOf(a.type)&&!c(a.name,e);return new h({fieldName:d,isEditable:g,label:a.alias,format:n(a),visible:u(a,{editFieldsInfo:e,objectIdField:f,visibleFieldNames:null===b||void 0===b?void 0:b.visibleFieldNames})})})}function n(a){switch(a.type){case "small-integer":case "integer":case "single":return new g({digitSeparator:!0,
places:0});case "double":return new g({digitSeparator:!0,places:2});case "date":return new g({dateFormat:"long-month-day-year"});default:return null}}function t(a){if("name"===(a.name&&a.name.toLowerCase())||"name"===(a.alias&&a.alias.toLowerCase()))return!0}Object.defineProperty(a,"__esModule",{value:!0});a.createFieldInfos=a.createFieldsContent=a.createPopupTemplate=void 0;var x=["oid","global-id"],p=["oid","global-id","guid"];a.createPopupTemplate=function(a,c){var d=a.displayField,f=a.fields,
g=a.title;if(!f)return null;a=e({editFieldsInfo:a.editFieldsInfo,fields:f,objectIdField:a.objectIdField},c);if(!a.length)return null;f={titleBase:g,fields:f,displayField:d};d=l.getDisplayFieldName(f);f=f.titleBase;d=d?f+": {"+d.trim()+"}":f;f=[new k.FieldsContent,new k.AttachmentsContent];return new b({title:d,content:f,fieldInfos:a})};var q=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],
u=function(a,b){var e=b.editFieldsInfo,d=b.objectIdField;return(b=b.visibleFieldNames)?b.has(a.name):c(a.name,e)?!1:d&&a.name===d?!1:-1<x.indexOf(a.type)?!1:!q.some(function(c){return c.test(a.name)})};a.createFieldsContent=function(a,c){return new k.FieldsContent({fieldInfos:e(a,c).filter(function(a){return a.visible})})};a.createFieldInfos=e;var y=["geometry","blob","raster","guid","xml"]})},"esri/tasks/support/AttachmentQuery":function(){define("require exports tslib ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(m,a,b,l,k,h,g){m=function(a){function d(c){c=a.call(this,c)||this;c.attachmentTypes=null;c.attachmentsWhere=null;c.keywords=null;c.globalIds=null;c.name=null;c.num=null;c.objectIds=null;c.returnMetadata=!1;c.size=null;c.start=null;c.where=null;return c}b.__extends(d,a);c=d;d.prototype.writeStart=function(a,c){c.resultOffset=this.start;c.resultRecordCount=this.num||10};d.prototype.clone=function(){return new c(k.clone({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,
keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))};var c;b.__decorate([h.property({type:[String],json:{write:!0}})],d.prototype,"attachmentTypes",void 0);b.__decorate([h.property({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],d.prototype,"attachmentsWhere",void 0);b.__decorate([h.property({type:[String],
json:{write:!0}})],d.prototype,"keywords",void 0);b.__decorate([h.property({type:[Number],json:{write:!0}})],d.prototype,"globalIds",void 0);b.__decorate([h.property({json:{write:!0}})],d.prototype,"name",void 0);b.__decorate([h.property({type:Number,json:{read:{source:"resultRecordCount"}}})],d.prototype,"num",void 0);b.__decorate([h.property({type:[Number],json:{write:!0}})],d.prototype,"objectIds",void 0);b.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],d.prototype,"returnMetadata",
void 0);b.__decorate([h.property({type:[Number],json:{write:!0}})],d.prototype,"size",void 0);b.__decorate([h.property({type:Number,json:{read:{source:"resultOffset"}}})],d.prototype,"start",void 0);b.__decorate([h.writer("start"),h.writer("num")],d.prototype,"writeStart",null);b.__decorate([h.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],d.prototype,"where",void 0);return d=c=b.__decorate([h.subclass("esri.tasks.support.AttachmentQuery")],
d)}(l.JSONSupport);m.from=g.default(m);return m})},"esri/tasks/support/RelationshipQuery":function(){define("require exports tslib ../../geometry ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../layers/support/source/DataLayerSource".split(" "),function(m,a,b,l,k,h,g,d,f){m=function(a){function c(c){c=a.call(this,c)||this;c.dynamicDataSource=void 0;c.gdbVersion=null;c.geometryPrecision=void 0;c.historicMoment=null;c.maxAllowableOffset=
void 0;c.objectIds=null;c.orderByFields=null;c.outFields=null;c.outSpatialReference=null;c.relationshipId=void 0;c.start=void 0;c.num=void 0;c.returnGeometry=!1;c.returnM=void 0;c.returnZ=void 0;c.where=null;return c}b.__extends(c,a);d=c;c.prototype._writeHistoricMoment=function(a,c){c.historicMoment=a&&a.getTime()};c.prototype.writeStart=function(a,c){c.resultOffset=this.start;c.resultRecordCount=this.num||10;c.where="1\x3d1"};c.prototype.clone=function(){return new d(h.clone({dynamicDataSource:this.dynamicDataSource,
gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))};var d;b.__decorate([g.property({type:f.DataLayerSource,
json:{write:!0}})],c.prototype,"dynamicDataSource",void 0);b.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,"gdbVersion",void 0);b.__decorate([g.property({type:Number,json:{write:!0}})],c.prototype,"geometryPrecision",void 0);b.__decorate([g.property({type:Date})],c.prototype,"historicMoment",void 0);b.__decorate([g.writer("historicMoment")],c.prototype,"_writeHistoricMoment",null);b.__decorate([g.property({type:Number,json:{write:!0}})],c.prototype,"maxAllowableOffset",void 0);
b.__decorate([g.property({type:[Number],json:{write:!0}})],c.prototype,"objectIds",void 0);b.__decorate([g.property({type:[String],json:{write:!0}})],c.prototype,"orderByFields",void 0);b.__decorate([g.property({type:[String],json:{write:!0}})],c.prototype,"outFields",void 0);b.__decorate([g.property({type:l.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);b.__decorate([g.property({json:{write:!0}})],c.prototype,"relationshipId",void 0);
b.__decorate([g.property({type:Number,json:{read:{source:"resultOffset"}}})],c.prototype,"start",void 0);b.__decorate([g.writer("start"),g.writer("num")],c.prototype,"writeStart",null);b.__decorate([g.property({type:Number,json:{read:{source:"resultRecordCount"}}})],c.prototype,"num",void 0);b.__decorate([g.property({json:{write:!0}})],c.prototype,"returnGeometry",void 0);b.__decorate([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],c.prototype,"returnM",void 0);
b.__decorate([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],c.prototype,"returnZ",void 0);b.__decorate([g.property({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],c.prototype,"where",void 0);return c=d=b.__decorate([g.subclass("esri.tasks.support.RelationshipQuery")],c)}(k.JSONSupport);m.from=d.default(m);return m})},"esri/layers/graphics/sources/connections/WebSocketConnection":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ./StreamConnection ../../../../tasks/operations/zscale".split(" "),
function(m,a,b,l,k,h,g,d,f,c){Object.defineProperty(a,"__esModule",{value:!0});a.WebSocketConnection=a.ReadyState=void 0;var e=k.getLogger("esri.layers.graphics.sources.connections.WebSocketConnection"),n;(function(a){a[a.CONNECTING=0]="CONNECTING";a[a.OPEN=1]="OPEN";a[a.CLOSING=2]="CLOSING";a[a.CLOSED=3]="CLOSED"})(n=a.ReadyState||(a.ReadyState={}));m=function(a){function f(b){var e=a.call(this)||this;e.errorString=null;var d=b.geometryType,f=b.spatialReference,g=b.sourceSpatialReference;e._config=
b;e._featureZScaler=c.getGeometryZScaler(d,g,f);e._open();return e}b.__extends(f,a);f.prototype._open=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){switch(a.label){case 0:return[4,this._tryCreateWebSocket()];case 1:return a.sent(),this.destroyed?[3,3]:[4,this._handshake()];case 2:a.sent(),a.label=3;case 3:return[2]}})})};f.prototype.destroy=function(){h.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=
null,this._websocket.onmessage=null,this._websocket.close());this._websocket=null};Object.defineProperty(f.prototype,"connectionStatus",{get:function(){if(h.isNone(this._websocket))return"disconnected";switch(this._websocket.readyState){case n.CONNECTING:case n.OPEN:return"connected";case n.CLOSING:case n.CLOSED:return"disconnected"}},enumerable:!1,configurable:!0});f.prototype._tryCreateWebSocket=function(a,c,d){void 0===a&&(a=this._config.source.path);void 0===c&&(c=1E3);void 0===d&&(d=0);return b.__awaiter(this,
void 0,void 0,function(){var f,n,h;return b.__generator(this,function(b){switch(b.label){case 0:b.trys.push([0,2,,4]);if(this.destroyed)return[2];f=this;return[4,this._createWebSocket(a)];case 1:return f._websocket=b.sent(),this.notifyChange("connectionStatus"),[3,4];case 2:n=b.sent();h=c/1E3;if(this._config.maxReconnectionAttempts&&d>=this._config.maxReconnectionAttempts)return e.error(new l("websocket-connection","Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),this.destroy(),
[2];e.error(new l("websocket-connection","Failed to connect. Attempting to reconnect in "+h+"s",n));return[4,g.after(c)];case 3:return b.sent(),[2,this._tryCreateWebSocket(a,Math.min(1.5*c,1E3*this._config.maxReconnectionInterval),d+1)];case 4:return[2]}})})};f.prototype._createWebSocket=function(a){var c=this,b=new WebSocket(a);a=g.create(function(a,c){b.onopen=function(){return a(b)};b.onclose=function(a){return c(a)}});a.then(function(){c.destroyed?(b.onclose=function(){},b.close()):(b.onclose=
function(a){return c._onClose(a)},b.onerror=function(a){return c._onError(a)},b.onmessage=function(a){return c._onMessage(a)})});return a};f.prototype._handshake=function(a){void 0===a&&(a=1E4);return b.__awaiter(this,void 0,void 0,function(){var c,d,f,n,k,p,t,m=this;return b.__generator(this,function(b){c=this._websocket;if(h.isNone(c))return[2];d=g.createResolver();f=c.onmessage;n=this._config;k=n.filter;p=n.outFields;t=n.spatialReference;d.timeout(a);c.onmessage=function(a){var b,g=null;try{g=
JSON.parse(a.data)}catch(I){}g&&"object"===typeof g||(e.error(new l("websocket-connection","Protocol violation. Handshake failed - malformed message",a.data)),d.reject(),m.destroy());(null===(b=g.spatialReference)||void 0===b?void 0:b.wkid)!==(null===t||void 0===t?void 0:t.wkid)&&(e.error(new l("websocket-connection","Protocol violation. Handshake failed - expected wkid of "+t.wkid,a.data)),d.reject(),m.destroy());"json"!==g.format&&(e.error(new l("websocket-connection","Protocol violation. Handshake failed - format is not set",
a.data)),d.reject(),m.destroy());k&&g.filter!==k&&e.error(new l("websocket-connection","Tried to set filter, but server doesn't support it"));p&&g.outFields!==p&&e.error(new l("websocket-connection","Tried to set outFields, but server doesn't support it"));c.onmessage=f;d.resolve()};c.send(JSON.stringify({filter:k,outFields:p,format:"json",spatialReference:{wkid:t.wkid}}));return[2,d.promise]})})};f.prototype._onMessage=function(a){try{var c=JSON.parse(a.data);if("featureResult"!==c.type)throw new l("websocket-connection",
"Protocol violation - Expected to find message of type 'featureResult'",c);a=0;for(var b=c.features;a<b.length;a++){var d=b[a];this._featureZScaler&&this._featureZScaler(d.geometry);this.onFeature(d)}}catch(w){e.error(new l("websocket-connection","Failed to parse message",w)),this.destroy()}};f.prototype._onError=function(a){this._set("errorString","Encountered an error over WebSocket connection");e.error("websocket-connection","Encountered an error over WebSocket connection")};f.prototype._onClose=
function(a){this._websocket=null;this.notifyChange("connectionStatus");1E3!==a.code&&e.error("websocket-connection","WebSocket closed unexpectedly with error code "+a.code);this.destroyed||this._open()};b.__decorate([d.property()],f.prototype,"connectionStatus",null);b.__decorate([d.property()],f.prototype,"errorString",void 0);return f=b.__decorate([d.subclass("esri.layers.graphics.sources.connections.WebSocketConnection")],f)}(f.default);a.WebSocketConnection=m})},"esri/layers/graphics/sources/connections/StreamConnection":function(){define("require exports tslib ../../../../core/Evented ../../../../core/HandleOwner ../../../../core/accessorSupport/decorators".split(" "),
function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});m=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}b.__extends(d,a);d.prototype.onFeature=function(a){this.emit("feature",a)};return d=b.__decorate([h.subclass("esri.layers.graphics.sources.connections.StreamConnection")],d)}(l.EventedMixin(k.HandleOwner));a.default=m})},"esri/views/2d/layers/features/sources/PagedFeatureSource":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/Logger ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.PagedFeatureSource=void 0;var d=k.getLogger("esri.views.2d.layers.features.sources.FeatureSource");m=function(a){function c(c){return a.call(this,c)||this}b.__extends(c,a);c.prototype._fetchDataTile=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,e,f,g,k,u,m,w,B,z,A,C,E,D=this;return b.__generator(this,function(b){switch(b.label){case 0:c=6,e=20,f=this._subscriptions.get(a.key.id),g=!1,u=k=0,m=function(c,
b){u--;h.throwIfAborted(f);var e=c.reader;c=c.query;e.exceededTransferLimit?b={tile:a,id:a.id,features:e,end:g&&0===u}:(g=!0,b={tile:a,id:a.id,features:e,end:0===u});f.requests.done.push({request:b,query:c});D._onRequest(b,"new")},B=w=0,b.label=1;case 1:if(g||!(B++<e))return[3,3];z=void 0;A=function(c){var b=k++;u++;z=C._fetchDataTilePage(a,b,f).then(function(a){return a&&m(a,b)}).catch(function(c){g=!0;h.isAbortError(c)||(d.error(new l("mapview-query-error","Encountered error when fetching tile",
{tile:a,error:c})),D._onRequest({tile:a,id:a.id,features:null,end:g},"new"))})};C=this;for(E=0;E<w+1;E++)A(E);return[4,z];case 2:return b.sent(),h.throwIfAborted(f),w=Math.min(w+2,c),[3,1];case 3:return[2]}})})};c.prototype._fetchDataTilePage=function(a,c,d){return b.__awaiter(this,void 0,void 0,function(){var e,f,g,n,k;return b.__generator(this,function(b){switch(b.label){case 0:e=this._sourceQueryInfo,f=this._createQuery(a,{start:8E3*c,num:8E3,maxRecordCountFactor:3,returnExceededLimitFeatures:!0,
quantizationParameters:a.getQuantizationParameters()}),b.label=1;case 1:return b.trys.push([1,3,,4]),g=d.signal,[4,this._queue.push({tile:a,query:f,signal:g,depth:c})];case 2:return n=b.sent(),h.throwIfAborted(d),n?e!==this._sourceQueryInfo?[2,this._fetchDataTilePage(a,c,d)]:[2,{reader:n,query:f}]:[2,null];case 3:return k=b.sent(),h.throwIfNotAbortError(k),[2,null];case 4:return[2]}})})};return c}(g.BaseFeatureSource);a.PagedFeatureSource=m})},"esri/views/2d/layers/features/support/UpdateToken":function(){define(["require",
"exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.UpdateToken=void 0;m=function(){function a(){this.source=!1;this.targets={feature:!1,aggregate:!1};this.storage={filters:!1,data:!1};this.queryFilter=this.mesh=!1;this.why={mesh:[],source:[]}}a.create=function(b){var k=new a,h;for(h in b){var g=b[h];if("object"===typeof g)for(var d in g)k[h][d]=g[d];k[h]=g}return k};a.empty=function(){return a.create({})};a.all=function(){return a.create({source:!0,targets:{feature:!0,aggregate:!0},
storage:{filters:!0,data:!0},mesh:!0})};a.prototype.any=function(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||this.queryFilter};a.prototype.describe=function(){var a=0,b="";if(this.mesh)for(var a=a+20,b=b+"-\x3e (20) Mesh needs update\n",h=0,g=this.why.mesh;h<g.length;h++)var d=g[h],b=b+("    + "+d+"\n");if(this.source)for(a+=10,b+="-\x3e (10) The source needs update\n",h=0,g=this.why.source;h<g.length;h++)d=g[h],b+="    + "+
d+"\n";this.targets.feature&&(a+=5,b+="-\x3e (5) Feature target parameters changed\n");this.storage.filters&&(a+=5,b+="-\x3e (5) Feature filter parameters changed\n");this.targets.aggregate&&(a+=4,b+="-\x3e (4) Aggregate target parameters changed\n");this.storage.data&&(a+=1,b+="-\x3e (1) Texture storage parameters changed");console.debug("Applying "+(5>a?"Fastest":10>a?"Fast":15>a?"Moderate":20>a?"Slow":"Very Slow")+" update of cost "+a+"/45 ");console.debug(b)};a.prototype.toJSON=function(){return{source:this.source,
targets:this.targets,storage:this.storage,mesh:this.mesh,queryFilter:this.queryFilter}};return a}();a.UpdateToken=m})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p){function q(a,c){return function(b){return c(a(b))}}Object.defineProperty(a,"__esModule",{value:!0});a.isAggregateId=a.DISPLAY_ID_TYPE_AGGREGATE=a.DISPLAY_ID_TYPE_FEATURE=void 0;var u=h.getLogger("esri.views.layers.2d.features.support.AttributeStore"),y=x.createDebugLogger(x.DEBUG_ATTR_UPDATES,u);a.DISPLAY_ID_TYPE_FEATURE=0;a.DISPLAY_ID_TYPE_AGGREGATE=1;a.isAggregateId=function(c){return(c&2147483648)>>>31===a.DISPLAY_ID_TYPE_AGGREGATE};var w=k("esri-shared-array-buffer"),
B=k("esri-webgl-texture-float"),z=k("esri-webgl-max-texture-size"),A=k("esri-atomics"),C=function(){function a(a,c,b,e){this.size=0;this.texelSize=4;var d=e.pixelType,f=e.layout;this.textureOnly=(e=e.textureOnly)||!1;this.pixelType=d;this._ctype=c;this.layout=f;this._resetRange();this._shared=a;this.size=b;e||(this.data=this._initData(d,b,a,c))}Object.defineProperty(a.prototype,"buffer",{get:function(){return d.andThen(this.data,function(a){return a.buffer})},enumerable:!1,configurable:!0});a.prototype.unsetComponentAllTexels=
function(a,c){for(var b=d.unwrap(this.data),e=0;e<this.size*this.size;e++)b[e*this.texelSize+a]&=~c;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};a.prototype.setComponentAllTexels=function(a,c){for(var b=d.unwrap(this.data),e=0;e<this.size*this.size;e++)b[e*this.texelSize+a]|=255&c;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};a.prototype.setComponent=function(a,c,b){for(var e=d.unwrap(this.data),f=0;f<b.length;f++){var g=b[f];e[g*this.texelSize+a]|=c;this.dirtyStart=Math.min(this.dirtyStart,
g);this.dirtyEnd=Math.max(this.dirtyEnd,g)}};a.prototype.setComponentTexel=function(a,c,b){d.unwrap(this.data)[b*this.texelSize+a]|=c;this.dirtyStart=Math.min(this.dirtyStart,b);this.dirtyEnd=Math.max(this.dirtyEnd,b)};a.prototype.unsetComponentTexel=function(a,c,b){d.unwrap(this.data)[b*this.texelSize+a]&=~c;this.dirtyStart=Math.min(this.dirtyStart,b);this.dirtyEnd=Math.max(this.dirtyEnd,b)};a.prototype.getData=function(a,c){a&=2147483647;return d.unwrap(this.data)[a*this.texelSize+c]};a.prototype.setData=
function(a,c,b){a&=2147483647;0===(this.layout&1<<c)?u.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[a*this.texelSize+c]=b,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.lock=function(){5121===this.pixelType&&this._shared&&A&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};a.prototype.unlock=function(){5121===this.pixelType&&this._shared&&A&&"local"!==this._ctype&&Atomics.store(this.data,
0,0)};a.prototype.expand=function(a){this.size=a;if(!this.textureOnly){a=this._initData(this.pixelType,a,this._shared,this._ctype);var c=d.unwrap(this.data);a.set(c);this.data=a}};a.prototype.toMessage=function(){var a=this.dirtyStart,c=this.dirtyEnd,b=this.texelSize;if(a>c)return null;this._resetRange();var e=!this._shared&&"local"!==this._ctype,f=this.pixelType,g=this.layout,n=d.unwrap(this.data);if(!n.slice){if(!e)return{start:a,end:c,data:null,pixelType:f,layout:g};b=new (t.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,
a*b,(c+1)*b));return{start:a,end:c,data:b,pixelType:f,layout:g}}b=e&&n.slice(a*b,(c+1)*b)||null;return{start:a,end:c,data:b,pixelType:f,layout:g}};a.prototype._initData=function(a,c,b,e){b=b&&"local"!==e?SharedArrayBuffer:ArrayBuffer;a=t.getPixelArrayCtor(a);c=new a(new b(c*c*4*a.BYTES_PER_ELEMENT));for(a=0;a<c.length;a+=4)c[a+1]=255;return c};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};return a}();h=function(){function h(a){this._attributeComputeMap=new Map;this._blocks=
[];this._filters=Array(n.MAX_FILTERS);this._targetType=0;this._abortController=f.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;var c=B?5126:5121;y("Creating AttributeStore "+(w?"with":"without")+" shared memory");this._client=a;this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:c,layout:15},{pixelType:c,layout:15}];this._blocks=this._blockDescriptors.map(function(){return null})}h.prototype.destroy=function(){this._abortController.abort()};
Object.defineProperty(h.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!1,configurable:!0});Object.defineProperty(h.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!1,configurable:!0});h.prototype.update=function(b,e){var f=c.diff(this._schema,e);if(b.targets.feature||b.targets.aggregate)b.storage.data=!0;if(f&&(k("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",f),b.storage.data=!0,this._schema=e,this._attributeComputeMap.clear(),
!d.isNone(e))){switch(e.target){case "feature":this._targetType=a.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=a.DISPLAY_ID_TYPE_AGGREGATE}b=0;for(e=e.mapping;b<e.length;b++)this._bindAttribute(e[b])}};h.prototype.onTileData=function(a,c){if(!d.isNone(c.addOrUpdate))for(a=c.addOrUpdate.getCursor();a.next();)c=a.getDisplayId(),this.setAttributeData(c,a)};h.prototype.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=
f.createAbortController()};h.prototype.setHighlight=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,f,g,n;return b.__generator(this,function(b){switch(b.label){case 0:e=this._getBlock(0);d=c.map(function(a){return a&2147483647});e.lock();e.unsetComponentAllTexels(0,1);e.setComponent(0,1,d);e.unlock();this._idsToHighlight.clear();f=0;for(g=a;f<g.length;f++)n=g[f],this._idsToHighlight.add(n);return[4,this.sendUpdates()];case 1:return b.sent(),[2]}})})};h.prototype.updateFilters=
function(a,c){return b.__awaiter(this,void 0,void 0,function(){var e,d,g,n,h,l,p,q=this;return b.__generator(this,function(b){switch(b.label){case 0:return e=c.config,d=c.service,g=c.spatialReference,n=e.filters,h=n.map(function(a,c){return q._updateFilter(a,c,d,g)}),[4,f.all(h)];case 1:l=b.sent();if(p=l.some(function(a){return a}))a.storage.filters=!0,k("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed");return[2]}})})};h.prototype.setData=function(a,c,b,
e){this._ensureSizeForTexel(a&2147483647);this._getBlock(c).setData(a,b,e)};h.prototype.getData=function(a,c,b){return this._getBlock(c).getData(a,b)};h.prototype.getHighlightFlag=function(a){return this._idsToHighlight.has(a)?n.HIGHLIGHT_FLAG:0};h.prototype.setAttributeData=function(a,c){var b=this,e=a&2147483647;this._ensureSizeForTexel(e);this._getBlock(0).setData(e,0,this.getFilterFlags(c));if(this._targetType===(a&2147483648)>>>31){a=this._attributeComputeMap;var d=B?1:2;a.size&&a.forEach(function(a,
f){var h=f*d%4;f=b._getBlock(Math.floor(f*d/4)+n.ATTRIBUTE_DATA_VV);a=a(c);if(B)f.setData(e,h,a);else if(a===n.NAN_MAGIC_NUMBER)f.setData(e,h,255),f.setData(e,h+1,255);else{a=g.clamp(Math.round(a),-32767,32766)+32768;var k=(a&65280)>>8;f.setData(e,h,a&255);f.setData(e,h+1,k)}})}};h.prototype.sendUpdates=function(){var a=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=f.createResolver(),this._nextUpdate.promise;var c={blocks:this._blocks.map(function(a){return d.isSome(a)?
a.toMessage():null})};return this._currUpdate=this._createResources().then(function(){var b=function(){a._currUpdate=null;if(a._nextUpdate){var c=a._nextUpdate;a._nextUpdate=null;a.sendUpdates().then(function(){return c.resolve()})}},b=a._client.update(c,a._signal).then(b).catch(b);a._client.render(a._signal);return b}).catch(function(c){if(f.isAbortError(c))return a._createResourcesPromise=null,a._createResources();u.error(new l("mapview-attribute-store","Encountered an error during client update",
c));return f.resolve()})};h.prototype._ensureSizeForTexel=function(a){for(;a>=this._size*this._size&&!this._expand(););};h.prototype._bindAttribute=function(a){function c(){return a.normalizationField?function(c){var b=c.readAttribute(a.normalizationField);return b?c.readAttribute(a.field)/b:null}:function(c){return c.readAttribute(a.field)}}function b(){a.normalizationField&&u.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return function(c){return c.getComputedNumericAtIndex(a.fieldIndex)}}
var e;if(null!=a.fieldIndex)e=b();else if(a.field)e=c();else return;a.valueRepresentation&&(e=q(e,function(c){return p.getVisualVariableSizeValueRepresentationRatio(c,a.valueRepresentation)}));this._attributeComputeMap.set(a.binding,q(e,function(a){return null===a||isNaN(a)||Infinity===a?n.NAN_MAGIC_NUMBER:a}))};h.prototype._createResources=function(){var a=this;if(d.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(n.ATTRIBUTE_DATA_ANIMATION);y("Initializing AttributeStore");
var c={shared:w&&"local"!==this._client.type,size:this._size,blocks:d.mapMany(this._blocks,function(a){return{textureOnly:a.textureOnly,buffer:a.buffer,pixelType:a.pixelType}})};this._createResourcesPromise=c=this._client.initialize(c,this._signal).catch(function(c){f.isAbortError(c)?a._createResourcesPromise=null:u.error(new l("mapview-attribute-store","Encountered an error during client initialization",c))});c.then(function(){return d.isNone(a._createResourcesPromise)?a._createResources():void 0});
return c};h.prototype._getBlock=function(a){var c=this._blocks[a];if(d.isSome(c))return c;y("Initializing AttributeBlock at index "+a);c=new C(w,this._client.type,this._size,this._blockDescriptors[a]);this._blocks[a]=c;this._createResourcesPromise=null;return c};h.prototype._expand=function(){if(this._size<z){var a=this._size<<=1;y("Expanding block size to",a,this._blocks);d.forEachSome(this._blocks,function(c){return c.expand(a)});this._createResourcesPromise=null;this._size=a;return 0}u.error(new l("mapview-limitations",
"Maximum number of onscreen features exceeded."));return-1};h.prototype._updateFilter=function(a,c,e,f){return b.__awaiter(this,void 0,void 0,function(){var g,n,h,k,l;return b.__generator(this,function(b){switch(b.label){case 0:return g=this._filters[c],n=d.isSome(g)&&g.hash,!g&&!a||n===JSON.stringify(a)?[2,!1]:d.isNone(a)?(h=1<<c+1,k=this._getBlock(0),this._filters[c]=null,k.setComponentAllTexels(0,h),this.sendUpdates(),[2,!0]):[4,this._getFilter(c,e)];case 1:return l=b.sent(),[4,l.update(a,f)];
case 2:return b.sent(),[2,!0]}})})};h.prototype._getFilter=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var f,g,n;return b.__generator(this,function(b){switch(b.label){case 0:return f=this._filters[a],d.isSome(f)?[2,f]:[4,new Promise(function(a,c){m(["../../../../../layers/graphics/data/FeatureFilter"],a,c)})];case 1:return g=b.sent().default,n=new g({geometryType:c.geometryType,hasM:!1,hasZ:!1,timeInfo:c.timeInfo,fieldsIndex:new e(c.fields)}),this._filters[a]=n,[2,n]}})})};h.prototype.isVisible=
function(a){return!!(this._getBlock(0).getData(a,0)&2)};h.prototype.getFilterFlags=function(c){var b=0,e;e=(c.getDisplayId()&2147483648)>>>31===a.DISPLAY_ID_TYPE_AGGREGATE?254:255;for(var f=0;f<this._filters.length;f++)var g=this._filters[f],g=!(e&1<<f)||d.isNone(g)||g.check(c),b=b|(g?1:0)<<f;e=0;this._idsToHighlight.size&&(c=c.getObjectId(),e=this.getHighlightFlag(c));return b<<1|e};return h}();a.default=h})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){function n(a){for(var c={},b=0;b<a.length;b++){var e=a[b];c[e.name]=e.strideInBytes}return c}function t(a){switch(a){case c.WGLGeometryType.MARKER:return w;case c.WGLGeometryType.FILL:return B;case c.WGLGeometryType.LINE:return z;case c.WGLGeometryType.TEXT:return A;case c.WGLGeometryType.LABEL:return C}}function x(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function p(a){switch(a){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}
function q(a){var c={},e=function(e){var d=0;c[e]=a[e].map(function(a){var c=b.__assign(b.__assign({},a),{normalized:a.normalized||!1,divisor:a.divisor||0,offset:d,stride:0});d+=a.count*p(a.type);return c});c[e].forEach(function(a){return a.stride=d})},d;for(d in a)e(d);return c}var u;Object.defineProperty(a,"__esModule",{value:!0});a.createProgramDescriptor=a.getPixelArrayCtor=a.getPixelBytes=a.getBytes=a.geometryToMappedGeometry=a.createTextureFromTexelData=a.createGeometryData=a.C_VBO_INFO=a.copyMeshData=
a.getTransformParams=a.getVVType=a.getJoinType=a.getCapType=a.isNumber=a.isDefined=a.getTextProperties=a.allocateTypedArrayBufferwithData=a.allocateTypedArrayBuffer=a.strideToPackingFactor=a.getNamedBuffers=a.getStrides=a.C_LABEL_STRIDE_SPEC=a.C_TEXT_STRIDE_SPEC=a.C_LINE_STRIDE_SPEC=a.C_FILL_STRIDE_SPEC_DD=a.C_FILL_STRIDE_SPEC=a.C_ICON_STRIDE_SPEC=a.C_LABEL_VERTEX_DEF=a.C_TEXT_VERTEX_DEF=a.C_LINE_VERTEX_DEF=a.C_FILL_VERTEX_DEF_DD=a.C_FILL_VERTEX_DEF=a.C_ICON_VERTEX_DEF=a.C_VBO_PERINSTANCE_VV=a.C_VBO_PERINSTANCE=
a.C_VBO_GEOMETRY=void 0;var y=k.getLogger("esri.views.2d.engine.webgl.Utils");a.C_VBO_GEOMETRY="geometry";a.C_VBO_PERINSTANCE="per_instance";a.C_VBO_PERINSTANCE_VV="per_instance_vv";a.C_ICON_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF_DD=[{name:a.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];a.C_LINE_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_TEXT_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,
strideInBytes:32,divisor:0}];a.C_LABEL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_ICON_STRIDE_SPEC=n(a.C_ICON_VERTEX_DEF);a.C_FILL_STRIDE_SPEC=n(a.C_FILL_VERTEX_DEF);a.C_FILL_STRIDE_SPEC_DD=n(a.C_FILL_VERTEX_DEF_DD);a.C_LINE_STRIDE_SPEC=n(a.C_LINE_VERTEX_DEF);a.C_TEXT_STRIDE_SPEC=n(a.C_TEXT_VERTEX_DEF);a.C_LABEL_STRIDE_SPEC=n(a.C_LABEL_VERTEX_DEF);a.getStrides=function(b,e){switch(b){case c.WGLGeometryType.MARKER:return a.C_ICON_STRIDE_SPEC;case c.WGLGeometryType.FILL:return e?
a.C_FILL_STRIDE_SPEC_DD:a.C_FILL_STRIDE_SPEC;case c.WGLGeometryType.LINE:return a.C_LINE_STRIDE_SPEC;case c.WGLGeometryType.TEXT:return a.C_TEXT_STRIDE_SPEC;case c.WGLGeometryType.LABEL:return a.C_LABEL_STRIDE_SPEC}};var w=[a.C_VBO_GEOMETRY],B=[a.C_VBO_GEOMETRY],z=[a.C_VBO_GEOMETRY],A=[a.C_VBO_GEOMETRY],C=[a.C_VBO_GEOMETRY];a.getNamedBuffers=t;a.strideToPackingFactor=x;a.allocateTypedArrayBuffer=function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(Math.floor(a*c/4));case 1:case 3:return new Uint8Array(a*
c)}};a.allocateTypedArrayBufferwithData=function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};a.getTextProperties=function(a){return e.TextProperties.pool.acquire(a.color?f.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?f.copyAndPremultiply(a.haloColor):[255,255,255,255],g.pt2px(a.haloSize),g.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?
1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};a.isDefined=function(a){return null!=a};a.isNumber=function(a){return"number"===typeof a};a.getCapType=function(a,c){switch(a){case "butt":return 0;case "round":return c?2:1;case "square":return 2;default:return y.error(new l("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),1}};a.getJoinType=function(a){switch(a){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return y.error(new l("mapview-invalid-type",
"Join type "+a+" is not a valid option. Defaulting to round")),1}};a.getVVType=function(a){switch(a){case "opacity":return c.VVType.OPACITY;case "color":return c.VVType.COLOR;case "rotation":return c.VVType.ROTATION;case "size":return c.VVType.SIZE;default:return y.error("Cannot interpret unknown vv: "+a),null}};a.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};a.copyMeshData=function(a,c,b,e,d,f,g){for(var n in f)for(var h=f[n].stride,k=x(h),l=f[n].data,p=b[n].data,
q=h*d.vertexCount/k,t=h*a/k,k=h*d.vertexFrom/k,h=0;h<q;++h)p[h+t]=l[h+k];b=d.indexCount;for(h=0;h<b;++h)e[h+c]=g[h+d.indexFrom]-d.vertexFrom+a};a.C_VBO_INFO=(u={},u[a.C_VBO_GEOMETRY]=35044,u);a.createGeometryData=function(a,c){for(var b=[],e=0;5>e;++e){for(var d={},f=0,g=t(e);f<g.length;f++){var n=g[f];d[n]={data:c(e,n)}}b.push({data:a(e),buffers:d})}return b};a.createTextureFromTexelData=function(a,c){var b,e;h.isPowerOfTwo(c.width)&&h.isPowerOfTwo(c.height)?(b=!0,e=9987):(b=!1,e=9729);return new d.Texture(a,
{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:b,samplingMode:e,wrapMode:33071,flipped:!0},c)};a.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};a.getBytes=p;a.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:y.error(new l("webgl-utils","Unable to handle type "+a))}};a.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;
default:y.error(new l("webgl-utils","Unable to handle type "+a))}};var E=new Map;a.createProgramDescriptor=function(a,c){if(!E.has(a)){var b=q(c),e={},d;for(d in b){var f=b[d];e[d]=f.length?f[0].stride:0}d={};for(var g in c)for(var f=0,n=c[g];f<n.length;f++){var h=n[f];d[h.name]=h.location}E.set(a,{strides:e,bufferLayouts:b,attributes:d})}return E.get(a)}})},"esri/views/webgl":function(){define("require exports ./webgl/BufferObject ./webgl/FramebufferObject ./webgl/Program ./webgl/Renderbuffer ./webgl/RenderingContext ./webgl/ShaderCompiler ./webgl/Texture ./webgl/VertexArrayObject ./webgl/ProgramCache ./webgl/programUtils ./webgl/context-util".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){Object.defineProperty(a,"__esModule",{value:!0});a.Renderbuffer=a.ShaderCompiler=a.Program=a.FramebufferObject=a.VertexArrayObject=a.Texture=a.RenderingContext=a.BufferObject=void 0;a.BufferObject=b;a.FramebufferObject=l;a.Program=k;a.Renderbuffer=h;a.RenderingContext=g;a.ShaderCompiler=d;a.Texture=f;a.VertexArrayObject=c;Object.defineProperty(a,"ProgramCache",{enumerable:!0,get:function(){return e.ProgramCache}});Object.defineProperty(a,"createProgram",{enumerable:!0,
get:function(){return n.createProgram}});Object.defineProperty(a,"glslifyDefineMap",{enumerable:!0,get:function(){return n.glslifyDefineMap}});Object.defineProperty(a,"createContextOrErrorHTML",{enumerable:!0,get:function(){return t.createContextOrErrorHTML}})})},"esri/views/webgl/BufferObject":function(){define(["require","exports","../../core/maybe","../../core/typedArrayUtil"],function(m,a,b,l){return function(){function a(h,g,d,f,c){this._glName=this._context=null;this._bufferType=void 0;this._usage=
35044;this._size=-1;this._indexType=void 0;this._context=h;this._bufferType=g;this._usage=d;this._id=a._nextId++;this._glName=this._context.gl.createBuffer();b.isSome(h.instanceCounter)&&h.instanceCounter.increment(1,this);f&&this.setData(f,c)}a.createIndex=function(b,g,d,f){return new a(b,34963,g,d,f)};a.createVertex=function(b,g,d){return new a(b,34962,g,d)};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"glName",{get:function(){return this._glName},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"usage",{get:function(){return this._usage},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"indexType",{get:function(){return this._indexType},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!1,configurable:!0});a.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),b.isSome(this._context.instanceCounter)&&this._context.instanceCounter.decrement(1,this),this._context=null)};a.prototype.setData=function(a,b){if(a){if("number"===
typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&b)switch(this._indexType=b,this._size=a,b){case 5123:a*=2;break;case 5125:a*=4}}else b=a.byteLength,l.isUint16Array(a)&&(b/=2,this._indexType=5123),l.isUint32Array(a)&&(b/=4,this._indexType=5125),this._size=b;b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(b)}};a.prototype.setSubData=
function(a,b,d,f){void 0===b&&(b=0);void 0===d&&(d=0);if(a){(0>b||b>=this._size)&&console.error("offset is out of range!");var c=b,e=d,g=f,h=a.byteLength;l.isUint16Array(a)&&(h/=2,c*=2,e*=2,g*=2);l.isUint32Array(a)&&(h/=4,c*=4,e*=4,g*=4);void 0===f&&(f=h-1);d>=f&&console.error("end must be bigger than start!");b+d-f>this._size&&console.error("An attempt to write beyond the end of the buffer!");b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);d=this._context.gl;
a=ArrayBuffer.isView(a)?a.buffer:a;d.bufferSubData(this._bufferType,c,a.slice(e,g));this._context.bindVAO(b)}};a._nextId=0;return a}()})},"esri/views/webgl/FramebufferObject":function(){define("require exports tslib ../../core/has ../../core/Logger ../../core/maybe ./Renderbuffer ./Texture".split(" "),function(m,a,b,l,k,h,g,d){var f=k.getLogger("esri.views.webgl.FrameBufferObject");return function(){function a(c,f,k,l){var e,n;this._stencilAttachment=this._depthAttachment=this._glName=this._context=
null;this._colorAttachments=new Map;this._initialized=!1;this._context=c;this._desc=b.__assign({},f);this._id=a._nextId++;h.isSome(c.instanceCounter)&&c.instanceCounter.increment(4,this);if(k){var t=void 0;if(Array.isArray(k))for(e=0;e<k.length;e++){t=k[e];f=t.attachmentPoint;var t=t.texture,m=t instanceof d?t:new d(c,t),t=m.descriptor;this._colorAttachments.set(f,m);this._validateColorAttachmentPoint(f);this._validateTextureDimensions(t,this._desc)}else k instanceof d?(t=k.descriptor,this._colorAttachments.set(36064,
k)):(t=k,this._colorAttachments.set(36064,new d(c,k))),0!==(null===(e=this._desc)||void 0===e?void 0:e.colorTarget)&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),this._validateTextureDimensions(t,this._desc)}l instanceof g?(c=null!==(n=this._desc.depthStencilTarget)&&void 0!==n?n:3,2===c?this._stencilAttachment=l:1===c||3===c?this._depthAttachment=l:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),
a._validateBufferDimensions(l.descriptor,this._desc)):l&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),n=void 0,l instanceof d?(this._depthStencilTexture=l,n=this._depthStencilTexture.descriptor):(n=l,this._depthStencilTexture=new d(this._context,n)),this._validateTextureDimensions(n,this._desc))}a.prototype.dispose=function(){if(this._context){var a=this._context,
c=a.getBoundFramebufferObject();this._disposeColorAttachments();this._disposeDepthStencilAttachments();this._glName&&(a.gl.deleteFramebuffer(this._glName),this._glName=null);h.isSome(a.instanceCounter)&&a.instanceCounter.decrement(4,this);a.bindFramebuffer(c);this._context=null}};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"descriptor",{get:function(){return this._desc},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"colorTexture",{get:function(){var a=this._colorAttachments.get(36064);return a&&a instanceof d?a:null},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"colorAttachment",{get:function(){return this._colorAttachments.get(36064)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"depthStencilAttachment",{get:function(){return this._depthStencilTexture||
this._depthAttachment||this._stencilAttachment},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this._desc.width},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._desc.height},enumerable:!1,configurable:!0});a.prototype.getColorTexture=function(a){return(a=this._colorAttachments.get(a))&&
a instanceof d?a:null};a.prototype.attachColorTexture=function(a,c){void 0===c&&(c=36064);if(a){this._validateColorAttachmentPoint(c);this._validateTextureDimensions(a.descriptor,this._desc);this._disposeColorAttachments();if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferTexture2D(b.FRAMEBUFFER,c,b.TEXTURE_2D,a.glName,0)}this._colorAttachments.set(c,a)}};a.prototype.detachColorTexture=function(a){void 0===a&&(a=36064);var c=this._colorAttachments.get(a);
if(c instanceof d){if(this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferTexture2D(b.FRAMEBUFFER,a,b.TEXTURE_2D,null,0)}this._colorAttachments.delete(a);return c}};a.prototype.attachDepthStencilTexture=function(a){if(a){var c=a.descriptor;34041!==c.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==c.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");this._context.capabilities.depthTexture||
console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");this._validateTextureDimensions(c,this._desc);this._desc.depthStencilTarget&&4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),c=this._context.gl,c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,a.glName,0));this._depthStencilTexture=
a}};a.prototype.detachDepthStencilTexture=function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;this._context.gl.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return a};a.prototype.attachDepthStencilBuffer=function(c){if(c){var b=c.descriptor;34041!==b.internalFormat&&33189!==b.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");
a._validateBufferDimensions(b,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===b.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),b=this._context.gl,b.framebufferRenderbuffer(b.FRAMEBUFFER,1===this._desc.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,c.glName));this._depthAttachment=c}};a.prototype.detachDepthStencilBuffer=function(){var a=this._context.gl,c=this._depthAttachment;c&&this._initialized&&
(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null));this._depthAttachment=null;return c};a.prototype.copyToTexture=function(a,c,b,d,f,g,h){(0>a||0>c||0>f||0>g)&&console.error("Offsets cannot be negative!");(0>=b||0>=d)&&console.error("Copy width and height must be greater than zero!");var e=this._desc,n=h.descriptor;3553!==h.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");
(a+b>e.width||c+d>e.height||f+b>n.width||g+d>n.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");e=this._context;e.bindTexture(h);e.bindFramebuffer(this);e.gl.copyTexSubImage2D(3553,0,f,g,a,c,b,d)};a.prototype.readPixels=function(a,c,b,d,f,g,h){(0>=b||0>=d)&&console.error("Copy width and height must be greater than zero!");h||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(a,
c,b,d,f,g,h)};a.prototype.resize=function(a,c){var b=this._desc;if(b.width!==a||b.height!==c)if(this._initialized){b.width=a;b.height=c;this._colorAttachments.forEach(function(b){b&&b.resize(a,c)});if(null!=this._depthStencilTexture)this._depthStencilTexture.resize(a,c);else if(this._depthAttachment||this._stencilAttachment)this._depthAttachment&&this._depthAttachment.resize(a,c),this._stencilAttachment&&this._stencilAttachment.resize(a,c);this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null);
this._initialized=!1}else b.width=a,b.height=c,this._colorAttachments.forEach(function(b){b&&b.resize(a,c)}),this._depthStencilTexture&&this._depthStencilTexture.resize(a,c)};a.prototype.initialize=function(){var a,c,b,f;if(this._initialized)return!1;var h=this._context,k=h.gl;this._glName&&k.deleteFramebuffer(this._glName);var l=k.createFramebuffer(),m=this._desc,w=null!==(a=m.colorTarget)&&void 0!==a?a:1;a=null!==(c=m.width)&&void 0!==c?c:1;c=null!==(b=m.height)&&void 0!==b?b:1;k.bindFramebuffer(k.FRAMEBUFFER,
l);0===this._colorAttachments.size&&(0===w?this._colorAttachments.set(36064,new d(h,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:m.width,height:m.height})):(b=new g(h,{internalFormat:32854,width:a,height:c}),this._colorAttachments.set(36064,b)));this._colorAttachments.forEach(function(a,c){a&&(a instanceof d?k.framebufferTexture2D(k.FRAMEBUFFER,c,k.TEXTURE_2D,a.glName,0):k.framebufferRenderbuffer(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.RENDERBUFFER,a.glName))});b=
null!==(f=m.depthStencilTarget)&&void 0!==f?f:0;switch(b){case 1:case 3:this._depthAttachment||(this._depthAttachment=new g(h,{internalFormat:1===m.depthStencilTarget?33189:34041,width:a,height:c}));k.framebufferRenderbuffer(k.FRAMEBUFFER,1===b?k.DEPTH_ATTACHMENT:k.DEPTH_STENCIL_ATTACHMENT,k.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new g(h,{internalFormat:36168,width:a,height:c}));k.framebufferRenderbuffer(k.FRAMEBUFFER,k.STENCIL_ATTACHMENT,
k.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:this._depthStencilTexture||(h.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new d(h,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:a,height:c})),k.framebufferTexture2D(k.FRAMEBUFFER,k.DEPTH_STENCIL_ATTACHMENT,k.TEXTURE_2D,this._depthStencilTexture.glName,
0)}this._glName=l;return this._initialized=!0};a.prototype._disposeColorAttachments=function(){var a=this;this._colorAttachments.forEach(function(c,b){if(c instanceof d){if(a._initialized){a._context.bindFramebuffer(a);var e=a._context.gl;e.framebufferTexture2D(e.FRAMEBUFFER,b,e.TEXTURE_2D,null,0)}c.dispose()}else c instanceof WebGLRenderbuffer&&(e=a._context.gl,a._initialized&&(a._context.bindFramebuffer(a),e.framebufferRenderbuffer(e.FRAMEBUFFER,b,e.RENDERBUFFER,null)),a._context.gl.deleteRenderbuffer(c))});
this._colorAttachments.clear()};a.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;this._depthAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,
a.STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};a._validateBufferDimensions=function(a,c){console.assert(0<=a.width&&0<=a.height);void 0!==c.width&&0<=c.width&&void 0!==c.height&&0<=c.height?c.width===a.width&&
c.height===a.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(c.width=a.width,c.height=a.height)};a.prototype._validateTextureDimensions=function(a,c){console.assert(0<=a.width&&0<=a.height);3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==c.width&&0<=c.width&&void 0!==c.height&&0<=c.height?c.width===a.width&&c.height===a.height||console.error("Color attachment texture must match the framebuffer's!"):(c.width=a.width,c.height=a.height)};a.prototype._validateColorAttachmentPoint=
function(c){if(-1===a._MAX_COLOR_ATTACHMENTS){var b=this._context.capabilities.drawBuffers;a._MAX_COLOR_ATTACHMENTS=b?this._context.gl.getParameter(b.MAX_COLOR_ATTACHMENTS):1}c-=36064;c+1>a._MAX_COLOR_ATTACHMENTS&&f.error("esri.FrameBufferObject","illegal attachment point for color attachment: "+(c+1)+". Implementation supports up to "+a._MAX_COLOR_ATTACHMENTS+" color attachments")};a._nextId=0;a._MAX_COLOR_ATTACHMENTS=-1;return a}()})},"esri/views/webgl/Renderbuffer":function(){define(["require",
"exports","../../core/maybe"],function(m,a,b){return function(){function a(k,h){this._context=k;this._desc=h;this._glName=null;this._id=-1;k=this._context.gl;b.isSome(this._context.instanceCounter)&&this._context.instanceCounter.increment(5,this);this._id=++a._nextId;this._glName=k.createRenderbuffer();this._context.bindRenderbuffer(this);k.renderbufferStorage(k.RENDERBUFFER,h.internalFormat,h.width,h.height)}Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!1,configurable:!0});a.prototype.resize=function(a,b){var g=this._context.gl,d=this._desc;if(d.width!==a||d.height!==b)d.width=a,d.height=b,this._context.bindRenderbuffer(this),g.renderbufferStorage(g.RENDERBUFFER,d.internalFormat,d.width,d.height)};a.prototype.dispose=function(){this._glName&&
(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null);this._context&&b.isSome(this._context.instanceCounter)&&this._context.instanceCounter.decrement(5,this);this._context=null};a._nextId=0;return a}()})},"esri/views/webgl/Texture":function(){define(["require","exports","tslib","../../core/mathUtils","../../core/maybe"],function(m,a,b,l,k){return function(){function a(g,d,f){void 0===f&&(f=null);this._glName=this._context=null;this._id=-1;this._descriptor=void 0;this._wrapModeDirty=
this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=g;this._descriptor=b.__assign({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},d);this._id=++a._nextId;k.isSome(g.instanceCounter)&&g.instanceCounter.increment(0,this);this.setData(f)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._descriptor},enumerable:!1,configurable:!0});a.prototype.dispose=function(){var a=this;if(this._context&&this._context.gl){if(this._glName){var b=this._context.gl;this._boundToUnits.forEach(function(b){a._context.bindTexture(null,b)});b.deleteTexture(this._glName);this._glName=null}k.isSome(this._context.instanceCounter)&&this._context.instanceCounter.decrement(0,this);this._context=null}};a.prototype.release=
function(){this.dispose()};a.prototype.resize=function(a,b){var d=this._descriptor;if(d.width!==a||d.height!==b)d.width=a,d.height=b,this.setData(null)};a.prototype.setData=function(b){if(this._context&&this._context.gl){var d=this._context.gl;this._glName||(this._glName=d.createTexture());void 0===b&&(b=null);null===b&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var f=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var c=
this._descriptor;a._validateTexture(c);d.pixelStorei(d.UNPACK_ALIGNMENT,c.unpackAlignment);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,c.flipped?1:0);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.preMultiplyAlpha?1:0);var e=c.pixelFormat,g=c.internalFormat?c.internalFormat:e;if(b instanceof ImageData||b instanceof HTMLImageElement||b instanceof HTMLCanvasElement||b instanceof HTMLVideoElement){var h=b.width,l=b.height;b instanceof HTMLVideoElement&&(h=b.videoWidth,l=b.videoHeight);c.width&&c.height&&console.assert(h===
c.width&&l===c.height);d.texImage2D(d.TEXTURE_2D,0,g,e,c.dataType,b);c.hasMipmap&&this.generateMipmap();void 0===c.width&&(c.width=h);void 0===c.height&&(c.height=l)}else{null!=c.width&&null!=c.height||console.error("Width and height must be specified!");d.DEPTH24_STENCIL8&&g===d.DEPTH_STENCIL&&(g=d.DEPTH24_STENCIL8);var h=c.width,l=c.height,p=b;if(k.isSome(p)&&"type"in p&&"compressed"===p.type)for(e=Math.round(Math.log(Math.max(h,l))/Math.LN2)+1,c.hasMipmap=c.hasMipmap&&e===b.levels.length,p=0;;++p){d.compressedTexImage2D(d.TEXTURE_2D,
p,g,h,l,0,b.levels[Math.min(p,b.levels.length-1)]);if(1===h&&1===l||!c.hasMipmap)break;h=Math.max(1,h>>1);l=Math.max(1,l>>1)}else if(k.isSome(b))d.texImage2D(d.TEXTURE_2D,0,g,h,l,0,e,c.dataType,b),c.hasMipmap&&this.generateMipmap();else for(p=0;;++p){d.texImage2D(d.TEXTURE_2D,p,g,h,l,0,e,c.dataType,null);if(1===h&&1===l||!c.hasMipmap)break;h=Math.max(1,h>>1);l=Math.max(1,l>>1)}}a._applySamplingMode(d,this._descriptor);a._applyWrapMode(d,this._descriptor);a._applyAnisotropicFilteringParameters(this._context,
this._descriptor);this._context.bindTexture(f,0)}};a.prototype.updateData=function(a,b,f,c,e,n){n||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var d=this._context.gl,g=this._descriptor,h=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>b||0>f||c>g.width||e>g.height||b+c>g.width||f+e>g.height)&&console.error("An attempt to update out of bounds of the texture!");d.pixelStorei(d.UNPACK_ALIGNMENT,
g.unpackAlignment);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,g.flipped?1:0);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g.preMultiplyAlpha?1:0);n instanceof ImageData||n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement?d.texSubImage2D(d.TEXTURE_2D,a,b,f,g.pixelFormat,g.dataType,n):d.texSubImage2D(d.TEXTURE_2D,a,b,f,c,e,g.pixelFormat,g.dataType,n);this._context.bindTexture(h,0)};a.prototype.generateMipmap=function(){var b=this._descriptor;b.hasMipmap||(this._samplingModeDirty=
b.hasMipmap=!0,a._validateTexture(b));9729===b.samplingMode?(this._samplingModeDirty=!0,b.samplingMode=9985):9728===b.samplingMode&&(this._samplingModeDirty=!0,b.samplingMode=9984);b=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var d=this._context.gl;d.generateMipmap(d.TEXTURE_2D);this._context.bindTexture(b,0)};a.prototype.setSamplingMode=function(b){b!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=b,a._validateTexture(this._descriptor),this._samplingModeDirty=
!0)};a.prototype.setWrapMode=function(b){b!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=b,a._validateTexture(this._descriptor),this._wrapModeDirty=!0)};a.prototype.applyChanges=function(){var b=this._context.gl,d=this._descriptor;this._samplingModeDirty&&(a._applySamplingMode(b,d),this._samplingModeDirty=!1);this._wrapModeDirty&&(a._applyWrapMode(b,d),this._wrapModeDirty=!1)};a.prototype.setBoundToUnit=function(a,b){b?this._boundToUnits.add(a):this._boundToUnits.delete(a)};a._validateTexture=
function(a){(0>a.width||0>a.height)&&console.error("Negative dimension parameters are not allowed!");l.isPowerOfTwo(a.width)&&l.isPowerOfTwo(a.height)||("number"===typeof a.wrapMode?33071!==a.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===a.wrapMode.s&&33071===a.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),a.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};a._applySamplingMode=
function(a,b){var d=b.samplingMode,c=b.samplingMode;if(9985===d||9987===d)d=9729,b.hasMipmap||(c=9729);else if(9984===d||9986===d)d=9728,b.hasMipmap||(c=9728);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,c)};a._applyWrapMode=function(a,b){"number"===typeof b.wrapMode?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,b.wrapMode),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,b.wrapMode)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,b.wrapMode.s),
a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,b.wrapMode.t))};a._applyAnisotropicFilteringParameters=function(a,b){if(null!=b.maxAnisotropy){var d=a.capabilities.textureFilterAnisotropic;d&&(a=a.gl,a.texParameterf(a.TEXTURE_2D,d.TEXTURE_MAX_ANISOTROPY,b.maxAnisotropy))}};a._nextId=0;return a}()})},"esri/views/webgl/Program":function(){define(["require","exports","../../core/has","../../core/maybe","./ShaderTranspiler"],function(m,a,b,l,k){function h(a,b){if(l.isNone(a)||a.length!==b.length)return!0;
for(var d=0;d<a.length;++d)if(a[d]!==b[d])return!0;return!1}return function(){function a(b,f,c,e,g){void 0===g&&(g={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};b||
console.error("RenderingContext isn't initialized!");0===f.length&&console.error("Shaders source should not be empty!");this._context=b;this._vertexShaderSource=f;this._fragmentShaderSource=c;if(Array.isArray(g))for(f=0;f<g.length;f++)this._defines[g[f]]="1";else this._defines=g;this._id=a._nextId++;this._locations=e;l.isSome(b.instanceCounter)&&b.instanceCounter.increment(3,this)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"glName",{get:function(){return this._glName},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!1,configurable:!0});a.prototype.getDefine=function(a){return this._defines[a]};a.prototype.dispose=function(){if(this._context){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),
this._glName=null);l.isSome(this._context.instanceCounter)&&this._context.instanceCounter.decrement(3,this);this._context=null}};a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,b=a.createProgram();a.attachShader(b,this._vShader);a.attachShader(b,this._fShader);for(var c in this._locations)a.bindAttribLocation(b,this._locations[c],
c);a.linkProgram(b);this._glName=b;this._initialized=!0}};a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};a.prototype.getAttribLocation=function(a){this.initialize();void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,
a));return this._nameToAttribLocation[a]};a.prototype.setUniform1i=function(a,b){var c=this._nameToUniform1[a];if(void 0===c||b!==c)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),b),this._nameToUniform1[a]=b};a.prototype.setUniform1iv=function(b,f){var c=this._nameToUniform1v[b];h(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(b),f),void 0===c?this._nameToUniform1v[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniform2iv=
function(b,f){var c=this._nameToUniform2[b];h(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(b),f),void 0===c?this._nameToUniform2[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniform3iv=function(b,f){var c=this._nameToUniform3[b];h(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(b),f),void 0===c?this._nameToUniform3[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniform4iv=function(b,f){var c=
this._nameToUniform4[b];h(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(b),f),void 0===c?this._nameToUniform4[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniform1f=function(a,b){var c=this._nameToUniform1[a];if(void 0===c||b!==c)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),b),this._nameToUniform1[a]=b};a.prototype.setUniform1fv=function(b,f){var c=this._nameToUniform1v[b];h(c,f)&&(this._context.bindProgram(this),
this._context.gl.uniform1fv(this.getUniformLocation(b),f),void 0===c?this._nameToUniform1v[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniform2f=function(a,b,c){var e=this._nameToUniform2[a];if(void 0===e||b!==e[0]||c!==e[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),b,c),void 0===e?this._nameToUniform2[a]=[b,c]:(e[0]=b,e[1]=c)};a.prototype.setUniform2fv=function(b,f){var c=this._nameToUniform2[b];h(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(b),
f),void 0===c?this._nameToUniform2[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniform3f=function(a,b,c,e){var d=this._nameToUniform3[a];if(void 0===d||b!==d[0]||c!==d[1]||e!==d[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),b,c,e),void 0===d?this._nameToUniform3[a]=[b,c,e]:(d[0]=b,d[1]=c,d[2]=e)};a.prototype.setUniform3fv=function(b,f){var c=this._nameToUniform3[b];h(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(b),
f),void 0===c?this._nameToUniform3[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniform4f=function(a,b,c,e,g){var d=this._nameToUniform4[a];if(void 0===d||b!==d[0]||c!==d[1]||e!==d[2]||g!==d[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),b,c,e,g),void 0===d?this._nameToUniform4[a]=[b,c,e,g]:(d[0]=b,d[1]=c,d[2]=e,d[3]=g)};a.prototype.setUniform4fv=function(b,f){var c=this._nameToUniform4[b];h(c,f)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(b),
f),void 0===c?this._nameToUniform4[b]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniformMatrix3fv=function(b,f,c){void 0===c&&(c=!1);var e=this._nameToUniformMatrix3[b],d;d=l.isNone(e)?!0:9!==e.length?h(e,f):9!==e.length||e[0]!==f[0]||e[1]!==f[1]||e[2]!==f[2]||e[3]!==f[3]||e[4]!==f[4]||e[5]!==f[5]||e[6]!==f[6]||e[7]!==f[7]||e[8]!==f[8];d&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(b),c,f),void 0===e?this._nameToUniformMatrix3[b]=a._arrayCopy(f):
a._arrayAssign(f,e))};a.prototype.setUniformMatrix4fv=function(b,f,c){void 0===c&&(c=!1);var e=this._nameToUniformMatrix4[b],d;d=l.isNone(e)?!0:16!==e.length?h(e,f):16!==e.length||e[0]!==f[0]||e[1]!==f[1]||e[2]!==f[2]||e[3]!==f[3]||e[4]!==f[4]||e[5]!==f[5]||e[6]!==f[6]||e[7]!==f[7]||e[8]!==f[8]||e[9]!==f[9]||e[10]!==f[10]||e[11]!==f[11]||e[12]!==f[12]||e[13]!==f[13]||e[14]!==f[14]||e[15]!==f[15];d&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(b),c,f),
void 0===e?this._nameToUniformMatrix4[b]=a._arrayCopy(f):a._arrayAssign(f,e))};a.prototype.assertCompatibleVertexAttributeLocations=function(a){(a=a.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return a};a._padToThree=function(a){var b=a.toString();1E3>a&&(b=("  "+a).slice(-3));return b};a.prototype._addLineNumbers=function(b){var d=2;return b.replace(/\n/g,function(){return"\n"+a._padToThree(d++)+":"})};a.prototype._loadShader=function(a){var b=35633===
a,c=b?this._vertexShaderSource:this._fragmentShaderSource,e="",d;for(d in this._defines)e+="#define "+d+" "+this._defines[d]+"\n";c=e+c;"webgl2"===this._context.contextVersion&&(c=k.transpileShader(c,b?"vertex":"fragment"));b=this._context.gl;a=b.createShader(a);b.shaderSource(a,c);b.compileShader(a);return a};a._arrayCopy=function(a){for(var b=[],c=0;c<a.length;++c)b.push(a[c]);return b};a._arrayAssign=function(a,b){for(var c=0;c<a.length;++c)b[c]=a[c]};a._nextId=0;return a}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["require",
"exports","./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(m,a,b,l){function k(a){return a.map(function(a){return"eof"!==a.type?a.data:""}).join("")}function h(a,c,b,d){d=d||b;for(var e=0;e<a.length;e++){var f=a[e];if("ident"===f.type&&f.data===b)return d in c?c[d]++:c[d]=0,h(a,c,d+"_"+c[d],d)}return b}function g(a,c,b){void 0===b&&(b="afterVersion");var e={data:"\n",type:"whitespace"},d=function(c){return c<a.length?/[^\r\n]$/.test(a[c].data):!1},f=function(a){for(var c=-1,e=0,d=-1,
f=0;f<a.length;f++){var g=a[f];"preprocessor"===g.type&&(g.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++e:g.data.match(/\#endif\s*.*/)&&--e);("afterVersion"===b||"afterPrecision"===b)&&"preprocessor"===g.type&&/^#version/.test(g.data)&&(d=Math.max(d,f));if("afterPrecision"===b&&"keyword"===g.type&&"precision"===g.data){a:{for(g=f;g<a.length;g++){var n=a[g];if("operator"===n.type&&";"===n.data)break a}g=null}if(null===g)throw Error("precision statement not followed by any semicolons!");d=Math.max(d,g)}c<
d&&0===e&&(c=f)}return c+1}(a);d(f-1)&&a.splice(f++,0,e);for(var g=0;g<c.length;g++){var h=c[g];a.splice(f++,0,h)}d(f-1)&&d(f)&&a.splice(f,0,e)}Object.defineProperty(a,"__esModule",{value:!0});a.transpileShader=void 0;var d=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];a.transpileShader=function(a,c){a=l(a);var e;a:{e="100";var f="300 es";void 0===e&&(e="100");void 0===f&&(f="300 es");for(var t=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,m=
0;m<a.length;m++){var p=a[m];if("preprocessor"===p.type){var q=t.exec(p.data);if(q){t=q[1].replace(/\s\s+/g," ");if(t===f){e=t;break a}if(t===e){p.data="#version "+f;break a}throw Error("unknown glsl version: "+t);}}}a.splice(0,0,{type:"preprocessor",data:"#version "+f},{type:"whitespace",data:"\n"});e=null}if("300 es"===e)throw Error("shader is already glsl 300 es");t=p=null;m={};q={};for(e=0;e<a.length;++e)switch(f=a[e],f.type){case "keyword":"vertex"===c&&"attribute"===f.data?f.data="in":"varying"===
f.data&&(f.data="vertex"===c?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(f.data.trim())&&(f.data=f.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===c&&"gl_FragColor"===f.data){if(!p){var p=h(a,m,"fragColor"),u=void 0;void 0===u&&(u="lowp");g(a,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:u},{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:p},{type:"operator",data:";"}],
"afterPrecision")}f.data=p}if("fragment"===c&&"gl_FragData"===f.data){for(var u=a,y=void 0,w=void 0,B=-1,z=e+1;z<u.length;z++){var A=u[z];if("operator"===A.type&&("["===A.data&&(y=z),"]"===A.data)){w=z;break}"integer"===A.type&&(B=parseInt(A.data,10))}y&&w&&u.splice(y,w-y+1);u=B;y=h(a,m,"fragData");w="mediump";void 0===w&&(w="lowp");g(a,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"\x3d"},{type:"whitespace",
data:" "},{type:"integer",data:u.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:w},{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:y},{type:"operator",data:";"}],"afterPrecision");f.data=y}else"fragment"===c&&"gl_FragDepthEXT"===f.data&&(t||(t=h(a,m,"gl_FragDepth")),f.data=t);break;case "ident":if(0<=b.indexOf(f.data)){if(u="vertex"===c)a:{for(u=
e-1;0<=u;u--)if(y=a[u],"whitespace"!==y.type&&"block-comment"!==y.type)if("keyword"===y.type){if("attribute"===y.data||"in"===y.data){u=!0;break a}}else break;u=!1}if(u)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");f.data in q||(q[f.data]=h(a,m,f.data));f.data=q[f.data]}}for(e=a.length-1;0<=e;--e)f=a[e],"preprocessor"===f.type&&((c=f.data.match(/\#extension\s+(.*)\:/))&&c[1]&&0<=d.indexOf(c[1].trim())&&(c=a[e+1],a.splice(e,c&&"whitespace"===c.type?2:
1)),(c=f.data.match(/\#ifdef\s+(.*)/))&&c[1]&&0<=d.indexOf(c[1].trim())&&(f.data="#if 1"),(c=f.data.match(/\#ifndef\s+(.*)/))&&c[1]&&0<=d.indexOf(c[1].trim())&&(f.data="#if 0"));return k(a)}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(["require","exports"],function(m,a){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(m){"use strict;";return function(a){var b=m(),l=[],l=l.concat(b(a));return l=l.concat(b(null))}})},"esri/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(m,a,b){"use strict;";var l="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function k(a){a.length&&y.push({type:l[x],
data:a,position:z,line:w,column:B})}function h(){u=u.length?[]:u;if("/"===q&&"*"===p)return z=t+n-1,x=0,q=p,n+1;if("/"===q&&"/"===p)return z=t+n-1,x=1,q=p,n+1;if("#"===p)return x=2,z=t+n,n;if(/\s/.test(p))return x=9,z=t+n,n;A=/\d/.test(p);C=/[^\w_]/.test(p);z=t+n;x=A?4:C?3:9999;return n}function g(){if(("\r"===p||"\n"===p)&&"\\"!==q)return k(u.join("")),x=999,n;u.push(p);q=p;return n+1}function d(){if("."===q&&/\d/.test(p))return x=5,n;if("/"===q&&"*"===p)return x=0,n;if("/"===q&&"/"===p)return x=
1,n;if("."===p&&u.length){for(;f(u););x=5;return n}if(";"===p||")"===p||"("===p){if(u.length)for(;f(u););k(p);x=999;return n+1}var a=2===u.length&&"\x3d"!==p;if(/[\w_\d\s]/.test(p)||a){for(;f(u););x=999;return n}u.push(p);q=p;return n+1}function f(c){var b=0,e,d;do{e=a.indexOf(c.slice(0,c.length+b).join(""));d=a[e];if(-1===e){if(0<b--+c.length)continue;d=c.slice(0,1).join("")}k(d);z+=d.length;u=u.slice(d.length);return u.length}while(1)}function c(){if("."===p||/[eE]/.test(p))return u.push(p),x=5,
q=p,n+1;if("x"===p&&1===u.length&&"0"===u[0])return x=11,u.push(p),q=p,n+1;if(/[^\d]/.test(p))return k(u.join("")),x=999,n;u.push(p);q=p;return n+1}function e(){"f"===p&&(u.push(p),q=p,n+=1);if(/[eE]/.test(p)||"-"===p&&/[eE]/.test(q))return u.push(p),q=p,n+1;if(/[^\d]/.test(p))return k(u.join("")),x=999,n;u.push(p);q=p;return n+1}var n=0,t=0,x=999,p,q,u=[],y=[],w=1,B=0,z=0,A=!1,C=!1,E="",D;return function(a){y=[];if(null!==a){a=a.replace?a.replace(/\r\n/g,"\n"):a;n=0;E+=a;for(D=E.length;p=E[n],n<
D;){a=n;switch(x){case 0:"/"===p&&"*"===q?(u.push(p),k(u.join("")),x=999):(u.push(p),q=p);n+=1;break;case 1:n=g();break;case 2:n=g();break;case 3:n=d();break;case 4:n=c();break;case 11:/[^a-fA-F0-9]/.test(p)?(k(u.join("")),x=999):(u.push(p),q=p,n+=1);break;case 5:n=e();break;case 9999:if(/[^\d\w_]/.test(p)){var f=u.join("");x=-1<m.indexOf(f)?8:-1<b.indexOf(f)?7:6;k(u.join(""));x=999}else u.push(p),q=p,n+=1;break;case 9:/[^\s]/g.test(p)?(k(u.join("")),x=999):(u.push(p),q=p,n+=1);break;case 999:n=h()}if(a!==
n)switch(E[a]){case "\n":B=0;++w;break;default:++B}}t+=n;E=E.slice(n);return y}u.length&&k(u.join(""));x=10;k("(eof)");return y}}})},"esri/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/views/webgl/RenderingContext":function(){define("require exports ../../core/has ../../core/maybe ./enums ./InstanceCounter ./renderState ./capabilities/isWebGL2Context ./capabilities/load".split(" "),function(m,a,b,l,k,h,g,d,f){return function(){function a(a,c){var b=this;this.gl=null;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,
g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation=
{face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this._numOfTriangles=this._numOfDrawCalls=0;this.contextVersion=d.default(a)?"webgl2":"webgl";this.gl=a;a instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=f.loadCapabilities(a,c);a=this.gl.getParameter(this.gl.VIEWPORT);
this._viewport={x:a[0],y:a[1],width:a[2],height:a[3]};this._stateTracker=new g.StateTracker({setBlending:function(a){a?(b.setBlendingEnabled(!0),b.setBlendEquationSeparate(a.opRgb,a.opAlpha),b.setBlendFunctionSeparate(a.srcRgb,a.dstRgb,a.srcAlpha,a.dstAlpha),a=a.color,b.setBlendColor(a.r,a.g,a.b,a.a)):b.setBlendingEnabled(!1)},setCulling:function(a){a?(b.setFaceCullingEnabled(!0),b.setCullFace(a.face),b.setFrontFace(a.mode)):b.setFaceCullingEnabled(!1)},setPolygonOffset:function(a){a?(b.setPolygonOffsetFillEnabled(!0),
b.setPolygonOffset(a.factor,a.units)):b.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(a){a?(b.setDepthTestEnabled(!0),b.setDepthFunction(a.func)):b.setDepthTestEnabled(!1)},setStencilTest:function(a){if(a){b.setStencilTestEnabled(!0);var c=a.function;b.setStencilFunction(c.func,c.ref,c.mask);a=a.operation;b.setStencilOp(a.fail,a.zFail,a.zPass)}else b.setStencilTestEnabled(!1)},setDepthWrite:function(a){a?(b.setDepthWriteEnabled(!0),b.setDepthRange(a.zNear,a.zFar)):b.setDepthWriteEnabled(!1)},
setColorWrite:function(a){a?b.setColorMask(a.r,a.g,a.b,a.a):b.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(a){a?b.setStencilWriteMask(a.mask):b.setStencilWriteMask(0)}});this.enforceState()}Object.defineProperty(a.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"parameters",{get:function(){if(!this._parameters){var a=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),
maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:a?this.gl.getParameter(a.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE)}}return this._parameters},enumerable:!1,configurable:!0});a.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);
this.unbindBuffer(34963);this._textureUnitMap={};l.isSome(this.instanceCounter)&&(this.instanceCounter.printResourceCount(),this.instanceCounter.destroy());this._capabilities=this.gl=null};a.prototype.setPipelineState=function(a){this._stateTracker.setPipeline(a)};a.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a,this._stateTracker.invalidateBlending())};a.prototype.setBlendColor=function(a,
c,b,d){if(a!==this._blendColorState.r||c!==this._blendColorState.g||b!==this._blendColorState.b||d!==this._blendColorState.a)this.gl.blendColor(a,c,b,d),this._blendColorState.r=a,this._blendColorState.g=c,this._blendColorState.b=b,this._blendColorState.a=d,this._stateTracker.invalidateBlending()};a.prototype.setBlendFunction=function(a,c){if(a!==this._blendFunctionState.srcRGB||c!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,c),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=
a,this._blendFunctionState.dstRGB=c,this._blendFunctionState.dstAlpha=c,this._stateTracker.invalidateBlending()};a.prototype.setBlendFunctionSeparate=function(a,c,b,d){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==b||this._blendFunctionState.dstRGB!==c||this._blendFunctionState.dstAlpha!==d)this.gl.blendFuncSeparate(a,c,b,d),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=b,this._blendFunctionState.dstRGB=c,this._blendFunctionState.dstAlpha=d,this._stateTracker.invalidateBlending()};
a.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a,this._stateTracker.invalidateBlending())};a.prototype.setBlendEquationSeparate=function(a,c){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==c)this.gl.blendEquationSeparate(a,c),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=c,this._stateTracker.invalidateBlending()};a.prototype.setColorMask=
function(a,c,b,d){if(this._colorMaskState.r!==a||this._colorMaskState.g!==c||this._colorMaskState.b!==b||this._colorMaskState.a!==d)this.gl.colorMask(a,c,b,d),this._colorMaskState.r=a,this._colorMaskState.g=c,this._colorMaskState.b=b,this._colorMaskState.a=d,this._stateTracker.invalidateColorWrite()};a.prototype.setClearColor=function(a,c,b,d){if(this._clearColor.r!==a||this._clearColor.g!==c||this._clearColor.b!==b||this._clearColor.a!==d)this.gl.clearColor(a,c,b,d),this._clearColor.r=a,this._clearColor.g=
c,this._clearColor.b=b,this._clearColor.a=d};a.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a,this._stateTracker.invalidateCulling())};a.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a,this._stateTracker.invalidatePolygonOffset())};
a.prototype.setPolygonOffset=function(a,c){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==c)this._polygonOffset[0]=a,this._polygonOffset[1]=c,this.gl.polygonOffset(a,c),this._stateTracker.invalidatePolygonOffset()};a.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a,this._stateTracker.invalidateCulling())};a.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a,this._stateTracker.invalidateCulling())};a.prototype.setScissorTestEnabled=
function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};a.prototype.setScissorRect=function(a,c,b,d){if(this._scissorRect.x!==a||this._scissorRect.y!==c||this._scissorRect.width!==b||this._scissorRect.height!==d)this.gl.scissor(a,c,b,d),this._scissorRect.x=a,this._scissorRect.y=c,this._scissorRect.width=b,this._scissorRect.height=d};a.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==
a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a,this._stateTracker.invalidateDepthTest())};a.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)};a.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a,this._stateTracker.invalidateDepthTest())};a.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),
this._depthWriteEnabled=a,this._stateTracker.invalidateDepthWrite())};a.prototype.setDepthRange=function(a,c){if(this._depthRange.zNear!==a||this._depthRange.zFar!==c)this.gl.depthRange(a,c),this._depthRange.zNear=a,this._depthRange.zFar=c,this._stateTracker.invalidateDepthWrite()};a.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a,this._stateTracker.invalidateStencilTest())};
a.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};a.prototype.setStencilFunction=function(a,c,b){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==c||this._stencilFunction.mask!==b)this.gl.stencilFunc(a,c,b),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=c,this._stencilFunction.mask=b,this._stateTracker.invalidateStencilTest()};a.prototype.setStencilFunctionSeparate=function(a,c,b,d){if(this._stencilFunction.face!==
a||this._stencilFunction.func!==c||this._stencilFunction.ref!==b||this._stencilFunction.mask!==d)this.gl.stencilFuncSeparate(a,c,b,d),this._stencilFunction.face=a,this._stencilFunction.func=c,this._stencilFunction.ref=b,this._stencilFunction.mask=d,this._stateTracker.invalidateStencilTest()};a.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a,this._stateTracker.invalidateStencilWrite())};a.prototype.setStencilOp=function(a,c,b){if(this._stencilOperation.fail!==
a||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==b)this.gl.stencilOp(a,c,b),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=c,this._stencilOperation.zPass=b,this._stateTracker.invalidateStencilTest()};a.prototype.setStencilOpSeparate=function(a,c,b,d){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==c||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==d)this.gl.stencilOpSeparate(a,c,b,d),this._stencilOperation.face=
a,this._stencilOperation.face=a,this._stencilOperation.fail=c,this._stencilOperation.zFail=b,this._stencilOperation.zPass=d,this._stateTracker.invalidateStencilTest()};a.prototype.setActiveTexture=function(a){var c=this._activeTextureUnit;0<=a&&a!==this._activeTextureUnit&&(this.gl.activeTexture(k.BASE_TEXTURE_UNIT+a),this._activeTextureUnit=a);return c};a.prototype.clear=function(a){a&&this.gl.clear(a)};a.prototype.clearSafe=function(a,c){void 0===c&&(c=255);a&&(a&16384&&this.setColorMask(!0,!0,
!0,!0),a&256&&this.setDepthWriteEnabled(!0),a&1024&&this.setStencilWriteMask(c),this.gl.clear(a))};a.prototype.drawArrays=function(a,c,b){this.gl.drawArrays(a,c,b)};a.prototype.drawElements=function(a,c,b,d){5123===b?this.gl.drawElements(a,c,b,d):5125===b&&this.gl.drawElements(a,c,b,d)};a.prototype.logIno=function(){};Object.defineProperty(a.prototype,"capabilities",{get:function(){return this._capabilities},enumerable:!1,configurable:!0});a.prototype.setViewport=function(a,c,b,d){var e=this._viewport;
if(e.x!==a||e.y!==c||e.width!==b||e.height!==d)e.x=a,e.y=c,e.width=b,e.height=d,this.gl.viewport(a,c,b,d)};a.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};a.prototype.bindProgram=function(a){a?this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),this._activeShaderProgram=null)};a.prototype.bindTexture=function(c,b){void 0===b&&(b=0);
-1===a._MAX_TEXTURE_IMAGE_UNITS&&(a._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(b>=a._MAX_TEXTURE_IMAGE_UNITS||0>b)&&console.error("Input texture unit is out of range of available units!");var e=this._textureUnitMap[b];this.setActiveTexture(b);null==c||null==c.glName?(null!=e&&(this.gl.bindTexture(e.descriptor.target,null),e.setBoundToUnit(b,!1)),this._textureUnitMap[b]=null):e&&e.id===c.id?c.applyChanges():(e&&e.setBoundToUnit(b,!1),this.gl.bindTexture(c.descriptor.target,
c.glName),c.setBoundToUnit(b,!0),c.applyChanges(),this._textureUnitMap[b]=c)};a.prototype.bindFramebuffer=function(a){l.isNone(a)?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null):this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a)};a.prototype.bindBuffer=function(c){c&&(34962===c.bufferType?this._activeVertexBuffer=a._bindBuffer(this.gl,c,c.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=
a._bindBuffer(this.gl,c,c.bufferType,this._activeIndexBuffer))};a.prototype.bindRenderbuffer=function(a){var c=this.gl;a||(c.bindRenderbuffer(c.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==a&&(c.bindRenderbuffer(c.RENDERBUFFER,a.glName),this._activeRenderbuffer=a)};a.prototype.unbindBuffer=function(c){34962===c?this._activeVertexBuffer=a._bindBuffer(this.gl,null,c,this._activeVertexBuffer):this._activeIndexBuffer=a._bindBuffer(this.gl,null,c,this._activeIndexBuffer)};
a.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};a.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};a.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};a.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};a.prototype.resetState=
function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,
0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};a.prototype.enforceState=function(){var a=
this.gl,c=this.capabilities.vao;c&&c.bindVertexArray(null);for(var b=0;b<this.parameters.maxVertexAttributes;b++)a.disableVertexAttribArray(b);this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(c&&this._activeVertexArrayObject){if(c=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),
this._activeVertexArrayObject=null;this.bindVAO(c)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);a.bindRenderbuffer(a.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);
a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);a.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);
a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);a.lineWidth(1);!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);
a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);
for(c=0;c<this.parameters.maxTextureImageUnits;c++)a.activeTexture(k.BASE_TEXTURE_UNIT+c),a.bindTexture(3553,null),(b=this._textureUnitMap[c])&&a.bindTexture(b.descriptor.target,b.glName);a.activeTexture(k.BASE_TEXTURE_UNIT+this._activeTextureUnit);a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};a._bindBuffer=function(a,c,b,d){if(!c)return a.bindBuffer(b,null),null;if(d===c)return d;a.bindBuffer(b,c.glName);return c};a._MAX_TEXTURE_IMAGE_UNITS=-1;return a}()})},
"esri/views/webgl/enums":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.BASE_TEXTURE_UNIT=void 0;a.BASE_TEXTURE_UNIT=33984})},"esri/views/webgl/InstanceCounter":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.InstanceCounter=a.allInstanceCounters=void 0;a.allInstanceCounters=new Set;m=function(){function b(){this._current=[];this._max=[];for(this._allocations=new Map;6>this._current.length;)this._current.push(0),
this._max.push(0);a.allInstanceCounters.add(this)}b.prototype.destroy=function(){a.allInstanceCounters.delete(this)};b.prototype.increment=function(a,b){b=++this._current[a];this._max[a]=Math.max(b,this._max[a])};b.prototype.decrement=function(a,b){--this._current[a]};Object.defineProperty(b.prototype,"max",{get:function(){return this._max},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0});b.prototype.printResourceCount=
function(){console.log("Live objects:");console.log("Textures: "+this._current[0]);console.log("Buffers: "+this._current[1]);console.log("VAOs: "+this._current[2]);console.log("Programs: "+this._current[3]);console.log("Framebuffers: "+this._current[4]);console.log("Renderbuffers: "+this._current[5]);if(0<this._allocations.size){console.log(this._allocations.size+" live object allocations:");var a=new Map;this._allocations.forEach(function(b){var h;a.set(b,(null!==(h=a.get(b))&&void 0!==h?h:0)+1)});
a.forEach(function(a,b){return console.log(a," : ",b)})}};return b}();a.InstanceCounter=m})},"esri/views/webgl/renderState":function(){define(["require","exports","tslib"],function(m,a,b){function l(a){return z.intern(a)}function k(a){return A.intern(a)}function h(a){return C.intern(a)}function g(a){return E.intern(a)}function d(a){return D.intern(a)}function f(a){return F.intern(a)}function c(a){return H.intern(a)}function e(a){return I.intern(a)}function n(a){return"["+a.join(",")+"]"}function t(a){return a?
n([a.srcRgb,a.srcAlpha,a.dstRgb,a.dstAlpha,a.opRgb,a.opAlpha,a.color.r,a.color.g,a.color.b,a.color.a]):null}function x(a){return a?n([a.face,a.mode]):null}function p(a){return a?n([a.factor,a.units]):null}function q(a){return a?n([a.func]):null}function u(a){return a?n([a.function.func,a.function.ref,a.function.mask,a.operation.fail,a.operation.zFail,a.operation.zPass]):null}function y(a){return a?n([a.zNear,a.zFar]):null}function w(a){return a?n([a.r,a.g,a.b,a.a]):null}function B(a){return a?n([a.mask]):
null}Object.defineProperty(a,"__esModule",{value:!0});a.StateTracker=a.makePipelineState=a.makeStencilWrite=a.makeColorWrite=a.makeDepthWrite=a.makeStencilTest=a.makeDepthTest=a.makePolygonOffset=a.makeCulling=a.makeBlending=a.defaultColorWriteParams=a.defaultDepthWriteParams=a.backFaceCullingParams=a.separateBlendingParams=a.simpleBlendingParams=void 0;a.simpleBlendingParams=function(a,c,b,e){void 0===b&&(b=32774);void 0===e&&(e=[0,0,0,0]);return{srcRgb:a,srcAlpha:a,dstRgb:c,dstAlpha:c,opRgb:b,opAlpha:b,
color:{r:e[0],g:e[1],b:e[2],a:e[3]}}};a.separateBlendingParams=function(a,c,b,e,d,f,g){void 0===d&&(d=32774);void 0===f&&(f=32774);void 0===g&&(g=[0,0,0,0]);return{srcRgb:a,srcAlpha:c,dstRgb:b,dstAlpha:e,opRgb:d,opAlpha:f,color:{r:g[0],g:g[1],b:g[2],a:g[3]}}};a.backFaceCullingParams={face:1029,mode:2305};a.defaultDepthWriteParams={zNear:0,zFar:1};a.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};a.makeBlending=l;a.makeCulling=k;a.makePolygonOffset=h;a.makeDepthTest=g;a.makeStencilTest=d;a.makeDepthWrite=
f;a.makeColorWrite=c;a.makeStencilWrite=e;a.makePipelineState=function(a){return G.intern(a)};m=function(){function a(a,c){this.makeKey=a;this.makeRef=c;this.interns=new Map}a.prototype.intern=function(a){if(!a)return null;var c=this.makeKey(a),b=this.interns;b.has(c)||b.set(c,this.makeRef(a));return b.get(c)};return a}();var z=new m(t,function(a){return b.__assign({__tag:"Blending"},a)}),A=new m(x,function(a){return b.__assign({__tag:"Culling"},a)}),C=new m(p,function(a){return b.__assign({__tag:"PolygonOffset"},
a)}),E=new m(q,function(a){return b.__assign({__tag:"DepthTest"},a)}),D=new m(u,function(a){return b.__assign({__tag:"StencilTest"},a)}),F=new m(y,function(a){return b.__assign({__tag:"DepthWrite"},a)}),H=new m(w,function(a){return b.__assign({__tag:"ColorWrite"},a)}),I=new m(B,function(a){return b.__assign({__tag:"StencilWrite"},a)}),G=new m(function(a){return a?n([t(a.blending),x(a.culling),p(a.polygonOffset),q(a.depthTest),u(a.stencilTest),y(a.depthWrite),w(a.colorWrite),B(a.stencilWrite)]):null},
function(a){return{blending:l(a.blending),culling:k(a.culling),polygonOffset:h(a.polygonOffset),depthTest:g(a.depthTest),stencilTest:d(a.stencilTest),depthWrite:f(a.depthWrite),colorWrite:c(a.colorWrite),stencilWrite:e(a.stencilWrite)}});m=function(){function a(a){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=
a}a.prototype.setPipeline=function(a){if(this._pipelineInvalid||a!==this._pipeline)this.setBlending(a.blending),this.setCulling(a.culling),this.setPolygonOffset(a.polygonOffset),this.setDepthTest(a.depthTest),this.setStencilTest(a.stencilTest),this.setDepthWrite(a.depthWrite),this.setColorWrite(a.colorWrite),this.setStencilWrite(a.stencilWrite),this._pipeline=a;this._pipelineInvalid=!1};a.prototype.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};a.prototype.invalidateCulling=
function(){this._pipelineInvalid=this._cullingInvalid=!0};a.prototype.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};a.prototype.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};a.prototype.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};a.prototype.invalidateColorWrite=function(){this._pipelineInvalid=
this._colorWriteInvalid=!0};a.prototype.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.setBlending=function(a){this._blending=this.setSubState(a,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};a.prototype.setCulling=function(a){this._culling=this.setSubState(a,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};a.prototype.setPolygonOffset=function(a){this._polygonOffset=
this.setSubState(a,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};a.prototype.setDepthTest=function(a){this._depthTest=this.setSubState(a,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};a.prototype.setStencilTest=function(a){this._stencilTest=this.setSubState(a,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};a.prototype.setDepthWrite=
function(a){this._depthWrite=this.setSubState(a,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};a.prototype.setColorWrite=function(a){this._colorWrite=this.setSubState(a,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};a.prototype.setStencilWrite=function(a){this._stencilWrite=this.setSubState(a,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=
!1};a.prototype.setSubState=function(a,c,b,e){if(b||a!==c)e(a),this._pipelineInvalid=!0;return a};return a}();a.StateTracker=m})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return window.WebGL2RenderingContext&&a instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/capabilities/load":function(){define("require exports ./DisjointTimerQuery ./DrawBuffers ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),
function(m,a,b,l,k,h,g,d){function f(a,b,d,f,g){if(f&&h.default(a))return!0;if(b[d])return!1;for(b=0;b<g.length;b++)if(a.getExtension(g[b]))return!0;return!1}Object.defineProperty(a,"__esModule",{value:!0});a.loadCapabilities=void 0;a.loadCapabilities=function(a,e){var c=e&&e.disabledExtensions||{},t=e&&e.debugWebGLExtensions||{},m,p,q,u,y,w,B,z,A,C,E=null,D=null,F=null,H=null;return{get drawBuffers(){C||(C=l.load(a,c));return C},get instancing(){m||(m=k.load(a));return m},get vao(){p||(p=d.load(a,
c));return p},get compressedTextureS3TC(){if(!q)if(c.compressedTextureS3TC)q=null;else{var b=a.getExtension("WEBGL_compressed_texture_s3tc");q=b?{COMPRESSED_RGB_S3TC_DXT1:b.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:b.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:b.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:b.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}return q},get textureFilterAnisotropic(){if(!u)if(c.textureFilterAnisotropic)u=null;else{var b=a.getExtension("EXT_texture_filter_anisotropic")||
a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");u=b?{MAX_TEXTURE_MAX_ANISOTROPY:b.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:b.TEXTURE_MAX_ANISOTROPY_EXT}:null}return u},get disjointTimerQuery(){y||(y=b.load(a,c));return y},get textureFloat(){if(!w)if(h.default(a))w={textureFloat:!0,textureFloatLinear:!c.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!c.textureHalfFloatLinear&&
!!a.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:a.HALF_FLOAT};else if(a instanceof WebGLRenderingContext){var b=!c.textureHalfFloat&&a.getExtension("OES_texture_half_float");w={textureFloat:!c.textureFloat&&!!a.getExtension("OES_texture_float"),textureFloatLinear:!c.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),textureHalfFloat:!!b,textureHalfFloatLinear:!c.textureHalfFloatLinear&&!!a.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:b?b.HALF_FLOAT_OES:void 0}}else w=
null;return w},get colorBufferFloat(){if(!B)if(h.default(a)){var b=!c.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),e=!c.colorBufferFloat&&a.getExtension("EXT_color_buffer_float");B=b||e?{textureFloat:!!e,textureHalfFloat:!!b,R16F:a.R16F,RG16F:a.RG16F,RGBA16F:a.RGBA16F,R32F:a.R32F,RG32F:a.RG32F,RGBA32F:a.RGBA32F,R11F_G11F_B10F:a.R11F_G11F_B10F,RGB16F:a.RGB16F}:null}else a instanceof WebGLRenderingContext?(b=!c.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),e=!c.colorBufferFloat&&
a.getExtension("WEBGL_color_buffer_float"),B=b||e?{textureFloat:!!e,textureHalfFloat:!!b,RGBA16F:b?b.RGBA16F_EXT:void 0,RGB16F:b?b.RGB16F_EXT:void 0,RGBA32F:e?e.RGBA32F_EXT:void 0}:null):B=null;return B},get blendMinMax(){if(!z)if(h.default(a))z={MIN:a.MIN,MAX:a.MAX};else if(c.blendMinMax)z=null;else{var b=a.getExtension("EXT_blend_minmax");z=b?{MIN:b.MIN_EXT,MAX:b.MAX_EXT}:null}return z},get depthTexture(){null===E&&(E=f(a,c,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));
return E},get standardDerivatives(){null===D&&(D=f(a,c,"standardDerivatives",!0,["OES_standard_derivatives"]));return D},get shaderTextureLOD(){null===F&&(F=f(a,c,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return F},get fragDepth(){null===H&&(H=f(a,c,"fragDepth",!0,["EXT_frag_depth"]));return H},get loseContext(){A||(A=g.load(a,t));return A}}}})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["require","exports","./isWebGL2Context"],function(m,a,b){Object.defineProperty(a,
"__esModule",{value:!0});a.load=void 0;a.load=function(a,k){if(k.disjointTimerQuery)return null;var h=a.getExtension("EXT_disjoint_timer_query")||a.getExtension("EXT_disjoint_timer_query_webgl2");return h?b.default(a)?{createQuery:function(){return a.createQuery()},resultAvailable:function(b){return a.getQueryParameter(b,a.QUERY_RESULT_AVAILABLE)},getResult:function(b){return a.getQueryParameter(b,a.QUERY_RESULT)},disjoint:function(){return a.getParameter(h.GPU_DISJOINT_EXT)},beginTimeElapsed:function(b){return a.beginQuery(h.TIME_ELAPSED_EXT,
b)},endTimeElapsed:function(){return a.endQuery(h.TIME_ELAPSED_EXT)},createTimestamp:function(a){return h.queryCounterEXT(a,h.TIMESTAMP_EXT)},timestampBits:function(){return a.getQuery(h.TIMESTAMP_EXT,h.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return h.createQueryEXT()},resultAvailable:function(a){return h.getQueryObjectEXT(a,h.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(a){return h.getQueryObjectEXT(a,h.QUERY_RESULT_EXT)},disjoint:function(){return a.getParameter(h.GPU_DISJOINT_EXT)},
beginTimeElapsed:function(a){return h.beginQueryEXT(h.TIME_ELAPSED_EXT,a)},endTimeElapsed:function(){return h.endQueryEXT(h.TIME_ELAPSED_EXT)},createTimestamp:function(a){return h.queryCounterEXT(a,h.TIMESTAMP_EXT)},timestampBits:function(){return h.getQueryEXT(h.TIMESTAMP_EXT,h.QUERY_COUNTER_BITS_EXT)}}:null}})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["require","exports","./isWebGL2Context"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.load=void 0;a.load=
function(a,k){return k.disjointTimerQuery?null:b.default(a)?{drawBuffers:a.drawBuffers.bind(a),MAX_DRAW_BUFFERS:a.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:a.MAX_COLOR_ATTACHMENTS}:k.drawBuffers?null:(a=a.getExtension("WEBGL_draw_buffers"))?{drawBuffers:a.drawBuffersWEBGL.bind(a),MAX_DRAW_BUFFERS:a.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:a.MAX_COLOR_ATTACHMENTS_WEBGL}:null}})},"esri/views/webgl/capabilities/Instancing":function(){define(["require","exports","./isWebGL2Context"],function(m,a,b){Object.defineProperty(a,
"__esModule",{value:!0});a.load=void 0;a.load=function(a){return b.default(a)?{drawArraysInstanced:a.drawArraysInstanced.bind(a),drawElementsInstanced:a.drawElementsInstanced.bind(a),vertexAttribDivisor:a.vertexAttribDivisor.bind(a)}:(a=a.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:a.drawArraysInstancedANGLE.bind(a),drawElementsInstanced:a.drawElementsInstancedANGLE.bind(a),vertexAttribDivisor:a.vertexAttribDivisorANGLE.bind(a)}:null}})},"esri/views/webgl/capabilities/LoseContext":function(){define(["require",
"exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.load=void 0;a.load=function(a,l){var b=l.loseContext&&a.getExtension("WEBGL_lose_context");return b?{loseRenderingContext:function(){return b.loseContext()}}:null}})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["require","exports","./isWebGL2Context"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.load=void 0;a.load=function(a,k){return b.default(a)?{createVertexArray:a.createVertexArray.bind(a),
deleteVertexArray:a.deleteVertexArray.bind(a),bindVertexArray:a.bindVertexArray.bind(a)}:k.vao?null:(a=a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:a.createVertexArrayOES.bind(a),deleteVertexArray:a.deleteVertexArrayOES.bind(a),bindVertexArray:a.bindVertexArrayOES.bind(a)}:null}})},"esri/views/webgl/ShaderCompiler":function(){define(["require","exports"],function(m,a){return function(){function a(a){this.readFile=
a}a.prototype.resolveIncludes=function(a){return this.resolve(a)};a.prototype.resolve=function(a,b){var h=this;void 0===b&&(b=new Map);if(b.has(a))return b.get(a);var g=this.read(a);if(!g)throw Error("cannot find shader file "+a);for(var d=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,f=d.exec(g),c=[];null!=f;)c.push({path:f[1],start:f.index,length:f[0].length}),f=d.exec(g);var e=0,n="";c.forEach(function(a){n+=g.slice(e,a.start);n+=b.has(a.path)?"":h.resolve(a.path,b);e=a.start+a.length});n+=g.slice(e);
b.set(a,n);return n};a.prototype.read=function(a){return this.readFile(a)};return a}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports","../../core/maybe","./Util"],function(m,a,b,l){return function(){function a(h,g,d,f,c){this._context=h;this._locations=g;this._layout=d;this._buffers=f;this._indexBuffer=c;this._glName=null;this._initialized=!1;this._id=a._nextId++;b.isSome(h.instanceCounter)&&h.instanceCounter.increment(2,this)}Object.defineProperty(a.prototype,"id",
{get:function(){return this._id},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){var a=this;return Object.keys(this._buffers).reduce(function(b,
d){return b+a._buffers[d].size},this._indexBuffer?this._indexBuffer.size:0)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!1,configurable:!0});a.prototype.dispose=function(a){void 0===a&&(a=!0);if(this._context){var g=this._context.capabilities.vao;g&&this._glName&&(g.deleteVertexArray(this._glName),this._glName=
null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(var d in this._buffers)this._buffers[d].dispose(),delete this._buffers[d];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}b.isSome(this._context.instanceCounter)&&this._context.instanceCounter.decrement(2,this);this._context=null}};a.prototype.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){var b=a.createVertexArray();a.bindVertexArray(b);this._bindLayout();
a.bindVertexArray(null);this._glName=b}this._initialized=!0}};a.prototype.bind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};a.prototype._bindLayout=function(){var a=this._buffers,b=!!this._context.capabilities.vao,d=this._layout,f=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var c=this._context.gl,e;for(e in a){var n=a[e];n||console.error("Vertex buffer is uninitialized!");
var k=d[e];k||console.error("Vertex element descriptor is empty!");l.bindVertexBufferLayout(this._context,this._locations,n,k)}f&&(b?c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,f.glName):this._context.bindBuffer(f))};a.prototype.unbind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};a.prototype._unbindLayout=function(){var a=this._buffers,b=this._layout;a||console.error("Vertex buffer dictionary is empty!");for(var d in a){var f=a[d];f||console.error("Vertex buffer is uninitialized!");
l.unbindVertexBufferLayout(this._context,this._locations,f,b[d])}(a=this._indexBuffer)&&this._context.unbindBuffer(a.bufferType)};a._nextId=0;return a}()})},"esri/views/webgl/Util":function(){define(["require","exports","tslib","../../core/compilerUtils","../../core/maybe"],function(m,a,b,l,k){function h(a){return a[0].stride}function g(a){switch(a){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw l.neverReached(a),
Error("Unknown data type");}}function d(a){switch(a){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;case 6408:return 4;case 34041:return 4;case 33325:return 2;case 33326:return 4;case 35898:return 4;case 33327:return 4;case 33328:return 8;case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;case 36168:return 1;default:l.neverReached(a)}return 0}function f(a){if(k.isNone(a))return 0;if("colorAttachment"in a)return a.glName?f(a.colorAttachment)+
f(a.depthStencilAttachment):0;if("descriptor"in a)return a.glName?f(a.descriptor):0;var c=a.internalFormat||"pixelFormat"in a&&a.pixelFormat;if(!c)return 0;var b="hasMipmap"in a&&a.hasMipmap?1.3:1;a=a.width*a.height;return d(c)*a*b}Object.defineProperty(a,"__esModule",{value:!0});a.getGpuMemoryUsage=a.getBytesPerElementFormat=a.unbindVertexBufferLayout=a.bindVertexBufferLayout=a.setBaseInstanceOffset=a.copyFramebufferToTexture=a.findAttribute=a.hasAttribute=a.addDescriptor=a.getTypedArrayConstructor=
a.getBytesPerElement=a.getStride=a.vertexCount=void 0;a.vertexCount=function(a,b){return a.vertexBuffers[b].size/h(a.layout[b])};a.getStride=h;a.getBytesPerElement=g;a.getTypedArrayConstructor=function(a){switch(a){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;default:throw l.neverReached(a),Error("Unknown data type");}};a.addDescriptor=function(a,
b,d,f,h,k){var c=g(f);if(0<a.length){var e=a[0].stride,n=e+c*d;a.forEach(function(a){return a.stride=n});a.push({name:b,count:d,type:f,offset:e,stride:n,normalized:h,divisor:k})}else a.push({name:b,count:d,type:f,offset:0,stride:c*d,normalized:h,divisor:k})};a.hasAttribute=function(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return!0;return!1};a.findAttribute=function(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return a[c];return null};a.copyFramebufferToTexture=function(a,b,d,f,g){void 0===
g&&(g=0);var c=a.getBoundFramebufferObject(),e=a.getBoundTexture(0);a.bindFramebuffer(b);a.bindTexture(d,0);a.gl.copyTexImage2D(a.gl.TEXTURE_2D,g,d.descriptor.pixelFormat,f[0],f[1],f[2],f[3],0);a.gl.flush();a.bindFramebuffer(c);a.bindTexture(e,0)};a.setBaseInstanceOffset=function(a,e){var c={},d;for(d in a)c[d]=a[d].map(function(a){return a.divisor?b.__assign(b.__assign({},a),{baseInstance:e}):a});return c};a.bindVertexBufferLayout=function(a,b,d,f,g){var c=a.gl,e=a.capabilities.instancing;a.bindBuffer(d);
for(a=0;a<f.length;a++){d=f[a];var h=b[d.name],k=(g?g:0+d.baseInstance?d.baseInstance:0)*d.stride;void 0===h&&console.error("There is no location for vertex attribute '"+d.name+"' defined.");d.baseInstance&&!d.divisor&&console.error("Vertex attribute '"+d.name+"' uses baseInstanceOffset without divisor.");if(4>=d.count)c.vertexAttribPointer(h,d.count,d.type,d.normalized,d.stride,d.offset+k),c.enableVertexAttribArray(h),d.divisor&&0<d.divisor&&e&&e.vertexAttribDivisor(h,d.divisor);else if(9===d.count)for(var n=
0;3>n;n++)c.vertexAttribPointer(h+n,3,d.type,d.normalized,d.stride,d.offset+12*n+k),c.enableVertexAttribArray(h+n),d.divisor&&0<d.divisor&&e&&e.vertexAttribDivisor(h+n,d.divisor);else if(16===d.count)for(n=0;4>n;n++)c.vertexAttribPointer(h+n,4,d.type,d.normalized,d.stride,d.offset+16*n+k),c.enableVertexAttribArray(h+n),d.divisor&&0<d.divisor&&e&&e.vertexAttribDivisor(h+n,d.divisor);else console.error("Unsupported vertex attribute element count: "+d.count)}};a.unbindVertexBufferLayout=function(a,b,
d,f){var c=a.gl,e=a.capabilities.instancing;a.bindBuffer(d);for(d=0;d<f.length;d++){var g=f[d],h=b[g.name];if(4>=g.count)c.disableVertexAttribArray(h),g.divisor&&0<g.divisor&&e&&e.vertexAttribDivisor(h,0);else if(9===g.count)for(var k=0;3>k;k++)c.disableVertexAttribArray(h+k),g.divisor&&0<g.divisor&&e&&e.vertexAttribDivisor(h+k,0);else if(16===g.count)for(k=0;4>k;k++)c.disableVertexAttribArray(h+k),g.divisor&&0<g.divisor&&e&&e.vertexAttribDivisor(h+k,0);else console.error("Unsupported vertex attribute element count: "+
g.count)}a.unbindBuffer(34962)};a.getBytesPerElementFormat=d;a.getGpuMemoryUsage=f})},"esri/views/webgl/ProgramCache":function(){define(["require","exports","./programUtils"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.ProgramCache=void 0;m=function(){function a(a){this._programCacheByTemplate=new Map;this._rctx=a}a.prototype.dispose=function(){this._programCacheByTemplate.forEach(function(a){a.programs.forEach(function(a){a.dispose()})});this._programCacheByTemplate=null};
a.prototype.getProgram=function(a,h){var g=this;this._programCacheByTemplate.has(a)||this.addProgramTemplate(a,function(d){return b.createProgram(g._rctx,a,d)});return this.getProgramTemplateInstance(a,h)};a.prototype.addProgramTemplate=function(a,b){this._programCacheByTemplate.set(a,{constructor:b,programs:new Map})};a.prototype.getProgramTemplateInstance=function(a,b){if(a=this._programCacheByTemplate.get(a)){var g=b?JSON.stringify(b):"default";a.programs.has(g)||(b=a.constructor(b),a.programs.set(g,
b));return a.programs.get(g)}return null};return a}();a.ProgramCache=m})},"esri/views/webgl/programUtils":function(){define(["require","exports","./Program"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.createProgram=a.glslifyDefineMap=void 0;a.glslifyDefineMap=function(a){var b="",h;for(h in a){var g=a[h];if("boolean"===typeof g)g&&(b+="#define "+h+"\n");else if("number"===typeof g)b+="#define "+h+" "+g.toFixed()+"\n";else if("object"===typeof g){var d=g.options,f=0,c;for(c in d)b+=
"#define "+d[c]+" "+(f++).toFixed()+"\n";b+="#define "+h+" "+d[g.value]+"\n"}}return b};a.createProgram=function(a,k,h,g){h=h||{};g=g||"";h="function"===typeof k.shaders?k.shaders(h):k.shaders;return new b(a,g+h.vertexShader,g+h.fragmentShader,k.attributes)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],function(m,a,b){function l(a,b){Array.isArray(b)?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a);return a}function k(a,b,
f){void 0===b&&(b=0);void 0===f&&(f=!1);var c=a[b+3];a[b+0]*=c;a[b+1]*=c;a[b+2]*=c;f||(a[b+3]*=255);return a}Object.defineProperty(a,"__esModule",{value:!0});a.premultiplyAlphaRGBAArray=a.premultiplyAlphaRGBA=a.premultiplyAlphaUint32=a.copyAndPremultiply=a.premultiplyAlpha=a.white=void 0;a.white=[255,255,255,1];var h=[0,0,0,0];a.premultiplyAlpha=k;a.copyAndPremultiply=function(a){return k(l([],a))};a.premultiplyAlphaUint32=function(a){k(l(h,a));return b.i8888to32(h[0],h[1],h[2],h[3])};a.premultiplyAlphaRGBA=
function(a){if(!a)return 0;var d=a.a;return b.i8888to32(a.r*d,a.g*d,a.b*d,255*d)};a.premultiplyAlphaRGBAArray=function(a){if(!a)return 0;var d=a[3];return b.i8888to32(d/255*a[0],d/255*a[1],d/255*a[2],d)}})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(m,a){function b(a,b,d){return Math.round(Math.max(Math.min(a,d),b))}Object.defineProperty(a,"__esModule",{value:!0});a.numTo32=a.i8816to32=a.i8888to32=a.i1616to32=a.u32to4Xu8=a.toFloat32=a.toUint32=a.u32=a.u16=
a.u8=a.i32=a.i16=a.i8=void 0;var l=new Float32Array(1),k=new Uint32Array(l.buffer);a.i8=function(a){return b(a,-128,127)};a.i16=function(a){return b(a,-32768,32767)};a.i32=function(a){return b(a,-2147483648,2147483647)};a.u8=function(a){return b(a,0,255)};a.u16=function(a){return b(a,0,65535)};a.u32=function(a){return b(a,0,4294967295)};a.toUint32=function(a){l[0]=a;return k[0]};a.toFloat32=function(a){k[0]=a;return l[0]};a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>8,(a&16711680)>>>16,(a&4278190080)>>>
24]};a.i1616to32=function(a,b){return 65535&a|b<<16};a.i8888to32=function(a,b,d,f){return a&255|(b&255)<<8|(d&255)<<16|f<<24};a.i8816to32=function(a,b,d){return a&255|(b&255)<<8|d<<16};a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.MosaicType=a.WGLVVTarget=a.WGLVVFlag=a.VVType=a.WGLDrawPhase=a.WGLGeometryTransactionStatus=a.WGLGeometryType=void 0;(function(a){a[a.FILL=
0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]="LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";
a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||
(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(m,
a,b){Object.defineProperty(a,"__esModule",{value:!0});a.TextProperties=void 0;m=function(){function a(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}a.prototype.acquire=function(a,b,g,d,f,c,e,n,l){this.color=a;this.haloColor=b;this.haloSize=g;this.size=d;this.angle=f;this.offsetX=c;this.offsetY=e;this.hAnchor=n;this.vAnchor=l};a.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=
0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};a.pool=new b(a);return a}();a.TextProperties=m})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require","exports","tslib"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.DEBUG_ATTR_UPDATES=a.createDebugLogger=void 0;a.createDebugLogger=function(a,k){return a&&function(){for(var a=[],g=0;g<arguments.length;g++)a[g]=
arguments[g];return k.warn.apply(k,b.__spreadArrays(["DEBUG:"],a))}||function(){return null}};a.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("require exports tslib ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils ../../../../../3d/layers/support/FastSymbolUpdates".split(" "),function(m,a,b,l,k,h,
g,d,f){function c(a){return{value:a.value,size:l.toPt(a.size)}}function e(a){return a.map(function(a){return c(a)})}function n(a){return"string"===typeof a||"number"===typeof a?l.toPt(a):{type:"size",expression:a.expression,stops:e(a.stops)}}function t(a){var c={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof a.field)if(a.stops){if(8<a.stops.length)return null;var b=a.stops;for(a=0;8>a;++a){var e=b[Math.min(a,b.length-1)];c.values[a]=e.value;c.opacities[a]=e.opacity}}else return null;
else if(a.stops&&0<=a.stops.length)for(b=a.stops&&0<=a.stops.length&&a.stops[0].opacity,a=0;8>a;a++)c.values[a]=Infinity,c.opacities[a]=b;else return null;return c}Object.defineProperty(a,"__esModule",{value:!0});a.convertVisualVariables=a.getVisualVariablesFields=a.normalizeSizeElement=a.normalizeSizeStops=a.stopToSizeStop=a.getVisualVariableSizeValueRepresentationRatio=void 0;a.getVisualVariableSizeValueRepresentationRatio=function(a,c){if(!a||!c)return a;switch(c){case "radius":case "distance":return 2*
a;case "area":return Math.sqrt(a)}return a};a.stopToSizeStop=c;a.normalizeSizeStops=e;a.normalizeSizeElement=n;a.getVisualVariablesFields=function(a){var c=a&&0<a.length?{}:null;c&&a.forEach(function(a){var b=a.type;a.field&&(c[b]=a.field)});return c};var x=function(a){var c=[],b=[];a=e(a);for(var d=a.length,f=0;6>f;f++){var g=a[Math.min(f,d-1)];c.push(g.value);b.push(null==g.size?h.NAN_MAGIC_NUMBER:l.pt2px(g.size))}return{values:new Float32Array(c),sizes:new Float32Array(b)}};a.convertVisualVariables=
function(a){var c=a&&0<a.length?{}:null,h=c?{}:null;if(!c)return{vvFields:c,vvRanges:h};for(var l=0;l<a.length;l++){var p=a[l],m=p.type;p.field&&(c[m]=p.field);if("size"===m)switch(h.size||(h.size={}),d.getTypeOfSizeVisualVariable(p)){case g.WGLVVFlag.SIZE_MINMAX_VALUE:h.size.minMaxValue={minDataValue:p.minDataValue,maxDataValue:p.maxDataValue,minSize:n(p.minSize),maxSize:n(p.maxSize)};break;case g.WGLVVFlag.SIZE_SCALE_STOPS:h.size.scaleStops={stops:e(p.stops)};break;case g.WGLVVFlag.SIZE_FIELD_STOPS:if(p.levels){var m=
{},z;for(z in p.levels)m[z]=x(p.levels[z]);h.size.fieldStops={type:"level-dependent",levels:m}}else h.size.fieldStops=b.__assign({type:"static"},x(p.stops));break;case g.WGLVVFlag.SIZE_UNIT_VALUE:h.size.unitValue={unit:p.valueUnit,valueRepresentation:p.valueRepresentation}}else if("color"===m){if(p=f.convertVisualVariables([p],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}))for(h.color=p.color,p=0;32>p;p+=4)k.premultiplyAlpha(h.color.colors,p,!0)}else"opacity"===m?h.opacity=t(p):
"rotation"===m&&(h.rotation={type:p.rotationType})}return{vvFields:c,vvRanges:h}}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.getTypeOfSizeVisualVariable=void 0;var g=l.getLogger("esri.views.2d.engine.webgl");a.getTypeOfSizeVisualVariable=function(a){if(h.isNumber(a.minDataValue)&&h.isNumber(a.maxDataValue)&&
null!=a.minSize&&null!=a.maxSize)return k.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return k.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return k.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&
"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return k.WGLVVFlag.SIZE_UNIT_VALUE;g.error(new b("mapview-bad-type","Found invalid size VisualVariable",a));return k.WGLVVFlag.NONE}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){function t(a){return null!==a&&void 0!==a}function x(a){return"number"===typeof a}function p(a){return"string"===typeof a}function q(a,c){a&&a.push(c)}function u(a,c,b,d,f){var g=a.minSize,h=a.maxSize;if(a.expression)return q(f,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=d.symbolSize[b],c.minSize[b]=a,c.maxSize[b]=a,c.offset[b]=c.minSize[b],c.factor[b]=0,c.type[b]=1,!0;if(t(a.field)){if(t(a.stops)){if(2===a.stops.length&&
x(a.stops[0].size)&&x(a.stops[1].size))return y(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,c,b),c.type[b]=1,!0;q(f,"Could not convert size info: stops only supported with 2 elements");return!1}if(x(g)&&x(h)&&t(a.minDataValue)&&t(a.maxDataValue))return y(g,h,a.minDataValue,a.maxDataValue,c,b),c.type[b]=1,!0;if(null!=e.meterIn[a.valueUnit])return c.minSize[b]=-Infinity,c.maxSize[b]=Infinity,c.offset[b]=0,c.factor[b]=1/e.meterIn[a.valueUnit],c.type[b]=1,!0;if("unknown"===a.valueUnit)return q(f,
"Could not convert size info: proportional size not supported"),!1;q(f,"Could not convert size info: scale-dependent size not supported");return!1}if(!t(a.field)){if(a.stops&&a.stops[0]&&x(a.stops[0].size))return c.minSize[b]=a.stops[0].size,c.maxSize[b]=a.stops[0].size,c.offset[b]=c.minSize[b],c.factor[b]=0,c.type[b]=1,!0;if(x(g))return c.minSize[b]=g,c.maxSize[b]=g,c.offset[b]=g,c.factor[b]=0,c.type[b]=1,!0}q(f,"Could not convert size info: unsupported variant of sizeInfo");return!1}function y(a,
c,b,e,d,f){e=0<Math.abs(e-b)?(c-a)/(e-b):0;d.minSize[f]=0<e?a:c;d.maxSize[f]=0<e?c:a;d.offset[f]=a-b*e;d.factor[f]=e}function w(a,c,b,e){if(a.normalizationField||a.valueRepresentation)return q(e,"Could not convert size info: unsupported property"),null;var d=a.field;if(null!=d&&!p(d))return q(e,"Could not convert size info: field is not a string"),null;if(!c.size)c.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!c.size.field)c.size.field=
a.field;else if(a.field!==c.size.field)return q(e,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(d=u(a,c.size,0,b,e))?c:null;case "height":return(d=u(a,c.size,2,b,e))?c:null;case "depth":return(d=u(a,c.size,1,b,e))?c:null;case "width-and-depth":return(d=u(a,c.size,0,b,e))&&u(a,c.size,1,b,e),d?c:null;case null:case void 0:case "all":return(d=(d=(d=u(a,c.size,0,b,e))&&u(a,c.size,1,b,e))&&u(a,c.size,2,b,e))?c:null;default:return q(e,'Could not convert size info: unknown axis "'+
a.axis+'""'),null}}function B(a,c,b){for(var e=0;3>e;++e){var d=c.unitInMeters;1===a.type[e]&&(d*=c.modelSize[e],a.type[e]=2);a.minSize[e]/=d;a.maxSize[e]/=d;a.offset[e]/=d;a.factor[e]/=d}if(0!==a.type[0])c=0;else if(0!==a.type[1])c=1;else if(0!==a.type[2])c=2;else return q(b,"No size axis contains a valid size or scale"),!1;for(e=0;3>e;++e)0===a.type[e]&&(a.minSize[e]=a.minSize[c],a.maxSize[e]=a.maxSize[c],a.offset[e]=a.offset[c],a.factor[e]=a.factor[c],a.type[e]=a.type[c]);return!0}function z(a,
c,b){a[4*c+0]=b.r/255;a[4*c+1]=b.g/255;a[4*c+2]=b.b/255;a[4*c+3]=b.a}function A(a,c,b){if(a.normalizationField)return q(b,"Could not convert color info: unsupported property"),null;if(p(a.field))if(a.stops){if(8<a.stops.length)return q(b,"Could not convert color info: too many color stops"),null;c.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};b=a.stops;for(a=0;8>a;++a){var e=b[Math.min(a,b.length-1)];c.color.values[a]=e.value;
z(c.color.colors,a,e.color)}}else return q(b,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(b=a.stops&&0<=a.stops.length&&a.stops[0].color,c.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)c.color.values[a]=Infinity,z(c.color.colors,a,b);else return q(b,"Could not convert color info: no field and no colors/stops"),null;return c}function C(a,c,b){if(a.normalizationField)return q(b,
"Could not convert opacity info: unsupported property"),null;if(p(a.field))if(a.stops){if(8<a.stops.length)return q(b,"Could not convert opacity info: too many opacity stops"),null;c.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};b=a.stops;for(a=0;8>a;++a){var e=b[Math.min(a,b.length-1)];c.opacity.values[a]=e.value;c.opacity.opacityValues[a]=e.opacity}}else return q(b,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(b=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,c.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)c.opacity.values[a]=Infinity,c.opacity.opacityValues[a]=b;else return q(b,"Could not convert opacity info: no field and no opacities/stops"),null;return c}function E(a,c,b){a=2===b&&"arithmetic"===a.rotationType;c.offset[b]=a?90:0;c.factor[b]=a?-1:1;c.type[b]=1}function D(a,c,b){if(!p(a.field))return q(b,"Could not convert rotation info: field is not a string"),
null;if(!c.rotation)c.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!c.rotation.field)c.rotation.field=a.field;else if(a.field!==c.rotation.field)return q(b,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return E(a,c.rotation,0),c;case "roll":return E(a,c.rotation,1),c;case null:case void 0:case "heading":return E(a,c.rotation,2),c;default:return q(b,'Could not convert rotation info: unknown axis "'+a.axis+'""'),
null}}function F(a,c,e){if(!a)return null;var d=!c.supportedTypes||!!c.supportedTypes.size,f=!c.supportedTypes||!!c.supportedTypes.color,g=!c.supportedTypes||!!c.supportedTypes.rotation,h=!!c.supportedTypes&&!!c.supportedTypes.opacity,k=a.reduce(function(a,k){if(!a)return a;if(k.valueExpression)return q(e,"Could not convert visual variables: arcade expressions not supported"),null;switch(k.type){case "size":return d?w(k,a,c,e):a;case "color":return f?A(k,a,e):a;case "opacity":return h?C(k,a,e):null;
case "rotation":return g?D(k,a,e):a;default:return b.neverReached(k),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&k&&!k.size&&!k.color&&!k.opacity&&!k.rotation||k&&k.size&&!B(k.size,c,e)?null:k}function H(a,c,b){if(!!a!==!!c||a&&a.field!==c.field)return!1;if(a&&"rotation"===b)for(b=0;3>b;b++)if(a.type[b]!==c.type[b]||a.offset[b]!==c.offset[b]||a.factor[b]!==c.factor[b])return!1;return!0}function I(a,c){var b={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},e=a&&null!=a.size;a&&a.size?(b.vvSizeEnabled=!0,b.vvSizeMinSize=a.size.minSize,b.vvSizeMaxSize=a.size.maxSize,b.vvSizeOffset=a.size.offset,b.vvSizeFactor=a.size.factor):a&&e&&(b.vvSizeValue=c.transformation.scale);if(a&&e){b.vvSymbolAnchor=c.transformation.anchor;b.vvSymbolRotationMatrix=h.mat3f64.create();
g.mat4.identity(K);var f=c.transformation.rotation[2],e=c.transformation.rotation[0],n=c.transformation.rotation[1];c=K;void 0===c&&(c=d.mat4f64.create());f=f||0;e=e||0;n=n||0;0!==f&&g.mat4.rotateZ(c,c,-f/180*Math.PI);0!==e&&g.mat4.rotateX(c,c,e/180*Math.PI);0!==n&&g.mat4.rotateY(c,c,n/180*Math.PI);k.mat3.fromMat4(b.vvSymbolRotationMatrix,K)}a&&a.color&&(b.vvColorEnabled=!0,b.vvColorValues=a.color.values,b.vvColorColors=a.color.colors);a&&a.opacity&&(b.vvOpacityEnabled=!0,b.vvOpacityValues=a.opacity.values,
b.vvOpacityOpacities=a.opacity.opacityValues);return b}Object.defineProperty(a,"__esModule",{value:!0});a.evaluateModelTransformScale=a.evaluateModelTransform=a.getMaterialParams=a.updateFastSymbolUpdatesState=a.initFastSymbolUpdatesState=a.convertVisualVariables=void 0;a.convertVisualVariables=F;a.initFastSymbolUpdatesState=function(a,c){return!a||n.DISABLE_FAST_UPDATES?{enabled:!1}:(a=F(a.visualVariables,c))?{enabled:!0,visualVariables:a,materialParameters:I(a,c),requiresShaderTransformation:a&&
null!=a.size}:{enabled:!1}};a.updateFastSymbolUpdatesState=function(a,c,b){if(!c||!a.enabled)return!1;var e=a.visualVariables;c=F(c.visualVariables,b);if(!(c&&H(e.size,c.size,"size")&&H(e.color,c.color,"color")&&H(e.rotation,c.rotation,"rotation")&&H(e.opacity,c.opacity,"opacity")))return!1;a.visualVariables=c;a.materialParameters=I(c,b);a.requiresShaderTransformation=c&&null!=c.size;return!0};a.getMaterialParams=I;var G;(function(a){var b=d.mat4f64.create(),e=c.vec3f64.create();a.evaluateModelTransform=
function(a,c,d){if(!a.vvSizeEnabled)return d;g.mat4.copy(b,d);d=a.vvSymbolRotationMatrix;g.mat4.set(K,d[0],d[1],d[2],0,d[3],d[4],d[5],0,d[6],d[7],d[8],0,0,0,0,1);g.mat4.multiply(b,b,K);for(d=0;3>d;++d)e[d]=l.clamp(a.vvSizeOffset[d]+c[0]*a.vvSizeFactor[d],a.vvSizeMinSize[d],a.vvSizeMaxSize[d]);g.mat4.scale(b,b,e);g.mat4.translate(b,b,a.vvSymbolAnchor);return b};a.evaluateModelTransformScale=function(a,c,b){if(!c.vvSizeEnabled)return f.vec3.set(a,1,1,1);for(var e=0;3>e;++e)a[e]=l.clamp(c.vvSizeOffset[e]+
b[0]*c.vvSizeFactor[e],c.vvSizeMinSize[e],c.vvSizeMaxSize[e]);return a}})(G||(G={}));var K=d.mat4f64.create();a.evaluateModelTransform=G.evaluateModelTransform;a.evaluateModelTransformScale=G.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f64=void 0;a.mat3f64=b})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],
function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.createView=a.fromValues=a.clone=a.create=void 0;a.create=function(){return[1,0,0,0,1,0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]};a.fromValues=function(a,l,k,h,g,d,f,c,e){return[a,l,k,h,g,d,f,c,e]};a.createView=function(a,l){return new Float64Array(a,l,9)}})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],function(m,a,b){Object.defineProperty(a,"__esModule",
{value:!0});a.mat4=void 0;a.mat4=b})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(m,a,b,l){function k(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function h(a,b,d){var c=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],n=b[6],l=b[7],m=b[8],A=b[9],C=b[10],E=b[11],D=b[12],F=b[13],H=b[14];b=b[15];var I=d[0],G=d[1],K=d[2],L=d[3];a[0]=I*c+G*h+K*m+L*
D;a[1]=I*e+G*k+K*A+L*F;a[2]=I*f+G*n+K*C+L*H;a[3]=I*g+G*l+K*E+L*b;I=d[4];G=d[5];K=d[6];L=d[7];a[4]=I*c+G*h+K*m+L*D;a[5]=I*e+G*k+K*A+L*F;a[6]=I*f+G*n+K*C+L*H;a[7]=I*g+G*l+K*E+L*b;I=d[8];G=d[9];K=d[10];L=d[11];a[8]=I*c+G*h+K*m+L*D;a[9]=I*e+G*k+K*A+L*F;a[10]=I*f+G*n+K*C+L*H;a[11]=I*g+G*l+K*E+L*b;I=d[12];G=d[13];K=d[14];L=d[15];a[12]=I*c+G*h+K*m+L*D;a[13]=I*e+G*k+K*A+L*F;a[14]=I*f+G*n+K*C+L*H;a[15]=I*g+G*l+K*E+L*b;return a}function g(a,b,d){var c=b[0],e=b[1],f=b[2],g=b[3],h=c+c,k=e+e,n=f+f;b=c*h;var l=
c*k,c=c*n,m=e*k,e=e*n,f=f*n,h=g*h,k=g*k,g=g*n;a[0]=1-(m+f);a[1]=l+g;a[2]=c-k;a[3]=0;a[4]=l-g;a[5]=1-(b+f);a[6]=e+h;a[7]=0;a[8]=c+k;a[9]=e-h;a[10]=1-(b+m);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a}function d(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];a[3]=b[3]-d[3];a[4]=b[4]-d[4];a[5]=b[5]-d[5];a[6]=b[6]-d[6];a[7]=b[7]-d[7];a[8]=b[8]-d[8];a[9]=b[9]-d[9];a[10]=b[10]-d[10];a[11]=b[11]-d[11];a[12]=b[12]-d[12];a[13]=b[13]-d[13];a[14]=b[14]-d[14];a[15]=b[15]-d[15];return a}Object.defineProperty(a,
"__esModule",{value:!0});a.sub=a.mul=a.equals=a.exactEquals=a.multiplyScalarAndAdd=a.multiplyScalar=a.subtract=a.add=a.frob=a.str=a.targetTo=a.lookAt=a.ortho=a.perspectiveFromFieldOfView=a.perspective=a.frustum=a.fromQuat=a.fromRotationTranslationScaleOrigin=a.fromRotationTranslationScale=a.getRotation=a.getScaling=a.getTranslation=a.fromQuat2=a.fromRotationTranslation=a.fromZRotation=a.fromYRotation=a.fromXRotation=a.fromRotation=a.fromScaling=a.fromTranslation=a.rotateZ=a.rotateY=a.rotateX=a.rotate=
a.scale=a.translate=a.multiply=a.determinant=a.adjoint=a.invert=a.transpose=a.identity=a.set=a.copy=void 0;a.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};a.set=function(a,b,d,f,g,h,k,l,m,w,B,z,A,C,E,D,F){a[0]=b;a[1]=d;a[2]=f;a[3]=g;a[4]=h;a[5]=k;a[6]=l;a[7]=m;a[8]=w;a[9]=B;a[10]=z;a[11]=A;a[12]=C;a[13]=E;a[14]=D;a[15]=F;return a};a.identity=k;
a.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};a.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],m=b[8],z=b[9],A=b[10],C=b[11],E=b[12],D=
b[13],F=b[14];b=b[15];var H=c*h-d*g,I=c*k-e*g,G=c*l-f*g,K=d*k-e*h,L=d*l-f*h,O=e*l-f*k,P=m*D-z*E,N=m*F-A*E,S=m*b-C*E,W=z*F-A*D,Q=z*b-C*D,V=A*b-C*F,R=H*V-I*Q+G*W+K*S-L*N+O*P;if(!R)return null;R=1/R;a[0]=(h*V-k*Q+l*W)*R;a[1]=(e*Q-d*V-f*W)*R;a[2]=(D*O-F*L+b*K)*R;a[3]=(A*L-z*O-C*K)*R;a[4]=(k*S-g*V-l*N)*R;a[5]=(c*V-e*S+f*N)*R;a[6]=(F*G-E*O-b*I)*R;a[7]=(m*O-A*G+C*I)*R;a[8]=(g*Q-h*S+l*P)*R;a[9]=(d*S-c*Q-f*P)*R;a[10]=(E*L-D*G+b*H)*R;a[11]=(z*G-m*L-C*H)*R;a[12]=(h*N-g*W-k*P)*R;a[13]=(c*W-d*N+e*P)*R;a[14]=(D*
I-E*K-F*H)*R;a[15]=(m*K-z*I+A*H)*R;return a};a.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],m=b[8],z=b[9],A=b[10],C=b[11],E=b[12],D=b[13],F=b[14];b=b[15];a[0]=h*(A*b-C*F)-z*(k*b-l*F)+D*(k*C-l*A);a[1]=-(d*(A*b-C*F)-z*(e*b-f*F)+D*(e*C-f*A));a[2]=d*(k*b-l*F)-h*(e*b-f*F)+D*(e*l-f*k);a[3]=-(d*(k*C-l*A)-h*(e*C-f*A)+z*(e*l-f*k));a[4]=-(g*(A*b-C*F)-m*(k*b-l*F)+E*(k*C-l*A));a[5]=c*(A*b-C*F)-m*(e*b-f*F)+E*(e*C-f*A);a[6]=-(c*(k*b-l*F)-g*(e*b-f*F)+E*(e*l-f*k));a[7]=c*(k*C-
l*A)-g*(e*C-f*A)+m*(e*l-f*k);a[8]=g*(z*b-C*D)-m*(h*b-l*D)+E*(h*C-l*z);a[9]=-(c*(z*b-C*D)-m*(d*b-f*D)+E*(d*C-f*z));a[10]=c*(h*b-l*D)-g*(d*b-f*D)+E*(d*l-f*h);a[11]=-(c*(h*C-l*z)-g*(d*C-f*z)+m*(d*l-f*h));a[12]=-(g*(z*F-A*D)-m*(h*F-k*D)+E*(h*A-k*z));a[13]=c*(z*F-A*D)-m*(d*F-e*D)+E*(d*A-e*z);a[14]=-(c*(h*F-k*D)-g*(d*F-e*D)+E*(d*k-e*h));a[15]=c*(h*A-k*z)-g*(d*A-e*z)+m*(d*k-e*h);return a};a.determinant=function(a){var c=a[0],b=a[1],d=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],m=a[8],B=a[9],z=a[10],A=a[11],
C=a[12],E=a[13],D=a[14];a=a[15];return(c*h-b*g)*(z*a-A*D)-(c*k-d*g)*(B*a-A*E)+(c*l-f*g)*(B*D-z*E)+(b*k-d*h)*(m*a-A*C)-(b*l-f*h)*(m*D-z*C)+(d*l-f*k)*(m*E-B*C)};a.multiply=h;a.translate=function(a,b,d){var c=d[0],e=d[1];d=d[2];var f=void 0,g=void 0,h=void 0,k=void 0,n=void 0,l=void 0,m=void 0,A=void 0,C=void 0,E=void 0,D=void 0,F=void 0;b===a?(a[12]=b[0]*c+b[4]*e+b[8]*d+b[12],a[13]=b[1]*c+b[5]*e+b[9]*d+b[13],a[14]=b[2]*c+b[6]*e+b[10]*d+b[14],a[15]=b[3]*c+b[7]*e+b[11]*d+b[15]):(f=b[0],g=b[1],h=b[2],
k=b[3],n=b[4],l=b[5],m=b[6],A=b[7],C=b[8],E=b[9],D=b[10],F=b[11],a[0]=f,a[1]=g,a[2]=h,a[3]=k,a[4]=n,a[5]=l,a[6]=m,a[7]=A,a[8]=C,a[9]=E,a[10]=D,a[11]=F,a[12]=f*c+n*e+C*d+b[12],a[13]=g*c+l*e+E*d+b[13],a[14]=h*c+m*e+D*d+b[14],a[15]=k*c+A*e+F*d+b[15]);return a};a.scale=function(a,b,d){var c=d[0],e=d[1];d=d[2];a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=b[10]*d;a[11]=b[11]*d;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];
return a};a.rotate=function(a,b,d,f){var c=f[0],e=f[1];f=f[2];var g=Math.sqrt(c*c+e*e+f*f),h=void 0,k=void 0,n=void 0,m=void 0,t=void 0,A=void 0,C=void 0,E=void 0,D=void 0,F=void 0,H=void 0,I=void 0,G=void 0,K=void 0,L=void 0,O=void 0,P=void 0,N=void 0,S=void 0,W=void 0,Q=void 0,V=void 0,k=h=void 0;if(g<l.EPSILON)return null;g=1/g;c*=g;e*=g;f*=g;h=Math.sin(d);k=Math.cos(d);n=1-k;m=b[0];t=b[1];A=b[2];C=b[3];E=b[4];D=b[5];F=b[6];H=b[7];I=b[8];G=b[9];K=b[10];L=b[11];O=c*c*n+k;P=e*c*n+f*h;N=f*c*n-e*h;
S=c*e*n-f*h;W=e*e*n+k;Q=f*e*n+c*h;V=c*f*n+e*h;h=e*f*n-c*h;k=f*f*n+k;a[0]=m*O+E*P+I*N;a[1]=t*O+D*P+G*N;a[2]=A*O+F*P+K*N;a[3]=C*O+H*P+L*N;a[4]=m*S+E*W+I*Q;a[5]=t*S+D*W+G*Q;a[6]=A*S+F*W+K*Q;a[7]=C*S+H*W+L*Q;a[8]=m*V+E*h+I*k;a[9]=t*V+D*h+G*k;a[10]=A*V+F*h+K*k;a[11]=C*V+H*h+L*k;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};a.rotateX=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[4],f=b[5],g=b[6],h=b[7],k=b[8],n=b[9],l=b[10],m=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=
b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*d+k*c;a[5]=f*d+n*c;a[6]=g*d+l*c;a[7]=h*d+m*c;a[8]=k*d-e*c;a[9]=n*d-f*c;a[10]=l*d-g*c;a[11]=m*d-h*c;return a};a.rotateY=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[8],n=b[9],l=b[10],m=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d-k*c;a[1]=f*d-n*c;a[2]=g*d-l*c;a[3]=h*d-m*c;a[8]=e*c+k*d;a[9]=f*c+n*d;a[10]=g*c+l*d;a[11]=h*c+m*d;return a};
a.rotateZ=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[0],f=b[1],g=b[2],h=b[3],k=b[4],n=b[5],l=b[6],m=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d+k*c;a[1]=f*d+n*c;a[2]=g*d+l*c;a[3]=h*d+m*c;a[4]=k*d-e*c;a[5]=n*d-f*c;a[6]=l*d-g*c;a[7]=m*d-h*c;return a};a.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};
a.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotation=function(a,b,d){var c=d[0],e=d[1];d=d[2];var f=Math.sqrt(c*c+e*e+d*d),g=void 0,h=void 0,k=void 0;if(f<l.EPSILON)return null;f=1/f;c*=f;e*=f;d*=f;g=Math.sin(b);h=Math.cos(b);k=1-h;a[0]=c*c*k+h;a[1]=e*c*k+d*g;a[2]=d*c*k-e*g;a[3]=0;a[4]=c*e*k-d*g;a[5]=e*e*k+h;a[6]=d*e*k+c*g;a[7]=0;a[8]=c*d*k+e*g;a[9]=e*d*k-c*g;a[10]=d*d*k+
h;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromXRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromYRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromZRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=
b;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotationTranslation=g;a.fromQuat2=function(a,b){var c=f,d=-b[0],e=-b[1],h=-b[2],k=b[3],l=b[4],m=b[5],w=b[6],B=b[7],z=d*d+e*e+h*h+k*k;0<z?(c[0]=2*(l*k+B*d+m*h-w*e)/z,c[1]=2*(m*k+B*e+w*d-l*h)/z,c[2]=2*(w*k+B*h+l*e-m*d)/z):(c[0]=2*(l*k+B*d+m*h-w*e),c[1]=2*(m*k+B*e+w*d-l*h),c[2]=2*(w*k+B*h+l*e-m*d));g(a,b,c);return a};var f=b.create();a.getTranslation=function(a,b){a[0]=b[12];
a[1]=b[13];a[2]=b[14];return a};a.getScaling=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[4],g=b[5],h=b[6],k=b[8],l=b[9];b=b[10];a[0]=Math.sqrt(c*c+d*d+e*e);a[1]=Math.sqrt(f*f+g*g+h*h);a[2]=Math.sqrt(k*k+l*l+b*b);return a};a.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;0<c?(d=2*Math.sqrt(c+1),a[3]=.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&&b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?
(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=(b[1]+b[4])/d,a[1]=.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=.25*d);return a};a.fromRotationTranslationScale=function(a,b,d,f){var c=b[0],e=b[1],g=b[2],h=b[3],k=c+c,n=e+e,l=g+g;b=c*k;var m=c*n,c=c*l,t=e*n,e=e*l,g=g*l,k=h*k,n=h*n,h=h*l,l=f[0],C=f[1];f=f[2];a[0]=(1-(t+g))*l;a[1]=(m+h)*l;a[2]=(c-n)*l;a[3]=0;a[4]=(m-h)*C;a[5]=(1-(b+g))*C;a[6]=(e+k)*C;a[7]=0;a[8]=(c+
n)*f;a[9]=(e-k)*f;a[10]=(1-(b+t))*f;a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a};a.fromRotationTranslationScaleOrigin=function(a,b,d,f,g){var c=b[0],e=b[1],h=b[2],k=b[3],n=c+c,l=e+e,m=h+h;b=c*n;var t=c*l,x=c*m,c=e*l,e=e*m,E=h*m,h=k*n,l=k*l,D=k*m,F=f[0],H=f[1],m=f[2];f=g[0];k=g[1];g=g[2];var n=(1-(c+E))*F,I=(t+D)*F,F=(x-l)*F,t=(t-D)*H,E=(1-(b+E))*H,H=(e+h)*H,x=(x+l)*m,e=(e-h)*m;b=(1-(b+c))*m;a[0]=n;a[1]=I;a[2]=F;a[3]=0;a[4]=t;a[5]=E;a[6]=H;a[7]=0;a[8]=x;a[9]=e;a[10]=b;a[11]=0;a[12]=d[0]+
f-(n*f+t*k+x*g);a[13]=d[1]+k-(I*f+E*k+e*g);a[14]=d[2]+g-(F*f+H*k+b*g);a[15]=1;return a};a.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,g=d+d,h=e+e,c=c*f,k=d*f,d=d*g,l=e*f,m=e*g,e=e*h,f=b*f,g=b*g;b*=h;a[0]=1-d-e;a[1]=k+b;a[2]=l-g;a[3]=0;a[4]=k-b;a[5]=1-c-e;a[6]=m+f;a[7]=0;a[8]=l+g;a[9]=m-f;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.frustum=function(a,b,d,f,g,h,k){var c=1/(d-b),e=1/(g-f),n=1/(h-k);a[0]=2*h*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*h*e;a[6]=0;a[7]=
0;a[8]=(d+b)*c;a[9]=(g+f)*e;a[10]=(k+h)*n;a[11]=-1;a[12]=0;a[13]=0;a[14]=k*h*2*n;a[15]=0;return a};a.perspective=function(a,b,d,f,g){b=1/Math.tan(b/2);var c=void 0;a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;null!=g&&Infinity!==g?(c=1/(f-g),a[10]=(g+f)*c,a[14]=2*g*f*c):(a[10]=-1,a[14]=-2*f);return a};a.perspectiveFromFieldOfView=function(a,b,d,f){var c=Math.tan(b.upDegrees*Math.PI/180),e=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*
Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var h=2/(g+b),k=2/(c+e);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=k;a[6]=0;a[7]=0;a[8]=-((g-b)*h*.5);a[9]=(c-e)*k*.5;a[10]=f/(d-f);a[11]=-1;a[12]=0;a[13]=0;a[14]=f*d/(d-f);a[15]=0;return a};a.ortho=function(a,b,d,f,g,h,k){var c=1/(b-d),e=1/(f-g),n=1/(h-k);a[0]=-2*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*e;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*n;a[11]=0;a[12]=(b+d)*c;a[13]=(g+f)*e;a[14]=(k+h)*n;a[15]=1;return a};a.lookAt=function(a,b,d,f){var c=void 0,e=
void 0,g=void 0,h=void 0,n=void 0,m=void 0,t=void 0,z=void 0,A=void 0,C=void 0,E=b[0],D=b[1];b=b[2];g=f[0];h=f[1];f=f[2];t=d[0];z=d[1];d=d[2];if(Math.abs(E-t)<l.EPSILON&&Math.abs(D-z)<l.EPSILON&&Math.abs(b-d)<l.EPSILON)return k(a);t=E-t;z=D-z;A=b-d;C=1/Math.sqrt(t*t+z*z+A*A);t*=C;z*=C;A*=C;c=h*A-f*z;e=f*t-g*A;g=g*z-h*t;(C=Math.sqrt(c*c+e*e+g*g))?(C=1/C,c*=C,e*=C,g*=C):g=e=c=0;h=z*g-A*e;n=A*c-t*g;m=t*e-z*c;(C=Math.sqrt(h*h+n*n+m*m))?(C=1/C,h*=C,n*=C,m*=C):m=n=h=0;a[0]=c;a[1]=h;a[2]=t;a[3]=0;a[4]=e;
a[5]=n;a[6]=z;a[7]=0;a[8]=g;a[9]=m;a[10]=A;a[11]=0;a[12]=-(c*E+e*D+g*b);a[13]=-(h*E+n*D+m*b);a[14]=-(t*E+z*D+A*b);a[15]=1;return a};a.targetTo=function(a,b,d,f){var c=b[0],e=b[1];b=b[2];var g=f[0],h=f[1],k=f[2];f=c-d[0];var n=e-d[1];d=b-d[2];var l=f*f+n*n+d*d;0<l&&(l=1/Math.sqrt(l),f*=l,n*=l,d*=l);var m=h*d-k*n,k=k*f-g*d,g=g*n-h*f,l=m*m+k*k+g*g;0<l&&(l=1/Math.sqrt(l),m*=l,k*=l,g*=l);a[0]=m;a[1]=k;a[2]=g;a[3]=0;a[4]=n*g-d*k;a[5]=d*m-f*g;a[6]=f*k-n*m;a[7]=0;a[8]=f;a[9]=n;a[10]=d;a[11]=0;a[12]=c;a[13]=
e;a[14]=b;a[15]=1;return a};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],
2)+Math.pow(a[14],2)+Math.pow(a[15],2))};a.add=function(a,b,d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];a[3]=b[3]+d[3];a[4]=b[4]+d[4];a[5]=b[5]+d[5];a[6]=b[6]+d[6];a[7]=b[7]+d[7];a[8]=b[8]+d[8];a[9]=b[9]+d[9];a[10]=b[10]+d[10];a[11]=b[11]+d[11];a[12]=b[12]+d[12];a[13]=b[13]+d[13];a[14]=b[14]+d[14];a[15]=b[15]+d[15];return a};a.subtract=d;a.multiplyScalar=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*d;a[5]=b[5]*d;a[6]=b[6]*d;a[7]=b[7]*d;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=
b[10]*d;a[11]=b[11]*d;a[12]=b[12]*d;a[13]=b[13]*d;a[14]=b[14]*d;a[15]=b[15]*d;return a};a.multiplyScalarAndAdd=function(a,b,d,f){a[0]=b[0]+d[0]*f;a[1]=b[1]+d[1]*f;a[2]=b[2]+d[2]*f;a[3]=b[3]+d[3]*f;a[4]=b[4]+d[4]*f;a[5]=b[5]+d[5]*f;a[6]=b[6]+d[6]*f;a[7]=b[7]+d[7]*f;a[8]=b[8]+d[8]*f;a[9]=b[9]+d[9]*f;a[10]=b[10]+d[10]*f;a[11]=b[11]+d[11]*f;a[12]=b[12]+d[12]*f;a[13]=b[13]+d[13]*f;a[14]=b[14]+d[14]*f;a[15]=b[15]+d[15]*f;return a};a.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&
a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};a.equals=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],m=a[7],B=a[8],z=a[9],A=a[10],C=a[11],E=a[12],D=a[13],F=a[14];a=a[15];var H=b[0],I=b[1],G=b[2],K=b[3],L=b[4],O=b[5],P=b[6],N=b[7],S=b[8],W=b[9],Q=b[10],V=b[11],R=b[12],T=b[13],X=b[14];b=b[15];return Math.abs(c-H)<=l.EPSILON*Math.max(1,Math.abs(c),
Math.abs(H))&&Math.abs(d-I)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(e-G)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(G))&&Math.abs(f-K)<=l.EPSILON*Math.max(1,Math.abs(f),Math.abs(K))&&Math.abs(g-L)<=l.EPSILON*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(h-O)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(k-P)<=l.EPSILON*Math.max(1,Math.abs(k),Math.abs(P))&&Math.abs(m-N)<=l.EPSILON*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(B-S)<=l.EPSILON*Math.max(1,Math.abs(B),Math.abs(S))&&
Math.abs(z-W)<=l.EPSILON*Math.max(1,Math.abs(z),Math.abs(W))&&Math.abs(A-Q)<=l.EPSILON*Math.max(1,Math.abs(A),Math.abs(Q))&&Math.abs(C-V)<=l.EPSILON*Math.max(1,Math.abs(C),Math.abs(V))&&Math.abs(E-R)<=l.EPSILON*Math.max(1,Math.abs(E),Math.abs(R))&&Math.abs(D-T)<=l.EPSILON*Math.max(1,Math.abs(D),Math.abs(T))&&Math.abs(F-X)<=l.EPSILON*Math.max(1,Math.abs(F),Math.abs(X))&&Math.abs(a-b)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};a.mul=h;a.sub=d})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require",
"exports","./factories/mat4f64"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f64=void 0;a.mat4f64=b})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(m,a){function b(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.IDENTITY=a.createView=a.fromValues=a.clone=a.create=void 0;a.create=b;a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],
a[14],a[15]]};a.fromValues=function(a,b,h,g,d,f,c,e,n,m,x,p,q,u,y,w){return[a,b,h,g,d,f,c,e,n,m,x,p,q,u,y,w]};a.createView=function(a,b){return new Float64Array(a,b,16)};a.IDENTITY=b()})},"esri/views/3d/support/debugFlags":function(){define(["require","exports","tslib","../../../core/Accessor","../../../core/accessorSupport/decorators"],function(m,a,b,l,k){return new (function(a){function g(){var b=null!==a&&a.apply(this,arguments)||this;b.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;b.SCENEVIEW_LOCKING_LOG=
!1;b.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;b.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;b.DECONFLICTOR_SHOW_VISIBLE=!1;b.DECONFLICTOR_SHOW_INVISIBLE=!1;b.DECONFLICTOR_SHOW_GRID=!1;b.LABELS_SHOW_BORDER=!1;b.OVERLAY_DRAW_DEBUG_TEXTURE=!1;b.OVERLAY_SHOW_CENTER=!1;b.SHOW_POI=!1;b.TERRAIN_DEBUG_POPUP=!1;b.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;b.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1;b.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1;b.DRAW_MESH_GEOMETRY_NORMALS=!1;b.FEATURE_TILE_FETCH_SHOW_TILES=!1;b.FEATURE_TILE_TREE_SHOW_TILES=
!1;b.I3S_TREE_SHOW_TILES=!1;b.I3S_SHOW_MODIFICATIONS=!1;b.ENABLE_PROFILE_DEPTH_RANGE=!1;b.DISABLE_FAST_UPDATES=!1;b.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;b.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;b.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return b}b.__extends(g,a);b.__decorate([k.property()],g.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);b.__decorate([k.property()],g.prototype,"SCENEVIEW_LOCKING_LOG",void 0);b.__decorate([k.property()],g.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",
void 0);b.__decorate([k.property()],g.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);b.__decorate([k.property()],g.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0);b.__decorate([k.property()],g.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0);b.__decorate([k.property()],g.prototype,"DECONFLICTOR_SHOW_GRID",void 0);b.__decorate([k.property()],g.prototype,"LABELS_SHOW_BORDER",void 0);b.__decorate([k.property()],g.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0);b.__decorate([k.property()],g.prototype,
"OVERLAY_SHOW_CENTER",void 0);b.__decorate([k.property()],g.prototype,"SHOW_POI",void 0);b.__decorate([k.property()],g.prototype,"TERRAIN_DEBUG_POPUP",void 0);b.__decorate([k.property()],g.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);b.__decorate([k.property()],g.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);b.__decorate([k.property()],g.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);b.__decorate([k.property()],g.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0);
b.__decorate([k.property()],g.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);b.__decorate([k.property()],g.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);b.__decorate([k.property()],g.prototype,"I3S_TREE_SHOW_TILES",void 0);b.__decorate([k.property()],g.prototype,"I3S_SHOW_MODIFICATIONS",void 0);b.__decorate([k.property()],g.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);b.__decorate([k.property()],g.prototype,"DISABLE_FAST_UPDATES",void 0);b.__decorate([k.property()],g.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",
void 0);b.__decorate([k.property()],g.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);b.__decorate([k.property()],g.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return g=b.__decorate([k.subclass("esri.views.3d.support.DebugFlags")],g)}(l))})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("require exports tslib ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/geodesicConstants ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/definitions ../Store2D ./FeatureSetReaderJSON".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w){Object.defineProperty(a,"__esModule",{value:!0});a.ClusterStore=void 0;var B=function(a){function c(c,b,d,e,f){var g=this;b=new p.default([],[b,d]);g=a.call(this,b,e,null,c)||this;g.geohashBoundsInfo=f;return g}b.__extends(c,a);Object.defineProperty(c.prototype,"count",{get:function(){return this.attributes.cluster_count},enumerable:!1,configurable:!0});c.create=function(a,b,d,e,f,g,h,k){b=new c(b,d,e,g,h);b.displayId=a.createDisplayId(!0);b.referenceId=
k;b.tileLevel=f;return b};c.prototype.update=function(a,c,b,d,e,f){this.geometry.coords[0]=a;this.geometry.coords[1]=c;this.tileLevel=b;this.attributes=d;this.geohashBoundsInfo=e;this.referenceId=null;this.referenceId=f;return this};c.prototype.toJSON=function(){return{objectId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null,attributes:b.__assign(b.__assign({},this.attributes),{clusterId:this.objectId}),geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};
return c}(x.default);m=function(a){function p(c,b,d){var e=a.call(this,c,d)||this;e.events=new k;e._geohashLevel=0;e._aggregateValueRanges={};e._aggregateValueRangesChanged=!1;e._geohashBuf=[];e._clusters=new Map;e._tiles=new Map;e.geometryInfo=c.geometryInfo;e._spatialReference=b;e._projectionSupportCheck=q.checkProjectionSupport(b,l.SpatialReference.WGS84);e._bitsets.geohash=d.getBitset(d.createBitset());e._bitsets.inserted=d.getBitset(d.createBitset());return e}b.__extends(p,a);p.prototype.updateSchema=
function(c,e){return b.__awaiter(this,void 0,void 0,function(){var k,n;return b.__generator(this,function(b){switch(b.label){case 0:k=this._schema,b.label=1;case 1:return b.trys.push([1,4,,5]),[4,a.prototype.updateSchema.call(this,c,e)];case 2:return b.sent(),[4,this._projectionSupportCheck];case 3:return b.sent(),[3,5];case 4:return b.sent(),[3,5];case 5:n=d.diff(k,e);c.mesh&&(c.targets.aggregate=!0);if(!e||g.isNone(n)&&!c.source&&!c.storage.filters)return[2];if(d.hasDiff(n,"params.fields")||!this._tree||
c.source)this._tree=new f.GeohashTree(e.params.fields,this._statisticFields),this._rebuildTree(),h("esri-2d-update-debug")&&console.debug("Aggregate mesh needs update due to tree changing");h("esri-2d-update-debug")&&console.debug("Applying Update - ClusterStore:",n);c.mesh=!0;c.targets[e.name]=!0;this._aggregateValueRanges={};return[2]}})})};p.prototype.sweepFeatures=function(a,c){var b=this;this._bitsets.inserted.forEachSet(function(d){a.has(d)||(d=c.lookupByDisplayIdUnsafe(d),b._remove(d))})};
p.prototype.sweepClusters=function(a,c){var b=this;this._clusters.forEach(function(d,e){d&&d.tileLevel!==c&&(a.releaseDisplayId(d.displayId),b._clusters.delete(e))})};p.prototype.onTileData=function(a,c,b,d,e,f){if(!this._schema||g.isNone(c.addOrUpdate))return c;d=this._tree;for(var h=this._getTransforms(a,this._spatialReference),k=c.addOrUpdate.getCursor();k.next();)this._update(k,e,d);if(!f)return c;e=[];this._getClustersForTile(e,a,this._schema.params.clusterRadius,b,d,h);c.type="replace"===c.type?
"replace":"update";c.addOrUpdate=w.FeatureSetReaderJSON.fromOptimizedFeatures(e,"esriGeometryPoint");c.addOrUpdate._storage=b;for(k=c.addOrUpdate.getCursor();k.next();)e=k.getDisplayId(),this._bitsets.computed.unset(e),this.setComputedAttributes(b,k,e,a.scale);this._aggregateValueRangesChanged&&c.end&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1);return c};p.prototype.onTileUpdate=function(a){var c=this,b=a.added;a=a.removed;
b.length&&this._setGeohashLevel(b[0].level);if(this._schema){var d=this._schema.params.clusterRadius;a.forEach(function(a){c._tiles.delete(a.key.id);c._markTileClustersForDeletion(a,d)})}};p.prototype.getAggregate=function(a){var c=null;this._clusters.forEach(function(b){b&&b.displayId===a&&(c=b.toJSON())});return c};p.prototype.getDisplayId=function(a){return(a=this._clusters.get(a))?a.displayId:null};p.prototype.getDisplayIdForReferenceId=function(a){var c;this._clusters.forEach(function(b){b&&
b.referenceId===a&&(c=b.displayId)});return c};p.prototype.getAggregateValueRanges=function(){return this._aggregateValueRanges};p.prototype._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};p.prototype._remove=function(a){var c=a.getDisplayId(),b=a.getXHydrate(),d=a.getYHydrate(),e=this._geohashBuf[2*c],f=this._geohashBuf[2*c+1];this._bitsets.inserted.has(c)&&(this._bitsets.inserted.unset(c),this._tree.removeCursor(a,b,d,e,f,this._geohashLevel))};
p.prototype._update=function(a,c,b){var d=a.getDisplayId(),e=this._bitsets.inserted;c=c.isVisible(d);var f=e.has(d);c!==f&&(c?(c=a.getXHydrate(),f=a.getYHydrate(),this._setGeohash(d,c,f)&&(b.insertCursor(a,d,c,f,this._geohashBuf[2*d],this._geohashBuf[2*d+1],this._geohashLevel),e.set(d))):this._remove(a))};p.prototype._setGeohash=function(a,b,d){if(this._bitsets.geohash.has(a))return!0;var f=this._geohashBuf;if(this._spatialReference.isWebMercator)b=b/e.earthRadius*57.29577951308232,c.setGeohashBuf(f,
a,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*d/e.earthRadius))),b-360*Math.floor((b+180)/360),12);else{d=q.project({x:b,y:d},this._spatialReference,l.SpatialReference.WGS84);if(!d)return!1;c.setGeohashBuf(f,a,d.y,d.x,12)}this._bitsets.geohash.set(a);return!0};p.prototype._getClustersForTile=function(a,c,d,e,f,h,k){void 0===k&&(k=!0);var n=this._schema.params.clusterPixelBuffer;d*=2;var l=this._getGeohashLevel(c.key.level),p=Math.pow(2,c.key.level)*Math.ceil(u.TILE_SIZE/d),q=Math.ceil(n/
d)+0,m=Math.ceil(u.TILE_SIZE/d),w=c.key,n=Math.floor(w.col*u.TILE_SIZE/d)-q;d=Math.floor(w.row*u.TILE_SIZE/d)-q;for(var w=n+m+2*q,q=d+m+2*q,y=c.tileInfoView.getLODInfoAt(c.key.level),C=n;C<=w;C++)for(var n=function(d){var n=C;y.wrap&&(n=0>C?C+p:C%p);var q=y.wrap&&0>C,m=y.wrap&&C%p!==C;d=B._lookupCluster(e,y,c.key.level,n,d,l,f);if(g.isSome(d)){n=g.andThen(h,function(a){return q?a.left:m?a.right:a.tile});if(k&&g.isNone(n)||!d.count)return"continue";if(g.isSome(n)&&k){var u=d.geometry.clone(),w=d.attributes;
u.coords[0]=t.quantizeX(n,u.coords[0]);u.coords[1]=t.quantizeY(n,u.coords[1]);1===d.count&&g.isSome(d.referenceId)&&(w=b.__assign(b.__assign({},d.attributes),{referenceId:d.referenceId}));n=new x.default(u,w);n.displayId=d.displayId;a.push(n)}}},B=this,m=d;m<=q;m++)n(m)};p.prototype._getGeohashLevel=function(a){return Math.min(Math.ceil(a/2+2),12)};p.prototype._setGeohashLevel=function(a){a=this._getGeohashLevel(a);a=1*(Math.floor(a/1)+1)-1;this._geohashLevel!==a&&(this._geohashLevel=a,this._rebuildTree())};
p.prototype._getTransforms=function(a,c){var d={originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]};c=n.getInfo(c);if(!c)return{tile:d,left:null,right:null};var e=c.valid;c=e[0];var f=e[1],e=b.__assign(b.__assign({},d),{translate:[f,a.bounds[3]]});a=b.__assign(b.__assign({},d),{translate:[c-f+a.bounds[0],a.bounds[3]]});return{tile:d,left:e,right:a}};p.prototype._getClusterId=function(a,c,b){return(a&15)<<28|(c&16383)<<14|b&16383};p.prototype._markForDeletion=
function(a,c,b){a=this._getClusterId(a,c,b);this._clusters.delete(a)};p.prototype._getClusterBounds=function(a,c,b){var d=this._schema.params.clusterRadius,e=2*d;c=b%2?c*e:c*e+d;var f=b*e,d=f/u.TILE_SIZE;b=(c+e)/u.TILE_SIZE;e=(f-e)/u.TILE_SIZE;c=a.getXForColumn(c/u.TILE_SIZE);d=a.getYForRow(d);b=a.getXForColumn(b);a=a.getYForRow(e);return[c,d,b,a]};p.prototype._lookupCluster=function(a,d,f,h,k,n,p){var m=this._getClusterId(f,h,k),u=this._clusters.get(m),t=this._getClusterBounds(d,h,k);d=t[0];h=t[1];
k=t[2];var t=t[3],w={x:d,y:h},y={x:k,y:t},x=0,C=0,z=0,A=0;if(this._spatialReference.isWebMercator)z=w.x/e.earthRadius*57.29577951308232,x=z-360*Math.floor((z+180)/360),C=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*w.y/e.earthRadius))),z=y.x/e.earthRadius*57.29577951308232,z-=360*Math.floor((z+180)/360),A=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*y.y/e.earthRadius)));else{C=q.project(w,this._spatialReference,l.SpatialReference.WGS84);y=q.project(y,this._spatialReference,l.SpatialReference.WGS84);
if(!C||!y)return null;x=C.x;C=C.y;z=y.x;A=y.y}x>z&&(z=180);w={geohashX:0,geohashY:0};y={geohashX:0,geohashY:0};c.setGeohashXY(w,C,x,n);c.setGeohashXY(y,A,z,n);C=w.geohashX;z=w.geohashY;A=y.geohashX;y=y.geohashY;x={xLL:C,yLL:z,xTR:A,yTR:y,level:n};C=p.getRegionStatistics(C,z,A,y,n);n=C.count;z=C.xTotal;y=C.yTotal;p=C.referenceId;z=n?z/n:0;y=n?y/n:0;if(0===n)return this._clusters.set(m,null),null;C=b.__assign({cluster_count:n},C.attributes);a=g.isSome(u)?u.update(z,y,f,C,x,p):B.create(a,m,z,y,f,C,x,
p);0===n&&(a.geometry.coords[0]=(d+k)/2,a.geometry.coords[1]=(h+t)/2);this._clusters.set(m,a);this._updateAggregateValueRangeForCluster(a,a.tileLevel);return a};p.prototype._updateAggregateValueRangeForCluster=function(a,c){var b=this._aggregateValueRanges[c]||{minValue:Infinity,maxValue:0},d=b.minValue,e=b.maxValue;b.minValue=Math.min(d,a.count);b.maxValue=Math.max(e,a.count);this._aggregateValueRanges[c]=b;if(d!==b.minValue||e!==b.maxValue)this._aggregateValueRangesChanged=!0};p.prototype._markTileClustersForDeletion=
function(a,c){var b=2*c;c=Math.ceil(u.TILE_SIZE/b);for(var d=a.key,e=Math.floor(d.col*u.TILE_SIZE/b),b=Math.floor(d.row*u.TILE_SIZE/b),d=e;d<e+c;d++)for(var f=b;f<b+c;f++)this._markForDeletion(a.key.level,d,f)};return p}(y.Store2D);a.ClusterStore=m})},"esri/geohash/GeohashTree":function(){define(["require","exports","../core/CircularArray","../core/maybe","./geohashUtils"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.GeohashTree=void 0;m=function(){function a(a,f,c){void 0===
c&&(c=8096);this._nodes=0;this._root=new h(0,0,0);this._fields=a;this._statisticFields=f;this._pool=c?new b.default(8096):null}a.prototype._acquire=function(a,b,c){this._nodes++;var d=null;l.isSome(this._pool)&&(d=this._pool.dequeue());return l.isSome(d)?d.realloc(a,b,c):new h(a,b,c)};a.prototype._release=function(a){this._nodes--;l.isSome(this._pool)&&this._pool.enqueue(a)};Object.defineProperty(a.prototype,"count",{get:function(){return this._root.count},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"size",{get:function(){return this._nodes},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"poolSize",{get:function(){return l.mapOr(this._pool,0,function(a){return a.size})},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"depth",{get:function(){var a=0;this._forEachNode(function(b){return a=Math.max(a,b.depth)});return a},enumerable:!1,configurable:!0});a.prototype.dropLevels=function(a){var b=this;this._forEachNode(function(c){if(c.depth>=a)for(var d=0;d<c.children.length;d++){var f=
c.children[d];c.children[d]=null;f&&b._release(f)}})};a.prototype.clear=function(){this.dropLevels(0)};a.prototype.insert=function(a,b,c){void 0===c&&(c=0);for(var d=this._root,f=0,g=0,h=0;null!==d;){d.depth>=c&&(d.count+=1,d.xTotal+=a.geometry.coords[0],d.yTotal+=a.geometry.coords[1],d.xGeohashTotal+=a.geohashX,d.yGeohashTotal+=a.geohashY,d.displayId=a.displayId,this._updateStatistics(a,d,1));if(f>=b)break;var k=Math.ceil((f+1)/2),l=Math.floor((f+1)/2),m=1-f%2,y=30-(3*k+2*l),k=30-(2*k+3*l),y=(a.geohashX&
7*m+3*(1-m)<<y)>>y,k=(a.geohashY&3*m+7*(1-m)<<k)>>k,l=y+k*(8*m+4*(1-m)),w=2*m+3*(1-m),g=g<<3*m+2*(1-m)|y,h=h<<w|k;null==d.children[l]&&(d.children[l]=this._acquire(g,h,f+1));f+=1;d=d.children[l]}};a.prototype.insertCursor=function(a,b,c,e,g,h,k,l){void 0===l&&(l=0);for(var d=this._root,f=0,n=0,p=0;null!==d;){d.depth>=l&&(d.count+=1,d.xTotal+=c,d.yTotal+=e,d.xGeohashTotal+=g,d.yGeohashTotal+=h,d.displayId=b,this._updateStatisticsCursor(a,d,1));if(f>=k)break;var m=Math.ceil((f+1)/2),t=Math.floor((f+
1)/2),x=1-f%2,C=30-(3*m+2*t),m=30-(2*m+3*t),C=(g&7*x+3*(1-x)<<C)>>C,m=(h&3*x+7*(1-x)<<m)>>m,t=C+m*(8*x+4*(1-x)),E=2*x+3*(1-x),n=n<<3*x+2*(1-x)|C,p=p<<E|m;null==d.children[t]&&(d.children[t]=this._acquire(n,p,f+1));f+=1;d=d.children[t]}};a.prototype.remove=function(a,b){for(var c=this._root,d=0;null!==c;){--c.count;c.xTotal-=a.geometry.coords[0];c.yTotal-=a.geometry.coords[1];c.xGeohashTotal-=a.geohashX;c.yGeohashTotal-=a.geohashY;this._updateStatistics(a,c,-1);if(d>=b)break;var f=Math.ceil((d+1)/
2),g=Math.floor((d+1)/2),h=1-d%2,k=30-(3*f+2*g),f=30-(2*f+3*g),h=((a.geohashX&7*h+3*(1-h)<<k)>>k)+((a.geohashY&3*h+7*(1-h)<<f)>>f)*(8*h+4*(1-h)),k=c.children[h];1===k.count&&(this._release(k),c.children[h]=null);d+=1;c=k}};a.prototype.removeCursor=function(a,b,c,e,g,h){for(var d=this._root,f=0;null!==d;){--d.count;d.xTotal-=b;d.yTotal-=c;d.xGeohashTotal-=e;d.yGeohashTotal-=g;this._updateStatisticsCursor(a,d,-1);if(f>=h)break;var k=Math.ceil((f+1)/2),n=Math.floor((f+1)/2),l=1-f%2,m=30-(3*k+2*n),k=
30-(2*k+3*n),l=((e&7*l+3*(1-l)<<m)>>m)+((g&3*l+7*(1-l)<<k)>>k)*(8*l+4*(1-l)),m=d.children[l];1===m.count&&(this._release(m),d.children[l]=null);f+=1;d=m}};a.prototype.find=function(a,b,c){return this._root.find(a,b,c,0,0,0)};a.prototype.findSingleOccupancyNode=function(a,b,c,e,g){for(var d=this._root;null!==d;){var f=d.depth,h=d.xNode,k=d.yNode,n=1-f%2,l=d.xGeohashTotal/d.count,m=d.yGeohashTotal/d.count;if(1===d.count&&a<l&&l<=c&&b<m&&m<=e)return d;if(f>=g)d=d.next;else{for(var l=Math.ceil((f+1)/
2),f=Math.floor((f+1)/2),B=30-(3*l+2*f),l=30-(2*l+3*f),z=~((1<<B)-1),m=~((1<<l)-1),h=h<<3*n+2*(1-n),k=k<<2*n+3*(1-n),f=Math.max(h,(a&z)>>B),B=Math.min(h+8*n+4*(1-n),(c&z)>>B),z=Math.min(k+4*n+8*(1-n),(e&m)>>l),A=null,C=null,l=Math.max(k,(b&m)>>l);l<=z;l++)for(m=f;m<=B;m++){var E=d.children[m-h+(l-k)*(8*n+4*(1-n))];E&&(A||(A=E,A.next=d.next),C&&(C.next=E),C=E,E.next=d.next)}d=A||d.next}}return null};a.prototype.getRegionStatistics=function(a,b,c,e,g){for(var d=this._root,f=0,h=0,k=0,n={},l=0;null!==
d;){var m=d.depth,B=d.xNode,z=d.yNode;if(m>=g){var A=d.xGeohashTotal/d.count,C=d.yGeohashTotal/d.count;a<A&&A<=c&&b<C&&C<=e&&(f+=d.count,h+=d.xTotal,k+=d.yTotal,1===d.count&&(l=d.displayId),this._aggregateStatistics(n,d.statistics));d=d.next}else{for(var E=Math.ceil((m+1)/2),D=Math.floor((m+1)/2),m=1-m%2,F=30-(3*E+2*D),A=30-(2*E+3*D),H=~((1<<F)-1),C=~((1<<A)-1),B=B<<3*m+2*(1-m),z=z<<2*m+3*(1-m),E=Math.max(B,(a&H)>>F),D=Math.max(z,(b&C)>>A),F=Math.min(B+8*m+4*(1-m),(c&H)>>F),H=Math.min(z+4*m+8*(1-
m),(e&C)>>A),I=null,G=null,K=D;K<=H;K++)for(var L=E;L<=F;L++){var O=d.children[L-B+(K-z)*(8*m+4*(1-m))];O&&(K!==D&&K!==H&&L!==E&&L!==F?(A=O.xGeohashTotal/O.count,C=O.yGeohashTotal/O.count,a<A&&A<=c&&b<C&&C<=e&&(f+=O.count,h+=O.xTotal,k+=O.yTotal,1===O.count&&(l=O.displayId),this._aggregateStatistics(n,O.statistics))):(I||(I=O,I.next=d.next),G&&(G.next=O),G=O,O.next=d.next))}d=I||d.next}}a=this._normalizeStatistics(n,f);return{count:f,attributes:a,xTotal:h,yTotal:k,referenceId:l}};a.prototype._forEachNode=
function(a){for(var b=this._root;null!==b;){var c=this._linkChildren(b)||b.next;a(b);b=c}};a.prototype._linkChildren=function(a){for(var b=null,c=null,d=0;d<=a.children.length;d++){var g=a.children[d];g&&(b||(b=g,b.next=a.next),c&&(c.next=g),c=g,g.next=a.next)}return b};a.prototype._updateStatistics=function(a,b,c){for(var d=0,f=this._fields;d<f.length;d++){var g=f[d],h=g.name,k=a.attributes[g.outStatistic.onStatisticField];switch(g.outStatistic.statisticType){case "norm":b.statistics[h]||(b.statistics[h]=
{});var g=a.attributes[g.outStatistic.onStatisticNormalizationField],l=b.statistics[h].onStatisticField||0,m=b.statistics[h].onStatisticNormalizationField||0;null==k||isNaN(k)||null==g||0===g||isNaN(g)||(b.statistics[h].onStatisticField=l+c*k,b.statistics[h].onStatisticNormalizationField=m+c*g);break;case "sum":case "avg":b.statistics[h]||(b.statistics[h]={value:0,nanCount:0});l=b.statistics[h].value;g=b.statistics[h].nanCount;null==k||isNaN(k)?b.statistics[h].nanCount=g+c:b.statistics[h].value=l+
c*k;break;case "avg_angle":b.statistics[h]||(b.statistics[h]={x:0,y:0,nanCount:0});var l=b.statistics[h].x,m=b.statistics[h].y,g=b.statistics[h].nanCount,y=Math.PI/180;null==k||isNaN(k)?b.statistics[h].nanCount=g+c:(b.statistics[h].x=l+c*Math.cos(k*y),b.statistics[h].y=m+c*Math.sin(k*y));break;case "mode":b.statistics[h]||(b.statistics[h]={}),l=b.statistics[h][k]||0,b.statistics[h][k]=l+c}}};a.prototype._updateStatisticsCursor=function(a,b,c){for(var d=0,f=this._statisticFields;d<f.length;d++){var g=
f[d],h=g.name,k=g.inField?a.readAttribute(g.inField):a.getComputedNumericAtIndex(g.inFieldIndex);switch(g.statisticType){case "norm":b.statistics[h]||(b.statistics[h]={});var g=a.readAttribute(g.inNormalizationField),l=b.statistics[h].onStatisticField||0,m=b.statistics[h].onStatisticNormalizationField||0;null==k||isNaN(k)||null==g||0===g||isNaN(g)||(b.statistics[h].onStatisticField=l+c*k,b.statistics[h].onStatisticNormalizationField=m+c*g);break;case "sum":case "avg":b.statistics[h]||(b.statistics[h]=
{value:0,nanCount:0});l=b.statistics[h].value;g=b.statistics[h].nanCount;null==k||isNaN(k)?b.statistics[h].nanCount=g+c:b.statistics[h].value=l+c*k;break;case "avg_angle":b.statistics[h]||(b.statistics[h]={x:0,y:0,nanCount:0});var l=b.statistics[h].x,m=b.statistics[h].y,g=b.statistics[h].nanCount,y=Math.PI/180;null==k||isNaN(k)?b.statistics[h].nanCount=g+c:(b.statistics[h].x=l+c*Math.cos(k*y),b.statistics[h].y=m+c*Math.sin(k*y));break;case "mode":b.statistics[h]||(b.statistics[h]={}),l=b.statistics[h][k]||
0,b.statistics[h][k]=l+c}}};a.prototype._aggregateStatistics=function(a,b){for(var c=0,d=this._fields;c<d.length;c++){var f=d[c],g=f.name;switch(f.outStatistic.statisticType){case "sum":case "avg":case "avg_angle":case "mode":case "norm":a[g]||(a[g]={});for(var h in b[g])a[g][h]=(a[g][h]||0)+b[g][h]}}};a.prototype._normalizeStatistics=function(a,b){for(var c={},d=0,f=this._fields;d<f.length;d++){var g=f[d],h=g.name;switch(g.outStatistic.statisticType){case "norm":g=a[h];if(b&&null==g.onStatisticNormalizationField)break;
if(b&&g.onStatisticNormalizationField){c[h]=g.onStatisticField/g.onStatisticNormalizationField;break}c[h]=0;break;case "sum":if(!b)break;var k=a[h],g=k.value,k=k.nanCount;if(!(b-k))break;c[h]=g;break;case "avg":if(!b)break;k=a[h];g=k.value;k=k.nanCount;if(!(b-k))break;c[h]=g/(b-k);break;case "avg_angle":if(!b)break;var k=a[h],g=k.x,l=k.y,k=k.nanCount;if(!(b-k))break;c[h]=180/Math.PI*Math.atan2(l/(b-k),g/(b-k));break;case "mode":var g=a[h],k=0,l=null,m;for(m in g){var y=g[m];y>k&&(k=y,l=m)}c[h]="null"===
l?null:l}}return c};return a}();a.GeohashTree=m;var h=function(){function a(a,b,c){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.displayId=0;this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this.children=Array(32);for(var d=0;d<this.children.length;d++)this.children[d]=null;this.xNode=a;this.yNode=b;this.depth=c}a.prototype.realloc=function(a,b,c){for(var d=0;d<this.children.length;d++)this.children[d]=null;this.xNode=a;this.yNode=b;this.depth=
c;this.next=null;this.count=this.yTotal=this.xTotal=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};return this};a.prototype.getLngLatBounds=function(){var a=this.depth,b=Math.ceil(a/2),a=Math.floor(a/2);return k.decodeGeohashXY({geohashX:this.xNode<<30-(3*b+2*a),geohashY:this.yNode<<30-(2*b+3*a)},this.depth)};a.prototype.find=function(a,b,c,e,g,h){if(e>=c)return this;var d=1-e%2,f=3*d+2*(1-d),k=2*d+3*(1-d),n=30-g-f,l=30-h-k,d=this.children[((a&7*d+3*(1-d)<<n)>>n)+((b&3*d+7*(1-d)<<l)>>
l)*(8*d+4*(1-d))];return null==d?null:d.find(a,b,c,e+1,g+f,h+k)};return a}()})},"esri/geohash/geohashUtils":function(){define(["require","exports"],function(m,a){function b(a){return 57>=a?a-48:104>=a?a-88:107>=a?a-89:110>=a?a-90:a-91}function l(a,c,b){a[0]=c;a[1]=b;return a}function k(a,c){var b=(a[0]+a[1])/2,d=!c;a[0]=d*a[0]+c*b;a[1]=d*b+c*a[1]}function h(a,c){c=c>(a[0]+a[1])/2;k(a,c);return c}function g(a,c){for(var d=l(x,-90,90),e=l(p,-180,180),f=0;f<c.length;f++){var g=c.charCodeAt(f),g=b(g);
0===f%2?(k(e,!!(16&g)),k(e,!!(4&g)),k(e,!!(1&g)),k(d,!!(8&g)),k(d,!!(2&g))):(k(d,!!(16&g)),k(d,!!(4&g)),k(d,!!(1&g)),k(e,!!(8&g)),k(e,!!(2&g)))}a[0]=(d[0]+d[1])/2;a[1]=(e[0]+e[1])/2;return a}function d(a,c,b){for(var d="",e=l(x,-90,90),f=l(p,-180,180),g=0;g<b;g++){var k=0;g%2?(k|=h(e,a)<<4,k|=h(f,c)<<3,k|=h(e,a)<<2,k|=h(f,c)<<1,k|=h(e,a)<<0):(k|=h(f,c)<<4,k|=h(e,a)<<3,k|=h(f,c)<<2,k|=h(e,a)<<1,k|=h(f,c)<<0);d+="0123456789bcdefghjkmnpqrstuvwxyz"[k]}return d}function f(a){return 180/Math.pow(2,Math.floor(5*
a/2))}function c(a){return 360/Math.pow(2,Math.ceil(5*a/2))}function e(a,c){return c?1&a|(4&a)>>1|(16&a)>>2:(2&a)>>1|(8&a)>>2}function n(a,c){return c?(2&a)>>1|(8&a)>>2:1&a|(4&a)>>1|(16&a)>>2}function t(a,c,d){var e=!((a.length-1)%2),f=a.substring(0,a.length-1),g=b(a.charCodeAt(a.length-1)),h=0,k=0,n=0,l=0;e?(h=8,k=4,n=1&g|(4&g)>>1|(16&g)>>2,l=(2&g)>>1|(8&g)>>2):(h=4,k=8,l=1&g|(4&g)>>1|(16&g)>>2,n=(2&g)>>1|(8&g)>>2);c=n+c;g=l+d;d=Math.floor(c/h);l=Math.floor(g/k);h=c-d*h;k=g-l*k;e="0123456789bcdefghjkmnpqrstuvwxyz"[e?
h&1|(k&1)<<1|(h&2)<<1|(k&2)<<2|(h&4)<<2:k&1|(h&1)<<1|(k&2)<<1|(h&2)<<2|(k&4)<<2];return 1<a.length&&(d||l)?t(f,d,l)+e:f+e}Object.defineProperty(a,"__esModule",{value:!0});a.forEachIntersectingGeohash=a.getIntersectingGeohashes=a.getRelativeGeohash=a.unpackYBits=a.unpackXBits=a.lonDistPerGeohash=a.latDistPerGeohash=a.encodeGeohash=a.setGeohashBuf=a.setGeohashXY=a.decodeGeohashXY=a.convertGeohash32ToXY=a.decodeGeohash=a.encodeBase32Char=a.decodeBase32Char=void 0;var x=new Float64Array(2),p=new Float64Array(2);
a.decodeBase32Char=b;a.encodeBase32Char=function(a){return"0123456789bcdefghjkmnpqrstuvwxyz"[a]};a.decodeGeohash=g;a.convertGeohash32ToXY=function(a,c){for(var d=a=0,f=30,g=30,h=0;h<c.length;h++){var k=c.charCodeAt(h),l=b(k),k=0===h%2,p=e(l,k),l=n(l,k),f=f-(k?3:2),g=g-(k?2:3);a|=p<<f;d|=l<<g}return{geohashX:a,geohashY:d}};a.decodeGeohashXY=function(a,c){for(var b=-90,d=90,e=-180,f=180,g=0;g<c;g++){for(var h=Math.ceil((g+1)/2),k=Math.floor((g+1)/2),n=1-g%2,l=30-(3*h+2*k),p=30-(2*h+3*k),h=2*n+3*(1-
n),k=(7*n+3*(1-n)<<l&a.geohashX)>>l,l=(3*n+7*(1-n)<<p&a.geohashY)>>p,n=3*n+2*(1-n)-1;0<=n;n--)var p=(e+f)/2,m=k&1<<n?1:0,e=(1-m)*e+m*p,f=(1-m)*p+m*f;for(n=h-1;0<=n;n--)h=(b+d)/2,k=l&1<<n?1:0,b=(1-k)*b+k*h,d=(1-k)*h+k*d}return[e,b,f,d]};a.setGeohashXY=function(a,c,b,d){d%2&&(d+=1);for(var e=0,f=0,g=-90,h=90,k=-180,n=180,l=0;l<d/2;l++){for(var p=0;5>p;p++)var m=(k+n)/2,q=b>m?1:0,e=e|q<<29-(p+5*l),k=(1-q)*k+q*m,n=(1-q)*m+q*n;for(p=0;5>p;p++)m=(g+h)/2,q=c>m?1:0,f|=q<<29-(p+5*l),g=(1-q)*g+q*m,h=(1-q)*
m+q*h}a.geohashX=e;a.geohashY=f};a.setGeohashBuf=function(a,c,b,d,e){e%2&&(e+=1);for(var f=0,g=0,h=-90,k=90,n=-180,l=180,p=0;p<e/2;p++){for(var m=0;5>m;m++)var q=(n+l)/2,u=d>q?1:0,f=f|u<<29-(m+5*p),n=(1-u)*n+u*q,l=(1-u)*q+u*l;for(m=0;5>m;m++)q=(h+k)/2,u=b>q?1:0,g|=u<<29-(m+5*p),h=(1-u)*h+u*q,k=(1-u)*q+u*k}a[2*c]=f;a[2*c+1]=g};a.encodeGeohash=d;a.latDistPerGeohash=f;a.lonDistPerGeohash=c;a.unpackXBits=e;a.unpackYBits=n;a.getRelativeGeohash=t;a.getIntersectingGeohashes=function(a,b,e,g,h){e=Math.abs(e-
a);g=Math.abs(g-b);var k=f(h),n=c(h);g=Math.ceil(g/n);e=Math.ceil(e/k);a=d(a,b,h);b=[];for(h=0;h<g;h++)for(k=0;k<e;k++)b.push(t(a,h,k));return b};a.forEachIntersectingGeohash=function(a,b,e,h,k,n){var l=Math.abs(e-a),p=Math.abs(h-b),m=f(k),q=c(k),p=Math.ceil(p/q),l=Math.ceil(l/m);k=d(a,b,k);for(var u=0;u<p;u++)for(var w=0;w<l;w++){var y=t(k,u,w),x=g([0,0],y),B=x[0],x=x[1];n(y,Math.abs((Math.min(e,B+m/2)-Math.max(a,B-m/2))*(Math.min(h,x+q/2)-Math.max(b,x-q/2)))/(m*q))}}})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["require",
"exports","./displayIdUtils","./StaticBitSet"],function(m,a,b,l){function k(a,b,d){if(!(a.length>b))for(;a.length<=b;)a.push(d)}Object.defineProperty(a,"__esModule",{value:!0});a.ComputedAttributeStorage=void 0;m=function(){function a(){this._numerics=[];this._strings=[];this._idGenerator=new b.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}a.prototype.createBitset=function(){var a=this._bitsets.length;this._bitsets.push(l.StaticBitSet.create(this._allocatedSize,
2147483647));return a+1};a.prototype.getBitset=function(a){return this._bitsets[a-1]};a.prototype._expand=function(){this._allocatedSize<<=1;for(var a=0,b=this._bitsets;a<b.length;a++)b[a].resize(this._allocatedSize)};a.prototype._ensureNumeric=function(a,b){this._numerics[a]||(this._numerics[a]=[]);k(this._numerics[a],b,0)};a.prototype._ensureInstanceId=function(a){k(this._instanceIds,a,0)};a.prototype._ensureString=function(a,b){this._strings[a]||(this._strings[a]=[]);k(this._strings[a],b,null)};
a.prototype.createDisplayId=function(a){void 0===a&&(a=!1);var b=this._idGenerator.createId();b>this._allocatedSize&&this._expand();return((a?2147483648:0)|b)>>>0};a.prototype.releaseDisplayId=function(a){for(var b=0,f=this._bitsets;b<f.length;b++)f[b].unset(a);return this._idGenerator.releaseId(a&2147483647)};a.prototype.getComputedNumeric=function(a,b){return this.getComputedNumericAtIndex(a&2147483647,0)};a.prototype.setComputedNumeric=function(a,b,f){return this.setComputedNumericAtIndex(a&2147483647,
f,0)};a.prototype.getComputedString=function(a,b){return this.getComputedStringAtIndex(a&2147483647,0)};a.prototype.setComputedString=function(a,b,f){return this.setComputedStringAtIndex(a&2147483647,0,f)};a.prototype.getComputedNumericAtIndex=function(a,b){a&=2147483647;this._ensureNumeric(b,a);return this._numerics[b][a]};a.prototype.setComputedNumericAtIndex=function(a,b,f){a&=2147483647;this._ensureNumeric(b,a);this._numerics[b][a]=f};a.prototype.getInstanceId=function(a){a&=2147483647;this._ensureInstanceId(a);
return this._instanceIds[a]};a.prototype.setInstanceId=function(a,b){a&=2147483647;this._ensureInstanceId(a);this._instanceIds[a]=b};a.prototype.getComputedStringAtIndex=function(a,b){a&=2147483647;this._ensureString(b,a);return this._strings[b][a]};a.prototype.setComputedStringAtIndex=function(a,b,f){a&=2147483647;this._ensureString(b,a);this._strings[b][a]=f};a.prototype.getXMin=function(a){return this._bounds[4*(a&2147483647)]};a.prototype.getYMin=function(a){return this._bounds[4*(a&2147483647)+
1]};a.prototype.getXMax=function(a){return this._bounds[4*(a&2147483647)+2]};a.prototype.getYMax=function(a){return this._bounds[4*(a&2147483647)+3]};a.prototype.setBounds=function(a,b){b=b.readHydratedGeometry();if(!b||!b.coords.length)return!1;var d=Infinity,c=Infinity,e=-Infinity,g=-Infinity;b.forEachVertex(function(a,b){d=Math.min(d,a);c=Math.min(c,b);e=Math.max(e,a);g=Math.max(g,b)});a&=2147483647;k(this._bounds,4*a+4,0);this._bounds[4*a]=d;this._bounds[4*a+1]=c;this._bounds[4*a+2]=e;this._bounds[4*
a+3]=g;return!0};return a}();a.ComputedAttributeStorage=m})},"esri/views/2d/layers/features/support/displayIdUtils":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.DisplayIdGenerator=a.getDisplayIdIndex=a.getDisplayIdType=a.DISPLAY_ID_TYPE_AGGREGATE=a.DISPLAY_ID_TYPE_FEATURE=void 0;a.DISPLAY_ID_TYPE_FEATURE=0;a.DISPLAY_ID_TYPE_AGGREGATE=1;a.getDisplayIdType=function(a){return(a&2147483648)>>>31};a.getDisplayIdIndex=function(a){return a&2147483647};
m=function(){function a(){this._freeIds=[];this._idCounter=1}a.prototype.createId=function(a){void 0===a&&(a=!1);var b=this._getFreeId();return((a?2147483648:0)|b)>>>0};a.prototype.releaseId=function(a){this._freeIds.push(a)};a.prototype._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return a}();a.DisplayIdGenerator=m})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",
{value:!0});a.StaticBitSet=void 0;m=function(){function a(a,b){this._mask=0;this._buf=a;this._mask=b}a.fromBuffer=function(b,k){return new a(b,k)};a.create=function(b,k){void 0===k&&(k=4294967295);b=new Uint32Array(Math.ceil(b/32));return new a(b,k)};a.prototype._getIndex=function(a){return Math.floor(a/32)};a.prototype.has=function(a){a&=this._mask;return!!(this._buf[this._getIndex(a)]&1<<a%32)};a.prototype.set=function(a){a&=this._mask;var b=this._getIndex(a);this._buf[b]|=1<<a%32};a.prototype.unset=
function(a){a&=this._mask;var b=this._getIndex(a);this._buf[b]&=4294967295^1<<a%32};a.prototype.resize=function(a){var b=this._buf;a=new Uint32Array(Math.ceil(a/32));a.set(b);this._buf=a};a.prototype.or=function(a){for(var b=0;b<this._buf.length;b++)this._buf[b]|=a._buf[b];return this};a.prototype.and=function(a){for(var b=0;b<this._buf.length;b++)this._buf[b]&=a._buf[b];return this};a.prototype.xor=function(a){for(var b=0;b<this._buf.length;b++)this._buf[b]^=a._buf[b];return this};a.prototype.ior=
function(a){for(var b=0;b<this._buf.length;b++)this._buf[b]|=~a._buf[b];return this};a.prototype.iand=function(a){for(var b=0;b<this._buf.length;b++)this._buf[b]&=~a._buf[b];return this};a.prototype.ixor=function(a){for(var b=0;b<this._buf.length;b++)this._buf[b]^=~a._buf[b];return this};a.prototype.any=function(){for(var a=0;a<this._buf.length;a++)if(this._buf[a])return!0;return!1};a.prototype.copy=function(a){for(var b=0;b<this._buf.length;b++)this._buf[b]=a._buf[b];return this};a.prototype.clone=
function(){return new a(this._buf.slice(),this._mask)};a.prototype.clear=function(){for(var a=0;a<this._buf.length;a++)this._buf[a]=0};a.prototype.forEachSet=function(a){for(var b=0;b<this._buf.length;b++){var h=this._buf[b],g=32*b;if(h)for(;h;)h&1&&a(g),h>>>=1,g++}};a.prototype.countSet=function(){var a=0;this.forEachSet(function(b){a++});return a};return a}();a.StaticBitSet=m})},"esri/views/2d/layers/features/support/TileStore":function(){define("require exports tslib ../../../../../core/Evented ../../../../../core/has ../../../../../core/libs/rbush/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(m,a,b,l,k,h,g,d,f){Object.defineProperty(a,"__esModule",{value:!0});var c={added:[],removed:[]},e=new Set,n=new f(0,0,0,0);m=function(a){function f(c){var b=a.call(this)||this;b._tiles=new Map;b._index=h(9,k("csp-restrictions")?function(a){return{minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);b.tiles=[];b.tileScheme=c;return b}b.__extends(f,a);f.prototype.destroy=function(){this.clear()};f.prototype.clear=function(){this.tiles.length=
0;this._tiles.clear();this._index.clear()};f.prototype.has=function(a){return this._tiles.has(a)};f.prototype.get=function(a){return this._tiles.get(a)};f.prototype.findByKey=function(a){return this._tiles.get(a.id)};f.prototype.intersections=function(a,c){var b="string"===typeof a?this.get(a):a;if(!b)return[];var d=c*b.resolution;c=b.bounds[0]-d;a=b.bounds[1]-d;for(var e=b.bounds[2]+d,b=b.bounds[3]+d,d=[],f=0,g=this._index.search({minX:c,minY:a,maxX:e,maxY:b});f<g.length;f++){var h=g[f],k=h.bounds.slice();
k[0]=Math.max(k[0],c);k[1]=Math.max(k[1],a);k[2]=Math.min(k[2],e);k[3]=Math.min(k[3],b);0<k[2]-k[0]&&0<k[3]-k[1]&&d.push({bounds:k,tile:h})}return d};f.prototype.boundsIntersections=function(a){return this._index.search({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]})};f.prototype.updateTiles=function(a){for(var c=this,b={added:[],removed:[]},d=0,e=a.added;d<e.length;d++){var f=e[d];if(!this.has(f)){var h=new g.default(this.tileScheme,f);this._tiles.set(f,h);this._index.insert(h);b.added.push(h)}}d=0;for(a=
a.removed;d<a.length;d++)f=a[d],this.has(f)&&(h=this.get(f),this._tiles.delete(f),this._index.remove(h),b.removed.push(h));this.tiles.length=0;this._tiles.forEach(function(a){return c.tiles.push(a)});(b.added.length||b.removed.length)&&this.emit("update",b)};f.prototype.setViewState=function(a){if(a=this.tileScheme.getTileCoverage(a,0)){var b=a.spans,f=a.lodInfo,h=f.level;if(0<b.length)for(var k=0;k<b.length;k++)for(var l=b[k],p=l.row,m=l.colTo,t=l.colFrom;t<=m;t++){var x=n.set(h,p,f.normalizeCol(t),
f.getWorldForColumn(t)).id;e.add(x);this.has(x)||(l=new g.default(this.tileScheme,x),this._tiles.set(x,l),this._index.insert(l),this.tiles.push(l),c.added.push(l))}for(b=this.tiles.length-1;0<=b;b--)l=this.tiles[b],e.has(l.id)||(this._tiles.delete(l.id),this.tiles.splice(b,1),this._index.remove(l),c.removed.push(l));(c.added.length||c.removed.length)&&this.emit("update",c);d.pool.release(a);e.clear();c.added.length=0;c.removed.length=0}};return f}(l);a.default=m})},"esri/views/2d/layers/features/support/Tile":function(){define("require exports ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(m,a,b,l,k,h,g){function d(a,c){var b=a.bounds,d=c.bounds;return a.key.id!==c.key.id&&a.key.world===c.key.world&&b[0]<=d[0]&&b[1]<=d[1]&&b[2]>=d[2]&&b[3]>=d[3]}Object.defineProperty(a,"__esModule",{value:!0});a.Tile=a.isChildOf=a.isParentOf=void 0;a.isParentOf=d;a.isChildOf=function(a,c){return d(c,a)};m=function(){function a(a,b){this.key=new g(0,0,0,0);this.bounds=k.create();this.objectIds=new Set;this.key.set(b);b=a.getLODInfoAt(this.key);this.tileInfoView=a;this.tileInfoView.getTileBounds(this.bounds,
this.key,!0);this.resolution=b.resolution;this.scale=b.scale;this.level=b.level;this.needsClear=!0}Object.defineProperty(a.prototype,"id",{get:function(){return this.key.id},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"extent",{get:function(){return l.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],
translate:[this.bounds[0],this.bounds[3]]}},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"bbox",{get:function(){var a=this.bounds;return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}},enumerable:!1,configurable:!0});a.prototype.clone=function(){return new a(this.tileInfoView,this.key)};a.prototype.neighbor=function(c,b){var d=this.key.clone(),e=1<<d.level;c=d.col+c;b=d.row+b;0>c?(d.col=c+e,--d.world):c>=e?(d.col=c-e,d.world+=1):d.col=c;d.row=b;return new a(this.tileInfoView,d)};a.prototype.createChildTiles=
function(){for(var c=this.key.getChildKeys(),d=b.acquire(),f=0;f<c.length;f++)d[f]=new a(this.tileInfoView,c[f]);return d};a.prototype.getQuantizationParameters=function(){return h.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};return a}();a.Tile=m;a.default=m})},"esri/views/2d/tiling/TileKey":function(){define(["require",
"exports","../../../core/ObjectPool"],function(m,a,b){return function(){function a(a,b,g,d){this.set(a,b,g,d)}a.getId=function(a,b,g,d){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+b+"/"+g+"/"+d};Object.defineProperty(a.prototype,"key",{get:function(){return this},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.toString()},set:function(a){this.set(a)},enumerable:!1,configurable:!0});a.prototype.acquire=function(a,b,g,d){this.set(a,
b,g,d)};a.prototype.contains=function(a){var b=a.level-this.level;return this.row===a.row>>b&&this.col===a.col>>b&&this.world===a.world};a.prototype.equals=function(a){return this.level===a.level&&this.row===a.row&&this.col===a.col&&this.world===a.world};a.prototype.clone=function(){return new a(this)};a.prototype.release=function(){this.world=this.col=this.row=this.level=0};a.prototype.set=function(a,b,g,d){null==a?this.world=this.col=this.row=this.level=0:"object"===typeof a?(this.level=a.level||
0,this.row=a.row||0,this.col=a.col||0,this.world=a.world||0):"string"===typeof a?(a=a.split("/"),b=a[1],g=a[2],d=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(b),this.col=parseFloat(g),this.world=parseFloat(d)):(this.level=+a,this.row=+b,this.col=+g,this.world=+d||0);return this};a.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};a.prototype.getParentKey=function(){return 0>=this.level?null:new a(this.level-1,this.row>>1,this.col>>1,this.world)};a.prototype.getChildKeys=
function(){var b=this.level+1,h=this.row<<1,g=this.col<<1,d=this.world;return[new a(b,h,g,d),new a(b,h,g+1,d),new a(b,h+1,g,d),new a(b,h+1,g+1,d)]};a.prototype.compareRowMajor=function(a){return this.row<a.row?-1:this.row>a.row?1:this.col<a.col?-1:this.col>a.col?1:0};a.pool=new b(a,null,null,25,50);return a}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ObjectPool"],function(m,a,b){return function(){function a(){this.spans=[]}a.prototype.acquire=function(a){this.lodInfo=
a};a.prototype.release=function(){this.lodInfo=null;this.spans.length=0};a.prototype.forEach=function(a,b){var g=this.spans,d=this.lodInfo,f=d.level;if(0!==g.length)for(var c=0;c<g.length;c++)for(var e=g[c],h=e.row,k=e.colTo,e=e.colFrom;e<=k;e++)a.call(b,f,h,d.normalizeCol(e),d.getWorldForColumn(e))};a.pool=new b(a);return a}()})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),
function(m,a,b,l,k,h,g){var d=new h("0/0/0/0"),f=function(){function a(a,c,b,d,e,f,g,h){this.x=a;this.ymin=c;this.ymax=b;this.invM=d;this.leftAdjust=e;this.rightAdjust=f;this.leftBound=g;this.rightBound=h}a.create=function(c,b){var d;c[1]>b[1]&&(d=[b,c],c=d[0],b=d[1]);d=c[0];c=c[1];var e=b[0];b=b[1];var f=e-d,g=b-c,g=0!==g?f/g:0,h=(Math.ceil(c)-c)*g,k=(Math.floor(c)-c)*g;return new a(d,Math.floor(c),Math.ceil(b),g,0>f?h:k,0>f?k:h,0>f?e:d,0>f?d:e)};a.prototype.incrRow=function(){this.x+=this.invM};
a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return a}(),c=[[0,0],[0,0],[0,0],[0,0]];return function(){function a(a,c){var b=this;this.tileInfo=a;this.fullExtent=c;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var d=a.lods.slice();d.sort(function(a,c){return c.scale-a.scale});var e=this._lodInfos=d.map(function(b){return l.create(a,
b,c)});d.forEach(function(a,c){b._infoByLevel[a.level]=e[c];b._infoByScale[a.scale]=e[c];b.scales[c]=a.scale},this);this._wrap=a.isWrappable}Object.defineProperty(a.prototype,"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!1,configurable:!0});a.prototype.getLODInfoAt=function(a){return this._infoByLevel["number"===typeof a?a:a.level]};a.prototype.getTileBounds=function(a,c,b){void 0===b&&(b=!1);d.set(c);return(c=this._infoByLevel[d.level])?c.getTileBounds(a,d,
b):a};a.prototype.getTileCoords=function(a,c,b){void 0===b&&(b=!1);d.set(c);return(c=this._infoByLevel[d.level])?c.getTileCoords(a,d,b):a};a.prototype.getTileCoverage=function(a,b,d){void 0===b&&(b=192);void 0===d&&(d="closest");d="closest"===d?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);var e=k.pool.acquire(d),h=this._wrap,n;n=Infinity;var l=-Infinity,m,t,x=e.spans;c[0][0]=c[0][1]=c[1][1]=c[3][0]=-b;c[1][0]=c[2][0]=a.size[0]+b;c[2][1]=c[3][1]=a.size[1]+b;for(b=0;b<
c.length;b++){var A=c[b];a.toMap(A,A);A[0]=d.getColumnForX(A[0]);A[1]=d.getRowForY(A[1])}a=[];A=3;for(b=0;4>b;b++){if(c[b][1]!==c[A][1]){var C=f.create(c[b],c[A]);n=Math.min(C.ymin,n);l=Math.max(C.ymax,l);void 0===a[C.ymin]&&(a[C.ymin]=[]);a[C.ymin].push(C)}A=b}if(null==n||null==l||100<l-n)return null;for(A=[];n<l;){null!=a[n]&&(A=A.concat(a[n]));m=Infinity;t=-Infinity;for(b=A.length-1;0<=b;b--)C=A[b],m=Math.min(m,C.getLeftCol()),t=Math.max(t,C.getRightCol());m=Math.floor(m);t=Math.floor(t);if(n>=
d.first[1]&&n<=d.last[1])if(h)if(d.size[0]<d.worldSize[0])for(C=Math.floor(t/d.worldSize[0]),b=Math.floor(m/d.worldSize[0]);b<=C;b++)x.push(new g(n,Math.max(d.getFirstColumnForWorld(b),m),Math.min(d.getLastColumnForWorld(b),t)));else x.push(new g(n,m,t));else m>d.last[0]||t<d.first[0]||(m=Math.max(m,d.first[0]),t=Math.min(t,d.last[0]),x.push(new g(n,m,t)));n+=1;for(b=A.length-1;0<=b;b--)C=A[b],C.ymax>=n?C.incrRow():A.splice(b,1)}return e};a.prototype.getTileParentId=function(a){d.set(a);a=this._lodInfos.indexOf(this._infoByLevel[d.level])-
1;if(0>a)return null;this._getTileIdAtLOD(d,this._lodInfos[a],d);return d.id};a.prototype.getTileResolution=function(a){return(a=this._infoByLevel["object"===typeof a?a.level:a])?a.resolution:-1};a.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};a.prototype.intersects=function(a,c){d.set(c);c=this._infoByLevel[d.level];var b=a.lodInfo;if(b.resolution>c.resolution){this._getTileIdAtLOD(d,b,d);for(var e=b.denormalizeCol(d.col,d.world),f=0,g=a.spans;f<g.length;f++){var h=
g[f];if(h.row===d.row&&h.colFrom<=e&&h.colTo>=e)return!0}}if(b.resolution<c.resolution){g=a.spans.reduce(function(a,c){a[0]=Math.min(a[0],c.row);a[1]=Math.max(a[1],c.row);a[2]=Math.min(a[2],c.colFrom);a[3]=Math.max(a[3],c.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]);a=g[0];var e=g[1],f=g[2],g=g[3],k=c.denormalizeCol(d.col,d.world),h=b.getColumnForX(c.getXForColumn(k)),n=b.getRowForY(c.getYForRow(d.row)),k=b.getColumnForX(c.getXForColumn(k+1))-1;c=b.getRowForY(c.getYForRow(d.row+1))-1;
return!(h>g||k<f||n>e||c<a)}var l=b.denormalizeCol(d.col,d.world);return a.spans.some(function(a){return a.row===d.row&&a.colFrom<=l&&a.colTo>=l})};a.prototype.normalizeBounds=function(a,c,d){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];this._wrap&&(c=b.getInfo(this.tileInfo.spatialReference),d=-d*(c.valid[1]-c.valid[0]),a[0]+=d,a[2]+=d);return a};a.prototype.getSmallestInfoForScale=function(a){var c=this.scales;if(this._infoByScale[a])return this._infoByScale[a];if(a>c[0])return this._infoByScale[c[0]];
for(var b=1;b<c.length-1;b++)if(a>c[b]+1E-6)return this._infoByScale[c[b-1]];return this._infoByScale[c[c.length-1]]};a.prototype.getClosestInfoForScale=function(a){var c=this.scales;if(this._infoByScale[a])return this._infoByScale[a];a=c.reduce(function(c,b){return Math.abs(b-a)<Math.abs(c-a)?b:c},c[0]);return this._infoByScale[a]};a.prototype.scaleToLevel=function(a){var c=this.scales;if(this._infoByScale[a])return this._infoByScale[a].level;for(var b=c.length-1;0<=b;b--)if(a<c[b])return b===c.length-
1?this._infoByScale[c[c.length-1]].level:this._infoByScale[c[b]].level+(c[b]-a)/(c[b]-c[b+1]);return this._infoByScale[c[0]].level};a.prototype.scaleToZoom=function(a){return this.tileInfo.scaleToZoom(a)};a.prototype._getTileIdAtLOD=function(a,c,b){var d=this._infoByLevel[b.level];a.set(b);if(c.resolution<d.resolution)return null;if(c.resolution===d.resolution)return a;a.level=c.level;a.col=Math.floor(b.col*d.resolution/c.resolution+.01);a.row=Math.floor(b.row*d.resolution/c.resolution+.01);return a};
return a}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(m,a,b,l){function k(a,b,f){a[0]=b;a[1]=f;return a}var h=new l("0/0/0/0");return function(){function a(a,b,c,e,g,h,k,l,m,u,y,w){this.level=a;this.resolution=b;this.scale=c;this.origin=e;this.first=g;this.last=h;this.size=k;this.norm=l;this.worldStart=m;this.worldEnd=u;this.worldSize=y;this.wrap=w}a.create=function(d,f,c){var e=b.getInfo(d.spatialReference),
g=[d.origin.x,d.origin.y],h=[d.size[0]*f.resolution,d.size[1]*f.resolution],l=[-Infinity,-Infinity],p=[Infinity,Infinity],m=[Infinity,Infinity];c&&(k(l,Math.max(0,Math.floor((c.xmin-g[0])/h[0])),Math.max(0,Math.floor((g[1]-c.ymax)/h[1]))),k(p,Math.max(0,Math.floor((c.xmax-g[0])/h[0])),Math.max(0,Math.floor((g[1]-c.ymin)/h[1]))),k(m,p[0]-l[0]+1,p[1]-l[1]+1));var u;d.isWrappable?(d=[Math.ceil(Math.round((e.valid[1]-e.valid[0])/f.resolution)/d.size[0]),m[1]],e=[Math.floor((e.origin[0]-g[0])/h[0]),l[1]],
c=[d[0]+e[0]-1,p[1]],u=!0):(e=l,c=p,d=m,u=!1);return new a(f.level,f.resolution,f.scale,g,l,p,m,h,e,c,d,u)};a.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b};a.prototype.denormalizeCol=function(a,b){return this.wrap?this.worldSize[0]*b+a:a};a.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};a.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};a.prototype.getLastColumnForWorld=
function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};a.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};a.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};a.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};a.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};a.prototype.getTileBounds=function(a,b,c){void 0===c&&(c=!1);h.set(b);var d=c?h.col:this.denormalizeCol(h.col,h.world),f=h.row;b=this.getXForColumn(d);
c=this.getYForRow(f+1);d=this.getXForColumn(d+1);f=this.getYForRow(f);a[0]=b;a[1]=c;a[2]=d;a[3]=f;return a};a.prototype.getTileCoords=function(a,b,c){void 0===c&&(c=!1);h.set(b);b=c?h.col:this.denormalizeCol(h.col,h.world);Array.isArray(a)?k(a,this.getXForColumn(b),this.getYForRow(h.row)):(a.x=this.getXForColumn(b),a.y=this.getYForRow(h.row));return a};return a}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports"],function(m,a){return function(){return function(a,l,k){this.row=
a;this.colFrom=l;this.colTo=k}}()})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../core/accessorSupport/diffUtils ../../../../../geometry/SpatialReference ../../../engine/webgl/definitions ../../../engine/webgl/collisions/CollisionGrid ../../../engine/webgl/mesh/factories/matcherUtils ../../../engine/webgl/mesh/factories/WGLMeshFactory ../../../engine/webgl/mesh/templates/WGLTemplateStore ../../../engine/webgl/util/BidiText ../textUtils ./BaseProcessor ../support/AttributeStore".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B){Object.defineProperty(a,"__esModule",{value:!0});h.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");m=function(a){function h(){var c=null!==a&&a.apply(this,arguments)||this;c.type="symbol";return c}b.__extends(h,a);h.prototype.destroy=function(){};Object.defineProperty(h.prototype,"supportsTileUpdates",{get:function(){return!0},enumerable:!1,configurable:!0});h.prototype.update=function(a,d){return b.__awaiter(this,void 0,void 0,
function(){var e,f;return b.__generator(this,function(b){e=d.schema.processors[0];if("symbol"!==e.type)return[2];f=c.diff(this._schema,e);if(!c.hasDiff(f,"mesh"))return[2];k("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",f);a.mesh=!0;a.why.mesh.push("Symbology changed");this._schema=e;this._factory=this._createFactory(e);this._factory.update(e,this.tileStore.tileScheme.tileInfo);return[2]})})};h.prototype.onTileData=function(a,c,b){d.throwIfAborted(b);return this._onTileData(a,
c,b)};h.prototype.onTileError=function(a,c,b){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:c},{signal:b.signal})};h.prototype._createFactory=function(a){var c=this,b=this.service,d=b.geometryType,f=b.objectIdField,b=b.fields,g=e.fromJSON(this.spatialReference),b={geometryType:d,fields:b,spatialReference:g};this._store=g=new q.WGLTemplateStore(function(a,b){return c.remoteClient.invoke("tileRenderer.getMaterialItems",a,b)},!1);this._matcher=x.createMatcher(a.mesh.matcher,
g,b);return new p.WGLMeshFactory(d,f,g)};h.prototype._onTileData=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var f,h,k,l,n,p,m,q,u,w,t,y;return b.__generator(this,function(b){switch(b.label){case 0:f=c.type;h=c.addOrUpdate;k=c.remove;l=c.end;if(!h)return n={type:f,addOrUpdate:null,remove:k,clear:!1,end:l},[2,this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:a.id,data:n},e)];p=this._processFeatures(a,h,e);m=e.signal;b.label=1;case 1:return b.trys.push([1,3,,4]),[4,p];
case 2:return q=b.sent(),u=g.andThen(q,function(a){return a.message}),w=g.andThen(q,function(a){return a.transferList})||[],n={type:f,addOrUpdate:u,remove:k,clear:!1,end:l},t={transferList:g.unwrap(w)||[],signal:m},d.throwIfAborted(t),[2,this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:a.id,data:n},t)];case 3:return y=b.sent(),this._handleError(a,y,e),[3,4];case 4:return[2]}})})};h.prototype._processFeatures=function(a,c,e){return b.__awaiter(this,void 0,void 0,function(){var f,h,k,l,n;
return b.__generator(this,function(b){switch(b.label){case 0:if(g.isNone(c)||!c.hasFeatures)return[2,null];f={transform:a.transform,hasZ:!1,hasM:!1};h=this._factory;k={viewingMode:"",scale:a.scale};return[4,this._matcher];case 1:return l=b.sent(),d.throwIfAborted(e),n=this._getLabelInfos(a,c),[4,h.analyze(c.getCursor(),l,f,k)];case 2:return b.sent(),d.throwIfAborted(e),[2,this._writeFeatureSet(a,c,f,n,h)]}})})};h.prototype._writeFeatureSet=function(a,c,b,d,e){var f=e.createMeshData(c.getApproximateSize()),
h={viewingMode:"",scale:a.scale};for(c=c.getCursor();c.next();)try{var k=c.getDisplayId(),l=g.isSome(d)?d.get(k):null;e.writeCursor(f,c,b,h,a.level,l)}catch(O){}return this._encodeDisplayData(f)};h.prototype._encodeDisplayData=function(a){var c={},b=[];a.encode(c,b);return{message:c,transferList:b}};h.prototype._handleError=function(a,c,b){if(!d.isAbortError(c))return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:c.message},{signal:b.signal})};h.prototype._shouldDiscard=
function(a,c){switch(this.service.geometryType){case "esriGeometryPoint":return c=c.readLegacyPointGeometry(),!c||a.checkOverlap(c.x,c.y);case "esriGeometryPolygon":return c=c.readLegacyCentroid(),!c||a.checkOverlap(c.x,c.y);default:return!1}};h.prototype._markUsed=function(a,c){switch(this.service.geometryType){case "esriGeometryPoint":var b=c.readLegacyPointGeometry();c=b.x;b=b.y;return a.markUsed(c,b);case "esriGeometryPolygon":return b=c.readLegacyCentroid(),c=b.x,b=b.y,a.markUsed(c,b)}};h.prototype._getLabelInfos=
function(a,c){var b=g.andThen(this._schema.mesh.labels,function(c){return c.filter(function(c){var b=a.scale;return(!c.minScale||c.minScale>=b)&&(!c.maxScale||c.maxScale<=b)})});if(g.isNone(b)||0===b.length)return null;var d=new Map,e=new t.CollisionGrid(n.COLLISION_EARLY_REJECT_BUCKET_SIZE),f=c.getCursor();c=function(){var a=f.getDisplayId();if(h._shouldDiscard(e,f))return d.has(a)||d.set(a,null),"continue";for(var c=!1,g=[],k=B.isAggregateId(a),l=k&&1!==f.readAttribute("cluster_count")?"aggregate":
"feature",n=function(b){if(b.target!==l)return"continue";var d=f.getStorage(),d=k&&"feature"===l?d.getComputedStringAtIndex(f.readAttribute("referenceId"),b.fieldIndex):d.getComputedStringAtIndex(a,b.fieldIndex);if(!d)return"continue";var d=u.bidiText(d.toString()),e=d[1];h._store.getMosaicItem(b.symbol,y.codepoints(d[0])).then(function(a){g[b.index]={glyphs:a.glyphMosaicItems,rtl:e,index:b.index}});c=!0},p=0;p<b.length;p++)n(b[p]);d.set(a,g);c&&h._markUsed(e,f)};for(var h=this;f.next();)c();return d};
return h=b.__decorate([f.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],h)}(w.default);a.default=m})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.CollisionGrid=void 0;m=function(){function a(a,h){void 0===h&&(h=2);this._bucketSize=a;this._rowsLength=b.TILE_SIZE/a;this._colsLength=b.TILE_SIZE/a;this._elementsPerBucket=h;this._grid=this._initGrid()}
a.prototype.checkOverlap=function(a,b){a=Math.floor(a/this._bucketSize);b=Math.floor(b/this._bucketSize);return 0>a||a>=this._rowsLength||0>b||b>=this._colsLength?!0:this._grid[b*this._colsLength+a]>=this._elementsPerBucket};a.prototype.markUsed=function(a,b){this._grid[Math.floor(b/this._bucketSize)*this._colsLength+Math.floor(a/this._bucketSize)]+=1};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};
return a}();a.CollisionGrid=m})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.createMatcher=void 0;var g=k.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");a.createMatcher=function(a,f,c){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){switch(a.type){case "simple":return[2,
h.FeatureMatcher.fromBasicRenderer(a,f,c)];case "map":return[2,h.MapMatcher.fromUVRenderer(a,f,c)];case "interval":return[2,h.IntervalMatcher.fromCBRenderer(a,f,c)];case "dictionary":return[2,h.DictionaryMatcher.fromDictionaryRenderer(a,f,c)];default:return g.error(new l("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/cimSymbolUtils ../../../../../symbols/cim/utils ../../../arcade/callExpressionWithFeature ../../../layers/features/schemaUtils @dojo/framework/shim/Promise".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){function t(a,c){return b.__awaiter(this,void 0,void 0,function(){var f,g;return b.__generator(this,function(b){switch(b.label){case 0:return f=a||1,"number"===typeof f?[2,function(a,c,b){return f}]:[4,d.createRendererExpression(f,c.spatialReference,c.fields)];case 1:return g=b.sent(),[2,function(a,b,d){return e.default(g,a,{$view:d},c.geometryType,b)||1}]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.DictionaryMatcher=a.MapMatcher=a.IntervalMatcher=a.FeatureMatcher=
void 0;var x=k.getLogger("esri/views/2d/engine/webgl/util/Matcher");k=function(){function a(){this.type="feature";this._defaultResult=null}a.fromBasicRenderer=function(c,d,e){return b.__awaiter(this,void 0,void 0,function(){var g,h,k;return b.__generator(this,function(b){switch(b.label){case 0:return g=new a,c.symbol?[4,f.expandSymbol(c.symbol,e)]:[3,2];case 1:h=b.sent(),k=d.createTemplateGroup(h,null),g.setDefault(k),b.label=2;case 2:return[2,g]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=
function(){return this._defaultResult};a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=function(a,c,b,d,e){return this.getDefault()};a.prototype.analyze=function(a,c,d,e,f){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){return[2,null]})})};return a}();a.FeatureMatcher=k;var p=function(a){function c(c,b,d,e){var f=a.call(this)||this;f.type="interval";f._intervals=[];f._isMaxInclusive=b;f._fieldIndex=e;f._field=c;f._normalizationInfo=
d;return f}b.__extends(c,a);c.fromCBRenderer=function(a,d,e){return b.__awaiter(this,void 0,void 0,function(){var h,k,l,n,p,m,q,u,w,t,y=this;return b.__generator(this,function(x){switch(x.label){case 0:return h=a.isMaxInclusive,k=a.normalizationField,l=a.normalizationTotal,n=a.normalizationType,p=a.field,m={normalizationField:k,normalizationTotal:l,normalizationType:n},q=new c(p,h,m,a.fieldIndex),[4,f.expandSymbol(a.backgroundFillSymbol,e)];case 1:return u=x.sent(),[4,g.all(a.intervals.map(function(a){return b.__awaiter(y,
void 0,void 0,function(){var c,g,h;return b.__generator(this,function(b){switch(b.label){case 0:return[4,f.expandSymbol(a.symbol,e)];case 1:return c=b.sent(),[4,d.createTemplateGroup(c,u)];case 2:return g=b.sent(),h={min:a.min,max:a.max},q.add(h,g),[2]}})})}))];case 2:return x.sent(),[4,f.expandSymbol(a.defaultSymbol,e)];case 3:return(w=x.sent())?[4,d.createTemplateGroup(w,u)]:[3,5];case 4:t=x.sent(),q.setDefault(t),x.label=5;case 5:return[2,q]}})})};c.prototype.add=function(a,c){this._intervals.push({interval:a,
result:c});this._intervals.sort(function(a,c){return a.interval.min-c.interval.min})};c.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};c.prototype.match=function(a,c,b,d,e){if(null==this._fieldIndex&&!this._field)return this.getDefault();a=null!=this._fieldIndex?c.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(c);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(c=0;c<this._intervals.length;c++)if(d=this._intervals[c],b=
d.interval,d=d.result,e=this._isMaxInclusive?a<=b.max:a<b.max,a>=b.min&&e)return d;return this.getDefault()};c.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};c.prototype._getValueFromField=function(a){var c=a.readAttribute(this._field);if(!this._needsNormalization())return c;var b=this._normalizationInfo,d=b.normalizationField,e=b.normalizationTotal,b=b.normalizationType;a=!!d&&a.readAttribute(d);
if(b)switch(b){case "esriNormalizeByField":return(a||void 0)&&c/a;case "esriNormalizeByLog":return Math.log(c)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return c/e*100;default:x.error("Found unknown normalization type: "+b)}else x.error("Normalization is required, but no type was set!")};return c}(k);a.IntervalMatcher=p;p=function(a){function c(c,b,d){var e=a.call(this)||this;e.type="map";e._nullResult=null;e._resultsMap=new Map;e._fieldsIndex=d;e._fields=c;e._seperator=b||"";return e}b.__extends(c,
a);c.fromUVRenderer=function(a,d,e){return b.__awaiter(this,void 0,void 0,function(){var h,k,l,n,p,m,q=this;return b.__generator(this,function(u){switch(u.label){case 0:return h=a.fieldDelimiter,k=[a.field],a.field2&&k.push(a.field2),a.field3&&k.push(a.field3),[4,f.expandSymbol(a.backgroundFillSymbol,e)];case 1:return l=u.sent(),n=new c(k,h,a.fieldIndex),[4,g.all(a.map.map(function(a){return b.__awaiter(q,void 0,void 0,function(){var c,g;return b.__generator(this,function(b){switch(b.label){case 0:return[4,
f.expandSymbol(a.symbol,e)];case 1:return c=b.sent(),[4,d.createTemplateGroup(c,l)];case 2:return g=b.sent(),"\x3cNull\x3e"===a.value?n.setNullResult(g):n.add(a.value,g),[2]}})})}))];case 2:return u.sent(),[4,f.expandSymbol(a.defaultSymbol,e)];case 3:return(p=u.sent())?[4,d.createTemplateGroup(p,l)]:[3,5];case 4:m=u.sent(),n.setDefault(m),u.label=5;case 5:return[2,n]}})})};c.prototype.setNullResult=function(a){this._nullResult=a};c.prototype.add=function(a,c){this._resultsMap.set(a.toString(),c)};
c.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};c.prototype.match=function(a,c,b,d,e){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();a=null!=this._fieldsIndex?c.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(c);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};
c.prototype._getValueFromFields=function(a){for(var c=[],b=0,d=this._fields;b<d.length;b++){var e=a.readAttribute(d[b]);c.push(e)}return c.join(this._seperator)};return c}(k);a.MapMatcher=p;k=function(a){function d(c,b,d,e){var f=a.call(this)||this;f.type="dictionary";f._groupIdCache=new h(100);f._renderer=c;f._fieldMap=c.fieldMap;f._symbolFields=c.getSymbolFields();f._templates=b;f._info=d;f._scaleFn=e;return f}b.__extends(d,a);d.fromDictionaryRenderer=function(a,c,e){return b.__awaiter(this,void 0,
void 0,function(){var f,g,h;return b.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,c){m(["../../../../../renderers/DictionaryRenderer"],a,c)})];case 1:return f=b.sent(),g=f.fromJSON(a.renderer),[4,g.fetchResources({spatialReference:e.spatialReference,fields:e.fields})];case 2:return b.sent(),[4,t(g.scaleExpression,e)];case 3:return h=b.sent(),[2,new d(g,c,e,h)]}})})};d.prototype._analyzeFeature=function(a,d,e,g){return b.__awaiter(this,void 0,void 0,function(){var h,
k,p,m,q,u,t,w,y=this;return b.__generator(this,function(C){switch(C.label){case 0:h=a.readLegacyFeature();k=this._scaleFn(h,d,e);p=this._attributeHash(h)+"-"+k;if(m=this._groupIdCache.get(p))return[2,m];q=b.__assign(b.__assign({},e),{spatialReference:this._info.spatialReference,abortOptions:g,fields:this._info.fields});return[4,this._renderer.getSymbolAsync(h,q)];case 1:return u=C.sent(),t=n.createSymbolSchema(u,this._renderer),w=f.expandSymbol(t,this._info,g).then(function(a){if("expanded-cim"!==
a.type)return x.error(new l("mapview-bad-type","Found unexpected type "+a.type+" in dictionary response")),null;a.hash+="-"+k;for(var b=0,d=a.layers;b<d.length;b++){var e=d[b];e.scaleFactor=k;e.templateHash+="-"+k;"text"===e.type&&"string"===typeof e.text&&-1<e.text.indexOf("[")&&(e.text=c.createLabelOverrideFunction(y._fieldMap,e.text,e.cim.textCase))}return y._templates.createTemplateGroup(a,null)}),this._groupIdCache.put(p,w,1),[2,w]}})})};d.prototype.analyze=function(a,c,d,e,f){return b.__awaiter(this,
void 0,void 0,function(){var a,h;return b.__generator(this,function(b){a=c.getCursor();for(h=[];a.next();)h.push(this._analyzeFeature(a,d,e,f));return[2,g.all(h)]})})};d.prototype.match=function(a,c,b,d,e){return null};d.prototype._attributeHash=function(a){for(var c="",b=0,d=this._symbolFields;b<d.length;b++){var e=this._fieldMap[d[b]];e&&(c+=a.attributes[e]+"-")}return c};return d}(k);a.DictionaryMatcher=k})},"esri/symbols/cim/cimSymbolUtils":function(){define("require exports tslib ../../symbols ../../core/promiseUtils ./cimAnalyzer ./ExpandedCIM".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.expandSymbol=a.expandSymbols=void 0;a.expandSymbols=function(d,c,e){return b.__awaiter(void 0,void 0,void 0,function(){return b.__generator(this,function(b){return[2,k.all(d.map(function(b){return a.expandSymbol(b,c,e)}))]})})};var d=function(a,c){return b.__awaiter(void 0,void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return d=g.ExpandedCIM.bind,[4,h.analyzeCIMSymbol(a.data,c)];
case 1:return[2,new (d.apply(g.ExpandedCIM,[void 0,b.sent(),a.data,a.rendererKey]))]}})})};a.expandSymbol=function(a,c,e){return b.__awaiter(void 0,void 0,void 0,function(){var f,g,h;return b.__generator(this,function(b){switch(b.label){case 0:if(!a)return[2,null];if("cim"===a.type)return[2,d(a,c)];if("web-style"!==a.type)return[3,2];f=l.WebStyleSymbol.fromJSON(a);h={type:"cim"};return[4,f.fetchCIMSymbol(e)];case 1:return g=(h.data=b.sent().data,h.rendererKey=a.rendererKey,h),[2,d(g,c)];case 2:return[2,
a]}})})}})},"esri/symbols/cim/cimAnalyzer":function(){define("require exports tslib ../../Color ../../core/Logger ../../core/promiseUtils ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./SDFHelper ./utils ../../views/2d/arcade/callExpressionWithFeature".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n,t){function x(a){switch(a){case "Butt":return 0;case "Square":return 2;default:return 1}}function p(a){switch(a){case "Bevel":return 0;case "Miter":return 2;default:return 1}}
function q(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function u(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function y(a){var c="normal",b="normal";a&&(a=a.toLowerCase(),-1!==a.indexOf("italic")?c="italic":-1!==a.indexOf("oblique")&&(c="oblique"),-1!==a.indexOf("bold")?b="bold":-1!==a.indexOf("light")&&(b="lighter"));return{style:c,weight:b}}
function w(a,c,b,d){var e;a[c]?e=a[c]:(e={},a[c]=e);e[b]=d}function B(a){return(a=a.markerPlacement)&&a.angleToLine?1:0}function z(a,b,e,f,g,h){if(a){var k=a.symbolLayers;if(k){var l,n=c.CIMSymbolHelper.getSize(a);"CIMPointSymbol"===a.type&&"Map"===a.angleAlignment&&(l=1);for(var m=k.length;m--;){var q=k[m];if(q&&!1!==q.enable){var u=[];c.OverrideHelper.findApplicableOverrides(q,b,u);switch(q.type){case "CIMSolidFill":A(q,e,u,f,g);break;case "CIMPictureFill":C(q,e,u,f,g);break;case "CIMHatchFill":E(q,
e,u,f,g);break;case "CIMGradientFill":var t=e,w=f,y=g,z=d.numericHash(JSON.stringify(q)).toString();y.push({type:"fill",templateHash:z,materialHash:0===u.length?z:S(z,t,u,w),cim:q,materialOverrides:null,colorLocked:q.colorLocked,effects:q.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1});break;case "CIMSolidStroke":D(q,e,u,f,g,"CIMPolygonSymbol"===a.type,n);break;case "CIMPictureStroke":F(q,e,u,f,g,"CIMPolygonSymbol"===a.type,n);break;case "CIMGradientStroke":var t=
e,w=f,y=g,z="CIMPolygonSymbol"===a.type,Q=n,L=q.primitiveName,X=void 0!==q.width?q.width:4,da=x(q.capStyle),P=p(q.joinStyle),V=q.miterLimit,T=d.numericHash(JSON.stringify(q)).toString();y.push({type:"line",templateHash:T,materialHash:0===u.length?T:S(T,t,u,w),cim:q,materialOverrides:null,isOutline:z,colorLocked:q.colorLocked,effects:q.effects,color:{r:128,g:128,b:128,a:1},width:N(L,t,"Width",w,X),cap:N(L,t,"CapStyle",w,da),join:N(L,t,"JoinStyle",w,P),miterLimit:N(L,t,"MiterLimit",w,V),referenceWidth:Q,
zOrder:O(q.name),isDashed:!1});break;case "CIMCharacterMarker":H(q,e,u,f,g);break;case "CIMPictureMarker":if(H(q,e,u,f,g))break;"CIMLineSymbol"===a.type&&(l=B(q));I(q,e,u,f,g,l,n);break;case "CIMVectorMarker":if(H(q,e,u,f,g))break;"CIMLineSymbol"===a.type&&(l=B(q));t=e;w=f;y=g;z=l;Q=n;L=h;if(P=q.markerGraphics)for(X=0,q.scaleSymbolsProportionally&&(da=q.frame)&&(X=da.ymax-da.ymin),da=0;da<P.length;da++)if(V=P[da])if(T=V.symbol)switch(T.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":K(q,
V,u,t,w,y,z,Q,X,L);break;case "CIMTextSymbol":G(q,V,t,u,w,y,z,Q,X)}break;default:W.error("Cannot analyze CIM layer",q.type)}}}}}}function A(a,c,b,e,f){var g=a.primitiveName,h=n.fromCIMColor(a.color),k=d.numericHash(JSON.stringify(a)).toString();f.push({type:"fill",templateHash:k,materialHash:0===b.length?k:function(){return k},cim:a,materialOverrides:null,colorLocked:a.colorLocked,color:N(g,c,"Color",e,h,P),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:a.effects})}function C(a,c,b,e,f){var g=
a.primitiveName,h=a.tintColor?n.fromCIMColor(a.tintColor):{r:255,g:255,b:255,a:1},k=d.numericHash(JSON.stringify(a)).toString(),l=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString();f.push({type:"fill",templateHash:k,materialHash:0===b.length?l:function(){return l},cim:a,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,color:N(g,c,"TintColor",e,h,P),height:N(g,c,"Height",e,a.height),scaleX:N(g,c,"ScaleX",e,a.scaleX),angle:N(g,c,"Rotation",e,a.rotation),offsetX:N(g,
c,"OffsetX",e,a.offsetX),offsetY:N(g,c,"OffsetY",e,a.offsetY)})}function E(a,c,b,e,f){var g=["Rotation","OffsetX","OffsetY"],h=b.filter(function(c){return c.primitiveName!==a.primitiveName&&-1===g.indexOf(c.propertyName)}),k=a.primitiveName,l=d.numericHash(JSON.stringify(a)).toString(),n=d.numericHash(""+a.separation+JSON.stringify(a.lineSymbol)).toString();f.push({type:"fill",templateHash:l,materialHash:0===b.length?n:S(n,c,h,e),cim:a,materialOverrides:h,colorLocked:a.colorLocked,effects:a.effects,
color:{r:255,g:255,b:255,a:1},height:N(k,c,"Separation",e,a.separation),scaleX:1,angle:N(k,c,"Rotation",e,a.rotation),offsetX:N(k,c,"OffsetX",e,a.offsetX),offsetY:N(k,c,"OffsetY",e,a.offsetY)})}function D(a,c,b,e,f,g,h){var k=d.numericHash(JSON.stringify(a)).toString(),l=a.primitiveName,m=n.fromCIMColor(a.color),q=void 0!==a.width?a.width:4,u=x(a.capStyle),t=p(a.joinStyle),w=a.miterLimit;f.push({type:"line",templateHash:k,materialHash:0===b.length?k:function(){return k},cim:a,materialOverrides:null,
isOutline:g,colorLocked:a.colorLocked,effects:a.effects,color:N(l,c,"Color",e,m,P),width:N(l,c,"Width",e,q),cap:N(l,c,"CapStyle",e,u),join:N(l,c,"JoinStyle",e,t),miterLimit:N(l,c,"MiterLimit",e,w),referenceWidth:h,zOrder:O(a.name),isDashed:!1})}function F(a,c,b,e,f,g,h){var k=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),l=a.primitiveName,m=n.fromCIMColor(a.tintColor),q=void 0!==a.width?a.width:4,u=x(a.capStyle),t=p(a.joinStyle),w=a.miterLimit,y=d.numericHash(JSON.stringify(a)).toString();
f.push({type:"line",templateHash:y,materialHash:0===b.length?k:function(){return k},cim:a,materialOverrides:null,isOutline:g,colorLocked:a.colorLocked,effects:a.effects,color:N(l,c,"TintColor",e,m,P),width:N(l,c,"Width",e,q),cap:N(l,c,"CapStyle",e,u),join:N(l,c,"JoinStyle",e,t),miterLimit:N(l,c,"MiterLimit",e,w),referenceWidth:h,zOrder:O(a.name),isDashed:!1})}function H(a,c,b,e,f){var g=a.markerPlacement;if(!g||"CIMMarkerPlacementInsidePolygon"!==g.type)return!1;var h=["Rotation","OffsetX","OffsetY"],
k=b.filter(function(c){return c.primitiveName!==a.primitiveName&&-1===h.indexOf(c.propertyName)}),l=d.numericHash(JSON.stringify(a)).toString();f.push({type:"fill",templateHash:l,materialHash:0===b.length?l:S(l,c,k,e),cim:a,materialOverrides:k,colorLocked:a.colorLocked,effects:a.effects,color:{r:255,g:255,b:255,a:1},height:N(g.primitiveName,c,"StepY",e,g.stepY),scaleX:1,angle:N(g.primitiveName,c,"GridAngle",e,g.gridAngle),offsetX:N(g.primitiveName,c,"OffsetX",e,g.offsetX),offsetY:N(g.primitiveName,
c,"OffsetY",e,g.offsetY)});return!0}function I(a,c,b,e,f,g,h){for(var k=a.primitiveName,l=a.size,p=a.scaleX,m=a.rotation,q=a.offsetX,u=a.offsetY,t=n.fromCIMColor(a.tintColor),w=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),y=!1,x="",C=0;C<b.length;C++){var B=b[C];B.primitiveName===k&&(void 0!==B.value?x+="-"+B.primitiveName+"-"+B.propertyName+"-"+JSON.stringify(B.value):B.valueExpressionInfo&&(y=!0))}f.push({type:"marker",templateHash:d.numericHash(JSON.stringify(a)+x).toString(),
materialHash:y?function(){return w}:w,cim:a,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:!1,alignment:g,size:N(k,c,"Size",e,l),scaleX:N(k,c,"ScaleX",e,p),rotation:N(k,c,"Rotation",e,m),offsetX:N(k,c,"OffsetX",e,q),offsetY:N(k,c,"OffsetY",e,u),color:N(k,c,"TintColor",e,t,P),anchorPoint:a.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:a.rotateClockwise,referenceSize:h,
sizeRatio:1,markerPlacement:a.markerPlacement})}function G(a,e,f,g,h,k,l,p,m){c.OverrideHelper.findApplicableOverrides(e,g,[]);var t=e.geometry;if("x"in t&&"y"in t){var w=e.symbol,x;x=w.underline?"underline":w.strikethrough?"line-through":"none";var C=y(w.fontStyleName);w.font=b.__assign({family:w.fontFamilyName,decoration:x},C);var B=a.frame,z=a.size/m;m=a.primitiveName;x=(w.height||0)*z;var C=w.angle||0,D=((w.offsetX||0)+(t.x-.5*(B.xmin+B.xmax)))*z,t=((w.offsetY||0)+(t.y-.5*(B.ymin+B.ymax)))*z,
B=n.fromCIMColor(c.CIMSymbolHelper.getFillColor(w)),A=n.fromCIMColor(c.CIMSymbolHelper.getStrokeColor(w)),E=c.CIMSymbolHelper.getStrokeWidth(w);E||(A=n.fromCIMColor(c.CIMSymbolHelper.getFillColor(w.haloSymbol)),E=w.haloSize*z);for(var z="",F=0;F<g.length;F++){var H=g[F];H.primitiveName===m&&void 0!==H.value&&(z+="-"+H.primitiveName+"-"+H.propertyName+"-"+JSON.stringify(H.value))}g=JSON.stringify(a.effects)+Number(a.colorLocked)+JSON.stringify(a.anchorPoint)+a.anchorPointUnits+JSON.stringify(a.markerPlacement);
g=d.numericHash(JSON.stringify(e)+g+z).toString();k.push({type:"text",templateHash:g,materialHash:function(){return d.numericHash(JSON.stringify(w.font)).toString()},cim:w,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,alignment:l,anchorPoint:{x:a.anchorPoint?a.anchorPoint.x:0,y:a.anchorPoint?a.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits,fontName:w.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:N(m,f,"Size",h,x),angle:N(m,f,"Rotation",
h,C),offsetX:N(m,f,"OffsetX",h,D),offsetY:N(m,f,"OffsetY",h,t),horizontalAlignment:q(w.horizontalAlignment),verticalAlignment:u(w.verticalAlignment),text:N(e.primitiveName,f,"TextString",h,e.textString,n._adjustTextCase,w.textCase),color:B,outlineColor:A,outlineSize:E,referenceSize:p,sizeRatio:1,markerPlacement:a.markerPlacement})}}function K(a,f,g,h,k,l,p,m,q,u){var t=f.geometry;if(t){var w=f.symbol.symbolLayers;if(w)if(u)L(a,f,h,g,k,l,p,m,q);else{var y=w.length;for(u=function(){var u=w[y];if(!u||
!1===u.enable)return"continue";switch(u.type){case "CIMSolidFill":case "CIMSolidStroke":var x=e.getExtent(t);if(!x)return"continue";var C=e.getSDFMetrics(x,a.frame,a.size,a.anchorPoint,"Relative"!==a.anchorPointUnits),x=C[0],B=C[1],C=C[2],z="CIMSolidFill"===u.type,D={type:"sdf",geom:t,asFill:z},A=a.primitiveName,E=a.size,F=a.rotation||0,H=a.offsetX,I=a.offsetY,G=u.primitiveName,K=z?n.fromCIMColor(c.CIMSymbolHelper.getFillColor(u)):n.fromCIMColor(c.CIMSymbolHelper.getStrokeColor(u)),X=z?{r:0,g:0,b:0,
a:0}:n.fromCIMColor(c.CIMSymbolHelper.getStrokeColor(u)),O=c.CIMSymbolHelper.getStrokeWidth(u);if(!z&&!O)break;for(var z=!1,fa="",da=0;da<g.length;da++){var Q=g[da];if(Q.primitiveName===G||Q.primitiveName===A)void 0!==Q.value?fa+="-"+Q.primitiveName+"-"+Q.propertyName+"-"+JSON.stringify(Q.value):Q.valueExpressionInfo&&(z=!0)}var A=JSON.stringify(b.__assign(b.__assign({},a),{markerGraphics:null})),aa=d.numericHash(JSON.stringify(D)).toString(),u={type:"marker",templateHash:d.numericHash(JSON.stringify(f)+
JSON.stringify(u)+A+fa).toString(),materialHash:z?function(){return aa}:aa,cim:D,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:p,anchorPoint:{x:B,y:C},isAbsoluteAnchorPoint:!1,size:N(a.primitiveName,h,"Size",k,E),rotation:N(a.primitiveName,h,"Rotation",k,F),offsetX:N(a.primitiveName,h,"OffsetX",k,H),offsetY:N(a.primitiveName,h,"OffsetY",k,I),scaleX:1,frameHeight:q,rotateClockwise:a.rotateClockwise,referenceSize:m,
sizeRatio:x,color:N(G,h,"Color",k,K,P),outlineColor:N(G,h,"Color",k,X,P),outlineWidth:N(G,h,"Width",k,O),markerPlacement:a.markerPlacement};l.push(u);break;default:L(a,f,h,g,k,l,p,m,q)}};y--;)u()}}}function L(a,b,e,f,h,k,l,n,p){b={type:a.type,enable:!0,name:a.name,colorLocked:a.colorLocked,primitiveName:a.primitiveName,anchorPoint:a.anchorPoint,anchorPointUnits:a.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:a.rotateClockwise,rotation:0,size:a.size,billboardMode3D:a.billboardMode3D,depth3D:a.depth3D,
frame:a.frame,markerGraphics:[b],scaleSymbolsProportionally:a.scaleSymbolsProportionally,respectFrame:a.respectFrame,clippingPath:a.clippingPath,effects:a.effects};for(var m=[],q=["Rotation","OffsetX","OffsetY"],m=f.filter(function(c){return c.primitiveName!==a.primitiveName||-1===q.indexOf(c.propertyName)}),u="",t=0;t<f.length;t++){var w=f[t];void 0!==w.value&&(u+="-"+w.primitiveName+"-"+w.propertyName+"-"+JSON.stringify(w.value))}w=c.CIMSymbolHelper.getTextureAnchor(b);f=w[0];var t=w[1],w=w[2],
y=a.primitiveName,x=a.rotation||0,C=a.offsetX||0,B=a.offsetY||0,u=d.numericHash(JSON.stringify(b)+u).toString();e={type:"marker",templateHash:u,materialHash:0===m.length?u:S(u,e,m,h),cim:b,materialOverrides:m,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:f,y:t},isAbsoluteAnchorPoint:!1,size:a.size,rotation:N(y,e,"Rotation",h,x),offsetX:N(y,e,"OffsetX",h,C),offsetY:N(y,e,"OffsetY",h,B),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,
g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:p,rotateClockwise:a.rotateClockwise,referenceSize:n,sizeRatio:w/g.pt2px(a.size),markerPlacement:a.markerPlacement};k.push(e)}function O(a){return a&&0===a.indexOf("Level_")?parseInt(a.substr(6),10):0}function P(a){if(!a||0===a.length)return null;a=(new l(a)).toRgba();return{r:a[0],g:a[1],b:a[2],a:a[3]}}function N(a,c,b,d,e,g,h){if(a=c[a]){var k=a[b];if("string"===typeof k||"number"===typeof k||k instanceof Array)return g?g.call(null,k,h):k;if(null!=
k&&k instanceof f.default)return function(a,c,b){a=t.default(k,a,{$view:b},d.geometryType,c);null!==a&&g&&(a=g.call(null,a,h));return null!==a?a:e}}return e}function S(a,b,e,g){for(var h=function(a){if(a.valueExpressionInfo){var c=b[a.primitiveName]&&b[a.primitiveName][a.propertyName];c instanceof f.default&&(a.fn=function(a,b,d){return t.default(c,a,{$view:d},g.geometryType,b)})}},k=0;k<e.length;k++)h(e[k]);return function(b,f,g){for(var h=0;h<e.length;h++){var k=e[h];k.fn&&(k.value=k.fn(b,f,g))}return d.numericHash(a+
c.OverrideHelper.buildOverrideKey(e)).toString()}}Object.defineProperty(a,"__esModule",{value:!0});a.analyzeCIMResource=a.analyzeCIMSymbol=void 0;var W=k.getLogger("esri.symbols.cim.cimAnalyzer");a.analyzeCIMSymbol=function(a,c,d,e){return b.__awaiter(this,void 0,void 0,function(){var g,k,l,n,p,m,q,u,t;return b.__generator(this,function(b){switch(b.label){case 0:g=d?d:[];if(!a)return[2,g];n={};if("CIMSymbolReference"!==a.type)return[3,3];k=a.symbol;l=a.primitiveOverrides;if(!l)return[3,2];p=[];m=
function(a){var b=a.valueExpressionInfo;b&&c?(b=f.createRendererExpression(b.expression,c.spatialReference,c.fields).then(function(c){c&&w(n,a.primitiveName,a.propertyName,c)}),p.push(b)):null!=a.value&&w(n,a.primitiveName,a.propertyName,a.value)};q=0;for(u=l;q<u.length;q++)t=u[q],m(t);return[4,h.all(p)];case 1:b.sent(),b.label=2;case 2:return[3,4];case 3:return W.error("Expect cim type to be 'CIMSymbolReference'"),[2,g];case 4:switch(k.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":z(k,
l,n,c,g,e)}return[2,g]}})})};a.analyzeCIMResource=function(a,b){if(!b||0===b.length)return a;a=JSON.parse(JSON.stringify(a));c.OverrideHelper.applyOverrides(a,b);return a}})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports tslib ../../Color ../../core/Logger ../../core/mathUtils ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(m,a,b,l,k,h,g,d,f){function c(a,c){switch(c.type){case "CIMSymbolReference":var b={type:"point",x:0,y:0};a.drawSymbol(c.symbol,
b);break;case "CIMPointSymbol":b={type:"point",x:0,y:0};a.drawSymbol(c,b);break;case "CIMVectorMarker":b=new g.Placement,a.drawMarker(c,b)}return a.envelope()}Object.defineProperty(a,"__esModule",{value:!0});a.OverrideHelper=a.SymbolHelper=a.CIMSymbolHelper=void 0;var e=Math.PI,n=e/2,t=k.getLogger("esri.symbols.cim.CIMSymbolHelper");m=function(){function a(){}a.getEnvelope=function(a){var b=new d.EnvDrawHelper;if(Array.isArray(a)){for(var e=void 0,f=0;f<a.length;f++){var g=a[f];e?e.union(c(b,g)):
e=c(b,g)}return e}return c(b,a)};a.getTextureAnchor=function(a){a=this.getEnvelope(a);if(!a||0>=a.width||0>=a.height)return[0,0,0];var c=96/72,b=a.height*c+2;return[(a.x+.5*a.width)*c/(a.width*c+2),-(a.y+.5*a.height)*c/b,b]};a.rasterize=function(a,c,b,e){void 0===e&&(e=!0);var f=b||this.getEnvelope(c);if(!f||0>=f.width||0>=f.height)return[null,0,0,0,0];var h=96/72,k=(f.x+.5*f.width)*h,l=(f.y+.5*f.height)*h;a.width=f.width*h;a.height=f.height*h;b||(a.width+=2,a.height+=2);b=a.getContext("2d");h=d.Transformation.createScale(h,
-h);h.translate(.5*a.width-k,.5*a.height+l);h=new d.CanvasDrawHelper(b,h);switch(c.type){case "CIMPointSymbol":h.drawSymbol(c,{type:"point",x:0,y:0});break;case "CIMVectorMarker":f=new g.Placement,h.drawMarker(c,f)}c=b.getImageData(0,0,a.width,a.height);c=new Uint8Array(c.data);if(e)for(e=void 0,b=0;b<c.length;b+=4)e=c[b+3]/255,c[b]*=e,c[b+1]*=e,c[b+2]*=e;return[c,a.width,a.height,-k/a.width,-l/a.height]};a.fromSimpleMarker=function(a){var c,b,d=a.style;if("circle"===d||"esriSMSCircle"===d){c=Math.acos(.995);
b=Math.ceil(e/c/4);0===b&&(b=1);c=n/b;b*=4;d=[];d.push([50,0]);for(var f=1;f<b;f++)d.push([50*Math.cos(f*c),-50*Math.sin(f*c)]);d.push([50,0]);c={rings:[d]};b={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===d||"esriSMSCross"===d)c=0,c={rings:[[[c,50],[c,c],[50,c],[50,-c],[c,-c],[c,-50],[-c,-50],[-c,-c],[-50,-c],[-50,c],[-c,c],[-c,50],[c,50]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===d||"esriSMSDiamond"===d)c={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},b={xmin:-50,ymin:-50,
xmax:50,ymax:50};else if("square"===d||"esriSMSSquare"===d)c={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===d||"esriSMSX"===d)c=0,c={rings:[[[0,c],[50-c,50],[50,50-c],[c,0],[50,c-50],[50-c,-50],[0,-c],[c-50,-50],[-50,c-50],[-c,0],[-50,50-c],[c-50,50],[0,c]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===d||"esriSMSTriangle"===d)b=2/3*100,d=b-100,c={rings:[[[-57.735026918962575,d],[0,b],[57.735026918962575,d],[-57.735026918962575,
d]]]},b={xmin:-57.735026918962575,ymin:d,xmax:57.735026918962575,ymax:b};else if("arrow"===d||"esriSMSArrow"===d)c={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},b={xmin:-50,ymin:-50,xmax:50,ymax:50};var g;c&&b&&(g=[{type:"CIMSolidFill",enable:!0,color:a.color}],a.outline&&g.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),g={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,
frame:b,markerGraphics:[{type:"CIMMarkerGraphic",geometry:c,symbol:{type:"CIMPolygonSymbol",symbolLayers:g}}]}]});return g};a.fromCIMHatchFill=function(a){for(var c=void 0!==a.separation?a.separation:4,b=c/2,d=this._getLineSymbolPeriod(a.lineSymbol)||4;4>d;)d*=2;d/=2;return{type:"CIMVectorMarker",frame:{xmin:-d,xmax:d,ymin:-b,ymax:b},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-d,0],[d,0]]]},symbol:a.lineSymbol}],size:c}};a._getLineSymbolPeriod=function(a){if(a){var c=this._getEffectsRepeat(a.effects);
if(c)return c;if(a.symbolLayers)for(c=0,a=a.symbolLayers;c<a.length;c++){var b=a[c],d=this._getEffectsRepeat(b.effects);if(d)return d;if(b&&(b=this._getPlacementRepeat(b.markerPlacement)))return b}}return 0};a._getEffectsRepeat=function(a){if(a)for(var c=0;c<a.length;c++){var b=a[c];if(b)switch(b.type){case "CIMGeometricEffectDashes":if((b=b.dashTemplate)&&b.length){for(var c=a=0,d=b;c<d.length;c++)a+=d[c];b.length&1&&(a*=2);return a}break;case "CIMGeometricEffectWave":return b.period;default:t.error("unsupported geometric effect type "+
b.type)}}return 0};a._getPlacementRepeat=function(a){if(a)switch(a.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((a=a.placementTemplate)&&a.length){for(var c=0,b=0;b<a.length;b++)c+=a[b];a.length&1&&(c*=2);return c}}return 0};a.fromCIMInsidePolygon=function(a){var c=a.markerPlacement,d=c.stepX/2,e=c.stepY/2,d={xmin:-d,xmax:d,ymin:-e,ymax:e};a=b.__assign({type:a.type},a);a.markerPlacement=null;a.anchorPoint=
null;return{type:"CIMVectorMarker",frame:d,markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[a]}}],size:c.stepY}};a.getFillColor=function(c){if(!c)return null;switch(c.type){case "CIMPolygonSymbol":if(c.symbolLayers){var b=0;for(c=c.symbolLayers;b<c.length;b++){var d=a.getFillColor(c[b]);if(null!=d)return d}}break;case "CIMTextSymbol":return a.getFillColor(c.symbol);case "CIMSolidFill":return c.color}};a.getStrokeColor=function(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c.symbolLayers){var b=
0;for(c=c.symbolLayers;b<c.length;b++){var d=a.getStrokeColor(c[b]);if(void 0!==d)return d}}break;case "CIMTextSymbol":return a.getStrokeColor(c.symbol);case "CIMSolidStroke":return c.color}};a.getStrokeWidth=function(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c.symbolLayers){var b=0;for(c=c.symbolLayers;b<c.length;b++){var d=a.getStrokeWidth(c[b]);if(void 0!==d)return d}}break;case "CIMTextSymbol":return a.getStrokeWidth(c.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return c.width}};
a.getSize=function(c){if(c)switch(c.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var b=0;if(c.symbolLayers){var d=0;for(c=c.symbolLayers;d<c.length;d++){var e=a.getSize(c[d]);e>b&&(b=e)}}return b;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return c.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return c.size}};a.getMarkerScaleRatio=function(a){if(a)switch(a.type){case "CIMVectorMarker":if(!1!==a.scaleSymbolsProportionally&&
a.frame)return a.size/(a.frame.ymax-a.frame.ymin)}return 1};return a}();a.CIMSymbolHelper=m;m=function(){function a(){}a.rasterizeSimpleFill=function(a,c,b){"solid"!==c&&"none"!==c&&"esriSFSSolid"!==c&&"esriSFSNull"!==c||console.error("Unexpected: style does not require rasterization");b=h.nextPowerOfTwo(Math.ceil(b));var d=16*b,e=2*b;a.width=d;a.height=d;var f=a.getContext("2d");f.strokeStyle="#FFFFFF";f.lineWidth=b;f.beginPath();if("vertical"===c||"cross"===c||"esriSFSCross"===c||"esriSFSVertical"===
c)f.moveTo(d/2,-e),f.lineTo(d/2,d+e);if("horizontal"===c||"cross"===c||"esriSFSCross"===c||"esriSFSHorizontal"===c)f.moveTo(-e,d/2),f.lineTo(d+e,d/2);if("forward-diagonal"===c||"diagonal-cross"===c||"esriSFSDiagonalCross"===c||"esriSFSForwardDiagonal"===c)f.moveTo(-e,-e),f.lineTo(d+e,d+e),f.moveTo(d-e,-e),f.lineTo(d+e,e),f.moveTo(-e,d-e),f.lineTo(e,d+e);if("backward-diagonal"===c||"diagonal-cross"===c||"esriSFSBackwardDiagonal"===c||"esriSFSDiagonalCross"===c)f.moveTo(d+e,-e),f.lineTo(-e,d+e),f.moveTo(e,
-e),f.lineTo(-e,e),f.moveTo(d+e,d-e),f.lineTo(d-e,d+e);f.stroke();c=f.getImageData(0,0,a.width,a.height);c=new Uint8Array(c.data);for(d=0;d<c.length;d+=4)b=c[d+3]/255,c[d]*=b,c[d+1]*=b,c[d+2]*=b;return[c,a.width,a.height]};a.rasterizeSimpleLine=function(a,c){switch(c){case "butt":c="Butt";break;case "square":c="Square";break;default:c="Round"}var b="Butt"===c;switch(a){case "dash":case "esriSLSDash":a=b?[4,3]:[3,4];break;case "dash-dot":case "esriSLSDashDot":a=b?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":a=
b?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":a=b?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":a=b?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":a=b?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":a=b?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=b?[4,1,1,1]:[3,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=b?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=
b?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":t.error("Unexpected: style does not require rasterization");a=[0,0];break;default:t.error("Tried to rasterize SLS, but found an unexpected style: "+a+"!"),a=[0,0]}return this.rasterizeDash(a,c)};a.rasterizeDash=function(a,c){var b="Butt"===c,d="Square"===c;c=!b&&!d;for(var e=0,g=0;g<a.length;g++)var h=a[g],e=e+h;for(var e=15*e,k=31*e,g=new Float32Array(k),l=c?225:15,h=0;h<k;++h)g[h]=l;for(var l=k=0,n=!0,m=0;m<a.length;m++){for(var h=
a[m],k=l,l=l+15*h,p=k;p<l;){for(var q=0;31>q;){var h=q*e+p,t=c?(q-15)*(q-15):Math.abs(q-15);g[h]=n?b?Math.max(Math.max(k+7.5-p,t),Math.max(p-l+7.5,t)):t:c?Math.min((p-k)*(p-k)+t,(p-l)*(p-l)+t):d?Math.min(Math.max(p-k,t),Math.max(l-p,t)):Math.min(Math.max(p-k+7.5,t),Math.max(l+7.5-p,t));q++}p++}n=!n}a=g.length;b=new Uint8Array(4*a);for(h=0;h<a;++h)f.packFloatRGBA((c?Math.sqrt(g[h]):g[h])/15,b,4*h);return[b,e,31]};return a}();a.SymbolHelper=m;m=function(){function a(){}a.findApplicableOverrides=function(c,
b,d){if(b){if(c.primitiveName){for(var e=!1,f=0;f<d.length;f++){var g=d[f];if(g.primitiveName===c.primitiveName){e=!0;break}}if(!e)for(e=0;e<b.length;e++)g=b[e],g.primitiveName===c.primitiveName&&d.push(g)}switch(c.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(c.effects)for(e=0,f=c.effects;e<f.length;e++)g=f[e],a.findApplicableOverrides(g,b,d);if(c.symbolLayers)for(g=0,c=c.symbolLayers;g<c.length;g++)a.findApplicableOverrides(c[g],b,d);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(c.effects)for(e=
0,f=c.effects;e<f.length;e++)g=f[e],a.findApplicableOverrides(g,b,d);c.markerPlacement&&a.findApplicableOverrides(c.markerPlacement,b,d);if("CIMVectorMarker"===c.type){if(c.markerGraphics)for(g=0,c=c.markerGraphics;g<c.length;g++)e=c[g],a.findApplicableOverrides(e,b,d),a.findApplicableOverrides(e.symbol,b,d)}else"CIMCharacterMarker"===c.type?a.findApplicableOverrides(c.symbol,b,d):"CIMHatchFill"===c.type&&a.findApplicableOverrides(c.lineSymbol,b,d)}}};a.applyOverrides=function(c,b,d,e){if(b){if(c.primitiveName)for(var f=
0;f<b.length;f++){var g=b[f];if(g.primitiveName===c.primitiveName){var h;h=(h=g.propertyName)?h.charAt(0).toLowerCase()+h.substr(1):h;e&&e.push({cim:c,nocapPropertyName:h,value:c[h]});g.expression&&(g.value=a.toValue(g.propertyName,g.expression));if(d){for(var k=!1,l=0,n=d;l<n.length;l++)n[l].primitiveName===c.primitiveName&&(k=!0);k||d.push(g)}c[h]=g.value}}switch(c.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(c.effects)for(g=0,h=c.effects;g<h.length;g++)f=h[g],a.applyOverrides(f,
b,d,e);if(c.symbolLayers)for(f=0,c=c.symbolLayers;f<c.length;f++)a.applyOverrides(c[f],b,d,e);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(c.effects)for(g=0,h=c.effects;g<h.length;g++)f=h[g],a.applyOverrides(f,b,d,e);if("CIMVectorMarker"===c.type&&c.markerGraphics)for(f=0,c=c.markerGraphics;f<c.length;f++)g=c[f],a.applyOverrides(g,b,d,e),a.applyOverrides(g.symbol,b,d,e)}}};a.restoreOverrides=function(a){for(var c=0;c<a.length;c++){var b=a[c];b.cim[b.nocapPropertyName]=
b.value}};a.buildOverrideKey=function(a){for(var c="",b=0;b<a.length;b++){var d=a[b];void 0!==d.value&&(c+=""+d.primitiveName+d.propertyName+JSON.stringify(d.value))}return c};a.toValue=function(a,c){return"DashTemplate"===a?c.split(" ").map(function(a){return Number(a)}):"Color"===a?(a=(new l(c)).toRgba(),a[3]*=255,a):c};return a}();a.OverrideHelper=m})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.EmptyPlacementCursor=
a.Placement=void 0;m=function(){function a(){this.setIdentity()}a.prototype.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,b){this.tx=a;this.ty=b};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,b){this.rz=void 0;this.rz_c=
a;this.rz_s=b};a.prototype.setRotate=function(a){this.rz=a;this.rz_s=this.rz_c=void 0};a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=a};return a}();a.Placement=m;m=function(){function a(){}a.prototype.next=function(){return null};return a}();a.EmptyPlacementCursor=m})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("require exports tslib ../../core/Logger ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./Rect".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e){Object.defineProperty(a,"__esModule",{value:!0});a.CanvasDrawHelper=a.EnvDrawHelper=a.CIMSymbolDrawHelper=a.Transformation=a.C_DEG_TO_RAD=void 0;a.C_DEG_TO_RAD=Math.PI/180;var n=l.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),t=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var c=this._t;return[c[0]*a[0]+c[1]*a[1]+c[2],c[3]*
a[0]+c[4]*a[1]+c[5]]};a.createScale=function(c,b){return new a([c,0,0,0,b,0])};a.prototype.scale=function(a,c){var b=this._t;b[0]*=a;b[1]*=a;b[2]*=a;b[3]*=c;b[4]*=c;b[5]*=c;return this};a.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(c,b){return new a([0,0,c,0,0,b])};a.prototype.translate=function(a,c){var b=this._t;b[2]+=a;b[5]+=c;return this};a.createRotate=function(c){var b=Math.cos(c);c=Math.sin(c);return new a([b,-c,
0,c,b,0])};a.prototype.rotate=function(c){return this.multiply(a.createRotate(c))};a.prototype.multiply=function(a){var c=this._t;a=a._t;var b=c[1]*a[0]+c[4]*a[1],d=c[2]*a[0]+c[5]*a[1]+a[2],e=c[0]*a[3]+c[3]*a[4],f=c[1]*a[3]+c[4]*a[4],g=c[2]*a[3]+c[5]*a[4]+a[5];c[0]=c[0]*a[0]+c[3]*a[1];c[1]=b;c[2]=d;c[3]=e;c[4]=f;c[5]=g;return this};return a}();a.Transformation=t;m=function(){function b(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||t.createIdentity());this._sizeTransfos.push(a?
a.scaleRatio():1)}b.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};b.prototype.transformSize=function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};b.prototype.back=function(){return this._transfos[this._transfos.length-1]};b.prototype.push=function(a,c){c=c?a.scaleRatio():1;a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*c)};b.prototype.pop=function(){this._transfos.splice(-1,
1);this._sizeTransfos.splice(-1,1)};b.prototype.drawSymbol=function(a,c){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,c)}};b.prototype.drawMultiLayerSymbol=function(a,c){if(a){var b=a.symbolLayers;if(b)if(a=a.effects){if(c=this.executeEffects(a,c))for(a=c.next();a;)this.drawSymbolLayers(b,a),a=c.next()}else this.drawSymbolLayers(b,c)}};b.prototype.executeEffects=function(a,c){c=new d.SimpleGeometryCursor(c);for(var b=0;b<a.length;b++){var e=
a[b],g=f.getEffectOperator(e);g&&(c=g.execute(c,e,1))}return c};b.prototype.drawSymbolLayers=function(a,c){for(var b=a.length;b--;){var d=a[b];if(d&&!1!==d.enable){var e=d.effects;if(e){if(e=this.executeEffects(e,c))for(var f=e.next();f;)this.drawSymbolLayer(d,f),f=e.next()}else this.drawSymbolLayer(d,c)}}};b.prototype.drawSymbolLayer=function(a,c){switch(a.type){case "CIMSolidFill":this.drawSolidFill(c,a.color);break;case "CIMHatchFill":this.drawHatchFill(a,c);break;case "CIMSolidStroke":this.drawSolidStroke(c,
a.color,a.width,a.capStyle,a.joinStyle,a.miterLimit);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(a,c)}};b.prototype.drawHatchFill=function(a,c){var b=this._buildHatchPolyline(a,c,1);b&&(this.pushClipPath(c),this.drawMultiLayerSymbol(a.lineSymbol,b),this.popClipPath())};b.prototype.drawMarkerLayer=function(a,b){var d=a.markerPlacement;if(d){var e=f.getPlacementOperator(d);if(e){var g="CIMMarkerPlacementInsidePolygon"===d.type;g&&this.pushClipPath(b);
if(b=e.execute(b,d,1))for(d=b.next();d;)this.drawMarker(a,d),d=b.next();g&&this.popClipPath()}}else g=new c.Placement,g.tx=b.x,g.ty=b.y,this.drawMarker(a,g)};b.prototype.drawMarker=function(a,c){switch(a.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(a,c);break;case "CIMVectorMarker":this.drawVectorMarker(a,c)}};b.prototype.drawPictureMarker=function(a,c){};b.prototype.drawVectorMarker=function(c,b){if(c){var d=c.markerGraphics;if(d){var e=c.size,f=c.frame,g=f?f.ymax-
f.ymin:0,e=e&&g?e/g:1,g=t.createIdentity();f&&g.translate(.5*-(f.xmax+f.xmin),.5*-(f.ymax+f.ymin));var h=c.anchorPoint;if(h){var k=h.x,h=h.y;"Absolute"!==c.anchorPointUnits&&f&&(k*=f.xmax-f.xmin,h*=f.ymax-f.ymin);g.translate(-k,-h)}1!==e&&g.scale(e,e);c.rotation&&g.rotate(c.rotation*a.C_DEG_TO_RAD);g.translate(c.offsetX||0,c.offsetY||0);g.translate(b.tx,b.ty);this.push(g,c.scaleSymbolsProportionally);for(c=0;c<d.length;c++)(b=d[c])&&b.symbol&&b.geometry||n.error("Invalid marker graphic",b),this.drawSymbol(b.symbol,
b.geometry);this.pop()}}};b.prototype._buildHatchPolyline=function(c,b,d){var e=(void 0!==c.separation?c.separation:4)*d,f=void 0!==c.rotation?c.rotation:0;if(0===e)return null;0>e&&(e=-e);for(var g=0,l=.5*e;g>l;)g-=e;for(;g<-l;)g+=e;g=k.create();h.getBoundsXY(g,b);g[0]-=l;g[1]-=l;g[2]+=l;g[3]+=l;for(var n=[[g[0],g[1]],[g[0],g[3]],[g[2],g[3]],[g[2],g[1]]];180<f;)f-=180;for(;0>f;)f+=180;var l=Math.cos(f*a.C_DEG_TO_RAD),m=Math.sin(f*a.C_DEG_TO_RAD),f=-e*m;b=e*l;var g=(void 0!==c.offsetX?c.offsetX*d:
0)*m-(void 0!==c.offsetY?c.offsetY*d:0)*l,p,q;p=c=Number.MAX_VALUE;q=d=-Number.MAX_VALUE;for(var t=0;t<n.length;t++){var u=n[t],x=u[0],G=u[1],u=l*x+m*G,x=-m*x+l*G;p=Math.min(p,u);c=Math.min(c,x);q=Math.max(q,u);d=Math.max(d,x)}c=Math.floor(c/e)*e;n=l*p-m*c-f*g/e;p=m*p+l*c-b*g/e;t=l*q-m*c-f*g/e;g=m*q+l*c-b*g/e;e=1+Math.round((d-c)/e);l=[];for(m=0;m<e;m++)n+=f,p+=b,t+=f,g+=b,l.push([[n,p],[t,g]]);return{paths:l}};return b}();a.CIMSymbolDrawHelper=m;l=function(a){function c(){var c=a.call(this)||this;
c.reset();return c}b.__extends(c,a);c.prototype.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};c.prototype.envelope=function(){return new e.default(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};c.prototype.drawSolidFill=function(a){!a||0<this._clipCount||(g.isPolygon(a)?this._processPath(a.rings,0):g.isPolyline(a)&&this._processPath(a.paths,0))};c.prototype.drawSolidStroke=function(a,c,b){!a||0<this._clipCount||(c=.5*this.transformSize(b),
g.isPolygon(a)?this._processPath(a.rings,c):g.isPolyline(a)&&this._processPath(a.paths,c))};c.prototype.pushClipPath=function(a){this.drawSolidFill(a);++this._clipCount};c.prototype.popClipPath=function(){--this._clipCount};c.prototype._processPath=function(a,c){if(a)for(var b=0;b<a.length;b++){var d=a[b],e=d?d.length:0;if(1<e){this._merge(this.transformPt(d[0]),c);for(var f=1;f<e;++f)this._merge(this.transformPt(d[f]),c)}}};c.prototype._merge=function(a,c){a[0]-c<this._xmin&&(this._xmin=a[0]-c);
a[0]+c>this._xmax&&(this._xmax=a[0]+c);a[1]-c<this._ymin&&(this._ymin=a[1]-c);a[1]+c>this._ymax&&(this._ymax=a[1]+c)};return c}(m);a.EnvDrawHelper=l;m=function(a){function c(c,b){b=a.call(this,b)||this;b._ctx=c;return b}b.__extends(c,a);c.prototype.drawSolidFill=function(a,c){if(a){if(g.isPolygon(a))this._buildPath(a.rings,!0);else if(g.isPolyline(a))this._buildPath(a.paths,!0);else return;a=this._ctx;a.fillStyle="string"===typeof c?c:"rgba("+Math.round(c[0])+","+Math.round(c[1])+","+Math.round(c[2])+
","+c[3]/255+")";a.fill("evenodd")}};c.prototype.drawSolidStroke=function(a,c,b,d,e,f){if(a&&c&&0!==b){if(g.isPolygon(a))this._buildPath(a.rings,!0);else if(g.isPolyline(a))this._buildPath(a.paths,!1);else return;a=this._ctx;a.strokeStyle="string"===typeof c?c:"rgba("+Math.round(c[0])+","+Math.round(c[1])+","+Math.round(c[2])+","+c[3]/255+")";a.lineWidth=this.transformSize(b)+.5;this._setCapStyle(d);this._setJoinStyle(e);a.miterLimit=f;a.stroke()}};c.prototype.pushClipPath=function(a){this._ctx.save();
g.isPolygon(a)?this._buildPath(a.rings,!0):g.isPolyline(a)&&this._buildPath(a.paths,!0);this._ctx.clip("evenodd")};c.prototype.popClipPath=function(){this._ctx.restore()};c.prototype._buildPath=function(a,c){var b=this._ctx;b.beginPath();if(a)for(var d=0;d<a.length;d++){var e=a[d],f=e?e.length:0;if(1<f){var g=this.transformPt(e[0]);b.moveTo(g[0],g[1]);for(var h=1;h<f;++h)g=this.transformPt(e[h]),b.lineTo(g[0],g[1]);c&&b.closePath()}}};c.prototype._setCapStyle=function(a){switch(a){case "Butt":this._ctx.lineCap=
"butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};c.prototype._setJoinStyle=function(a){switch(a){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin="round";break;case "Miter":this._ctx.lineJoin="miter"}};return c}(m);a.CanvasDrawHelper=m})},"esri/symbols/cim/CIMEffects":function(){define(["require","exports","../../core/lang"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.clone=a.SimpleGeometryCursor=
void 0;m=function(){function a(a){this._geometry=a}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a};return a}();a.SimpleGeometryCursor=m;a.clone=function(a){return b.clone(a)}})},"esri/symbols/cim/CIMOperators":function(){define("require exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w,B,z,A){Object.defineProperty(a,"__esModule",{value:!0});a.getPlacementOperator=a.getEffectOperator=void 0;a.getEffectOperator=function(a){if(!a)return null;switch(a.type){case "CIMGeometricEffectAddControlPoints":return b.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return l.EffectArrow.local();case "CIMGeometricEffectBuffer":return k.EffectBuffer.local();case "CIMGeometricEffectCut":return h.EffectCut.local();case "CIMGeometricEffectDashes":return g.EffectDashes.local();
case "CIMGeometricEffectDonut":return d.EffectDonut.local();case "CIMGeometricEffectJog":return f.EffectJog.local();case "CIMGeometricEffectMove":return c.EffectMove.local();case "CIMGeometricEffectOffset":return e.EffectOffset.local();case "CIMGeometricEffectReverse":return n.EffectReverse.local();case "CIMGeometricEffectRotate":return t.EffectRotate.local();case "CIMGeometricEffectScale":return x.EffectScale.local();case "CIMGeometricEffectWave":return p.EffectWave.local()}return null};a.getPlacementOperator=
function(a){if(!a)return null;switch(a.type){case "CIMMarkerPlacementAlongLineSameSize":return q.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return u.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return y.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return w.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return B.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return z.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return A.PlacementPolygonCenter.local()}return null}})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectAddControlPoints=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,
b,c)};a.instance=null;return a}();a.EffectAddControlPoints=m;var h=function(){function a(a,b,c){this._inputGeometries=a;this._angleTolerance=void 0!==b.angleTolerance?b.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(l.isPolygon(a))return this._isClosed=!0,a=b.clone(a),this._processMultipath(a.rings),a;if(l.isPolyline(a))return this._isClosed=!1,a=b.clone(a),this._processMultipath(a.paths),
a;if(l.isExtent(a)){if(this._maxCosAngle)return a;this._isClosed=!0;a=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];this._processPath(a);return{rings:[a]}}a=this._inputGeometries.next()}return null};a.prototype._processMultipath=function(a){if(a)for(var b=0;b<a.length;b++)this._processPath(a[b])};a.prototype._processPath=function(a){if(a){var b=a.length,c=a[0],d=void 0,g=void 0,h=void 0,l=void 0,m=void 0,q=void 0;this._isClosed&&++b;for(var u=1;u<b;++u){var y=void 0,
y=this._isClosed&&u===b-1?a[0]:a[u],w=y[0]-c[0],B=y[1]-c[1],z=Math.sqrt(w*w+B*B);1<u&&0<z&&0<h&&(d*w+g*B)/z/h<=this._maxCosAngle&&k.setId(c,1);1===u&&(l=w,m=B,q=z);0<z&&(c=y,d=w,g=B,h=z)}this._isClosed&&0<h&&0<q&&(d*l+g*m)/q/h<=this._maxCosAngle&&k.setId(a[0],1)}};return a}()})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(m,a,b,l,k){function h(a){if(a)for(var c=a.length-1;0<c;--c)a[c][0]-=a[c-
1][0],a[c][1]-=a[c-1][1]}function g(a){if(a)for(var c=0;c<a.length;c++)h(a[c])}function d(a){if(a)for(var c=a.length,b=1;b<c;++b)a[b][0]+=a[b-1][0],a[b][1]+=a[b-1][1]}function f(a){if(a)for(var c=0;c<a.length;c++)d(a[c])}function c(a){a&&(l.isPolygon(a)?f(a.rings):l.isPolyline(a)?f(a.paths):l.isMultipoint(a)&&d(a.points))}function e(a){a&&a.reverse()}function n(a){return{rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}Object.defineProperty(a,"__esModule",
{value:!0});a.PathGeometryCursor=a.PathTransformationCursor=a.setId=a.getId=a.isClosedPath=a.getCoord2D=a.reversePath=a.reverseMultipath=a.deltaEncodeGeometry=a.deltaDecodeGeometry=a.cloneAndDecodeGeometry=void 0;a.cloneAndDecodeGeometry=function(a){a=b.clone(a);c(a);return a};a.deltaDecodeGeometry=c;a.deltaEncodeGeometry=function(a){a&&(l.isPolygon(a)?g(a.rings):l.isPolyline(a)?g(a.paths):l.isMultipoint(a)&&h(a.points))};a.reverseMultipath=function(a){if(a)for(var c=0;c<a.length;c++)e(a[c])};a.reversePath=
e;a.getCoord2D=function(a,c,b){return[a[0]+(c[0]-a[0])*b,a[1]+(c[1]-a[1])*b]};a.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};a.getId=function(a){return a[4]};a.setId=function(a,c){a[4]=c};m=function(){function a(a,c,b,d){this.acceptPolygon=c;this.acceptPolyline=b;this.geomUnitsPerPoint=d;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(l.isPolygon(a)?c&&(this.multiPath=a.rings,this.isClosed=!0):l.isPolyline(a)?b&&(this.multiPath=
a.paths,this.isClosed=!1):l.isExtent(a)&&c&&(this.multiPath=n(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new k.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var a=this.processPath(this.multiPath[this.pathIndex]);if(a)return a}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}();a.PathTransformationCursor=
m;m=function(){function a(a,c,b,d){this.inputGeometries=a;this.acceptPolygon=c;this.acceptPolyline=b;this.geomUnitsPerPoint=d;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(l.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):l.isPolyline(a)?this.acceptPolyline&&(this.multiPath=a.paths,this.isClosed=!1):l.isExtent(a)&&this.acceptPolygon&&(this.multiPath=n(a).rings,this.isClosed=
!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();a.PathGeometryCursor=m})},"esri/symbols/cim/effects/EffectArrow":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],
function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectArrow=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,b,c)};a.instance=null;return a}();a.EffectArrow=m;var h=function(a){function d(b,c,d){b=a.call(this,b,!1,!0)||this;b._curveHelper=new k.CurveHelper;b._width=(void 0!==c.width?c.width:5)*d;b._arrowType=void 0!==c.geometricEffectArrowType?c.geometricEffectArrowType:
"OpenEnded";b._offsetFlattenError=k.PIXEL_TOLERANCE*d;return b}b.__extends(d,a);d.prototype.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case "Block":return this._constructSimpleArrow(a,!1);case "Crossed":return this._constructCrossedArrow(a)}};d.prototype._constructSimpleArrow=function(a,c){var b=this._curveHelper.calculatePathLength(a),d=this._width;b<2*d&&(d=b/2);b=this._curveHelper.getSubCurve(a,0,b-d);if(!b)return null;var f=d/2;if(this._curveHelper.isEmpty(b,
!1))return null;d=this._constructOffset(b,-f);if(!d)return null;b=this._constructOffset(b,f);if(!b)return null;var g=this._constructArrowBasePoint(d,-f/2);if(!g)return null;f=this._constructArrowBasePoint(b,f/2);if(!f)return null;a=a[a.length-1];c||(this._makeControlPoint(b,!0),this._makeControlPoint(d,!0));var h=new k.PathHelper;h.addPath(b,!0);h.lineTo(f);this._makeControlPoint(h.path());h.lineTo(a);this._makeControlPoint(h.path());h.lineTo(g);this._makeControlPoint(h.path());h.addPath(d,!1);return c?
{paths:[h.path()]}:(h.close(),{rings:[h.path()]})};d.prototype._constructCrossedArrow=function(a){var c=this._curveHelper.calculatePathLength(a),b=this._width;c<3.732050807568877*b&&(b=c/3.732050807568877);var d=this._curveHelper.getSubCurve(a,0,c-2.732050807568877*b);if(!d)return null;var f=b/2;if(this._curveHelper.isEmpty(d,!1))return null;var g=this._constructOffset(d,f);if(!g)return null;d=this._constructOffset(d,-f);if(!d)return null;c=this._curveHelper.getSubCurve(a,0,c-b);if(!c||this._curveHelper.isEmpty(c,
!1))return null;b=this._constructOffset(c,f);if(!b)return null;var h=this._constructOffset(c,-f);if(!h)return null;c=b[b.length-1];b=this._constructArrowBasePoint(b,f/2);if(!b)return null;var l=h[h.length-1],f=this._constructArrowBasePoint(h,-f/2);if(!f)return null;a=a[a.length-1];this._makeControlPoint(g,!1);this._makeControlPoint(d,!1);h=new k.PathHelper;h.addPath(g,!0);this._makeControlPoint(h.path());h.lineTo(l);h.lineTo(f);this._makeControlPoint(h.path());h.lineTo(a);this._makeControlPoint(h.path());
h.lineTo(b);this._makeControlPoint(h.path());h.lineTo(c);this._makeControlPoint(h.path());h.addPath(d,!1);return{paths:[h.path()]}};d.prototype._constructOffset=function(a,c){return this._curveHelper.offset(a,c,"Rounded",4,this._offsetFlattenError)};d.prototype._constructArrowBasePoint=function(a,c){if(!a||2>a.length)return null;var b=a[a.length-2];a=a[a.length-1];b=[a[0]-b[0],a[1]-b[1]];this._curveHelper.normalize(b);return[a[0]+b[1]*c,a[1]-b[0]*c]};d.prototype._makeControlPoint=function(a,c){void 0===
c&&(c=!1);c?l.setId(a[0],1):l.setId(a[a.length-1],1)};return d}(l.PathGeometryCursor)})},"esri/symbols/cim/CurveHelper":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.CurveHelper=a.PathHelper=a.PIXEL_TOLERANCE=void 0;a.PIXEL_TOLERANCE=.03;m=function(){function a(){this._path=[]}a.prototype.path=function(){return this._path};a.prototype.addPath=function(a,b){b||a.reverse();Array.prototype.push.apply(this._path,a);b||a.reverse()};a.mergePath=
function(a,b){b&&Array.prototype.push.apply(a,b)};a.prototype.startPath=function(a){this._path.push(a)};a.prototype.lineTo=function(a){this._path.push(a)};a.prototype.close=function(){var a=this._path;1<a.length&&(a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]||a.push([a[0][0],a[0][1]]))};return a}();a.PathHelper=m;m=function(){function a(a,b){void 0===a&&(a=0);void 0===b&&(b=!1)}a.prototype.normalize=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);a[0]/=b;a[1]/=b};a.prototype.calculateLength=
function(a,b){var h=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(h*h+a*a)};a.prototype.calculateSegLength=function(a,b){return this.calculateLength(a[b],a[b+1])};a.prototype.calculatePathLength=function(a){for(var b=0,h=a?a.length:0,g=0;g<h-1;++g)b+=this.calculateSegLength(a,g);return b};a.prototype.calculatePathArea=function(a){for(var b=0,h=a?a.length:0,g=0;g<h-1;++g)b+=(a[g+1][0]-a[g][0])*(a[g+1][1]+a[g][1]);return b/2};a.prototype.getCoord2D=function(a,b,h){return[a[0]+(b[0]-a[0])*h,a[1]+(b[1]-a[1])*
h]};a.prototype.getSegCoord2D=function(a,b,h){return this.getCoord2D(a[b],a[b+1],h)};a.prototype.getAngle=function(a,b,h){return Math.atan2(b[1]-a[1],b[0]-a[0])};a.prototype.getSegAngle=function(a,b,h){return this.getAngle(a[b],a[b+1],h)};a.prototype.getAngleCS=function(a,b,h){h=b[0]-a[0];a=b[1]-a[1];b=Math.sqrt(h*h+a*a);return 0<b?[h/b,a/b]:[1,0]};a.prototype.getSegAngleCS=function(a,b,h){return this.getAngleCS(a[b],a[b+1],h)};a.prototype.cut=function(a,b,h,g){h=0>=h?a[b]:this.getSegCoord2D(a,b,
h);a=1<=g?a[b+1]:this.getSegCoord2D(a,b,g);return[h,a]};a.prototype.addSegment=function(a,b,h){h&&a.push(b[0]);a.push(b[1])};a.prototype.getSubCurve=function(a,b,h){var g=[];return this.appendSubCurve(g,a,b,h)?g:null};a.prototype.appendSubCurve=function(a,b,h,g){for(var d=b?b.length-1:0,f=0,c=!0,e=0;e<d;){var k=this.calculateSegLength(b,e);if(0!==k){if(c){if(f+k>h){var l=(h-f)/k,m=1,p=!1;f+k>=g&&(m=(g-f)/k,p=!0);(l=this.cut(b,e,l,m))&&this.addSegment(a,l,c);if(p)break;c=!1}}else{if(f+k>g){(l=this.cut(b,
e,0,(g-f)/k))&&this.addSegment(a,l,c);break}this.addSegment(a,[b[e],b[e+1]],c)}f+=k}++e}return!0};a.prototype.getCIMPointAlong=function(a,b){for(var h=a?a.length-1:0,g=0,d=-1;d<h;){++d;var f=this.calculateSegLength(a,d);if(0!==f){if(g+f>b)return this.getCoord2D(a[d],a[d+1],(b-g)/f);g+=f}}return null};a.prototype.isEmpty=function(a,b){if(!a||1>=a.length)return!0;for(var h=a?a.length-1:0,g=-1;g<h;)if(++g,a[g+1][0]!==a[g][0]||a[g+1][1]!==a[g][1]||b&&a[g+1][2]!==a[g][2])return!1;return!0};a.prototype.offset=
function(a,b,h,g,d){d;if(!a||2>a.length)return null;d=a.length;var f=a[0][0]===a[d-1][0]&&a[0][1]===a[d-1][1];if(f){if(3>a.length)return null;--d}for(var c=[],e=f?a[d-1]:null,k=a[0],l=0;l<d;l++){var m=l===d-1?f?a[0]:null:a[l+1];if(e)if(m){var p=[m[0]-k[0],m[1]-k[1]];this.normalize(p);e=[k[0]-e[0],k[1]-e[1]];this.normalize(e);var q=e[0]*p[1]-e[1]*p[0],u=e[0]*p[0]+e[1]*p[1];if(0<=q===0>=b)q=[p[0]-e[0],p[1]-e[1]],this.normalize(q),u=Math.sqrt((1+u)/2),p=-Math.abs(b)/u,c.push([k[0]-q[0]*p,k[1]-q[1]*p]);
else switch(h){case "Mitered":if(u=Math.sqrt((1+u)/2),0<u&&1/u<g){q=[p[0]-e[0],p[1]-e[1]];this.normalize(q);p=Math.abs(b)/u;c.push([k[0]-q[0]*p,k[1]-q[1]*p]);break}case "Bevelled":c.push([k[0]+e[1]*b,k[1]-e[0]*b]);c.push([k[0]+p[1]*b,k[1]-p[0]*b]);break;case "Rounded":c.push([k[0]+e[1]*b,k[1]-e[0]*b]);for(var u=.2,y=1;5>y;y++,u+=.2)q=[e[1]*(1-u)+p[1]*u,-e[0]*(1-u)-p[0]*u],this.normalize(q),c.push([k[0]+q[0]*b,k[1]+q[1]*b]);c.push([k[0]+p[1]*b,k[1]-p[0]*b]);break;default:0>q?(c.push([k[0]+(e[1]+e[0])*
b,k[1]+(e[1]-e[0])*b]),c.push([k[0]+(p[1]-p[0])*b,k[1]-(p[0]+p[1])*b])):(u=Math.sqrt((1+Math.abs(u))/2),q=[p[0]-e[0],p[1]-e[1]],this.normalize(q),p=b/u,c.push([k[0]-q[0]*p,k[1]-q[1]*p]))}}else q=[k[0]-e[0],k[1]-e[1]],this.normalize(q),c.push([k[0]+q[1]*b,k[1]-q[0]*b]);else q=[m[0]-k[0],m[1]-k[1]],this.normalize(q),c.push([k[0]+q[1]*b,k[1]-q[0]*b]);e=k;k=m}f&&c.push([c[0][0],c[0][1]]);return c};return a}();a.CurveHelper=m})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["require","exports",
"../../../geometry/support/jsonUtils","../CurveHelper"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.EffectBuffer=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,f){return new k(a,b,f)};a.instance=null;return a}();a.EffectBuffer=m;var k=function(){function a(a,b,f){this._inputGeometries=a;this._curveHelper=new l.CurveHelper;this._size=(void 0!==b.size?b.size:1)*f;this._offsetFlattenError=
l.PIXEL_TOLERANCE*f}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(b.isExtent(a))if(0<this._size){var d=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(d=this._curveHelper.offset(d,this._size,"Rounded",4,this._offsetFlattenError))return{rings:[d]}}else if(0>this._size){if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._size)return{xmin:a.xmin-this._size,xmax:a.xmax+this._size,ymin:a.ymin-this._size,ymax:a.ymax+this._size}}else return a;
if(b.isPolygon(a)){if(0===this._size)return a;for(var f=[],c=0,e=a.rings;c<e.length;c++)d=e[c],(d=this._curveHelper.offset(d,this._size,"Rounded",4,this._offsetFlattenError))&&f.push(d);if(f.length)return{rings:f}}if(b.isPolyline(a)&&0<this._size){f=[];c=0;for(e=a.paths;c<e.length;c++){var h=e[c];if(h&&1<h.length&&(d=this._curveHelper.offset(h,this._size,"Rounded",4,this._offsetFlattenError),h=this._curveHelper.offset(h,-this._size,"Rounded",4,this._offsetFlattenError),d&&h)){for(var k=h.length-1;0<=
k;k--)d.push(h[k]);d.push([d[0][0],d[0][1]]);f.push(d)}}if(f.length)return{rings:f}}b.isPoint(a);a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectCut":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectCut=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,
b,c)};a.instance=null;return a}();a.EffectCut=m;var h=function(a){function d(b,c,d){b=a.call(this,b,!0,!0)||this;b._curveHelper=new k.CurveHelper;b._beginCut=(void 0!==c.beginCut?c.beginCut:1)*d;b._endCut=(void 0!==c.endCut?c.endCut:1)*d;b._middleCut=(void 0!==c.middleCut?c.middleCut:0)*d;b._invert=void 0!==c.invert?c.invert:!1;0>b._beginCut&&(b._beginCut=0);0>b._endCut&&(b._endCut=0);0>b._middleCut&&(b._middleCut=0);return b}b.__extends(d,a);d.prototype.processPath=function(a){var c=this._beginCut,
b=this._endCut,d=this._middleCut,f=this._curveHelper.calculatePathLength(a),g=[];if(!this._invert)0===c&&0===b&&0===d?g.push(a):c+b+d>=f||(0===d?c=this._curveHelper.getSubCurve(a,c,f-b):((c=this._curveHelper.getSubCurve(a,c,.5*(f-d)))&&g.push(c),c=this._curveHelper.getSubCurve(a,.5*(f+d),f-b)),c&&g.push(c));else if(0!==c||0!==b||0!==d)c+b+d>=f?g.push(a):((c=this._curveHelper.getSubCurve(a,0,c))&&g.push(c),(c=this._curveHelper.getSubCurve(a,.5*(f-d),.5*(f+d)))&&g.push(c),(c=this._curveHelper.getSubCurve(a,
f-b,b))&&g.push(c));return 0===g.length?null:{paths:g}};return d}(l.PathGeometryCursor)})},"esri/symbols/cim/effects/EffectDashes":function(){define("require exports tslib ../CIMCursor ../CurveHelper ../GeometryWalker".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectDashes=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,b){return new g(a,c,b)};a.instance=null;return a}();
a.EffectDashes=m;var g=function(a){function d(c,b,d){c=a.call(this,c,!0,!0)||this;c._walker=new h.GeometryWalker;c._walker.updateTolerance(d);c._endings=b.lineDashEnding;c._customDashPos=void 0!==b.offsetAlongLine?b.offsetAlongLine*d:0;c._offsetAtEnd=void 0!==b.customEndingOffset?b.customEndingOffset*d:0;c._pattern=new h.DashPattern;c._pattern.init(b.dashTemplate,!0);c._pattern.scale(d);return c}b.__extends(d,a);d.prototype.processPath=function(a){if(0===this._pattern.length())return this.iteratePath=
!1,{paths:[a]};if(!this.iteratePath){var c=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||(c=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var b=this._walker.calculatePathLength(a);if(this._pattern.isEmpty()||b<.1*this._pattern.length()||
!this._walker.init(a,this._pattern,c))return{paths:[a]}}if(this.iteratePath)a=this._pattern.nextValue();else{c=void 0;switch(this._endings){default:c=.5*this._pattern.firstValue();break;case "HalfGap":c=.5*-this._pattern.lastValue();break;case "FullGap":c=-this._pattern.lastValue();break;case "FullPattern":c=0;break;case "NoConstraint":case "Custom":c=-this._customDashPos}a=c/this._pattern.length();a-=Math.floor(a);c=a*this._pattern.length();this._pattern.reset();a=this._pattern.nextValue();for(b=
!1;c>=a;)c-=a,a=this._pattern.nextValue(),b=!b;a-=c;b?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),this._walker.nextPosition(a),a=this._pattern.nextValue())}(c=this._walker.nextCurve(a))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),k.PathHelper.mergePath(c,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||
this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(c=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,c=this._firstCurve,this._firstCurve=null);return{paths:[c]}};return d}(l.PathGeometryCursor)})},"esri/symbols/cim/GeometryWalker":function(){define(["require","exports","tslib","./CIMCursor","./CurveHelper"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.GeometryWalker=a.DashPattern=void 0;m=function(){function a(){this._values=
[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}a.prototype.isEmpty=function(){return 0===this._values.length};a.prototype.size=function(){return this._values.length};a.prototype.init=function(a,b,c){void 0===c&&(c=!0);this._setEmpty();if(!a||0===a.length)return!1;for(var d=0;d<a.length;d++){var f=Math.abs(a[d]);c&&1E-7>f&&(f=1E-7);this._values.push(f);this._length+=f}b&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=
-1;return!0};a.prototype.scale=function(a){for(var b=this._values?this._values.length:0,c=0;c<b;++c)this._values[c]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};a.prototype.addValue=function(a){this._length+=a;this._values.push(a)};a.prototype.firstValue=function(){return this._values[0]};a.prototype.lastValue=function(){return this._values[this._values.length-1]};a.prototype.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};
a.prototype.reset=function(){this._currentValue=-1};a.prototype.length=function(){return this._length};a.prototype._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return a}();a.DashPattern=m;var h=function(){function a(){this.reset()}a.prototype.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};a.prototype.isValid=function(){return-1!==this.segment};a.prototype.copyTo=function(a){a.segment=
this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return a}();m=function(a){function d(b,c){void 0===b&&(b=0);void 0===c&&(c=!1);b=a.call(this,b,c)||this;b._tolerance=k.PIXEL_TOLERANCE;b._currentPosition=new h;return b}b.__extends(d,a);d.prototype.updateTolerance=function(a){this._tolerance=k.PIXEL_TOLERANCE*a};d.prototype.init=function(a,c,b){void 0===b&&(b=!0);b?(this._patternLength=c.length(),this._partExtPtGap=c.extPtGap,
this._partCtrlPtGap=c.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=a;this._seg=-1;return this.setPosAtNextPart()};d.prototype.curPositionIsValid=function(){return this._currentPosition.isValid()};d.prototype.nextPosition=function(a,c){void 0===c&&(c=0);var b=new h;if(!this._nextPosition(a,b,null,c))return!1;b.copyTo(this._currentPosition);return!0};d.prototype.curPointAndAngle=function(a){a.pt=this._getPoint(this._currentPosition);
var c=this._getAngle(this._currentPosition),b=c[1];a.ca=c[0];a.sa=b};d.prototype.nextPointAndAngle=function(a,c,b){void 0===b&&(b=0);var d=new h;if(!this._nextPosition(a,d,null,b))return!1;d.copyTo(this._currentPosition);c.pt=this._getPoint(d);a=this._getAngle(d);b=a[1];c.ca=a[0];c.sa=b;return!0};d.prototype.nextCurve=function(a){if(0===a)return null;var c=[],b=new h;if(!this._nextPosition(a,b,c,1))return null;b.copyTo(this._currentPosition);return c};d.prototype.isPathEnd=function(){return this._currentPosition.isPathEnd};
d.prototype.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};d.prototype._nextPosition=function(a,c,b,d){if(this._currentPosition.isPathEnd)return!1;var e=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(e/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(c);c.abscissa+a*this._partLengthRatio>c.segmentLength+this._tolerance;)if(b&&(0===b.length&&(0===e?(e=this._path[c.segment],
b.push([e[0],e[1]])):b.push(this.getSegCoord2D(this._path,c.segment,e))),e=this._path[c.segment+1],b.push([e[0],e[1]])),e=0,a-=(c.segmentLength-c.abscissa)/this._partLengthRatio,this._partSegCount)c.segment=this.nextSegment(),c.segmentLength=this.calculateSegLength(this._path,c.segment),c.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===d)return!1;c.segmentLength=this.calculateSegLength(this._path,c.segment);c.isPartEnd=!0;1===d?(c.abscissa=c.segmentLength,c.isPathEnd=!0):
c.abscissa=c.segmentLength+a;return!0}this._currentPosition.copyTo(c)}c.abscissa+=a*this._partLengthRatio;b&&(0===b.length&&(0===e?(e=this._path[c.segment],b.push([e[0],e[1]])):b.push(this.getSegCoord2D(this._path,c.segment,e))),a=c.abscissa/c.segmentLength,1===a?(e=this._path[c.segment+1],b.push([e[0],e[1]])):b.push(this.getSegCoord2D(this._path,c.segment,a)));!this._partSegCount&&Math.abs(c.abscissa-c.segmentLength)<this._tolerance&&(c.isPathEnd=this._partIsLast,c.isPartEnd=!0);return!0};d.prototype._getPoint=
function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};d.prototype._getAngle=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};d.prototype.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;
this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===l.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var a=this._partSegCount;a;)this.previousSegment(),--a;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=
0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;a=this.getStartPointIndex();this._ctrlPtBegin=1===l.getId(this._path[a]);a=a+this._partSegCount+1;a>=this._path.length&&(a=0);this._ctrlPtEnd=1===l.getId(this._path[a]);if(0<this._patternLength){var a=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,c=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap,b=Math.round((this._partLength-(a+c))/this._patternLength);0>=b&&(b=0<a+c?0:1);this._partLengthRatio=
this._partLength/(a+c+b*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};d.prototype.hasNextSegment=function(){return this._seg<this._path.length-2};d.prototype.previousSegment=function(){return--this._seg};d.prototype.nextSegment=function(){return++this._seg};d.prototype.getStartPointIndex=function(){return this._seg};d.prototype.getEndPointIndex=function(){return this._seg+1};return d}(k.CurveHelper);a.GeometryWalker=m})},"esri/symbols/cim/effects/EffectDonut":function(){define(["require",
"exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.EffectDonut=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,f){return new k(a,b,f)};a.instance=null;return a}();a.EffectDonut=m;var k=function(){function a(a,b,f){this._inputGeometries=a;this._curveHelper=new l.CurveHelper;this._width=(void 0!==b.width?b.width:2)*f;switch(b.method){default:this._method=
"Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";break;case "Square":this._method="Square"}this._option=b.option;this._offsetFlattenError=l.PIXEL_TOLERANCE*f;this._option}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(b.isExtent(a)&&0<this._width){if(0>Math.min(a.xmax-a.xmin,a.ymax-a.ymin)-2*this._width)return a;var d=[];d.push([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]);
d.push([[a.xmin+this._width,a.ymin+this._width],[a.xmax-this._width,a.ymin+this._width],[a.xmax-this._width,a.ymax-this._width],[a.xmin+this._width,a.ymax-this._width],[a.xmin+this._width,a.ymin+this._width]]);return{rings:d}}if(b.isPolygon(a)&&0<this._width){for(var f=[],d=[],c=0,a=a.rings;c<a.length;c++){var e=a[c],h=this._curveHelper.calculatePathLength(e);0<h&&f.push(e);var k=this._curveHelper.offset(e,this._width,this._method,4,this._offsetFlattenError);k&&(0>h&&k.reverse(),d.push(k));0>h&&f.push(e)}if(d.length)return{rings:d}}a=
this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectJog":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectJog=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,b,c)};a.instance=null;return a}();a.EffectJog=m;var h=function(a){function d(b,c,d){b=
a.call(this,b,!1,!0)||this;b._curveHelper=new k.CurveHelper;b._length=(void 0!==c.length?c.length:20)*d;b._angle=void 0!==c.angle?c.angle:225;b._position=void 0!==c.position?c.position:50;0>b._length&&(b._length=-b._length);20>b._position&&(b._position=20);80<b._position&&(b._position=80);b._mirror=!1;return b}b.__extends(d,a);d.prototype.processPath=function(a){if(this._curveHelper.isEmpty(a,!1))return null;var c=a[0];a=a[a.length-1];this._curveHelper.normalize([a[0]-c[0],a[1]-c[1]]);var b=[c[0]+
(a[0]-c[0])*this._position/100,c[1]+(a[1]-c[1])*this._position/100],d=Math.cos((90-this._angle)/180*Math.PI),f=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(f=-f);this._mirror=!this._mirror;return{paths:[[c,[b[0]-this._length/2*d,b[1]-this._length/2*f],[b[0]+this._length/2*d,b[1]+this._length/2*f],a]]}};return d}(l.PathGeometryCursor)})},"esri/symbols/cim/effects/EffectMove":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(m,a,b,l){Object.defineProperty(a,
"__esModule",{value:!0});a.EffectMove=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,f){return new k(a,b,f)};a.instance=null;return a}();a.EffectMove=m;var k=function(){function a(a,b,f){this._inputGeometries=a;this._offsetX=void 0!==b.offsetX?b.offsetX*f:0;this._offsetY=void 0!==b.offsetY?-b.offsetY*f:0}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(l.isExtent(a))return{xmin:a.xmin+
this._offsetX,xmax:a.xmax+this._offsetX,ymin:a.ymin+this._offsetY,ymax:a.ymax+this._offsetY};if(l.isPolygon(a))return a=b.clone(a),this._moveMultipath(a.rings,this._offsetX,this._offsetY),a;if(l.isPolyline(a))return a=b.clone(a),this._moveMultipath(a.paths,this._offsetX,this._offsetY),a;if(l.isMultipoint(a))return a=b.clone(a),this._movePath(a.points,this._offsetX,this._offsetY),a;if(l.isPoint(a))return{x:a.x+this._offsetX,y:a.y+this._offsetY};a=this._inputGeometries.next()}return null};a.prototype._moveMultipath=
function(a,b,f){if(a)for(var c=0;c<a.length;c++)this._movePath(a[c],b,f)};a.prototype._movePath=function(a,b,f){if(a)for(var c=0;c<a.length;c++){var d=a[c];d[0]+=b;d[1]+=f}};return a}()})},"esri/symbols/cim/effects/EffectOffset":function(){define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.EffectOffset=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};
a.prototype.execute=function(a,b,f){return new k(a,b,f)};a.instance=null;return a}();a.EffectOffset=m;var k=function(){function a(a,b,f){this._inputGeometries=a;this._curveHelper=new l.CurveHelper;this._offset=(void 0!==b.offset?b.offset:1)*f;this._method=b.method;this._option=b.option;this._offsetFlattenError=l.PIXEL_TOLERANCE*f;this._option}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._offset)return a;if(b.isExtent(a)){if("Rounded"===this._method&&0<this._offset){var d=
[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];return(d=this._curveHelper.offset(d,this._offset,this._method,4,this._offsetFlattenError))?{rings:[d]}:null}if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._offset)return{xmin:a.xmin-this._offset,xmax:a.xmax+this._offset,ymin:a.ymin-this._offset,ymax:a.ymax+this._offset}}if(b.isPolygon(a)){for(var f=[],c=0,e=a.rings;c<e.length;c++)d=e[c],(d=this._curveHelper.offset(d,this._offset,this._method,4,this._offsetFlattenError))&&
f.push(d);if(f.length)return{rings:f}}if(b.isPolyline(a)){f=[];c=0;for(a=a.paths;c<a.length;c++)(e=this._curveHelper.offset(a[c],this._offset,this._method,4,this._offsetFlattenError))&&f.push(e);if(f.length)return{paths:f}}a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectReverse":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});
a.EffectReverse=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,b,c)};a.instance=null;return a}();a.EffectReverse=m;var h=function(){function a(a,b,c){this._inputGeometries=a;this._reverse=void 0!==b.reverse?b.reverse:!0;c}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(!this._reverse)return a;if(l.isPolyline(a))return a=b.clone(a),k.reverseMultipath(a.paths),
a;a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectRotate":function(){define("require exports ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectRotate=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,
c,b){return new g(a,c,b)};a.instance=null;return a}();a.EffectRotate=m;var g=function(){function a(a,c,b){this._inputGeometries=a;this._rotateAngle=void 0!==c.angle?-c.angle*Math.PI/180:0;b}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var c=l.create();k.getBoundsXY(c,a);var d=(c[2]+c[0])/2,c=(c[3]+c[1])/2;if(h.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,
d,c),a;if(h.isPolygon(a))return a=b.clone(a),this._rotateMultipath(a.rings,d,c),a;if(h.isPolyline(a))return a=b.clone(a),this._rotateMultipath(a.paths,d,c),a;if(h.isMultipoint(a))return a=b.clone(a),this._rotatePath(a.points,d,c),a;if(h.isPoint(a))return a;a=this._inputGeometries.next()}return null};a.prototype._rotateMultipath=function(a,c,b){if(a)for(var d=0;d<a.length;d++)this._rotatePath(a[d],c,b)};a.prototype._rotatePath=function(a,c,b){if(a)for(var d=Math.cos(this._rotateAngle),e=Math.sin(this._rotateAngle),
f=0;f<a.length;f++){var g=a[f],h=g[0]-c,k=g[1]-b;g[0]=c+h*d-k*e;g[1]=b+h*e+k*d}};return a}()})},"esri/symbols/cim/effects/EffectScale":function(){define("require exports ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectScale=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};
a.prototype.execute=function(a,c,b){return new g(a,c,b)};a.instance=null;return a}();a.EffectScale=m;var g=function(){function a(a,c,b){this._inputGeometries=a;this._xFactor=void 0!==c.xScaleFactor?c.xScaleFactor:1.15;this._yFactor=void 0!==c.yScaleFactor?c.yScaleFactor:1.15;b}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var c=l.create();k.getBoundsXY(c,a);var d=(c[2]+c[0])/2,c=(c[3]+c[1])/2;if(h.isExtent(a))return a={rings:[[[a.xmin,
a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,d,c),a;if(h.isPolygon(a))return a=b.clone(a),this._scaleMultipath(a.rings,d,c),a;if(h.isPolyline(a))return a=b.clone(a),this._scaleMultipath(a.paths,d,c),a;if(h.isMultipoint(a))return a=b.clone(a),this._scalePath(a.points,d,c),a;if(h.isPoint(a))return a;a=this._inputGeometries.next()}return null};a.prototype._scaleMultipath=function(a,c,b){if(a)for(var d=0;d<a.length;d++)this._scalePath(a[d],c,
b)};a.prototype._scalePath=function(a,c,b){if(a)for(var d=0;d<a.length;d++){var e=a[d],f=(e[1]-b)*this._yFactor;e[0]=c+(e[0]-c)*this._xFactor;e[1]=b+f}};return a}()})},"esri/symbols/cim/effects/EffectWave":function(){define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectWave=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};
a.prototype.execute=function(a,b,c){return new h(a,b,c)};a.instance=null;return a}();a.EffectWave=m;var h=function(){function a(a,b,c){this._inputGeometries=a;this._height=(void 0!==b.amplitude?b.amplitude:2)*c;this._period=(void 0!==b.period?b.period:3)*c;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new k.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=
new k.GeometryWalker;this._walker.updateTolerance(c)}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period)return a;if(b.isPolyline(a)){var f=this._processGeom(a.paths);if(f.length)return{paths:f}}if(b.isPolygon(a)&&(a=this._processGeom(a.rings),a.length))return{rings:a};a=this._inputGeometries.next()}return null};a.prototype._processGeom=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(this._walker.init(d,this._pattern))switch(this._style){default:b.push(this._constructCurve(d,
!1));break;case "Square":b.push(this._constructSquare(d));break;case "Triangle":b.push(this._constructTriangle(d));break;case "Random":b.push(this._constructCurve(d,!0))}else b.push(d)}return b};a.prototype._constructCurve=function(a,b){var c=new l.PathHelper,d=this._walker.calculatePathLength(a),f=Math.round(d/this._period);0===f&&(f=1);var g=this._period/16,h=1/(16*f+1),d=2*Math.PI*d/(d/f),f=2*Math.PI*Math.random(),k=2*Math.PI*Math.random(),m=2*Math.PI*Math.random(),u=.75-Math.random()/2,y=.75-
Math.random()/2,w={};this._walker.curPointAndAngle(w);c.startPath(w.pt);for(var B=0;;)if(this._walker.nextPointAndAngle(g,w)){var z=B,B=B+h,A=void 0;if(b)var C=this._height/2*(1+.3*Math.sin(u*d*z+f)),A=C*Math.sin(d*z+k),A=A+C*Math.sin(y*d*z+m),A=A/2;else A=.5*this._height*Math.sin(.5*d*z);c.lineTo([w.pt[0]-A*w.sa,w.pt[1]+A*w.ca])}else{c.lineTo(a[a.length-1]);break}return c.path()};a.prototype._constructSquare=function(a){var b=new l.PathHelper;a=this._walker.calculatePathLength(a);a=Math.round(a/
this._period);0===a&&(a=1);for(a=!0;;){var c=!1;if(this._walker.curPositionIsValid()){var d={};this._walker.curPointAndAngle(d);var g={};if(this._walker.nextPointAndAngle(this._period,g)){var h={};this._walker.nextPointAndAngle(this._period,h)&&(a?(b.startPath(d.pt),a=!1):b.lineTo(d.pt),b.lineTo([d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca]),b.lineTo([g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca]),b.lineTo([g.pt[0]+this._height/2*g.sa,g.pt[1]-this._height/2*g.ca]),b.lineTo([h.pt[0]+
this._height/2*h.sa,h.pt[1]-this._height/2*h.ca]),c=!0)}}if(!c){b.lineTo(this._walker.getPathEnd());break}}return b.path()};a.prototype._constructTriangle=function(a){var b=new l.PathHelper;a=this._walker.calculatePathLength(a);a=Math.round(a/this._period);0===a&&(a=1);for(a=!0;;){var c=!1;if(this._walker.curPositionIsValid()){var d={};this._walker.curPointAndAngle(d);var g={};if(this._walker.nextPointAndAngle(this._period/2,g)){var h={};this._walker.nextPointAndAngle(this._period,h)&&(this._walker.nextPosition(this._period/
2)&&(a?(b.startPath(d.pt),a=!1):b.lineTo(d.pt),b.lineTo([g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca]),b.lineTo([h.pt[0]+this._height/2*h.sa,h.pt[1]-this._height/2*h.ca])),c=!0)}}if(!c){b.lineTo(this._walker.getPathEnd());break}}return b.path()};return a}()})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define("require exports tslib ../CIMCursor ../enums ../GeometryWalker".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementAlongLineSameSize=
void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,b){return new g(a,c,b)};a.instance=null;return a}();a.PlacementAlongLineSameSize=m;var g=function(a){function d(c,b,d){c=a.call(this,c,!0,!0)||this;c._grometryWalker=new h.GeometryWalker;c._grometryWalker.updateTolerance(d);c._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;c._offset=void 0!==b.offset?b.offset*d:0;c._originalEndings=b.endings;c._offsetAtEnd=
void 0!==b.customEndingOffset?b.customEndingOffset*d:0;c._position=void 0!==b.offsetAlongLine?b.offsetAlongLine*d:0;c._pattern=new h.DashPattern;c._pattern.init(b.placementTemplate,!1);c._pattern.scale(d);c._endings=c._originalEndings;return c}b.__extends(d,a);d.prototype.processPath=function(a){if(this._pattern.isEmpty())return null;var c;if(this.iteratePath)c=this._pattern.nextValue();else{this._endings=this._originalEndings===k.PlacementEndings.WithFullGap&&this.isClosed?k.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;var b=!0;c=void 0;switch(this._endings){case k.PlacementEndings.NoConstraint:c=-this._position;c=this._adjustPosition(c);b=!1;break;default:c=-this._pattern.lastValue()/2;break;case k.PlacementEndings.WithFullGap:c=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case k.PlacementEndings.WithMarkers:c=0;break;case k.PlacementEndings.Custom:c=-this._position,c=this._adjustPosition(c),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(a,
this._pattern,b))return null;this._pattern.reset();for(a=0;c>a;)c-=a,a=this._pattern.nextValue();c=a-c;this.iteratePath=!0}a={};if(!this._grometryWalker.nextPointAndAngle(c,a)||this._endings===k.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===k.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(a.pt[0]+this._offset*a.sa,a.pt[1]-this._offset*
a.ca);this._angleToLine&&this.internalPlacement.setRotateCS(a.ca,a.sa);return this.internalPlacement};d.prototype._adjustPosition=function(a){a/=this._pattern.length();a-=Math.floor(a);return a*this._pattern.length()};return d}(l.PathTransformationCursor)})},"esri/symbols/cim/enums":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementEndings=void 0;m=a.PlacementEndings||(a.PlacementEndings={});m.NoConstraint="NoConstraint";m.WithMarkers=
"WithMarkers";m.WithFullGap="WithFullGap";m.WithHalfGap="WithHalfGap";m.Custom="Custom"})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementAtExtremities=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,b,c)};a.instance=null;
return a}();a.PlacementAtExtremities=m;var h=function(a){function d(b,c,d){b=a.call(this,b,!1,!0)||this;b._curveHelper=new k.CurveHelper;b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*d:0;b._type=c.extremityPlacement;b._position=void 0!==c.offsetAlongLine?c.offsetAlongLine*d:0;b._beginProcessed=!1;return b}b.__extends(d,a);d.prototype.processPath=function(a){var c;switch(this._type){default:this._beginProcessed?(c=this._atExtremities(a,this._position,!1),
this.iteratePath=this._beginProcessed=!1):(c=this._atExtremities(a,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":c=this._atExtremities(a,this._position,!0);break;case "JustEnd":c=this._atExtremities(a,this._position,!1);case "None":}return c};d.prototype._atExtremities=function(a,c,b){var d=a.length;if(2>d)return null;for(var e=b?d:-1,f=b?1:-1,g=0,h=b?a[0]:a[d-1],d=b?1:d-2;d!==e;d+=f){b=h;var h=a[d],k=this._curveHelper.calculateLength(b,h);if(g+k>c)return c=(c-
g)/k,e=this._curveHelper.getAngleCS(b,h,c),a=e[0],e=e[1],h=l.getCoord2D(b,h,c),this.internalPlacement.setTranslate(h[0]-this._offset*e,h[1]+this._offset*a),this._angleToLine&&this.internalPlacement.setRotateCS(-a,-e),this.internalPlacement;g+=k}return null};return d}(l.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["require","exports","tslib","../CIMCursor","../GeometryWalker"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});
a.PlacementAtRatioPositions=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,b,c)};a.instance=null;return a}();a.PlacementAtRatioPositions=m;var h=function(a){function d(b,c,d){b=a.call(this,b,!0,!0)||this;b._walker=new k.GeometryWalker;b._walker.updateTolerance(d);b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*d:0;b._beginGap=void 0!==c.beginPosition?
c.beginPosition*d:0;b._endGap=void 0!==c.endPosition?c.endPosition*d:0;b._flipFirst=void 0!==c.flipFirst?c.flipFirst:!0;b._pattern=new k.DashPattern;b._pattern.init(c.positionArray,!1,!1);b._subPathLen=0;b._posCount=b._pattern.size();b._isFirst=!0;b._prevPos=0;return b}b.__extends(d,a);d.prototype.processPath=function(a){if(this._pattern.isEmpty())return null;var c;if(this.iteratePath)a=this._pattern.nextValue()*this._subPathLen,a=this._beginGap+a,c=a-this._prevPos,this._prevPos=a;else{this._posCount=
this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(a)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(a,this._pattern,!1))return null;this._pattern.reset();a=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+a;c=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(c,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]+
this._offset*a.sa,a.pt[1]-this._offset*a.ca);c=this._isFirst&&this._flipFirst;var b;this._angleToLine?(b=a.ca,a=a.sa):(b=1,a=0);c&&(b=-b,a=-a);this.internalPlacement.setRotateCS(b,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return d}(l.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["require","exports","../CIMPlacements"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});
a.PlacementInsidePolygon=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,d){return new l(a,b,d)};a.instance=null;return a}();a.PlacementInsidePolygon=m;var l=function(){function a(a,g,d){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==g.stepX?Math.abs(g.stepX):16)*d;this._stepY=(void 0!==g.stepY?Math.abs(g.stepY):16)*d;if(0!==this._stepX&&0!==this._stepY&&
a&&void 0!==a.rings&&a.rings){this._gridType=void 0!==g.gridType?g.gridType:"Fixed";if("Random"===this._gridType)this._randomness=void 0!==g.randomness?g.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==g.gridAngle?g.gridAngle:0;this._shiftOddRows=void 0!==g.shiftOddRows?g.shiftOddRows:!1;this._offsetX=void 0!==g.offsetX?g.offsetX*d:0;this._offsetY=void 0!==g.offsetY?g.offsetY*d:
0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=
new b.Placement;this._calculateMinMax(a);this._geometry=a}}a.prototype.next=function(){return this._geometry?this._nextInside():null};a.prototype._calculateMinMax=function(a){this._yMax=this._yMin=this._xMax=this._xMin=0;var b,d,f,c,e,h;f=c=Number.MAX_VALUE;e=h=-Number.MAX_VALUE;for(var k=0,l=a.rings;k<l.length;k++)for(var m=l[k],q=m?m.length:0,u=0;u<q;++u)b=m[u][0]-this._graphicOriginX-this._offsetX,d=m[u][1]-this._graphicOriginY-this._offsetY,a=this._cosAngle*b-this._sinAngle*d,b=this._sinAngle*
b+this._cosAngle*d,f=Math.min(f,a),e=Math.max(e,a),c=Math.min(c,b),h=Math.max(h,b);f+=this._graphicOriginX;e+=this._graphicOriginX;c+=this._graphicOriginY;h+=this._graphicOriginY;this._xMin=Math.round(f/this._stepX);this._xMax=Math.round(e/this._stepX);this._yMin=Math.round(c/this._stepY);this._yMax=Math.round(h/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};a.prototype._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;
this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var a=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(a+=.5*this._stepX);var b=this._currentY*this._stepY+this._offsetY;this._currentX++;var d=void 0,f=void 0;"Random"===this._gridType?(d=this._graphicOriginX+a+this._stepX*this._randomness*(.5-Math.random())*2/3,f=this._graphicOriginY+b+this._stepY*this._randomness*(.5-Math.random())*2/3):(d=this._graphicOriginX+this._cosAngle*a+this._sinAngle*
b,f=this._graphicOriginY-this._sinAngle*a+this._cosAngle*b);this._internalPlacement.setTranslate(d,f);return this._internalPlacement}};return a}()})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementOnLine=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,
b,c){return new h(a,b,c)};a.instance=null;return a}();a.PlacementOnLine=m;var h=function(a){function d(b,c,d){b=a.call(this,b,!0,!0)||this;b._curveHelper=new k.CurveHelper;b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*d:0;b._relativeTo=c.relativeTo;b._position=void 0!==c.startPointOffset?c.startPointOffset*d:0;b._epsilon=.001*d;return b}b.__extends(d,a);d.prototype.processPath=function(a){var c=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||
(this._segmentCount=a.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var b=this._curSegment;this._curSegment++;var c=a[b-1],b=a[b],d=this._curveHelper.calculateLength(c,b);if(!(d<this._epsilon)){var d=.5+this._position/d,f=this._curveHelper.getAngleCS(c,b,d);a=f[0];f=f[1];c=l.getCoord2D(c,b,d);this.internalPlacement.setTranslate(c[0]-this._offset*f,c[1]+this._offset*a);this._angleToLine&&this.internalPlacement.setRotateCS(a,f);return this.internalPlacement}}this.iteratePath=
!1;return null}"LineEnd"===this._relativeTo&&l.reversePath(a);c=this.onLine(a,c);"LineEnd"===this._relativeTo&&l.reversePath(a);return c};d.prototype.onLine=function(a,c){var b,d=!1;switch(this._relativeTo){default:b=this._curveHelper.calculatePathLength(a)/2+c;break;case "LineBeginning":b=c;break;case "LineEnd":b=c,d=!0}for(var f=a.length,g=0,h=a[0],k=1;k<f;++k){c=h;var h=a[k],m=this._curveHelper.calculateLength(c,h);if(g+m>b)return f=(b-g)/m,b=this._curveHelper.getAngleCS(c,h,f),a=b[0],b=b[1],c=
l.getCoord2D(c,h,f),h=d?this._offset:-this._offset,this.internalPlacement.setTranslate(c[0]-h*b,c[1]+h*a),this._angleToLine&&(d?this.internalPlacement.setRotateCS(-a,-b):this.internalPlacement.setRotateCS(a,b)),this.internalPlacement;g+=m}return null};return d}(l.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(m,a,b,l,k){function h(a,b){for(var c=Math.PI;Math.abs(b-a)>c+2E-15;)b=
b-a>c?b-2*c:b+2*c;return(a+b)/2}Object.defineProperty(a,"__esModule",{value:!0});a.PlacementOnVertices=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,b){return new g(a,c,b)};a.instance=null;return a}();a.PlacementOnVertices=m;var g=function(a){function d(c,b,d){c=a.call(this,c,!0,!0)||this;c._curveHelper=new k.CurveHelper;c._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;c._offset=void 0!==b.offset?
b.offset*d:0;c._endPoints=void 0!==b.placeOnEndPoints?b.placeOnEndPoints:!0;c._controlPoints=void 0!==b.placeOnControlPoints?b.placeOnControlPoints:!0;c._regularVertices=void 0!==b.placeOnRegularVertices?b.placeOnRegularVertices:!0;c._tags=[];c._tagIterator=0;return c}b.__extends(d,a);d.prototype.processPath=function(a){this.iteratePath||(this._preparePath(a),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;a=this._tags[this._tagIterator];
this._angleToLine&&this.internalPlacement.setRotate(a[2]);var c=a[0],b=a[1];if(0!==this._offset)var d=Math.cos(a[2]),c=c-this._offset*Math.sin(a[2]),b=b+this._offset*d;this.internalPlacement.setTranslate(c,b);this._tagIterator++;return this.internalPlacement};d.prototype._preparePath=function(a){this._tagIterator=this._tags.length=0;for(var c=l.isClosedPath(a),b=a.length-1,d=0,f=0,g=0,k=0,m=0,y,w;d<b;){d++;y=a[d-1];w=a[d];var B=l.getId(y),z=l.getId(w);if(this._angleToLine||0!==this._offset)k=this._curveHelper.getAngle(y,
w,0);1===d?c?(f=k,g=B):this._endPoints&&this._tags.push([y[0],y[1],k]):1===B?this._controlPoints&&this._tags.push([y[0],y[1],h(m,k)]):this._regularVertices&&this._tags.push([y[0],y[1],h(m,k)]);if(this._angleToLine||0!==this._offset)m=this._curveHelper.getAngle(y,w,1);d===b&&(c?1===z||1===g?this._controlPoints&&this._tags.push([w[0],w[1],h(m,f)]):this._regularVertices&&this._tags.push([w[0],w[1],h(m,f)]):this._endPoints&&this._tags.push([w[0],w[1],m]))}this._tagIterator=0};return d}(l.PathTransformationCursor)})},
"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["require","exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementPolygonCenter=void 0;m=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new h(a,b,c)};a.instance=null;return a}();a.PlacementPolygonCenter=
m;var h=function(){function a(a,b,c){this._geometry=a;this._offsetX=void 0!==b.offsetX?b.offsetX*c:0;this._offsetY=void 0!==b.offsetY?b.offsetY*c:0;this._method=void 0!==b.method?b.method:"OnPolygon";this._internalPlacement=new k.Placement}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a&&void 0!==a.rings?this._polygonCenter(a):null};a.prototype._polygonCenter=function(a){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":var d=b.create();l.getBoundsXY(d,
a);this._internalPlacement.setTranslate((d[2]+d[0])/2+this._offsetX,(d[3]+d[1])/2-this._offsetY)}return this._internalPlacement};return a}()})},"esri/symbols/cim/Rect":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a,b,h,g){void 0===a&&(a=0);void 0===b&&(b=0);void 0===h&&(h=0);void 0===g&&(g=0);this.x=a;this.y=b;this.width=h;this.height=g}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||
0>=this.height},enumerable:!1,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=m})},"esri/symbols/cim/packingUtils":function(){define(["require","exports"],function(m,a){function b(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});a.packFloatRGBA=void 0;var l=[1,256,65536,16777216],k=[1/256,1/65536,1/16777216,1/4294967296],
h=function(a,b){void 0===b&&(b=0);for(var d=0,c=0;4>c;c++)d+=a[b+c]*k[c];return d}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,d,f){void 0===f&&(f=0);a=0>a?0:a>h?h:a;for(var c=0;4>c;c++)d[f+c]=Math.floor(256*b(a*l[c]))}})},"esri/symbols/cim/SDFHelper":function(){define(["require","exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(m,a,b,l,k){function h(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;
return h(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var b=a[0];if(!b)break;a=b.geometry;if(!a)break;b=b.symbol;if(!b||"CIMPolygonSymbol"!==b.type&&"CIMLineSymbol"!==b.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===b.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function g(a){for(var b=Infinity,c=-Infinity,d=Infinity,g=-Infinity,h=0;h<a.length;h++)for(var k=0,l=a[h];k<l.length;k++){var m=l[k];m[0]<b&&(b=m[0]);m[0]>c&&(c=m[0]);m[1]<d&&(d=m[1]);
m[1]>g&&(g=m[1])}return[b,d,c,g]}Object.defineProperty(a,"__esModule",{value:!0});a.buildSDF=a.getSDFMetrics=a.getExtent=a.getSDFSymbol=a.getSDFInfo=void 0;a.getSDFInfo=h;a.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};a.getExtent=function(a){return a?a.rings?g(a.rings):a.paths?g(a.paths):b.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};a.getSDFMetrics=function(a,
b,c,e,g){var d=a[0],f=a[1],h=a[2];a=a[3];if(h<d||a<f)return[0,0,0];var k=h-d,l=a-f,h=Math.floor(31.5);a=(128-2*(h+1))/Math.max(k,l);var k=Math.round(k*a),l=Math.round(l*a)+2*h,n=1;b&&(n=l/a/(b.ymax-b.ymin));var m=0,B=0;e&&(g?b&&c&&0<b.ymax-b.ymin&&(m=e.x/((b.xmax-b.xmin)/(b.ymax-b.ymin)*c),B=e.y/c):(m=e.x,B=e.y));m=.5*(b.xmax+b.xmin)+m*(b.xmax-b.xmin);B=.5*(b.ymax+b.ymin)+B*(b.ymax-b.ymin);m=(m-d)*a+h;B=(B-f)*a+h;return[n,m/(k+2*h)-.5,-(B/l-.5)]};a.buildSDF=function(a){var b,c=a.geom;b=c?c.rings?
c.rings:c.paths?c.paths:void 0!==c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax?[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]:null:null;var d,c=Infinity,g=-Infinity,h=Infinity,m=-Infinity;for(d=0;d<b.length;d++)for(var p=0,q=b[d];p<q.length;p++){var u=q[p];u[0]<c&&(c=u[0]);u[0]>g&&(g=u[0]);u[1]<h&&(h=u[1]);u[1]>m&&(m=u[1])}d=new k.default(c,h,g-c,m-h);h=Math.floor(31.5);p=(128-2*(h+1))/Math.max(d.width,d.height);c=Math.round(d.width*p)+2*h;g=Math.round(d.height*
p)+2*h;m=[];for(q=0;q<b.length;q++){var y=b[q];if(y&&1<y.length){for(var u=[],w=0;w<y.length;w++){var B=y[w],z=B[0],B=B[1],z=z-d.x,B=B-d.y,z=z*p,B=B*p,z=z+(h-.5),B=B+(h-.5);u.push([z,B])}a.asFill&&(w=u.length-1,u[0][0]===u[w][0]&&u[0][1]===u[w][1]||u.push(u[0]));m.push(u)}}d=c*g;b=Array(d);q=h*h+1;for(p=0;p<d;++p)b[p]=q;for(q=0;q<m.length;q++)for(u=m[q],w=u.length,p=1;p<w;++p){var y=u[p-1],z=u[p],A=void 0,B=void 0;y[0]<z[0]?(A=y[0],B=z[0]):(A=z[0],B=y[0]);var C=void 0,E=void 0;y[1]<z[1]?(C=y[1],E=
z[1]):(C=z[1],E=y[1]);var D=Math.floor(A)-h,B=Math.floor(B)+h,C=Math.floor(C)-h,E=Math.floor(E)+h;0>D&&(D=0);B>c&&(B=c);0>C&&(C=0);E>g&&(E=g);for(var A=z[0]-y[0],F=z[1]-y[1],H=A*A+F*F;D<B;D++)for(var I=C;I<E;I++){var G=(D-y[0])*A+(I-y[1])*F,K=void 0,L=void 0;0>G?(K=y[0],L=y[1]):G>H?(K=z[0],L=z[1]):(G/=H,K=y[0]+G*A,L=y[1]+G*F);G=(D-K)*(D-K)+(I-L)*(I-L);K=(g-I-1)*c+D;G<b[K]&&(b[K]=G)}}for(p=0;p<d;++p)b[p]=Math.sqrt(b[p]);if(a.asFill)for(a=0;a<m.length;a++)for(d=m[a],p=d.length,q=1;q<p;++q)for(u=d[q-
1],w=d[q],z=y=void 0,u[0]<w[0]?(y=u[0],z=w[0]):(y=w[0],z=u[0]),B=C=void 0,u[1]<w[1]?(C=u[1],B=w[1]):(C=w[1],B=u[1]),y=Math.floor(y),z=Math.floor(z)+1,C=Math.floor(C),B=Math.floor(B)+1,y<h&&(y=h),z>c-h&&(z=c-h),C<h&&(C=h),B>g-h&&(B=g-h);C<B;++C)if(u[1]>C!==w[1]>C){E=(g-C-1)*c;for(A=y;A<z;++A)A<(w[0]-u[0])*(C-u[1])/(w[1]-u[1])+u[0]&&(b[E+A]=-b[E+A]);for(A=h;A<y;++A)b[E+A]=-b[E+A]}h*=2;m=b.length;a=new Uint8Array(4*m);for(d=0;d<m;++d)l.packFloatRGBA(.5-b[d]/h,a,4*d);return[a,c,g]}})},"esri/symbols/cim/utils":function(){define(["require",
"exports"],function(m,a){function b(a,b){"string"!==typeof a&&(a=String(a));switch(b){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.isCIMMarkerStrokePlacement=a.isCIMFill=a.isCIMStroke=a.isCIMMarker=a.toCIMSymbolJSON=a.fromCIMColor=a.resampleHermite=a._adjustTextCase=a.createLabelOverrideFunction=a.colorToArray=a.evaluateValueOrFunction=void 0;a.evaluateValueOrFunction=function(a,b,h,g){return"function"===
typeof a?a(b,h,g):a};a.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};a.createLabelOverrideFunction=function(a,k,h){var g=function(a){for(var c=a.length;c--;)if(-1===" /-,\n".indexOf(a.charAt(c)))return!1;return!0},d=[],f=0,c=-1;do c=k.indexOf("[",f),c>=f&&(c>f&&(f=k.substr(f,c-f),d.push([f,null,g(f)])),f=c+1,c=k.indexOf("]",f),c>=f&&(c>f&&(f=k.substr(f,c-f),(f=a[f])&&d.push([null,f,!1])),f=c+1));while(-1!==c);f<k.length-1&&(f=k.substr(f),d.push([f,null,g(f)]));return function(a){for(var c="",
e=null,f=0;f<d.length;f++){var g=d[f],k=g[0],l=g[1],g=g[2];if(k)g?e=k:(e&&(c+=e,e=null),c+=k);else if(k=a.attributes[l])e&&(c+=e,e=null),c+=k}return b(c,h)}};a._adjustTextCase=b;a.resampleHermite=function(a,b,h,g,d,f,c){void 0===c&&(c=!0);var e=b/d;h/=f;for(var k=Math.ceil(e/2),l=Math.ceil(h/2),m=0;m<f;m++)for(var p=0;p<d;p++){for(var q=4*(p+(c?f-m-1:m)*d),u=0,y=0,w=0,B=0,z=0,A=0,C=0,E=(m+.5)*h,D=Math.floor(m*h);D<(m+1)*h;D++)for(var F=Math.abs(E-(D+.5))/l,H=(p+.5)*e,F=F*F,I=Math.floor(p*e);I<(p+
1)*e;I++){var G=Math.abs(H-(I+.5))/k,u=Math.sqrt(F+G*G);-1<=u&&1>=u&&(u=2*u*u*u-3*u*u+1,0<u&&(G=4*(I+D*b),C+=u*a[G+3],w+=u,255>a[G+3]&&(u=u*a[G+3]/250),B+=u*a[G],z+=u*a[G+1],A+=u*a[G+2],y+=u))}g[q]=B/y;g[q+1]=z/y;g[q+2]=A/y;g[q+3]=C/w}};a.fromCIMColor=function(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}};a.toCIMSymbolJSON=function(a){var b;return null===(b=a.data)||void 0===b?void 0:b.symbol};a.isCIMMarker=function(a){return"CIMVectorMarker"===a.type||"CIMPictureMarker"===a.type||
"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};a.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};a.isCIMFill=function(a){return"CIMGradientFill"===a.type||"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===a.type};a.isCIMMarkerStrokePlacement=function(a){return"CIMMarkerPlacementAlongLineRandomSize"===a.type||
"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===a.type||"CIMMarkerPlacementAtRatioPositions"===a.type||"CIMMarkerPlacementOnLine"===a.type||"CIMMarkerPlacementOnVertices"===a.type}})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define("require exports tslib ../../../core/Error ../../../core/Logger ../../../geometry/support/quantizationUtils".split(" "),
function(m,a,b,l,k,h){function g(a){var c={};switch(a){case "esriGeometryPoint":return function(a,b,d,f){return h.unquantizePoint(b,c,a,d,f)};case "esriGeometryPolygon":return function(a,b,d,f){return h.unquantizePolygon(b,c,a,d,f)};case "esriGeometryPolyline":return function(a,b,d,f){return h.unquantizePolyline(b,c,a,d,f)};case "esriGeometryMultipoint":return function(a,b,d,f){return h.unquantizeMultipoint(b,c,a,d,f)};default:return k.getLogger("esri.views.2d.support.arcadeOnDemand").error(new l("mapview-arcade",
"Unable to handle geometryType: "+a)),function(a){return a}}}Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a,c,e,h,l){if(a.referencesGeometry()&&l){var f=l.transform,n=l.hasZ;l=l.hasM;d.has(h)||d.set(h,g(h));h=d.get(h)(c.geometry,f,n,l);c=b.__assign(b.__assign({},c),{geometry:h})}c=a.repurposeFeature(c);try{return a.evaluate(b.__assign(b.__assign({},e),{$feature:c}))}catch(q){return k.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",
q),null}};var d=new Map})},"esri/symbols/cim/ExpandedCIM":function(){define(["require","exports","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.ExpandedCIM=void 0;var k={marker:b.WGLGeometryType.MARKER,fill:b.WGLGeometryType.FILL,line:b.WGLGeometryType.LINE,text:b.WGLGeometryType.TEXT};m=function(){function a(a,b,f){this.layers=a;this.data=b;this.hash=this._createHash();this.rendererKey=
f;for(b=0;b<a.length;b++)f=a[b],f.materialKey=l.createMaterialKey(k[f.type],this.rendererKey,!1,!1)}Object.defineProperty(a.prototype,"type",{get:function(){return"expanded-cim"},enumerable:!1,configurable:!0});a.prototype._createHash=function(){for(var a="",b=0,f=this.layers;b<f.length;b++)a+=f[b].templateHash;return a};return a}();a.ExpandedCIM=m})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports tslib ../../../../../core/Error ../enums ../mesh/templates/meshUtils".split(" "),
function(m,a,b,l,k,h){function g(a,c){void 0===c&&(c=!1);var b=k.WGLVVFlag.SIZE_FIELD_STOPS|k.WGLVVFlag.SIZE_MINMAX_VALUE|k.WGLVVFlag.SIZE_SCALE_STOPS|k.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(k.WGLVVTarget.FIELD_TARGETS_OUTLINE|k.WGLVVTarget.MINMAX_TARGETS_OUTLINE|k.WGLVVTarget.SCALE_TARGETS_OUTLINE|k.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return c?b&a:b&~a}function d(a){var c=g(a,!1);return a&(k.WGLVVFlag.COLOR|k.WGLVVFlag.OPACITY|k.WGLVVFlag.ROTATION|c)}Object.defineProperty(a,"__esModule",{value:!0});
a.LabelMaterialKey=a.TextMaterialKey=a.LineMaterialKey=a.MarkerMaterialKey=a.FillMaterialKey=a.MaterialKeyBase=a.hydrateMaterialKey=a.createMaterialKey=a.getLabelVVFlags=a.getTextVVFlags=a.getLineVVFlags=a.getFillVVFlags=a.getMarkerVVFlags=a.getSizeFlagsMask=void 0;a.getSizeFlagsMask=g;a.getMarkerVVFlags=d;a.getFillVVFlags=function(a){return a&(k.WGLVVFlag.COLOR|k.WGLVVFlag.OPACITY)};a.getLineVVFlags=function(a,c){if(c)return c=g(a,!0),a&c;c=g(a,!1);return a&(k.WGLVVFlag.COLOR|k.WGLVVFlag.OPACITY|
c)};a.getTextVVFlags=function(a){return d(a)};a.getLabelVVFlags=function(a){var c=g(a,!1);return a&c};a.createMaterialKey=function(a,c,b,d,e){switch(a){case k.WGLGeometryType.FILL:return t.from(c,d);case k.WGLGeometryType.LINE:return p.from(c,b);case k.WGLGeometryType.MARKER:return x.from(c);case k.WGLGeometryType.TEXT:return q.from(c);case k.WGLGeometryType.LABEL:return u.from(c,e);default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}};a.hydrateMaterialKey=function(a){switch(f.load(a).geometryType){case k.WGLGeometryType.MARKER:return new x(a);
case k.WGLGeometryType.FILL:return new t(a);case k.WGLGeometryType.LINE:return new p(a);case k.WGLGeometryType.TEXT:return new q(a);case k.WGLGeometryType.LABEL:return new u(a)}};var f=function(){function a(a){this._data=0;this._data=a}a.load=function(a){var c=this.shared;c.data=a;return c};Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.bits(8,
11)},set:function(a){this.setBits(a,8,11)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"mapAligned",{get:function(){return!!this.bit(20)},set:function(a){this.setBit(20,a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"sdf",{get:function(){return!!this.bit(11)},set:function(a){this.setBit(11,a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"pattern",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this.bits(0,8)},set:function(a){this.setBits(a,0,8)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"geometryTypeString",{get:function(){switch(this.geometryType){case k.WGLGeometryType.FILL:return"fill";case k.WGLGeometryType.MARKER:return"marker";case k.WGLGeometryType.LINE:return"line";case k.WGLGeometryType.TEXT:return"text";case k.WGLGeometryType.LABEL:return"label";default:throw new l("Unable to handle unknown geometryType: "+
this.geometryType);}},enumerable:!1,configurable:!0});a.prototype.setBit=function(a,c){a=1<<a;this._data=c?this._data|a:this._data&~a};a.prototype.bit=function(a){return(this._data&1<<a)>>a};a.prototype.setBits=function(a,c,b){for(var d=0;c<b;c++,d++)this.setBit(c,0!==(a&1<<d))};a.prototype.bits=function(a,c){for(var b=0,d=0;a<c;a++,d++)b|=this.bit(a)<<d;return b};a.prototype.hasVV=function(){return!1};a.prototype.setVV=function(a,c){};a.prototype.getVariation=function(){return{mapAligned:this.mapAligned,
pattern:this.pattern,sdf:this.sdf}};a.prototype.getVariationHash=function(){return this._data&~(7&this.textureBinding)};a.shared=new a(0);return a}();a.MaterialKeyBase=f;m=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);Object.defineProperty(c.prototype,"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"vvSizeScaleStops",{get:function(){return 0!==
this.bit(17)},set:function(a){this.setBit(17,a)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"vvSizeFieldStops",{get:function(){return 0!==this.bit(18)},set:function(a){this.setBit(18,a)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"vvSizeUnitValue",{get:function(){return 0!==this.bit(19)},set:function(a){this.setBit(19,a)},enumerable:!1,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||
this.vvSizeFieldStops||this.vvSizeUnitValue};c.prototype.setVV=function(c,b){a.prototype.setVV.call(this,c,b);c&=g(c,b);this.vvSizeMinMaxValue=!!(c&k.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(c&k.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(c&k.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(c&k.WGLVVFlag.SIZE_SCALE_STOPS)};return c}(a)};var c=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);Object.defineProperty(c.prototype,
"vvRotation",{get:function(){return 0!==this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!1,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvRotation};c.prototype.setVV=function(c,b){a.prototype.setVV.call(this,c,b);this.vvRotation=!b&&!!(c&k.WGLVVFlag.ROTATION)};return c}(a)},e=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);Object.defineProperty(c.prototype,"vvColor",{get:function(){return 0!==
this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!1,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};c.prototype.setVV=function(c,b){a.prototype.setVV.call(this,c,b);this.vvColor=!b&&!!(c&k.WGLVVFlag.COLOR)};return c}(a)},n=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);Object.defineProperty(c.prototype,"vvOpacity",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,
a)},enumerable:!1,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};c.prototype.setVV=function(c,b){a.prototype.setVV.call(this,c,b);this.vvOpacity=!b&&!!(c&k.WGLVVFlag.OPACITY)};return c}(a)},t=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.load=function(a){var c=this.shared;c.data=a;return c};c.from=function(a,c){var b=this.load(0);b.geometryType=k.WGLGeometryType.FILL;c?b.dotDensity=!0:b.setVV(a,!1);return b.data};
c.prototype.getVariation=function(){return b.__assign(b.__assign({},a.prototype.getVariation.call(this)),{dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity})};Object.defineProperty(c.prototype,"dotDensity",{get:function(){return!!this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!1,configurable:!0});c.shared=new c(0);return c}(e(n(f)));a.FillMaterialKey=t;var x=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.load=function(a){var c=
this.shared;c.data=a;return c};c.from=function(a){var c=this.load(0);c.geometryType=k.WGLGeometryType.MARKER;c.setVV(a,!1);return c.data};c.prototype.getVariation=function(){return b.__assign(b.__assign({},a.prototype.getVariation.call(this)),{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};c.shared=new c(0);return c}(e(n(c(m(f)))));
a.MarkerMaterialKey=x;var p=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.load=function(a){var c=this.shared;c.data=a;return c};c.from=function(a,c){var b=this.load(0);b.geometryType=k.WGLGeometryType.LINE;b.setVV(a,c);return b.data};c.prototype.getVariation=function(){return b.__assign(b.__assign({},a.prototype.getVariation.call(this)),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,
vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};c.shared=new c(0);return c}(e(n(m(f))));a.LineMaterialKey=p;var q=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.load=function(a){var c=this.shared;c.data=a;return c};c.from=function(a){var c=this.load(a);c.geometryType=k.WGLGeometryType.TEXT;c.setVV(a,!1);return c.data};c.prototype.getVariation=function(){return b.__assign(b.__assign({},a.prototype.getVariation.call(this)),{vvColor:this.vvColor,
vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};c.shared=new c(0);return c}(e(n(c(m(f)))));a.TextMaterialKey=q;var u=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}b.__extends(c,a);c.load=function(a){var c=this.shared;c.data=a;return c};c.from=function(a,c){var b=this.load(0);b.geometryType=k.WGLGeometryType.LABEL;
b.setVV(a,!1);b.mapAligned=!!h.isMapAligned(c);return b.data};c.prototype.getVariation=function(){return b.__assign(b.__assign({},a.prototype.getVariation.call(this)),{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};c.shared=new c(0);return c}(m(f));a.LabelMaterialKey=u})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,
"__esModule",{value:!0});a.isMapAligned=void 0;a.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}}})},"esri/views/2d/layers/features/schemaUtils":function(){define("require exports tslib ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../symbols/support/jsonUtils ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/materialKey/MaterialKey ../../engine/webgl/util/vvFlagUtils ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u){function y(a){var b;switch(a.type){case "line-marker":return{type:"line-marker",color:null===(b=a.color)||void 0===b?void 0:b.toJSON(),placement:a.placement,style:a.style};default:return c.fromJSON(a.toJSON()).toJSON()}}function w(a,c,f){if(!a)return null;var g=0,h=!1;d.isSome(c)&&"visualVariables"in c&&(g=x.getVVFlags(c.visualVariables||[]),h="dot-density"===c.type);switch(a.type){case "simple-fill":case "picture-fill":return B(a,g,h,f);case "simple-marker":case "picture-marker":return c=
t.createMaterialKey(e.WGLGeometryType.MARKER,g,!1,!1),f=f?t.hydrateMaterialKey(c):c,c=y(a),b.__assign(b.__assign({materialKey:f,hash:a.hash()},c),{angle:a.angle});case "simple-line":return z(a,g,f);case "text":return c=t.createMaterialKey(e.WGLGeometryType.TEXT,g,!1,!1),f=f?t.hydrateMaterialKey(c):c,c=y(a),b.__assign(b.__assign({materialKey:f,hash:a.hash()},c),{angle:a.angle});case "label":return c=t.createMaterialKey(e.WGLGeometryType.LABEL,g,!1,!1,a.labelPlacement),f=f?t.hydrateMaterialKey(c):c,
b.__assign(b.__assign({materialKey:f,hash:a.hash()},a.toJSON()),{labelPlacement:a.labelPlacement});case "cim":return{type:"cim",rendererKey:g,data:a.data};case "web-style":return b.__assign(b.__assign({},y(a)),{type:"web-style",hash:a.hash(),rendererKey:g});default:throw Error("symbol not supported "+a.type);}}function B(a,c,d,f){d=t.createMaterialKey(e.WGLGeometryType.FILL,c,!1,d);var g=f?t.hydrateMaterialKey(d):d,h=a.clone();d=h.outline;h.outline=null;a=[];g=b.__assign({materialKey:g,hash:h.hash()},
y(h));a.push(g);d&&(c=t.createMaterialKey(e.WGLGeometryType.LINE,c,!0,!1),f=f?t.hydrateMaterialKey(c):c,f=b.__assign({materialKey:f,hash:d.hash()},y(d)),a.push(f));return{type:"composite-symbol",layers:a,hash:a.reduce(function(a,c){return c.hash+a},"")}}function z(a,c,d){var f,g=t.createMaterialKey(e.WGLGeometryType.LINE,c,!1,!1),h=d?t.hydrateMaterialKey(g):g;a=a.clone();g=a.marker;a.marker=null;var k=[];k.push(b.__assign({materialKey:h,hash:a.hash()},y(a)));g&&(c=t.createMaterialKey(e.WGLGeometryType.MARKER,
c,!1,!1),d=d?t.hydrateMaterialKey(c):c,g.color=null!==(f=g.color)&&void 0!==f?f:a.color,k.push(b.__assign({materialKey:d,hash:g.hash(),lineWidth:a.width},y(g))));return{type:"composite-symbol",layers:k,hash:k.reduce(function(a,c){return c.hash+a},"")}}function A(a,c){var b=a.labelPlacement,d=T[c];if(!a.symbol)return R.warn("No LabelClass symbol specified."),!0;if(!d)return R.error(new l("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+c+" is not supported")),
!0;d.some(function(a){return a===b})||(d=d[0],b&&R.warn("Found invalid label placement type "+b+" for "+c+". Defaulting to "+d),a.labelPlacement=d);return!1}function C(a,c){a=h.clone(a);return a.some(function(a){return A(a,c)})?[]:a}function E(a,c,b){var d,e;void 0===b&&(b=!1);try{var g=K(a.layer,b),h={};g.map(function(c){a:{switch(c.target){case "feature":H(h,F(a),c);c=void 0;break a;case "aggregate":var b=a.layer.featureReduction;if("selection"===b.type)throw new l("ValidationError","Mapview does not support `selection` reduction type",
b);H(h,F(a),c);h.aggregate||(h.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:f.pt2px(b.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(f.pt2px(b.clusterMaxSize)/64),fields:c.aggregateFields}});D(h.aggregate,c.attributes.fields);c=void 0;break a}c=void 0}return c});return{source:{definitionExpression:a.layer.definitionExpression,fields:a.layer.fields.map(function(a){return a.toJSON()}),gdbVersion:"feature"===a.layer.type?a.layer.gdbVersion:void 0,historicMoment:"feature"===
a.layer.type?null===(d=a.layer.historicMoment)||void 0===d?void 0:d.getTime():void 0,outFields:a.availableFields,pixelBuffer:c,spatialReference:a.layer.spatialReference.toJSON(),timeExtent:null===(e=a.layer.timeExtent)||void 0===e?void 0:e.toJSON()},attributes:{fields:{},indexCount:0},processors:g,targets:h}}catch(ea){if("ValidationError"===ea.fieldName)return R.error(ea),null;throw ea;}}function D(a,c){for(var b in c){var d=c[b];if(d.target===a.name){var e=a.attributes[b];e?(e.context.mesh=e.context.mesh||
d.context.mesh,e.context.storage=e.context.storage||d.context.storage):a.attributes[b]=d}}return a}function F(a){var c,b,d,e,f;return[null!==(b=null===(c=a.filter)||void 0===c?void 0:c.toJSON())&&void 0!==b?b:null,null!==(f=null===(e=null===(d=a.effect)||void 0===d?void 0:d.filter)||void 0===e?void 0:e.toJSON())&&void 0!==f?f:null]}function H(a,c,b){a.feature||(a.feature={name:"feature",input:"source",filters:c,attributes:{}});D(a.feature,b.attributes.fields);return a}function I(a,c){return c.field?
G(a,b.__assign(b.__assign({},c),{type:"field",field:c.field})):c.valueExpression?G(a,b.__assign(b.__assign({},c),{type:"expression",valueExpression:c.valueExpression})):{field:null,fieldIndex:null}}function G(a,c){switch(c.type){case "expression":var d=c.valueExpression;if(!a.fields[d]){var e=a.indexCount++;a.fields[d]=b.__assign(b.__assign({},c),{name:d,fieldIndex:e})}a=a.fields[d];return{fieldIndex:a.fieldIndex};case "label-expression":return d=JSON.stringify(c.label),a.fields[d]||(e=a.indexCount++,
a.fields[d]=b.__assign(b.__assign({},c),{name:d,fieldIndex:e})),a=a.fields[d],{fieldIndex:a.fieldIndex};case "field":d=c.field;if("aggregate"===c.target&&a.fields[d])return{field:d};a.fields[d]=b.__assign(b.__assign({},c),{name:d});return{field:d};case "statistic":return a.fields[c.name]=b.__assign({},c),{field:c.name}}}function K(a,c){void 0===c&&(c=!1);var b=[],d=0;b.push(O(a,d++,c));return b}function L(a,c,d,e,f,g){void 0===g&&(g=!1);c=G(c,{type:"label-expression",target:e,context:{mesh:!0},resultType:"string",
label:{labelExpression:d.labelExpression,labelExpressionInfo:d.labelExpressionInfo?{expression:d.labelExpressionInfo.expression}:null,symbol:!!d.symbol,where:d.where}}).fieldIndex;return b.__assign(b.__assign({},w(d,a,g)),{fieldIndex:c,target:e,index:f})}function O(a,c,d){void 0===d&&(d=!1);var e={indexCount:0,fields:{}},f="featureReduction"in a&&a.featureReduction;c=f?"aggregate":"feature";switch(a.renderer.type){case "heatmap":var g=a.renderer;return{type:"heatmap",aggregateFields:[],attributes:e,
target:c,storage:null,mesh:{blurRadius:g.blurRadius,fieldOffset:g.fieldOffset,field:I(e,{target:c,field:g.field,resultType:"numeric"}).field}};default:var g=[],h="aggregate"===c?q.createClusterRenderer(g,a.renderer,f,null):a.renderer;P(e,g);var k=Q(e,c,h,d),n=N(e,c,h),m=u.toJSONGeometryType(a.geometryType);a=a.labelsVisible&&a.labelingInfo||[];var p=[];if(f){if("selection"===f.type)throw new l("ValidationError","Mapview does not support `selection` reduction type",f);p=f&&f.labelsVisible&&f.labelingInfo||
[]}a=C(a,m);var p=C(p,m),w=0,f=b.__spreadArrays(a.map(function(a){return L(h,e,a,"feature",w++,d)}),p.map(function(a){return L(h,e,a,"aggregate",w++,d)}));return{type:"symbol",target:c,attributes:e,aggregateFields:g,storage:n,mesh:{matcher:k,labels:f}}}}function P(a,c){for(var b={mesh:!0,storage:!0},d=0;d<c.length;d++){var e=c[d],f=e.name,e=e.outStatistic,g=e.statisticType,h=e.onStatisticField,k=null,l=null,n=null;"onStatisticValueExpression"in e?l=G(a,{type:"expression",target:"feature",valueExpression:e.onStatisticValueExpression,
resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in e?(k=G(a,{type:"field",target:"feature",field:h,resultType:"numeric"}).field,n=e.onStatisticNormalizationField):k=G(a,{type:"field",target:"feature",field:h,resultType:"numeric"}).field;G(a,{type:"statistic",target:"aggregate",name:f,context:b,inField:k,inNormalizationField:n,inFieldIndex:l,statisticType:g})}}function N(a,c,b){switch(b.type){case "dot-density":return S(a,c,b.attributes);case "simple":case "class-breaks":case "unique-value":return W(a,
c,b.visualVariables);case "heatmap":case "dictionary":return null}}function S(a,c,b){return b&&b.length?{type:"dot-density",mapping:b.map(function(b,d){b=I(a,{valueExpression:b.valueExpression,field:b.field,resultType:"numeric",target:c});return{binding:d,field:b.field,fieldIndex:b.fieldIndex}}),target:c}:{type:"dot-density",mapping:[],target:c}}function W(a,c,b){if(!b||!b.length)return{type:"visual-variable",mapping:[],target:c};var d={storage:!0};return{type:"visual-variable",mapping:p.simplifyVisualVariables(b).map(function(b){var e,
f=n.getVVType(b.type),g=I(a,{target:c,valueExpression:b.valueExpression,field:b.field,context:d,resultType:"numeric"}),h=g.field,g=g.fieldIndex;switch(b.type){case "size":return"$view.scale"===b.valueExpression?null:{type:"size",binding:f,field:h,fieldIndex:g,normalizationField:I(a,{target:c,field:b.normalizationField,context:d,resultType:"numeric"}).field,valueRepresentation:null!==(e=b.valueRepresentation)&&void 0!==e?e:null};case "color":return{type:"color",binding:f,field:h,fieldIndex:g,normalizationField:I(a,
{target:c,field:b.normalizationField,context:d,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:f,field:h,fieldIndex:g,normalizationField:I(a,{target:c,field:b.normalizationField,context:d,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:f,field:h,fieldIndex:g}}}).filter(function(a){return a}),target:c}}function Q(a,c,e,f){void 0===f&&(f=!1);a=d.unwrapOr(a,{indexCount:0,fields:{}});switch(e.type){case "simple":case "dot-density":a="dot-density"===
e.type;void 0===f&&(f=!1);var g=e.getSymbols();return{type:"simple",symbol:w(g.length?g[0]:null,e,f),isDotDensity:a};case "class-breaks":return V(a,c,e,f);case "unique-value":void 0===f&&(f=!1);var g=[],h=e.backgroundFillSymbol;c={target:c,context:{mesh:!0},resultType:"string"};if(e.field&&"string"!==typeof e.field)throw new l("ValidationError","Expected renderer.field to be a string",e);for(var k=I(a,b.__assign(b.__assign({},c),{field:e.field,valueExpression:e.valueExpression})),n=k.field,k=k.fieldIndex,
m=0,p=e.uniqueValueInfos;m<p.length;m++){var q=p[m];g.push({value:""+q.value,symbol:w(q.symbol,e,f)})}return{type:"map",attributes:a.fields,field:n,fieldIndex:k,field2:I(a,b.__assign(b.__assign({},c),{field:e.field2})).field,field3:I(a,b.__assign(b.__assign({},c),{field:e.field3})).field,fieldDelimiter:e.fieldDelimiter,backgroundFillSymbol:w(h,e),defaultSymbol:w(e.defaultSymbol,e),map:g};case "dictionary":return a=f,void 0===a&&(a=!1),{type:"dictionary",renderer:e.toJSON()}}}function V(a,c,b,d){void 0===
d&&(d=!1);var e=b.backgroundFillSymbol,f=I(a,{target:c,field:b.field,valueExpression:b.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});c=f.field;var f=f.fieldIndex,g=b.normalizationType,g="log"===g?"esriNormalizeByLog":"percent-of-total"===g?"esriNormalizeByPercentOfTotal":"field"===g?"esriNormalizeByField":null,h=b.classBreakInfos.map(function(a){return{symbol:w(a.symbol,b,d),min:a.minValue,max:a.maxValue}}).sort(function(a,c){return a.min-c.min});return{type:"interval",
attributes:a.fields,field:c,fieldIndex:f,backgroundFillSymbol:w(e,b,d),defaultSymbol:w(b.defaultSymbol,b,d),intervals:h,normalizationField:b.normalizationField,normalizationTotal:b.normalizationTotal,normalizationType:g,isMaxInclusive:b.isMaxInclusive}}Object.defineProperty(a,"__esModule",{value:!0});a.createMatcherSchema=a.createSchema=a.createSymbolSchema=void 0;var R=g.getLogger("esri.views.2d.layers.features.schemaUtils"),T={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),
esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};a.createSymbolSchema=w;a.createSchema=function(a,c){void 0===c&&(c=0);k("esri-2d-update-debug")&&console.debug("Created new schema",E(a,c,!0));return E(a,c)};a.createMatcherSchema=Q})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.getVVFlags=void 0;
a.getVVFlags=function(a){if(!a)return b.WGLVVFlag.NONE;for(var h=0,g=0;g<a.length;g++){var d=a[g];if("size"===d.type){var f=l.getTypeOfSizeVisualVariable(d),h=h|f;"outline"===d.target&&(h|=f<<4)}else"color"===d.type?h|=b.WGLVVFlag.COLOR:"opacity"===d.type?h|=b.WGLVVFlag.OPACITY:"rotation"===d.type&&(h|=b.WGLVVFlag.ROTATION)}return h}})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["require","exports","tslib","../../../../../core/Logger","../../../../../core/screenUtils"],
function(m,a,b,l,k){function h(a){return("size"===a.type||"color"===a.type||"opacity"===a.type)&&null!=a.stops}function g(a){var c;var e=a.type;c=a.stops;if(!(8>=c.length))if(d.warn("Found "+c.length+" Visual Variable stops, but MapView only supports 8. Displayed stops will be simplified."),16<c.length){for(var f=c[0],g=c.slice(1),h=g.pop(),l=g[0].value,m=g[g.length-1].value,u=(m-l)/6,y=[];l<m;l+=u){for(var w=0;l>=g[w].value;)w++;var B=g[w],z=c[w-1],A=l-z.value,B=B.value===z.value?1:A/(B.value-z.value);
"color"===e?(z=g[w],w=c[w-1],A=z.color.clone(),A.r=(1-B)*w.color.r+B*A.r,A.g=(1-B)*w.color.g+B*A.g,A.b=(1-B)*w.color.b+B*A.b,A.a=(1-B)*w.color.a+B*A.a,y.push({value:l,color:A,label:z.label})):"size"===e?(z=g[w],A=c[w-1],w=k.toPt(z.size),A=k.toPt(A.size),y.push({value:l,size:(1-B)*A+B*w,label:z.label})):(z=g[w],y.push({value:l,opacity:(1-B)*c[w-1].opacity+B*z.opacity,label:z.label}))}c=b.__spreadArrays([f],y,[h])}else{e=c[0];c=c.slice(1);for(f=c.pop();6<c.length;){h=g=0;for(m=1;m<c.length;m++)u=Math.abs(c[m].value-
c[m-1].value),u>h&&(h=u,g=m);c.splice(g,1)}c=b.__spreadArrays([e],c,[f])}a.stops=c;return a}Object.defineProperty(a,"__esModule",{value:!0});a.simplifyVisualVariables=a.simplifyVVRenderer=void 0;var d=l.getLogger("esri.renderers.visualVariables.support.utils");a.simplifyVVRenderer=function(a){if(!("visualVariables"in a&&a.visualVariables&&a.visualVariables.length))return a;a=a.clone();var c=a.visualVariables.map(function(a){return h(a)?g(a):a});a.visualVariables=c;return a};a.simplifyVisualVariables=
function(a){return a.map(function(a){return h(a)?g(a.clone()):a})}})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports tslib ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),function(m,a,b,l,k,h,g,d,f,c,e){function n(a,c,b){switch(a){case "avg":case "avg_angle":return"cluster_avg_"+
c;case "mode":return"cluster_type_"+c;case "norm":return a=c.toLowerCase()+",norm:field,"+b.toLowerCase(),"cluster_avg_"+d.createMD5Hash(a)}}function t(a,c){var b=c.name,e=c.outStatistic,f=e.onStatisticField,g=e.onStatisticValueExpression,e=e.statisticType;g?(c=d.createMD5Hash(g.toLowerCase()),a.push({name:b,outStatistic:{onStatisticField:c,onStatisticValueExpression:g,statisticType:e}})):f?a.push({name:b,outStatistic:{onStatisticField:f,statisticType:e}}):q.error(new l("mapview-unsupported-field",
"Unable to handle field",{field:c}))}function x(a,c,b){var e=d.createMD5Hash(c),f="mode"===b?"cluster_type_"+e:"cluster_avg_"+e;a.some(function(a){return a.name===f})||a.push({name:f,outStatistic:{onStatisticField:e,onStatisticValueExpression:c,statisticType:b}});return f}function p(a,c,b,d){if("cluster_count"===c||a.some(function(a){return a.name===c}))return c;var e=n(b,c,d);a.some(function(a){return a.name===e})||("norm"===b?a.push({name:e,outStatistic:{onStatisticField:c,onStatisticNormalizationField:d,
statisticType:b}}):a.push({name:e,outStatistic:{onStatisticField:c,statisticType:b}}));return e}Object.defineProperty(a,"__esModule",{value:!0});a.isClusterCompatibleRenderer=a.createClusterCountSizeVariable=a.hasClusterCountVV=a.findSizeVV=a.createClusterRenderer=void 0;var q=h.getLogger("esri.views.2d.layers.support.clusterUtils");k.add("esri-cluster-arcade-enabled",1);var u=k("esri-cluster-arcade-enabled");a.createClusterRenderer=function(c,b,d,e){b=b.clone();if(!a.isClusterCompatibleRenderer(b))return b;
if(d.fields)for(var f=0,h=d.fields;f<h.length;f++)t(c,h[f]);"visualVariables"in b&&(f=(b.visualVariables||[]).filter(function(a){return"$view.scale"!==a.valueExpression}),h=a.findSizeVV(f),f.forEach(function(a){"rotation"===a.type?a.field?a.field=p(c,a.field,"avg_angle"):a.valueExpression&&(a.field=x(c,a.valueExpression,"avg_angle"),a.valueExpression=null):a.normalizationField?(a.field=p(c,a.field,"norm",a.normalizationField),a.normalizationField=null):a.field?a.field=p(c,a.field,"avg"):(a.field=
x(c,a.valueExpression,"avg"),a.valueExpression=null)}),g.isNone(h)&&!a.hasClusterCountVV(f)&&(f.push(a.createClusterCountSizeVariable(d,e)),b.dynamicClusterSize=!0),b.visualVariables=f);switch(b.type){case "unique-value":b.field?b.field=p(c,b.field,"mode"):b.valueExpression&&(b.field=x(c,b.valueExpression,"mode"),b.valueExpression=null);break;case "class-breaks":b.normalizationField?(b.field=p(c,b.field,"norm",b.normalizationField),b.normalizationField=null):b.field?b.field=p(c,b.field,"avg"):(b.field=
x(c,b.valueExpression,"avg"),b.valueExpression=null)}return b};a.findSizeVV=function(a){for(var c=0;c<a.length;c++){var b=a[c];if("size"===b.type)return b}return null};a.hasClusterCountVV=function(a){for(var c=0;c<a.length;c++)if("cluster_count"===a[c].field)return!0;return!1};a.createClusterCountSizeVariable=function(a,d){var h=[new c({value:0,size:0}),new c({value:1})];if(g.isNone(d))return new f({field:"cluster_count",stops:b.__spreadArrays(h,[new c({value:2,size:0})])});var k=Object.keys(d).reduce(function(e,
f){var g;return b.__assign(b.__assign({},e),(g={},g[f]=b.__spreadArrays(h,[new c({value:Math.max(2,d[f].minValue),size:a.clusterMinSize}),new c({value:Math.max(3,d[f].maxValue),size:a.clusterMaxSize})]),g))},{});return new e.LevelDependentSizeVariable({field:"cluster_count",levels:k})};a.isClusterCompatibleRenderer=function(a){var c=function(c){return q.error(new l("Unsupported-renderer",c,{renderer:a}))};if("unique-value"===a.type){if(a.field2||a.field3)return c("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),
!1}else if("class-breaks"===a.type){if(a.normalizationField){var b=a.normalizationType;if("field"!==b)return c("FeatureReductionCluster does not support a normalizationType of "+b),!1}}else if("simple"!==a.type)return c("FeatureReductionCluster does not support renderers of type "+a.type),!1;if(!u){if("valueExpression"in a&&a.valueExpression)return c("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in
a&&a.visualVariables||[]).some(function(a){return!!("valueExpression"in a&&a.valueExpression)}))return c("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0}})},"esri/core/MD5":function(){define(["require","exports"],function(m,a){function b(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function l(a,f,c,e,g,h){a=b(b(f,a),b(e,h));return b(a<<g|a>>>32-g,c)}function k(a,b,c,e,g,
h,k){return l(b&c|~b&e,a,b,g,h,k)}function h(a,b,c,e,g,h,k){return l(b&e|c&~e,a,b,g,h,k)}function g(a,b,c,e,g,h,k){return l(c^(b|~e),a,b,g,h,k)}Object.defineProperty(a,"__esModule",{value:!0});a.createMD5Hash=a.outputTypes=void 0;a.outputTypes={Base64:0,Hex:1,String:2,Raw:3};a.createMD5Hash=function(d,f){void 0===f&&(f=a.outputTypes.Hex);f=f||a.outputTypes.Base64;for(var c=[],e=0,n=8*d.length;e<n;e+=8)c[e>>5]|=(d.charCodeAt(e/8)&255)<<e%32;d=8*d.length;c[d>>5]|=128<<d%32;c[(d+64>>>9<<4)+14]=d;d=1732584193;
for(var e=-271733879,n=-1732584194,m=271733878,x=0;x<c.length;x+=16){var p=d,q=e,u=n,y=m;d=k(d,e,n,m,c[x+0],7,-680876936);m=k(m,d,e,n,c[x+1],12,-389564586);n=k(n,m,d,e,c[x+2],17,606105819);e=k(e,n,m,d,c[x+3],22,-1044525330);d=k(d,e,n,m,c[x+4],7,-176418897);m=k(m,d,e,n,c[x+5],12,1200080426);n=k(n,m,d,e,c[x+6],17,-1473231341);e=k(e,n,m,d,c[x+7],22,-45705983);d=k(d,e,n,m,c[x+8],7,1770035416);m=k(m,d,e,n,c[x+9],12,-1958414417);n=k(n,m,d,e,c[x+10],17,-42063);e=k(e,n,m,d,c[x+11],22,-1990404162);d=k(d,e,
n,m,c[x+12],7,1804603682);m=k(m,d,e,n,c[x+13],12,-40341101);n=k(n,m,d,e,c[x+14],17,-1502002290);e=k(e,n,m,d,c[x+15],22,1236535329);d=h(d,e,n,m,c[x+1],5,-165796510);m=h(m,d,e,n,c[x+6],9,-1069501632);n=h(n,m,d,e,c[x+11],14,643717713);e=h(e,n,m,d,c[x+0],20,-373897302);d=h(d,e,n,m,c[x+5],5,-701558691);m=h(m,d,e,n,c[x+10],9,38016083);n=h(n,m,d,e,c[x+15],14,-660478335);e=h(e,n,m,d,c[x+4],20,-405537848);d=h(d,e,n,m,c[x+9],5,568446438);m=h(m,d,e,n,c[x+14],9,-1019803690);n=h(n,m,d,e,c[x+3],14,-187363961);
e=h(e,n,m,d,c[x+8],20,1163531501);d=h(d,e,n,m,c[x+13],5,-1444681467);m=h(m,d,e,n,c[x+2],9,-51403784);n=h(n,m,d,e,c[x+7],14,1735328473);e=h(e,n,m,d,c[x+12],20,-1926607734);d=l(e^n^m,d,e,c[x+5],4,-378558);m=l(d^e^n,m,d,c[x+8],11,-2022574463);n=l(m^d^e,n,m,c[x+11],16,1839030562);e=l(n^m^d,e,n,c[x+14],23,-35309556);d=l(e^n^m,d,e,c[x+1],4,-1530992060);m=l(d^e^n,m,d,c[x+4],11,1272893353);n=l(m^d^e,n,m,c[x+7],16,-155497632);e=l(n^m^d,e,n,c[x+10],23,-1094730640);d=l(e^n^m,d,e,c[x+13],4,681279174);m=l(d^e^
n,m,d,c[x+0],11,-358537222);n=l(m^d^e,n,m,c[x+3],16,-722521979);e=l(n^m^d,e,n,c[x+6],23,76029189);d=l(e^n^m,d,e,c[x+9],4,-640364487);m=l(d^e^n,m,d,c[x+12],11,-421815835);n=l(m^d^e,n,m,c[x+15],16,530742520);e=l(n^m^d,e,n,c[x+2],23,-995338651);d=g(d,e,n,m,c[x+0],6,-198630844);m=g(m,d,e,n,c[x+7],10,1126891415);n=g(n,m,d,e,c[x+14],15,-1416354905);e=g(e,n,m,d,c[x+5],21,-57434055);d=g(d,e,n,m,c[x+12],6,1700485571);m=g(m,d,e,n,c[x+3],10,-1894986606);n=g(n,m,d,e,c[x+10],15,-1051523);e=g(e,n,m,d,c[x+1],21,
-2054922799);d=g(d,e,n,m,c[x+8],6,1873313359);m=g(m,d,e,n,c[x+15],10,-30611744);n=g(n,m,d,e,c[x+6],15,-1560198380);e=g(e,n,m,d,c[x+13],21,1309151649);d=g(d,e,n,m,c[x+4],6,-145523070);m=g(m,d,e,n,c[x+11],10,-1120210379);n=g(n,m,d,e,c[x+2],15,718787259);e=g(e,n,m,d,c[x+9],21,-343485551);d=b(d,p);e=b(e,q);n=b(n,u);m=b(m,y)}c=[d,e,n,m];switch(f){case a.outputTypes.Raw:return c;case a.outputTypes.Hex:f=[];d=0;for(e=4*c.length;d<e;d++)f.push("0123456789abcdef".charAt(c[d>>2]>>d%4*8+4&15)+"0123456789abcdef".charAt(c[d>>
2]>>d%4*8&15));return f.join("");case a.outputTypes.String:f=[];d=0;for(e=32*c.length;d<e;d+=8)f.push(String.fromCharCode(c[d>>5]>>>d%32&255));return f.join("");case a.outputTypes.Base64:f=[];d=0;for(e=4*c.length;d<e;d+=3)for(n=(c[d>>2]>>d%4*8&255)<<16|(c[d+1>>2]>>(d+1)%4*8&255)<<8|c[d+2>>2]>>(d+2)%4*8&255,m=0;4>m;m++)8*d+6*m>32*c.length?f.push("\x3d"):f.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-m)&63));return f.join("")}}})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports tslib ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});a.LevelDependentSizeVariable=void 0;m=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}b.__extends(d,a);c=d;d.prototype.writeLevels=function(a,c,b){for(var d in a){c.stops=this.levels[d];break}};d.prototype.clone=function(){return new c({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:g.isSizeVariable(this.maxSize)?
this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:g.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:l.clone(this.levels)})};var c;b.__decorate([k.property()],d.prototype,
"levels",void 0);b.__decorate([k.writer("levels")],d.prototype,"writeLevels",null);return d=c=b.__decorate([k.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],d)}(h);a.LevelDependentSizeVariable=m})},"esri/views/2d/layers/support/util":function(){define(["require","exports","../../../../core/jsonMap"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.analyzeRings=a.toJSONGeometryType=void 0;var l=new b.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",
esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});a.toJSONGeometryType=function(a){return l.toJSON(a)};a.analyzeRings=function(a,b,g){for(var d=[],f=[],c=0,e=0,h=0;h<a.length;h++){var k=a[h],l=e,m=k[0][0],q=k[0][1];d[e++]=m;d[e++]=q;for(var u=0,y=1;y<k.length;++y){var w=m,B=q,m=k[y][0],q=k[y][1],u=u+(q*w-m*B);d[e++]=m;d[e++]=q}b(u/2);0<u?(0<l-c&&(g(c,l,d,f),c=l),f.length=0):0>u?0<l-c?f.push(.5*(l-c)):e=l:e=l}0<e-c&&g(c,e,d,f)}})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports tslib ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../definitions ../../enums ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){Object.defineProperty(a,"__esModule",{value:!0});a.WGLMeshFactory=void 0;m=function(){function a(a,c,b){this._isDD=!1;this._geometryType=a;this._idField=c;this._templateStore=b}a.prototype.update=function(a,c){this._isDD="simple"===a.mesh.matcher.type&&a.mesh.matcher.isDotDensity;k.isSome(a.mesh.labels)&&this._setLabelTemplates(a.mesh.labels,c)};a.prototype._setLabelTemplates=function(a,c){this._labelTemplates=a.map(function(a){return e.default.fromLabelClass(a,
c)})};Object.defineProperty(a.prototype,"templates",{get:function(){return this._templateStore},enumerable:!1,configurable:!0});a.prototype.createMeshData=function(a){var b=Array(5),e=this._labelTemplates&&0<this._labelTemplates.length,h="esriGeometryPolyline"===this._geometryType?g.HEURISTIC_GLYPHS_PER_LINE:g.HEURISTIC_GLYPHS_PER_FEATURE;b[d.WGLGeometryType.MARKER]=new c.VertexVectors(d.WGLGeometryType.MARKER,4*a);b[d.WGLGeometryType.FILL]=new c.VertexVectors(d.WGLGeometryType.FILL,a,this._isDD);
b[d.WGLGeometryType.LINE]=new c.VertexVectors(d.WGLGeometryType.LINE,a);b[d.WGLGeometryType.TEXT]=new c.VertexVectors(d.WGLGeometryType.TEXT,4*a);b[d.WGLGeometryType.LABEL]=new c.VertexVectors(d.WGLGeometryType.LABEL,e?4*h:0);return new f.MeshData(b,{features:a,records:a,metrics:0})};a.prototype.analyze=function(a,c,d,e,f){return b.__awaiter(this,void 0,void 0,function(){var g,k,l,n,m,p,q;return b.__generator(this,function(b){switch(b.label){case 0:return h.isAborted(f)?[2]:"dictionary"!==c.type?
[3,2]:[4,c.analyze(this._idField,a.copy(),d,e,f)];case 1:g=b.sent(),b.label=2;case 2:for(k=0;a.next();)if(l=void 0,l=g?g[k++]:c.match(this._idField,a,this._geometryType,d,e),a.setGroupId(l),t.isDynamicId(l))for(n=this._templateStore.getDynamicTemplateGroup(l),m=0,p=n;m<p.length;m++)(q=p[m])&&q.analyze&&q.analyze(this._templateStore,a,d,e);return[2,this._templateStore.finalize(f)]}})})};a.prototype.analyzeGraphics=function(a,c,d,e,f){return b.__awaiter(this,void 0,void 0,function(){var g,k,l,n,m,p;
return b.__generator(this,function(b){switch(b.label){case 0:if(h.isAborted(f))return[2];g=a.getCursor();return c?[4,c.analyze(this._idField,g.copy(),d,e,f)]:[3,2];case 1:b.sent(),b.label=2;case 2:for(;g.next();){k=g.getGroupId();if(null==k||-1===k)k=c.match(this._idField,g,g.geometryType,d,e),g.setGroupId(k);if(t.isDynamicId(k))for(l=this._templateStore.getDynamicTemplateGroup(k),n=0,m=l;n<m.length;n++)(p=m[n])&&p.analyze&&p.analyze(this._templateStore,g,d,e);g.setGroupId(k)}return[2,this._templateStore.finalize(f)]}})})};
a.prototype.writeGraphic=function(a,c){var b=c.getGroupId(),d=c.getDisplayId(),e=this._templateStore.getTemplateGroup(b),f=c.geometryType;if(null!=d){if(t.isDynamicId(b))for(var g=0;g<e.length;g++)b=e[g],b.bindFeature(c,null,null);if(e)for(a.writeDisplayObject(d,c.readGraphic().insertAfter),g=0;g<e.length;g++)if(b=e[g]){var h=a.get(b.geometryType);b.writeMesh(a,h,c,f,d)}}};a.prototype.writeCursor=function(a,c,b,d,e,f){var g=c.getGroupId(),h=c.getDisplayId(),l=this._templateStore.getTemplateGroup(g);
if(null!=h&&l){a.writeDisplayObject(h,0);if(t.isDynamicId(g))for(var n=0;n<l.length;n++)g=l[n],g.bindFeature(c,b,d);for(b=0;b<l.length;b++)g=l[b],d=a.get(g.geometryType),!g.needsPixelBuffer&&c.hasFilter()||g.writeMesh(a,d,c,this._geometryType,h);g=a.hasDisplayRecords();k.isSome(f)&&g&&(l=f&&this._findLabelRef(l),this._writeLabels(a,c,h,f,l,e));a.endDisplayObject()}};a.prototype._findLabelRef=function(a){for(var c=0;c<a.length;c++){var b=a[c];if(b instanceof n.default)return b}return null};a.prototype._writeLabels=
function(a,c,b,d,e,f){for(var g=0;g<d.length;g++){var h=d[g];if(k.isSome(h)&&h){var l=h.glyphs,n=h.rtl,h=this._labelTemplates[h.index],m=a.get(h.geometryType);h.bindReferenceTemplate(e);h.bindTextInfo(l,n);h.writeMesh(a,m,c,this._geometryType,b,f)}}};return a}();a.WGLMeshFactory=m})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("require exports ../WGLDisplayObject ../WGLDisplayRecord ../collisions/Metric ../util/Reader ../util/serializationUtils ../util/Writer".split(" "),function(m,
a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.MeshData=void 0;m=function(){function a(a,b){this.vertexVectorsMap=a;this._currentIndex=-1;this._currentMetricOffset=this._currentRecordOffset=0;a=4*(8*b.records+1);var c=4*(20*b.metrics+1);this._bufDisplayObjects=new d.default(Uint32Array,4*(4*b.features+1)+4);this._bufDisplayRecords=new d.default(Uint32Array,a+4);this._bufMetrics=new d.default(Uint32Array,c+4);this._bufDisplayObjects.push(0);this._bufDisplayRecords.push(0);this._bufMetrics.push(0)}
Object.defineProperty(a.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!1,configurable:!0});a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.currentDisplayRecordCount=function(){return this._bufDisplayRecords[this._currentRecordOffset]};a.prototype.writeDisplayObject=
function(a,b){this._bufDisplayObjects.incr(0);this._currentIndex=this._bufDisplayObjects.push(a);this._bufDisplayObjects.push(b);this._bufDisplayObjects.push(0);this._bufDisplayObjects.push(0);this._currentMetricOffset=this._currentRecordOffset=0};a.prototype.hasDisplayRecords=function(){return 0!==this._currentRecordOffset};a.prototype.endDisplayObject=function(){this.hasDisplayRecords()||this._rollbackDisplayObject()};a.prototype.writeDisplayRecord=function(a,b,d,f,g,h,k,l){void 0===k&&(k=0);void 0===
l&&(l=0);0===this._currentRecordOffset&&(this._currentRecordOffset=this._bufDisplayRecords.push(0),this._bufDisplayObjects.setValue(this._currentIndex+2,this._currentRecordOffset));this._bufDisplayRecords.incr(this._currentRecordOffset);this._bufDisplayRecords.push(a);this._bufDisplayRecords.push(b);this._bufDisplayRecords.push(d);this._bufDisplayRecords.push(f);this._bufDisplayRecords.push(g);this._bufDisplayRecords.push(h);this._bufDisplayRecords.push(k);this._bufDisplayRecords.push(l)};a.prototype.writeMetrics=
function(a){0===this._currentMetricOffset&&(this._bufDisplayObjects.setValue(this._currentIndex+3,this._bufMetrics.length),this._currentMetricOffset=this._bufMetrics.length);g.serializeList(this._bufMetrics,a)};a.deserializeDisplayObjects=function(a){var c=a.bufMetrics,d=a.bufRecords;a=new h.default(a.bufDisplayObjects);var d=new h.default(d),c=new h.default(c),f=[],m=a.readInt32();d.readInt32();for(c.readInt32();m--;){var p=a.readInt32(),q=a.readInt32(),u=a.readInt32(),y=a.readInt32(),w=new b(p);
0!==q&&(w.insertAfter=q);0!==u&&(w.displayRecords=g.deserializeList(d,l,{id:p}));0!==y&&(w.metrics=g.deserializeList(c,k.default));f.push(w)}return f};a.prototype.encode=function(a,b){for(var c={},d=0;d<this.vertexVectorsMap.length;d++){var e=this.vertexVectorsMap[d];c[d]={};e.transfer(c[d],b)}a.bufDisplayObjects=this._bufDisplayObjects.buffer();a.bufRecords=this._bufDisplayRecords.buffer();a.bufMetrics=this._bufMetrics.buffer();b.push(a.bufDisplayObjects);b.push(a.bufMetrics);b.push(a.bufRecords);
a.vertexBuffersMap=c;this.destroy()};a.prototype.destroy=function(){this._bufMetrics=this._bufDisplayRecords=this._bufDisplayObjects=this.vertexVectorsMap=null};a.prototype._rollbackDisplayObject=function(){this._bufDisplayObjects.decr(0);this._bufDisplayObjects.seek(this._bufDisplayObjects.length-4);this._currentIndex=this._bufDisplayObjects.length};return a}();a.MeshData=m})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric",
"./util/serializationUtils"],function(m,a,b,l,k){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=[]}a.prototype.copy=function(){var b=new a(this.id);b.set(this);return b};a.prototype.clone=function(){var b=new a(this.id);b.displayRecords=this.displayRecords.map(function(a){return a.clone()});b.metrics=this.metrics.map(function(a){return a.clone()});b.insertAfter=this.insertAfter;return b};a.prototype.set=function(a){this.id=a.id;this.displayRecords=
a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);k.serializeList(a,this.metrics);k.serializeList(a,this.displayRecords);return a};a.deserialize=function(g){var d=g.readInt32(),f=new a(d),d={id:d},c=k.deserializeList(g,l.default);c.length&&(f.metrics=c);f.displayRecords=k.deserializeList(g,b,d);return f};return a}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],
function(m,a,b,l){return function(){function a(a,b,d,f,c){void 0===f&&(f=0);void 0===c&&(c=0);this.id=a;this.geometryType=b;this.materialKey=d;this.minZoom=f;this.maxZoom=c;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!1,configurable:!0});a.prototype.clone=function(){return this.copy()};a.prototype.copy=
function(){var b=new a(this.id,this.geometryType,this.materialKey);b.vertexFrom=this.vertexFrom;b.vertexCount=this.vertexCount;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;b.zOrder=this.zOrder;b.symbolLevel=this.symbolLevel;b.meshData=this.meshData;b.minZoom=this.minZoom;b.maxZoom=this.maxZoom;return b};a.prototype.setMeshDataFromBuffers=function(a,g,d){var f=new b,c;for(c in g){for(var e=g[c].stride,h=g[c].data,k=[],m=l.strideToPackingFactor(e),p=0;p<e*a.vertexCount/m;++p)k[p]=h[p+e*a.vertexFrom/
m];f.vertexData.set(c,k)}for(p=f.indexData.length=0;p<a.indexCount;++p)f.indexData[p]=d[p+a.indexFrom]-a.vertexFrom;f.vertexCount=a.vertexCount;this.meshData=f};a.prototype.readMeshDataFromBuffers=function(a,g){this.meshData?this.meshData.clear():this.meshData=new b;for(var d in a){for(var f=a[d].stride,c=a[d].data,e=[],h=l.strideToPackingFactor(f),k=0;k<f*this.vertexCount/h;++k)e[k]=c[k+f*this.vertexFrom/h];this.meshData.vertexData.set(d,e)}for(k=this.meshData.indexData.length=0;k<this.indexCount;++k)this.meshData.indexData[k]=
g[k+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};a.prototype.writeMeshDataToBuffers=function(a,b,d,f){for(var c in b)for(var e=b[c].stride,g=this.meshData.vertexData.get(c),h=b[c].data,k=l.strideToPackingFactor(e),m=0;m<e*this.meshData.vertexCount/k;++m)h[m+e*a/k]=g[m];for(m=0;m<this.meshData.indexData.length;++m)f[m+d]=this.meshData.indexData[m]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=d;this.indexCount=this.meshData.indexData.length};
a.writeAllMeshDataToBuffers=function(a,b,d){for(var f=0,c=0,e=0;e<a.length;e++){var g=a[e];g.writeMeshDataToBuffers(f,b,c,d);f+=g.vertexCount;c+=g.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);
return a};a.deserialize=function(b,g){var d=b.readInt32(),f=b.readInt32();g=new a(g.id,d,f);g.vertexFrom=b.readInt32();g.vertexCount=b.readInt32();g.indexFrom=b.readInt32();g.indexCount=b.readInt32();g.minZoom=b.readInt32();g.maxZoom=b.readInt32();return g};return a}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(m,a){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=function(){this.vertexData.clear();
this.vertexCount=0;this.indexData=[]};a.prototype.update=function(a,b,h){for(var g in a)this.vertexData.set(g,a[g]);for(g in this.vertexData)null===a[g]&&this.vertexData.delete(g);this.vertexCount=b;this.indexData=h};return a}()})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),function(m,a,b,l,k,h,g){Object.defineProperty(a,
"__esModule",{value:!0});var d=b.getLogger("esri/views/2d/engine/webgl/collisions/Metric");m=function(){function a(a,b,d,f,g){this.id=a;this.range=b;this.boxes=null;this.minZoom=-1;this.placementPadding=this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=l.vec2f32.fromValues(d,f);this.baseZoom=g}a.prototype.add=function(a,b,d){a.x+=b;a.y+=d;this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):this.bounds=
a};a.prototype.computeIndex=function(){var a=Math.floor(this.anchor[1]/k.COLLISION_BUCKET_SIZE);this.xBucket=Math.floor(this.anchor[0]/k.COLLISION_BUCKET_SIZE);this.yBucket=a;a=k.TILE_SIZE/k.COLLISION_BUCKET_SIZE;this.hasVV?this.yOverflow=this.xOverflow=a:(this.xOverflow=Math.min(a,Math.ceil(2*this.bounds.width/k.COLLISION_BUCKET_SIZE)),this.yOverflow=Math.min(a,Math.ceil(2*this.bounds.height/k.COLLISION_BUCKET_SIZE)))};a.prototype.findCollisionDelta=function(a){var c=this.bounds.findCollisionDelta(a.bounds),
b=this.boxes&&this.boxes.length,d=a.boxes&&a.boxes.length;return Math.abs(c)>k.COLLISION_MAX_ZOOM_DELTA||!b&&!d?c:b&&d?this._boxesToBoxes(a):b?this._boxesToBox(a):this._boxToBoxes(a)};a.prototype.computeVVOffset=function(a,b){b||d.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+b);var c=this.size;this.hasVV&&(a=b(a),c=isNaN(a)||null==a||Infinity===a?this.size:a);this._computeOffset(c)};a.prototype.setPlacementOffset=function(a,b,d,f,g){this.hasVV=
a;this.size=b;this.placementPadding=Math.round(d);this.directionX=f;this.directionY=g};a.prototype.clone=function(){var c=new a(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);c.minZoom=this.minZoom;this.bounds&&(c.bounds=this.bounds.clone());this.boxes&&(c.boxes=this.boxes.map(function(a){return a.clone()}));c.xBucket=this.xBucket;c.yBucket=this.yBucket;c.xOverflow=this.xOverflow;c.yOverflow=this.yOverflow;c.hasVV=this.hasVV;c.size=this.size;c.directionX=this.directionX;c.directionY=
this.directionY;c.offsetX=this.offsetX;c.offsetY=this.offsetY;return c};a.prototype._boxToBoxes=function(a){var c=-Infinity,b=0;for(a=a.boxes;b<a.length;b++)var d=this.bounds.findCollisionDelta(a[b]),c=Math.max(d,c);return c};a.prototype._boxesToBox=function(a){for(var c=this.boxes[0].findCollisionDelta(a.bounds),b=1;b<this.boxes.length;b++)var d=this.boxes[b].findCollisionDelta(a.bounds),c=Math.max(d,c);return c};a.prototype._boxesToBoxes=function(a){for(var c=-Infinity,b=0;b<this.boxes.length;b++)for(var d=
this.boxes[b],f=0,g=a.boxes;f<g.length;f++)var h=d.findCollisionDelta(g[f]),c=Math.max(h,c);return c};a.prototype._computeOffset=function(a){this.offsetX=this.directionX*(a/2+this.placementPadding);this.offsetY=this.directionY*(a/2+this.placementPadding)};a.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?1:0);a.push(this.size);a.writeF32(this.directionX);
a.writeF32(this.directionY);a.push(this.offsetX);a.push(this.offsetY);a.push(this.placementPadding);g.serializeList(a,this.boxes);return a};a.deserialize=function(c){var b=c.readInt32(),d=h.default.deserialize(c),f=c.readInt32(),k=c.readInt32(),l={from:f,count:k},m=c.readInt32(),u=c.readInt32(),y=c.readInt32(),f=c.readInt32(),k=c.readInt32(),w=c.readF32(),B=c.readF32(),z=c.readInt32(),A=c.readInt32(),C=c.readInt32();c=g.deserializeList(c,h.default);b=new a(b,l,m,u,y);b.bounds=d;b.boxes=c;b.setPlacementOffset(!!f,
k,C,w,B);b.offsetX=z;b.offsetY=A;b.computeIndex();f||b._computeOffset(k);return b};return a}();a.default=m})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a,b,d,f){this.center=l.vec2f32.fromValues(a,b);this.centerT=l.vec2f32.create();this.halfWidth=d/2;this.halfHeight=f/2;this.width=
d;this.height=f}Object.defineProperty(a.prototype,"x",{get:function(){return this.center[0]},set:function(a){this.center[0]=a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"blX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"blY",{get:function(){return this.center[1]+
this.halfHeight},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"trX",{get:function(){return this.center[0]-this.halfWidth},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"trY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xmin",{get:function(){return this.x-this.halfWidth},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xmax",{get:function(){return this.x+this.halfWidth},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"ymin",{get:function(){return this.y-this.halfHeight},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"ymax",{get:function(){return this.y+this.halfHeight},enumerable:!1,configurable:!0});a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};a.prototype.findCollisionDelta=
function(a,g){void 0===g&&(g=4);return b.log2(Math.min((a.halfWidth+this.halfWidth+g)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight+g)/Math.abs(a.centerT[1]-this.centerT[1])))};a.prototype.extend=function(a){var b=Math.min(this.xmin,a.xmin),d=Math.min(this.ymin,a.ymin),f=Math.max(this.xmax,a.xmax)-b;a=Math.max(this.ymax,a.ymax)-d;this.width=f;this.height=a;this.halfWidth=f/2;this.halfHeight=a/2;this.x=b+f/2;this.y=d+a/2};a.deserialize=function(b){var g=b.readF32(),d=b.readF32(),
f=b.readInt32();b=b.readInt32();return new a(g,d,f,b)};return a}();a.default=m})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.deserializeList=a.serializeList=void 0;a.serializeList=function(a,l){if(null===l)a.push(0);else{a.push(l.length);for(var b=0;b<l.length;b++)l[b].serialize(a);return a}};a.deserializeList=function(a,l,k){for(var b=a.readInt32(),b=Array(b),g=0;g<b.length;g++)b[g]=
l.deserialize(a,k);return b}})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();a.default=m})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require",
"exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(a,b){this._pos=0;b=b?this._roundToNearest(b,a.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(b);this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!1,configurable:!0});a.prototype._roundToNearest=function(a,b){a=Math.round(a);return a+(b-a%b)};a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=
this._roundToNearest(1.5*(this._array.byteLength+a*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);a=new ArrayBuffer(a);var b=new this._ctor(a);b.set(this._buffer,0);this._array=a;this._buffer=b}};a.prototype.writeF32=function(a){this._ensureSize(1);var b=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return b};a.prototype.push=function(a){this._ensureSize(1);var b=this._pos;this._buffer[this._pos++]=a;return b};a.prototype.writeFixed=function(a){this._buffer[this._pos++]=
a};a.prototype.setValue=function(a,b){this._buffer[a]=b};a.prototype.getValue=function(a){return this._buffer[a]};a.prototype.incr=function(a){this._buffer[a]++};a.prototype.decr=function(a){this._buffer[a]--};a.prototype.writeRegion=function(a){this._ensureSize(a.length);var b=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return b};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.toArray=function(){for(var a=this._array,b=[],
h=0;h<a.byteLength/4;h++)b.push(a[h]);return b};a.prototype.seek=function(a){this._pos=a};a.prototype.destroy=function(){this._buffer=this._array=null};return a}();a.default=m})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.VertexVectors=void 0;var h=function(){function a(a,b){this.data=a;this.stride=b}Object.defineProperty(a.prototype,"vertexCount",
{get:function(){var a=this.data.length/(this.stride/4);a!==(a|0)&&console.debug("Corrupted stride");return a},enumerable:!1,configurable:!0});a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();a.default=h;m=function(){function a(a,f,c){void 0===c&&(c=!1);this.geometryType=a;this.indexVector=new k.default(Uint32Array,6*f);this.namedVectors={};a=b.getStrides(a,c);for(var d in a){c=a[d];var g=void 0;switch(c%
4){case 0:case 2:g=new k.default(Uint32Array,c*f);break;case 1:case 3:g=new k.default(Uint8Array,c*f)}this.namedVectors[d]=new h(g,c)}}a.prototype.get=function(a){return this.namedVectors[a].data};a.prototype.getVector=function(a){return this.namedVectors[a]};a.prototype.transfer=function(a,b){var c=this.indexVector.buffer(),d={};b.push(c);for(var f in this.namedVectors){var g=this.namedVectors[f];d[f]={};g.transfer(d[f],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=d;this.destroy()};
a.prototype.intoBuffers=function(){var a=l.VertexBuffers.fromVertexVectors(this);this.destroy();return a};a.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return a}();a.VertexVectors=m})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.VertexBuffers=void 0;var l=function(){function a(a,b,d){this.data=a;this.stride=b;this.vertexCount=d}a.decode=function(h){var g=
b.allocateTypedArrayBufferwithData(h.data,h.stride);return new a(g,h.stride,h.vertexCount)};a.fromVertexVector=function(h){var g=b.allocateTypedArrayBufferwithData(h.data.buffer(),h.stride);return new a(g,h.stride,h.vertexCount)};return a}();a.default=l;m=function(){function a(a,b,d){this.geometryType=a;this.indexBuffer=new Uint32Array(b);this.namedBuffers=d}a.decode=function(b){var g=b.geometryType,d=b.indexBuffer,f={},c;for(c in b.namedBuffers)f[c]=l.decode(b.namedBuffers[c]);return new a(g,d,f)};
a.fromVertexVectors=function(b){var g=b.geometryType,d=b.indexVector.buffer(),f={},c;for(c in b.namedVectors)f[c]=l.fromVertexVector(b.namedVectors[c]);return new a(g,d,f)};return a}();a.VertexBuffers=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../collisions/Metric ../../materialKey/MaterialKey ./meshUtils ./segmentUtils ./WGLTextTemplate".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w){Object.defineProperty(a,"__esModule",{value:!0});var B=k.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),z=function(a){var c=new Map;return function(b){c.has(b)||c.set(b,a(b));return c.get(b)}}(function(a){var c=0;if(0===a)return Infinity;for(;!(a%2);)c++,a/=2;return c}),A=function(a,c){return x.i1616to32(Math.round(8*a),Math.round(8*c))};m=function(a){function k(b,d,g,k){var l=a.call(this,b,g.font.size,g.haloSize||0,g.color&&e.premultiplyAlphaRGBAArray(g.color)||
0,g.haloColor&&e.premultiplyAlphaRGBAArray(g.haloColor)||0,g.horizontalAlignment,g.verticalAlignment,u.isMapAligned(d.labelPlacement)?1:0,g.font.decoration,!1,g.angle||0,g.xoffset,g.yoffset,g.lineWidth,g.lineHeight,null,null)||this;l._outLineLabelAngle=0;l._refPlacementPadding=0;l._refPlacementDirX=0;l._refPlacementDirY=0;l._refOffsetX=0;l._refOffsetY=0;l.geometryType=t.WGLGeometryType.LABEL;var m;m=!!d.minScale&&k.scaleToZoom(d.minScale)||0;m=h.clamp(m,0,25.5);k=!!d.maxScale&&k.scaleToZoom(d.maxScale)||
255;k=h.clamp(k,0,25.5);d=c.getAlignmentFromPlacement(d.labelPlacement);var p=d[1];l._xAlignD=d[0];l._yAlignD=p;l._minZoom=m;l._maxZoom=k;l._refPlacementPadding=f.pt2px(g.haloSize)+n.TEXT_PLACEMENT_PADDING;b=q.LabelMaterialKey.load(b);b.sdf=!0;l._materialKey=b.data;return l}b.__extends(k,a);k.fromLabelClass=function(a,c){if("center-along"===a.labelPlacement){var b=a.symbol;b.xoffset=0;b.yoffset=0;b.angle=0;b.font.decoration="none"}return new k(a.materialKey,a,a.symbol,c)};Object.defineProperty(k.prototype,
"_shapedBox",{get:function(){return d.unwrap(this._shapingInfo).bounds},enumerable:!1,configurable:!0});k.prototype.bindReferenceTemplate=function(a){var b=c.getXDirection(this._xAlignD),e=c.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(d.isNone(a))this._refSymbolAndPlacementOffset=x.i8888to32(0,0,Math.floor(127*b+127),Math.floor(127*e+127));else{if("circle"===a.boundsType&&(b||e))var f=Math.sqrt(b*b+e*e),b=b/f,e=e/f;f=Math.max(a.height,a.width);this._refSymbolAndPlacementOffset=
x.i8888to32(4*this._refPlacementPadding,f,Math.floor(127*b+127),Math.floor(127*e+127));this._referenceSize=f;this._refPlacementDirX=b;this._refPlacementDirY=e;this._refOffsetX=a.xOffset;this._refOffsetY=a.yOffset}};k.prototype.writeMesh=function(a,c,b,e,f,g){if(!d.isNone(this._shapingInfo)){var h=[],k=this._shapingInfo;if(b="esriGeometryPolygon"===b.geometryType?b.readLegacyCentroid():b.readLegacyGeometry()){this.current={out:a,outVecs:c,outMetrics:h,inId:f,inShaping:k,zoomLevel:g};switch(e){case "esriGeometryPolyline":this._placeLineLabels(b);
break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(b);break;default:c="Geometry of type "+e+" is not supported",void 0===c&&(c="mapview-labeling"),B.error(new l(c,"mapview-labeling"))}a.writeMetrics(this.current.outMetrics)}}};k.prototype._isVisible=function(a,c){var b=Math.floor(10*this.current.zoomLevel);return Math.floor(10*a)<=b&&b<=Math.floor(10*c)};k.prototype._placePointLabels=function(a){var c=this.current;this._writeGlyphs(c.out,c.outVecs,c.inId,a,c.outMetrics)};
k.prototype._placeLineLabels=function(a){a=y.smoothPaths(a.paths,this.current.inShaping.bounds.width);for(var c=this._placeSubdivGlyphs.bind(this),b=(this._shapedBox.width+128)/4,d=0;d<a.length;d++)y.pathDivide(a[d],b,c)};k.prototype._placeSubdivGlyphs=function(a,c,b,d){var e=z(c);b=g.log2(Math.min(b,d-b)/(4+this._shapedBox.width/4/2));e=Math.max(this._minZoom,this.current.zoomLevel+2-(0===c?b:Math.min(e,b)));b=this._shapedBox.width/2*Math.pow(2,this.current.zoomLevel-e);this.current.inShaping.isMultiline?
0===c&&this._placeStraight(a,e):this._placeCurved(a,e,b)};k.prototype._placeStraight=function(a,c){var b=this.current;this._writeGlyphs(b.out,b.outVecs,b.inId,a,b.outMetrics,c)};k.prototype._placeCurved=function(a,c,b){var d={from:this.current.out.currentDisplayRecordCount(),count:-1},d=new p.default(this.current.inId,d,a.x,a.y,c),e=a.clone(),f=(180/Math.PI*a.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*a.angle%360*(254/360));this._placeFirst(e,d,c,1);this._placeBack(a,e,d,c,b,1);
this._placeForward(a,e,d,c,b,1);this._outLineLabelAngle=Math.round(254/360*f);this._placeFirst(e,d,c,0);this._placeBack(a,e,d,c,b,0);this._placeForward(a,e,d,c,b,0);d.range.count=this.current.out.currentDisplayRecordCount()-d.range.from;d.bounds&&this.current.outMetrics.push(d)};k.prototype._placeBack=function(a,c,b,d,e,f){var g=a.clone();for(a=a.backwardLength+0;g.prev()&&!(a>=e);)this._placeOnSegment(g,c,b,a,d,-1,f),a+=g.length+0};k.prototype._placeForward=function(a,c,b,d,e,f){var g=a.clone();
for(a=a.remainingLength+0;g.next()&&!(a>=e);)this._placeOnSegment(g,c,b,a,d,1,f),a+=g.length+0};k.prototype._placeFirst=function(a,c,b,d){for(var e=this.current.inShaping,f=e.glyphs,h=this.current.zoomLevel,k=this.current,l=k.out,n=k.outVecs,k=k.inId,m=A(a.x,a.y),p=0;p<f.length;p++){var q=f[p],u=q.x>e.bounds.x?d:1-d,u=Math.max(0,h+g.log2(Math.abs(q.x+q.width/2-e.bounds.x)/(u*a.remainingLength+(1-u)*a.backwardLength+0))),u=Math.max(b,u);q.maxZoom=25;q.angle=a.angle+(1-d)*Math.PI;q.minZoom=u;this._writeGlyph(l,
n,q,k,m);d&&this._isVisible(q.minZoom,q.maxZoom)&&c.add(q.bounds,0,0)}};k.prototype._placeOnSegment=function(a,c,b,d,e,f,h){for(var k=this.current.inShaping.glyphs,l=this.current,n=l.out,m=l.outVecs,l=l.inId,p=this.current.inShaping,q=this.current.zoomLevel,u=A(a.x+a.dx/a.length*-f*d,a.y+a.dy/a.length*-f*d),w=0;w<k.length;w++){var t=k[w],y=t.x>p.bounds.x?h:1-h;if(y&&1===f||!y&&-1===f){var x=Math.abs(t.x+t.width/2-p.bounds.x),y=Math.max(0,q+g.log2(x/d)-.1),x=Math.max(e,q+g.log2(x/(d+a.length+0)));
0!==y&&(t.angle=a.angle+(1-h)*Math.PI,t.minZoom=x,t.maxZoom=y,this._writeGlyph(n,m,t,l,u),h&&this._isVisible(t.minZoom,t.maxZoom)&&b.add(t.bounds,a.x-c.x,a.y-c.y))}}};k.prototype._writeGlyphs=function(a,c,b,e,f,g){void 0===g&&(g=this._minZoom);var h=this._shapingInfo;if(!(d.isNone(h)||0>e.x||512<=e.x||0>e.y||512<=e.y)){var k=a.currentDisplayRecordCount(),l=A(e.x+this._refOffsetX,e.y-this._refOffsetY);e=new p.default(b,{from:k,count:-1},e.x+this._refOffsetX,e.y-this._refOffsetY,g);for(var k=0,n=h.glyphs;k<
n.length;k++){var m=n[k];m.minZoom=g;m.maxZoom=this._maxZoom;this._writeGlyph(a,c,m,b,l)}e.range.count=a.currentDisplayRecordCount()-e.range.from;e.bounds=h.boundsT;a=q.LabelMaterialKey.load(this._materialKey);e.setPlacementOffset(a.vvSizeFieldStops||a.vvSizeMinMaxValue||a.vvSizeScaleStops||a.vvSizeUnitValue,this._referenceSize,this._refPlacementPadding,this._refPlacementDirX,this._refPlacementDirY);f.push(e)}};k.prototype._writeGlyph=function(a,c,b,d,e){var f=q.MaterialKeyBase.load(this._materialKey);
f.textureBinding=b.textureBinding;var g=c.indexVector.length,h=c.getVector("geometry").vertexCount,k=this._writeIndices(c);c=this._writeVertex(c,d,e,b);a.writeDisplayRecord(this.geometryType,f.data,h,c,g,k)};k.prototype._writeVertexCommon=function(a,c,b,d){var e=this._color,f=this._haloColor,g=x.i8888to32(0,0,this._size,this._haloSize);d=x.i8888to32(Math.floor(10*Math.max(d.minZoom,this._minZoom)),Math.floor(10*Math.min(d.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);a.push(b);a.push(c);a.push(e);
a.push(f);a.push(g);a.push(this._refSymbolAndPlacementOffset);a.push(d)};return k}(w.default);a.default=m})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.getJustification=a.getYDirection=a.getXDirection=a.getAlignmentFromPlacement=a.getYAnchorDirection=a.getXAnchorDirection=a.VAlign=a.HAlign=void 0;var b;(function(a){a[a.Left=-1]="Left";a[a.Center=0]="Center";a[a.Right=1]="Right"})(b=a.HAlign||
(a.HAlign={}));var l;(function(a){a[a.Top=1]="Top";a[a.Center=0]="Center";a[a.Bottom=-1]="Bottom";a[a.Baseline=2]="Baseline"})(l=a.VAlign||(a.VAlign={}));a.getXAnchorDirection=function(a){switch(a){case "left":return b.Left;case "right":return b.Right;case "center":case "justify":return b.Center}};a.getYAnchorDirection=function(a){switch(a){case "top":return l.Top;case "middle":return l.Center;case "baseline":return l.Baseline;case "bottom":return l.Bottom}};a.getAlignmentFromPlacement=function(a){switch(a){case "above-left":return[b.Right,
l.Bottom];case "above-center":case "above-along":return[b.Center,l.Bottom];case "above-right":return[b.Left,l.Bottom];case "center-left":return[b.Right,l.Center];case "center-center":case "center-along":return[b.Center,l.Center];case "center-right":return[b.Left,l.Center];case "below-left":return[b.Right,l.Top];case "below-center":case "below-along":return[b.Center,l.Top];case "below-right":return[b.Left,l.Top];case "always-horizontal":return[b.Center,l.Baseline];default:return console.debug("Found invalid placement type "+
a),[b.Center,l.Center]}};a.getXDirection=function(a){switch(a){case b.Right:return-1;case b.Center:return 0;case b.Left:return 1;default:return console.debug("Found invalid horizontal alignment "+a),0}};a.getYDirection=function(a){switch(a){case l.Top:return 1;case l.Center:return 0;case l.Bottom:case l.Baseline:return-1;default:return console.debug("Found invalid vertical alignment "+a),0}};a.getJustification=function(a){switch(a){case "left":return b.Left;case "right":return b.Right;case "center":case "justify":return b.Center}}})},
"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["require","exports","../../../../../../core/maybe","./util"],function(m,a,b,l){function k(a){return a.length-1}function h(a){for(var c=0,b=0;b<k(a);b++)c+=g(a,b);return c}function g(a,b,d){void 0===d&&(d=1);b=a[b+1];a=b[0];b=b[1];return Math.sqrt(a*a+b*b)*d}function d(a,e,f,g,h){if(!(f<e)){var c=g.clone().seek(f/2);b.isNone(c)||(a(c.clone(),f,h),f=(f-e)/2,c=b.unwrap(c.seek(e/2)),d(a,e,f,g,h+1),d(a,e,f,c,h+1))}}Object.defineProperty(a,
"__esModule",{value:!0});a.smoothPaths=a.pathSubdivide=a.pathDivide=a.SegmentCursor=a.segmentLength=a.pathLength=a.segmentCount=a.segmentAt=void 0;a.segmentAt=function(a,b){return a[b+1]};a.segmentCount=k;a.pathLength=h;a.segmentLength=g;var f=function(){function a(a,c,b,d,f){this._segments=a;this._index=c;this._distance=b;this._xStart=d;this._yStart=f;this._done=!1}a.create=function(c){return new a(c,0,0,c[0][0],c[0][1])};a.prototype.clone=function(){return new a(this._segments,this._index,this._distance,
this.xStart,this.yStart)};a.prototype.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||0===a._distance)};a.prototype.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=a._distance};a.prototype.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};Object.defineProperty(a.prototype,"_segment",{get:function(){return this._segments[this._index+
1]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){var a=this.dy,c=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(c=2*Math.PI-c);return c},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xStart",{get:function(){return this._xStart},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"yStart",{get:function(){return this._yStart},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"x",{get:function(){return this.xStart+
this.distance*this.dx},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.yStart+this.distance*this.dy},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"dx",{get:function(){return this._segment[0]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"dy",{get:function(){return this._segment[1]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xMidpoint",{get:function(){return this.xStart+.5*this.dx},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"yMidpoint",{get:function(){return this.yStart+.5*this.dy},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xEnd",{get:function(){return this.xStart+this.dx},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"yEnd",{get:function(){return this.yStart+this.dy},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"length",{get:function(){var a=this.dx,c=this.dy;return Math.sqrt(a*a+c*c)},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"remainingLength",{get:function(){return this.length*(1-this._distance)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"backwardLength",{get:function(){return this.length*this._distance},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"distance",{get:function(){return this._distance},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"done",{get:function(){return this._done},enumerable:!1,configurable:!0});
a.prototype.hasPrev=function(){return 0<=this._index-1};a.prototype.hasNext=function(){return this._index+1<k(this._segments)};a.prototype.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};a.prototype.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};a.prototype._seekBackwards=function(a,c){var b=this.backwardLength;
if(a<=b)return this._distance=(b-a)/this.length,this;for(b=this.backwardLength;this.prev();){if(b+this.length>a)return this._seekBackwards(a-b);b+=this.length}this._distance=0;return c?this:null};a.prototype.seek=function(a,c){void 0===c&&(c=!1);if(0>a)return this._seekBackwards(Math.abs(a),c);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;for(var b=this.remainingLength;this.next();){if(b+this.length>a)return this.seek(a-b,c);b+=this.length}this._distance=
1;return c?this:null};return a}();a.SegmentCursor=f;a.pathDivide=function(a,b,d){var c=h(a);a=f.create(a);var e=c/2,g=Math.floor((c-b)/2/b);a.seek(e-g*b);for(var k=-g;k<=g;k++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&d(a.clone(),k,e+k*b,c),a.seek(b)};a.pathSubdivide=function(a,b,g){d(g,b,h(a),f.create(a),0)};a.smoothPaths=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=[];e.push(d[0]);for(var f=1;f<d.length;f++){var g=e[f-1],h=g[0],g=g[1],h=h+d[f][0],g=g+d[f][1];e.push([h,g])}h=e;g=b;if(!(0>=g||(d=
h.length,3>d))){var f=[],k=0;f.push(0);for(var m=1;m<d;m++)k+=l.dist(h[m],h[m-1]),f.push(k);g=Math.min(g,.2*k);k=[];k.push(h[0][0]);k.push(h[0][1]);var B=h[d-1][0],z=h[d-1][1],m=l.sub([0,0],h[0],h[1]);l.normalize(m);h[0][0]+=g*m[0];h[0][1]+=g*m[1];l.sub(m,h[d-1],h[d-2]);l.normalize(m);h[d-1][0]+=g*m[0];h[d-1][1]+=g*m[1];for(m=1;m<d;m++)f[m]+=g;f[d-1]+=g;for(var A=.5*g,m=1;m<d-1;m++){for(var C=0,E=0,D=0,F=m-1;0<=F&&!(f[F+1]<f[m]-A);F--){var H=A+f[F+1]-f[m],I=f[F+1]-f[F],G=f[m]-f[F]<A?1:H/I;if(1E-6>
Math.abs(G))break;var K=G*G,L=G*H-.5*K*I,O=G*I/g,P=h[F+1],N=h[F][0]-P[0],S=h[F][1]-P[1],C=C+O/L*(P[0]*G*H+.5*K*(H*N-I*P[0])-K*G*I*N/3),E=E+O/L*(P[1]*G*H+.5*K*(H*S-I*P[1])-K*G*I*S/3),D=D+O}for(F=m+1;F<d&&!(f[F-1]>f[m]+A);F++){H=A-f[F-1]+f[m];I=f[F]-f[F-1];G=f[F]-f[m]<A?1:H/I;if(1E-6>Math.abs(G))break;K=G*G;L=G*H-.5*K*I;O=G*I/g;P=h[F-1];N=h[F][0]-P[0];S=h[F][1]-P[1];C+=O/L*(P[0]*G*H+.5*K*(H*N-I*P[0])-K*G*I*N/3);E+=O/L*(P[1]*G*H+.5*K*(H*S-I*P[1])-K*G*I*S/3);D+=O}k.push(C/D);k.push(E/D)}k.push(B);k.push(z);
for(F=m=0;m<d;m++)h[m][0]=k[F++],h[m][1]=k[F++]}d=[];d.push(e[0]);for(f=1;f<e.length;f++)h=e[f-1],m=h[0],k=h[1],g=e[f],h=g[0],g=g[1],d.push([Math.round(h-m),Math.round(g-k)]);a[c]=d}return a}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),function(m,a,b,l,k,h,g,d,f,c){Object.defineProperty(a,
"__esModule",{value:!0});m=function(a){function d(c,b,d,e,f,h,n,m,z,A,C,E,D,F,H,I,G,K){void 0===K&&(K=!1);var p=a.call(this)||this;p._xOffset=l.pt2px(E);p._yOffset=l.pt2px(D);p._decoration=z||"none";p._color=e;p._haloColor=f;p._haloSize=Math.min(Math.floor(5*l.pt2px(l.toPt(d))),127);p._size=Math.min(Math.round(l.pt2px(b)),127);b=Math.min(Math.round(l.pt2px(b)),127);p._referenceSize=Math.round(Math.sqrt(256*b));p._scale=p._size/24;p._angle=C;p._justify=k.getJustification(h||"center");p._xAlignD=k.getXAnchorDirection(h||
"center");p._yAlignD=k.getYAnchorDirection(n||"baseline");p._baseline="baseline"===(n||"baseline");p._bitset=(1===m?1:0)|(A?1:0)<<1;c=g.MaterialKeyBase.load(c);c.sdf=!0;p._materialKey=c.data;p._lineWidth=l.pt2px(F)||512;p._lineHeight=H||1;p._textPlacement=I;p.effects=G;p._isCIM=K;return p}b.__extends(d,a);d.fromText=function(a,b){var e=new d(a.materialKey,a.font.size,a.haloSize||0,a.color&&h.premultiplyAlphaRGBAArray(a.color)||0,a.haloColor&&h.premultiplyAlphaRGBAArray(a.haloColor)||0,a.horizontalAlignment,
a.verticalAlignment,0,a.font.decoration,!1,a.angle||0,a.xoffset,a.yoffset,a.lineWidth,a.lineHeight,null,null,!1);a=c.bidiText(a.text)[1];e.bindTextInfo(b,a);return e};d.fromCIMText=function(a,b){var e=a.scaleFactor||1,e=new d(a.materialKey,a.size*a.sizeRatio*e,a.outlineSize*a.sizeRatio,h.premultiplyAlphaRGBA(a.color),h.premultiplyAlphaRGBA(a.outlineColor),a.horizontalAlignment,a.verticalAlignment,a.alignment,a.decoration,a.colorLocked,a.angle,a.offsetX*a.sizeRatio*e,a.offsetY*a.sizeRatio*e,512,1,
a.markerPlacement,a.effects,!0);a=c.bidiText(a.text)[1];e.bindTextInfo(b,a);return e};return d}(d.default(f.default));a.default=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return function(a){function m(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b._isCIM=!1;b.geometryType=f.WGLGeometryType.TEXT;b._aux=c.i8888to32(0,0,b._referenceSize,b._bitset);return b}b.__extends(m,a);m.prototype.bindTextInfo=function(a,b){var c=this;this._shapingInfo=a&&a.length?l.andThen(a,function(a){return n.shapeGlyphs(a,b,{scale:c._scale,angle:c._angle,
xOffset:c._xOffset,yOffset:c._yOffset,hAlign:c._xAlignD,vAlign:c._yAlignD,maxLineWidth:Math.max(32,Math.min(c._lineWidth,512)),lineHeight:d.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(c._lineHeight,4)),decoration:c._decoration,isCIM:c._isCIM})}):null};m.prototype.writeMeshWithGeometry=function(a,c,b,d,e,f){var g=this;if(l.isSome(this._textPlacement))return b=null!==f&&void 0!==f?f:b.readLegacyGeometry(),this._writePlacedText(a,c,e,b);if(b=f?h.deltaDecodeGeometry(h.convertFromGeometry(f),2):"esriGeometryPolygon"===
d?b.readCentroid():b.readUnquantizedGeometry()){if(b.isPoint)return b=b.coords,this._writeGlyphs(a,c,e,{x:b[0],y:b[1]});b.forEachVertex(function(b,d){return g._writeGlyphs(a,c,e,{x:b,y:d})})}};m.prototype._writePlacedText=function(a,b,d,f){var h=this._shapingInfo;if(!l.isNone(h)){var n=e.MaterialKeyBase.load(this._materialKey),m=l.unwrap(this._textPlacement);if(f=g.CIMMarkerPlacementHelper.getPlacement(f,m,k.pt2px(1))){var p;for(p=f.next();null!=p;){m=c.i1616to32(Math.round(8*p.tx),Math.round(8*p.ty));
p=p.getAngle();h.setRotation(p);for(var q=0,u=h.glyphs;q<u.length;q++){var w=u[q];n.textureBinding=w.textureBinding;var t=b.getVector("geometry").vertexCount,y=b.indexVector.length,x=this._writeIndices(b),w=this._writeVertex(b,d,m,w);a.writeDisplayRecord(this.geometryType,n.data,t,w,y,x)}h.setRotation(-p);p=f.next()}}}};m.prototype._writeGlyphs=function(a,b,d,f){var g=this._shapingInfo;if(!l.isNone(g)){var h=e.MaterialKeyBase.load(this._materialKey);f=c.i1616to32(Math.round(8*f.x),Math.round(8*f.y));
for(var k=0,g=g.glyphs;k<g.length;k++){var n=g[k];h.textureBinding=n.textureBinding;var m=b.getVector("geometry").vertexCount,p=b.indexVector.length,q=this._writeIndices(b),n=this._writeVertex(b,d,f,n);a.writeDisplayRecord(this.geometryType,h.data,m,n,p,q)}}};m.prototype._writeVertexCommon=function(a,b,d,e){e=this._color;var f=this._haloColor,g=c.i8888to32(0,0,this._referenceSize,this._bitset),h=c.i8888to32(0,0,this._size,this._haloSize);a.push(d);a.push(b);a.push(e);a.push(f);a.push(h);a.push(g)};
m.prototype._writeVertex=function(a,b,c,d){a=a.get("geometry");this._writeVertexCommon(a,b,c,d);a.push(d.offsets.upperLeft);a.push(d.texcoords.upperLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.upperRight);a.push(d.texcoords.upperRight);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerLeft);a.push(d.texcoords.lowerLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerRight);a.push(d.texcoords.lowerRight);return 4};m.prototype._writeIndices=function(a){var b=a.getVector("geometry").vertexCount;
a=a.indexVector;a.push(b+0);a.push(b+1);a.push(b+2);a.push(b+1);a.push(b+3);a.push(b+2);return 6};return m}(a)}})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["require","exports","../CIMCursor","../CIMOperators"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});a.CIMMarkerPlacementHelper=void 0;m=function(){function a(){}a.getPlacement=function(a,g,d){var f=l.getPlacementOperator(g);if(!f)return null;a=b.cloneAndDecodeGeometry(a);return f.execute(a,
g,d)};return a}();a.CIMMarkerPlacementHelper=m})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(m,a,b,l,k,h,g,d,f,c){Object.defineProperty(a,"__esModule",{value:!0});a.shapeGlyphs=
a.ShapingInfo=a.ShapedGlyph=void 0;var e=Math.PI/180,n=function(){function a(a,b,c,d){this._rotationT=l.mat2df32.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;var e=c.rect,f=new Float32Array(8);a*=d;b*=d;var g=c.code?e.width*d:c.metrics.width,h=c.code?e.height*d:c.metrics.height;f[0]=a;f[1]=b;f[2]=a+g;f[3]=b;f[4]=a;f[5]=b+h;f[6]=a+g;f[7]=b+h;this._data=f;this._setTextureCoords(e);this._scale=d;this._mosaic=c;this.x=a;this.y=b}Object.defineProperty(a.prototype,"width",{get:function(){return this._mosaic.metrics.width*
this._scale},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"mosaic",{get:function(){return this._mosaic},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a;b.mat2d.identity(this._rotationT);b.mat2d.rotate(this._rotationT,this._rotationT,-a);this._setOffsets(this._data)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xTopLeft",{get:function(){return this._data[0]},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"yTopLeft",{get:function(){return this._data[1]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xBottomRight",{get:function(){return this._data[6]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"yBottomRight",{get:function(){return this._data[7]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"texcoords",{get:function(){return this._texcoords},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"textureBinding",{get:function(){return this._mosaic.textureBinding},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"offsets",{get:function(){this._offsets||this._setOffsets(this._data);return this._offsets},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"char",{get:function(){return String.fromCharCode(this._mosaic.code)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"code",{get:function(){return this._mosaic.code},enumerable:!1,configurable:!0});
Object.defineProperty(a.prototype,"bounds",{get:function(){var a=this._mosaic.metrics,d=a.width*this._scale,e=Math.abs(a.height)*this._scale,a=new Float32Array(8);a[0]=this.x;a[1]=this.y;a[2]=this.x+d;a[3]=this.y;a[4]=this.x;a[5]=this.y+e;a[6]=this.x+d;a[7]=this.y+e;d=b.mat2d.multiply(l.mat2df32.create(),this._rotationT,this._T);l.mat2df32.transformMany(a,a,d);for(var e=d=Infinity,f=0,g=0,h=0;4>h;h++)var k=a[2*h],n=a[2*h+1],d=Math.min(d,k),e=Math.min(e,n),f=Math.max(f,k),g=Math.max(g,n);a=f-d;g-=
e;return new c.default(d+a/2,e+g/2,a,g)},enumerable:!1,configurable:!0});a.prototype.setTransform=function(a){this._T=a;this._offsets=null};a.prototype._setOffsets=function(a){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var c=this._offsets,e=new Float32Array(8),f=b.mat2d.multiply(l.mat2df32.create(),this._rotationT,this._T);l.mat2df32.transformMany(e,a,f);c.upperLeft=d.i1616to32(8*e[0],8*e[1]);c.upperRight=d.i1616to32(8*e[2],8*e[3]);c.lowerLeft=d.i1616to32(8*
e[4],8*e[5]);c.lowerRight=d.i1616to32(8*e[6],8*e[7])};a.prototype._setTextureCoords=function(a){var b=a.x,c=a.y,e=a.width;a=a.height;this._texcoords={upperLeft:d.i1616to32(b,c),upperRight:d.i1616to32(b+e,c),lowerLeft:d.i1616to32(b,c+a),lowerRight:d.i1616to32(b+e,c+a)}};return a}();a.ShapedGlyph=n;var t=function(a,b){return{code:0,page:0,sdf:!0,rect:new f.default(0,0,11,8),textureBinding:b,metrics:{advance:0,height:4,width:a,left:0,top:0}}},x=function(){function a(a,b,c){this._rotation=0;this._decorate(a,
b,c);this.glyphs=a;this.bounds=this._createBounds(a);this.isMultiline=1<b.length;this._hasRotation=0!==c.angle;this._T=this._createGlyphTransform(this.bounds,c);for(b=0;b<a.length;b++)a[b].setTransform(this._T)}a.prototype.setRotation=function(a){if(0!==a||0!==this._rotation){this._rotation=a;var c=this._T;a=b.mat2d.fromRotation(l.mat2df32.create(),a);b.mat2d.multiply(c,a,c);c=0;for(a=this.glyphs;c<a.length;c++)a[c].setTransform(this._T)}};a.prototype._decorate=function(a,b,c){if(c.decoration&&"none"!==
c.decoration&&a.length){var d=c.scale;c="underline"===c.decoration?30:20;for(var e=a[0].textureBinding,f=0;f<b.length;f++){var g=b[f];a.push(new n(g.startX*d,g.startY*d+c*d,t((g.width+g.glyphWidthEnd)*d,e),1))}}};Object.defineProperty(a.prototype,"boundsT",{get:function(){var a=this.bounds,b=k.vec2.set(h.vec2f32.create(),a.x,a.y);k.vec2.transformMat2d(b,b,this._T);return this._hasRotation?(a=Math.max(a.width,a.height),new c.default(b[0],b[1],a,a)):new c.default(b[0],b[1],a.width,a.height)},enumerable:!1,
configurable:!0});a.prototype._createBounds=function(a){for(var b=Infinity,d=Infinity,e=0,f=0,g=0;g<a.length;g++)var h=a[g],b=Math.min(b,h.xTopLeft),d=Math.min(d,h.yTopLeft),e=Math.max(e,h.xTopLeft+h.width),f=Math.max(f,h.yBottomRight);a=e-b;f-=d;return new c.default(b+a/2,d+f/2,a,f)};a.prototype._createGlyphTransform=function(a,c){var d=e*c.angle,f=l.mat2df32.create(),g=h.vec2f32.create();b.mat2d.translate(f,f,k.vec2.set(g,c.xOffset,-c.yOffset));c.isCIM?b.mat2d.rotate(f,f,d):(b.mat2d.translate(f,
f,k.vec2.set(g,a.x,a.y)),b.mat2d.rotate(f,f,d),b.mat2d.translate(f,f,k.vec2.set(g,-a.x,-a.y)));return f};return a}();a.ShapingInfo=x;var p=function(){return function(a,b,c,d,e,f){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,c));this.end=Math.max(0,Math.max(b,c));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=d;this.yMin=e;this.yMax=f}}();a.shapeGlyphs=function(a,b,c){var d=c.scale,e=[],f=[],h=1/c.scale*c.maxLineWidth,k=b?a.length-1:0,
l=b?-1:a.length;b=b?-1:1;for(var m=k,q=0,u=0,t=m,y=t,K=0,L=Infinity,O=0;m!==l;){var P=a[m],N=P.code,P=P.metrics,S=Math.abs(P.top);10!==N&&32!==N&&(L=Math.min(L,S),O=Math.max(O,S+P.height));10===N?(m!==k&&(f.push(new p(a,t,m-b,q,L,O)),L=Infinity,O=0),q=0,t=m+b,y=m+b,u=0):32===N?(y=m+b,u=0,K=P.advance,q+=P.advance):(q>h&&(y!==t?(N=y-2*b,q-=K,f.push(new p(a,t,N,q-u,L,O)),L=Infinity,O=0,t=y,q=u):(f.push(new p(a,t,m-b,q,L,O)),L=Infinity,O=0,y=t=m,q=0)),q+=P.advance,u+=P.advance);m+=b}h=new p(a,t,m-b,q,
L,O);0<=h.start&&h.end<a.length&&f.push(h);for(h=0;h<f.length;h++);k=f[0].yMin;l=c.vAlign;h=c.hAlign;b=l===g.VAlign.Baseline?1:0;k=(1-b)*-k+(f[f.length-1].yMax+c.lineHeight*(f.length-1)+("underline"===c.decoration?4:0)-k)/2*(b?0:l-1)+-26*(b?1:0);for(l=0;l<f.length;l++)for(m=f[l],u=m.start,b=m.end,m=m.width/2*(h+1)*-1-3,q=l*c.lineHeight+k-3,f[l].startX=m,f[l].startY=q;u<=b;u++)t=a[u],10!==t.code&&(y=new n(m+t.metrics.left,q-t.metrics.top,t,d),m+=t.metrics.advance,e.push(y));return new x(e,f,c)}})},
"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define("require exports ../../../../../../core/maybe ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/cim/effects/CIMEffectHelper ../../enums".split(" "),function(m,a,b,l,k,h){Object.defineProperty(a,"__esModule",{value:!0});m=function(){function a(){}Object.defineProperty(a.prototype,"needsPixelBuffer",{get:function(){return!!this.effects||this.geometryType===h.WGLGeometryType.MARKER||this.geometryType===
h.WGLGeometryType.TEXT||this.geometryType===h.WGLGeometryType.LABEL},enumerable:!1,configurable:!0});a.prototype.writeMesh=function(a,f,c,e,g){if(b.isNone(this.effects))return this.writeMeshWithGeometry(a,f,c,e,g);e=k.CIMEffectHelper.executeEffects(this.effects,c.readLegacyGeometry());for(var d=k.CIMEffectHelper.next(e);d;)this.writeMeshWithGeometry(a,f,c,l.getJsonType(d),g,d),d=k.CIMEffectHelper.next(e)};a.prototype.writeMeshWithGeometry=function(a,b,c,e,g,h){};a.prototype.bindFeature=function(a,
b,c){};return a}();a.default=m})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["require","exports","../CIMCursor","../CIMEffects","../CIMOperators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});a.CIMEffectHelper=void 0;var h=96/72;m=function(){function a(){}a.executeEffects=function(a,f){f=b.cloneAndDecodeGeometry(f);f=new l.SimpleGeometryCursor(f);for(var c=0;c<a.length;c++){var d=a[c],g=k.getEffectOperator(d);g&&(f=g.execute(f,d,h))}return f};a.next=function(a){a=
a.next();b.deltaEncodeGeometry(a);return a};return a}();a.CIMEffectHelper=m})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","../../../../../core/BidiEngine"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.bidiText=void 0;var l=new b.default;a.bidiText=function(a){if(!l.hasBidiChar(a))return[a,!1];var b;b="rtl"===l.checkContextual(a)?"IDNNN":"ICNNN";return[l.bidiTransform(a,b,"VLYSN"),!0]}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../definitions ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x){Object.defineProperty(a,"__esModule",{value:!0});m=function(a){function m(b,d,f,k,l,m,p,q,t,x,H,I,G,K,L,O,P,N,S,W,Q){var u=a.call(this)||this;u.angle=k;u.height=p;u.width=m;u.xOffset=d*S;u.yOffset=f*S;u._markerPlacement=W;u.effects=Q;u._anchorX=.5-(.5+O)*L.width/L.width;u._anchorY=.5-(.5+P)*L.height/L.height;d=(1===K?1:0)|(H?1:0)<<1|(G?1:0)<<2|(I?1:0)<<3;f=L&&L.sdf;b=n.MarkerMaterialKey.load(b);b.sdf=f;b.pattern=!0;b.textureBinding=L.textureBinding;u._materialKey=
b.data;u._fillColor=l;u._outlineColor=t;u._sizeOutlineWidth=e.i8888to32(Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*x),255)),Math.round(Math.min(Math.sqrt(128*q),255)));l=L.rect.x+c.SPRITE_PADDING;q=L.rect.y+c.SPRITE_PADDING;t=l+L.width;L=q+L.height;u._texUpperLeft=e.i1616to32(l,q);u._texUpperRight=e.i1616to32(t,q);u._texBottomLeft=e.i1616to32(l,L);u._texBottomRight=e.i1616to32(t,L);m=m*N*S;p=p*N*S;u._bitestAndDistRatio=e.i8888to32(0,
0,d,Math.round(Math.min(64*N,255)));u._computedWidth=m;u._computedHeight=p;m=g.vec2f32.create();p=h.mat2df32.create();u._applyTransformation(p,m);return u}b.__extends(m,a);m.fromCIMMarker=function(a,b){var c=a.size,e=(b&&b.width||1)/(b&&b.height||1)*a.scaleX,f=a.scaleSymbolsProportionally&&a.frameHeight?c/a.frameHeight:1,g=d.premultiplyAlphaRGBA(a.color),h=d.premultiplyAlphaRGBA(a.outlineColor),n=k.pt2px(c),p=n*e,q=k.pt2px(a.offsetX||0),u=k.pt2px(a.offsetY||0),f=k.pt2px(a.outlineWidth||0)*f,t=a.alignment||
0,x=k.pt2px(a.referenceSize),y=a.rotation||0;a.rotateClockwise||(y=-y);var L=0,O=0,P=a.anchorPoint;P&&(a.isAbsoluteAnchorPoint?c&&(L=-P.x/(c*e),O=P.y/c):(L=P.x,O=P.y));return new m(a.materialKey,q,u,y,g,p,n,x,h,f,a.colorLocked,a.scaleSymbolsProportionally,!1,t,b,L,O,a.sizeRatio,l.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects)};m.fromPictureMarker=function(a,b){var c=Math.round(k.pt2px(a.width)),d=Math.round(k.pt2px(a.height)),e=f.PICTURE_FILL_COLOR,g=Math.round(k.pt2px(a.xoffset||0)),h=Math.round(k.pt2px(a.yoffset||
0));return new m(a.materialKey,g,h,a.angle,e,c,d,d,0,0,!1,!1,!1,0,b,0,0,1,1,null,null)};m.fromSimpleMarker=function(a,b){var c=d.premultiplyAlphaRGBAArray(a.color),e=Math.round(k.pt2px(a.size)),f=Math.round(k.pt2px(a.xoffset||0)),g=Math.round(k.pt2px(a.yoffset||0)),h=a.style,l=a.outline,n=(l&&l.color&&d.premultiplyAlphaRGBAArray(l.color))|0,l=(l&&l.width&&Math.round(k.pt2px(l.width)))|0;a=new m(a.materialKey,f,g,a.angle,c,e,e,e,n,l,!1,!1,"esriSMSCross"===h||"esriSMSX"===h,0,b,0,0,1.96875,1,null,null);
a.boundsType="esriSMSCircle"===h?"circle":"square";return a};m.fromLineSymbolMarker=function(a,b){var c=d.premultiplyAlphaRGBAArray(a.color),e=Math.round(k.pt2px(6*a.lineWidth)),f="cross"===a.style||"x"===a.style,g;switch(a.placement){case "begin-end":g="Both";break;case "begin":g="JustBegin";break;case "end":g="JustEnd";break;default:g="None"}g={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:g,offsetAlongLine:0};b=new m(a.materialKey,0,0,0,c,e,e,e/6,c,f?Math.round(k.pt2px(a.lineWidth)):
0,!1,!1,f,1,b,0,0,1.96875,1,g,null);b.boundsType="circle"===a.style?"circle":"square";return b};return m}(t.default(x.default));a.default=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t){Object.defineProperty(a,"__esModule",{value:!0});var x=3.14159265359/180;a.default=function(a){return function(a){function m(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.angle=0;b.xOffset=0;b.yOffset=0;b.width=0;b.height=0;b.boundsType="square";b._anchorX=0;b._anchorY=0;b._computedWidth=0;b._computedHeight=0;b.geometryType=n.WGLGeometryType.MARKER;return b}b.__extends(m,a);m.prototype.writeMeshWithGeometry=function(a,b,d,
e,f,g){var h=this,k=b.indexVector,m=b.get("geometry"),n=b.getVector("geometry"),p=n.vertexCount,q=k.length;if(l.isSome(this._markerPlacement))d=null!==g&&void 0!==g?g:d.readLegacyGeometry(),this._writePlacedMarkers(m,k,p,f,d);else{d=g?c.deltaDecodeGeometry(c.convertFromGeometry(g),2):"esriGeometryPolygon"===e?d.readCentroid():d.readUnquantizedGeometry();if(!d)return;d.isPoint?(d=d.coords,this._writeVertices(m,f,this._getPos(d[0],d[1])),this._writeIndices(k,p)):d.forEachVertex(function(a,b){var c=
n.vertexCount;h._writeVertices(m,f,h._getPos(a,b));h._writeIndices(k,c)})}b=b.getVector("geometry").vertexCount-p;a.writeDisplayRecord(this.geometryType,this._materialKey,p,b,q,k.length-q)};m.prototype._applyTransformation=function(a,b,c){void 0===c&&(c=0);h.mat2d.identity(a);h.mat2d.translate(a,a,f.vec2f32.fromValues(this.xOffset,-this.yOffset));0!==this.angle+c&&h.mat2d.rotate(a,a,x*(this.angle+c));c=this._computedWidth;var e=this._computedHeight,g=(this._anchorX-.5)*c,k=(this._anchorY-.5)*e;d.vec2.set(b,
g,k);d.vec2.transformMat2d(b,b,a);this._offsetUpperLeft=t.i1616to32(16*b[0],16*b[1]);d.vec2.set(b,g+c,k);d.vec2.transformMat2d(b,b,a);this._offsetUpperRight=t.i1616to32(16*b[0],16*b[1]);d.vec2.set(b,g,k+e);d.vec2.transformMat2d(b,b,a);this._offsetBottomLeft=t.i1616to32(16*b[0],16*b[1]);d.vec2.set(b,g+c,k+e);d.vec2.transformMat2d(b,b,a);this._offsetBottomRight=t.i1616to32(16*b[0],16*b[1])};m.prototype._writePlacedMarkers=function(a,b,c,d,h){if(h=e.CIMMarkerPlacementHelper.getPlacement(h,l.unwrap(this._markerPlacement),
k.pt2px(1)))for(var m=f.vec2f32.create(),n=g.mat2df32.create(),p=0,q=h.next();null!=q;)-128<=q.tx&&640>=q.tx&&-128<=q.ty&&640>=q.ty&&(this._applyTransformation(n,m,q.getAngle()/x),this._writeVertices(a,d,this._getPos(q.tx,q.ty)),this._writeIndices(b,c+p),p+=4),q=h.next()};m.prototype._getPos=function(a,b){return t.i1616to32(Math.round(8*a),Math.round(8*b))};m.prototype._writeVertices=function(a,b,c){a.push(c);a.push(this._offsetUpperLeft);a.push(this._texUpperLeft);a.push(this._bitestAndDistRatio);
a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetUpperRight);a.push(this._texUpperRight);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetBottomLeft);a.push(this._texBottomLeft);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetBottomRight);
a.push(this._texBottomRight);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth)};m.prototype._writeIndices=function(a,b){a.push(b+0);a.push(b+1);a.push(b+2);a.push(b+1);a.push(b+3);a.push(b+2)};return m}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/schemaUtils ../../../../layers/features/textUtils".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u,y,w){function B(a,b){var c=a.length;a.push(null);b.then(function(b){return a[c]=b});return a}function z(a){return!!(a&1)}Object.defineProperty(a,"__esModule",{value:!0});a.WGLTemplateStore=a.isDynamicId=void 0;var A=k.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),C=[];a.isDynamicId=z;m=function(){function a(a,b){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=
[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new q.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!1,configurable:!0});a.prototype.createTemplateGroup=function(a,b){this._initErrorTemplates();var c=a.hash;if(this._symbolToTemplate.has(c))return this._symbolToTemplate.get(c);var d=[];b&&this._createMeshTemplates(d,b,!0);this._createMeshTemplates(d,a,!1);a=this._createGroupId("expanded-cim"===a.type);this._idToTemplateGroup.set(a,d);this._symbolToTemplate.set(c,
a);return a};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):C};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return C;z(a)||A.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.getMosaicItem=function(a,b){var c=this,d=this._createTemplateId(),e=h.create(function(a){return c._idToResolver.set(d,a)});this._fetchQueue.push({symbol:a,
id:d,glyphIds:b});return e};a.prototype.finalize=function(a){return this._fetchQueue.length||this._lock.isHeld()?q.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):h.resolve()};a.prototype._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],y.createSymbolSchema(g.errorPolygonSymbol2D),!1),marker:this._createMeshTemplates([],y.createSymbolSchema(g.errorPointSymbol2D),!1),line:this._createMeshTemplates([],y.createSymbolSchema(g.errorPolylineSymbol2D),
!1)})};a.prototype._fetchAllQueuedResources=function(a){var b=this;if(!this._fetchQueue.length)return h.resolve();var c=this._fetchQueue,d=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return h.all(d).then(function(){return b._fetchResource(c,a).then(function(a){for(var c=0;c<a.length;c++){var d=a[c],e=d.id,d=d.mosaicItem;b._idToResolver.get(e)(d);b._idToResolver.delete(e)}})}).catch(function(a){h.isAbortError(a)?b._fetchQueue=b._fetchQueue.concat(c):"worker:port-closed"!==a.name&&A.error(new l("mapview-template-store",
"Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._createSMS=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a)];case 1:return c=b.sent().spriteMosaicItem,u.ok(c,A)?[2,x.default.fromSimpleMarker(a,c)]:[2,this._markerError]}})})};
a.prototype._createPMS=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a)];case 1:return c=b.sent().spriteMosaicItem,u.ok(c,A)?[2,x.default.fromPictureMarker(a,c)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a)];case 1:return d=
b.sent().spriteMosaicItem,u.ok(d,A)?[2,n.default.fromSimpleFill(a,d,c)]:[2,this._fillError]}})})};a.prototype._createPFS=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var d;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a)];case 1:return d=b.sent().spriteMosaicItem,u.ok(d,A)?[2,n.default.fromPictureFill(a,d,c)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,
function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a)];case 1:return c=b.sent().spriteMosaicItem,u.ok(c,A)?[2,t.default.fromSimpleLine(a,c,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createLMS=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a)];case 1:return c=b.sent().spriteMosaicItem,u.ok(c,A)?[2,x.default.fromLineSymbolMarker(a,c)]:[2,this._markerError]}})})};a.prototype._createTS=
function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a)];case 1:return c=b.sent().glyphMosaicItems,[2,p.default.fromText(a,c)]}})})};a.prototype._createCIMText=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this.getMosaicItem(a.cim,w.codepoints(a.text))];case 1:return c=b.sent().glyphMosaicItems,a.cim.mosaicHash=
a.materialHash,u.ok(c,A)?[2,p.default.fromCIMText(a,c)]:[2,this._textError]}})})};a.prototype._createCIMFill=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim)];case 1:return c=b.sent().spriteMosaicItem,u.ok(c,A)?[2,n.default.fromCIMFill(a,c)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;
return b.__generator(this,function(b){switch(b.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim)];case 1:return c=b.sent().spriteMosaicItem,u.ok(c,A)?[2,t.default.fromCIMLine(a,c,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim)];case 1:return c=b.sent().spriteMosaicItem,
u.ok(c,A)?[2,x.default.fromCIMMarker(a,c)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,d,e=this;return b.__generator(this,function(b){c=a.templateHash;if(this._cimTemplateCache.has(c))return[2,this._cimTemplateCache.get(c)];switch(a.type){case "marker":d=this._createCIMMarker(a);break;case "line":d=this._createCIMLine(a);break;case "fill":d=this._createCIMFill(a);break;case "text":d=this._createCIMText(a)}d.then(function(a){return e._cimTemplateCache.set(c,
a)});return[2,d]})})};a.prototype._createDynamicCIM=function(a){var b=a.templateHash;if(this._cimTemplateCache.has(b))return this._cimTemplateCache.get(b);var g;switch(a.type){case "marker":g=c.default.fromCIMMarker(a);break;case "line":g=f.default.fromCIMLine(a);break;case "fill":g=d.default.fromCIMFill(a);break;case "text":g=e.default.fromCIMText(a)}this._cimTemplateCache.set(b,g);return g};a.prototype._createPrimitiveMeshTemplates=function(a,b,c){switch(b.type){case "esriSMS":return B(a,this._createSMS(b));
case "esriPMS":return B(a,this._createPMS(b));case "esriSFS":return B(a,this._createSFS(b,c));case "line-marker":return B(a,this._createLMS(b));case "esriPFS":return B(a,this._createPFS(b,c));case "esriSLS":return B(a,this._createSLS(b,!1));case "esriTS":return B(a,this._createTS(b));default:return A.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),a}};a.prototype._createMeshTemplates=function(a,b,c){if(-1!==b.type.indexOf("3d"))return A.error("3D symbols are not supported with MapView"),
a;if("expanded-cim"===b.type){c=0;for(var d=b.layers;c<d.length;c++)b=d[c],"function"===typeof b.materialHash?a.push(this._createDynamicCIM(b)):B(a,this._createCIM(b));return a}if("composite-symbol"===b.type){for(var d=0,e=b.layers;d<e.length;d++)b=e[d],this._createPrimitiveMeshTemplates(a,b,c);return a}return"cim"===b.type||"label"===b.type||"web-style"===b.type?a:this._createPrimitiveMeshTemplates(a,b,c)};return a}();a.WGLTemplateStore=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("require exports tslib ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x){Object.defineProperty(a,"__esModule",{value:!0});m=function(a){function m(b){var f=a.call(this,b)||this;if(e.isFunction(b.color))f._dynamicPropertyMap.set("_fillColor",function(a,c,d){return(a=b.color(a,c,d))&&h.premultiplyAlphaRGBA(a)||0});else{var g=b.color;f.fillColor=g&&h.premultiplyAlphaRGBA(g)||0}var l=0;e.isFunction(b.height)||(l=b.height||0);f._dynamicPropertyMap.set("_height",function(a,c,d){return e.isFunction(b.height)?b.height(a,c,d):l});var m=0;e.isFunction(b.offsetX)||
(m=k.pt2px(b.offsetX||0)+128,255<m&&(m=255));f._dynamicPropertyMap.set("_offsetX",function(a,c,d){return e.isFunction(b.offsetX)?(a=k.pt2px(b.offsetX(a,c,d))+128,255<a&&(a=255),a):m});var n=1;e.isFunction(b.scaleX)||(n=b.scaleX||1);f._dynamicPropertyMap.set("_scaleX",function(a,c,d){return e.isFunction(b.scaleX)?b.scaleX(a,c,d):n});var p=0;e.isFunction(b.offsetY)||(p=k.pt2px(-b.offsetY||0)+128,255<p&&(p=255));f._dynamicPropertyMap.set("_offsetY",function(a,c,d){return e.isFunction(b.offsetY)?(a=k.pt2px(-b.offsetY(a,
c,d))+128,255<a&&(a=255),a):p});var q=0;e.isFunction(b.angle)||(q=d.radToByte(b.angle)||0);f._dynamicPropertyMap.set("_angle",function(a,c,f){return e.isFunction(b.angle)?d.radToByte(b.angle(a,c,f)):q});f.effects=b.effects;f._cimFillLayer=b;f._fillMaterialKey=c.FillMaterialKey.load(b.materialKey);return f}b.__extends(m,a);m.fromCIMFill=function(a){return new m(a)};m.prototype.bindFeature=function(a,b,c){var d=this,e=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,f){d[f]=a(e,b,c)});
a=this._fillMaterialKey;var h=this._materialCache,m=this._cimFillLayer;this.aux3=f.i8888to32(0,0,this._angle,m.colorLocked?1:0);m=m.materialHash;m=m(e,b,c);m=h.get(m);h=null;m&&x.ok(m.spriteMosaicItem)&&(h=m.spriteMosaicItem);if(h){var n=h.rect,p=h.width,q=h.height,m=n.x+g.SPRITE_PADDING,n=n.y+g.SPRITE_PADDING,u=m+p,t=n+q,w=l.nextHighestPowerOfTwo(k.pt2px(this._height));255<w?w=255:0>=w&&(w=l.nextHighestPowerOfTwo(t-n));p=l.nextHighestPowerOfTwo(k.pt2px(this._height/q*p||0));255<p?p=255:0>=p&&(p=
l.nextHighestPowerOfTwo(u-m));q=this._scaleX;this.tl=f.i1616to32(m,n);this.br=f.i1616to32(u,t);this.aux1=f.i8888to32(p,w,this._offsetX,this._offsetY);this.aux2=f.i1616to32(128*q,128);a.sdf=h.sdf;a.pattern=!0;a.textureBinding=h.textureBinding}else this.aux2=this.aux1=this.br=this.tl=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data};return m}(n.default(t.default));a.default=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("require exports tslib ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(m,a,b,l,k,h,g,d){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return function(a){function c(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.forceLibtess=!1;b.geometryType=k.WGLGeometryType.FILL;return b}b.__extends(c,a);c.prototype.writeMeshWithGeometry=function(a,b,c,e,f,h){e=g.FillMaterialKey.load(this._materialKey);var k=b.indexVector;b=b.getVector("geometry");var m=b.vertexCount,n=k.length;if(h=h?l.deltaDecodeGeometry(l.convertFromGeometry(h),
2):c.readUnquantizedGeometry())if(h=d.clipMarshall(h)){var p=h.coords;if(this.forceLibtess||!d.triangulate(k,h,m))p=[],d.triangulateLibtess(p,k,h,m);this._write(b,c,f,p,e);a.writeDisplayRecord(this.geometryType,this._materialKey,m,b.vertexCount-m,n,k.length-n)}};c.prototype._write=function(a,b,c,d,e){for(var f=0;f<d.length;f+=2){var g=h.i1616to32(1*d[f],1*d[f+1]);a.data.push(g);a.data.push(c);e.dotDensity?a.data.writeF32(1/Math.abs(b.readGeometryArea())):(a.data.push(this.fillColor),a.data.push(this.tl),
a.data.push(this.br),a.data.push(this.aux1),a.data.push(this.aux2),a.data.push(this.aux3))}};return c}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("require exports ../../../../../../core/libs/earcut/earcut ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut ../Tesselator".split(" "),function(m,a,b,l,k,h,g,d){function f(a,b,c){for(var d=0,e=1;e<c;e++)d+=(a[2*(b+e)]-a[2*(b+e-1)])*(a[2*(b+e)+1]+a[2*(b+e-1)+1]);return d}
function c(a,b,c,d,e){for(var f=0;c<d;c+=3)var g=2*(a.getValue(c)-e),h=2*(a.getValue(c+1)-e),k=2*(a.getValue(c+2)-e),f=f+Math.abs((b[g]-b[k])*(b[h+1]-b[g+1])-(b[g]-b[h])*(b[k+1]-b[g+1]));return f}function e(a,b,c,d,e,f,g,h){e=((a-e)*(f-h)-(b-h)*(e-g))/((a-c)*(f-h)-(b-d)*(e-g));return 0>e||1<e?null:{x:Math.round(a+e*(c-a)),y:Math.round(b+e*(d-b))}}Object.defineProperty(a,"__esModule",{value:!0});a.clip=a.clipMarshall=a.triangulateLibtess=a.triangulateEarcut=a.triangulate=a.triangleArea=a.area=void 0;
var n=new d.default,t=new h.TileClipper(0,0,0,1,128);t.setExtent(k.TILE_SIZE);a.area=f;a.triangleArea=c;a.triangulate=function(a,b,d){var e=b.coords,h=b.lengths;if(b.hasIndeterminateRingOrder)return!1;b=a.length;for(var k=0,l=0;l<h.length;){for(var m=l,n=h[l],l=f(e,k,n),p=[];++m<h.length;){var q=h[m],t=f(e,k+n,q);if(!(0<t))break;l+=t;p.push(k+n);n+=q}q=a.length;g.bufcut(a,e,k,k+n,p,2,d);p=c(a,e,q,a.length,d);l=Math.abs(l);if(1E-5<Math.abs((p-l)/Math.max(1E-7,l)))return a.seek(b),!1;l=m;k+=n}return!0};
a.triangulateEarcut=function(a,c,d){var e=c.coords,g=c.lengths;if(c.hasIndeterminateRingOrder)return!1;for(var h=0,k=0;k<g.length;){for(var l=k,m=g[k],k=[];++l<g.length;){var n=g[l];if(!(0<f(e,h+m,n)))break;k.push(h+m-h);m+=n}for(var p=c.coords.slice(2*h,2*(h+m)),n=0,k=b.earcut(p,k,2);n<k.length;n++)a.push(k[n]+d+h);k=l;h+=m}return!0};a.triangulateLibtess=function(a,b,c,d){var e=[],f=c.coords,g=c.lengths;n.beginPolygon(a,e);for(var h=a=0;h<g.length;h++){var k=c.lengths[h];n.beginContour();for(var l=
0;l<k;l++){var m=[f[2*(a+l)],f[2*(a+l)+1],0];n.addVertex(m,m)}n.endContour();a+=k}n.endPolygon();for(l=0;l<e.length;l++)b.push(e[l]+d)};a.clipMarshall=function(a){var b;a:{b=k.TILE_SIZE+128;for(var c=0,d=0;d<a.lengths.length;d++){for(var e=a.lengths[d],f=0;f<e;f++){var g=a.coords[2*(f+c)],h=a.coords[2*(f+c)+1];if(-128>g||g>b||-128>h||h>b){b=!0;break a}}c+=e}b=!1}if(!b)return a;t.reset(3);for(b=c=0;b<a.lengths.length;b++){d=a.lengths[b];e=a.coords[2*(0+c)];f=a.coords[2*(0+c)+1];t.moveTo(e,f);for(g=
1;g<d;g++)e=a.coords[2*(g+c)],f=a.coords[2*(g+c)+1],t.lineTo(e,f);t.close();c+=d}a=t.result(!1);if(!a)return null;c=[];d=[];for(e=0;e<a.length;e++){b=a[e];for(g=f=0;g<b.length;g++)h=b[g],d.push(h.x),d.push(h.y),f++;c.push(f)}return new l.default(c,d)};a.clip=function(a,b,c){void 0===c&&(c=0);var d=-c;b+=c;for(var f=c=0,g=0,h=0;h<a.lengths.length;h++){for(var k=a.lengths[h],l=g+k,m=0,n=null;c!==l;){for(var p=a.coords[2*c],q=a.coords[2*c++ +1],t=p<d||p>=b||q<d||q>=b,x=t;c!==l&&t===x;)t||(a.coords[2*
f]=p,a.coords[2*f++ +1]=q,m++),p=a.coords[2*c],q=a.coords[2*c++ +1],t=p<d||p>=b||q<d||q>=b;if(c===l)t?n&&(a.coords[2*f]=n.x,a.coords[2*f++ +1]=n.y,m++):(a.coords[2*f]=p,a.coords[2*f++ +1]=q,m++);else{var x=a.coords[2*(c-2)],G=a.coords[2*(c-2)+1];if(x=e(x,G,p,q,d,d,b,d)||e(x,G,p,q,b,d,b,b)||e(x,G,p,q,b,b,d,b)||e(x,G,p,q,d,d,d,b))a.coords[2*f]=x.x,a.coords[2*f++ +1]=x.y,m++,n||(n=x);t||(a.coords[2*f]=p,a.coords[2*f++ +1]=q,m++)}}a.lengths[h]=m;g+=k}}})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["require",
"exports"],function(m,a){function b(a,b,c,e,f,h,k){var l;c=0;for(var m=e,n=f-h;m<f;m+=h)c+=(a[n+b*h]-a[m+b*h])*(a[m+1+b*h]+a[n+1+b*h]),n=m;if(k===0<c)for(k=e;k<f;k+=h)l=g(k+b*h,a[k+b*h],a[k+1+b*h],l);else for(k=f-h;k>=e;k-=h)l=g(k+b*h,a[k+b*h],a[k+1+b*h],l);l&&u(l,l.next)&&(d(l),l=l.next);return l}function l(a,b){void 0===b&&(b=a);if(!a)return a;var c;do if(c=!1,a.steiner||!u(a,a.next)&&0!==n(a.prev,a,a.next))a=a.next;else{d(a);a=b=a.prev;if(a===a.next)break;c=!0}while(c||a!==b);return b}function k(a,
b,c,f,g,m,q,y){if(a){!y&&m&&(a=e(a,f,g,m));for(var C=a;a.prev!==a.next;){var A=a.prev,z=a.next,B;if(m)B=h(a,f,g,m);else a:{B=a;var D=B.prev,E=B,F=B.next;if(0<=n(D,E,F))B=!1;else{for(var H=B.next.next,I=H,G=0;H!==B.prev&&(0===G||H!==I);){G++;if(x(D.x,D.y,E.x,E.y,F.x,F.y,H.x,H.y)&&0<=n(H.prev,H,H.next)){B=!1;break a}H=H.next}B=!0}}if(B)b.push(A.index/c+q),b.push(a.index/c+q),b.push(z.index/c+q),d(a),C=a=z.next;else if(a=z,a===C){if(!y)k(l(a),b,c,f,g,m,q,1);else if(1===y){y=b;C=c;A=q;z=a;do B=z.prev,
D=z.next.next,!u(B,D)&&t(B,z,z.next,D)&&p(B,D)&&p(D,B)&&(y.push(B.index/C+A),y.push(z.index/C+A),y.push(D.index/C+A),d(z),d(z.next),z=a=D),z=z.next;while(z!==a);a=z;k(a,b,c,f,g,m,q,2)}else if(2===y)a:{y=a;do{for(C=y.next.next;C!==y.prev;){if(A=y.index!==C.index){A=y;z=C;B=void 0;if(B=A.next.index!==z.index&&A.prev.index!==z.index){B=void 0;b:{B=A;do{if(B.index!==A.index&&B.next.index!==A.index&&B.index!==z.index&&B.next.index!==z.index&&t(B,B.next,A,z)){B=!0;break b}B=B.next}while(B!==A);B=!1}B=!B}D=
void 0;if(D=B&&p(A,z)&&p(z,A)){B=A;D=!1;E=(A.x+z.x)/2;z=(A.y+z.y)/2;do B.y>z!==B.next.y>z&&B.next.y!==B.y&&E<(B.next.x-B.x)*(z-B.y)/(B.next.y-B.y)+B.x&&(D=!D),B=B.next;while(B!==A)}A=D}if(A){a=w(y,C);y=l(y,y.next);a=l(a,a.next);k(y,b,c,f,g,m,q,0);k(a,b,c,f,g,m,q,0);break a}C=C.next}y=y.next}while(y!==a)}break}}}}function h(a,b,c,d){var e=a.prev,f=a.next;if(0<=n(e,a,f))return!1;var g=e.x>a.x?e.x>f.x?e.x:f.x:a.x>f.x?a.x:f.x,h=e.y>a.y?e.y>f.y?e.y:f.y:a.y>f.y?a.y:f.y,k=q(e.x<a.x?e.x<f.x?e.x:f.x:a.x<f.x?
a.x:f.x,e.y<a.y?e.y<f.y?e.y:f.y:a.y<f.y?a.y:f.y,b,c,d);b=q(g,h,b,c,d);c=a.prevZ;for(d=a.nextZ;c&&c.z>=k&&d&&d.z<=b;){if(c!==a.prev&&c!==a.next&&x(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=n(c.prev,c,c.next))return!1;c=c.prevZ;if(d!==a.prev&&d!==a.next&&x(e.x,e.y,a.x,a.y,f.x,f.y,d.x,d.y)&&0<=n(d.prev,d,d.next))return!1;d=d.nextZ}for(;c&&c.z>=k;){if(c!==a.prev&&c!==a.next&&x(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=n(c.prev,c,c.next))return!1;c=c.prevZ}for(;d&&d.z<=b;){if(d!==a.prev&&d!==a.next&&x(e.x,e.y,a.x,
a.y,f.x,f.y,d.x,d.y)&&0<=n(d.prev,d,d.next))return!1;d=d.nextZ}return!0}function g(a,b,c,d){a=B.create(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function d(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function f(a){var b=a,c=a;do{if(b.x<c.x||b.x===c.x&&b.y<c.y)c=b;b=b.next}while(b!==a);return c}function c(a,b){var c=b,d=a.x,e=a.y,f=-Infinity,g;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var h=
c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(h<=d&&h>f){f=h;if(h===d){if(e===c.y)return c;if(e===c.next.y)return c.next}g=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!g)return null;if(d===f)return g.prev;b=g;for(var h=g.x,k=g.y,l=Infinity,m,c=g.next;c!==b;)d>=c.x&&c.x>=h&&d!==c.x&&x(e<k?d:f,e,h,k,e<k?f:d,e,c.x,c.y)&&(m=Math.abs(e-c.y)/(d-c.x),(m<l||m===l&&c.x>g.x)&&p(c,a)&&(g=c,l=m)),c=c.next;return g}function e(a,b,c,d){for(var f=void 0;f!==a;f=f.next){f=f||a;null===f.z&&(f.z=q(f.x,f.y,b,c,d));
if(f.prev.next!==f||f.next.prev!==f)return f.prev.next=f,f.next.prev=f,e(a,b,c,d);f.prevZ=f.prev;f.nextZ=f.next}a.prevZ.nextZ=null;a.prevZ=null;a:for(c=1;;){d=a;f=void 0;b=a=null;for(var g=0;d;){g++;for(var f=d,h=0;h<c&&f;h++)f=f.nextZ;for(var k=c;0<h||0<k&&f;){var l=void 0;0===h?(l=f,f=f.nextZ,k--):0!==k&&f?d.z<=f.z?(l=d,d=d.nextZ,h--):(l=f,f=f.nextZ,k--):(l=d,d=d.nextZ,h--);b?b.nextZ=l:a=l;l.prevZ=b;b=l}d=f}b.nextZ=null;c*=2;if(2>g)break a}return a}function n(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-
a.x)*(c.y-b.y)}function t(a,b,c,d){return u(a,b)&&u(c,d)||u(a,d)&&u(c,b)?!0:0<n(a,b,c)!==0<n(a,b,d)&&0<n(c,d,a)!==0<n(c,d,b)}function x(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function p(a,b){return 0>n(a.prev,a,a.next)?0<=n(a,b,a.next)&&0<=n(a,a.prev,b):0>n(a,b,a.prev)||0>n(a,a.next,b)}function q(a,b,c,d,e){a=32767*(a-c)*e;b=32767*(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&
252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function u(a,b){return a.x===b.x&&a.y===b.y}function y(a,b){return a.x-b.x}function w(a,b){var c=B.create(a.index,a.x,a.y),d=B.create(b.index,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}Object.defineProperty(a,"__esModule",{value:!0});a.bufcut=void 0;a.bufcut=function(a,d,e,g,h,m,n){A=0;var p=(g-e)*m,q=h&&h.length,u=q?(h[0]-e)*m:p,t=b(d,e,g,0,u,m,!0);if(t&&
t.next!==t.prev){var x,C,z;if(q){for(var q=[],B=0,E=h.length;B<E;B++){var D=b(d,e,g,h[B]*m,B<E-1?h[B+1]*m:g*m,m,!1);D===D.next&&(D.steiner=!0);q.push(f(D))}q.sort(y);for(g=0;g<q.length;g++){h=q[g];B=t;if(B=c(h,B))h=w(B,h),l(h,h.next);t=l(t,t.next)}}if(p>80*m){x=p=d[0+e*m];C=z=d[1+e*m];for(q=m;q<u;q+=m)g=d[q+e*m],h=d[q+1+e*m],x=Math.min(x,g),C=Math.min(C,h),p=Math.max(p,g),z=Math.max(z,h);z=Math.max(p-x,z-C);z=0!==z?1/z:0}k(t,a,m,x,C,z,n,0)}};var B=function(){function a(){this.y=this.x=this.index=
0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}a.create=function(a,b,c){var d=z[A++];d.index=a;d.x=b;d.y=c;d.prev=null;d.next=null;d.z=null;d.prevZ=null;d.nextZ=null;d.steiner=!1;return d};return a}(),z=[],A=0;for(m=0;8096>m;m++)z.push(new B)})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(m,a,b,l){Object.defineProperty(a,"__esModule",{value:!0});var k=
b.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");m=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new l.GluTesselator;this.glu.gluTessCallback(l.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(l.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(l.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(l.gluEnum.GLU_TESS_COMBINE,
this._combinecallback.bind(this));this.glu.gluTessCallback(l.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(l.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));this.glu.gluTessProperty(l.gluEnum.GLU_TESS_WINDING_RULE,l.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=
b};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};a.prototype.addVertex=function(a,b){this.glu.gluTessVertex(a,b)};a.prototype._vertexCallback=function(a,b){b[b.length]=a[0];b[b.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),
this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){k.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=
function(){};return a}();a.default=m})},"esri/core/libs/libtess/libtess":function(){define([],function(){var m={DEBUG:!1,assert:function(a,b){if(m.DEBUG&&!a)throw Error("Assertion failed"+(b?": "+b:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,
GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,
GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};m.geom.vertEq=function(a,b){return a.s===b.s&&a.t===b.t};m.geom.vertLeq=function(a,b){return a.s<b.s||a.s===b.s&&a.t<=b.t};m.geom.edgeEval=function(a,b,l){m.assert(m.geom.vertLeq(a,b)&&m.geom.vertLeq(b,l));var k=b.s-a.s,h=l.s-b.s;return 0<k+h?k<h?b.t-a.t+k/(k+h)*(a.t-l.t):b.t-
l.t+h/(k+h)*(l.t-a.t):0};m.geom.edgeSign=function(a,b,l){m.assert(m.geom.vertLeq(a,b)&&m.geom.vertLeq(b,l));var k=b.s-a.s,h=l.s-b.s;return 0<k+h?(b.t-l.t)*k+(b.t-a.t)*h:0};m.geom.transLeq=function(a,b){return a.t<b.t||a.t===b.t&&a.s<=b.s};m.geom.transEval=function(a,b,l){m.assert(m.geom.transLeq(a,b)&&m.geom.transLeq(b,l));var k=b.t-a.t,h=l.t-b.t;return 0<k+h?k<h?b.s-a.s+k/(k+h)*(a.s-l.s):b.s-l.s+h/(k+h)*(l.s-a.s):0};m.geom.transSign=function(a,b,l){m.assert(m.geom.transLeq(a,b)&&m.geom.transLeq(b,
l));var k=b.t-a.t,h=l.t-b.t;return 0<k+h?(b.s-l.s)*k+(b.s-a.s)*h:0};m.geom.edgeGoesLeft=function(a){return m.geom.vertLeq(a.dst(),a.org)};m.geom.edgeGoesRight=function(a){return m.geom.vertLeq(a.org,a.dst())};m.geom.vertL1dist=function(a,b){return Math.abs(a.s-b.s)+Math.abs(a.t-b.t)};m.geom.vertCCW=function(a,b,l){return 0<=a.s*(b.t-l.t)+b.s*(l.t-a.t)+l.s*(a.t-b.t)};m.geom.interpolate_=function(a,b,l,k){a=0>a?0:a;l=0>l?0:l;return a<=l?0===l?(b+k)/2:b+a/(a+l)*(k-b):k+l/(a+l)*(b-k)};m.geom.edgeIntersect=
function(a,b,l,k,h){var g,d;m.geom.vertLeq(a,b)||(g=a,a=b,b=g);m.geom.vertLeq(l,k)||(g=l,l=k,k=g);m.geom.vertLeq(a,l)||(g=a,a=l,l=g,g=b,b=k,k=g);m.geom.vertLeq(l,b)?m.geom.vertLeq(b,k)?(g=m.geom.edgeEval(a,l,b),d=m.geom.edgeEval(l,b,k),0>g+d&&(g=-g,d=-d),h.s=m.geom.interpolate_(g,l.s,d,b.s)):(g=m.geom.edgeSign(a,l,b),d=-m.geom.edgeSign(a,k,b),0>g+d&&(g=-g,d=-d),h.s=m.geom.interpolate_(g,l.s,d,k.s)):h.s=(l.s+b.s)/2;m.geom.transLeq(a,b)||(g=a,a=b,b=g);m.geom.transLeq(l,k)||(g=l,l=k,k=g);m.geom.transLeq(a,
l)||(g=a,a=l,l=g,g=b,b=k,k=g);m.geom.transLeq(l,b)?m.geom.transLeq(b,k)?(g=m.geom.transEval(a,l,b),d=m.geom.transEval(l,b,k),0>g+d&&(g=-g,d=-d),h.t=m.geom.interpolate_(g,l.t,d,b.t)):(g=m.geom.transSign(a,l,b),d=-m.geom.transSign(a,k,b),0>g+d&&(g=-g,d=-d),h.t=m.geom.interpolate_(g,l.t,d,k.t)):h.t=(l.t+b.t)/2};m.mesh={};m.mesh.makeEdge=function(a){var b=m.mesh.makeEdgePair_(a.eHead);m.mesh.makeVertex_(b,a.vHead);m.mesh.makeVertex_(b.sym,a.vHead);m.mesh.makeFace_(b,a.fHead);return b};m.mesh.meshSplice=
function(a,b){var l=!1,k=!1;a!==b&&(b.org!==a.org&&(k=!0,m.mesh.killVertex_(b.org,a.org)),b.lFace!==a.lFace&&(l=!0,m.mesh.killFace_(b.lFace,a.lFace)),m.mesh.splice_(b,a),k||(m.mesh.makeVertex_(b,a.org),a.org.anEdge=a),l||(m.mesh.makeFace_(b,a.lFace),a.lFace.anEdge=a))};m.mesh.deleteEdge=function(a){var b=a.sym,l=!1;a.lFace!==a.rFace()&&(l=!0,m.mesh.killFace_(a.lFace,a.rFace()));a.oNext===a?m.mesh.killVertex_(a.org,null):(a.rFace().anEdge=a.oPrev(),a.org.anEdge=a.oNext,m.mesh.splice_(a,a.oPrev()),
l||m.mesh.makeFace_(a,a.lFace));b.oNext===b?(m.mesh.killVertex_(b.org,null),m.mesh.killFace_(b.lFace,null)):(a.lFace.anEdge=b.oPrev(),b.org.anEdge=b.oNext,m.mesh.splice_(b,b.oPrev()));m.mesh.killEdge_(a)};m.mesh.addEdgeVertex=function(a){var b=m.mesh.makeEdgePair_(a),l=b.sym;m.mesh.splice_(b,a.lNext);b.org=a.dst();m.mesh.makeVertex_(l,b.org);b.lFace=l.lFace=a.lFace;return b};m.mesh.splitEdge=function(a){var b=m.mesh.addEdgeVertex(a).sym;m.mesh.splice_(a.sym,a.sym.oPrev());m.mesh.splice_(a.sym,b);
a.sym.org=b.org;b.dst().anEdge=b.sym;b.sym.lFace=a.rFace();b.winding=a.winding;b.sym.winding=a.sym.winding;return b};m.mesh.connect=function(a,b){var l=!1,k=m.mesh.makeEdgePair_(a),h=k.sym;b.lFace!==a.lFace&&(l=!0,m.mesh.killFace_(b.lFace,a.lFace));m.mesh.splice_(k,a.lNext);m.mesh.splice_(h,b);k.org=a.dst();h.org=b.org;k.lFace=h.lFace=a.lFace;a.lFace.anEdge=h;l||m.mesh.makeFace_(k,a.lFace);return k};m.mesh.zapFace=function(a){var b=a.anEdge,l=b.lNext,k;do if(k=l,l=k.lNext,k.lFace=null,null===k.rFace()){k.oNext===
k?m.mesh.killVertex_(k.org,null):(k.org.anEdge=k.oNext,m.mesh.splice_(k,k.oPrev()));var h=k.sym;h.oNext===h?m.mesh.killVertex_(h.org,null):(h.org.anEdge=h.oNext,m.mesh.splice_(h,h.oPrev()));m.mesh.killEdge_(k)}while(k!==b);b=a.prev;a=a.next;a.prev=b;b.next=a};m.mesh.meshUnion=function(a,b){var l=a.fHead,k=a.vHead,h=a.eHead,g=b.fHead,d=b.vHead;b=b.eHead;g.next!==g&&(l.prev.next=g.next,g.next.prev=l.prev,g.prev.next=l,l.prev=g.prev);d.next!==d&&(k.prev.next=d.next,d.next.prev=k.prev,d.prev.next=k,k.prev=
d.prev);b.next!==b&&(h.sym.next.sym.next=b.next,b.next.sym.next=h.sym.next,b.sym.next.sym.next=h,h.sym.next=b.sym.next);return a};m.mesh.deleteMesh=function(a){};m.mesh.makeEdgePair_=function(a){var b=new m.GluHalfEdge,l=new m.GluHalfEdge,k=a.sym.next;l.next=k;k.sym.next=b;b.next=a;a.sym.next=l;b.sym=l;b.oNext=b;b.lNext=l;l.sym=b;l.oNext=l;return l.lNext=b};m.mesh.splice_=function(a,b){var l=a.oNext,k=b.oNext;l.sym.lNext=b;k.sym.lNext=a;a.oNext=k;b.oNext=l};m.mesh.makeVertex_=function(a,b){var l=
b.prev,k=new m.GluVertex(b,l);l.next=k;b.prev=k;b=k.anEdge=a;do b.org=k,b=b.oNext;while(b!==a)};m.mesh.makeFace_=function(a,b){var l=b.prev,k=new m.GluFace(b,l);l.next=k;b.prev=k;k.anEdge=a;k.inside=b.inside;b=a;do b.lFace=k,b=b.lNext;while(b!==a)};m.mesh.killEdge_=function(a){var b=a.next;a=a.sym.next;b.sym.next=a;a.sym.next=b};m.mesh.killVertex_=function(a,b){var l=a.anEdge,k=l;do k.org=b,k=k.oNext;while(k!==l);b=a.prev;a=a.next;a.prev=b;b.next=a};m.mesh.killFace_=function(a,b){var l=a.anEdge,k=
l;do k.lFace=b,k=k.lNext;while(k!==l);b=a.prev;a=a.next;a.prev=b;b.next=a};m.normal={};m.normal.S_UNIT_X_=1;m.normal.S_UNIT_Y_=0;m.normal.projectPolygon=function(a,b,l,k){var h=!1,g=[b,l,k];0===b&&0===l&&0===k&&(m.normal.computeNormal_(a,g),h=!0);l=m.normal.longAxis_(g);b=a.mesh.vHead;if(m.TRUE_PROJECT){m.normal.normalize_(g);k=[0,0,0];var d=[0,0,0];k[l]=0;k[(l+1)%3]=m.normal.S_UNIT_X_;k[(l+2)%3]=m.normal.S_UNIT_Y_;l=m.normal.dot_(k,g);k[0]-=l*g[0];k[1]-=l*g[1];k[2]-=l*g[2];m.normal.normalize_(k);
d[0]=g[1]*k[2]-g[2]*k[1];d[1]=g[2]*k[0]-g[0]*k[2];d[2]=g[0]*k[1]-g[1]*k[0];m.normal.normalize_(d);for(g=b.next;g!==b;g=g.next)g.s=m.normal.dot_(g.coords,k),g.t=m.normal.dot_(g.coords,d)}else for(k=(l+1)%3,d=(l+2)%3,l=0<g[l]?1:-1,g=b.next;g!==b;g=g.next)g.s=g.coords[k],g.t=l*g.coords[d];h&&m.normal.checkOrientation_(a)};m.normal.dot_=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};m.normal.normalize_=function(a){var b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];m.assert(0<b);b=Math.sqrt(b);a[0]/=b;a[1]/=b;a[2]/=
b};m.normal.longAxis_=function(a){var b=0;Math.abs(a[1])>Math.abs(a[0])&&(b=1);Math.abs(a[2])>Math.abs(a[b])&&(b=2);return b};m.normal.computeNormal_=function(a,b){var l=[-2*m.GLU_TESS_MAX_COORD,-2*m.GLU_TESS_MAX_COORD,-2*m.GLU_TESS_MAX_COORD],k=[2*m.GLU_TESS_MAX_COORD,2*m.GLU_TESS_MAX_COORD,2*m.GLU_TESS_MAX_COORD],h=[],g=[],d;a=a.mesh.vHead;for(d=a.next;d!==a;d=d.next)for(var f=0;3>f;++f){var c=d.coords[f];c<k[f]&&(k[f]=c,g[f]=d);c>l[f]&&(l[f]=c,h[f]=d)}d=0;l[1]-k[1]>l[0]-k[0]&&(d=1);l[2]-k[2]>l[d]-
k[d]&&(d=2);if(k[d]>=l[d])b[0]=0,b[1]=0,b[2]=1;else{l=0;k=g[d];h=h[d];g=[0,0,0];k=[k.coords[0]-h.coords[0],k.coords[1]-h.coords[1],k.coords[2]-h.coords[2]];f=[0,0,0];for(d=a.next;d!==a;d=d.next)f[0]=d.coords[0]-h.coords[0],f[1]=d.coords[1]-h.coords[1],f[2]=d.coords[2]-h.coords[2],g[0]=k[1]*f[2]-k[2]*f[1],g[1]=k[2]*f[0]-k[0]*f[2],g[2]=k[0]*f[1]-k[1]*f[0],c=g[0]*g[0]+g[1]*g[1]+g[2]*g[2],c>l&&(l=c,b[0]=g[0],b[1]=g[1],b[2]=g[2]);0>=l&&(b[0]=b[1]=b[2]=0,b[m.normal.longAxis_(k)]=1)}};m.normal.checkOrientation_=
function(a){for(var b=0,l=a.mesh.fHead,k=l.next;k!==l;k=k.next){var h=k.anEdge;if(!(0>=h.winding)){do b+=(h.org.s-h.dst().s)*(h.org.t+h.dst().t),h=h.lNext;while(h!==k.anEdge)}}if(0>b)for(a=a.mesh.vHead,b=a.next;b!==a;b=b.next)b.t=-b.t};m.render={};m.render.renderMesh=function(a,b,l){for(var k=!1,h=-1,g=b.fHead.prev;g!==b.fHead;g=g.prev)if(g.inside){k||(a.callBeginCallback(m.primitiveType.GL_TRIANGLES),k=!0);var d=g.anEdge;m.assert(d.lNext.lNext.lNext===d,"renderMesh called with non-triangulated mesh");
do{if(l){var f=d.rFace().inside?0:1;h!==f&&(h=f,a.callEdgeFlagCallback(!!h))}a.callVertexCallback(d.org.data);d=d.lNext}while(d!==g.anEdge)}k&&a.callEndCallback()};m.render.renderBoundary=function(a,b){for(var l=b.fHead.next;l!==b.fHead;l=l.next)if(l.inside){a.callBeginCallback(m.primitiveType.GL_LINE_LOOP);var k=l.anEdge;do a.callVertexCallback(k.org.data),k=k.lNext;while(k!==l.anEdge);a.callEndCallback()}};m.sweep={};m.sweep.SENTINEL_COORD_=4*m.GLU_TESS_MAX_COORD;m.sweep.TOLERANCE_NONZERO_=!1;m.sweep.computeInterior=
function(a){a.fatalError=!1;m.sweep.removeDegenerateEdges_(a);m.sweep.initPriorityQ_(a);m.sweep.initEdgeDict_(a);for(var b;null!==(b=a.pq.extractMin());){for(;;){var l=a.pq.minimum();if(null===l||!m.geom.vertEq(l,b))break;l=a.pq.extractMin();m.sweep.spliceMergeVertices_(a,b.anEdge,l.anEdge)}m.sweep.sweepEvent_(a,b)}b=a.dict.getMin().getKey();a.event=b.eUp.org;m.sweep.doneEdgeDict_(a);m.sweep.donePriorityQ_(a);m.sweep.removeDegenerateFaces_(a.mesh);a.mesh.checkMesh()};m.sweep.addWinding_=function(a,
b){a.winding+=b.winding;a.sym.winding+=b.sym.winding};m.sweep.edgeLeq_=function(a,b,l){a=a.event;b=b.eUp;l=l.eUp;if(b.dst()===a)return l.dst()===a?m.geom.vertLeq(b.org,l.org)?0>=m.geom.edgeSign(l.dst(),b.org,l.org):0<=m.geom.edgeSign(b.dst(),l.org,b.org):0>=m.geom.edgeSign(l.dst(),a,l.org);if(l.dst()===a)return 0<=m.geom.edgeSign(b.dst(),a,b.org);b=m.geom.edgeEval(b.dst(),a,b.org);a=m.geom.edgeEval(l.dst(),a,l.org);return b>=a};m.sweep.deleteRegion_=function(a,b){b.fixUpperEdge&&m.assert(0===b.eUp.winding);
b.eUp.activeRegion=null;a.dict.deleteNode(b.nodeUp);b.nodeUp=null};m.sweep.fixUpperEdge_=function(a,b){m.assert(a.fixUpperEdge);m.mesh.deleteEdge(a.eUp);a.fixUpperEdge=!1;a.eUp=b;b.activeRegion=a};m.sweep.topLeftRegion_=function(a){var b=a.eUp.org;do a=a.regionAbove();while(a.eUp.org===b);a.fixUpperEdge&&(b=m.mesh.connect(a.regionBelow().eUp.sym,a.eUp.lNext),m.sweep.fixUpperEdge_(a,b),a=a.regionAbove());return a};m.sweep.topRightRegion_=function(a){var b=a.eUp.dst();do a=a.regionAbove();while(a.eUp.dst()===
b);return a};m.sweep.addRegionBelow_=function(a,b,l){var k=new m.ActiveRegion;k.eUp=l;k.nodeUp=a.dict.insertBefore(b.nodeUp,k);return l.activeRegion=k};m.sweep.isWindingInside_=function(a,b){switch(a.windingRule){case m.windingRule.GLU_TESS_WINDING_ODD:return 0!==(b&1);case m.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==b;case m.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<b;case m.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>b;case m.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=b||-2>=
b}m.assert(!1);return!1};m.sweep.computeWinding_=function(a,b){b.windingNumber=b.regionAbove().windingNumber+b.eUp.winding;b.inside=m.sweep.isWindingInside_(a,b.windingNumber)};m.sweep.finishRegion_=function(a,b){var l=b.eUp,k=l.lFace;k.inside=b.inside;k.anEdge=l;m.sweep.deleteRegion_(a,b)};m.sweep.finishLeftRegions_=function(a,b,l){var k=b;for(b=b.eUp;k!==l;){k.fixUpperEdge=!1;var h=k.regionBelow(),g=h.eUp;if(g.org!==b.org){if(!h.fixUpperEdge){m.sweep.finishRegion_(a,k);break}g=m.mesh.connect(b.lPrev(),
g.sym);m.sweep.fixUpperEdge_(h,g)}b.oNext!==g&&(m.mesh.meshSplice(g.oPrev(),g),m.mesh.meshSplice(b,g));m.sweep.finishRegion_(a,k);b=h.eUp;k=h}return b};m.sweep.addRightEdges_=function(a,b,l,k,h,g){var d=!0;do m.assert(m.geom.vertLeq(l.org,l.dst())),m.sweep.addRegionBelow_(a,b,l.sym),l=l.oNext;while(l!==k);for(null===h&&(h=b.regionBelow().eUp.rPrev());;){k=b.regionBelow();l=k.eUp.sym;if(l.org!==h.org)break;l.oNext!==h&&(m.mesh.meshSplice(l.oPrev(),l),m.mesh.meshSplice(h.oPrev(),l));k.windingNumber=
b.windingNumber-l.winding;k.inside=m.sweep.isWindingInside_(a,k.windingNumber);b.dirty=!0;!d&&m.sweep.checkForRightSplice_(a,b)&&(m.sweep.addWinding_(l,h),m.sweep.deleteRegion_(a,b),m.mesh.deleteEdge(h));d=!1;b=k;h=l}b.dirty=!0;m.assert(b.windingNumber-l.winding===k.windingNumber);g&&m.sweep.walkDirtyRegions_(a,b)};m.sweep.callCombine_=function(a,b,l,k,h){var g=[b.coords[0],b.coords[1],b.coords[2]];b.data=null;b.data=a.callCombineCallback(g,l,k);null===b.data&&(h?a.fatalError||(a.callErrorCallback(m.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),
a.fatalError=!0):b.data=l[0])};m.sweep.spliceMergeVertices_=function(a,b,l){var k=[null,null,null,null];k[0]=b.org.data;k[1]=l.org.data;m.sweep.callCombine_(a,b.org,k,[.5,.5,0,0],!1);m.mesh.meshSplice(b,l)};m.sweep.vertexWeights_=function(a,b,l,k,h){var g=m.geom.vertL1dist(b,a),d=m.geom.vertL1dist(l,a),f=h+1;k[h]=.5*d/(g+d);k[f]=.5*g/(g+d);a.coords[0]+=k[h]*b.coords[0]+k[f]*l.coords[0];a.coords[1]+=k[h]*b.coords[1]+k[f]*l.coords[1];a.coords[2]+=k[h]*b.coords[2]+k[f]*l.coords[2]};m.sweep.getIntersectData_=
function(a,b,l,k,h,g){var d=[0,0,0,0],f=[l.data,k.data,h.data,g.data];b.coords[0]=b.coords[1]=b.coords[2]=0;m.sweep.vertexWeights_(b,l,k,d,0);m.sweep.vertexWeights_(b,h,g,d,2);m.sweep.callCombine_(a,b,f,d,!0)};m.sweep.checkForRightSplice_=function(a,b){var l=b.regionBelow(),k=b.eUp,h=l.eUp;if(m.geom.vertLeq(k.org,h.org)){if(0<m.geom.edgeSign(h.dst(),k.org,h.org))return!1;m.geom.vertEq(k.org,h.org)?k.org!==h.org&&(a.pq.remove(k.org.pqHandle),m.sweep.spliceMergeVertices_(a,h.oPrev(),k)):(m.mesh.splitEdge(h.sym),
m.mesh.meshSplice(k,h.oPrev()),b.dirty=l.dirty=!0)}else{if(0>m.geom.edgeSign(k.dst(),h.org,k.org))return!1;b.regionAbove().dirty=b.dirty=!0;m.mesh.splitEdge(k.sym);m.mesh.meshSplice(h.oPrev(),k)}return!0};m.sweep.checkForLeftSplice_=function(a,b){var l=b.regionBelow();a=b.eUp;var k=l.eUp;m.assert(!m.geom.vertEq(a.dst(),k.dst()));if(m.geom.vertLeq(a.dst(),k.dst())){if(0>m.geom.edgeSign(a.dst(),k.dst(),a.org))return!1;b.regionAbove().dirty=b.dirty=!0;l=m.mesh.splitEdge(a);m.mesh.meshSplice(k.sym,l);
l.lFace.inside=b.inside}else{if(0<m.geom.edgeSign(k.dst(),a.dst(),k.org))return!1;b.dirty=l.dirty=!0;l=m.mesh.splitEdge(k);m.mesh.meshSplice(a.lNext,k.sym);l.rFace().inside=b.inside}return!0};m.sweep.checkForIntersect_=function(a,b){var l=b.regionBelow(),k=b.eUp,h=l.eUp,g=k.org,d=h.org,f=k.dst(),c=h.dst(),e=new m.GluVertex;m.assert(!m.geom.vertEq(c,f));m.assert(0>=m.geom.edgeSign(f,a.event,g));m.assert(0<=m.geom.edgeSign(c,a.event,d));m.assert(g!==a.event&&d!==a.event);m.assert(!b.fixUpperEdge&&!l.fixUpperEdge);
if(g===d||Math.min(g.t,f.t)>Math.max(d.t,c.t))return!1;if(m.geom.vertLeq(g,d)){if(0<m.geom.edgeSign(c,g,d))return!1}else if(0>m.geom.edgeSign(f,d,g))return!1;m.geom.edgeIntersect(f,g,c,d,e);m.assert(Math.min(g.t,f.t)<=e.t);m.assert(e.t<=Math.max(d.t,c.t));m.assert(Math.min(c.s,f.s)<=e.s);m.assert(e.s<=Math.max(d.s,g.s));m.geom.vertLeq(e,a.event)&&(e.s=a.event.s,e.t=a.event.t);var n=m.geom.vertLeq(g,d)?g:d;m.geom.vertLeq(n,e)&&(e.s=n.s,e.t=n.t);if(m.geom.vertEq(e,g)||m.geom.vertEq(e,d))return m.sweep.checkForRightSplice_(a,
b),!1;if(!m.geom.vertEq(f,a.event)&&0<=m.geom.edgeSign(f,a.event,e)||!m.geom.vertEq(c,a.event)&&0>=m.geom.edgeSign(c,a.event,e)){if(c===a.event)return m.mesh.splitEdge(k.sym),m.mesh.meshSplice(h.sym,k),b=m.sweep.topLeftRegion_(b),k=b.regionBelow().eUp,m.sweep.finishLeftRegions_(a,b.regionBelow(),l),m.sweep.addRightEdges_(a,b,k.oPrev(),k,k,!0),!0;if(f===a.event)return m.mesh.splitEdge(h.sym),m.mesh.meshSplice(k.lNext,h.oPrev()),l=b,b=m.sweep.topRightRegion_(b),g=b.regionBelow().eUp.rPrev(),l.eUp=h.oPrev(),
h=m.sweep.finishLeftRegions_(a,l,null),m.sweep.addRightEdges_(a,b,h.oNext,k.rPrev(),g,!0),!0;0<=m.geom.edgeSign(f,a.event,e)&&(b.regionAbove().dirty=b.dirty=!0,m.mesh.splitEdge(k.sym),k.org.s=a.event.s,k.org.t=a.event.t);0>=m.geom.edgeSign(c,a.event,e)&&(b.dirty=l.dirty=!0,m.mesh.splitEdge(h.sym),h.org.s=a.event.s,h.org.t=a.event.t);return!1}m.mesh.splitEdge(k.sym);m.mesh.splitEdge(h.sym);m.mesh.meshSplice(h.oPrev(),k);k.org.s=e.s;k.org.t=e.t;k.org.pqHandle=a.pq.insert(k.org);m.sweep.getIntersectData_(a,
k.org,g,f,d,c);b.regionAbove().dirty=b.dirty=l.dirty=!0;return!1};m.sweep.walkDirtyRegions_=function(a,b){for(var l=b.regionBelow();;){for(;l.dirty;)b=l,l=l.regionBelow();if(!b.dirty&&(l=b,b=b.regionAbove(),null===b||!b.dirty))break;b.dirty=!1;var k=b.eUp,h=l.eUp;k.dst()!==h.dst()&&m.sweep.checkForLeftSplice_(a,b)&&(l.fixUpperEdge?(m.sweep.deleteRegion_(a,l),m.mesh.deleteEdge(h),l=b.regionBelow(),h=l.eUp):b.fixUpperEdge&&(m.sweep.deleteRegion_(a,b),m.mesh.deleteEdge(k),b=l.regionAbove(),k=b.eUp));
if(k.org!==h.org)if(k.dst()===h.dst()||b.fixUpperEdge||l.fixUpperEdge||k.dst()!==a.event&&h.dst()!==a.event)m.sweep.checkForRightSplice_(a,b);else if(m.sweep.checkForIntersect_(a,b))break;k.org===h.org&&k.dst()===h.dst()&&(m.sweep.addWinding_(h,k),m.sweep.deleteRegion_(a,b),m.mesh.deleteEdge(k),b=l.regionAbove())}};m.sweep.connectRightVertex_=function(a,b,l){var k=l.oNext,h=b.regionBelow(),g=b.eUp,d=h.eUp,f=!1;g.dst()!==d.dst()&&m.sweep.checkForIntersect_(a,b);m.geom.vertEq(g.org,a.event)&&(m.mesh.meshSplice(k.oPrev(),
g),b=m.sweep.topLeftRegion_(b),k=b.regionBelow().eUp,m.sweep.finishLeftRegions_(a,b.regionBelow(),h),f=!0);m.geom.vertEq(d.org,a.event)&&(m.mesh.meshSplice(l,d.oPrev()),l=m.sweep.finishLeftRegions_(a,h,null),f=!0);f?m.sweep.addRightEdges_(a,b,l.oNext,k,k,!0):(k=m.geom.vertLeq(d.org,g.org)?d.oPrev():g,k=m.mesh.connect(l.lPrev(),k),m.sweep.addRightEdges_(a,b,k,k.oNext,k.oNext,!1),k.sym.activeRegion.fixUpperEdge=!0,m.sweep.walkDirtyRegions_(a,b))};m.sweep.connectLeftDegenerate_=function(a,b,l){var k=
b.eUp;if(m.geom.vertEq(k.org,l))m.assert(m.sweep.TOLERANCE_NONZERO_),m.sweep.TOLERANCE_NONZERO_&&m.sweep.spliceMergeVertices_(a,k,l.anEdge);else if(m.geom.vertEq(k.dst(),l)){if(m.assert(m.sweep.TOLERANCE_NONZERO_),m.sweep.TOLERANCE_NONZERO_){b=m.sweep.topRightRegion_(b);var k=b.regionBelow(),h=k.eUp.sym,g=h.oNext,d=g;k.fixUpperEdge&&(m.assert(g!==h),m.sweep.deleteRegion_(a,k),m.mesh.deleteEdge(h),h=g.oPrev());m.mesh.meshSplice(l.anEdge,h);m.geom.edgeGoesLeft(g)||(g=null);m.sweep.addRightEdges_(a,
b,h.oNext,d,g,!0)}}else m.mesh.splitEdge(k.sym),b.fixUpperEdge&&(m.mesh.deleteEdge(k.oNext),b.fixUpperEdge=!1),m.mesh.meshSplice(l.anEdge,k),m.sweep.sweepEvent_(a,l)};m.sweep.connectLeftVertex_=function(a,b){var l=new m.ActiveRegion;l.eUp=b.anEdge.sym;var l=a.dict.search(l).getKey(),k=l.regionBelow(),h=l.eUp,g=k.eUp;0===m.geom.edgeSign(h.dst(),b,h.org)?m.sweep.connectLeftDegenerate_(a,l,b):(k=m.geom.vertLeq(g.dst(),h.dst())?l:k,l.inside||k.fixUpperEdge?(h=k===l?m.mesh.connect(b.anEdge.sym,h.lNext):
m.mesh.connect(g.dNext(),b.anEdge).sym,k.fixUpperEdge?m.sweep.fixUpperEdge_(k,h):m.sweep.computeWinding_(a,m.sweep.addRegionBelow_(a,l,h)),m.sweep.sweepEvent_(a,b)):m.sweep.addRightEdges_(a,l,b.anEdge,b.anEdge,null,!0))};m.sweep.sweepEvent_=function(a,b){a.event=b;for(var l=b.anEdge;null===l.activeRegion;)if(l=l.oNext,l===b.anEdge){m.sweep.connectLeftVertex_(a,b);return}b=m.sweep.topLeftRegion_(l.activeRegion);var k=b.regionBelow(),l=k.eUp,k=m.sweep.finishLeftRegions_(a,k,null);k.oNext===l?m.sweep.connectRightVertex_(a,
b,k):m.sweep.addRightEdges_(a,b,k.oNext,l,l,!0)};m.sweep.addSentinel_=function(a,b){var l=new m.ActiveRegion,k=m.mesh.makeEdge(a.mesh);k.org.s=m.sweep.SENTINEL_COORD_;k.org.t=b;k.dst().s=-m.sweep.SENTINEL_COORD_;k.dst().t=b;a.event=k.dst();l.eUp=k;l.windingNumber=0;l.inside=!1;l.fixUpperEdge=!1;l.sentinel=!0;l.dirty=!1;l.nodeUp=a.dict.insert(l)};m.sweep.initEdgeDict_=function(a){a.dict=new m.Dict(a,m.sweep.edgeLeq_);m.sweep.addSentinel_(a,-m.sweep.SENTINEL_COORD_);m.sweep.addSentinel_(a,m.sweep.SENTINEL_COORD_)};
m.sweep.doneEdgeDict_=function(a){for(var b=0,l;null!==(l=a.dict.getMin().getKey());)l.sentinel||(m.assert(l.fixUpperEdge),m.assert(1===++b)),m.assert(0===l.windingNumber),m.sweep.deleteRegion_(a,l);a.dict=null};m.sweep.removeDegenerateEdges_=function(a){for(var b=a.mesh.eHead,l,k=b.next;k!==b;k=l){l=k.next;var h=k.lNext;m.geom.vertEq(k.org,k.dst())&&k.lNext.lNext!==k&&(m.sweep.spliceMergeVertices_(a,h,k),m.mesh.deleteEdge(k),k=h,h=k.lNext);if(h.lNext===k){if(h!==k){if(h===l||h===l.sym)l=l.next;m.mesh.deleteEdge(h)}if(k===
l||k===l.sym)l=l.next;m.mesh.deleteEdge(k)}}};m.sweep.initPriorityQ_=function(a){var b=new m.PriorityQ;a.pq=b;a=a.mesh.vHead;var l;for(l=a.next;l!==a;l=l.next)l.pqHandle=b.insert(l);b.init()};m.sweep.donePriorityQ_=function(a){a.pq.deleteQ();a.pq=null};m.sweep.removeDegenerateFaces_=function(a){for(var b,l=a.fHead.next;l!==a.fHead;l=b)b=l.next,l=l.anEdge,m.assert(l.lNext!==l),l.lNext.lNext===l&&(m.sweep.addWinding_(l.oNext,l),m.mesh.deleteEdge(l))};m.tessmono={};m.tessmono.tessellateMonoRegion_=function(a){a=
a.anEdge;for(m.assert(a.lNext!==a&&a.lNext.lNext!==a);m.geom.vertLeq(a.dst(),a.org);a=a.lPrev());for(;m.geom.vertLeq(a.org,a.dst());a=a.lNext);for(var b=a.lPrev(),l;a.lNext!==b;)if(m.geom.vertLeq(a.dst(),b.org)){for(;b.lNext!==a&&(m.geom.edgeGoesLeft(b.lNext)||0>=m.geom.edgeSign(b.org,b.dst(),b.lNext.dst()));)l=m.mesh.connect(b.lNext,b),b=l.sym;b=b.lPrev()}else{for(;b.lNext!==a&&(m.geom.edgeGoesRight(a.lPrev())||0<=m.geom.edgeSign(a.dst(),a.org,a.lPrev().org));)l=m.mesh.connect(a,a.lPrev()),a=l.sym;
a=a.lNext}for(m.assert(b.lNext!==a);b.lNext.lNext!==a;)l=m.mesh.connect(b.lNext,b),b=l.sym};m.tessmono.tessellateInterior=function(a){for(var b,l=a.fHead.next;l!==a.fHead;l=b)b=l.next,l.inside&&m.tessmono.tessellateMonoRegion_(l)};m.tessmono.discardExterior=function(a){for(var b,l=a.fHead.next;l!==a.fHead;l=b)b=l.next,l.inside||m.mesh.zapFace(l)};m.tessmono.setWindingNumber=function(a,b,l){for(var k,h=a.eHead.next;h!==a.eHead;h=k)k=h.next,h.rFace().inside!==h.lFace.inside?h.winding=h.lFace.inside?
b:-b:l?m.mesh.deleteEdge(h):h.winding=0};m.Dict=function(a,b){this.head_=new m.DictNode;this.frame_=a;this.leq_=b};m.Dict.prototype.deleteDict_=function(){};m.Dict.prototype.insertBefore=function(a,b){do a=a.prev;while(null!==a.key&&!this.leq_(this.frame_,a.key,b));b=new m.DictNode(b,a.next,a);a.next.prev=b;return a.next=b};m.Dict.prototype.insert=function(a){return this.insertBefore(this.head_,a)};m.Dict.prototype.deleteNode=function(a){a.next.prev=a.prev;a.prev.next=a.next};m.Dict.prototype.search=
function(a){var b=this.head_;do b=b.next;while(null!==b.key&&!this.leq_(this.frame_,a,b.key));return b};m.Dict.prototype.getMin=function(){return this.head_.next};m.Dict.prototype.getMax=function(){return this.head_.prev};m.DictNode=function(a,b,l){this.key=a||null;this.next=b||this;this.prev=l||this};m.DictNode.prototype.getKey=function(){return this.key};m.DictNode.prototype.getSuccessor=function(){return this.next};m.DictNode.prototype.getPredecessor=function(){return this.prev};m.GluTesselator=
function(){this.state_=m.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=m.windingRule.GLU_TESS_WINDING_ODD;this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};m.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};m.GluTesselator.prototype.gluDeleteTess=
function(){this.requireState_(m.GluTesselator.tessState_.T_DORMANT)};m.GluTesselator.prototype.gluTessProperty=function(a,b){switch(a){case m.gluEnum.GLU_TESS_TOLERANCE:return;case m.gluEnum.GLU_TESS_WINDING_RULE:switch(b){case m.windingRule.GLU_TESS_WINDING_ODD:case m.windingRule.GLU_TESS_WINDING_NONZERO:case m.windingRule.GLU_TESS_WINDING_POSITIVE:case m.windingRule.GLU_TESS_WINDING_NEGATIVE:case m.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=b;return}break;case m.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=
!!b;return;default:this.callErrorCallback(m.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(m.gluEnum.GLU_INVALID_VALUE)};m.GluTesselator.prototype.gluGetTessProperty=function(a){switch(a){case m.gluEnum.GLU_TESS_TOLERANCE:return 0;case m.gluEnum.GLU_TESS_WINDING_RULE:return a=this.windingRule,m.assert(a===m.windingRule.GLU_TESS_WINDING_ODD||a===m.windingRule.GLU_TESS_WINDING_NONZERO||a===m.windingRule.GLU_TESS_WINDING_POSITIVE||a===m.windingRule.GLU_TESS_WINDING_NEGATIVE||a===m.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),
a;case m.gluEnum.GLU_TESS_BOUNDARY_ONLY:return m.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(m.gluEnum.GLU_INVALID_ENUM)}return!1};m.GluTesselator.prototype.gluTessNormal=function(a,b,l){this.normal_[0]=a;this.normal_[1]=b;this.normal_[2]=l};m.GluTesselator.prototype.gluTessCallback=function(a,b){b=b?b:null;switch(a){case m.gluEnum.GLU_TESS_BEGIN:case m.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=b;break;case m.gluEnum.GLU_TESS_EDGE_FLAG:case m.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=
b;break;case m.gluEnum.GLU_TESS_VERTEX:case m.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=b;break;case m.gluEnum.GLU_TESS_END:case m.gluEnum.GLU_TESS_END_DATA:this.endCallback_=b;break;case m.gluEnum.GLU_TESS_ERROR:case m.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=b;break;case m.gluEnum.GLU_TESS_COMBINE:case m.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=b;break;case m.gluEnum.GLU_TESS_MESH:this.meshCallback_=b;break;default:this.callErrorCallback(m.gluEnum.GLU_INVALID_ENUM)}};m.GluTesselator.prototype.gluTessVertex=
function(a,b){var l=!1,k=[0,0,0];this.requireState_(m.GluTesselator.tessState_.T_IN_CONTOUR);for(var h=0;3>h;++h){var g=a[h];g<-m.GLU_TESS_MAX_COORD&&(g=-m.GLU_TESS_MAX_COORD,l=!0);g>m.GLU_TESS_MAX_COORD&&(g=m.GLU_TESS_MAX_COORD,l=!0);k[h]=g}l&&this.callErrorCallback(m.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(k,b)};m.GluTesselator.prototype.gluTessBeginPolygon=function(a){this.requireState_(m.GluTesselator.tessState_.T_DORMANT);this.state_=m.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=
new m.GluMesh;this.polygonData_=a};m.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(m.GluTesselator.tessState_.T_IN_POLYGON);this.state_=m.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};m.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(m.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=m.GluTesselator.tessState_.T_IN_POLYGON};m.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(m.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=m.GluTesselator.tessState_.T_DORMANT;m.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);m.sweep.computeInterior(this);if(!this.fatalError){var a=this.mesh;this.boundaryOnly_?m.tessmono.setWindingNumber(a,1,!0):m.tessmono.tessellateInterior(a);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?m.render.renderBoundary(this,this.mesh):m.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);
if(this.meshCallback_){m.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}m.mesh.deleteMesh(this.mesh);this.mesh=this.polygonData_=null};m.GluTesselator.prototype.requireState_=function(a){this.state_!==a&&this.gotoState_(a)};m.GluTesselator.prototype.gotoState_=function(a){for(;this.state_!==a;)if(this.state_<a)switch(this.state_){case m.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);
this.gluTessBeginPolygon(null);break;case m.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case m.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_END_CONTOUR);this.gluTessEndContour();break;case m.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};m.GluTesselator.prototype.addVertex_=
function(a,b){var l=this.lastEdge_;null===l?(l=m.mesh.makeEdge(this.mesh),m.mesh.meshSplice(l,l.sym)):(m.mesh.splitEdge(l),l=l.lNext);l.org.data=b;l.org.coords[0]=a[0];l.org.coords[1]=a[1];l.org.coords[2]=a[2];l.winding=1;l.sym.winding=-1;this.lastEdge_=l};m.GluTesselator.prototype.callBeginCallback=function(a){this.beginCallback_&&this.beginCallback_(a,this.polygonData_)};m.GluTesselator.prototype.callVertexCallback=function(a){this.vertexCallback_&&this.vertexCallback_(a,this.polygonData_)};m.GluTesselator.prototype.callEdgeFlagCallback=
function(a){this.edgeFlagCallback_&&this.edgeFlagCallback_(a,this.polygonData_)};m.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};m.GluTesselator.prototype.callCombineCallback=function(a,b,l){return this.combineCallback_?this.combineCallback_(a,b,l,this.polygonData_)||null:null};m.GluTesselator.prototype.callErrorCallback=function(a){this.errorCallback_&&this.errorCallback_(a,this.polygonData_)};m.GluFace=function(a,b){this.next=a||this;
this.prev=b||this;this.anEdge=null;this.inside=!1};m.GluHalfEdge=function(a){this.next=a||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};m.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};m.GluHalfEdge.prototype.dst=function(){return this.sym.org};m.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};m.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};m.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};
m.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};m.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};m.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};m.GluMesh=function(){this.vHead=new m.GluVertex;this.fHead=new m.GluFace;this.eHead=new m.GluHalfEdge;this.eHeadSym=new m.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};m.GluMesh.prototype.checkMesh=function(){if(m.DEBUG){var a=this.fHead,b=this.vHead,l=this.eHead,k,h;for(k=k=a;(h=
k.next)!==a;k=h){m.assert(h.prev===k);k=h.anEdge;do m.assert(k.sym!==k),m.assert(k.sym.sym===k),m.assert(k.lNext.oNext.sym===k),m.assert(k.oNext.sym.lNext===k),m.assert(k.lFace===h),k=k.lNext;while(k!==h.anEdge)}m.assert(h.prev===k&&null===h.anEdge);for(k=k=b;(a=k.next)!==b;k=a){m.assert(a.prev===k);k=a.anEdge;do m.assert(k.sym!==k),m.assert(k.sym.sym===k),m.assert(k.lNext.oNext.sym===k),m.assert(k.oNext.sym.lNext===k),m.assert(k.org===a),k=k.oNext;while(k!==a.anEdge)}m.assert(a.prev===k&&null===
a.anEdge&&null===a.data);for(b=b=l;(k=b.next)!==l;b=k)m.assert(k.sym.next===b.sym),m.assert(k.sym!==k),m.assert(k.sym.sym===k),m.assert(null!==k.org),m.assert(null!==k.dst()),m.assert(k.lNext.oNext.sym===k),m.assert(k.oNext.sym.lNext===k);m.assert(k.sym.next===b.sym&&k.sym===this.eHeadSym&&k.sym.sym===k&&null===k.org&&null===k.dst()&&null===k.lFace&&null===k.rFace())}};m.GluVertex=function(a,b){this.next=a||this;this.prev=b||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=
this.s=0};m.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new m.PriorityQHeap};m.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};m.PriorityQ.prototype.init=function(){this.order_=[];for(var a=0;a<this.size_;a++)this.order_[a]=a;a=function(a){return function(b,h){return m.geom.vertLeq(a[b],a[h])?1:-1}}(this.verts_);this.order_.sort(a);this.initialized_=!0;this.heap_.init();if(m.DEBUG)for(var b=0+this.size_-1,a=0;a<
b;++a)m.assert(m.geom.vertLeq(this.verts_[this.order_[a+1]],this.verts_[this.order_[a]]))};m.PriorityQ.prototype.insert=function(a){if(this.initialized_)return this.heap_.insert(a);var b=this.size_++;this.verts_[b]=a;return-(b+1)};m.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(m.geom.vertLeq(b,a))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&
null===this.verts_[this.order_[this.size_-1]]);return a};m.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(m.geom.vertLeq(b,a))return b}return a};m.PriorityQ.prototype.remove=function(a){if(0<=a)this.heap_.remove(a);else for(a=-(a+1),m.assert(a<this.verts_.length&&null!==this.verts_[a]),this.verts_[a]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-
1]];)--this.size_};m.PriorityQHeap=function(){this.heap_=m.PriorityQHeap.reallocNumeric_([0],m.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=m.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};m.PriorityQHeap.INIT_SIZE_=32;m.PriorityQHeap.reallocNumeric_=function(a,b){for(var l=Array(b),k=0;k<a.length;k++)l[k]=a[k];for(;k<b;k++)l[k]=0;return l};m.PriorityQHeap.prototype.init=function(){for(var a=this.size_;1<=a;--a)this.floatDown_(a);
this.initialized_=!0};m.PriorityQHeap.prototype.insert=function(a){var b=++this.size_;2*b>this.max_&&(this.max_*=2,this.handles_=m.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var l;0===this.freeList_?l=b:(l=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[l]=a;this.handles_[l]=b;this.heap_[b]=l;this.initialized_&&this.floatUp_(b);return l};m.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};m.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};
m.PriorityQHeap.prototype.extractMin=function(){var a=this.heap_,b=this.verts_,l=this.handles_,k=a[1],h=b[k];0<this.size_&&(a[1]=a[this.size_],l[a[1]]=1,b[k]=null,l[k]=this.freeList_,this.freeList_=k,0<--this.size_&&this.floatDown_(1));return h};m.PriorityQHeap.prototype.remove=function(a){var b=this.heap_,l=this.verts_,k=this.handles_;m.assert(1<=a&&a<=this.max_&&null!==l[a]);var h=k[a];b[h]=b[this.size_];k[b[h]]=h;h<=--this.size_&&(1>=h?this.floatDown_(h):m.geom.vertLeq(l[b[h>>1]],l[b[h]])?this.floatDown_(h):
this.floatUp_(h));l[a]=null;k[a]=this.freeList_;this.freeList_=a};m.PriorityQHeap.prototype.floatDown_=function(a){for(var b=this.heap_,l=this.verts_,k=this.handles_,h=b[a];;){var g=a<<1;g<this.size_&&m.geom.vertLeq(l[b[g+1]],l[b[g]])&&(g+=1);m.assert(g<=this.max_);var d=b[g];if(g>this.size_||m.geom.vertLeq(l[h],l[d])){b[a]=h;k[h]=a;break}b[a]=d;k[d]=a;a=g}};m.PriorityQHeap.prototype.floatUp_=function(a){for(var b=this.heap_,l=this.verts_,k=this.handles_,h=b[a];;){var g=a>>1,d=b[g];if(0===g||m.geom.vertLeq(l[d],
l[h])){b[a]=h;k[h]=a;break}b[a]=d;k[d]=a;a=g}};m.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};m.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};m.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return m})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),
function(m,a,b,l,k,h,g){Object.defineProperty(a,"__esModule",{value:!0});var d=l.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");m=function(a){function c(b){var c=a.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=b;return c}b.__extends(c,a);c.prototype.analyze=function(a,b,c,f){var e=this;b=b.readLegacyFeature();var g=this._materialCache,l=this._cimLayer.materialHash;if(!l)return d.error("A Dynamic mesh template must have a material hash value or function!"),
k.reject(null);var m="function"===typeof l?l(b,c,f):l;if(g.has(m))return a=g.get(m),k.resolve(a);if(this._ongoingMaterialRequestMap.has(m))return this._ongoingMaterialRequestMap.get(m);c=h.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);c.mosaicHash=m;a=a.getMosaicItem(c).then(function(a){e._ongoingMaterialRequestMap.delete(m);g.set(m,a);return a}).catch(function(a){e._ongoingMaterialRequestMap.delete(m);d.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(m,
a);return a};return c}(g.default);a.default=m})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});a.ok=void 0;a.ok=function(a,k){return a&&"name"in a?(k&&k.error(new b(a.name,a.message,a.details)),!1):!0}})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n){Object.defineProperty(a,"__esModule",{value:!0});m=function(a){function c(b){var c=a.call(this,b)||this;c._cimLineLayer=b;var d=0;f.isFunction(b.width)||(d=.5*l.pt2px(b.width));c._dynamicPropertyMap.set("_halfWidth",function(a,c,e){return f.isFunction(b.width)?.5*l.pt2px(b.width(a,c,e)):d});f.isFunction(b.cap)?c._dynamicPropertyMap.set("_capType",b.cap):c._capType=b.cap;f.isFunction(b.join)?c._dynamicPropertyMap.set("_joinType",b.join):c._joinType=b.join;if(f.isFunction(b.color))c._dynamicPropertyMap.set("_fillColor",
function(a,c,d){return(a=b.color(a,c,d))&&k.premultiplyAlphaRGBA(a)||0});else{var e=b.color;c._fillColor=e&&k.premultiplyAlphaRGBA(e)||0}f.isFunction(b.miterLimit)?c._dynamicPropertyMap.set("_miterLimitCosine",function(a,c,d){return f.getLimitCosine(b.miterLimit(a,c,d))}):c._miterLimitCosine=f.getLimitCosine(b.miterLimit);c._scaleFactor=b.scaleFactor||1;c._isDashed=b.isDashed;c.effects=b.effects;c.tessellationProperties._bitset=b.colorLocked?1:0;c._materialKey=b.materialKey;c._initializeTessellator(!0);
return c}b.__extends(c,a);c.fromCIMLine=function(a){return new c(a)};c.prototype.bindFeature=function(a,b,c){var e=this,f=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,d){e[d]=a(f,b,c)});this._halfWidth*=this._scaleFactor;a=this._materialCache;var k=this._cimLineLayer.materialHash,k=k(f,b,c),k=a.get(k);a=null;k&&n.ok(k.spriteMosaicItem)&&(a=k.spriteMosaicItem);if(a){this._hasPattern=!0;var l=a.rect,k=l.x+h.SPRITE_PADDING,l=l.y+h.SPRITE_PADDING,m=k+a.width,p=l+a.height;this.tessellationProperties._tl=
g.i1616to32(k,l);this.tessellationProperties._br=g.i1616to32(m,p)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;k=d.LineMaterialKey.load(this._materialKey);a&&(k.sdf=a.sdf,k.pattern=!0,k.textureBinding=a.textureBinding);this._materialKey=k.data};return c}(c.default(e.default));
a.default=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports tslib ../../../../../../core/has ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../materialKey/MaterialKey".split(" "),function(m,a,b,l,k,h,g,d,f,c){Object.defineProperty(a,"__esModule",{value:!0});var e=k.TILE_SIZE+16,n=1/3.8,t=new d.TileClipper(0,0,0,1,16);t.setExtent(k.TILE_SIZE);var x=new Uint32Array(9),p=new Uint32Array(36),q=new Uint32Array(3),u=
new Uint32Array(6),y=function(a){return function(b){var c=Math.ceil(1024*a._halfWidth),d=Math.ceil(1024*a._halfReferenceWidth);b.entry0=a.offset+a.vertexCount++;var e=g.i1616to32(b.distance,c),f=g.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),Math.round(0),Math.round(-31)),h=g.i8888to32(0,0,0,a._bitset);p[0]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);p[1]=a.id;p[2]=a._fillColor;p[3]=f;p[4]=e;p[5]=a._tl;p[6]=a._br;p[7]=h;p[8]=g.i1616to32(d,0);b.entry2=a.offset+a.vertexCount++;
e=g.i1616to32(b.distance,c);f=g.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));h=g.i8888to32(0,0,0,a._bitset);p[9]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);p[10]=a.id;p[11]=a._fillColor;p[12]=f;p[13]=e;p[14]=a._tl;p[15]=a._br;p[16]=h;p[17]=g.i1616to32(d,0);b.exit0=a.offset+a.vertexCount++;e=g.i1616to32(b.distance,c);f=g.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));h=g.i8888to32(0,
0,0,a._bitset);p[18]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);p[19]=a.id;p[20]=a._fillColor;p[21]=f;p[22]=e;p[23]=a._tl;p[24]=a._br;p[25]=h;p[26]=g.i1616to32(d,0);b.exit2=a.offset+a.vertexCount++;e=g.i1616to32(b.distance,c);f=g.i8888to32(Math.round(31*-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));h=g.i8888to32(0,0,0,a._bitset);p[27]=g.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);p[28]=a.id;p[29]=a._fillColor;p[30]=f;p[31]=e;p[32]=a._tl;p[33]=a._br;
p[34]=h;p[35]=g.i1616to32(d,0);a.geometryBuf.writeRegion(p)}},w=function(a){return function(b){u[0]=b.leftExit0;u[1]=b.rightEntry0;u[2]=b.leftExit2;u[3]=b.rightEntry0;u[4]=b.rightEntry2;u[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(u)}},B=function(a){return function(b,c,d,e,f,h,k,l,m){m=g.i1616to32(m,Math.ceil(1024*a._halfWidth));f=g.i8888to32(Math.round(31*f),Math.round(31*h),Math.round(31*k),Math.round(31*l));d=g.i8888to32(31*d,31*e,0,a._bitset);x[0]=g.i1616to32(8*b,8*c);x[1]=a.id;x[2]=
a._fillColor;x[3]=f;x[4]=m;x[5]=a._tl;x[6]=a._br;x[7]=d;x[8]=g.i1616to32(Math.ceil(1024*a._halfReferenceWidth),0);a.geometryBuf.writeRegion(x);return a.offset+a.vertexCount++}},z=function(a){return function(b,c,d){q[0]=b;q[1]=c;q[2]=d;a.indexCount+=3;a.indexBuf.writeRegion(q)}};a.default=function(a){return function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,
_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};b._tessellationOptions={};b.geometryType=h.WGLGeometryType.LINE;return b}b.__extends(d,a);d.prototype.writeMeshWithGeometry=function(a,b,c,d,e,f){var g=b.indexVector,h=b.get("geometry");b=b.getVector("geometry").vertexCount;var k=g.length;if(c=null!==f&&void 0!==f?f:c.readLegacyGeometry()){switch(d){case "esriGeometryPolyline":d=this._clipLines(c.paths);if(0===d.length)return;this._write(g,
h,b,e,d);break;case "esriGeometryPolygon":d=this._clipLines(c.rings);if(0===d.length)return;this._write(g,h,b,e,d)}a.writeDisplayRecord(this.geometryType,this._materialKey,b,this.tessellationProperties.vertexCount,k,this.tessellationProperties.indexCount)}};d.prototype._clipLines=function(a){for(var b=[],c=!1,d=0;d<a.length;){var f=[],g=a[d];t.reset(2);var h=g[0],k=h[0],h=h[1];if(c)t.moveTo(k,h);else{if(-16>k||k>e||-16>h||h>e){c=!0;continue}f.push({x:k,y:h})}for(var l=!1,m=g.length,n=1;n<m;++n)if(k+=
g[n][0],h+=g[n][1],c)t.lineTo(k,h);else{if(-16>k||k>e||-16>h||h>e){l=!0;break}f.push({x:k,y:h})}if(l)c=!0;else{if(c){if(f=t.resultWithStarts())for(c=0;c<f.length;c++)b.push(f[c])}else b.push({line:f,start:0});d++;c=!1}}return b};d.prototype._write=function(a,b,c,d,e){this.tessellationProperties.id=d;this.tessellationProperties.indexBuf=a;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=b;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=c;
for(a=0;a<e.length;a++)b=e[a],c=b.line,2>c.length||(this._tessellationOptions.initialDistance=b.start%65535,this._tessellationCallbacks instanceof f.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),f.tessellate(c,this._tessellationOptions,this._tessellationCallbacks),f.cleanup())};d.prototype._initializeTessellator=function(a){var b=c.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=
this._isDashed||this._hasPattern;this._tessellationOptions.thin=!a&&this.tessellationProperties._halfWidth<k.THIN_LINE_THRESHOLD/2&&!(b.vvSizeFieldStops||b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=n;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=n;this._tessellationOptions.enableInnerBisectorSplit=
this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:y(this.tessellationProperties),bridge:w(this.tessellationProperties)}:(a=new f.StandardTessellationCallbacks(B(this.tessellationProperties),z(this.tessellationProperties)),a.miterLimitCosine=this._miterLimitCosine,a.textured=this._isDashed||this._hasPattern,a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a)};return d}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(m,a,b,l,k,h,g,d,f,c,e,n,t,x,p,q,u){Object.defineProperty(a,"__esModule",{value:!0});var y=f.vec2f32.create(),w=d.mat2df32.create(),B=k.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");m=function(a){function d(b){var d=a.call(this,b)||this;d._cimMarkerLayer=b;x.isFunction(b.color)?d._dynamicPropertyMap.set("_fillColor",function(a,d,e){return c.premultiplyAlphaRGBA(b.color(a,d,e))}):d._fillColor=c.premultiplyAlphaRGBA(b.color);x.isFunction(b.outlineColor)?d._dynamicPropertyMap.set("_outlineColor",
function(a,d,e){return c.premultiplyAlphaRGBA(b.outlineColor(a,d,e))}):d._outlineColor=c.premultiplyAlphaRGBA(b.outlineColor);x.isFunction(b.size)?d._dynamicPropertyMap.set("_size",function(a,c,d){return g.pt2px(b.size(a,c,d))}):d._size=g.pt2px(b.size);x.isFunction(b.scaleX)?d._dynamicPropertyMap.set("_scaleX",b.scaleX):d._scaleX=b.scaleX;x.isFunction(b.offsetX)?d._dynamicPropertyMap.set("xOffset",function(a,c,d){return g.pt2px(b.offsetX(a,c,d))}):d.xOffset=g.pt2px(b.offsetX);x.isFunction(b.offsetY)?
d._dynamicPropertyMap.set("yOffset",function(a,c,d){return g.pt2px(b.offsetY(a,c,d))}):d.yOffset=g.pt2px(b.offsetY);x.isFunction(b.outlineWidth)?d._dynamicPropertyMap.set("_outlineWidth",function(a,c,d){return g.pt2px(b.outlineWidth(a,c,d))}):d._outlineWidth=g.pt2px(b.outlineWidth);x.isFunction(b.rotation)?d._dynamicPropertyMap.set("_angle",b.rotation):d._angle=b.rotation;d._scaleFactor=h.unwrapOr(b.scaleFactor,1);d._markerPlacement=b.markerPlacement;d.effects=b.effects;d._bitSet=(1===b.alignment?
1:0)|(b.colorLocked?1:0)<<1|(b.scaleSymbolsProportionally?1:0)<<3;d._materialKey=b.materialKey;return d}b.__extends(d,a);d.fromCIMMarker=function(a){return new d(a)};d.prototype.bindFeature=function(a,b,c){var d=this,f=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,e){d[e]=a(f,b,c)});a=this._cimMarkerLayer.materialHash;a="function"===typeof a?a(f,b,c):a;if((a=this._materialCache.get(a))&&u.ok(a.spriteMosaicItem)&&a.spriteMosaicItem){a=a.spriteMosaicItem;var h=this._cimMarkerLayer.sizeRatio,
k=a.width/a.height*this._scaleX,m=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,p=this._size,q=p*k,x=this.xOffset,z=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var A=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/g.pt2px(this._cimMarkerLayer.frameHeight):1,C=this._outlineWidth*A,E=g.pt2px(this._cimMarkerLayer.referenceSize),D=A=0,R=this._cimMarkerLayer.anchorPoint;R&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?
this._size&&(A=-R.x/(this._size*k),D=R.y/this._size):(A=R.x,D=R.y));this._sizeOutlineWidth=n.i8888to32(Math.round(Math.min(Math.sqrt(128*q),255)),Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*C),255)),Math.round(Math.min(Math.sqrt(128*E),255)));this.angle=m;this._bitestAndDistRatio=n.i8888to32(0,0,this._bitSet,Math.round(Math.min(64*h,255)));k=a.rect.x+e.SPRITE_PADDING;m=a.rect.y+e.SPRITE_PADDING;C=k+a.width;E=m+a.height;this._texUpperLeft=n.i1616to32(k,m);this._texUpperRight=
n.i1616to32(C,m);this._texBottomLeft=n.i1616to32(k,E);this._texBottomRight=n.i1616to32(C,E);k=t.MarkerMaterialKey.load(this._materialKey);k.sdf=a.sdf;k.pattern=!0;k.textureBinding=a.textureBinding;this._materialKey=k.data;this._anchorX=.5-(.5+A)*a.width/a.width;this._anchorY=.5-(.5+D)*a.height/a.height;q=q*h*this._scaleFactor;p=p*h*this._scaleFactor;q*=a.rect.width/a.width;p*=a.rect.height/a.height;this._computedWidth=q;this._computedHeight=p;this._applyTransformation(w,y);this.xOffset=x;this.yOffset=
z}else B.error(new l("mapview-cim","Encountered an error when binding feature"))};return d}(p.default(q.default));a.default=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),function(m,a,b,l,k,h,g,d,f,c,e){Object.defineProperty(a,"__esModule",
{value:!0});m=function(a){function c(b){var c=a.call(this,b)||this;c._horizontalAlignment="center";c._verticalAlignment="middle";c._textToGlyphs=new Map;var e=b.scaleFactor||1;c._cimTextLayer=b;d.isFunction(b.color)?c._dynamicPropertyMap.set("_color",function(a,c,d){return h.premultiplyAlphaRGBA(b.color(a,c,d))}):c._color=h.premultiplyAlphaRGBA(b.color);d.isFunction(b.color)?c._dynamicPropertyMap.set("_haloColor",function(a,c,d){return h.premultiplyAlphaRGBA(b.outlineColor(a,c,d))}):c._haloColor=
h.premultiplyAlphaRGBA(b.outlineColor);var f;d.isFunction(b.size)||(f=Math.min(Math.round(l.pt2px(b.size*b.sizeRatio)),127));c._dynamicPropertyMap.set("_size",function(a,c,e){return d.isFunction(b.size)?Math.min(Math.round(l.pt2px(b.size(a,c,e)*b.sizeRatio)),127):f});d.isFunction(b.outlineSize)?c._dynamicPropertyMap.set("_haloSize",function(a,c,d){return Math.min(Math.floor(5*l.pt2px(b.outlineSize(a,c,d)*b.sizeRatio)),127)}):c._haloSize=Math.min(Math.floor(5*l.pt2px(b.outlineSize*b.sizeRatio)),127);
var k;d.isFunction(b.offsetX)||(k=Math.round(l.pt2px(b.offsetX*b.sizeRatio)));c._dynamicPropertyMap.set("_xOffset",function(a,c,e){return d.isFunction(b.offsetX)?Math.round(l.pt2px(b.offsetX(a,c,e)*b.sizeRatio)):k});var m;d.isFunction(b.offsetY)||(m=Math.round(l.pt2px(b.offsetY*b.sizeRatio)));c._dynamicPropertyMap.set("_yOffset",function(a,c,e){return d.isFunction(b.offsetY)?Math.round(l.pt2px(b.offsetY(a,c,e)*b.sizeRatio)):m});d.isFunction(b.angle)?c._dynamicPropertyMap.set("_angle",b.angle):c._angle=
b.angle;d.isFunction(b.horizontalAlignment)?c._dynamicPropertyMap.set("_horizontalAlignment",b.horizontalAlignment):c._horizontalAlignment=b.horizontalAlignment;d.isFunction(b.verticalAlignment)?c._dynamicPropertyMap.set("_verticalAlignment",b.verticalAlignment):c._verticalAlignment=b.verticalAlignment;c._scaleFactor=e;d.isFunction(b.text)?c._dynamicPropertyMap.set("_text",b.text):c._text=b.text;e=Math.min(Math.round(l.pt2px(b.referenceSize*b.sizeRatio)),127);c._referenceSize=Math.round(Math.sqrt(256*
e));c._materialKey=b.materialKey;e=g.TextMaterialKey.load(c._materialKey);e.sdf=!0;c._bitset=(1===b.alignment?1:0)|(b.colorLocked?1:0)<<1;c._materialKey=e.data;c._decoration="none";c._lineHeight=1;c._lineWidth=512;c._textPlacement=b.markerPlacement;c.effects=b.effects;c._isCIM=!0;return c}b.__extends(c,a);c.fromCIMText=function(a){return new c(a)};c.prototype.analyze=function(a,c,d,f){return b.__awaiter(this,void 0,void 0,function(){var g,h,k;return b.__generator(this,function(b){switch(b.label){case 0:return g=
c.readLegacyFeature(),b=this._cimTextLayer,h="string"===typeof b.text?b.text:"function"===typeof b.text?b.text(g,d,f):"",[4,a.getMosaicItem(this._cimTextLayer.cim,e.codepoints(h))];case 1:return k=b.sent(),this._textToGlyphs.set(h,k.glyphMosaicItems),[2,k]}})})};c.prototype.bindFeature=function(a,b,c){var d=this,e=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,f){d[f]=a(e,b,c)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=
this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=k.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=k.getYAnchorDirection(this._verticalAlignment||"baseline"),a=this._textToGlyphs.get(this._text),this.bindTextInfo(a,!1)):this._shapingInfo=null};return c}(f.default(c.default));a.default=m})},"esri/views/2d/layers/features/textUtils":function(){define(["require","exports"],function(m,a){Object.defineProperty(a,"__esModule",{value:!0});a.codepoints=void 0;a.codepoints=
function(a){for(var b=Array(a.length),k=0;k<a.length;k++)b[k]=a.charCodeAt(k);return b}})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports tslib ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n){Object.defineProperty(a,"__esModule",{value:!0});m=function(a){function e(b,
d,e,f,g,h,k,l,m){var n=a.call(this)||this;n.effects=m;b=c.FillMaterialKey.load(b);d&&(b.sdf=d.sdf,b.pattern=!0,b.textureBinding=d.textureBinding);n.fillColor=e;n.tl=f;n.br=g;n.aux1=h;n.aux2=k;n.aux3=l;n._materialKey=b.data;return n}b.__extends(e,a);e.fromCIMFill=function(a,b){var c=a.color,c=c&&h.premultiplyAlphaRGBA(c)||0,m=a.materialKey;if(!b)return b=f.i8888to32(0,0,0,a.colorLocked?1:0),new e(m,null,c,0,0,0,0,b,a.effects);var n=b.rect,p=b.width,q=b.height,t=n.x+g.SPRITE_PADDING,x=n.y+g.SPRITE_PADDING,
E=t+p,D=x+q,n=l.nextHighestPowerOfTwo(k.pt2px(a.height||0));255<n?n=255:0>=n&&(n=l.nextHighestPowerOfTwo(D-x));q=l.nextHighestPowerOfTwo(k.pt2px(a.height/q*p||0));255<q?q=255:0>=q&&(q=l.nextHighestPowerOfTwo(E-t));var F=k.pt2px(a.offsetX||0)+128;255<F&&(F=255);var H=k.pt2px(-a.offsetY||0)+128;255<H&&(H=255);p=a.scaleX||1;t=f.i1616to32(t,x);E=f.i1616to32(E,D);n=f.i8888to32(q,n,F,H);D=f.i1616to32(128*p,128);p=f.i8888to32(0,0,d.degToByte(a.angle),a.colorLocked?1:0);return new e(m,b,c,t,E,n,D,p,a.effects)};
e.fromSimpleFill=function(a,b,c){void 0===c&&(c=!1);var d=a.color,d=d&&"esriSFSNull"!==a.style&&h.premultiplyAlphaRGBAArray(d)||0;c=f.i8888to32(0,0,0,c?255:0);a=a.materialKey;if(!b)return new e(a,null,d,0,0,0,0,c,null);var k=b.rect,m=k.x+g.SPRITE_PADDING,n=k.y+g.SPRITE_PADDING,p=m+b.width,q=n+b.height,k=f.i1616to32(m,n),t=f.i1616to32(p,q),m=f.i8888to32(l.nextHighestPowerOfTwo(p-m),l.nextHighestPowerOfTwo(q-n),0,0),n=f.i1616to32(128,128);return new e(a,b,d,k,t,m,n,c,null)};e.fromPictureFill=function(a,
b,c){void 0===c&&(c=!1);var d=g.PICTURE_FILL_COLOR,h=b.rect,m=h.x+g.SPRITE_PADDING,n=h.y+g.SPRITE_PADDING,h=m+b.width,p=n+b.height,m=f.i1616to32(m,n),h=f.i1616to32(h,p),p=l.nextHighestPowerOfTwo(k.pt2px(a.width));255<p&&(p=255);n=l.nextHighestPowerOfTwo(k.pt2px(a.height));255<n&&(n=255);var q=k.pt2px(a.xoffset)+128;255<q&&(q=255);var t=k.pt2px(-a.yoffset)+128;255<t&&(t=255);p=f.i8888to32(p,n,q,t);n=f.i1616to32(128*a.xscale,128*a.yscale);c=f.i8888to32(0,0,0,c?255:0);return new e(a.materialKey,b,d,
m,h,p,n,c,null)};return e}(e.default(n.default));a.default=m})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n,t){Object.defineProperty(a,"__esModule",{value:!0});var x=l.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");
m=function(a){function l(b,d,f,g,h,k,l,m,n,p,q,t,x,K,L,O){var u=a.call(this)||this;b=c.LineMaterialKey.load(b);d&&(b.sdf=d.sdf,b.pattern=!0,b.textureBinding=d.textureBinding);u._capType=g;u._joinType=h;u._miterLimitCosine=e.getLimitCosine(k);u.tessellationProperties._fillColor=l;u.tessellationProperties._tl=m;u.tessellationProperties._br=n;u._hasPattern=p;u._isDashed=q;u._joinOnUTurn=L;u._isColorLocked=t;u._zOrder=K;u.effects=O;u._materialKey=b.data;u.tessellationProperties._bitset=t?1:0;u.tessellationProperties._halfWidth=
.5*f;u.tessellationProperties._halfReferenceWidth=.5*x;u._initializeTessellator(!1);return u}b.__extends(l,a);l.fromCIMLine=function(a,b,c){var e=a.color,f=a.scaleFactor||1,m=a.isDashed,n=a.cap;m&&1===n&&(n=2);var p=a.join,f=k.pt2px(a.width)*f,q=k.pt2px(a.referenceWidth),t=k.pt2px(a.miterLimit),e=e&&h.premultiplyAlphaRGBA(e)||0;if(!b)return new l(a.materialKey,b,f,n,p,t,e,0,0,!1,m,a.colorLocked,q,a.zOrder,c,a.effects);var u=b.rect,w=u.x+g.SPRITE_PADDING,x=u.y+g.SPRITE_PADDING,u=w+b.width,y=x+b.height,
w=d.i1616to32(w,x),u=d.i1616to32(u,y);return new l(a.materialKey,b,f,n,p,t,e,w,u,!0,m,a.colorLocked,q,a.zOrder,c,a.effects)};l.fromSimpleLine=function(a,b,c){var e=a.color,m="esriSLSSolid"!==a.style&&"esriSLSNull"!==a.style,n=f.getCapType(a.cap||"round",m),p=f.getJoinType(a.join||"round"),e=e&&"esriSLSNull"!==a.style&&h.premultiplyAlphaRGBAArray(e)||0;"esriSLSNull"===a.style&&(e=0);var q=k.pt2px(a.width),t=a.miterLimit;if(!b)return new l(a.materialKey,b,q,n,p,t,e,0,0,!1,m,!1,q,0,c,null);var u=b.rect,
w=u.x+g.SPRITE_PADDING,x=u.y+g.SPRITE_PADDING,u=w+b.width,y=x+b.height,w=d.i1616to32(w,x),u=d.i1616to32(u,y);return new l(a.materialKey,b,q,n,p,t,e,w,u,!0,m,!1,q,0,c,null)};l.fromPictureLineSymbol=function(a,b,c,d){x.error("PictureLineSymbol support does not exist!");return null};return l}(n.default(t.default));a.default=m})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(m,a,b){Object.defineProperty(a,"__esModule",{value:!0});
a.withLock=void 0;m=function(){function a(){this._resolver=null}a.prototype.isHeld=function(){return!!this._resolver};a.prototype.acquire=function(){var a=this;return this._resolver?this._resolver.promise.then(function(){return a.acquire()}):(this._resolver=b.createResolver(),b.resolve())};a.prototype.release=function(){var a=this._resolver;this._resolver=null;a.resolve()};return a}();a.default=m;a.withLock=function(a,b,h){return a.acquire().then(function(){return b(h)}).then(function(){return a.release()}).catch(function(b){a.release();
throw b;})}})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define(["require","exports","tslib","../../../../../core/HandleOwner","../../../../../core/accessorSupport/decorators"],function(m,a,b,l,k){Object.defineProperty(a,"__esModule",{value:!0});m=function(a){function g(){return null!==a&&a.apply(this,arguments)||this}b.__extends(g,a);g.prototype.initialize=function(){};g.prototype.destroy=function(){};Object.defineProperty(g.prototype,"supportsTileUpdates",{get:function(){return!1},
enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,"spatialReference",{get:function(){var a=this.get("tileStore.tileScheme.spatialReference");return a&&a.toJSON()||null},enumerable:!1,configurable:!0});b.__decorate([k.property({readOnly:!0})],g.prototype,"supportsTileUpdates",null);b.__decorate([k.property({constructOnly:!0})],g.prototype,"remoteClient",void 0);b.__decorate([k.property({constructOnly:!0})],g.prototype,"service",void 0);b.__decorate([k.property({dependsOn:["tileStore.tileScheme.spatialReference"]})],
g.prototype,"spatialReference",null);b.__decorate([k.property({constructOnly:!0})],g.prototype,"tileInfo",void 0);b.__decorate([k.property({constructOnly:!0})],g.prototype,"tileStore",void 0);return g=b.__decorate([k.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],g)}(l.HandleOwner);a.default=m})},"*noref":1}});
define("require exports tslib ../../../../core/HandleOwner ../../../../core/has ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../../../layers/support/TileInfo ../../ViewState ./processors ./controllers/FeatureController2D ./support/TileStore ./support/UpdateToken ../../tiling/TileInfoView".split(" "),function(m,a,b,l,k,h,g,d,f,c,e,n,t,x){Object.defineProperty(a,"__esModule",{value:!0});a.getInstances=void 0;var p=new Set;a.getInstances=function(){return p};m=function(a){function k(){var b=
null!==a&&a.apply(this,arguments)||this;b.controller=null;b.processor=null;b.remoteClient=null;b.tileStore=null;b.service=null;b.viewState=null;return b}b.__extends(k,a);k.prototype.initialize=function(){var a=this;this.handles.add(this.watch("updating",function(b){a.remoteClient.invoke("setUpdating",b).catch(function(a){})}))};k.prototype.destroy=function(){var a,b,c;null===(a=this.controller)||void 0===a?void 0:a.destroy();null===(b=this.processor)||void 0===b?void 0:b.destroy();null===(c=this.tileStore)||
void 0===c?void 0:c.destroy();this.controller=this.processor=this.tileStore=this.remoteClient=null};Object.defineProperty(k.prototype,"updating",{get:function(){return!this.controller||this.controller.updating},enumerable:!1,configurable:!0});k.prototype.startup=function(a){var c=a.service,e=a.config,f=a.tileInfo;return b.__awaiter(this,void 0,void 0,function(){var a;return b.__generator(this,function(b){switch(b.label){case 0:return this.service=c,this.tileStore||(a=new x(d.fromJSON(f)),this.tileStore=
new n.default(a)),[4,this._configure(e)];case 1:return b.sent(),this.tileStore.clear(),[2]}})})};k.prototype.updateTiles=function(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){this.tileStore.updateTiles(a);return[2]})})};k.prototype.update=function(a){var c=a.config,d=a.pause;return b.__awaiter(this,void 0,void 0,function(){var a;return b.__generator(this,function(b){switch(b.label){case 0:return a=t.UpdateToken.empty(),[4,h.all([this.processor.update(a,
c),this.controller.update(a,c,d)])];case 1:return b.sent(),[2,a.toJSON()]}})})};k.prototype.invalidate=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,d;return b.__generator(this,function(b){switch(b.label){case 0:return c=t.UpdateToken.create(a),d=this.controller.invalidate(c),[4,this.remoteClient.invoke("setUpdating",this.updating)];case 1:return b.sent(),[2,d]}})})};k.prototype.setViewState=function(a){a=f.fromJSON(a);this._set("viewState",a)};k.prototype._configure=function(a){return b.__awaiter(this,
void 0,void 0,function(){return b.__generator(this,function(b){switch(b.label){case 0:return[4,h.all([this._handleControllerConfig(a),this._handleProcessorConfig(a)])];case 1:return b.sent(),this.controller.processor=this.processor,[4,this.update({config:a})];case 2:return b.sent(),[2]}})})};k.prototype._handleControllerConfig=function(a){return b.__awaiter(this,void 0,void 0,function(){var c;return b.__generator(this,function(b){switch(b.label){case 0:return[4,this._createController(this.service,
a)];case 1:return c=b.sent(),[4,c.startup()];case 2:return b.sent(),[2,c]}})})};k.prototype._handleProcessorConfig=function(a){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(b){return[2,this._createProcessor(this.service,a)]})})};k.prototype._createController=function(a,c){return b.__awaiter(this,void 0,void 0,function(){var d,f,g,h;return b.__generator(this,function(b){this.controller&&this.controller.destroy();d=this;f=d.tileStore;g=d.remoteClient;this.controller=
h=new e.default({service:a,config:c,tileStore:f,remoteClient:g});return[2,h]})})};k.prototype._createProcessor=function(a,d){return b.__awaiter(this,void 0,void 0,function(){var e,f,g,h,k,l;return b.__generator(this,function(b){switch(b.label){case 0:return e=d.schema.processors[0].type,[4,c.loadProcessorModule(e)];case 1:return f=b.sent().default,g=this,h=g.remoteClient,k=g.tileStore,l=new f({service:a,config:d,tileStore:k,remoteClient:h}),this.processor&&this.processor.destroy(),this.processor=
l,[2,l]}})})};b.__decorate([g.property()],k.prototype,"controller",void 0);b.__decorate([g.property()],k.prototype,"processor",void 0);b.__decorate([g.property({dependsOn:["controller.updating"]})],k.prototype,"updating",null);b.__decorate([g.property()],k.prototype,"viewState",void 0);return k=b.__decorate([g.subclass("esri.views.2d.layers.features.Pipeline")],k)}(l.HandleOwner);a.default=m});