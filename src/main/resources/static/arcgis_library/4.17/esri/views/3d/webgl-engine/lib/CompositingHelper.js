// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/maybe ./glUtil3D ../shaders/CompositingTechnique ../../../webgl/Util".split(" "),function(h,k,l,n,g,m){Object.defineProperty(k,"__esModule",{value:!0});h=function(){function e(b,a){this._rctx=b;this._techniqueRepository=a;this._techniques=new Set}e.prototype.dispose=function(){var b=this;this._techniques.forEach(function(a){return b._techniqueRepository.release(a)});this._techniques.clear();l.isSome(this._vao)&&(this._vao.dispose(),this._vao=null)};e.prototype.composite=
function(b,a,d){void 0===a&&(a=0);void 0===d&&(d=1);this.compositeInternal(b,a,d,0)};e.prototype.compositeTransparent=function(b,a,e,f){void 0===f&&(f=1);var c=this._rctx;d.alphaMode=3;d.function=3;d.hasOpacityFactor=1!==f;f=this._techniqueRepository.acquire(g.CompositingTechnique,d);c.bindProgram(f.program);f.bindPipelineState(c);f.program.setUniform1i("colorTexture",1);c.bindTexture(b,1);f.program.setUniform1i("alphaTexture",2);c.bindTexture(a,2);f.program.setUniform1i("frontFaceTexture",3);c.bindTexture(e,
3);b=this.ensureVAO();c.bindVAO(b);c.drawArrays(5,0,m.vertexCount(b,"geometry"));this._techniqueRepository.release(f)};e.prototype.compositeSpecial=function(b,a){this.compositeInternal(b,0,1,a)};e.prototype.compositeInternal=function(b,a,e,f){var c=this._rctx;d.alphaMode=a;d.function=f;d.hasOpacityFactor=1!==e;a=this._techniqueRepository.acquire(g.CompositingTechnique,d);c.bindProgram(a.program);a.bindPipelineState(c);a.program.setUniform1i("tex",1);d.hasOpacityFactor&&a.program.setUniform1f("opacity",
e);c.bindTexture(b,1);b=this.ensureVAO();c.bindVAO(b);c.drawArrays(5,0,m.vertexCount(b,"geometry"));this._techniqueRepository.release(a)};e.prototype.ensureVAO=function(){l.isNone(this._vao)&&(this._vao=n.createQuadVAO(this._rctx));return this._vao};return e}();k.default=h;var d=new g.CompositingTechniqueConfiguration});