// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64","../../support/geometryUtils/triangle"],function(B,c,b,v,y){Object.defineProperty(c,"__esModule",{value:!0});c.getNewId=c.computeAttachmentOriginLines=c.computeAttachmentOriginPoints=c.computeAttachmentOriginTriangles=c.generateDefaultIndexArray=void 0;var u=1,w=null,z=new Uint32Array([0]);c.generateDefaultIndexArray=function(a){if(1===a)return z;if(a>u||null==w){for(;a>u;)u*=2;w=new Uint32Array(u);
for(var b=0;b<u;b++)w[b]=b}return new Uint32Array(w.buffer,0,a)};c.computeAttachmentOriginTriangles=function(a,l,e){if(!a)return!1;var m=a.strideIdx,c=a.offsetIdx;a=a.data;b.vec3.set(e,0,0,0);b.vec3.set(g,0,0,0);for(var t=0,h=0,k=0;k<l.length-2;k+=3){var f=l[k+0]*m+c,n=l[k+1]*m+c,p=l[k+2]*m+c;b.vec3.set(d,a[f+0],a[f+1],a[f+2]);b.vec3.set(r,a[n+0],a[n+1],a[n+2]);b.vec3.set(x,a[p+0],a[p+1],a[p+2]);(f=y.areaPoints3d(d,r,x))?(b.vec3.add(d,d,r),b.vec3.add(d,d,x),b.vec3.scale(d,d,1/3*f),b.vec3.add(e,e,
d),t+=f):(b.vec3.add(g,g,d),b.vec3.add(g,g,r),b.vec3.add(g,g,x),h+=3)}return 0===h&&0===t?!1:0!==t?(b.vec3.scale(e,e,1/t),!0):0!==h?(b.vec3.scale(e,g,1/h),!0):!1};c.computeAttachmentOriginPoints=function(a,d,e){if(!a||!d)return!1;var c=a.strideIdx,g=a.offsetIdx;a=a.data;b.vec3.set(e,0,0,0);for(var l=-1,h=0,k=0;k<d.length;k++){var f=d[k]*c+g;l!==f&&(e[0]+=a[f+0],e[1]+=a[f+1],e[2]+=a[f+2],h++);l=f}1<h&&b.vec3.scale(e,e,1/h);return 0<h};c.computeAttachmentOriginLines=function(a,c,e,m){if(!a)return!1;
var l=a.strideIdx,t=a.offsetIdx;a=a.data;b.vec3.set(m,0,0,0);b.vec3.set(g,0,0,0);var h=0,k=0,f=c?c.length-1:a.length/l-1;e=f+(e?2:0);for(var n=0;n<e;n+=2){var p=n<f?n:f,q=n<f?n+1:0,p=(c?c[p]:p)*l+t,q=(c?c[q]:q)*l+t;d[0]=a[p+0];d[1]=a[p+1];d[2]=a[p+2];r[0]=a[q+0];r[1]=a[q+1];r[2]=a[q+2];b.vec3.scale(d,b.vec3.add(d,d,r),.5);q=b.vec3.dist(d,r);0<q?(b.vec3.add(m,m,b.vec3.scale(d,d,q)),h+=q):(b.vec3.add(g,g,d),k++)}return 0!==h?(b.vec3.scale(m,m,1/h),!0):0!==k?(b.vec3.scale(m,g,1/k),!0):!1};var A=0;c.getNewId=
function(){return A++};var d=v.vec3f64.create(),r=v.vec3f64.create(),x=v.vec3f64.create(),g=v.vec3f64.create()});