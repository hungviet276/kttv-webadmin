// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../../../geometry/Extent ../../../layers/support/ExportWMSImageParameters ./DynamicLayerView3D ../../layers/WMSLayerView".split(" "),function(p,q,c,g,h,f,k,l,m,n){return function(d){function a(){return null!==d&&d.apply(this,arguments)||this}c.__extends(a,d);a.prototype.initialize=function(){var a=this;this.layer.supportsSpatialReference(this.view.spatialReference)||this.addResolvingPromise(h.reject(new g("layerview:spatial-reference-incompatible",
"The spatial references supported by this WMS layer are incompatible with the spatial reference of the view")));this._exportWMSImageParameters=new l({layer:this.layer,view:this.view});this.updatingHandles.add(this._exportWMSImageParameters,"version",function(){a.updatingHandles.addPromise(a.refreshDebounced())})};a.prototype.destroy=function(){this._exportWMSImageParameters&&(this._exportWMSImageParameters.layer=null,this._exportWMSImageParameters.destroy(),this._exportWMSImageParameters=null)};a.prototype.createFetchPopupFeaturesQuery=
function(a){var e=this.findExtentInfoAt(a),b=e.extent,b=new k(b[0],b[1],b[2],b[3],e.spatialReference),e=e.imageSize,c=e.width,d=b.width/c;return{extent:b,width:c,height:e.height,x:Math.round((a.x-b.xmin)/d),y:Math.round((b.ymax-a.y)/d)}};a.prototype.getFetchOptions=function(){return{timeExtent:this._exportWMSImageParameters.timeExtent}};c.__decorate([f.property({dependsOn:["view.spatialReference","layer.spatialReferences"]})],a.prototype,"suspended",void 0);return a=c.__decorate([f.subclass("esri.views.3d.layers.WMSLayerView3D")],
a)}(n.WMSLayerView(m))});