// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../definitions ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(q,u,v,C,f,D,E,r,F,B,p,G,H,I){Object.defineProperty(u,"__esModule",{value:!0});q=function(q){function l(a,d,h,f,k,c,m,g,l,r,J,K,z,w,e,x,t,A,y,u,v){var b=q.call(this)||
this;b.angle=f;b.height=m;b.width=c;b.xOffset=d*y;b.yOffset=h*y;b._markerPlacement=u;b.effects=v;b._anchorX=.5-(.5+x)*e.width/e.width;b._anchorY=.5-(.5+t)*e.height/e.height;d=(1===w?1:0)|(J?1:0)<<1|(z?1:0)<<2|(K?1:0)<<3;h=e&&e.sdf;a=G.MarkerMaterialKey.load(a);a.sdf=h;a.pattern=!0;a.textureBinding=e.textureBinding;b._materialKey=a.data;b._fillColor=k;b._outlineColor=l;b._sizeOutlineWidth=p.i8888to32(Math.round(Math.min(Math.sqrt(128*c),255)),Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*
r),255)),Math.round(Math.min(Math.sqrt(128*g),255)));k=e.rect.x+B.SPRITE_PADDING;g=e.rect.y+B.SPRITE_PADDING;l=k+e.width;e=g+e.height;b._texUpperLeft=p.i1616to32(k,g);b._texUpperRight=p.i1616to32(l,g);b._texBottomLeft=p.i1616to32(k,e);b._texBottomRight=p.i1616to32(l,e);c=c*A*y;m=m*A*y;b._bitestAndDistRatio=p.i8888to32(0,0,d,Math.round(Math.min(64*A,255)));b._computedWidth=c;b._computedHeight=m;c=E.vec2f32.create();m=D.mat2df32.create();b._applyTransformation(m,c);return b}v.__extends(l,q);l.fromCIMMarker=
function(a,d){var h=a.size,n=(d&&d.width||1)/(d&&d.height||1)*a.scaleX,k=a.scaleSymbolsProportionally&&a.frameHeight?h/a.frameHeight:1,c=r.premultiplyAlphaRGBA(a.color),m=r.premultiplyAlphaRGBA(a.outlineColor),g=f.pt2px(h),p=g*n,q=f.pt2px(a.offsetX||0),u=f.pt2px(a.offsetY||0),k=f.pt2px(a.outlineWidth||0)*k,v=a.alignment||0,z=f.pt2px(a.referenceSize),w=a.rotation||0;a.rotateClockwise||(w=-w);var e=0,x=0,t=a.anchorPoint;t&&(a.isAbsoluteAnchorPoint?h&&(e=-t.x/(h*n),x=t.y/h):(e=t.x,x=t.y));return new l(a.materialKey,
q,u,w,c,p,g,z,m,k,a.colorLocked,a.scaleSymbolsProportionally,!1,v,d,e,x,a.sizeRatio,C.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects)};l.fromPictureMarker=function(a,d){var h=Math.round(f.pt2px(a.width)),n=Math.round(f.pt2px(a.height)),k=F.PICTURE_FILL_COLOR,c=Math.round(f.pt2px(a.xoffset||0)),m=Math.round(f.pt2px(a.yoffset||0));return new l(a.materialKey,c,m,a.angle,k,h,n,n,0,0,!1,!1,!1,0,d,0,0,1,1,null,null)};l.fromSimpleMarker=function(a,d){var h=r.premultiplyAlphaRGBAArray(a.color),n=Math.round(f.pt2px(a.size)),
k=Math.round(f.pt2px(a.xoffset||0)),c=Math.round(f.pt2px(a.yoffset||0)),m=a.style,g=a.outline,p=(g&&g.color&&r.premultiplyAlphaRGBAArray(g.color))|0,g=(g&&g.width&&Math.round(f.pt2px(g.width)))|0;a=new l(a.materialKey,k,c,a.angle,h,n,n,n,p,g,!1,!1,"esriSMSCross"===m||"esriSMSX"===m,0,d,0,0,1.96875,1,null,null);a.boundsType="esriSMSCircle"===m?"circle":"square";return a};l.fromLineSymbolMarker=function(a,d){var h=r.premultiplyAlphaRGBAArray(a.color),n=Math.round(f.pt2px(6*a.lineWidth)),k="cross"===
a.style||"x"===a.style,c;switch(a.placement){case "begin-end":c="Both";break;case "begin":c="JustBegin";break;case "end":c="JustEnd";break;default:c="None"}c={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:c,offsetAlongLine:0};d=new l(a.materialKey,0,0,0,h,n,n,n/6,h,k?Math.round(f.pt2px(a.lineWidth)):0,!1,!1,k,1,d,0,0,1.96875,1,c,null);d.boundsType="circle"===a.style?"circle":"square";return d};return l}(H.default(I.default));u.default=q});