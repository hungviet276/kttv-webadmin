// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib @dojo/framework/shim/array ../../../core/maybe ../../../layers/support/fieldUtils".split(" "),function(u,a,k,t,l,e){Object.defineProperty(a,"__esModule",{value:!0});a.getFetchPopupTemplate=a.getRequiredFields=void 0;a.getRequiredFields=function(c,d){void 0===d&&(d=c.popupTemplate);return k.__awaiter(this,void 0,void 0,function(){var a,q,f,m,g,n,r,p,b;return k.__generator(this,function(h){switch(h.label){case 0:return l.isSome(d)?[4,d.getRequiredFields(c.fields)]:[2,[]];
case 1:return a=h.sent(),q=d.lastEditInfoEnabled,f=c.objectIdField,m=c.typeIdField,g=c.globalIdField,n=c.relationships,t.includes(a,"*")?[2,["*"]]:q?[4,e.getFeatureEditFields(c)]:[3,3];case 2:return p=h.sent(),[3,4];case 3:p=[],h.label=4;case 4:return r=p,b=e.fixFields(c.fields,k.__spreadArrays(a,r)),m&&b.push(m),b&&f&&e.hasField(c.fields,f)&&-1===b.indexOf(f)&&b.push(f),b&&g&&e.hasField(c.fields,g)&&-1===b.indexOf(g)&&b.push(g),n&&n.forEach(function(a){a=a.keyField;b&&a&&e.hasField(c.fields,a)&&
-1===b.indexOf(a)&&b.push(a)}),[2,b]}})})};a.getFetchPopupTemplate=function(a,d){return a.popupTemplate?a.popupTemplate:l.isSome(d)&&d.defaultPopupTemplateEnabled&&l.isSome(a.defaultPopupTemplate)?a.defaultPopupTemplate:null}});