// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":function(){define(["require","exports","tslib","../../../../../core/HandleOwner","../../../../../core/accessorSupport/decorators"],function(h,b,f,k,g){Object.defineProperty(b,"__esModule",{value:!0});h=function(b){function a(e){e=b.call(this,e)||this;e.tiles=new Map;return e}f.__extends(a,b);a.prototype.destroy=function(){this.tiles.clear();this.layer=this.layerView=this.tileInfoView=this.tiles=null};Object.defineProperty(a.prototype,
"updating",{get:function(){return this.isUpdating()},enumerable:!1,configurable:!0});a.prototype.acquireTile=function(e){var a=this,c=this.createTile(e);c.once("isReady",function(){return a.notifyChange("updating")});this.tiles.set(e.id,c);return c};a.prototype.forceAttributeTextureUpload=function(){};a.prototype.forEachTile=function(a){this.tiles.forEach(a)};a.prototype.releaseTile=function(a){this.tiles.delete(a.key.id);this.disposeTile(a)};a.prototype.isUpdating=function(){var a=!0;this.tiles.forEach(function(e){a=
a&&e.isReady});return!a};a.prototype.setHighlight=function(){};a.prototype.invalidateLabels=function(){};a.prototype.requestUpdate=function(){this.layerView.requestUpdate()};f.__decorate([g.property()],a.prototype,"layer",void 0);f.__decorate([g.property()],a.prototype,"layerView",void 0);f.__decorate([g.property()],a.prototype,"tileInfoView",void 0);f.__decorate([g.property()],a.prototype,"updating",null);return a=f.__decorate([g.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],
a)}(k.HandleOwner);b.default=h})},"esri/views/2d/layers/features/tileRenderers/support/WGLFeatureView":function(){define("require exports tslib ../../../../../../core/promiseUtils ../../../../engine/brushes ../../../../engine/FeatureContainer ../../../../engine/webgl/enums".split(" "),function(h,b,f,k,g,l,a){Object.defineProperty(b,"__esModule",{value:!0});b.WGLFeatureView=void 0;h=function(e){function b(c,a,b){c=e.call(this,c)||this;c._pointToCallbacks=new Map;c._layer=b;c._layerView=a;return c}
f.__extends(b,e);b.prototype.renderChildren=function(c){this.hasAnimation&&c.painter.effects.integrate.draw(c,c.attributeView);e.prototype.renderChildren.call(this,c)};b.prototype.hitTest=function(c,a){c=[c,a];a=k.createResolver();this._pointToCallbacks.set(c,a);this.requestRender();return a.promise};b.prototype.doRender=function(a){var c=this._layer,b=c.maxScale,d=a.state.scale;d<=(c.minScale||Infinity)&&d>=b&&e.prototype.doRender.call(this,a)};Object.defineProperty(b.prototype,"hasAnimation",{get:function(){return this.hasLabels},
enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"hasLabels",{get:function(){var a=this._layer.featureReduction,a=a&&"cluster"===a.type&&a.labelsVisible&&a.labelingInfo&&a.labelingInfo.length;return this._layer.labelingInfo&&this._layer.labelingInfo.length&&this._layer.labelsVisible||!!a},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"labelsVisible",{get:function(){return this._layer.labelsVisible},enumerable:!1,configurable:!0});b.prototype.prepareRenderPasses=
function(c){var b=this,h=c.registerRenderPass({name:"label",brushes:[g.brushes.label],target:function(){return b.hasLabels?b.children:null},drawPhase:a.WGLDrawPhase.LABEL|a.WGLDrawPhase.LABEL_ALPHA}),d=c.registerRenderPass({name:"geometry",brushes:[g.brushes.fill,g.brushes.line,g.brushes.marker,g.brushes.text],target:function(){return b.children},effects:[{apply:c.effects.highlight,enable:function(){return!!b._layerView.hasHighlight()}},{apply:c.effects.hittest,enable:function(){return!!b._pointToCallbacks.size},
args:function(){return b._pointToCallbacks}}]});return f.__spreadArrays(e.prototype.prepareRenderPasses.call(this,c),[d,h])};return b}(l.FeatureContainer);b.WGLFeatureView=h})},"*noref":1}});
define("require exports tslib ../../../../../core/has ../../../../../core/accessorSupport/decorators ../../../../../geometry/support/aaBoundingRect ../../../engine/webgl/WGLTile ../support/rendererUtils ./BaseTileRenderer ./support/visualVariablesUtils ./support/WGLFeatureView".split(" "),function(h,b,f,k,g,l,a,e,m,c,n){Object.defineProperty(b,"__esModule",{value:!0});h=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}f.__extends(d,b);d.prototype.install=function(a){var b=new n.WGLFeatureView(this.tileInfoView,
this.layerView,this.layer);this.featuresView=b;a.addChild(b)};d.prototype.uninstall=function(a){a.removeChild(this.featuresView);this.featuresView.destroy()};d.prototype.hitTest=function(a,b){return this.featuresView.hitTest(a,b)};d.prototype.supportsRenderer=function(a){return null!=a&&-1!==["simple","class-breaks","unique-value","dot-density","dictionary"].indexOf(a.type)};d.prototype.onConfigUpdate=function(a){var b=null;"visualVariables"in a&&(b=(e.simplifyVVRenderer(a).visualVariables||[]).map(function(a){var b=
a.clone();"normalizationField"in a&&(b.normalizationField=null);a.valueExpression&&"$view.scale"!==a.valueExpression&&(b.valueExpression=null,b.field="nop");return b}),b=c.convertVisualVariables(b));this.featuresView.setRendererInfo(a,b,this.layerView.effects)};d.prototype.onTileData=function(a){var b=this.tiles.get(a.tileKey);if(b)this.featuresView.onTileData(b,a.data);this.layerView.view.labelManager.requestUpdate()};d.prototype.onTileError=function(a){if(a=this.tiles.get(a.tileKey))this.featuresView.onTileError(a)};
d.prototype.forceAttributeTextureUpload=function(){this.featuresView.attributeView.forceTextureUpload()};d.prototype.lockGPUUploads=function(){this.featuresView.attributeView.lockTextureUpload();this.tiles.forEach(function(a){return a.lockUploads()})};d.prototype.unlockGPUUploads=function(){this.featuresView.attributeView.unlockTextureUpload();this.tiles.forEach(function(a){return a.unlockUploads()})};d.prototype.getMaterialItems=function(a){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,
function(b){return[2,this.featuresView.getMaterialItems(a)]})})};d.prototype.invalidateLabels=function(){this.featuresView.hasLabels&&(this.tiles.forEach(function(a){return a.isDirty=!0}),this.layerView.view.labelManager.requestUpdate())};d.prototype.createTile=function(b){var c=this.tileInfoView.getTileBounds(l.create(),b);b=new a.WGLTile(b,c);this.featuresView.hasLabels&&this.layerView.view.labelManager.addTile(this.layerView,b);return b};d.prototype.disposeTile=function(a){this.featuresView.removeChild(a);
this.featuresView.hasLabels&&this.layerView.view.labelManager.removeTile(this.layerView,a.key.id);a.destroy();this.layerView.view.labelManager.requestUpdate()};return d=f.__decorate([g.subclass("esri.views.2d.layers.features.tileRenderers.SymbolTileRenderer")],d)}(m.default);b.default=h});