// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports"],function(C,D){function F(a,d,b,e,c,f,k){var g;b=0;for(var l=e,n=c-f;l<c;l+=f)b+=(a[n+d*f]-a[l+d*f])*(a[l+1+d*f]+a[n+1+d*f]),n=l;if(k===0<b)for(k=e;k<c;k+=f)g=G(k+d*f,a[k+d*f],a[k+1+d*f],g);else for(k=c-f;k>=e;k-=f)g=G(k+d*f,a[k+d*f],a[k+1+d*f],g);g&&u(g,g.next)&&(x(g),g=g.next);return g}function y(a,d){void 0===d&&(d=a);if(!a)return a;var b;do if(b=!1,a.steiner||!u(a,a.next)&&0!==p(a.prev,a,a.next))a=a.next;else{x(a);a=d=a.prev;if(a===a.next)break;b=!0}while(b||a!==d);
return d}function z(a,d,b,e,c,f,k,g){if(a){!g&&f&&(a=H(a,e,c,f));for(var l=a;a.prev!==a.next;){var n=a.prev,m=a.next,h;if(f)h=M(a,e,c,f);else a:{h=a;var q=h.prev,A=h,r=h.next;if(0<=p(q,A,r))h=!1;else{for(var t=h.next.next,N=t,v=0;t!==h.prev&&(0===v||t!==N);){v++;if(w(q.x,q.y,A.x,A.y,r.x,r.y,t.x,t.y)&&0<=p(t.prev,t,t.next)){h=!1;break a}t=t.next}h=!0}}if(h)d.push(n.index/b+k),d.push(a.index/b+k),d.push(m.index/b+k),x(a),l=a=m.next;else if(a=m,a===l){if(!g)z(y(a),d,b,e,c,f,k,1);else if(1===g){g=d;l=
b;n=k;m=a;do h=m.prev,q=m.next.next,!u(h,q)&&I(h,m,m.next,q)&&B(h,q)&&B(q,h)&&(g.push(h.index/l+n),g.push(m.index/l+n),g.push(q.index/l+n),x(m),x(m.next),m=a=q),m=m.next;while(m!==a);a=m;z(a,d,b,e,c,f,k,2)}else if(2===g)a:{g=a;do{for(l=g.next.next;l!==g.prev;){if(n=g.index!==l.index){n=g;m=l;h=void 0;if(h=n.next.index!==m.index&&n.prev.index!==m.index){h=void 0;b:{h=n;do{if(h.index!==n.index&&h.next.index!==n.index&&h.index!==m.index&&h.next.index!==m.index&&I(h,h.next,n,m)){h=!0;break b}h=h.next}while(h!==
n);h=!1}h=!h}q=void 0;if(q=h&&B(n,m)&&B(m,n)){h=n;q=!1;A=(n.x+m.x)/2;m=(n.y+m.y)/2;do h.y>m!==h.next.y>m&&h.next.y!==h.y&&A<(h.next.x-h.x)*(m-h.y)/(h.next.y-h.y)+h.x&&(q=!q),h=h.next;while(h!==n)}n=q}if(n){a=J(g,l);g=y(g,g.next);a=y(a,a.next);z(g,d,b,e,c,f,k,0);z(a,d,b,e,c,f,k,0);break a}l=l.next}g=g.next}while(g!==a)}break}}}}function M(a,d,b,e){var c=a.prev,f=a.next;if(0<=p(c,a,f))return!1;var k=c.x>a.x?c.x>f.x?c.x:f.x:a.x>f.x?a.x:f.x,g=c.y>a.y?c.y>f.y?c.y:f.y:a.y>f.y?a.y:f.y,l=E(c.x<a.x?c.x<f.x?
c.x:f.x:a.x<f.x?a.x:f.x,c.y<a.y?c.y<f.y?c.y:f.y:a.y<f.y?a.y:f.y,d,b,e);d=E(k,g,d,b,e);b=a.prevZ;for(e=a.nextZ;b&&b.z>=l&&e&&e.z<=d;){if(b!==a.prev&&b!==a.next&&w(c.x,c.y,a.x,a.y,f.x,f.y,b.x,b.y)&&0<=p(b.prev,b,b.next))return!1;b=b.prevZ;if(e!==a.prev&&e!==a.next&&w(c.x,c.y,a.x,a.y,f.x,f.y,e.x,e.y)&&0<=p(e.prev,e,e.next))return!1;e=e.nextZ}for(;b&&b.z>=l;){if(b!==a.prev&&b!==a.next&&w(c.x,c.y,a.x,a.y,f.x,f.y,b.x,b.y)&&0<=p(b.prev,b,b.next))return!1;b=b.prevZ}for(;e&&e.z<=d;){if(e!==a.prev&&e!==a.next&&
w(c.x,c.y,a.x,a.y,f.x,f.y,e.x,e.y)&&0<=p(e.prev,e,e.next))return!1;e=e.nextZ}return!0}function G(a,d,b,e){a=v.create(a,d,b);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a}function x(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function O(a){var d=a,b=a;do{if(d.x<b.x||d.x===b.x&&d.y<b.y)b=d;d=d.next}while(d!==a);return b}function P(a,d){var b=d,e=a.x,c=a.y,f=-Infinity,k;do{if(c<=b.y&&c>=b.next.y&&b.next.y!==
b.y){var g=b.x+(c-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(g<=e&&g>f){f=g;if(g===e){if(c===b.y)return b;if(c===b.next.y)return b.next}k=b.x<b.next.x?b:b.next}}b=b.next}while(b!==d);if(!k)return null;if(e===f)return k.prev;d=k;for(var g=k.x,l=k.y,n=Infinity,m,b=k.next;b!==d;)e>=b.x&&b.x>=g&&e!==b.x&&w(c<l?e:f,c,g,l,c<l?f:e,c,b.x,b.y)&&(m=Math.abs(c-b.y)/(e-b.x),(m<n||m===n&&b.x>k.x)&&B(b,a)&&(k=b,n=m)),b=b.next;return k}function H(a,d,b,e){for(var c=void 0;c!==a;c=c.next){c=c||a;null===c.z&&(c.z=E(c.x,
c.y,d,b,e));if(c.prev.next!==c||c.next.prev!==c)return c.prev.next=c,c.next.prev=c,H(a,d,b,e);c.prevZ=c.prev;c.nextZ=c.next}a.prevZ.nextZ=null;a.prevZ=null;a:for(b=1;;){e=a;c=void 0;d=a=null;for(var f=0;e;){f++;for(var c=e,k=0;k<b&&c;k++)c=c.nextZ;for(var g=b;0<k||0<g&&c;){var l=void 0;0===k?(l=c,c=c.nextZ,g--):0!==g&&c?e.z<=c.z?(l=e,e=e.nextZ,k--):(l=c,c=c.nextZ,g--):(l=e,e=e.nextZ,k--);d?d.nextZ=l:a=l;l.prevZ=d;d=l}e=c}d.nextZ=null;b*=2;if(2>f)break a}return a}function p(a,d,b){return(d.y-a.y)*
(b.x-d.x)-(d.x-a.x)*(b.y-d.y)}function I(a,d,b,e){return u(a,d)&&u(b,e)||u(a,e)&&u(b,d)?!0:0<p(a,d,b)!==0<p(a,d,e)&&0<p(b,e,a)!==0<p(b,e,d)}function w(a,d,b,e,c,f,k,g){return 0<=(c-k)*(d-g)-(a-k)*(f-g)&&0<=(a-k)*(e-g)-(b-k)*(d-g)&&0<=(b-k)*(f-g)-(c-k)*(e-g)}function B(a,d){return 0>p(a.prev,a,a.next)?0<=p(a,d,a.next)&&0<=p(a,a.prev,d):0>p(a,d,a.prev)||0>p(a,a.next,d)}function E(a,d,b,e,c){a=32767*(a-b)*c;d=32767*(d-e)*c;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;d=(d|d<<8)&16711935;
d=(d|d<<4)&252645135;d=(d|d<<2)&858993459;return(a|a<<1)&1431655765|((d|d<<1)&1431655765)<<1}function u(a,d){return a.x===d.x&&a.y===d.y}function Q(a,d){return a.x-d.x}function J(a,d){var b=v.create(a.index,a.x,a.y),e=v.create(d.index,d.x,d.y),c=a.next,f=d.prev;a.next=d;d.prev=a;b.next=c;c.prev=b;e.next=b;b.prev=e;f.next=e;e.prev=f;return e}Object.defineProperty(D,"__esModule",{value:!0});D.bufcut=void 0;D.bufcut=function(a,d,b,e,c,f,k){K=0;var g=(e-b)*f,l=c&&c.length,n=l?(c[0]-b)*f:g,m=F(d,b,e,0,
n,f,!0);if(m&&m.next!==m.prev){var h,q,p;if(l){for(var l=[],r=0,t=c.length;r<t;r++){var u=F(d,b,e,c[r]*f,r<t-1?c[r+1]*f:e*f,f,!1);u===u.next&&(u.steiner=!0);l.push(O(u))}l.sort(Q);for(e=0;e<l.length;e++){c=l[e];r=m;if(r=P(c,r))c=J(r,c),y(c,c.next);m=y(m,m.next)}}if(g>80*f){h=g=d[0+b*f];q=p=d[1+b*f];for(l=f;l<n;l+=f)e=d[l+b*f],c=d[l+1+b*f],h=Math.min(h,e),q=Math.min(q,c),g=Math.max(g,e),p=Math.max(p,c);p=Math.max(g-h,p-q);p=0!==p?1/p:0}z(m,a,f,h,q,p,k,0)}};var v=function(){function a(){this.y=this.x=
this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}a.create=function(a,b,e){var c=L[K++];c.index=a;c.x=b;c.y=e;c.prev=null;c.next=null;c.z=null;c.prevZ=null;c.nextZ=null;c.steiner=!1;return c};return a}(),L=[],K=0;for(C=0;8096>C;C++)L.push(new v)});