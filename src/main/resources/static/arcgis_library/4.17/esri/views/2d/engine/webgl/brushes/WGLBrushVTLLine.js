// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../definitions ../enums ../number ./WGLBrush".split(" "),function(n,f,p,x,q,r,v,y,z,t){Object.defineProperty(f,"__esModule",{value:!0});f.WGLBrushVTLLine=f.C_DEG_TO_RAD=void 0;f.C_DEG_TO_RAD=Math.PI/180;var A=[1,1,1,1];n=function(f){function h(){var a=null!==f&&f.apply(this,arguments)||this;a._color=r.vec4f32.create();a._dashArray=q.vec2f32.create();a._programOptions=
{id:!1,dd:!1,pattern:!1};return a}p.__extends(h,f);h.prototype.dispose=function(){};h.prototype.drawMany=function(a,f){var l=a.context,d=a.displayLevel,m=a.state,b=a.drawPhase,h=a.styleLayerId,e=a.styleLayer,n=a.painter.getVectorTileProgramCach(),p=e.getPaintValue("line-translate",d),q=e.getPaintValue("line-translate-anchor",d),c=e.getPaintValue("line-pattern",d),u=void 0!==c,r=1/a.pixelRatio,t=e.getPaintValue("line-blur",d),k=e.hasDataDrivenColor?A:e.getPaintValue("line-color",d),g=e.hasDataDrivenOpacity?
1:e.getPaintValue("line-opacity",d),B=e.hasDataDrivenWidth?1:e.getPaintValue("line-width",d),g=g*k[3];this._color[0]=g*k[0];this._color[1]=g*k[1];this._color[2]=g*k[2];this._color[3]=g;var k=e.hasDataDrivenLine,g=b===y.WGLDrawPhase.HITTEST,w;g&&(w=z.u32to4Xu8(h+1));b=this._programOptions;b.id=g;b.dd=k;b.pattern=u;b=n.getProgram(3,(g?1:0)<<2|(k?1:0)<<1|(u?1:0),b);l.bindProgram(b);b.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);b.setUniformMatrix3fv("u_displayMat3",1===q?m.displayMat3:
m.displayViewMat3);b.setUniform2fv("u_lineTranslation",p);b.setUniform1f("u_depth",e.z);b.setUniform1f("u_blur",t);b.setUniform1f("u_antialiasing",r);b.setUniform4fv("u_color",this._color);b.setUniform1f("u_width",B);g&&b.setUniform4fv("u_id",w);if(u){if(a=a.spriteMosaic,c=a.getMosaicItemPosition(c,!0))a.bind(l,9729,c.page,v.VTL_TEXTURE_BINDING_UNIT_SPRITES),b.setUniform2f("u_pattern_tl",c.tl[0],c.br[1]),b.setUniform2f("u_pattern_br",c.br[0],c.tl[1]),b.setUniform2f("u_spriteSize",8*c.size[0],c.size[1]),
b.setUniform1i("u_texture",v.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else c=e.getPaintValue("line-dasharray",d),2>c.length&&(c=[1,-1]),this._dashArray[0]=8*c[0],this._dashArray[1]=8*c[1],b.setUniform2fv("u_dasharray",this._dashArray);for(c=0;c<f.length;c++)a=f[c],a.layerData[h]&&(d=a.layerData[h],d.prepareForRendering(l,n),m=d.lineVertexArrayObject,x.isNone(m)||(l.bindVAO(m),b.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),l.setStencilFunction(514,a.stencilRef,255),l.drawElements(4,d.lineIndexCount,
5125,Uint32Array.BYTES_PER_ELEMENT*d.lineIndexStart),a.triangleCount+=d.lineIndexCount/3))};return h}(t.default);f.WGLBrushVTLLine=n});