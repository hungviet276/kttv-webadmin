// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/views/2d/engine/Stage":function(){define("require exports tslib ../../../core/Error ../../../core/events ../../../core/has ../../../core/scheduling ../../../core/SetUtils ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l,w,p,y,z,C,B){Object.defineProperty(a,"__esModule",{value:!0});a.Stage=a.EXTRA_RENDER_TIME=void 0;a.EXTRA_RENDER_TIME=2E3;g=function(g){function x(c,b){var a=g.call(this)||this;a._trash=new Set;a._clipData=new Float32Array(8);a._upperLeft=r.vec2f64.create();a._upperRight=r.vec2f64.create();a._lowerLeft=r.vec2f64.create();a._lowerRight=r.vec2f64.create();a._mat2=u.mat2df64.create();a._clipRendererInitialized=!1;a._supersampleScreenshots=!0;a.renderRequested=
!1;a.stage=a;a._stationary=!0;var q=b.canvas,q=void 0===q?document.createElement("canvas"):q,d=b.alpha,l=b.stencil,e=b.renderContext,t=b.supersampleScreenshots,t=void 0===t?!0:t,v=b.contextOptions,v=void 0===v?{}:v;a._canvas=q;d=m.createContextOrErrorHTML(q,{alpha:void 0===d?!0:d,antialias:!1,depth:!0,stencil:void 0===l?!0:l},void 0===e?"webgl":e);a.context=new m.RenderingContext(d,v);a.painter=new w.default(a.context,a);f("esri-2d-profiler")&&(a._debugOutput=document.createElement("div"),a._debugOutput.setAttribute("style",
"margin: 24px 64px; position: absolute; color: red;"),c.appendChild(a._debugOutput));a._renderParameters={drawPhase:0,state:a.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:a.context,painter:a.painter,timeline:b.timeline||new C.Timeline,renderingOptions:b.renderingOptions,driverTestResult:y.testWebGLDriver(a.context),profiler:new p.Profiler(a.context,a._debugOutput),dataUploadCounter:0};a._taskHandle=
n.addFrameTask({render:function(c){return a.renderFrame(c)}});a._taskHandle.pause();a._supersampleScreenshots=t;a._lostWebGLContextHandle=h.on(q,"webglcontextlost",function(){a.emit("webgl-error",{error:new k("webgl-context-lost")})});q.setAttribute("style","width: 100%; height:100%; display:block;");c.appendChild(q);return a}e.__extends(x,g);x.prototype.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),
this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;
this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(x.prototype,"background",{get:function(){return this._background},set:function(c){this._background=c;this.requestRender()},enumerable:!1,configurable:!0});Object.defineProperty(x.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(c){var a=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=c)this._highlightOptionsHandle=
b.init(this._highlightOptions,"version",function(){a.painter.setHighlightOptions(c);a.requestRender()})},enumerable:!1,configurable:!0});Object.defineProperty(x.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(c){this._renderingOptions=c;this.requestRender()},enumerable:!1,configurable:!0});Object.defineProperty(x.prototype,"state",{get:function(){return this._state},set:function(c){this._state=c;this.requestRender()},enumerable:!1,configurable:!0});Object.defineProperty(x.prototype,
"stationary",{get:function(){return this._stationary},set:function(c){this._stationary!==c&&(this._stationary=c,this.requestRender())},enumerable:!1,configurable:!0});x.prototype.trashDisplayObject=function(c){this._trash.add(c);this.requestRender()};x.prototype.untrashDisplayObject=function(c){return this._trash.delete(c)};x.prototype.requestRender=function(){this._lastRenderRequestTime=performance.now();this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};
x.prototype.renderFrame=function(c){c.time-this._lastRenderRequestTime>=a.EXTRA_RENDER_TIME&&this._taskHandle.pause();this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=c.time;this._renderParameters.deltaTime=c.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();
this.emit("post-render")};x.prototype.renderChildren=function(c){this._renderChildren(this.children,c)};x.prototype._renderChildren=function(c,b){var a=this.context;b.profiler.recordStart("drawLayers");b.dataUploadCounter=0;this._beforeRenderChildren(b);b.drawPhase=l.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(a,this.background);for(var q=0;q<c.length;q++){var d=c[q];d.processRender(b)}this.painter.renderLayers(a);if(this._isLabelDrawPhaseRequired(c)){b.drawPhase=l.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(a);
for(q=0;q<c.length;q++)d=c[q],d.processRender(b);this.painter.renderLayers(a)}if(f("esri-tiles-debug")){b.drawPhase=l.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(a);for(q=0;q<c.length;q++)d=c[q],d.processRender(b);this.painter.renderLayers(a)}b.profiler.recordEnd("drawLayers");this._afterRenderChildren()};x.prototype._beforeRenderChildren=function(b){var a=this.context,d=b.state,p=b.pixelRatio;a.enforceState();var f=d.size;b=d.rotation;var l=Math.round(f[0]*p),f=Math.round(f[1]*p);this._boundFBO=
a.getBoundFramebufferObject();if(d.spatialReference&&(d.spatialReference._isWrappable?d.spatialReference._isWrappable():d.spatialReference.isWrappable)){var r=c.common.toRadian(b),e=Math.abs(Math.cos(r)),v=Math.abs(Math.sin(r)),u=Math.round(d.worldScreenWidth);if(Math.round(l*e+f*v)<=u)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===l&&this._clipFBO.height===f||(this._clipFBO=new m.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:l,height:f}));var w=(this.state.padding.left-
this.state.padding.right)/2,n=(this.state.padding.bottom-this.state.padding.top)/2,h=.5*l,k=.5*f,d=1/l,z=1/f,p=.5*u*p,y=.5*(l*v+f*e),l=this._upperLeft,e=this._upperRight,v=this._lowerLeft,u=this._lowerRight;t.vec2.set(l,-p,-y);t.vec2.set(e,p,-y);t.vec2.set(v,-p,y);t.vec2.set(u,p,y);q.mat2d.identity(this._mat2);q.mat2d.translate(this._mat2,this._mat2,[h+w,k+n]);0!==b&&q.mat2d.rotate(this._mat2,this._mat2,r);t.vec2.transformMat2d(l,l,this._mat2);t.vec2.transformMat2d(e,e,this._mat2);t.vec2.transformMat2d(v,
v,this._mat2);t.vec2.transformMat2d(u,u,this._mat2);b=this._clipData;b.set([2*v[0]*d-1,2*(f-v[1])*z-1,2*u[0]*d-1,2*(f-u[1])*z-1,2*l[0]*d-1,2*(f-l[1])*z-1,2*e[0]*d-1,2*(f-e[1])*z-1]);this._clipRendererInitialized||this._initializeClipRenderer(a);this._clipVBO.setData(b);this._boundFBO=a.getBoundFramebufferObject();a.bindFramebuffer(this._clipFBO);a.setDepthWriteEnabled(!0);a.setStencilWriteMask(255);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT|
a.gl.STENCIL_BUFFER_BIT);a.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1};x.prototype._afterRenderChildren=function(){var c=this.context;c.logIno();if(this._clipFrame&&this._clipRendererInitialized){c.bindFramebuffer(this._boundFBO);this._boundFBO=null;c.bindVAO(this._clipVAO);c.bindProgram(this._clipStencilProgram);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);c.setBlendingEnabled(!1);c.setColorMask(!1,!1,!1,!1);c.setStencilOp(7680,7680,7681);
c.setStencilWriteMask(255);c.setStencilFunction(519,1,255);c.drawElements(4,6,5123,0);c.bindVAO();c.setColorMask(!0,!0,!0,!0);if(null!=this.background){var b=this.background.color,a=b.a;c.setClearColor(a*b.r/255,a*b.g/255,a*b.b/255,a)}else c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);c.setBlendingEnabled(!0);c.setStencilFunction(514,1,255);this.painter.blitTexture(c,this._clipFBO.colorTexture,9728,1);c.setStencilTestEnabled(!1)}};x.prototype.doRender=function(c){var b=this.context,a=c.state,
q=c.pixelRatio;this._resizeCanvas(c);this.context.enforceState();b.setViewport(0,0,q*a.size[0],q*a.size[1]);b.setDepthWriteEnabled(!0);b.setStencilWriteMask(255);g.prototype.doRender.call(this,c)};x.prototype.takeScreenshot=function(c,b){return e.__awaiter(this,void 0,void 0,function(){var a,q,d,f,p,l,r,t,v,u,w,n,h,k;return e.__generator(this,function(z){a=B.screenshotSuperSampleSettings(c,this._supersampleScreenshots,this._state.padding);q=a.framebufferWidth;d=a.framebufferHeight;f=this.context;
p=c.layers;l=this.children;r=e.__assign(e.__assign({},this._renderParameters),{drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:a.pixelRatio,time:Date.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1});null!=c.rotation&&(t=r.state.viewpoint,t.rotation=c.rotation,r.state.viewpoint=t);0<p.length&&(l=[],p.forEach(function(c){var a=b.find(function(b){return b.layer.id===c.id});a&&"container"in a&&a.container&&l.push(a.container)}));v=
new m.FramebufferObject(f,{colorTarget:0,depthStencilTarget:3,width:q,height:d});u=f.getBoundFramebufferObject();w=f.getViewport();f.bindFramebuffer(v);f.setViewport(0,0,q,d);this._renderChildren(l,r);n=this._readbackScreenshot(a);f.bindFramebuffer(u);f.setViewport(w.x,w.y,w.width,w.height);this.requestRender();h=this._ensureScreenshotEncodeCanvas();k=B.encodeResult(n,c,h,{flipY:!0,premultipliedAlpha:!0});return[2,k]})})};x.prototype._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||
(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};x.prototype._readbackScreenshot=function(c){var b=c.framebufferWidth,a=c.framebufferHeight,q=c.region;c=c.resample;var d=this.context.gl;if(c){var m=B.createEmptyImageData(b,a,this._ensureScreenshotEncodeCanvas());d.readPixels(0,0,b,a,6408,5121,new Uint8Array(m.data.buffer));b=B.createEmptyImageData(q.width,q.height,this._ensureScreenshotEncodeCanvas());return B.resampleHermite(m,b,!0,c.region.x,a-
(c.region.y+c.region.height),c.region.width,c.region.height)}m=B.createEmptyImageData(q.width,q.height,this._ensureScreenshotEncodeCanvas());d.readPixels(q.x,a-(q.y+q.height),q.width,q.height,6408,5121,new Uint8Array(m.data.buffer));return m};x.prototype._resizeCanvas=function(c){var b=this._canvas,a=b.style,q=c.state.size,d=c.pixelRatio;c=q[0];var q=q[1],m=Math.round(c*d),d=Math.round(q*d);if(b.width!==m||b.height!==d)b.width=m,b.height=d;a.width=c+"px";a.height=q+"px"};x.prototype._initializeClipRenderer=
function(c){if(this._clipRendererInitialized)return!0;var b=z.stencil.attributes,a=m.createProgram(c,z.stencil);if(!a)return!1;var q=m.BufferObject.createVertex(c,35040,32),d=new Uint16Array([0,1,2,2,1,3]),d=m.BufferObject.createIndex(c,35044,d);c=new m.VertexArrayObject(c,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:q},d);this._clipStencilProgram=a;this._clipVBO=q;this._clipVAO=c;return this._clipRendererInitialized=!0};x.prototype._emptyTrash=
function(){for(;0<this._trash.size;){var c=d.valuesOfSet(this._trash);this._trash.clear();for(var b=0;b<c.length;b++)c[b].processDetach()}};x.prototype._isLabelDrawPhaseRequired=function(c){for(var b=!1,a=0;a<c.length;a++){var q=c[a];if(!(q instanceof v.Container)){b=b||!1;break}if(q.hasLabels)return!0;b=b||this._isLabelDrawPhaseRequired(q.children)}return b};return x}(v.Container);a.Stage=g})},"esri/views/2d/engine/Container":function(){define("require exports tslib ../../../core/has ./DisplayObject ../../layers/effects/EffectList".split(" "),
function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.Container=void 0;var n=k("mapview-transitions-duration");g=function(a){function b(){var c=null!==a&&a.apply(this,arguments)||this;c._childrenSet=new Set;c.children=[];c._effectList=null;return c}e.__extends(b,a);Object.defineProperty(b.prototype,"blendMode",{get:function(){return this._blendMode},set:function(c){this._blendMode=c;this.requestRender()},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"clips",
{get:function(){return this._clips},set:function(c){this._clips=c;this.children.forEach(function(b){return b.clips=c})},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"computedEffects",{get:function(){var c,b;return null!==(b=null===(c=this._effectList)||void 0===c?void 0:c.effects)&&void 0!==b?b:null},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"effect",{get:function(){var c,b;return null!==(b=null===(c=this._effectList)||void 0===c?void 0:c.effect)&&void 0!==
b?b:""},set:function(c){if(this._effectList||c)this._effectList||(this._effectList=new f.default(n)),this._effectList.effect=c,this.requestRender()},enumerable:!1,configurable:!0});b.prototype.updateTransitionProperties=function(c){a.prototype.updateTransitionProperties.call(this,c);this._effectList&&(this._effectList.transitionStep(c),this._effectList.transitioning&&this.requestRender())};b.prototype.doRender=function(c){c=this.createRenderParams(c);this.renderChildren(c)};b.prototype.addChild=function(c){return this.addChildAt(c,
this.children.length)};b.prototype.addChildAt=function(c,b){void 0===b&&(b=this.children.length);if(!c||this.contains(c))return c;var a=c.parent;a&&a!==this&&a.removeChild(c);b>=this.children.length?this.children.push(c):this.children.splice(b,0,c);this._childrenSet.add(c);c.parent=this;c.stage=this.stage;this!==this.stage&&(c.clips=this.clips);this.requestRender();return c};b.prototype.contains=function(c){return this._childrenSet.has(c)};b.prototype.removeAllChildren=function(){this._childrenSet.clear();
for(var c=0,b=this.children;c<b.length;c++){var a=b[c];this!==this.stage&&(a.clips=null);a.stage=null;a.parent=null}this.children.length=0};b.prototype.removeChild=function(c){return this.contains(c)?this.removeChildAt(this.children.indexOf(c)):c};b.prototype.removeChildAt=function(c){if(0>c||c>=this.children.length)return null;c=this.children.splice(c,1)[0];this._childrenSet.delete(c);this!==this.stage&&(c.clips=null);c.stage=null;c.parent=null;return c};b.prototype.sortChildren=function(c){return this.children.sort(c)};
b.prototype.onAttach=function(){a.prototype.onAttach.call(this);for(var c=this.stage,b=0,d=this.children;b<d.length;b++)d[b].stage=c};b.prototype.onDetach=function(){a.prototype.onDetach.call(this);for(var c=0,b=this.children;c<b.length;c++)b[c].stage=null};b.prototype.renderChildren=function(c){for(var b=this.children,a=b.length,d=0;d<a;d++)b[d].processRender(c)};b.prototype.createRenderParams=function(c){return e.__assign(e.__assign({},c),{blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:c.globalOpacity*
this.computedOpacity,inFadeTransition:this.inFadeTransition})};return b}(h.DisplayObject);a.Container=g})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","tslib","../../../core/Evented","../../../core/has"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.DisplayObject=void 0;var f=1/h("mapview-transitions-duration");g=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._clips=null;b.computedVisible=!0;b.computedOpacity=1;b.fadeTransitionEnabled=
!1;b.inFadeTransition=!1;b._isReady=!1;b._opacity=1;b._stage=null;b._visible=!0;return b}e.__extends(d,a);Object.defineProperty(d.prototype,"clips",{get:function(){return this._clips},set:function(b){this._clips=b;this.requestRender()},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"isReady",{get:function(){return this._isReady},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"opacity",{get:function(){return this._opacity},set:function(b){this._opacity!==b&&(this._opacity=
Math.min(1,Math.max(b,0)),this.requestRender())},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"stage",{get:function(){return this._stage},set:function(b){if(this._stage!==b){var c=this._stage;(this._stage=b)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):c.trashDisplayObject(this)}},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"visible",{get:function(){return this._visible},set:function(b){this._visible!==b&&(this._visible=b,
this.requestRender())},enumerable:!1,configurable:!0});d.prototype.setTransform=function(b){};d.prototype.processRender=function(b){this.stage&&(this.updateTransitionProperties(b.deltaTime),this.computedVisible&&this.doRender(b))};d.prototype.requestRender=function(){this.stage&&this.stage.requestRender()};d.prototype.processDetach=function(){this.onDetach();this.emit("detach")};d.prototype.updateTransitionProperties=function(b){if(this.fadeTransitionEnabled){var c=this.visible?this.opacity:0,a=this.computedOpacity;
a===c?this.computedVisible=this.visible:(b*=f,this.computedOpacity=a>c?Math.max(c,a-b):Math.min(c,a+b),this.computedVisible=0<this.computedOpacity,c=c===this.computedOpacity,this.inFadeTransition=!c,c||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};d.prototype.onAttach=function(){};d.prototype.onDetach=function(){};d.prototype.doRender=function(b){};d.prototype.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};
return d}(k);a.DisplayObject=g})},"esri/views/layers/effects/EffectList":function(){define("require exports tslib ../../../colorUtils ./effects ./parser".split(" "),function(g,a,e,k,h,f){function n(a){switch(a){case "grayscale":case "sepia":case "invert":return new h.ColorMatrixEffect(a,0);case "saturate":case "brightness":case "contrast":return new h.ColorMatrixEffect(a,1);case "opacity":return new h.OpacityEffect(1);case "hue-rotate":return new h.HueRotateEffect(0);case "radial-blur":case "blur":return new h.BlurEffect(a,
0);case "drop-shadow":return new h.DropShadowEffect(0,0,0,e.__spreadArrays(k.getNamedColor("transparent")));case "bloom":return new h.BloomEffect(0,0,0)}}Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(b){void 0===b&&(b=200);this.duration=b;this._to=this._from=null;this._time=this._toNumEffects=0;this._effects=[];this._effect=""}Object.defineProperty(a.prototype,"effects",{get:function(){return this._effects},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"effect",{get:function(){return this._effect},set:function(b){(this._effect=b)?(b=f.parse(b),b.error?(this._from=this._to=null,this._toNumEffects=0,this._effects=[]):this._transitionTo(b.effects)):this._transitionTo([])},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"transitioning",{get:function(){return null!==this._to},enumerable:!1,configurable:!0});a.prototype.transitionStep=function(b){if(this._to){this._time+=b;b=Math.min(1,this._time/this.duration);for(var c=0;c<this._effects.length;c++)this._effects[c].interpolate(this._from[c],
this._to[c],b);1===b&&(this._effects.length=this._toNumEffects,this._from=this._to=null,this._toNumEffects=0)}};a.prototype._transitionTo=function(b){var c=this._effects,a=c.length>b.length?c:b,d=c.length>b.length?b:c;if(d.every(function(c,b){return c.type===a[b].type})){this._toNumEffects=b.length;for(var f=d.length;f<a.length;f++)d.push(n(a[f].type));this._from=c.map(function(c){return c.clone()});this._to=b;this._time=0}else this._from=this._to=null,this._toNumEffects=0,this._effects=b};return a}();
a.default=g})},"esri/views/layers/effects/effects":function(){define(["require","exports","tslib","../../../core/libs/gl-matrix-2/mat4","../../../core/libs/gl-matrix-2/mat4f32"],function(g,a,e,k,h){function f(a,d,b){return a+(d-a)*b}Object.defineProperty(a,"__esModule",{value:!0});a.OpacityEffect=a.HueRotateEffect=a.DropShadowEffect=a.ColorMatrixEffect=a.sepia=a.grayscale=a.BlurEffect=a.BloomEffect=void 0;g=function(){function a(a,b,c){this.strength=a;this.radius=b;this.threshold=c;this.type="bloom"}
a.prototype.interpolate=function(a,b,c){this.strength=f(a.strength,b.strength,c);this.radius=f(a.radius,b.radius,c);this.threshold=f(a.threshold,b.threshold,c)};a.prototype.clone=function(){return new a(this.strength,this.radius,this.threshold)};return a}();a.BloomEffect=g;g=function(){function a(a,b){this.type=a;this.radius=b}a.prototype.interpolate=function(a,b,c){this.radius=Math.round(f(a.radius,b.radius,c))};a.prototype.clone=function(){return new a(this.type,this.radius)};return a}();a.BlurEffect=
g;a.grayscale=function(a,d){d=1-d;a=k.mat4.set(a,.2126+.7874*d,.7152-.7152*d,.0722-.0722*d,0,.2126-.2126*d,.7152+.2848*d,.0722-.0722*d,0,.2126-.2126*d,.7152-.7152*d,.0722+.9278*d,0,0,0,0,1);return k.mat4.transpose(a,a)};a.sepia=function(a,d){d=1-d;a=k.mat4.set(a,.393+.607*d,.769-.769*d,.189-.189*d,0,.349-.349*d,.686+.314*d,.168-.168*d,0,.272-.272*d,.534-.534*d,.131+.869*d,0,0,0,0,1);return k.mat4.transpose(a,a)};g=function(){function e(a,b){this.type=a;this.amount=b;if("invert"===this.type||"grayscale"===
this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}Object.defineProperty(e.prototype,"colorMatrix",{get:function(){this._colorMatrix||this._updateMatrix();return this._colorMatrix},enumerable:!1,configurable:!0});e.prototype.interpolate=function(a,b,c){this.amount=f(a.amount,b.amount,c);this._updateMatrix()};e.prototype.clone=function(){return new e(this.type,this.amount)};e.prototype._updateMatrix=function(){var d=this._colorMatrix||h.mat4f32.create();switch(this.type){case "brightness":var b=
this.amount,d=k.mat4.set(d,b,0,0,0,0,b,0,0,0,0,b,0,0,0,0,1);this._colorMatrix=k.mat4.transpose(d,d);break;case "contrast":b=this.amount;d=k.mat4.set(d,b,0,0,.5-.5*b,0,b,0,.5-.5*b,0,0,b,.5-.5*b,0,0,0,1);this._colorMatrix=k.mat4.transpose(d,d);break;case "grayscale":this._colorMatrix=a.grayscale(d,this.amount);break;case "invert":var b=this.amount,c=1-2*b,d=k.mat4.set(d,c,0,0,b,0,c,0,b,0,0,c,b,0,0,0,1);this._colorMatrix=k.mat4.transpose(d,d);break;case "saturate":b=this.amount;d=k.mat4.set(d,.213+.787*
b,.715-.715*b,.072-.072*b,0,.213-.213*b,.715+.285*b,.072-.072*b,0,.213-.213*b,.715-.715*b,.072+.928*b,0,0,0,0,1);this._colorMatrix=k.mat4.transpose(d,d);break;case "sepia":this._colorMatrix=a.sepia(d,this.amount)}};return e}();a.ColorMatrixEffect=g;g=function(){function a(a,b,c,q){this.offsetX=a;this.offsetY=b;this.blurRadius=c;this.color=q;this.type="drop-shadow"}a.prototype.interpolate=function(a,b,c){this.offsetX=f(a.offsetX,b.offsetX,c);this.offsetY=f(a.offsetY,b.offsetY,c);this.blurRadius=f(a.blurRadius,
b.blurRadius,c);this.color[0]=Math.round(f(a.color[0],b.color[0],c));this.color[1]=Math.round(f(a.color[1],b.color[1],c));this.color[2]=Math.round(f(a.color[2],b.color[2],c));this.color[3]=f(a.color[3],b.color[3],c)};a.prototype.clone=function(){return new a(this.offsetX,this.offsetY,this.blurRadius,e.__spreadArrays(this.color))};return a}();a.DropShadowEffect=g;g=function(){function a(a){this.angle=a;this.type="hue-rotate"}Object.defineProperty(a.prototype,"colorMatrix",{get:function(){this._colorMatrix||
this._updateMatrix();return this._colorMatrix},enumerable:!1,configurable:!0});a.prototype.interpolate=function(a,b,c){this.angle=f(a.angle,b.angle,c);this._updateMatrix()};a.prototype.clone=function(){return new a(this.angle)};a.prototype._updateMatrix=function(){var a=this._colorMatrix||h.mat4f32.create(),b=this.angle,c=Math.sin(b*Math.PI/180),b=Math.cos(b*Math.PI/180),a=k.mat4.set(a,.213+.787*b-.213*c,.715-.715*b-.715*c,.072-.072*b+.928*c,0,.213-.213*b+.143*c,.715+.285*b+.14*c,.072-.072*b-.283*
c,0,.213-.213*b-.787*c,.715-.715*b+.715*c,.072+.928*b+.072*c,0,0,0,0,1);this._colorMatrix=k.mat4.transpose(a,a)};return a}();a.HueRotateEffect=g;g=function(){function a(a){this.amount=a;this.type="opacity";this.amount=Math.min(this.amount,1)}a.prototype.interpolate=function(a,b,c){this.amount=f(a.amount,b.amount,c)};a.prototype.clone=function(){return new a(this.amount)};return a}();a.OpacityEffect=g})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],function(g,
a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat4=void 0;a.mat4=e})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(g,a,e,k){function h(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c}function f(c,b,a){var q=b[0],d=b[1],m=b[2],f=b[3],l=b[4],e=b[5],p=b[6],u=b[7],h=b[8],k=b[9],n=b[10],g=b[11],x=b[12],A=b[13],F=b[14];b=b[15];var I=a[0],
G=a[1],J=a[2],H=a[3];c[0]=I*q+G*l+J*h+H*x;c[1]=I*d+G*e+J*k+H*A;c[2]=I*m+G*p+J*n+H*F;c[3]=I*f+G*u+J*g+H*b;I=a[4];G=a[5];J=a[6];H=a[7];c[4]=I*q+G*l+J*h+H*x;c[5]=I*d+G*e+J*k+H*A;c[6]=I*m+G*p+J*n+H*F;c[7]=I*f+G*u+J*g+H*b;I=a[8];G=a[9];J=a[10];H=a[11];c[8]=I*q+G*l+J*h+H*x;c[9]=I*d+G*e+J*k+H*A;c[10]=I*m+G*p+J*n+H*F;c[11]=I*f+G*u+J*g+H*b;I=a[12];G=a[13];J=a[14];H=a[15];c[12]=I*q+G*l+J*h+H*x;c[13]=I*d+G*e+J*k+H*A;c[14]=I*m+G*p+J*n+H*F;c[15]=I*f+G*u+J*g+H*b;return c}function n(c,b,a){var q=b[0],d=b[1],m=b[2],
f=b[3],l=q+q,e=d+d,p=m+m;b=q*l;var u=q*e,q=q*p,h=d*e,d=d*p,m=m*p,l=f*l,e=f*e,f=f*p;c[0]=1-(h+m);c[1]=u+f;c[2]=q-e;c[3]=0;c[4]=u-f;c[5]=1-(b+m);c[6]=d+l;c[7]=0;c[8]=q+e;c[9]=d-l;c[10]=1-(b+h);c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c}function d(c,b,a){c[0]=b[0]-a[0];c[1]=b[1]-a[1];c[2]=b[2]-a[2];c[3]=b[3]-a[3];c[4]=b[4]-a[4];c[5]=b[5]-a[5];c[6]=b[6]-a[6];c[7]=b[7]-a[7];c[8]=b[8]-a[8];c[9]=b[9]-a[9];c[10]=b[10]-a[10];c[11]=b[11]-a[11];c[12]=b[12]-a[12];c[13]=b[13]-a[13];c[14]=b[14]-
a[14];c[15]=b[15]-a[15];return c}Object.defineProperty(a,"__esModule",{value:!0});a.sub=a.mul=a.equals=a.exactEquals=a.multiplyScalarAndAdd=a.multiplyScalar=a.subtract=a.add=a.frob=a.str=a.targetTo=a.lookAt=a.ortho=a.perspectiveFromFieldOfView=a.perspective=a.frustum=a.fromQuat=a.fromRotationTranslationScaleOrigin=a.fromRotationTranslationScale=a.getRotation=a.getScaling=a.getTranslation=a.fromQuat2=a.fromRotationTranslation=a.fromZRotation=a.fromYRotation=a.fromXRotation=a.fromRotation=a.fromScaling=
a.fromTranslation=a.rotateZ=a.rotateY=a.rotateX=a.rotate=a.scale=a.translate=a.multiply=a.determinant=a.adjoint=a.invert=a.transpose=a.identity=a.set=a.copy=void 0;a.copy=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.set=function(b,a,d,f,r,m,e,l,w,p,h,k,n,g,E,x,A){b[0]=a;b[1]=d;b[2]=f;b[3]=r;b[4]=m;b[5]=e;b[6]=l;b[7]=w;b[8]=p;b[9]=h;b[10]=k;b[11]=
n;b[12]=g;b[13]=E;b[14]=x;b[15]=A;return b};a.identity=h;a.transpose=function(b,a){if(b===a){var c=a[1],q=a[2],d=a[3],m=a[6],f=a[7],l=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=q;b[9]=m;b[11]=a[14];b[12]=d;b[13]=f;b[14]=l}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};a.invert=function(b,a){var c=a[0],d=a[1],q=a[2],m=a[3],f=a[4],l=a[5],
e=a[6],p=a[7],h=a[8],k=a[9],n=a[10],g=a[11],E=a[12],x=a[13],A=a[14];a=a[15];var F=c*l-d*f,I=c*e-q*f,G=c*p-m*f,J=d*e-q*l,H=d*p-m*l,M=q*p-m*e,L=h*x-k*E,K=h*A-n*E,N=h*a-g*E,Q=k*A-n*x,O=k*a-g*x,T=n*a-g*A,R=F*T-I*O+G*Q+J*N-H*K+M*L;if(!R)return null;R=1/R;b[0]=(l*T-e*O+p*Q)*R;b[1]=(q*O-d*T-m*Q)*R;b[2]=(x*M-A*H+a*J)*R;b[3]=(n*H-k*M-g*J)*R;b[4]=(e*N-f*T-p*K)*R;b[5]=(c*T-q*N+m*K)*R;b[6]=(A*G-E*M-a*I)*R;b[7]=(h*M-n*G+g*I)*R;b[8]=(f*O-l*N+p*L)*R;b[9]=(d*N-c*O-m*L)*R;b[10]=(E*H-x*G+a*F)*R;b[11]=(k*G-h*H-g*F)*
R;b[12]=(l*K-f*Q-e*L)*R;b[13]=(c*Q-d*K+q*L)*R;b[14]=(x*I-E*J-A*F)*R;b[15]=(h*J-k*I+n*F)*R;return b};a.adjoint=function(b,a){var c=a[0],d=a[1],q=a[2],m=a[3],f=a[4],l=a[5],e=a[6],p=a[7],h=a[8],k=a[9],n=a[10],g=a[11],E=a[12],x=a[13],A=a[14];a=a[15];b[0]=l*(n*a-g*A)-k*(e*a-p*A)+x*(e*g-p*n);b[1]=-(d*(n*a-g*A)-k*(q*a-m*A)+x*(q*g-m*n));b[2]=d*(e*a-p*A)-l*(q*a-m*A)+x*(q*p-m*e);b[3]=-(d*(e*g-p*n)-l*(q*g-m*n)+k*(q*p-m*e));b[4]=-(f*(n*a-g*A)-h*(e*a-p*A)+E*(e*g-p*n));b[5]=c*(n*a-g*A)-h*(q*a-m*A)+E*(q*g-m*n);
b[6]=-(c*(e*a-p*A)-f*(q*a-m*A)+E*(q*p-m*e));b[7]=c*(e*g-p*n)-f*(q*g-m*n)+h*(q*p-m*e);b[8]=f*(k*a-g*x)-h*(l*a-p*x)+E*(l*g-p*k);b[9]=-(c*(k*a-g*x)-h*(d*a-m*x)+E*(d*g-m*k));b[10]=c*(l*a-p*x)-f*(d*a-m*x)+E*(d*p-m*l);b[11]=-(c*(l*g-p*k)-f*(d*g-m*k)+h*(d*p-m*l));b[12]=-(f*(k*A-n*x)-h*(l*A-e*x)+E*(l*n-e*k));b[13]=c*(k*A-n*x)-h*(d*A-q*x)+E*(d*n-q*k);b[14]=-(c*(l*A-e*x)-f*(d*A-q*x)+E*(d*e-q*l));b[15]=c*(l*n-e*k)-f*(d*n-q*k)+h*(d*e-q*l);return b};a.determinant=function(b){var c=b[0],a=b[1],d=b[2],f=b[3],m=
b[4],e=b[5],l=b[6],k=b[7],p=b[8],h=b[9],n=b[10],g=b[11],B=b[12],E=b[13],x=b[14];b=b[15];return(c*e-a*m)*(n*b-g*x)-(c*l-d*m)*(h*b-g*E)+(c*k-f*m)*(h*x-n*E)+(a*l-d*e)*(p*b-g*B)-(a*k-f*e)*(p*x-n*B)+(d*k-f*l)*(p*E-h*B)};a.multiply=f;a.translate=function(b,a,d){var c=d[0],q=d[1];d=d[2];var m=void 0,f=void 0,l=void 0,e=void 0,p=void 0,k=void 0,h=void 0,n=void 0,u=void 0,g=void 0,x=void 0,A=void 0;a===b?(b[12]=a[0]*c+a[4]*q+a[8]*d+a[12],b[13]=a[1]*c+a[5]*q+a[9]*d+a[13],b[14]=a[2]*c+a[6]*q+a[10]*d+a[14],b[15]=
a[3]*c+a[7]*q+a[11]*d+a[15]):(m=a[0],f=a[1],l=a[2],e=a[3],p=a[4],k=a[5],h=a[6],n=a[7],u=a[8],g=a[9],x=a[10],A=a[11],b[0]=m,b[1]=f,b[2]=l,b[3]=e,b[4]=p,b[5]=k,b[6]=h,b[7]=n,b[8]=u,b[9]=g,b[10]=x,b[11]=A,b[12]=m*c+p*q+u*d+a[12],b[13]=f*c+k*q+g*d+a[13],b[14]=l*c+h*q+x*d+a[14],b[15]=e*c+n*q+A*d+a[15]);return b};a.scale=function(b,a,d){var c=d[0],q=d[1];d=d[2];b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c;b[4]=a[4]*q;b[5]=a[5]*q;b[6]=a[6]*q;b[7]=a[7]*q;b[8]=a[8]*d;b[9]=a[9]*d;b[10]=a[10]*d;b[11]=a[11]*
d;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(b,a,d,f){var c=f[0],q=f[1];f=f[2];var e=Math.sqrt(c*c+q*q+f*f),l=void 0,h=void 0,p=void 0,n=void 0,t=void 0,u=void 0,g=void 0,E=void 0,x=void 0,A=void 0,F=void 0,I=void 0,G=void 0,J=void 0,H=void 0,M=void 0,L=void 0,K=void 0,N=void 0,Q=void 0,O=void 0,T=void 0,h=l=void 0;if(e<k.EPSILON)return null;e=1/e;c*=e;q*=e;f*=e;l=Math.sin(d);h=Math.cos(d);p=1-h;n=a[0];t=a[1];u=a[2];g=a[3];E=a[4];x=a[5];A=a[6];F=a[7];I=a[8];G=a[9];
J=a[10];H=a[11];M=c*c*p+h;L=q*c*p+f*l;K=f*c*p-q*l;N=c*q*p-f*l;Q=q*q*p+h;O=f*q*p+c*l;T=c*f*p+q*l;l=q*f*p-c*l;h=f*f*p+h;b[0]=n*M+E*L+I*K;b[1]=t*M+x*L+G*K;b[2]=u*M+A*L+J*K;b[3]=g*M+F*L+H*K;b[4]=n*N+E*Q+I*O;b[5]=t*N+x*Q+G*O;b[6]=u*N+A*Q+J*O;b[7]=g*N+F*Q+H*O;b[8]=n*T+E*l+I*h;b[9]=t*T+x*l+G*h;b[10]=u*T+A*l+J*h;b[11]=g*T+F*l+H*h;a!==b&&(b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b};a.rotateX=function(b,a,d){var c=Math.sin(d);d=Math.cos(d);var q=a[4],f=a[5],e=a[6],l=a[7],h=a[8],p=a[9],k=a[10],
n=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=q*d+h*c;b[5]=f*d+p*c;b[6]=e*d+k*c;b[7]=l*d+n*c;b[8]=h*d-q*c;b[9]=p*d-f*c;b[10]=k*d-e*c;b[11]=n*d-l*c;return b};a.rotateY=function(b,a,d){var c=Math.sin(d);d=Math.cos(d);var f=a[0],q=a[1],e=a[2],l=a[3],h=a[8],p=a[9],k=a[10],n=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=f*d-h*c;b[1]=q*d-p*c;b[2]=e*d-k*c;b[3]=l*d-n*c;b[8]=f*c+h*
d;b[9]=q*c+p*d;b[10]=e*c+k*d;b[11]=l*c+n*d;return b};a.rotateZ=function(b,a,d){var c=Math.sin(d);d=Math.cos(d);var f=a[0],m=a[1],q=a[2],l=a[3],e=a[4],p=a[5],h=a[6],k=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=f*d+e*c;b[1]=m*d+p*c;b[2]=q*d+h*c;b[3]=l*d+k*c;b[4]=e*d-f*c;b[5]=p*d-m*c;b[6]=h*d-q*c;b[7]=k*d-l*c;return b};a.fromTranslation=function(b,a){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=
0;b[12]=a[0];b[13]=a[1];b[14]=a[2];b[15]=1;return b};a.fromScaling=function(b,a){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a[1];b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=a[2];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromRotation=function(b,a,d){var c=d[0],f=d[1];d=d[2];var m=Math.sqrt(c*c+f*f+d*d),q=void 0,l=void 0,e=void 0;if(m<k.EPSILON)return null;m=1/m;c*=m;f*=m;d*=m;q=Math.sin(a);l=Math.cos(a);e=1-l;b[0]=c*c*e+l;b[1]=f*c*e+d*q;b[2]=d*c*e-f*q;b[3]=0;b[4]=c*f*e-d*q;b[5]=f*f*e+l;b[6]=d*f*e+
c*q;b[7]=0;b[8]=c*d*e+f*q;b[9]=f*d*e-c*q;b[10]=d*d*e+l;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromXRotation=function(b,a){var c=Math.sin(a);a=Math.cos(a);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a;b[6]=c;b[7]=0;b[8]=0;b[9]=-c;b[10]=a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromYRotation=function(b,a){var c=Math.sin(a);a=Math.cos(a);b[0]=a;b[1]=0;b[2]=-c;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=c;b[9]=0;b[10]=a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromZRotation=
function(b,a){var c=Math.sin(a);a=Math.cos(a);b[0]=a;b[1]=c;b[2]=0;b[3]=0;b[4]=-c;b[5]=a;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromRotationTranslation=n;a.fromQuat2=function(a,d){var c=b,f=-d[0],q=-d[1],m=-d[2],e=d[3],l=d[4],h=d[5],p=d[6],k=d[7],g=f*f+q*q+m*m+e*e;0<g?(c[0]=2*(l*e+k*f+h*m-p*q)/g,c[1]=2*(h*e+k*q+p*f-l*m)/g,c[2]=2*(p*e+k*m+l*q-h*f)/g):(c[0]=2*(l*e+k*f+h*m-p*q),c[1]=2*(h*e+k*q+p*f-l*m),c[2]=2*(p*e+k*m+l*q-h*f));n(a,d,c);return a};var b=
e.create();a.getTranslation=function(b,a){b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.getScaling=function(b,a){var c=a[0],d=a[1],f=a[2],m=a[4],q=a[5],l=a[6],e=a[8],p=a[9];a=a[10];b[0]=Math.sqrt(c*c+d*d+f*f);b[1]=Math.sqrt(m*m+q*q+l*l);b[2]=Math.sqrt(e*e+p*p+a*a);return b};a.getRotation=function(b,a){var c=a[0]+a[5]+a[10],d=0;0<c?(d=2*Math.sqrt(c+1),b[3]=.25*d,b[0]=(a[6]-a[9])/d,b[1]=(a[8]-a[2])/d,b[2]=(a[1]-a[4])/d):a[0]>a[5]&&a[0]>a[10]?(d=2*Math.sqrt(1+a[0]-a[5]-a[10]),b[3]=(a[6]-a[9])/d,b[0]=
.25*d,b[1]=(a[1]+a[4])/d,b[2]=(a[8]+a[2])/d):a[5]>a[10]?(d=2*Math.sqrt(1+a[5]-a[0]-a[10]),b[3]=(a[8]-a[2])/d,b[0]=(a[1]+a[4])/d,b[1]=.25*d,b[2]=(a[6]+a[9])/d):(d=2*Math.sqrt(1+a[10]-a[0]-a[5]),b[3]=(a[1]-a[4])/d,b[0]=(a[8]+a[2])/d,b[1]=(a[6]+a[9])/d,b[2]=.25*d);return b};a.fromRotationTranslationScale=function(b,a,d,f){var c=a[0],m=a[1],q=a[2],l=a[3],e=c+c,p=m+m,h=q+q;a=c*e;var k=c*p,c=c*h,n=m*p,m=m*h,q=q*h,e=l*e,p=l*p,l=l*h,h=f[0],t=f[1];f=f[2];b[0]=(1-(n+q))*h;b[1]=(k+l)*h;b[2]=(c-p)*h;b[3]=0;b[4]=
(k-l)*t;b[5]=(1-(a+q))*t;b[6]=(m+e)*t;b[7]=0;b[8]=(c+p)*f;b[9]=(m-e)*f;b[10]=(1-(a+n))*f;b[11]=0;b[12]=d[0];b[13]=d[1];b[14]=d[2];b[15]=1;return b};a.fromRotationTranslationScaleOrigin=function(b,a,d,f,e){var c=a[0],q=a[1],l=a[2],r=a[3],p=c+c,h=q+q,k=l+l;a=c*p;var n=c*h,t=c*k,c=q*h,q=q*k,u=l*k,l=r*p,h=r*h,g=r*k,A=f[0],F=f[1],k=f[2];f=e[0];r=e[1];e=e[2];var p=(1-(c+u))*A,I=(n+g)*A,A=(t-h)*A,n=(n-g)*F,u=(1-(a+u))*F,F=(q+l)*F,t=(t+h)*k,q=(q-l)*k;a=(1-(a+c))*k;b[0]=p;b[1]=I;b[2]=A;b[3]=0;b[4]=n;b[5]=
u;b[6]=F;b[7]=0;b[8]=t;b[9]=q;b[10]=a;b[11]=0;b[12]=d[0]+f-(p*f+n*r+t*e);b[13]=d[1]+r-(I*f+u*r+q*e);b[14]=d[2]+e-(A*f+F*r+a*e);b[15]=1;return b};a.fromQuat=function(b,a){var c=a[0],d=a[1],f=a[2];a=a[3];var m=c+c,q=d+d,l=f+f,c=c*m,e=d*m,d=d*q,p=f*m,h=f*q,f=f*l,m=a*m,q=a*q;a*=l;b[0]=1-d-f;b[1]=e+a;b[2]=p-q;b[3]=0;b[4]=e-a;b[5]=1-c-f;b[6]=h+m;b[7]=0;b[8]=p+q;b[9]=h-m;b[10]=1-c-d;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.frustum=function(b,a,d,f,e,m,h){var c=1/(d-a),q=1/(e-f),p=1/(m-h);b[0]=
2*m*c;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=2*m*q;b[6]=0;b[7]=0;b[8]=(d+a)*c;b[9]=(e+f)*q;b[10]=(h+m)*p;b[11]=-1;b[12]=0;b[13]=0;b[14]=h*m*2*p;b[15]=0;return b};a.perspective=function(b,a,d,f,e){a=1/Math.tan(a/2);var c=void 0;b[0]=a/d;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[11]=-1;b[12]=0;b[13]=0;b[15]=0;null!=e&&Infinity!==e?(c=1/(f-e),b[10]=(e+f)*c,b[14]=2*e*f*c):(b[10]=-1,b[14]=-2*f);return b};a.perspectiveFromFieldOfView=function(b,a,d,f){var c=Math.tan(a.upDegrees*Math.PI/
180),m=Math.tan(a.downDegrees*Math.PI/180),q=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var l=2/(q+a),e=2/(c+m);b[0]=l;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=e;b[6]=0;b[7]=0;b[8]=-((q-a)*l*.5);b[9]=(c-m)*e*.5;b[10]=f/(d-f);b[11]=-1;b[12]=0;b[13]=0;b[14]=f*d/(d-f);b[15]=0;return b};a.ortho=function(b,a,d,f,e,m,h){var c=1/(a-d),q=1/(f-e),p=1/(m-h);b[0]=-2*c;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=-2*q;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=2*p;b[11]=0;b[12]=(a+d)*c;b[13]=(e+f)*q;b[14]=
(h+m)*p;b[15]=1;return b};a.lookAt=function(b,a,d,f){var c=void 0,m=void 0,q=void 0,l=void 0,e=void 0,p=void 0,n=void 0,t=void 0,u=void 0,g=void 0,E=a[0],x=a[1];a=a[2];q=f[0];l=f[1];f=f[2];n=d[0];t=d[1];d=d[2];if(Math.abs(E-n)<k.EPSILON&&Math.abs(x-t)<k.EPSILON&&Math.abs(a-d)<k.EPSILON)return h(b);n=E-n;t=x-t;u=a-d;g=1/Math.sqrt(n*n+t*t+u*u);n*=g;t*=g;u*=g;c=l*u-f*t;m=f*n-q*u;q=q*t-l*n;(g=Math.sqrt(c*c+m*m+q*q))?(g=1/g,c*=g,m*=g,q*=g):q=m=c=0;l=t*q-u*m;e=u*c-n*q;p=n*m-t*c;(g=Math.sqrt(l*l+e*e+p*p))?
(g=1/g,l*=g,e*=g,p*=g):p=e=l=0;b[0]=c;b[1]=l;b[2]=n;b[3]=0;b[4]=m;b[5]=e;b[6]=t;b[7]=0;b[8]=q;b[9]=p;b[10]=u;b[11]=0;b[12]=-(c*E+m*x+q*a);b[13]=-(l*E+e*x+p*a);b[14]=-(n*E+t*x+u*a);b[15]=1;return b};a.targetTo=function(b,a,d,f){var c=a[0],m=a[1];a=a[2];var q=f[0],l=f[1],e=f[2];f=c-d[0];var p=m-d[1];d=a-d[2];var h=f*f+p*p+d*d;0<h&&(h=1/Math.sqrt(h),f*=h,p*=h,d*=h);var k=l*d-e*p,e=e*f-q*d,q=q*p-l*f,h=k*k+e*e+q*q;0<h&&(h=1/Math.sqrt(h),k*=h,e*=h,q*=h);b[0]=k;b[1]=e;b[2]=q;b[3]=0;b[4]=p*q-d*e;b[5]=d*k-
f*q;b[6]=f*e-p*k;b[7]=0;b[8]=f;b[9]=p;b[10]=d;b[11]=0;b[12]=c;b[13]=m;b[14]=a;b[15]=1;return b};a.str=function(b){return"mat4("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+")"};a.frob=function(b){return Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)+Math.pow(b[2],2)+Math.pow(b[3],2)+Math.pow(b[4],2)+Math.pow(b[5],2)+Math.pow(b[6],2)+Math.pow(b[7],2)+Math.pow(b[8],2)+Math.pow(b[9],2)+Math.pow(b[10],
2)+Math.pow(b[11],2)+Math.pow(b[12],2)+Math.pow(b[13],2)+Math.pow(b[14],2)+Math.pow(b[15],2))};a.add=function(b,a,d){b[0]=a[0]+d[0];b[1]=a[1]+d[1];b[2]=a[2]+d[2];b[3]=a[3]+d[3];b[4]=a[4]+d[4];b[5]=a[5]+d[5];b[6]=a[6]+d[6];b[7]=a[7]+d[7];b[8]=a[8]+d[8];b[9]=a[9]+d[9];b[10]=a[10]+d[10];b[11]=a[11]+d[11];b[12]=a[12]+d[12];b[13]=a[13]+d[13];b[14]=a[14]+d[14];b[15]=a[15]+d[15];return b};a.subtract=d;a.multiplyScalar=function(b,a,d){b[0]=a[0]*d;b[1]=a[1]*d;b[2]=a[2]*d;b[3]=a[3]*d;b[4]=a[4]*d;b[5]=a[5]*
d;b[6]=a[6]*d;b[7]=a[7]*d;b[8]=a[8]*d;b[9]=a[9]*d;b[10]=a[10]*d;b[11]=a[11]*d;b[12]=a[12]*d;b[13]=a[13]*d;b[14]=a[14]*d;b[15]=a[15]*d;return b};a.multiplyScalarAndAdd=function(b,a,d,f){b[0]=a[0]+d[0]*f;b[1]=a[1]+d[1]*f;b[2]=a[2]+d[2]*f;b[3]=a[3]+d[3]*f;b[4]=a[4]+d[4]*f;b[5]=a[5]+d[5]*f;b[6]=a[6]+d[6]*f;b[7]=a[7]+d[7]*f;b[8]=a[8]+d[8]*f;b[9]=a[9]+d[9]*f;b[10]=a[10]+d[10]*f;b[11]=a[11]+d[11]*f;b[12]=a[12]+d[12]*f;b[13]=a[13]+d[13]*f;b[14]=a[14]+d[14]*f;b[15]=a[15]+d[15]*f;return b};a.exactEquals=function(b,
a){return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===a[7]&&b[8]===a[8]&&b[9]===a[9]&&b[10]===a[10]&&b[11]===a[11]&&b[12]===a[12]&&b[13]===a[13]&&b[14]===a[14]&&b[15]===a[15]};a.equals=function(b,a){var c=b[0],d=b[1],f=b[2],m=b[3],e=b[4],l=b[5],q=b[6],p=b[7],h=b[8],n=b[9],g=b[10],B=b[11],E=b[12],x=b[13],A=b[14];b=b[15];var F=a[0],I=a[1],G=a[2],J=a[3],H=a[4],M=a[5],L=a[6],K=a[7],N=a[8],Q=a[9],O=a[10],T=a[11],R=a[12],V=a[13],S=a[14];a=a[15];return Math.abs(c-
F)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(d-I)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-G)<=k.EPSILON*Math.max(1,Math.abs(f),Math.abs(G))&&Math.abs(m-J)<=k.EPSILON*Math.max(1,Math.abs(m),Math.abs(J))&&Math.abs(e-H)<=k.EPSILON*Math.max(1,Math.abs(e),Math.abs(H))&&Math.abs(l-M)<=k.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(q-L)<=k.EPSILON*Math.max(1,Math.abs(q),Math.abs(L))&&Math.abs(p-K)<=k.EPSILON*Math.max(1,Math.abs(p),Math.abs(K))&&Math.abs(h-N)<=k.EPSILON*
Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(n-Q)<=k.EPSILON*Math.max(1,Math.abs(n),Math.abs(Q))&&Math.abs(g-O)<=k.EPSILON*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(B-T)<=k.EPSILON*Math.max(1,Math.abs(B),Math.abs(T))&&Math.abs(E-R)<=k.EPSILON*Math.max(1,Math.abs(E),Math.abs(R))&&Math.abs(x-V)<=k.EPSILON*Math.max(1,Math.abs(x),Math.abs(V))&&Math.abs(A-S)<=k.EPSILON*Math.max(1,Math.abs(A),Math.abs(S))&&Math.abs(b-a)<=k.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))};a.mul=f;a.sub=d})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require",
"exports","./factories/mat4f32"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f32=void 0;a.mat4f32=e})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require","exports"],function(g,a){function e(){var a=new Float32Array(16);a[0]=1;a[5]=1;a[10]=1;a[15]=1;return a}Object.defineProperty(a,"__esModule",{value:!0});a.IDENTITY=a.createView=a.fromValues=a.clone=a.create=void 0;a.create=e;a.clone=function(a){var e=new Float32Array(16);e[0]=a[0];e[1]=a[1];e[2]=
a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.fromValues=function(a,e,f,n,d,b,c,q,g,t,r,m,v,l,w,p){var h=new Float32Array(16);h[0]=a;h[1]=e;h[2]=f;h[3]=n;h[4]=d;h[5]=b;h[6]=c;h[7]=q;h[8]=g;h[9]=t;h[10]=r;h[11]=m;h[12]=v;h[13]=l;h[14]=w;h[15]=p;return h};a.createView=function(a,e){return new Float32Array(a,e,16)};a.IDENTITY=e()})},"esri/views/layers/effects/parser":function(){define("require exports ../../../colorUtils ../../../core/Error ./effects ./grammar".split(" "),
function(g,a,e,k,h,f){function n(a){try{switch(a.name){case "grayscale":case "sepia":case "saturate":case "invert":case "brightness":case "contrast":var f=1;d(a.parameters,1);1===a.parameters.length&&(f=q(a.parameters[0]));return new h.ColorMatrixEffect(a.name,f);case "opacity":return f=1,d(a.parameters,1),1===a.parameters.length&&(f=q(a.parameters[0])),new h.OpacityEffect(f);case "hue-rotate":f=0;d(a.parameters,1);if(1===a.parameters.length){var p=a.parameters[0];if("quantity"!==p.type||(0!==p.value||
null!==p.unit)&&null==m[p.unit])throw new k("effect:type-error","Expected \x3cangle\x3e, Actual: "+b(p),{term:p});f=p.value*m[p.unit]||0}return new h.HueRotateEffect(f);case "radial-blur":case "blur":return f=0,d(a.parameters,1),1===a.parameters.length&&(f=t(a.parameters[0]),c(f,a.parameters[0])),new h.BlurEffect(a.name,f);case "drop-shadow":for(var p=[],n=0,v=a.parameters;n<v.length;n++){var g=v[n];if("color"===g.type){p.length&&Object.freeze(p);if(f)throw new k("effect:type-error","Accepts only one color",
{});a:{var x=g;switch(x.colorType){case "hex":f=e.hex2rgba(x.value);break a;case "named":f=r(x.value);break a;case "function":var A=void 0;var F=x.value;d(F.parameters,4);if(l.test(F.name))A=[q(F.parameters[0]),q(F.parameters[1]),q(F.parameters[2]),F.parameters[3]?q(F.parameters[3]):1];else if(w.test(F.name))A=e.hsla2rgba(u(F.parameters[0]),q(F.parameters[1]),q(F.parameters[2]),F.parameters[3]?q(F.parameters[3]):1);else throw new k("effect:syntax-error","Invalid color function '"+F.name+"'",{colorFunction:F});
f=A;break a}f=void 0}}else{var I=t(g);if(Object.isFrozen(p))throw new k("effect:type-error","\x3clength\x3e parameters not consecutive",{lengths:p});p.push(I);3===p.length&&c(I,g)}}if(2>p.length||3<p.length)throw new k("effect:type-error","Expected \x3clength\x3e{2,3}, Actual: \x3clength\x3e{"+p.length+"}",{lengths:p});return new h.DropShadowEffect(p[0],p[1],p[2]||0,f||r("black"));case "bloom":return f=1,g=v=0,d(a.parameters,3),a.parameters[0]&&(f=q(a.parameters[0])),a.parameters[1]&&(v=t(a.parameters[1]),
c(v,a.parameters[1])),a.parameters[2]&&(g=q(a.parameters[2])),new h.BloomEffect(f,v,g)}}catch(G){throw G.details.filter=a,G;}throw new k("effect:unknown-effect","Effect '"+a.name+"' is not supported",{effect:a});}function d(b,a){if(b.length>a)throw new k("effect:type-error","Function supports up to "+a+" parameters, Actual: "+b.length,{parameters:b});}function b(b){return"color"===b.type?"\x3ccolor\x3e":v[b.unit]?"\x3clength\x3e":m[b.unit]?"\x3cangle\x3e":"%"===b.unit?"\x3cpercentage\x3e":"\x3cdouble\x3e"}
function c(b,a){if(0>b)throw new k("effect:type-error","Negative values are not allowed, Actual: "+b,{term:a});}function q(a){if("quantity"!==a.type||null!==a.unit&&"%"!==a.unit)throw new k("effect:type-error","Expected \x3cdouble\x3e or \x3cpercentage\x3e, Actual: "+b(a),{term:a});var d=a.value;c(d,a);return"%"===a.unit?.01*d:d}function u(a){if("quantity"!==a.type||null!==a.unit)throw new k("effect:type-error","Expected \x3cdouble\x3e, Actual: "+b(a),{term:a});c(a.value,a);return a.value}function t(a){if("quantity"!==
a.type||(0!==a.value||null!==a.unit)&&null==v[a.unit])throw new k("effect:type-error","Expected \x3clength\x3e, Actual: "+b(a),{term:a});return a.value*v[a.unit]||0}function r(b){var a=e.getNamedColorCopy(b);if(!a)throw new k("effect:unknown-color","color '"+b+"' isn't valid",{namedColor:b});return a}Object.defineProperty(a,"__esModule",{value:!0});a.parse=void 0;a.parse=function(b){var a;try{a=b?f.parse(b):[]}catch(C){return{input:b,parsedFunctions:[],effects:[],error:new k("effect:invalid-syntax",
"Invalid filter syntax",{input:b,error:C})}}b={input:b,parsedFunctions:a,effects:[],error:null};try{for(var c=0;c<a.length;c++)b.effects.push(n(a[c]))}catch(C){b.effects.length=0,b.error=C}return b};var m={deg:1,grad:.9,rad:180/Math.PI,turn:360},v={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/73},l=/^rgba?/i,w=/^hsla?/i})},"esri/views/layers/effects/grammar":function(){(function(g,a){"function"===typeof define&&define.amd?define([],a):"object"===typeof module&&module.exports&&(module.exports=a())})(this,
function(){function g(a,e,k,h){this.message=a;this.expected=e;this.found=k;this.location=h;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,g)}(function(a,e){function k(){this.constructor=a}k.prototype=e.prototype;a.prototype=new k})(g,Error);g.buildMessage=function(a,e){function k(a){return a.charCodeAt(0).toString(16).toUpperCase()}function h(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+k(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+k(b)})}function f(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+k(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+k(b)})}var n={literal:function(a){return'"'+h(a.text)+
'"'},"class":function(a){var b="",c;for(c=0;c<a.parts.length;c++)b+=a.parts[c]instanceof Array?f(a.parts[c][0])+"-"+f(a.parts[c][1]):f(a.parts[c]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var d=c,f;f=a[c];f=n[f.type](f);b[d]=f}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=
a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(e?'"'+h(e)+'"':"end of input")+" found."};return{SyntaxError:g,parse:function(a,e){function k(b,a){return{type:"literal",text:b,ignoreCase:a}}function h(b,a,c){return{type:"class",parts:b,inverted:a,ignoreCase:c}}function f(b){return{type:"other",description:b}}function n(b){var c=ia[b],d;if(!c){for(d=b-1;!ia[d];)d--;c=ia[d];for(c={line:c.line,column:c.column};d<
b;)10===a.charCodeAt(d)?(c.line++,c.column=1):c.column++,d++;ia[b]=c}return c}function d(b,a){var c=n(b),d=n(a);return{start:{offset:b,line:c.line,column:c.column},end:{offset:a,line:d.line,column:d.column}}}function b(b){D<ba||(D>ba&&(ba=D,ja=[]),ja.push(b))}function c(){var c,d;P++;c=D;d=t();d!==l?(a.substr(D,4)===z?(d=z,D+=4):(d=l,0===P&&b(C)),d!==l?(d=t(),d!==l?(U=c,c=d=[]):(D=c,c=l)):(D=c,c=l)):(D=c,c=l);P--;c===l&&(d=l,0===P&&b(y));if(c===l)if(c=[],d=q(),d!==l)for(;d!==l;)c.push(d),d=q();else c=
l;return c}function q(){var c,d,f,m;c=D;d=t();if(d!==l)if(P++,d=D,f=r(),f!==l?(40===a.charCodeAt(D)?(m=H,D++):(m=l,0===P&&b(M)),m!==l?(U=d,d=f):(D=d,d=l)):(D=d,d=l),P--,d===l&&(f=l,0===P&&b(J)),d!==l)if(f=t(),f!==l){var p,e,q,h,n,k;m=D;p=u();if(p!==l){f=[];e=D;q=t();q!==l?(44===a.charCodeAt(D)?(h=x,D++):(h=l,0===P&&b(A)),h===l&&(h=null),h!==l?(n=t(),n!==l?(k=u(),k!==l?e=q=[q,h,n,k]:(D=e,e=l)):(D=e,e=l)):(D=e,e=l)):(D=e,e=l);for(;e!==l;)f.push(e),e=D,q=t(),q!==l?(44===a.charCodeAt(D)?(h=x,D++):(h=
l,0===P&&b(A)),h===l&&(h=null),h!==l?(n=t(),n!==l?(k=u(),k!==l?e=q=[q,h,n,k]:(D=e,e=l)):(D=e,e=l)):(D=e,e=l)):(D=e,e=l);f!==l?(U=m,m=p,m=p=0<f.length?[m].concat(v(f,3)):[m]):(D=m,m=l)}else D=m,m=l;f=m;f===l&&(f=null);f!==l?(m=t(),m!==l?(41===a.charCodeAt(D)?(m=B,D++):(m=l,0===P&&b(E)),m!==l?(m=t(),m!==l?(U=c,c=d={type:"function",name:d,parameters:f||[]}):(D=c,c=l)):(D=c,c=l)):(D=c,c=l)):(D=c,c=l)}else D=c,c=l;else D=c,c=l;else D=c,c=l;return c}function u(){var c,d;c=D;var f,e;P++;d=D;f=t();f!==l?
(f=m(),f!==l?(37===a.charCodeAt(D)?(e=O,D++):(e=l,0===P&&b(T)),e!==l?(U=d,d=f={value:f,unit:"%"}):(D=d,d=l)):(D=d,d=l)):(D=d,d=l);P--;d===l&&(f=l,0===P&&b(Q));d===l&&(P++,d=D,f=t(),f!==l?(f=m(),f!==l?(a.substr(D,2)===V?(e=V,D+=2):(e=l,0===P&&b(S)),e!==l?(U=d,d=f={value:f,unit:"px"}):(D=d,d=l)):(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=t(),f!==l?(f=m(),f!==l?(a.substr(D,2)===W?(e=W,D+=2):(e=l,0===P&&b(X)),e!==l?(U=d,d=f={value:f,unit:"cm"}):(D=d,d=l)):(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=t(),f!==l?(f=m(),f!==
l?(a.substr(D,2)===ca?(e=ca,D+=2):(e=l,0===P&&b(da)),e!==l?(U=d,d=f={value:f,unit:"mm"}):(D=d,d=l)):(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=t(),f!==l?(f=m(),f!==l?(a.substr(D,2)===Y?(e=Y,D+=2):(e=l,0===P&&b(ha)),e!==l?(U=d,d=f={value:f,unit:"in"}):(D=d,d=l)):(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=t(),f!==l?(f=m(),f!==l?(a.substr(D,2)===Z?(e=Z,D+=2):(e=l,0===P&&b(aa)),e!==l?(U=d,d=f={value:f,unit:"pt"}):(D=d,d=l)):(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=t(),f!==l?(f=m(),f!==l?(a.substr(D,2)===ea?(e=ea,D+=2):(e=
l,0===P&&b(sa)),e!==l?(U=d,d=f={value:f,unit:"pc"}):(D=d,d=l)):(D=d,d=l)):(D=d,d=l)))))),P--,d===l&&(f=l,0===P&&b(R)),d===l&&(P++,d=D,f=m(),f!==l?(a.substr(D,3)===ka?(e=ka,D+=3):(e=l,0===P&&b(ta)),e!==l?(U=d,d=f={value:f,unit:"deg"}):(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=m(),f!==l?(a.substr(D,3)===la?(e=la,D+=3):(e=l,0===P&&b(ua)),e!==l?(U=d,d=f={value:f,unit:"rad"}):(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=m(),f!==l?(a.substr(D,4)===ma?(e=ma,D+=4):(e=l,0===P&&b(va)),e!==l?(U=d,d=f={value:f,unit:"grad"}):
(D=d,d=l)):(D=d,d=l),d===l&&(d=D,f=m(),f!==l?(a.substr(D,4)===na?(e=na,D+=4):(e=l,0===P&&b(wa)),e!==l?(U=d,d=f={value:f,unit:"turn"}):(D=d,d=l)):(D=d,d=l)))),P--,d===l&&(f=l,0===P&&b(xa)),d===l&&(P++,d=D,f=t(),f!==l?(f=m(),f!==l?(U=d,d=f={value:f,unit:null}):(D=d,d=l)):(D=d,d=l),P--,d===l&&(f=l,0===P&&b(ya)))));d!==l&&(U=c,d={type:"quantity",value:d.value,unit:d.unit});c=d;if(c===l){c=D;P++;d=D;35===a.charCodeAt(D)?(f=za,D++):(f=l,0===P&&b(Aa));if(f!==l){f=[];oa.test(a.charAt(D))?(e=a.charAt(D),D++):
(e=l,0===P&&b(pa));if(e!==l)for(;e!==l;)f.push(e),oa.test(a.charAt(D))?(e=a.charAt(D),D++):(e=l,0===P&&b(pa));else f=l;f!==l?(U=d,d=f={type:"hex",value:a.substring(U,D)}):(D=d,d=l)}else D=d,d=l;d===l&&(d=D,f=q(),f!==l&&(U=d,f={type:"function",value:f}),d=f,d===l&&(d=D,f=r(),f!==l&&(U=d,f={type:"named",value:a.substring(U,D)}),d=f));P--;d===l&&(f=l,0===P&&b(Ba));d!==l&&(U=c,d={type:"color",colorType:d.type,value:d.value});c=d}return c}function t(){var c,d;P++;c=[];I.test(a.charAt(D))?(d=a.charAt(D),
D++):(d=l,0===P&&b(G));for(;d!==l;)c.push(d),I.test(a.charAt(D))?(d=a.charAt(D),D++):(d=l,0===P&&b(G));P--;c===l&&(d=l,0===P&&b(F));return c}function r(){var c,d,f;P++;c=D;d=[];K.test(a.charAt(D))?(f=a.charAt(D),D++):(f=l,0===P&&b(N));if(f!==l)for(;f!==l;)d.push(f),K.test(a.charAt(D))?(f=a.charAt(D),D++):(f=l,0===P&&b(N));else d=l;d!==l&&(U=c,d=a.substring(U,D));c=d;P--;c===l&&(d=l,0===P&&b(L));return c}function m(){var c,d,f,m,e,p;c=D;qa.test(a.charAt(D))?(d=a.charAt(D),D++):(d=l,0===P&&b(ra));d===
l&&(d=null);if(d!==l){f=D;d=[];fa.test(a.charAt(D))?(m=a.charAt(D),D++):(m=l,0===P&&b(ga));for(;m!==l;)d.push(m),fa.test(a.charAt(D))?(m=a.charAt(D),D++):(m=l,0===P&&b(ga));if(d!==l)if(46===a.charCodeAt(D)?(m=Ca,D++):(m=l,0===P&&b(Da)),m!==l){e=[];fa.test(a.charAt(D))?(p=a.charAt(D),D++):(p=l,0===P&&b(ga));if(p!==l)for(;p!==l;)e.push(p),fa.test(a.charAt(D))?(p=a.charAt(D),D++):(p=l,0===P&&b(ga));else e=l;e!==l?f=d=[d,m,e]:(D=f,f=l)}else D=f,f=l;else D=f,f=l;if(f===l)if(f=[],fa.test(a.charAt(D))?(d=
a.charAt(D),D++):(d=l,0===P&&b(ga)),d!==l)for(;d!==l;)f.push(d),fa.test(a.charAt(D))?(d=a.charAt(D),D++):(d=l,0===P&&b(ga));else f=l;if(f!==l){d=D;101===a.charCodeAt(D)?(m=Ea,D++):(m=l,0===P&&b(Fa));if(m!==l)if(qa.test(a.charAt(D))?(e=a.charAt(D),D++):(e=l,0===P&&b(ra)),e===l&&(e=null),e!==l){p=[];fa.test(a.charAt(D))?(f=a.charAt(D),D++):(f=l,0===P&&b(ga));if(f!==l)for(;f!==l;)p.push(f),fa.test(a.charAt(D))?(f=a.charAt(D),D++):(f=l,0===P&&b(ga));else p=l;p!==l?d=m=[m,e,p]:(D=d,d=l)}else D=d,d=l;else D=
d,d=l;d===l&&(d=null);d!==l?(U=c,c=d=parseFloat(a.substring(U,D))):(D=c,c=l)}else D=c,c=l}else D=c,c=l;return c}function v(b,a){return b.map(function(b){return b[a]})}e=void 0!==e?e:{};var l={},w={start:c},p=c,y=f("none"),z="none",C=k("none",!1),B=")",E=k(")",!1),x=",",A=k(",",!1),F=f("whitespace"),I=/^[ \t\n\r]/,G=h([" ","\t","\n","\r"],!1,!1),J=f("function"),H="(",M=k("(",!1),L=f("identifier"),K=/^[a-z\-]/,N=h([["a","z"],"-"],!1,!1),Q=f("percentage"),O="%",T=k("%",!1),R=f("length"),V="px",S=k("px",
!1),W="cm",X=k("cm",!1),ca="mm",da=k("mm",!1),Y="in",ha=k("in",!1),Z="pt",aa=k("pt",!1),ea="pc",sa=k("pc",!1),xa=f("angle"),ka="deg",ta=k("deg",!1),la="rad",ua=k("rad",!1),ma="grad",va=k("grad",!1),na="turn",wa=k("turn",!1),ya=f("number"),Ba=f("color"),za="#",Aa=k("#",!1),oa=/^[0-9a-fA-F]/,pa=h([["0","9"],["a","f"],["A","F"]],!1,!1),qa=/^[+\-]/,ra=h(["+","-"],!1,!1),fa=/^[0-9]/,ga=h([["0","9"]],!1,!1),Ca=".",Da=k(".",!1),Ea="e",Fa=k("e",!1),D=0,U=0,ia=[{line:1,column:1}],ba=0,ja=[],P=0;if("startRule"in
e){if(!(e.startRule in w))throw Error("Can't start parsing from rule \""+e.startRule+'".');p=w[e.startRule]}e=p();if(e!==l&&D===a.length)return e;e!==l&&D<a.length&&b({type:"end"});throw function(b,a,c){return new g(g.buildMessage(b,a),b,a,c)}(ja,ba<a.length?a.charAt(ba):null,ba<a.length?d(ba,ba+1):d(ba,ba));}}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.MosaicType=a.WGLVVTarget=a.WGLVVFlag=a.VVType=
a.WGLDrawPhase=a.WGLGeometryTransactionStatus=a.WGLGeometryType=void 0;(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]="LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=
8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=
32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/maybe ../../../webgl ../brushes ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/post-processing/EffectManager ./painter/RenderPass".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v){function l(b,a,c){return 1!==c||e.isSome(b)&&"normal"!==b||e.isSome(a)&&0<a.length}Object.defineProperty(a,"__esModule",{value:!0});a.PainterOptions=void 0;g=function(){return function(){}}();a.PainterOptions=g;g=function(){function a(a,d){this.context=a;this._blitRenderer=new n.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this._blendEffect=new u.BlendEffect;this.effects={highlight:new t.default,hittest:new r.HittestEffect,integrate:new q.AnimationEffect};
this.materialManager=new b(a);this._vtlProgramCache=new f.default(a);this.textureManager=new c(d);this._effectsManager=new m.EffectManager(d)}a.prototype.getRenderTarget=function(){return this._renderTarget};a.prototype.setRenderTarget=function(b){this._renderTarget=b};a.prototype.getFbos=function(b,a){if(b!==this._lastWidth||a!==this._lastHeight){this._lastWidth=b;this._lastHeight=a;if(this._fbos){for(var c in this._fbos)this._fbos[c].resize(b,a);return this._fbos}c={target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071,width:b,height:a};var d={colorTarget:0,depthStencilTarget:3};this._stencilBuf=b=new k.Renderbuffer(this.context,{width:b,height:a,internalFormat:34041});this._fbos={output:new k.FramebufferObject(this.context,d,c,b),blend:new k.FramebufferObject(this.context,d,c,b),effect0:new k.FramebufferObject(this.context,d,c,b)}}return this._fbos};a.prototype.getSharedStencilBuffer=function(){return this._stencilBuf};a.prototype.beforeRenderLayers=function(b,a){void 0===
a&&(a=null);var c=b.getViewport(),d=c.width,c=c.height;this._prevFBO=b.getBoundFramebufferObject();d=this.getFbos(d,c);b.bindFramebuffer(d.output);b.setDepthWriteEnabled(!0);e.isSome(a)?(a=a.color,d=a.a,b.setClearColor(d*a.r/255,d*a.g/255,d*a.b/255,d)):b.setClearColor(0,0,0,0);b.setClearDepth(1);b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT);b.setDepthWriteEnabled(!1)};a.prototype.beforeRenderLayer=function(b,a,c){var d=b.context;l(b.blendMode,b.effects,c)?(d.bindFramebuffer(this._fbos.blend),
d.setColorMask(!0,!0,!0,!0),d.setClearColor(0,0,0,0),d.clear(d.gl.COLOR_BUFFER_BIT)):(b=this._getOutputFBO(),d.bindFramebuffer(b));d.setDepthWriteEnabled(!1);d.setDepthTestEnabled(!1);d.setStencilTestEnabled(!0);d.setClearStencil(a);d.setStencilWriteMask(255);d.clear(d.gl.STENCIL_BUFFER_BIT)};a.prototype.compositeLayer=function(b,a){var c=b.context,d=b.blendMode,f=b.effects;l(d,f,a)&&(e.isSome(f)&&0<f.length&&this._applyEffects(b,f),f=this._getOutputFBO(),c.bindFramebuffer(f),c.setStencilTestEnabled(!1),
c.setStencilWriteMask(0),c.setBlendingEnabled(!0),c.setBlendFunctionSeparate(1,771,1,771),c.setColorMask(!0,!0,!0,!0),c=e.isSome(d)?d:"normal",this._blendEffect.draw(b,this._fbos.blend.colorTexture,9728,c,a))};a.prototype.renderLayers=function(b){b.bindFramebuffer(this._prevFBO);if(this._fbos){var a=this._getOutputFBO();b.setStencilTestEnabled(!1);b.setStencilWriteMask(0);this.blitTexture(b,a.colorTexture,9728)}};a.prototype.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();
this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(b){return b.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var b in this._fbos)this._fbos[b]&&this._fbos[b].dispose();if(this.effects)for(var a in this.effects)this.effects[a]&&this.effects[a].dispose();this._prevFBO=null};a.prototype.getGeometryBrush=function(b){var a;
b=(a={},a[d.WGLGeometryType.FILL]=h.brushes.fill,a[d.WGLGeometryType.LINE]=h.brushes.line,a[d.WGLGeometryType.MARKER]=h.brushes.marker,a[d.WGLGeometryType.TEXT]=h.brushes.text,a)[b];a=this._brushCache.get(b);void 0===a&&(a=new b,this._brushCache.set(b,a));return this._brushCache.get(b)};a.prototype.renderObject=function(b,a,c,d){c=h.brushes[c];if(!c)return null;var f=this._brushCache.get(c);void 0===f&&(f=new c,this._brushCache.set(c,f));f.prepareState(b,a,d);f.draw(b,a,d)};a.prototype.renderObjects=
function(b,a,c,d){c=h.brushes[c];if(!c)return null;var f=this._brushCache.get(c);void 0===f&&(f=new c,this._brushCache.set(c,f));f.drawMany(b,a,d)};a.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};a.prototype.registerRenderPass=function(b){var a=this,c=b.brushes.map(function(b){a._brushCache.has(b)||a._brushCache.set(b,new b);return a._brushCache.get(b)});return new v.default(c,b)};a.prototype.setHighlightOptions=function(b){this.effects.highlight.setHighlightOptions(b)};
a.prototype.blitTexture=function(b,a,c,d){void 0===d&&(d=1);b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(b,a,c,d)};a.prototype._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};a.prototype._applyEffects=function(b,a){var c=b.context,d=0;for(a=this._effectsManager.getPostProcessingEffects(a);d<a.length;d++){var f=a[d],m=f.postProcessingEffect,f=f.effect;c.bindFramebuffer(this._fbos.blend);
m.draw(b,this._fbos.blend,f)}};return a}();a.default=g})},"esri/views/2d/engine/brushes":function(){define("require exports ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText ./webgl/brushes/raster/BrushRasterBitmap".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l){Object.defineProperty(a,"__esModule",{value:!0});a.vtlBrushes=a.brushes=void 0;a.brushes={marker:m.default,line:r.default,fill:u.default,text:v.default,label:t.default,clip:k.default,stencil:f.default,bitmap:e.default,raster:l.default,tileInfo:h.default,vtlBackground:n.WGLBrushVTLBackground,vtlFill:b.WGLBrushVTLFill,vtlLine:c.WGLBrushVTLLine,vtlCircle:d.WGLBrushVTLCircle,vtlSymbol:q.WGLBrushVTLSymbol};a.vtlBrushes={vtlBackground:n.WGLBrushVTLBackground,
vtlFill:b.WGLBrushVTLFill,vtlLine:c.WGLBrushVTLLine,vtlCircle:d.WGLBrushVTLCircle,vtlSymbol:q.WGLBrushVTLSymbol}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports tslib ../definitions ../VertexStream ./WGLBrush".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});var n={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],
samplingMode:9987,mips:!0}};g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return b}e.__extends(b,a);b.prototype.dispose=function(){this._quad&&this._quad.dispose()};b.prototype.prepareState=function(b,a){b=b.context;b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,
a.stencilRef,255)};b.prototype.draw=function(b,a){var c=b.context,d=b.renderingOptions,f=b.painter;if(a.source){b.timeline.begin(this.name);this._quad||(this._quad=new h(c,[0,0,1,0,0,1,1,1]));if("dynamic"===d.samplingMode)var d=b.state,m=a.resolution/a.pixelRatio/d.resolution,e=Math.round(b.pixelRatio)!==b.pixelRatio,d=d.rotation||1.05<m||.95>m||e||a.isSourceScaled||a.rotation?n.bilinear:n.nearest;else d=n[d.samplingMode];f=f.materialManager.getProgram(b,this._desc,d.defines);a.updateTexture(b);a.setSamplingProfile(d);
a.bind(b,k.TEXTURE_BINDING_BITMAP);c.bindProgram(f);f.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);f.setUniform1i("u_texture",k.TEXTURE_BINDING_BITMAP);f.setUniform2fv("u_coordScale",a.coordScale);this._quad.draw();b.timeline.end(this.name)}};return b}(f.default);a.default=g})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.SPRITE_PADDING=a.MAX_GPU_UPLOADS_PER_FRAME=a.VTL_HIGH_RES_CUTOFF=a.VTL_TEXTURE_BINDING_UNIT_GLYPHS=
a.VTL_TEXTURE_BINDING_UNIT_SPRITES=a.HITTEST_SEARCH_SIZE=a.THIN_LINE_THRESHOLD=a.EFFECT_FLAG_0=a.FILTER_FLAG_0=a.HIGHLIGHT_FLAG=a.MAX_FILTERS=a.ATTRIBUTE_DATA_DD1=a.ATTRIBUTE_DATA_DD0=a.ATTRIBUTE_DATA_VV=a.ATTRIBUTE_DATA_ANIMATION=a.ATTRIBUTE_DATA_FILTER_FLAGS=a.TEXTURE_BINDING_RENDERER_1=a.TEXTURE_BINDING_RENDERER_0=a.TEXTURE_BINDING_HIGHLIGHT_1=a.TEXTURE_BINDING_HIGHLIGHT_0=a.TEXTURE_BINDING_ATTRIBUTE_DATA_3=a.TEXTURE_BINDING_ATTRIBUTE_DATA_2=a.TEXTURE_BINDING_ATTRIBUTE_DATA_1=a.TEXTURE_BINDING_ATTRIBUTE_DATA_0=
a.TEXTURE_BINDING_BITMAP=a.TEXTURE_BINDING_GLYPH_ATLAS=a.TEXTURE_BINDING_SPRITE_ATLAS=a.ATTRIBUTE_STORE_TEXTURE_SIZE=a.AVERAGE_GLYPH_MOSAIC_ITEM=a.TEXT_PLACEMENT_PADDING=a.GLYPH_SIZE=a.HEURISTIC_GLYPHS_PER_FEATURE=a.HEURISTIC_GLYPHS_PER_LINE=a.COLLISION_PLACEMENT_PADDING=a.COLLISION_TILE_BOX_SIZE=a.COLLISION_BOX_PADDING=a.COLLISION_EARLY_REJECT_BUCKET_SIZE=a.COLLISION_MAX_ZOOM_DELTA=a.MAGIC_LABEL_LINE_HEIGHT=a.DOT_DENSITY_MAX_FIELDS=a.COLLISION_BUCKET_SIZE=a.DEBUG_LABELS=a.ANGLE_FACTOR_256=a.RASTER_TILE_SIZE=
a.TILE_SIZE=a.PICTURE_FILL_COLOR=a.EXTRUDE_SCALE=a.NAN_MAGIC_NUMBER=a.WEBGL_MAX_INNER_STOPS=a.WEBGL_MAX_STOPS=void 0;a.WEBGL_MAX_STOPS=8;a.WEBGL_MAX_INNER_STOPS=a.WEBGL_MAX_STOPS-2;a.NAN_MAGIC_NUMBER=1E-30;a.EXTRUDE_SCALE=64;a.PICTURE_FILL_COLOR=4294967295;a.TILE_SIZE=512;a.RASTER_TILE_SIZE=256;a.ANGLE_FACTOR_256=256/360;a.DEBUG_LABELS=!1;a.COLLISION_BUCKET_SIZE=128;a.DOT_DENSITY_MAX_FIELDS=8;a.MAGIC_LABEL_LINE_HEIGHT=29;a.COLLISION_MAX_ZOOM_DELTA=1;a.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;a.COLLISION_BOX_PADDING=
16;a.COLLISION_TILE_BOX_SIZE=a.TILE_SIZE/a.COLLISION_BUCKET_SIZE;a.COLLISION_PLACEMENT_PADDING=8;a.HEURISTIC_GLYPHS_PER_LINE=50;a.HEURISTIC_GLYPHS_PER_FEATURE=10;a.GLYPH_SIZE=24;a.TEXT_PLACEMENT_PADDING=8;a.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};a.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;a.TEXTURE_BINDING_SPRITE_ATLAS=0;a.TEXTURE_BINDING_GLYPH_ATLAS=0;a.TEXTURE_BINDING_BITMAP=0;a.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;a.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;a.TEXTURE_BINDING_ATTRIBUTE_DATA_2=
3;a.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;a.TEXTURE_BINDING_HIGHLIGHT_0=5;a.TEXTURE_BINDING_HIGHLIGHT_1=6;a.TEXTURE_BINDING_RENDERER_0=5;a.TEXTURE_BINDING_RENDERER_1=6;a.ATTRIBUTE_DATA_FILTER_FLAGS=0;a.ATTRIBUTE_DATA_ANIMATION=1;a.ATTRIBUTE_DATA_VV=2;a.ATTRIBUTE_DATA_DD0=3;a.ATTRIBUTE_DATA_DD1=3;a.MAX_FILTERS=2;a.HIGHLIGHT_FLAG=1;a.FILTER_FLAG_0=2;a.EFFECT_FLAG_0=4;a.THIN_LINE_THRESHOLD=2.5;a.HITTEST_SEARCH_SIZE=24;a.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;a.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;a.VTL_HIGH_RES_CUTOFF=
1.15;a.MAX_GPU_UPLOADS_PER_FRAME=2;a.SPRITE_PADDING=2})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports","../../../webgl"],function(g,a,e){return function(){function a(a,f){this.rctx=a;this._vertexBuffer=e.BufferObject.createVertex(a,35044,new Uint16Array(f));this._vao=new e.VertexArrayObject(a,{a_position:0},{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}a.prototype.bind=function(){this._vao.bind()};
a.prototype.unbind=function(){this._vao.unbind()};a.prototype.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};a.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return a}()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this.name=this.constructor.name||"UnnamedBrush"}a.prototype.prepareState=function(a,e,f){};a.prototype.draw=
function(a,e,f){};a.prototype.drawMany=function(a,e,f){for(var h=0;h<e.length;h++)this.draw(a,e[h],f)};return a}();a.default=g})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),function(g,a,e,k,h,f,n,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;
a._color=k.vec4f32.fromValues(0,1,0,1);return a}e.__extends(a,b);a.prototype.dispose=function(){this._program&&this._program.dispose()};a.prototype.prepareState=function(b){b=b.context;b.setStencilTestEnabled(!0);b.setBlendingEnabled(!1);b.setFaceCullingEnabled(!1);b.setColorMask(!1,!1,!1,!1);b.setStencilOp(7680,7680,7681);b.setStencilWriteMask(255);b.setStencilFunction(519,0,255)};a.prototype.draw=function(b,a){var c=b.context;b=b.state;this._program||(this._program=d.createProgram(c,n.background));
var f=this._program,m=h.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});a=a.getVAO(c,b,m.attributes,m.bufferLayouts);c.bindProgram(this._program);f.setUniform2fv("u_coord_range",[1,1]);f.setUniform4fv("u_color",this._color);f.setUniformMatrix3fv("u_dvsMat3",b.displayMat3);c.bindVAO(a);c.drawElements(4,a.indexBuffer.size,5125,0);c.bindVAO()};return a}(f.default);a.default=g})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["require","exports","./factories/vec4f32"],
function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec4f32=void 0;a.vec4f32=e})},"esri/core/libs/gl-matrix-2/factories/vec4f32":function(){define(["require","exports"],function(g,a){function e(){return new Float32Array(4)}function k(b,a,d,f){var c=new Float32Array(4);c[0]=b;c[1]=a;c[2]=d;c[3]=f;return c}function h(){return k(1,1,1,1)}function f(){return k(1,0,0,0)}function n(){return k(0,1,0,0)}function d(){return k(0,0,1,0)}function b(){return k(0,0,0,1)}Object.defineProperty(a,"__esModule",
{value:!0});a.UNIT_W=a.UNIT_Z=a.UNIT_Y=a.UNIT_X=a.ONES=a.ZEROS=a.unitW=a.unitZ=a.unitY=a.unitX=a.ones=a.zeros=a.createView=a.fromValues=a.clone=a.create=void 0;a.create=e;a.clone=function(b){var a=new Float32Array(4);a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};a.fromValues=k;a.createView=function(b,a){return new Float32Array(b,a,4)};a.zeros=function(){return e()};a.ones=h;a.unitX=f;a.unitY=n;a.unitZ=d;a.unitW=b;a.ZEROS=e();a.ONES=h();a.UNIT_X=f();a.UNIT_Y=n();a.UNIT_Z=d();a.UNIT_W=b()})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q){function u(b){for(var a={},c=0;c<b.length;c++){var d=b[c];a[d.name]=d.strideInBytes}return a}function t(b){switch(b){case c.WGLGeometryType.MARKER:return p;case c.WGLGeometryType.FILL:return y;case c.WGLGeometryType.LINE:return z;case c.WGLGeometryType.TEXT:return C;case c.WGLGeometryType.LABEL:return B}}function r(b){switch(b%4){case 0:case 2:return 4;case 1:case 3:return 1}}function m(b){switch(b){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}
function v(b){var a={},c=function(c){var d=0;a[c]=b[c].map(function(b){var a=e.__assign(e.__assign({},b),{normalized:b.normalized||!1,divisor:b.divisor||0,offset:d,stride:0});d+=b.count*m(b.type);return a});a[c].forEach(function(b){return b.stride=d})},d;for(d in b)c(d);return a}var l;Object.defineProperty(a,"__esModule",{value:!0});a.createProgramDescriptor=a.getPixelArrayCtor=a.getPixelBytes=a.getBytes=a.geometryToMappedGeometry=a.createTextureFromTexelData=a.createGeometryData=a.C_VBO_INFO=a.copyMeshData=
a.getTransformParams=a.getVVType=a.getJoinType=a.getCapType=a.isNumber=a.isDefined=a.getTextProperties=a.allocateTypedArrayBufferwithData=a.allocateTypedArrayBuffer=a.strideToPackingFactor=a.getNamedBuffers=a.getStrides=a.C_LABEL_STRIDE_SPEC=a.C_TEXT_STRIDE_SPEC=a.C_LINE_STRIDE_SPEC=a.C_FILL_STRIDE_SPEC_DD=a.C_FILL_STRIDE_SPEC=a.C_ICON_STRIDE_SPEC=a.C_LABEL_VERTEX_DEF=a.C_TEXT_VERTEX_DEF=a.C_LINE_VERTEX_DEF=a.C_FILL_VERTEX_DEF_DD=a.C_FILL_VERTEX_DEF=a.C_ICON_VERTEX_DEF=a.C_VBO_PERINSTANCE_VV=a.C_VBO_PERINSTANCE=
a.C_VBO_GEOMETRY=void 0;var w=h.getLogger("esri.views.2d.engine.webgl.Utils");a.C_VBO_GEOMETRY="geometry";a.C_VBO_PERINSTANCE="per_instance";a.C_VBO_PERINSTANCE_VV="per_instance_vv";a.C_ICON_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF_DD=[{name:a.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];a.C_LINE_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_TEXT_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,
strideInBytes:32,divisor:0}];a.C_LABEL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_ICON_STRIDE_SPEC=u(a.C_ICON_VERTEX_DEF);a.C_FILL_STRIDE_SPEC=u(a.C_FILL_VERTEX_DEF);a.C_FILL_STRIDE_SPEC_DD=u(a.C_FILL_VERTEX_DEF_DD);a.C_LINE_STRIDE_SPEC=u(a.C_LINE_VERTEX_DEF);a.C_TEXT_STRIDE_SPEC=u(a.C_TEXT_VERTEX_DEF);a.C_LABEL_STRIDE_SPEC=u(a.C_LABEL_VERTEX_DEF);a.getStrides=function(b,d){switch(b){case c.WGLGeometryType.MARKER:return a.C_ICON_STRIDE_SPEC;case c.WGLGeometryType.FILL:return d?
a.C_FILL_STRIDE_SPEC_DD:a.C_FILL_STRIDE_SPEC;case c.WGLGeometryType.LINE:return a.C_LINE_STRIDE_SPEC;case c.WGLGeometryType.TEXT:return a.C_TEXT_STRIDE_SPEC;case c.WGLGeometryType.LABEL:return a.C_LABEL_STRIDE_SPEC}};var p=[a.C_VBO_GEOMETRY],y=[a.C_VBO_GEOMETRY],z=[a.C_VBO_GEOMETRY],C=[a.C_VBO_GEOMETRY],B=[a.C_VBO_GEOMETRY];a.getNamedBuffers=t;a.strideToPackingFactor=r;a.allocateTypedArrayBuffer=function(b,a){switch(a%4){case 0:case 2:return new Uint32Array(Math.floor(b*a/4));case 1:case 3:return new Uint8Array(b*
a)}};a.allocateTypedArrayBufferwithData=function(b,a){switch(a%4){case 0:case 2:return new Uint32Array(b);case 1:case 3:return new Uint8Array(b)}};a.getTextProperties=function(a){return q.TextProperties.pool.acquire(a.color?b.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?b.copyAndPremultiply(a.haloColor):[255,255,255,255],n.pt2px(a.haloSize),n.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?
1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};a.isDefined=function(b){return null!=b};a.isNumber=function(b){return"number"===typeof b};a.getCapType=function(b,a){switch(b){case "butt":return 0;case "round":return a?2:1;case "square":return 2;default:return w.error(new k("mapview-invalid-type","Cap type "+b+" is not a valid option. Defaulting to round")),1}};a.getJoinType=function(b){switch(b){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return w.error(new k("mapview-invalid-type",
"Join type "+b+" is not a valid option. Defaulting to round")),1}};a.getVVType=function(b){switch(b){case "opacity":return c.VVType.OPACITY;case "color":return c.VVType.COLOR;case "rotation":return c.VVType.ROTATION;case "size":return c.VVType.SIZE;default:return w.error("Cannot interpret unknown vv: "+b),null}};a.getTransformParams=function(b){return{transform:b.transform,hasZ:b.hasZ,hasM:b.hasM}};a.copyMeshData=function(b,a,c,d,f,m,l){for(var e in m)for(var p=m[e].stride,q=r(p),h=m[e].data,n=c[e].data,
k=p*f.vertexCount/q,v=p*b/q,q=p*f.vertexFrom/q,p=0;p<k;++p)n[p+v]=h[p+q];c=f.indexCount;for(p=0;p<c;++p)d[p+a]=l[p+f.indexFrom]-f.vertexFrom+b};a.C_VBO_INFO=(l={},l[a.C_VBO_GEOMETRY]=35044,l);a.createGeometryData=function(b,a){for(var c=[],d=0;5>d;++d){for(var f={},m=0,l=t(d);m<l.length;m++){var e=l[m];f[e]={data:a(d,e)}}c.push({data:b(d),buffers:f})}return c};a.createTextureFromTexelData=function(b,a){var c,m;f.isPowerOfTwo(a.width)&&f.isPowerOfTwo(a.height)?(c=!0,m=9987):(c=!1,m=9729);return new d.Texture(b,
{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:c,samplingMode:m,wrapMode:33071,flipped:!0},a)};a.geometryToMappedGeometry=function(b){return{vertexFrom:void 0,vertexTo:void 0,geometry:b}};a.getBytes=m;a.getPixelBytes=function(b){switch(b){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:w.error(new k("webgl-utils","Unable to handle type "+b))}};a.getPixelArrayCtor=function(b){switch(b){case 5121:return Uint8Array;case 32819:return Uint16Array;case 5126:return Float32Array;
default:w.error(new k("webgl-utils","Unable to handle type "+b))}};var E=new Map;a.createProgramDescriptor=function(b,a){if(!E.has(b)){var c=v(a),d={},f;for(f in c){var m=c[f];d[f]=m.length?m[0].stride:0}f={};for(var l in a)for(var m=0,e=a[l];m<e.length;m++){var p=e[m];f[p.name]=p.location}E.set(b,{strides:d,bufferLayouts:c,attributes:f})}return E.get(b)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],function(g,a,e){function k(a,d){Array.isArray(d)?(a[0]=
d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3]):(a[0]=d.r,a[1]=d.g,a[2]=d.b,a[3]=d.a);return a}function h(a,d,b){void 0===d&&(d=0);void 0===b&&(b=!1);var c=a[d+3];a[d+0]*=c;a[d+1]*=c;a[d+2]*=c;b||(a[d+3]*=255);return a}Object.defineProperty(a,"__esModule",{value:!0});a.premultiplyAlphaRGBAArray=a.premultiplyAlphaRGBA=a.premultiplyAlphaUint32=a.copyAndPremultiply=a.premultiplyAlpha=a.white=void 0;a.white=[255,255,255,1];var f=[0,0,0,0];a.premultiplyAlpha=h;a.copyAndPremultiply=function(a){return h(k([],a))};a.premultiplyAlphaUint32=
function(a){h(k(f,a));return e.i8888to32(f[0],f[1],f[2],f[3])};a.premultiplyAlphaRGBA=function(a){if(!a)return 0;var d=a.a;return e.i8888to32(a.r*d,a.g*d,a.b*d,255*d)};a.premultiplyAlphaRGBAArray=function(a){if(!a)return 0;var d=a[3];return e.i8888to32(d/255*a[0],d/255*a[1],d/255*a[2],d)}})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(g,a){function e(a,e,d){return Math.round(Math.max(Math.min(a,d),e))}Object.defineProperty(a,"__esModule",{value:!0});a.numTo32=
a.i8816to32=a.i8888to32=a.i1616to32=a.u32to4Xu8=a.toFloat32=a.toUint32=a.u32=a.u16=a.u8=a.i32=a.i16=a.i8=void 0;var k=new Float32Array(1),h=new Uint32Array(k.buffer);a.i8=function(a){return e(a,-128,127)};a.i16=function(a){return e(a,-32768,32767)};a.i32=function(a){return e(a,-2147483648,2147483647)};a.u8=function(a){return e(a,0,255)};a.u16=function(a){return e(a,0,65535)};a.u32=function(a){return e(a,0,4294967295)};a.toUint32=function(a){k[0]=a;return h[0]};a.toFloat32=function(a){h[0]=a;return k[0]};
a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>8,(a&16711680)>>>16,(a&4278190080)>>>24]};a.i1616to32=function(a,e){return 65535&a|e<<16};a.i8888to32=function(a,e,d,b){return a&255|(e&255)<<8|(d&255)<<16|b<<24};a.i8816to32=function(a,e,d){return a&255|(e&255)<<8|d<<16};a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.TextProperties=
void 0;g=function(){function a(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}a.prototype.acquire=function(a,f,e,d,b,c,q,k,g){this.color=a;this.haloColor=f;this.haloSize=e;this.size=d;this.angle=b;this.offsetX=c;this.offsetY=q;this.hAnchor=k;this.vAnchor=g};a.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=
this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};a.pool=new e(a);return a}();a.TextProperties=g})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.background=void 0;a.background={name:"background",shaders:{vertexShader:e.resolveIncludes("background/background.vert"),fragmentShader:e.resolveIncludes("background/background.frag")},
attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.resolveIncludes=void 0;var h=new e.ShaderCompiler(function(a){var f=k.default;a.split("/").forEach(function(a){f&&(f=f[a])});return f});a.resolveIncludes=function(a){return h.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.default={background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}",
"bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\n  return max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\n  float vIn \x3d rgb2v(Cb);\n  vec3 hsvTint \x3d rgb2hsv(Cs);\n  vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n  return hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\n  return (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\n return (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\n\treturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\n  if (Cs \x3c\x3d 0.5) {\n    return Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n  }\n  if (Cb \x3c\x3d 0.25) {\n    return Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n  }\n  return Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\n  return min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\n  return max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\n  return dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\n  return maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\n  float lum \x3d lumv3(color);\n  float mincol \x3d minv3(color);\n  float maxcol \x3d maxv3(color);\n  if (mincol \x3c 0.0) {\n    color \x3d lum + ((color - lum) * lum) / (lum - mincol);\n  }\n  if (maxcol \x3e 1.0) {\n    color \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n  }\n  return color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\n  float lbase \x3d lumv3(cbase);\n  float llum \x3d lumv3(clum);\n  float ldiff \x3d llum - lbase;\n  vec3 color \x3d cbase + vec3(ldiff);\n  return clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\n  float minbase \x3d minv3(cbase);\n  float sbase \x3d satv3(cbase);\n  float ssat \x3d satv3(csat);\n  vec3 color;\n  if (sbase \x3e 0.0) {\n    color \x3d (cbase - minbase) * ssat / sbase;\n  } else {\n    color \x3d vec3(0.0);\n  }\n  return setLum(color, clum);\n}\nvoid main() {\n  vec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\n  gl_FragColor \x3d src *  u_opacity;\n#else\n  vec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\n  vec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\n  vec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\n  float as \x3d u_opacity * src.a;\n  float ab \x3d dst.a;\n  #ifdef DESTINATION_OVER\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n  #endif\n  #ifdef SOURCE_IN\n    vec4 color \x3d vec4(as * Cs * ab, as * ab);\n    vec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\n    gl_FragColor \x3d color + fadeColor;\n  #endif\n  #ifdef DESTINATION_IN\n    vec4 color \x3d vec4(ab * Cb * as, ab * as);\n    vec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\n    gl_FragColor \x3d color + fadeColor;\n  #endif\n  #ifdef SOURCE_OUT\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n  #endif\n  #ifdef DESTINATION_OUT\n    gl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n  #endif\n  #ifdef SOURCE_ATOP\n    gl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n  #endif\n  #ifdef DESTINATION_ATOP\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n  #endif\n  #ifdef XOR\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\n                        as * (1.0 - ab) + ab * (1.0 - as));\n  #endif\n  #ifdef MULTIPLY\n    gl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SCREEN\n    gl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef OVERLAY\n    vec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DARKEN\n    gl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LIGHTER\n    gl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n  #endif\n  #ifdef LIGHTEN\n    gl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_DODGE\n    vec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_BURN\n    vec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HARD_LIGHT\n    vec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SOFT_LIGHT\n    vec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DIFFERENCE\n    gl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef EXCLUSION\n     vec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef INVERT\n    gl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n  #endif\n  #ifdef VIVID_LIGHT\n    vec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\n                  vividLight(Cb.g, Cs.g),\n                  vividLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HUE\n    vec3 f \x3d setLumSat(Cs,Cb,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SATURATION\n    vec3 f \x3d setLumSat(Cb,Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR\n    vec3 f \x3d setLum(Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LUMINOSITY\n    vec3 f \x3d setLum(Cb,Cs);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef PLUS\n    gl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n  #endif\n  #ifdef MINUS\n     gl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n  #endif\n  #ifdef AVERAGE\n     vec3 f \x3d (Cb + Cs) / 2.0;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef REFLECT\n    vec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\n                  reflectBlend(Cb.g, Cs.g),\n                  reflectBlend(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position , 0.0, 1.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackDisplayIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity();\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  float width \x3d u_zoomFactor * a_aux1.x * aux2.x;\n  float height \x3d u_zoomFactor * a_aux1.y * aux2.y;\n  float angle \x3d C_256_TO_RAD * a_aux3.z;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  mat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n                           -sinA / width, cosA / height, 0,\n                            0,            0,             1);\n  vec2 symbolOffset \x3d (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\n  v_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity();\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_glyphData.x;\n  float glyphMaxZoom    \x3d a_glyphData.y;\n  float glyphAngle      \x3d a_glyphData.z;\n  float a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\n  float a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\n  vec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\n  float a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize           \x3d a_texAndSize.z;\n  float haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  float animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\n  v_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\n  v_opacity   \x3d 1.0;\n  v_tex       \x3d a_texCoords / u_mosaicSize;\n  v_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d v_lineHalfWidth;\n  mediump float adjustedPatternWidth \x3d v_patternSize.x * 2.0 * lineHalfWidth / v_patternSize.y;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / adjustedPatternWidth, 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexY, relativeTexX));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity();\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  float SDF_CUTOFF \x3d (2.0 / 8.0);\n  float SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\n  edge /\x3d 2.0;\n#endif\n  lowp float aa \x3d v_antialiasingWidth;\n  lowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\n  gl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet      \x3d a_aux.w;\n  float a_fontSize    \x3d a_texFontSize.z;\n  vec2  a_offset      \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float fontSize      \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor   \x3d fontSize / a_fontSize;\n  float fontScale     \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset        \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  mat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\n  v_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\n  v_opacity \x3d getOpacity();\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texCoords / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\n  v_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackDisplayIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\n  return (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\n  gl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\n  float mirrorFactor \x3d 1.2 - factor;\n  return mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\n  gl_FragColor \x3d u_bloomStrength * (\n    lerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\n    lerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\n    lerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\n    lerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\n    lerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n  );\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\n  vec2 invSize \x3d 1.0 / u_texSize;\n  float fSigma \x3d float(SIGMA);\n  float weightSum \x3d gaussianPdf(0.0, fSigma);\n  vec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\n  for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n    float x \x3d float(i);\n    float w \x3d gaussianPdf(x, fSigma);\n    vec2 uvOffset \x3d u_direction * invSize * x;\n    vec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\n    vec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\n    pixelColorSum +\x3d (sample1 + sample2) * w;\n    weightSum +\x3d 2.0 * w;\n  }\n  gl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 texel \x3d texture2D(u_texture, v_uv);\n  vec3 luma \x3d vec3(0.299, 0.587, 0.114);\n  float v \x3d dot(texel.xyz, luma);\n  vec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\n  float alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\n  gl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\n  vec2 invSize \x3d 1.0 / u_texSize;\n  float fSigma \x3d u_sigma;\n  float weightSum \x3d gaussianPdf(0.0, fSigma);\n  vec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\n  for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n    float x \x3d float(i);\n    float w \x3d gaussianPdf(x, fSigma);\n    vec2 uvOffset \x3d u_direction * invSize * x;\n    vec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\n    vec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\n    pixelColorSum +\x3d (sample1 + sample2) * w;\n    weightSum +\x3d 2.0 * w;\n  }\n  gl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\n    float samples[10];\n    samples[0] \x3d -0.08;\n    samples[1] \x3d -0.05;\n    samples[2] \x3d -0.03;\n    samples[3] \x3d -0.02;\n    samples[4] \x3d -0.01;\n    samples[5] \x3d  0.01;\n    samples[6] \x3d  0.02;\n    samples[7] \x3d  0.03;\n    samples[8] \x3d  0.05;\n    samples[9] \x3d  0.08;\n    vec2 dir \x3d 0.5 - v_uv;\n    float dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\n    dir \x3d dir / dist;\n    vec4 color \x3d texture2D(u_colorTexture,v_uv);\n    vec4 sum \x3d color;\n    for (int i \x3d 0; i \x3c 10; i++) {\n      sum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n    }\n    sum *\x3d 1.0 / 11.0;\n    float t \x3d dist * sampleStrength;\n    t \x3d clamp(t, 0.0, 1.0);\n    gl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\n  vec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\n  vec4 color \x3d texture2D(u_texture, v_uv);\n  vec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\n  vec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\n  vec3 colorUnpremultiply \x3d color.rgb / color.a;\n  vec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\n  gl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\n  vec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\n  vec2 onePixel \x3d vec2(1.0) / u_srcResolution;\n  vec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\n  vec4 minColor \x3d vec4(1.0);\n  vec4 maxColor \x3d vec4(0.0);\n  for (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\n    for (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\n      vec2 offset \x3d uv + vec2(x, y) * onePixel;\n      minColor \x3d min(minColor, texture2D(u_minTexture, offset));\n      maxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n    }\n  }\n  gl_FragData[0] \x3d minColor;\n  gl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\n  vec4 blurColor \x3d texture2D(u_blurTexture, v_uv);\n  gl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"},"drop-shadow.vert":"precision mediump float;\nattribute vec2 a_position;\nuniform highp mat3 u_displayViewMat3;\nuniform highp vec2 u_offset;\nvarying vec2 v_uv;\nvoid main() {\n  vec3 offset \x3d u_displayViewMat3 * vec3(u_offset, 0.0);\n  gl_Position \x3d vec4(a_position, 0.0, 1.0) + vec4(offset, 0.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\n  G[0] \x3d g0,\n  G[1] \x3d g1,\n  G[2] \x3d g2,\n  G[3] \x3d g3,\n  G[4] \x3d g4,\n  G[5] \x3d g5,\n  G[6] \x3d g6,\n  G[7] \x3d g7,\n  G[8] \x3d g8;\n  mat3 I;\n  float cnv[9];\n  vec3 sample;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 9; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  float M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\n  float S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\n  gl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\n  mat3 I;\n  float cnv[2];\n  vec3 sample;\n  G[0] \x3d g0;\n  G[1] \x3d g1;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 2; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  gl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\n  mat3 I;\n  float cnv[2];\n  vec3 sample;\n  G[0] \x3d g0;\n  G[1] \x3d g1;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 2; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  vec4 color \x3d texture2D(u_colorTexture, v_uv);\n  gl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 color \x3d texture2D(u_colorTexture, v_uv);\n  vec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  gl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\n  targetLocation \x3d projectPixelLocation(targetLocation);\n#endif\n  return targetLocation;\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#else\n  vec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\n  return color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\n  if (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\n    return 0.0;\n  }\n  else {\n    return e;\n  }\n}\nvec3 rgb2hsv(vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\n  val \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\n  vec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\n  vec3 hsv \x3d rgb2hsv(rgb.xyz);\n  hsv.z \x3d hillshade;\n  return vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  vec2 axy \x3d vec2(-1.0, -1.0);\n  vec2 bxy \x3d vec2(0.0, -1.0);\n  vec2 cxy \x3d vec2(1.0, -1.0);\n  vec2 dxy \x3d vec2(-1.0, 0.0);\n  vec2 fxy \x3d vec2(1.0, 0.0);\n  vec2 gxy \x3d vec2(-1.0, 1.0);\n  vec2 hxy \x3d vec2(0.0, 1.0);\n  vec2 ixy \x3d vec2(1.0, 1.0);\n  vec2 onePixel \x3d 1.0 / u_srcImageSize;\n  if (pixelLocation.s \x3c onePixel.s) {\n    axy[0] \x3d 1.0;\n    dxy[0] \x3d 1.0;\n    gxy[0] \x3d 1.0;\n  }\n  if (pixelLocation.t \x3c onePixel.t) {\n    axy[1] \x3d 1.0;\n    bxy[1] \x3d 1.0;\n    cxy[1] \x3d 1.0;\n  }\n  if (pixelLocation.s \x3e 1.0 - onePixel.s) {\n    cxy[0] \x3d -1.0;\n    fxy[0] \x3d -1.0;\n    ixy[0] \x3d -1.0;\n  }\n  if (pixelLocation.t \x3e 1.0 - onePixel.t) {\n    gxy[1] \x3d -1.0;\n    hxy[1] \x3d -1.0;\n    ixy[1] \x3d -1.0;\n  }\n  vec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\n  vec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\n  vec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\n  vec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\n  vec4 ve \x3d texture2D(u_image, pixelLocation);\n  vec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\n  vec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\n  vec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\n  vec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\n  float dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\n  float dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\n  float dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\n  float hillshade \x3d 0.0;\n  if (u_hillshadeType \x3d\x3d 0){\n\t   float cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\n     float z \x3d (u_cosZs[0] + cosDelta) / dzd;\n     if (z \x3c 0.0)  z \x3d 0.0;\n\t   hillshade \x3d z;\n  } else {\n\t  for (int k \x3d 0; k \x3c 6; k++) {\n\t\t float cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\n\t\t float z \x3d (u_cosZs[k] + cosDelta) / dzd;\n\t\t if (z \x3c 0.0) z \x3d 0.0;\n     hillshade \x3d hillshade + z * u_weights[k];\n\t\t if (k \x3d\x3d 5) break;\n    }\n  }\n  float alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\n  gl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\n  gl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\n  float clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\n  vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n  vec4 color \x3d texture2D(u_colormap, clrPosition);\n  vec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  vec4 result \x3d colorize(currentPixel, 1.0);\n  gl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}",
"lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\n      vec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\n      gl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(g,a,e,k,h,f,n,d){Object.defineProperty(a,"__esModule",{value:!0});g=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a._color=k.vec4f32.fromValues(1,0,0,1);return a}e.__extends(a,b);a.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=
null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};a.prototype.prepareState=function(b){b=b.context;b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!1)};a.prototype.draw=function(b,a){b=b.context;if(a.isReady){this._loadWGLResources(b);b.bindVAO(this._outlineVertexArrayObject);b.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",
a.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",a.coordRange[0],a.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);b.drawArrays(3,0,4);b.bindVAO();var c=this._getTexture(b,a);c&&(b.bindVAO(this._tileInfoVertexArrayObject),b.bindProgram(this._tileInfoProgram),b.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",
a.coordRange[0]/a.size[0],a.coordRange[1]/a.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),b.drawArrays(5,0,4),b.bindVAO())}};a.prototype._loadWGLResources=function(b){if(!this._outlineProgram||!this._tileInfoProgram){var a=h.createProgram(b,n.background),c=h.createProgram(b,d.tileInfo),f={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},m=new Int8Array([0,0,
1,0,1,1,0,1]),m=h.BufferObject.createVertex(b,35044,m),m=new h.VertexArrayObject(b,n.background.attributes,f,{geometry:m}),e=new Int8Array([0,0,1,0,0,1,1,1]),e=h.BufferObject.createVertex(b,35044,e);b=new h.VertexArrayObject(b,d.tileInfo.attributes,f,{geometry:e});this._outlineProgram=a;this._tileInfoProgram=c;this._outlineVertexArrayObject=m;this._tileInfoVertexArrayObject=b}};a.prototype._getTexture=function(b,a){if(a.texture&&a.triangleCountReportedInDebug===a.triangleCount)return a.texture;a.triangleCountReportedInDebug=
a.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=a.triangleCount,d=a.key.id;0<a.triangleCount&&(d+=", "+c);var f=this._canvas,e=f.getContext("2d");e.font="24px sans-serif";e.textAlign="left";e.textBaseline="top";e.clearRect(0,0,300,32);1E5<c?(e.fillStyle="red",e.fillRect(0,0,300,32),e.fillStyle=
"black"):(e.clearRect(0,0,300,32),e.fillStyle="blue");e.fillText(d,0,0);a.texture=new h.Texture(b,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},f);return a.texture};return a}(f.default);a.default=g})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.tileInfo=void 0;a.tileInfo={name:"tileInfo",shaders:{vertexShader:e.resolveIncludes("tileInfo/tileInfo.vert"),
fragmentShader:e.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=k.vec4f32.fromValues(1,0,0,1);b._initialized=!1;return b}
e.__extends(b,a);b.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};b.prototype.prepareState=function(b,a){b=b.context;b.setDepthWriteEnabled(!1);b.setDepthTestEnabled(!1);b.setStencilTestEnabled(!0);b.setBlendingEnabled(!1);b.setColorMask(!1,!1,!1,!1);b.setStencilOp(7680,7680,7681);b.setStencilWriteMask(255);b.setStencilFunctionSeparate(1032,
516,a.stencilRef,255)};b.prototype.draw=function(b,a){b=b.context;this._initialized||this._initialize(b);b.bindVAO(this._solidVertexArrayObject);b.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",a.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);b.drawArrays(5,0,4);b.bindVAO()};b.prototype._initialize=function(b){if(this._initialized)return!0;
var a=h.createProgram(b,n.background);if(!a)return!1;var c=new Int8Array([0,0,1,0,0,1,1,1]),c=h.BufferObject.createVertex(b,35044,c);b=new h.VertexArrayObject(b,n.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:c});this._solidProgram=a;this._solidVertexArrayObject=b;return this._initialized=!0};return b}(f.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports tslib ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q){Object.defineProperty(a,"__esModule",{value:!0});a.WGLBrushVTLBackground=void 0;g=function(a){function q(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.fromValues(1,0,0,1);b._patternMatrix=k.mat3f32.create();b._programOptions={id:!1,pattern:!1};return b}e.__extends(q,a);q.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};q.prototype.drawMany=function(a,f){var m=
a.context,l=a.styleLayerId;this._loadWGLResources(m);var e=a.displayLevel,p=a.styleLayer,q=a.painter.getVectorTileProgramCach(),h=p.getPaintValue("background-color",e),r=p.getPaintValue("background-opacity",e),k=p.getPaintValue("background-pattern",e),n=void 0!==k,g=h[3]*r,t=a.spriteMosaic,u,I=(window.devicePixelRatio|1)>d.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===b.WGLDrawPhase.HITTEST;var G=this._programOptions;G.id=a;G.pattern=n;q=q.getProgram(0,(a?1:0)<<1|(n?1:0),G);m.bindVAO(this._vao);m.bindProgram(q);
if(n){u=t.getMosaicItemPosition(k,!0);if(!u)return;q.setUniform1f("u_opacity",r);q.setUniform2f("u_pattern_tl",u.tl[0],u.tl[1]);q.setUniform2f("u_pattern_br",u.br[0],u.br[1]);q.setUniform1i("u_texture",d.VTL_TEXTURE_BINDING_UNIT_SPRITES);t.bind(m,9729,u.page,d.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=g*h[0],this._color[1]=g*h[1],this._color[2]=g*h[2],this._color[3]=g,q.setUniform4fv("u_color",this._color);q.setUniform1f("u_depth",p.z||0);a&&(l=c.u32to4Xu8(l+1),q.setUniform4fv("u_id",
l));for(l=0;l<f.length;l++)p=f[l],q.setUniform1f("u_coord_range",p.coordRange[0]),q.setUniformMatrix3fv("u_dvsMat3",p.transforms.dvs),n&&(h=I*p.size[0]*Math.max(Math.pow(2,Math.round(e)-p.key.level),1),r=h/u.size[1],this._patternMatrix[0]=h/u.size[0],this._patternMatrix[4]=r,q.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),m.setStencilFunction(514,p.stencilRef,255),m.drawArrays(5,0,4)};q.prototype._loadWGLResources=function(b){if(!this._program||!this._vao){var a=f.createProgram(b,n.background);
if(a){var c=new Int8Array([0,0,1,0,0,1,1,1]),c=f.BufferObject.createVertex(b,35044,c);b=new f.VertexArrayObject(b,n.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:c});this._program=a;this._vao=b}}};return q}(q.default);a.WGLBrushVTLBackground=g})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,a,e,k){Object.defineProperty(a,"__esModule",
{value:!0});a.text=a.line=a.icon=a.outline=a.fill=a.circle=a.background=void 0;a.background={name:"background",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+k.resolveIncludes("background/background.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+k.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};a.circle={name:"circle",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id})+k.resolveIncludes("circle/circle.vert"),
fragmentShader:e.glslifyDefineMap({ID:a.id})+k.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var h=function(a){return e.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.fill={name:"fill",shaders:function(a){return{vertexShader:h(a)+k.resolveIncludes("fill/fill.vert"),fragmentShader:h(a)+k.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};a.outline={name:"outline",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,
DD:a.dd})+k.resolveIncludes("outline/outline.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+k.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};a.icon={name:"icon",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+k.resolveIncludes("icon/icon.vert"),fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+k.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_texAngleRange:2,
a_levelInfo:3,a_color:4,a_size:5,a_opacityInfo:6}};var f=function(a){return e.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.line={name:"line",shaders:function(a){return{vertexShader:f(a)+k.resolveIncludes("line/line.vert"),fragmentShader:f(a)+k.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};a.text={name:"text",shaders:function(a){return{vertexShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+k.resolveIncludes("text/text.vert"),
fragmentShader:e.glslifyDefineMap({ID:a.id,DD:a.dd})+k.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_texAngleRange:2,a_levelInfo:3,a_color:4,a_size:5,a_opacityInfo:6}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.resolveIncludes=void 0;var h=new e.ShaderCompiler(function(a){var f=k.default;a.split("/").forEach(function(a){f&&
(f=f[a])});return f});a.resolveIncludes=function(a){return h.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.default={background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_opacity;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n  float modded \x3d mod(a_opacityInfo, 128.0);\n  float targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\n  float startOpacity \x3d modded / 127.0;\n  float interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\n  v_opacity \x3d u_opacity * interpolatedOpacity;\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump vec2 a_tex            \x3d a_texAngleRange.xy;\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  delta_z +\x3d step(v_opacity, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_opacity *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_opacity;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nvarying lowp float v_opacity;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nuniform highp float u_time;\nvoid main()\n{\n  float modded \x3d mod(a_opacityInfo, 128.0);\n  float targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\n  float startOpacity \x3d modded / 127.0;\n  float interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\n  v_opacity \x3d u_opacity * interpolatedOpacity;\n  mediump float a_angle       \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump vec2 a_tex           \x3d a_texAngleRange.xy;\n  mediump float a_visMinAngle    \x3d a_texAngleRange.z;\n  mediump float a_visMaxAngle    \x3d a_texAngleRange.w;\n  mediump float delta_z \x3d 0.0;\n  mediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\n  if (a_visMinAngle \x3c a_visMaxAngle)\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n  }\n  else\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n  }\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  delta_z +\x3d step(v_opacity, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports tslib ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec4f32 ../enums ../number ./WGLBrush".split(" "),function(g,
a,e,k,h,f,n,d){Object.defineProperty(a,"__esModule",{value:!0});a.WGLBrushVTLCircle=void 0;var b=[1,1,1,1];g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._color=h.vec4f32.create();b._strokeColor=h.vec4f32.create();b._programOptions={id:!1};return b}e.__extends(c,a);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,c){var d=a.context,m=a.state,e=a.drawPhase,l=a.styleLayerId,q=a.displayLevel,p=a.styleLayer;a=a.painter.getVectorTileProgramCach();var h=p.hasDataDrivenRadius?
1:p.getPaintValue("circle-radius",q),g=p.hasDataDrivenColor?b:p.getPaintValue("circle-color",q),t=p.hasDataDrivenOpacity?1:p.getPaintValue("circle-opacity",q),u=p.hasDataDrivenStrokeWidth?1:p.getPaintValue("circle-stroke-width",q),E=p.hasDataDrivenStrokeColor?b:p.getPaintValue("circle-stroke-color",q),x=p.hasDataDrivenStrokeOpacity?1:p.getPaintValue("circle-stroke-opacity",q),A=p.hasDataDrivenBlur?0:p.getPaintValue("circle-blur",q),t=t*g[3];this._color[0]=t*g[0];this._color[1]=t*g[1];this._color[2]=
t*g[2];this._color[3]=t;t=x*E[3];this._strokeColor[0]=t*E[0];this._strokeColor[1]=t*E[1];this._strokeColor[2]=t*E[2];this._strokeColor[3]=t;g=p.getPaintValue("circle-translate",q);q=p.getPaintValue("circle-translate-anchor",q);E=e===f.WGLDrawPhase.HITTEST;e=this._programOptions;e.id=E;e=a.getProgram(5,E?1:0,e);d.bindProgram(e);e.setUniformMatrix3fv("u_displayMat3",1===q?m.displayMat3:m.displayViewMat3);e.setUniform2fv("u_circleTranslation",g);e.setUniform1f("u_depth",p.z);e.setUniform1f("u_radius",
h);e.setUniform4fv("u_color",this._color);e.setUniform1f("u_blur",A);e.setUniform1f("u_stroke_width",u);e.setUniform4fv("u_stroke_color",this._strokeColor);e.setUniform1f("u_antialiasingWidth",1.2);E&&(m=n.u32to4Xu8(l+1),e.setUniform4fv("u_id",m));for(m=0;m<c.length;m++)p=c[m],p.layerData[l]&&(h=p.layerData[l],h.prepareForRendering(d,a),u=h.circleVertexArrayObject,k.isNone(u)||(d.bindVAO(u),e.setUniformMatrix3fv("u_dvsMat3",p.transforms.dvs),d.setStencilFunction(514,p.stencilRef,255),d.drawElements(4,
h.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*h.circleIndexStart),p.triangleCount+=h.circleIndexCount/3))};return c}(d.default);a.WGLBrushVTLCircle=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports tslib ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../definitions ../enums ../number ./WGLBrush".split(" "),function(g,a,e,k,h,f,n,d,b,c){Object.defineProperty(a,"__esModule",{value:!0});
a.WGLBrushVTLFill=void 0;var q=1/65536,u=[1,1,1,1];g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._color=f.vec4f32.create();b._outlineColor=f.vec4f32.create();b._fillProgramOptions={id:!1,dd:!1,pattern:!1};b._outlineProgramOptions={id:!1,dd:!1};b._patternMatrix=h.mat3f32.create();return b}e.__extends(c,a);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,c){var f=a.displayLevel,m=a.drawPhase,e=a.renderPass,q=a.styleLayerId,h=a.styleLayer,r=h.getPaintValue("fill-pattern",
f),k=h.hasDataDrivenColor?u:h.getPaintValue("fill-color",f),n=h.hasDataDrivenOpacity?1:h.getPaintValue("fill-opacity",f),v=n*k[3],g=void 0!==r||1>v||h.hasDataDrivenFill;if(!g||"opaque"!==e){this._color[0]=v*k[0];this._color[1]=v*k[1];this._color[2]=v*k[2];this._color[3]=v;var t;m===d.WGLDrawPhase.HITTEST&&(t=b.u32to4Xu8(q+1));m=h.getPaintValue("fill-translate",f);f=h.getPaintValue("fill-translate-anchor",f);this._drawFill(a,q,h,c,m,f,r,g,t);this._drawOutline(a,q,h,c,m,f,r,t,n)}};c.prototype._drawFill=
function(b,a,c,f,e,h,r,g,t){var m=b.context,l=b.displayLevel,p=b.drawPhase,v=b.renderPass,w=b.spriteMosaic,u=b.state;if(g||"translucent"!==v){g=void 0!==r;var v=b.pixelRatio>n.VTL_HIGH_RES_CUTOFF?2:1,z=c.hasDataDrivenFill;b=b.painter.getVectorTileProgramCach();var y,C=p===d.WGLDrawPhase.HITTEST,p=this._fillProgramOptions;p.id=C;p.dd=z;p.pattern=g;p=b.getProgram(1,(C?1:0)<<2|(z?1:0)<<1|(g?1:0),p);m.bindProgram(p);if(g){y=w.getMosaicItemPosition(r,!0);if(!y){m.bindProgram();return}p.setUniform2f("u_pattern_tl",
y.tl[0],y.tl[1]);p.setUniform2f("u_pattern_br",y.br[0],y.br[1]);p.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES);w.bind(m,9729,y.page,n.VTL_TEXTURE_BINDING_UNIT_SPRITES)}p.setUniformMatrix3fv("u_displayMat3",1===h?u.displayMat3:u.displayViewMat3);p.setUniform2fv("u_fillTranslation",e);p.setUniform1f("u_depth",c.z+q);p.setUniform4fv("u_color",this._color);C&&p.setUniform4fv("u_id",t);for(c=0;c<f.length;c++)e=f[c],e.layerData[a]&&(h=e.layerData[a],h.prepareForRendering(m,b),r=h.fillVertexArrayObject,
k.isNone(r)||(m.bindVAO(r),p.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),g&&(r=e.coordRange[0]/(v*e.size[0]*Math.max(Math.pow(2,Math.round(l)-e.key.level),1)),t=1/(y.size[1]*r),this._patternMatrix[0]=1/(y.size[0]*r),this._patternMatrix[4]=t,p.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),m.setStencilFunction(514,e.stencilRef,255),m.drawElements(4,h.fillIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*h.fillIndexStart),e.triangleCount+=h.fillIndexCount/3))}};c.prototype._drawOutline=
function(b,a,c,f,e,h,r,n,g){var m=b.context,l=b.displayLevel,p=b.drawPhase,v=b.pixelRatio,w=b.state;if("opaque"!==b.renderPass&&(r=void 0!==r,c.getPaintValue("fill-antialias",l)&&!r||c.hasDataDrivenOutlineColor)){b=b.painter.getVectorTileProgramCach();r=c.hasDataDrivenOutline;if(c.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else l=c.hasDataDrivenOutlineColor?
u:c.getPaintValue("fill-outline-color",l),g*=l[3],this._outlineColor[0]=g*l[0],this._outlineColor[1]=g*l[1],this._outlineColor[2]=g*l[2],this._outlineColor[3]=g;v=.75/v;g=p===d.WGLDrawPhase.HITTEST;p=this._outlineProgramOptions;p.id=g;p.dd=r;p=b.getProgram(2,(g?1:0)<<1|(r?1:0),p);m.bindProgram(p);p.setUniformMatrix3fv("u_displayMat3",1===h?w.displayMat3:w.displayViewMat3);p.setUniform2fv("u_fillTranslation",e);p.setUniform1f("u_depth",c.z+q);p.setUniform1f("u_outline_width",v);p.setUniform4fv("u_color",
this._outlineColor);g&&p.setUniform4fv("u_id",n);for(c=0;c<f.length;c++)e=f[c],e.layerData[a]&&(h=e.layerData[a],h.prepareForRendering(m,b),n=h.outlineVertexArrayObject,k.isNone(n)||(m.bindVAO(n),p.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),m.setStencilFunction(514,e.stencilRef,255),m.drawElements(4,h.outlineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*h.outlineIndexStart),e.triangleCount+=h.outlineIndexCount/3))}};return c}(c.default);a.WGLBrushVTLFill=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports tslib ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../definitions ../enums ../number ./WGLBrush".split(" "),
function(g,a,e,k,h,f,n,d,b,c){Object.defineProperty(a,"__esModule",{value:!0});a.WGLBrushVTLLine=a.C_DEG_TO_RAD=void 0;a.C_DEG_TO_RAD=Math.PI/180;var q=[1,1,1,1];g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._color=f.vec4f32.create();b._dashArray=h.vec2f32.create();b._programOptions={id:!1,dd:!1,pattern:!1};return b}e.__extends(c,a);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,c){var f=a.context,m=a.displayLevel,e=a.state,p=a.drawPhase,h=a.styleLayerId,
r=a.styleLayer,g=a.painter.getVectorTileProgramCach(),t=r.getPaintValue("line-translate",m),u=r.getPaintValue("line-translate-anchor",m),x=r.getPaintValue("line-pattern",m),A=void 0!==x,F=1/a.pixelRatio,I=r.getPaintValue("line-blur",m),G=r.hasDataDrivenColor?q:r.getPaintValue("line-color",m),J=r.hasDataDrivenOpacity?1:r.getPaintValue("line-opacity",m),H=r.hasDataDrivenWidth?1:r.getPaintValue("line-width",m),J=J*G[3];this._color[0]=J*G[0];this._color[1]=J*G[1];this._color[2]=J*G[2];this._color[3]=
J;var G=r.hasDataDrivenLine,J=p===d.WGLDrawPhase.HITTEST,M;J&&(M=b.u32to4Xu8(h+1));p=this._programOptions;p.id=J;p.dd=G;p.pattern=A;p=g.getProgram(3,(J?1:0)<<2|(G?1:0)<<1|(A?1:0),p);f.bindProgram(p);p.setUniformMatrix3fv("u_displayViewMat3",e.displayViewMat3);p.setUniformMatrix3fv("u_displayMat3",1===u?e.displayMat3:e.displayViewMat3);p.setUniform2fv("u_lineTranslation",t);p.setUniform1f("u_depth",r.z);p.setUniform1f("u_blur",I);p.setUniform1f("u_antialiasing",F);p.setUniform4fv("u_color",this._color);
p.setUniform1f("u_width",H);J&&p.setUniform4fv("u_id",M);if(A){if(a=a.spriteMosaic,x=a.getMosaicItemPosition(x,!0))a.bind(f,9729,x.page,n.VTL_TEXTURE_BINDING_UNIT_SPRITES),p.setUniform2f("u_pattern_tl",x.tl[0],x.br[1]),p.setUniform2f("u_pattern_br",x.br[0],x.tl[1]),p.setUniform2f("u_spriteSize",8*x.size[0],x.size[1]),p.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else x=r.getPaintValue("line-dasharray",m),2>x.length&&(x=[1,-1]),this._dashArray[0]=8*x[0],this._dashArray[1]=8*x[1],p.setUniform2fv("u_dasharray",
this._dashArray);for(x=0;x<c.length;x++)a=c[x],a.layerData[h]&&(m=a.layerData[h],m.prepareForRendering(f,g),e=m.lineVertexArrayObject,k.isNone(e)||(f.bindVAO(e),p.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),f.setStencilFunction(514,a.stencilRef,255),f.drawElements(4,m.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*m.lineIndexStart),a.triangleCount+=m.lineIndexCount/3))};return c}(c.default);a.WGLBrushVTLLine=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports tslib ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../vectorTiles/decluttering/config ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u){Object.defineProperty(a,"__esModule",{value:!0});a.WGLBrushVTLSymbol=void 0;var t=1/65536,r=[1,1,1,1];g=function(a){function m(){var b=null!==a&&a.apply(this,arguments)||this;b._iconProgramOptions={id:!1,dd:!1,sdf:!1};b._sdfProgramOptions={id:!1,dd:!1};b._spritesTextureSize=h.vec2f32.create();b._haloColor=f.vec4f32.create();b._sdfColor=f.vec4f32.create();b._color=f.vec4f32.create();return b}e.__extends(m,a);m.prototype.dispose=function(){};m.prototype.drawMany=function(a,
c){var d=a.styleLayerId,f=a.styleLayer,m;a.drawPhase===b.WGLDrawPhase.HITTEST&&(m=q.u32to4Xu8(d+1));this._drawIcons(a,f,c,m);this._drawText(a,f,c,m)};m.prototype._drawIcons=function(a,f,m,e){for(var l=this,p=a.context,h=a.displayLevel,q=a.drawPhase,g=a.painter,v=a.state,t=a.styleLayerId,w,u=!1,y=0;y<m.length;y++){var H=m[y];if(H.layerData[t]&&(w=H.layerData[t],0<w.iconPerPageElementsMap.size)){u=!0;break}}if(u){var H=f.hasDataDrivenIconSize?1:f.getLayoutValue("icon-size",h),M=f.hasDataDrivenIconColor?
r:f.getPaintValue("icon-color",h),L=f.hasDataDrivenIconOpacity?1:f.getPaintValue("icon-opacity",h),u=f.getPaintValue("icon-translate",h),y=f.getPaintValue("icon-translate-anchor",h),K=g.getVectorTileProgramCach(),g=M[3]*L;this._color[0]=g*M[0];this._color[1]=g*M[1];this._color[2]=g*M[2];this._color[3]=g;g=f.getLayoutValue("icon-rotation-alignment",h);2===g&&(g=1===f.getLayoutValue("symbol-placement",h)?0:1);var M=w.isIconSDF,L=f.hasDataDrivenIcon,q=q===b.WGLDrawPhase.HITTEST,N=this._iconProgramOptions;
N.id=q;N.dd=L;N.sdf=M;var Q=K.getProgram(4,(q?1:0)<<2|(L?1:0)<<1|(M?1:0),N);p.bindProgram(Q);M&&(M=f.getPaintValue("icon-halo-color",h),L=f.getPaintValue("icon-halo-width",h),Q.setUniform4f("u_outlineColor",M[0],M[1],M[2],M[3]),Q.setUniform1f("u_outlineSize",L));Q.setUniformMatrix3fv("u_displayViewMat3",0===g?v.displayViewMat3:v.displayMat3);Q.setUniformMatrix3fv("u_displayMat3",1===y?v.displayMat3:v.displayViewMat3);Q.setUniform2fv("u_iconTranslation",u);Q.setUniform1f("u_depth",f.z);Q.setUniform1f("u_mapRotation",
c.degToByte(v.rotation));Q.setUniform1f("u_keepUpright",0);Q.setUniform1f("u_level",10*h);Q.setUniform1i("u_texture",d.VTL_TEXTURE_BINDING_UNIT_SPRITES);Q.setUniform1f("u_size",H);Q.setUniform4fv("u_color",this._color);Q.setUniform1f("u_opacity",1);Q.setUniform1f("u_fadeDuration",n.FADE_DURATION/1E3);q&&Q.setUniform4fv("u_id",e);f=function(b){if(!b.layerData[t])return"continue";w=b.layerData[t];if(0===w.iconPerPageElementsMap.size)return"continue";w.prepareForRendering(p,K);w.updateOpacityInfo();
var c=w.iconVertexArrayObject;if(k.isNone(c))return"continue";p.bindVAO(c);Q.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);Q.setUniform1f("u_time",(performance.now()-w.lastOpacityUpdate)/1E3);w.iconPerPageElementsMap.forEach(function(c,d){l._renderIconRange(a,Q,c,d,b)})};for(e=0;e<m.length;e++)H=m[e],f(H)}};m.prototype._renderIconRange=function(b,a,c,f,m){var e=b.context;b=b.spriteMosaic;this._spritesTextureSize[0]=b.getWidth(f)/4;this._spritesTextureSize[1]=b.getHeight(f)/4;a.setUniform2fv("u_mosaicSize",
this._spritesTextureSize);b.bind(e,9729,f,d.VTL_TEXTURE_BINDING_UNIT_SPRITES);e.setStencilTestEnabled(!0);e.setStencilFunction(516,255,255);e.setStencilWriteMask(0);e.drawElements(4,c[1],5125,Uint32Array.BYTES_PER_ELEMENT*c[0]);m.triangleCount+=c[1]/3};m.prototype._drawText=function(a,f,m,e){for(var l=this,p=a.context,q=a.displayLevel,g=a.drawPhase,v=a.glyphMosaic,w=a.painter,u=a.pixelRatio,y=a.state,G=a.styleLayerId,J,H=!1,M=0;M<m.length;M++)if(a=m[M],a.layerData[G]&&(J=a.layerData[G],0<J.glyphPerPageElementsMap.size)){H=
!0;break}if(H){a=f.getLayoutValue("text-rotation-alignment",q);2===a&&(a=1===f.getLayoutValue("symbol-placement",q)?0:1);var H=0===a,H=f.getLayoutValue("text-keep-upright",q)&&H,g=g===b.WGLDrawPhase.HITTEST,u=.8*3/u,M=f.hasDataDrivenTextSize?1:f.getLayoutValue("text-size",q),L=f.hasDataDrivenTextColor?r:f.getPaintValue("text-color",q),K=f.hasDataDrivenTextOpacity?1:f.getPaintValue("text-opacity",q),N=f.getPaintValue("text-halo-color",q),Q=f.getPaintValue("text-halo-width",q),O=3*f.getPaintValue("text-halo-blur",
q),T=3*Q,R=w.getVectorTileProgramCach(),w=L[3]*K;this._sdfColor[0]=w*L[0];this._sdfColor[1]=w*L[1];this._sdfColor[2]=w*L[2];this._sdfColor[3]=w;w=N[3]*K;this._haloColor[0]=w*N[0];this._haloColor[1]=w*N[1];this._haloColor[2]=w*N[2];this._haloColor[3]=w;this._glyphTextureSize||(this._glyphTextureSize=h.vec2f32.fromValues(v.width/4,v.height/4));var w=f.getPaintValue("text-translate",q),L=f.getPaintValue("text-translate-anchor",q),K=f.hasDataDrivenText,V=this._sdfProgramOptions;V.id=g;V.dd=K;var S=R.getProgram(6,
(g?1:0)<<1|(K?1:0),V);p.bindProgram(S);S.setUniformMatrix3fv("u_displayViewMat3",0===a?y.displayViewMat3:y.displayMat3);S.setUniformMatrix3fv("u_displayMat3",1===L?y.displayMat3:y.displayViewMat3);S.setUniform2fv("u_textTranslation",w);S.setUniform1f("u_depth",f.z+t);S.setUniform2fv("u_mosaicSize",this._glyphTextureSize);S.setUniform1f("u_mapRotation",c.degToByte(y.rotation));S.setUniform1f("u_keepUpright",H?1:0);S.setUniform1f("u_level",10*q);S.setUniform1i("u_texture",d.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
S.setUniform1f("u_size",M);S.setUniform1f("u_antialiasingWidth",u);S.setUniform1f("u_opacity",1);S.setUniform1f("u_fadeDuration",n.FADE_DURATION/1E3);g&&S.setUniform4fv("u_id",e);f=function(b){if(!b.layerData[G])return"continue";J=b.layerData[G];if(0===J.glyphPerPageElementsMap.size)return"continue";J.prepareForRendering(p,R);J.updateOpacityInfo();var a=J.textVertexArrayObject;if(k.isNone(a))return"continue";p.bindVAO(a);S.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);p.setStencilTestEnabled(!0);
p.setStencilFunction(516,255,255);p.setStencilWriteMask(0);a=(performance.now()-J.lastOpacityUpdate)/1E3;S.setUniform1f("u_time",a);J.glyphPerPageElementsMap.forEach(function(a,c){l._renderGlyphRange(p,a,c,v,S,N[3],Q,O,T,b)})};for(e=0;e<m.length;e++)a=m[e],f(a)}};m.prototype._renderGlyphRange=function(b,a,c,f,m,e,q,h,r,k){f.bind(b,9729,c,d.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<e&&0<q&&(m.setUniform4fv("u_color",this._haloColor),m.setUniform1f("u_halo",1),m.setUniform1f("u_edgeDistance",r),m.setUniform1f("u_edgeBlur",
h),b.drawElements(4,a[1],5125,Uint32Array.BYTES_PER_ELEMENT*a[0]),k.triangleCount+=a[1]/3);0<this._sdfColor[3]&&(m.setUniform4fv("u_color",this._sdfColor),m.setUniform1f("u_halo",0),m.setUniform1f("u_edgeDistance",0),m.setUniform1f("u_edgeBlur",0),b.drawElements(4,a[1],5125,Uint32Array.BYTES_PER_ELEMENT*a[0]),k.triangleCount+=a[1]/3)};return m}(u.default);a.WGLBrushVTLSymbol=g})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,
"__esModule",{value:!0});a.FADE_DURATION=a.DECLUTTER_BUDGET=a.COLLISION_GRID_CELL_SIZE=a.DECLUTTER_TILES=void 0;a.DECLUTTER_TILES=!0;a.COLLISION_GRID_CELL_SIZE=32;a.DECLUTTER_BUDGET=1.5;a.FADE_DURATION=200})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(g,a){function e(a,f){a%=f;return 0<=a?a:a+f}Object.defineProperty(a,"__esModule",{value:!0});a.between=a.interpolate=a.sqr=a.log2=a.degToByte=a.radToByte=a.positiveMod=a.C_SQRT2_INV=a.C_SQRT2=a.C_DEG_TO_RAD=
a.C_DEG_TO_256=a.C_256_TO_RAD=a.C_RAD_TO_256=a.C_PI_BY_2=a.C_2PI=a.C_PI=a.C_INFINITY=void 0;a.C_INFINITY=Number.POSITIVE_INFINITY;a.C_PI=Math.PI;a.C_2PI=2*a.C_PI;a.C_PI_BY_2=a.C_PI/2;a.C_RAD_TO_256=128/a.C_PI;a.C_256_TO_RAD=a.C_PI/128;a.C_DEG_TO_256=256/360;a.C_DEG_TO_RAD=a.C_PI/180;a.C_SQRT2=1.414213562;a.C_SQRT2_INV=1/a.C_SQRT2;var k=1/Math.LN2;a.positiveMod=e;a.radToByte=function(h){return e(h*a.C_RAD_TO_256,256)};a.degToByte=function(h){return e(h*a.C_DEG_TO_256,256)};a.log2=function(a){return Math.log(a)*
k};a.sqr=function(a){return a*a};a.interpolate=function(a,f,e){return a*(1-e)+f*e};a.between=function(a,f,e){return a>=f&&a<=e||a>=e&&a<=f}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports tslib ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,a,e,k,h,f,n,d,b,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(b){function a(){var a=null!==b&&
b.apply(this,arguments)||this;a._dotTextureSize=0;a._dotTextures=null;a._dotSamplers=new Int32Array([f.TEXTURE_BINDING_RENDERER_0,f.TEXTURE_BINDING_RENDERER_1]);return a}e.__extends(a,b);a.prototype.dispose=function(){this._disposeTextures()};a.prototype.getGeometryType=function(){return n.WGLGeometryType.FILL};a.prototype.drawGeometry=function(b,a,m,q,l){var h=b.context,p=b.painter,r=b.rendererInfo,k=b.requiredLevel,n=m.indexCount,g=m.indexFrom;m=c.FillMaterialKey.load(m.materialKey);var v=d.createProgramDescriptor(m.data,
{geometry:e.__spreadArrays([{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}],m.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],m.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),t=v.bufferLayouts,v=v.attributes;l=p.materialManager.getMaterialProgram(b,
m,"materials/fill",v,l);q=this._getVAO(h,t,v,q);h.bindProgram(l);h.bindVAO(q);this._setSharedUniforms(l,b,a);m.textureBinding&&(p.textureManager.bindTextures(h,l,m),p=1/Math.pow(2,k-a.key.level)/b.pixelRatio,l.setUniform1f("u_zoomFactor",p));m.vvColor&&(l.setUniform1fv("u_vvColorValues",r.vvColorValues),l.setUniform4fv("u_vvColors",r.vvColors));m.vvOpacity&&(l.setUniform1fv("u_vvOpacityValues",r.vvOpacityValues),l.setUniform1fv("u_vvOpacities",r.vvOpacities));m.dotDensity&&(m=f.TILE_SIZE/r.ddDotSize,
q=m*window.devicePixelRatio*m*window.devicePixelRatio,p=1/Math.pow(2,k-a.key.level),a=1/p*(1/p),b=r.ddDotScale?b.state.scale/r.ddDotScale:1,l.setUniform1f("u_tileZoomFactor",p),l.setUniform1f("u_tileDotsOverArea",q/(f.TILE_SIZE*window.devicePixelRatio*f.TILE_SIZE*window.devicePixelRatio)),l.setUniformMatrix4fv("u_dotColors",r.ddColors),l.setUniform4fv("u_isActive",r.ddActiveDots),l.setUniform4fv("u_dotBackgroundColor",r.ddBackgroundColor),l.setUniform1f("u_dotValue",Math.max(1,r.ddDotValue*b*a)),
this._bindDotDensityTextures(h,l,r,m));h.drawElements(4,n,5125,Uint32Array.BYTES_PER_ELEMENT*g);h.bindVAO(null)};a.prototype._disposeTextures=function(){if(this._dotTextures){for(var b=0;b<this._dotTextures.length;b++)this._dotTextures[b].dispose();this._dotTextures=null}};a.prototype._bindDotDensityTextures=function(b,a,c,d){c=this._createDotDensityTextures(b,d,c.ddSeed);a.setUniform1iv("u_dotTextures",this._dotSamplers);for(a=0;a<c.length;a++)b.bindTexture(c[a],this._dotSamplers[a])};a.prototype._createDotDensityTextures=
function(b,a,c){if(this._dotTextureSize!==a||this._seed!==c)this._disposeTextures(),this._dotTextureSize=a,this._seed=c;null===this._dotTextures&&(c=new k(c),this._dotTextures=[this._allocDotDensityTexture(b,a,c),this._allocDotDensityTexture(b,a,c)]);return this._dotTextures};a.prototype._allocDotDensityTexture=function(b,a,c){for(var d=new Float32Array(a*a*4),f=0;f<d.length;f++)d[f]=c.getFloat();return new h.Texture(b,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:a,height:a},
d)};return a}(b.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports tslib ../../../../webgl ../definitions ./WGLBrush".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}e.__extends(d,a);d.prototype.prepareState=function(b,a,d){b=b.context;d=d&&-1!==d.indexOf("id");b.setBlendingEnabled(!d);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,
!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,a.stencilRef,255)};d.prototype.draw=function(b,a,d){var c=this;a.commitChanges(b);if(a.visible){var f=this.getGeometryType(),e=a.getDisplayList(),m=a.getGeometry(f);m&&e&&(b.timeline.begin(this.name),e.byType(f,function(f){c.drawGeometry(b,a,f,m,d)}),b.timeline.end(this.name))}};d.prototype._getVAO=function(b,a,d,f){f.vao||(f.vao=new k.VertexArrayObject(b,d,a,f.vertexBufferMap,f.indexBuffer));return f.vao};d.prototype._setSharedUniforms=
function(b,a,d){b.setUniform1f("u_pixelRatio",a.pixelRatio);b.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);b.setUniformMatrix3fv("u_displayViewMat3",a.state.displayViewMat3);b.setUniformMatrix4fv("u_insideEffectMat4",a.rendererInfo.insideEffect);b.setUniformMatrix4fv("u_outsideEffectMat4",a.rendererInfo.outsideEffect);b.setUniform1fv("u_insideOpacities",a.rendererInfo.insideOpacities);b.setUniform1fv("u_outsideOpacities",a.rendererInfo.outsideOpacities);b.setUniform1i("u_attributeTextureSize",
a.attributeView.size);b.setUniform1i("u_attributeData0",h.TEXTURE_BINDING_ATTRIBUTE_DATA_0);b.setUniform1i("u_attributeData1",h.TEXTURE_BINDING_ATTRIBUTE_DATA_1);b.setUniform1i("u_attributeData2",h.TEXTURE_BINDING_ATTRIBUTE_DATA_2);b.setUniform1i("u_attributeData3",h.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return d}(f.default);a.default=g})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports tslib ../../../../../core/Error ../enums ../mesh/templates/meshUtils".split(" "),
function(g,a,e,k,h,f){function n(b,a){void 0===a&&(a=!1);var c=h.WGLVVFlag.SIZE_FIELD_STOPS|h.WGLVVFlag.SIZE_MINMAX_VALUE|h.WGLVVFlag.SIZE_SCALE_STOPS|h.WGLVVFlag.SIZE_UNIT_VALUE;b=(b&(h.WGLVVTarget.FIELD_TARGETS_OUTLINE|h.WGLVVTarget.MINMAX_TARGETS_OUTLINE|h.WGLVVTarget.SCALE_TARGETS_OUTLINE|h.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return a?c&b:c&~b}function d(b){var a=n(b,!1);return b&(h.WGLVVFlag.COLOR|h.WGLVVFlag.OPACITY|h.WGLVVFlag.ROTATION|a)}Object.defineProperty(a,"__esModule",{value:!0});
a.LabelMaterialKey=a.TextMaterialKey=a.LineMaterialKey=a.MarkerMaterialKey=a.FillMaterialKey=a.MaterialKeyBase=a.hydrateMaterialKey=a.createMaterialKey=a.getLabelVVFlags=a.getTextVVFlags=a.getLineVVFlags=a.getFillVVFlags=a.getMarkerVVFlags=a.getSizeFlagsMask=void 0;a.getSizeFlagsMask=n;a.getMarkerVVFlags=d;a.getFillVVFlags=function(b){return b&(h.WGLVVFlag.COLOR|h.WGLVVFlag.OPACITY)};a.getLineVVFlags=function(b,a){if(a)return a=n(b,!0),b&a;a=n(b,!1);return b&(h.WGLVVFlag.COLOR|h.WGLVVFlag.OPACITY|
a)};a.getTextVVFlags=function(b){return d(b)};a.getLabelVVFlags=function(b){var a=n(b,!1);return b&a};a.createMaterialKey=function(b,a,c,d,f){switch(b){case h.WGLGeometryType.FILL:return t.from(a,d);case h.WGLGeometryType.LINE:return m.from(a,c);case h.WGLGeometryType.MARKER:return r.from(a);case h.WGLGeometryType.TEXT:return v.from(a);case h.WGLGeometryType.LABEL:return l.from(a,f);default:throw Error("Unable to createMaterialKey for unknown geometryType "+b);}};a.hydrateMaterialKey=function(a){switch(b.load(a).geometryType){case h.WGLGeometryType.MARKER:return new r(a);
case h.WGLGeometryType.FILL:return new t(a);case h.WGLGeometryType.LINE:return new m(a);case h.WGLGeometryType.TEXT:return new v(a);case h.WGLGeometryType.LABEL:return new l(a)}};var b=function(){function b(b){this._data=0;this._data=b}b.load=function(b){var a=this.shared;a.data=b;return a};Object.defineProperty(b.prototype,"data",{get:function(){return this._data},set:function(b){this._data=b},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"geometryType",{get:function(){return this.bits(8,
11)},set:function(b){this.setBits(b,8,11)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"mapAligned",{get:function(){return!!this.bit(20)},set:function(b){this.setBit(20,b)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"sdf",{get:function(){return!!this.bit(11)},set:function(b){this.setBit(11,b)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"pattern",{get:function(){return!!this.bit(12)},set:function(b){this.setBit(12,b)},enumerable:!1,
configurable:!0});Object.defineProperty(b.prototype,"textureBinding",{get:function(){return this.bits(0,8)},set:function(b){this.setBits(b,0,8)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"geometryTypeString",{get:function(){switch(this.geometryType){case h.WGLGeometryType.FILL:return"fill";case h.WGLGeometryType.MARKER:return"marker";case h.WGLGeometryType.LINE:return"line";case h.WGLGeometryType.TEXT:return"text";case h.WGLGeometryType.LABEL:return"label";default:throw new k("Unable to handle unknown geometryType: "+
this.geometryType);}},enumerable:!1,configurable:!0});b.prototype.setBit=function(b,a){b=1<<b;this._data=a?this._data|b:this._data&~b};b.prototype.bit=function(b){return(this._data&1<<b)>>b};b.prototype.setBits=function(b,a,c){for(var d=0;a<c;a++,d++)this.setBit(a,0!==(b&1<<d))};b.prototype.bits=function(b,a){for(var c=0,d=0;b<a;b++,d++)c|=this.bit(b)<<d;return c};b.prototype.hasVV=function(){return!1};b.prototype.setVV=function(b,a){};b.prototype.getVariation=function(){return{mapAligned:this.mapAligned,
pattern:this.pattern,sdf:this.sdf}};b.prototype.getVariationHash=function(){return this._data&~(7&this.textureBinding)};b.shared=new b(0);return b}();a.MaterialKeyBase=b;g=function(b){return function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);Object.defineProperty(a.prototype,"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(16)},set:function(b){this.setBit(16,b)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"vvSizeScaleStops",{get:function(){return 0!==
this.bit(17)},set:function(b){this.setBit(17,b)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"vvSizeFieldStops",{get:function(){return 0!==this.bit(18)},set:function(b){this.setBit(18,b)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"vvSizeUnitValue",{get:function(){return 0!==this.bit(19)},set:function(b){this.setBit(19,b)},enumerable:!1,configurable:!0});a.prototype.hasVV=function(){return b.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||
this.vvSizeFieldStops||this.vvSizeUnitValue};a.prototype.setVV=function(a,c){b.prototype.setVV.call(this,a,c);a&=n(a,c);this.vvSizeMinMaxValue=!!(a&h.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(a&h.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(a&h.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(a&h.WGLVVFlag.SIZE_SCALE_STOPS)};return a}(b)};var c=function(b){return function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);Object.defineProperty(a.prototype,
"vvRotation",{get:function(){return 0!==this.bit(15)},set:function(b){this.setBit(15,b)},enumerable:!1,configurable:!0});a.prototype.hasVV=function(){return b.prototype.hasVV.call(this)||this.vvRotation};a.prototype.setVV=function(a,c){b.prototype.setVV.call(this,a,c);this.vvRotation=!c&&!!(a&h.WGLVVFlag.ROTATION)};return a}(b)},q=function(b){return function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);Object.defineProperty(a.prototype,"vvColor",{get:function(){return 0!==
this.bit(13)},set:function(b){this.setBit(13,b)},enumerable:!1,configurable:!0});a.prototype.hasVV=function(){return b.prototype.hasVV.call(this)||this.vvColor};a.prototype.setVV=function(a,c){b.prototype.setVV.call(this,a,c);this.vvColor=!c&&!!(a&h.WGLVVFlag.COLOR)};return a}(b)},u=function(b){return function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);Object.defineProperty(a.prototype,"vvOpacity",{get:function(){return 0!==this.bit(14)},set:function(b){this.setBit(14,
b)},enumerable:!1,configurable:!0});a.prototype.hasVV=function(){return b.prototype.hasVV.call(this)||this.vvOpacity};a.prototype.setVV=function(a,c){b.prototype.setVV.call(this,a,c);this.vvOpacity=!c&&!!(a&h.WGLVVFlag.OPACITY)};return a}(b)},t=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);a.load=function(b){var a=this.shared;a.data=b;return a};a.from=function(b,a){var c=this.load(0);c.geometryType=h.WGLGeometryType.FILL;a?c.dotDensity=!0:c.setVV(b,!1);return c.data};
a.prototype.getVariation=function(){return e.__assign(e.__assign({},b.prototype.getVariation.call(this)),{dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity})};Object.defineProperty(a.prototype,"dotDensity",{get:function(){return!!this.bit(15)},set:function(b){this.setBit(15,b)},enumerable:!1,configurable:!0});a.shared=new a(0);return a}(q(u(b)));a.FillMaterialKey=t;var r=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);a.load=function(b){var a=
this.shared;a.data=b;return a};a.from=function(b){var a=this.load(0);a.geometryType=h.WGLGeometryType.MARKER;a.setVV(b,!1);return a.data};a.prototype.getVariation=function(){return e.__assign(e.__assign({},b.prototype.getVariation.call(this)),{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};a.shared=new a(0);return a}(q(u(c(g(b)))));
a.MarkerMaterialKey=r;var m=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);a.load=function(b){var a=this.shared;a.data=b;return a};a.from=function(b,a){var c=this.load(0);c.geometryType=h.WGLGeometryType.LINE;c.setVV(b,a);return c.data};a.prototype.getVariation=function(){return e.__assign(e.__assign({},b.prototype.getVariation.call(this)),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,
vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};a.shared=new a(0);return a}(q(u(g(b))));a.LineMaterialKey=m;var v=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);a.load=function(b){var a=this.shared;a.data=b;return a};a.from=function(b){var a=this.load(b);a.geometryType=h.WGLGeometryType.TEXT;a.setVV(b,!1);return a.data};a.prototype.getVariation=function(){return e.__assign(e.__assign({},b.prototype.getVariation.call(this)),{vvColor:this.vvColor,
vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};a.shared=new a(0);return a}(q(u(c(g(b)))));a.TextMaterialKey=v;var l=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}e.__extends(a,b);a.load=function(b){var a=this.shared;a.data=b;return a};a.from=function(b,a){var c=this.load(0);c.geometryType=h.WGLGeometryType.LABEL;
c.setVV(b,!1);c.mapAligned=!!f.isMapAligned(a);return c.data};a.prototype.getVariation=function(){return e.__assign(e.__assign({},b.prototype.getVariation.call(this)),{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})};a.shared=new a(0);return a}(g(b));a.LabelMaterialKey=l})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,
"__esModule",{value:!0});a.isMapAligned=void 0;a.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,
a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return k.WGLGeometryType.LABEL};b.prototype.drawGeometry=function(b,a,d,f,e){var c=b.context,q=b.painter,l=b.state,k=b.rendererInfo,p=d.indexCount,r=d.indexFrom;d=n.LabelMaterialKey.load(d.materialKey);var g=d.mapAligned?1:0;if(g||!(1<=Math.abs(a.key.level-Math.round(100*b.displayLevel)/100))){var t=h.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},
{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",count:2,type:5123}]}),u=t.bufferLayouts,t=t.attributes;e=q.materialManager.getMaterialProgram(b,d,"materials/label",t,e);f=this._getVAO(c,
u,t,f);b.context.setStencilFunction(514,0,255);c.bindProgram(e);c.bindVAO(f);this._setSharedUniforms(e,b,a);q.textureManager.bindTextures(c,e,d);q=1===g?l.displayViewMat3:l.displayMat3;d.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",k.vvSizeMinMaxValue);d.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",k.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(a=k.getSizeVVFieldStops(a.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",a.values),e.setUniform1fv("u_vvSizeFieldStopsSizes",
a.sizes));d.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",k.vvSizeUnitValueToPixelsRatio);e.setUniform1f("u_mapRotation",Math.floor(l.rotation/360*254));e.setUniform1f("u_mapAligned",g);e.setUniformMatrix3fv("u_displayMat3",q);e.setUniform1f("u_opacity",1);e.setUniform1f("u_zoomLevel",Math.round(10*b.displayLevel));e.setUniform2fv("u_screenSize",b.state.size);e.setUniform1f("u_isHalo",1);c.drawElements(4,p,5125,Uint32Array.BYTES_PER_ELEMENT*r);e.setUniform1f("u_isHalo",0);
c.drawElements(4,p,5125,Uint32Array.BYTES_PER_ELEMENT*r);c.bindVAO(null);c.setStencilTestEnabled(!0);c.setBlendingEnabled(!0)}};return b}(f.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);
b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return k.WGLGeometryType.LINE};b.prototype.drawGeometry=function(b,a,d,f,e){var c=b.context,q=b.painter,l=b.rendererInfo,k=b.requiredLevel,p=d.indexFrom,r=d.indexCount;d=n.LineMaterialKey.load(d.materialKey);var g=h.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",
count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),t=g.bufferLayouts,g=g.attributes;e=q.materialManager.getMaterialProgram(b,d,"materials/line",g,e);f=this._getVAO(c,t,g,f);t=1/b.pixelRatio;c.bindProgram(e);c.bindVAO(f);this._setSharedUniforms(e,b,a);d.textureBinding&&q.textureManager.bindTextures(c,e,d);e.setUniform1f("u_zoomFactor",
Math.pow(2,k-a.key.level)/b.pixelRatio);e.setUniform1f("u_blur",0+t);e.setUniform1f("u_antialiasing",t);d.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);d.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(b=l.getSizeVVFieldStops(a.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",b.values),e.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",
l.vvSizeUnitValueToPixelsRatio);d.vvColor&&(e.setUniform1fv("u_vvColorValues",l.vvColorValues),e.setUniform4fv("u_vvColors",l.vvColors));d.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),e.setUniform1fv("u_vvOpacities",l.vvOpacities));c.setFaceCullingEnabled(!0);c.setFrontFace(2305);c.setCullFace(1029);c.drawElements(4,r,5125,Uint32Array.BYTES_PER_ELEMENT*p);c.setFaceCullingEnabled(!1);c.bindVAO(null)};return b}(f.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return k.WGLGeometryType.MARKER};b.prototype.drawGeometry=function(b,a,d,f,e){var c=b.context,q=b.painter,l=b.rendererInfo,k=b.state,p=d.indexCount,r=d.indexFrom;d=n.MarkerMaterialKey.load(d.materialKey);var g=h.createProgramDescriptor(d.data,{geometry:[{location:0,
name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),t=g.bufferLayouts,g=g.attributes;e=q.materialManager.getMaterialProgram(b,
d,"materials/icon",g,e);f=this._getVAO(c,t,g,f);c.bindProgram(e);c.bindVAO(f);d.textureBinding&&q.textureManager.bindTextures(c,e,d);this._setSharedUniforms(e,b,a);e.setUniformMatrix3fv("u_displayMat3",d.vvRotation?k.displayViewMat3:k.displayMat3);d.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);d.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(b=l.getSizeVVFieldStops(a.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",
b.values),e.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);d.vvColor&&(e.setUniform1fv("u_vvColorValues",l.vvColorValues),e.setUniform4fv("u_vvColors",l.vvColors));d.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),e.setUniform1fv("u_vvOpacities",l.vvOpacities));d.vvRotation&&e.setUniform1f("u_vvRotationType","geographic"===l.vvMaterialParameters.vvRotationType?0:1);c.drawElements(4,
p,5125,Uint32Array.BYTES_PER_ELEMENT*r);c.bindVAO(null)};return b}(f.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports tslib ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return k.WGLGeometryType.TEXT};
b.prototype.drawGeometry=function(b,a,d,f,e){var c=b.context,q=b.painter,l=b.rendererInfo,k=b.state,p=d.indexCount,r=d.indexFrom;d=n.TextMaterialKey.load(d.materialKey);var g=h.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",
count:4,type:5120},{location:6,name:"a_vertexOffset",count:2,type:5122},{location:7,name:"a_texCoords",count:2,type:5123}]}),t=g.bufferLayouts,g=g.attributes;e=q.materialManager.getMaterialProgram(b,d,"materials/text",g,e);f=this._getVAO(c,t,g,f);c.bindProgram(e);c.bindVAO(f);this._setSharedUniforms(e,b,a);q.textureManager.bindTextures(c,e,d);e.setUniformMatrix3fv("u_displayMat3",k.displayMat3);e.setUniformMatrix3fv("u_displayViewMat3",k.displayViewMat3);d.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",
l.vvSizeMinMaxValue);d.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(b=l.getSizeVVFieldStops(a.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",b.values),e.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));d.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);d.vvColor&&(e.setUniform1fv("u_vvColorValues",l.vvColorValues),e.setUniform4fv("u_vvColors",l.vvColors));d.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",
l.vvOpacityValues),e.setUniform1fv("u_vvOpacities",l.vvOpacities));d.vvRotation&&e.setUniform1f("u_vvRotationType","geographic"===l.vvMaterialParameters.vvRotationType?0:1);e.setUniform1f("u_isHalo",1);c.drawElements(4,p,5125,Uint32Array.BYTES_PER_ELEMENT*r);e.setUniform1f("u_isHalo",0);c.drawElements(4,p,5125,Uint32Array.BYTES_PER_ELEMENT*r);c.bindVAO(null)};return b}(f.default);a.default=g})},"esri/views/2d/engine/webgl/brushes/raster/BrushRasterBitmap":function(){define("require exports tslib ../../VertexStream ../WGLBrush ../../../../../webgl/rasterUtils".split(" "),
function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:{a_position:0,a_texcoord:1}},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:{a_position:0,a_texcoord:1}}};b._rendererUniformInfos=new Map;return b}e.__extends(d,a);d.prototype.dispose=
function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(b,a){b=b.context;b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,a.stencilRef,255)};d.prototype.draw=function(b,a){if(a.source&&!a.suspended){b.timeline.begin(this.name);a.updateTexture(b);var c=this.getShaderVariations(a),c=b.painter.materialManager.getProgram(b,this._desc[a.symbolizerParameters.type],
c);this.drawWithProgram(b.context,c,a);b.timeline.end(this.name)}};d.prototype.drawWithProgram=function(b,a,d,h,n,r){void 0===h&&(h=1);void 0===n&&(n=[0,0]);void 0===r&&(r=!1);this._quad||(this._quad=new k(b,[0,0,1,0,0,1,1,1]));var c=d.symbolizerParameters,q=d.transformGrid,l=d.width,g=d.height,p=d.opacity,t=c.type;b.bindProgram(a);var u=this.getShaderVariations(d),t=this.getUniformInfos(t,b,a,u),u=d.getTextures();f.setTextures(b,a,u.names,u.textures);b=f.getBasicGridUniforms(h,n);r=f.getCommonUniforms(q,
[l,g],[d.source.width,d.source.height],p,r);f.setUniforms(a,t,e.__assign(e.__assign({u_coordScale:d.coordScale,u_dvsMat3:d.transforms.dvs},b),r));c.colormap&&(d=f.getColormapUniforms(c.colormap,c.colormapOffset),f.setUniforms(a,t,d));"stretch"===c.type?(c=f.getStretchUniforms(c),f.setUniforms(a,t,c)):"hillshade"===c.type&&(c=f.getShadedReliefUniforms(c),f.setUniforms(a,t,c));this._quad.draw()};d.prototype.getUniformInfos=function(b,a,d,e){b=0<e.length?b+"-"+e.join("-"):b;if(this._rendererUniformInfos.has(b))return this._rendererUniformInfos.get(b);
a=f.getUniformLocationInfos(a,d);this._rendererUniformInfos.set(b,a);return a};d.prototype.getShaderVariations=function(b){var a=[];"cubic"===b.interpolation&&a.push("bicubic");b.symbolizerParameters.colormap&&a.push("applyColormap");b.transformGrid&&a.push("applyProjection");return a};return d}(h.default);a.default=g})},"esri/views/webgl/rasterUtils":function(){define(["require","exports","../webgl"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.setTextures=a.setUniforms=a.getUniformLocationInfos=
a.getShadedReliefUniforms=a.getStretchUniforms=a.getBasicGridUniforms=a.getColormapUniforms=a.getCommonUniforms=a.createColormapTexture=a.createTransformTexture=a.createFrameBuffer=a.createRasterTexture=void 0;a.createRasterTexture=function(a,h,f,n){void 0===f&&(f="nearest");void 0===n&&(n=!1);var d=!(n&&"u8"===h.pixelType);n=d?5126:5121;d=null==h.pixels||0===h.pixels.length?null:d?h.getAsRGBAFloat():h.getAsRGBA();return new e.Texture(a,{width:h.width,height:h.height,target:3553,pixelFormat:6408,
internalFormat:6408,samplingMode:"bilinear"===f||"cubic"===f?9729:9728,dataType:n,wrapMode:33071,flipped:!1},d)};a.createFrameBuffer=function(a,h,f,n){n=new e.Texture(a,{width:h,height:f,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:n?5121:5126,wrapMode:33071,flipped:!1});return new e.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:h,height:f},n)};a.createTransformTexture=function(a,h){for(var f=4*h.size[0],k=h.size[1],d={width:f,height:k,target:3553,pixelFormat:6408,
internalFormat:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1},f=new Float32Array(f*k*4),b=k=0;b<h.coefficients.length;b++)f[k++]=h.coefficients[b],2===b%3&&(f[k++]=1);return new e.Texture(a,d,f)};a.createColormapTexture=function(a,h){return new e.Texture(a,{width:h.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},h)};a.getCommonUniforms=function(a,e,f,n,d,b){void 0===n&&(n=1);void 0===d&&(d=!0);void 0===
b&&(b=!1);return{u_flipY:d,u_isFloatTexture:b,u_applyTransform:a?!0:!1,u_opacity:n,u_transformSpacing:a?a.spacing:null,u_transformGridSize:a?a.size:null,u_targetImageSize:e,u_srcImageSize:f}};a.getColormapUniforms=function(a,e){return{u_colormapOffset:e||0,u_colormapMaxIndex:a?a.length/4-1:null}};a.getBasicGridUniforms=function(a,e){return{u_scale:a,u_offset:e}};a.getStretchUniforms=function(a){return{u_bandCount:a.bandCount,u_minOutput:a.outMin,u_maxOutput:a.outMax,u_minCutOff:a.minCutOff,u_maxCutOff:a.maxCutOff,
u_factor:a.factor,u_useGamma:a.useGamma,u_gamma:a.gamma,u_gammaCorrection:a.gammaCorrection}};a.getShadedReliefUniforms=function(a){return{u_hillshadeType:a.hillshadeType,u_sinZcosAs:a.sinZcosAs,u_sinZsinAs:a.sinZsinAs,u_cosZs:a.cosZs,u_weights:a.weights,u_factor:a.factor,u_minValue:a.minValue,u_maxValue:a.maxValue}};a.getUniformLocationInfos=function(a,e){a=a.gl;e=e.glName;for(var f=a.getProgramParameter(e,a.ACTIVE_UNIFORMS),h=new Map,d,b=0;b<f;b++)(d=a.getActiveUniform(e,b))&&h.set(d.name,{location:a.getUniformLocation(e,
d.name),info:d});return h};a.setUniforms=function(a,e,f){Object.keys(f).forEach(function(h){var d=e.get(h)||e.get(h+"[0]");if(d){var b=f[h];if(null!==d&&null!=b)switch(d=d.info,d.type){case 5126:1<d.size?a.setUniform1fv(h,b):a.setUniform1f(h,b);break;case 35664:a.setUniform2fv(h,b);break;case 35665:a.setUniform3fv(h,b);break;case 35666:a.setUniform4fv(h,b);break;case 35675:a.setUniformMatrix3fv(h,b);break;case 35676:a.setUniformMatrix4fv(h,b);break;case 5124:1<d.size?a.setUniform1iv(h,b):a.setUniform1i(h,
b);break;case 35670:a.setUniform1i(h,b?1:0);break;case 35667:case 35671:a.setUniform2iv(h,b);break;case 35668:case 35672:a.setUniform3iv(h,b);break;case 35669:case 35673:a.setUniform4iv(h,b)}}})};a.setTextures=function(a,e,f,g){f.length===g.length&&(g.some(function(a){return null==a})||f.some(function(a){return null==a})||f.forEach(function(d,b){e.setUniform1i(d,b);a.bindTexture(g[b],b)}))}})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl",
"./Programs"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this._cache=Array(8);for(var f=0;8>f;f++)this._cache[f]={};this._programRepo=new e.ProgramCache(a)}a.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};a.prototype.getProgram=function(a,e,d){var b=this._cache[a];b[e]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),d),b[e]=a);return b[e]};a.prototype.getProgramAttributes=function(a){switch(a){case 0:return k.background.attributes;
case 5:return k.circle.attributes;case 1:return k.fill.attributes;case 4:return k.icon.attributes;case 3:return k.line.attributes;case 2:return k.outline.attributes;case 6:return k.text.attributes;default:return null}};a.prototype._getProgramTemplate=function(a){switch(a){case 0:return k.background;case 5:return k.circle;case 1:return k.fill;case 4:return k.icon;case 3:return k.line;case 2:return k.outline;case 6:return k.text;default:return null}};return a}();a.default=g})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require",
"exports","../../../webgl","./shaders/BitBlitPrograms"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.BitBlitRenderer=void 0;g=function(){function a(){this._initialized=!1}a.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.render=function(a,e,d,b){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),
a.bindProgram(this._program),e.setSamplingMode(d),a.bindTexture(e,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",b),a.drawArrays(5,0,4),a.bindTexture(null,0),a.bindVAO())};a.prototype._initialize=function(a){if(this._initialized)return!0;var f=k.bitBlit.attributes,d=e.createProgram(a,k.bitBlit);if(!d)return!1;var b=new Int8Array(16);b[0]=-1;b[1]=-1;b[2]=0;b[3]=0;b[4]=1;b[5]=-1;b[6]=1;b[7]=0;b[8]=-1;b[9]=1;b[10]=0;b[11]=1;b[12]=1;b[13]=1;b[14]=1;b[15]=1;a=new e.VertexArrayObject(a,
f,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:e.BufferObject.createVertex(a,35044,b)});this._program=d;this._vertexArrayObject=a;return this._initialized=!0};return a}();a.BitBlitRenderer=g})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});
a.bitBlit=void 0;a.bitBlit={name:"bitBlit",shaders:{vertexShader:e.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:e.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports tslib ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(g,a,e,k,h,f,n){var d=function(b){return b===f.WGLDrawPhase.HITTEST||b===f.WGLDrawPhase.LABEL_ALPHA},b=function(b,a,h,g){g=g.reduce(function(a,
c){var d;return e.__assign(e.__assign({},a),(d={},d[c]=b.driverTestResult[c],d))},{});a=e.__assign(e.__assign(e.__assign(e.__assign({},a.getVariation()),b.rendererInfo.getVariation()),{highlight:b.drawPhase===f.WGLDrawPhase.HIGHLIGHT,id:d(b.drawPhase)}),g);if(k.isSome(h))for(g=0;g<h.length;g++)a[h[g]]=!0;return a};return function(){function a(b){this._programByKey=new Map;this._programCache=new h.ProgramCache(b)}a.prototype.dispose=function(){this._programCache&&this._programCache.dispose()};a.prototype.getProgram=
function(b,a,c,d){void 0===c&&(c=[]);void 0===d&&(d=[]);var f=a.vsPath+"."+a.fsPath+JSON.stringify(c)+d.join(".");if(this._programByKey.has(f))return this._programByKey.get(f);d=d.reduce(function(a,c){var d;return e.__assign(e.__assign({},a),(d={},d[c]=b.driverTestResult[c],d))},{});c=e.__assign(e.__assign({},c.map(function(b){return"string"===typeof b?{name:b,value:!0}:b}).reduce(function(b,a){var c;return e.__assign(e.__assign({},b),(c={},c[a.name]=a.value,c))},{})),d);a=this._programCache.getProgram(n.createProgramTemplate(a.vsPath,
a.fsPath,a.attributes),c);if(!a)throw Error("Unable to get program for key: ${key}");this._programByKey.set(f,a);return a};a.prototype.getMaterialProgram=function(a,c,e,h,m,g){void 0===g&&(g=["ignoresSamplerPrecision"]);var l,q=g;l=a.rendererInfo;var p=a.drawPhase,q=c.getVariationHash()+"-"+q.join(".")+"-",p=(d(p)?1:0)|(p===f.WGLDrawPhase.HIGHLIGHT?2:0);l=q+p+"-"+l.getVariationHash()+"-"+(k.isSome(m)&&m.join("."));if(this._programByKey.has(l))return this._programByKey.get(l);a=b(a,c,m,g);e=this._programCache.getProgram(n.createProgramTemplate(e,
e,h),a);if(!e)throw Error("Unable to get program for key: ${key}");this._programByKey.set(l,e);return e};return a}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.createProgramTemplate=void 0;var h=function(a){var f={},d;for(d in a){for(var b=d,c=void 0,c=""+b[0].toUpperCase(),h=1;h<b.length;h++){var k=b[h];k===k.toUpperCase()?(c+="_",c+=
k):c+=k.toUpperCase()}f[c]=a[d]}return e.glslifyDefineMap(f)};a.createProgramTemplate=function(a,e,d){var b=a+a.substring(a.lastIndexOf("/")),c=e+e.substring(e.lastIndexOf("/"));return{name:name,attributes:d,shaders:function(a){return{vertexShader:h(a)+k.resolveIncludes(b+".vert"),fragmentShader:h(a)+k.resolveIncludes(c+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports tslib ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/BidiText ./util/Result ./util/symbolUtils".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l,w,p,y,z,C,B,E,x){function A(b){switch(b.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===b.style||"esriSFSNull"===b.style;case "esriSLS":return"esriSLSSolid"===b.style||"esriSLSNull"===b.style;default:return!1}}function F(b){switch(b.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}function I(b){return e.__awaiter(this,
void 0,void 0,function(){var a,c;return e.__generator(this,function(d){switch(d.label){case 0:a=window.URL.createObjectURL(b),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,h(a,{responseType:"image"})];case 2:return c=d.sent().data,window.URL.revokeObjectURL(a),[2,c];case 3:return d.sent(),window.URL.revokeObjectURL(a),[2,new f("mapview-invalid-resource","Could not fetch requested resource at "+a)];case 4:return[2]}})})}function G(a,c){return e.__awaiter(this,void 0,void 0,function(){var d,m,l,
q,p,k,g,r,n;return e.__generator(this,function(v){switch(v.label){case 0:d=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;if(-1===d.indexOf(";base64,"))return[3,1];l=d.indexOf(";base64,")+8;q=d.substring(l);p=atob(q);k=new Uint8Array(p.length);for(g=0;g<p.length;g++)k[g]=p.charCodeAt(g);m=k.buffer;return[3,4];case 1:return v.trys.push([1,3,,4]),[4,h(d,e.__assign({responseType:"array-buffer"},c))];case 2:return m=r=v.sent().data,[3,4];case 3:return n=v.sent(),b.isAbortError(n)?[3,4]:
[2,new f("mapview-invalid-resource","Could not fetch requested resource at "+d)];case 4:return[2,m]}})})}var J=u.vec2f32.create(),H=n.getLogger("esri.views.2d.engine.webgl.TextureManager"),M=function(){function b(b,a,c){this.mosaicType=b;this.page=a;this.sdf=c}b.fromMosaic=function(a,c){return new b(a,c.page,c.sdf)};return b}();return function(){function a(b){this._invalidFontsMap=new Map;this._sdfConverter=new p.default(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=
new t.default;this._spriteMosaic=new y(b,2048,2048,500);this._glyphSource=new w(k.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new l(1024,1024,this._glyphSource)}a.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._rasterizer=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null};Object.defineProperty(a.prototype,
"sprites",{get:function(){return this._spriteMosaic},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!1,configurable:!0});a.prototype.rasterizeItem=function(b,a,c,l){return e.__awaiter(this,void 0,void 0,function(){var h,q,p,k=this;return e.__generator(this,function(e){switch(e.label){case 0:if(d.isNone(b))return H.error(new f("mapview-null-resource","Unable to rasterize null resource",void 0)),[2,null];h=b.type;switch(h){case "CIMTextSymbol":return[3,
1];case "esriTS":return[3,1]}return[3,3];case 1:return[4,this._rasterizeText(b,c,l)];case 2:return q=e.sent(),q.forEach(function(b){return k._setTextureBinding(m.MosaicType.GLYPH,b)}),[2,{glyphMosaicItems:q}];case 3:return b.type&&-1!==b.type.toLowerCase().indexOf("3d")?(H.error(new f("mapview-invalid-type","MapView does not support symbol type: "+b.type,b)),[2,null]):[4,this._rasterizeSpriteSymbol(b,a,l)];case 4:return p=e.sent(),E.ok(p)&&p&&this._setTextureBinding(m.MosaicType.SPRITE,p),[2,{spriteMosaicItem:p}]}})})};
a.prototype.bindTextures=function(b,a,c){if(0!==c.textureBinding){var d=this._bindingInfos[c.textureBinding-1];c=d.page;switch(d.mosaicType){case m.MosaicType.SPRITE:var d=this.sprites.getWidth(c),f=this.sprites.getHeight(c),d=q.vec2.set(J,d,f);this._spriteMosaic.bind(b,9729,c,r.TEXTURE_BINDING_SPRITE_ATLAS);a.setUniform1i("u_texture",r.TEXTURE_BINDING_SPRITE_ATLAS);a.setUniform2fv("u_mosaicSize",d);break;case m.MosaicType.GLYPH:d=this.glyphs.width;f=this.glyphs.height;d=q.vec2.set(J,d,f);this._glyphMosaic.bind(b,
9729,c,r.TEXTURE_BINDING_GLYPH_ATLAS);a.setUniform1i("u_texture",r.TEXTURE_BINDING_GLYPH_ATLAS);a.setUniform2fv("u_mosaicSize",d);break;default:H.error("mapview-texture-manager","Cannot handle unknown type "+d.mosaicType)}}};a.prototype._hashMosaic=function(b,a){return 1|b<<1|(a.sdf?1:0)<<2|a.page<<3};a.prototype._setTextureBinding=function(b,a){var c=this._hashMosaic(b,a);this._hashToBindingIndex.has(c)||(b=M.fromMosaic(b,a),this._hashToBindingIndex.set(c,this._bindingInfos.length+1),this._bindingInfos.push(b));
a.textureBinding=this._hashToBindingIndex.get(c)};a.prototype._rasterizeText=function(b,a,c){return e.__awaiter(this,void 0,void 0,function(){var d,m,l;return e.__generator(this,function(e){switch(e.label){case 0:d=v.getFullyQualifiedFontName(b.font);m=this._invalidFontsMap.has(d);var h;if(a)h=a;else{h=B.bidiText(b.text)[0];for(var q=[],p=0;p<h.length;p++)q.push(h.charCodeAt(p));h=q}l=h;e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._glyphMosaic.getGlyphItems(m?"arial-unicode-ms-regular":d,
l,c)];case 2:return[2,e.sent()];case 3:return e.sent(),H.error(new f("mapview-invalid-resource","Couldn't find font "+d+". Falling back to Arial Unicode MS Regular",void 0)),this._invalidFontsMap.set(d,!0),[2,this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",l,c)];case 4:return[2]}})})};a.prototype._rasterizeSpriteSymbol=function(b,a,c){return e.__awaiter(this,void 0,void 0,function(){var d,m,l,h,q,p;return e.__generator(this,function(e){if(A(b))return[2,null];d=x.keyFromSymbol(b);return this._spriteMosaic.has(d)?
[2,this._spriteMosaic.getSpriteItem(d)]:"esriSMS"===b.type&&b.path?[2,this._handleSVG(b,d,c)]:b.url||b.imageData?[2,this._handleImage(b,d,c)]:(m=this._rasterizer.rasterizeJSONResource(b,a))?(l=m.size,h=m.image,q=m.sdf,p=m.simplePattern,[2,this._addItemToMosaic(d,l,{type:"static",data:h},F(b),q,p)]):[2,new f("TextureManager","unrecognized or null rasterized image")]})})};a.prototype._handleSVG=function(b,a,c){return e.__awaiter(this,void 0,void 0,function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:return d=
[126,126],[4,this._sdfConverter.draw(b.path,c)];case 1:return f=e.sent(),[2,this._addItemToMosaic(a,d,{type:"static",data:new Uint32Array(f.buffer)},!1,!0,!0)]}})})};a.prototype._handleGIFOrPNG=function(a,c,d){return e.__awaiter(this,void 0,void 0,function(){var m,l,h,q,p,k,g,r,n,v,t,w;return e.__generator(this,function(e){switch(e.label){case 0:return[4,G(a,d)];case 1:m=e.sent();if(!E.ok(m))return[3,10];l=C.isGIF(m);h=z.isPNG(m);if(!l&&!h)return[2,new f("mapview-invalid-resource","Image data is neither GIF nor PNG!")];
q=void 0;e.label=2;case 2:return e.trys.push([2,7,,8]),l&&C.isAnimatedGIF(m)?[4,C.default.create(m,d)]:[3,4];case 3:return q=e.sent(),[3,6];case 4:return h&&z.isAnimatedPNG(m)?[4,z.default.create(m,d)]:[3,6];case 5:q=e.sent(),e.label=6;case 6:return[3,8];case 7:return p=e.sent(),b.isAbortError(p)?[3,8]:[2,new f("mapview-invalid-resource","Could not fetch requested resource!")];case 8:if(q&&E.ok(q))return[2,this._addItemToMosaic(c,[q.width,q.height],{type:"animated",data:q},F(a),!1,!1)];k=l?"image/gif":
"image/png";g=new Blob([m],{type:k});return[4,I(g)];case 9:if((r=e.sent())&&r instanceof HTMLImageElement)return n=this._rasterizer.rasterizeImageResource(r,a.colorSubstitutions),v=n.size,t=n.sdf,w=n.image,[2,this._addItemToMosaic(c,v,{type:"static",data:w},F(a),t,!1)];e.label=10;case 10:return[2,new f("mapview-invalid-resource","Could not handle resource!")]}})})};a.prototype._handleImage=function(a,d,m){return e.__awaiter(this,void 0,void 0,function(){var l,q,p,k,g,r,n;return e.__generator(this,
function(v){switch(v.label){case 0:var t;(t=a.url&&-1!==a.url.indexOf(".gif")||a.contentType&&"image/gif"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/gif"))||(t=a.url&&-1!==a.url.indexOf(".png")||a.contentType&&"image/png"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/png"));if(t)return[2,this._handleGIFOrPNG(a,d,m)];l=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;v.label=1;case 1:return v.trys.push([1,3,,4]),[4,h(l,e.__assign({responseType:"image"},
m))];case 2:return q=v.sent().data,-1!==l.indexOf("data:image/svg+xml")&&(q.width=c.pt2px(a.width),q.height=c.pt2px(a.height)),p=this._rasterizer.rasterizeImageResource(q,a.colorSubstitutions),k=p.size,g=p.sdf,r=p.image,[2,this._addItemToMosaic(d,k,{type:"static",data:r},F(a),g,!1)];case 3:return n=v.sent(),b.isAbortError(n)?[3,4]:[2,new f("mapview-invalid-resource","Could not fetch requested resource at "+l)];case 4:return[2,void 0]}})})};a.prototype._addItemToMosaic=function(b,a,c,d,f,e){return this._spriteMosaic.addSpriteItem(b,
a,c,d,f,e)};return a}()})},"esri/symbols/cim/Rasterizer":function(){define("require exports ./CIMSymbolHelper ./Rect ./SDFHelper ./utils".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};a.prototype.rasterizeJSONResource=function(a,b,c){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return c=
e.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style,b),{size:[c[1],c[2]],image:new Uint32Array(c[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return c=e.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[c[1],c[2]],image:new Uint32Array(c[0].buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var d,f;"simple-marker"===a.type||"esriSMS"===a.type||"line-marker"===a.type?(a=e.CIMSymbolHelper.fromSimpleMarker(a),f=h.getSDFInfo(a)):
"CIMHatchFill"===a.type?(a=e.CIMSymbolHelper.fromCIMHatchFill(a),d=new k.default(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):a.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===a.markerPlacement.type?(a=e.CIMSymbolHelper.fromCIMInsidePolygon(a),d=new k.default(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):f=h.getSDFInfo(a);if(f&&!c)return c=h.buildSDF(f),(d=c[0])?{size:[c[1],c[2]],image:new Uint32Array(d.buffer),sdf:!0,simplePattern:!0,
anchorX:0,anchorY:0}:null;c=e.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,d,!c);d=c[0];f=c[3];a=c[4];return d?{size:[c[1],c[2]],image:new Uint32Array(d.buffer),sdf:!1,simplePattern:!1,anchorX:f,anchorY:a}:null};a.prototype.rasterizeImageResource=function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var c=this._rasterizationCanvas.getContext("2d");a instanceof
ImageData?c.putImageData(a,0,0):(a.setAttribute("width",a.width.toString()),a.setAttribute("height",a.height.toString()),c.drawImage(a,0,0,a.width,a.height));c=c.getImageData(0,0,a.width,a.height);c=new Uint8Array(c.data);if(b)for(var d=0;d<b.length;d++){var e=b[d];if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){var h=e.oldColor,k=h[0],m=h[1],g=h[2],h=h[3],l=e.newColor,e=l[0],n=l[1],p=l[2],y=l[3];if(k!==e||m!==n||g!==p||h!==y)for(l=0;l<c.length;l+=4)k===c[l]&&m===c[l+1]&&
g===c[l+2]&&h===c[l+3]&&(c[l]=e,c[l+1]=n,c[l+2]=p,c[l+3]=y)}}for(l=0;l<c.length;l+=4)b=c[l+3]/255,c[l]*=b,c[l+1]*=b,c[l+2]*=b;b=a.width;d=a.height;k=c;if(512<=b||512<=d)k=a.width/a.height,1<k?(b=512,d=Math.round(512/k)):(d=512,b=Math.round(512*k)),k=new Uint8Array(4*b*d),f.resampleHermite(c,a.width,a.height,new Uint8ClampedArray(k.buffer),b,d,!1);return{size:[b,d],image:new Uint32Array(k.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();a.default=g})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports tslib ../../Color ../../core/Logger ../../core/mathUtils ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),
function(g,a,e,k,h,f,n,d,b){function c(b,a){switch(a.type){case "CIMSymbolReference":var c={type:"point",x:0,y:0};b.drawSymbol(a.symbol,c);break;case "CIMPointSymbol":c={type:"point",x:0,y:0};b.drawSymbol(a,c);break;case "CIMVectorMarker":c=new n.Placement,b.drawMarker(a,c)}return b.envelope()}Object.defineProperty(a,"__esModule",{value:!0});a.OverrideHelper=a.SymbolHelper=a.CIMSymbolHelper=void 0;var q=Math.PI,u=q/2,t=h.getLogger("esri.symbols.cim.CIMSymbolHelper");g=function(){function b(){}b.getEnvelope=
function(b){var a=new d.EnvDrawHelper;if(Array.isArray(b)){for(var f=void 0,e=0;e<b.length;e++){var m=b[e];f?f.union(c(a,m)):f=c(a,m)}return f}return c(a,b)};b.getTextureAnchor=function(b){b=this.getEnvelope(b);if(!b||0>=b.width||0>=b.height)return[0,0,0];var a=96/72,c=b.height*a+2;return[(b.x+.5*b.width)*a/(b.width*a+2),-(b.y+.5*b.height)*a/c,c]};b.rasterize=function(b,a,c,f){void 0===f&&(f=!0);var e=c||this.getEnvelope(a);if(!e||0>=e.width||0>=e.height)return[null,0,0,0,0];var m=96/72,l=(e.x+.5*
e.width)*m,h=(e.y+.5*e.height)*m;b.width=e.width*m;b.height=e.height*m;c||(b.width+=2,b.height+=2);c=b.getContext("2d");m=d.Transformation.createScale(m,-m);m.translate(.5*b.width-l,.5*b.height+h);m=new d.CanvasDrawHelper(c,m);switch(a.type){case "CIMPointSymbol":m.drawSymbol(a,{type:"point",x:0,y:0});break;case "CIMVectorMarker":e=new n.Placement,m.drawMarker(a,e)}a=c.getImageData(0,0,b.width,b.height);a=new Uint8Array(a.data);if(f)for(f=void 0,c=0;c<a.length;c+=4)f=a[c+3]/255,a[c]*=f,a[c+1]*=f,
a[c+2]*=f;return[a,b.width,b.height,-l/b.width,-h/b.height]};b.fromSimpleMarker=function(b){var a,c,d=b.style;if("circle"===d||"esriSMSCircle"===d){a=Math.acos(.995);c=Math.ceil(q/a/4);0===c&&(c=1);a=u/c;c*=4;d=[];d.push([50,0]);for(var f=1;f<c;f++)d.push([50*Math.cos(f*a),-50*Math.sin(f*a)]);d.push([50,0]);a={rings:[d]};c={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===d||"esriSMSCross"===d)a=0,a={rings:[[[a,50],[a,a],[50,a],[50,-a],[a,-a],[a,-50],[-a,-50],[-a,-a],[-50,-a],[-50,a],[-a,a],[-a,
50],[a,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===d||"esriSMSDiamond"===d)a={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===d||"esriSMSSquare"===d)a={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===d||"esriSMSX"===d)a=0,a={rings:[[[0,a],[50-a,50],[50,50-a],[a,0],[50,a-50],[50-a,-50],[0,-a],[a-50,-50],[-50,a-50],[-a,0],[-50,50-a],[a-50,50],[0,a]]]},c={xmin:-50,
ymin:-50,xmax:50,ymax:50};else if("triangle"===d||"esriSMSTriangle"===d)c=2/3*100,d=c-100,a={rings:[[[-57.735026918962575,d],[0,c],[57.735026918962575,d],[-57.735026918962575,d]]]},c={xmin:-57.735026918962575,ymin:d,xmax:57.735026918962575,ymax:c};else if("arrow"===d||"esriSMSArrow"===d)a={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};var e;a&&c&&(e=[{type:"CIMSolidFill",enable:!0,color:b.color}],b.outline&&e.push({type:"CIMSolidStroke",enable:!0,
width:b.outline.width,color:b.outline.color}),e={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:b.angle,size:b.size,offsetX:b.xoffset,offsetY:b.yoffset,frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:a,symbol:{type:"CIMPolygonSymbol",symbolLayers:e}}]}]});return e};b.fromCIMHatchFill=function(b){for(var a=void 0!==b.separation?b.separation:4,c=a/2,d=this._getLineSymbolPeriod(b.lineSymbol)||4;4>d;)d*=2;d/=2;return{type:"CIMVectorMarker",frame:{xmin:-d,xmax:d,
ymin:-c,ymax:c},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-d,0],[d,0]]]},symbol:b.lineSymbol}],size:a}};b._getLineSymbolPeriod=function(b){if(b){var a=this._getEffectsRepeat(b.effects);if(a)return a;if(b.symbolLayers)for(a=0,b=b.symbolLayers;a<b.length;a++){var c=b[a],d=this._getEffectsRepeat(c.effects);if(d)return d;if(c&&(c=this._getPlacementRepeat(c.markerPlacement)))return c}}return 0};b._getEffectsRepeat=function(b){if(b)for(var a=0;a<b.length;a++){var c=b[a];if(c)switch(c.type){case "CIMGeometricEffectDashes":if((c=
c.dashTemplate)&&c.length){for(var a=b=0,d=c;a<d.length;a++)b+=d[a];c.length&1&&(b*=2);return b}break;case "CIMGeometricEffectWave":return c.period;default:t.error("unsupported geometric effect type "+c.type)}}return 0};b._getPlacementRepeat=function(b){if(b)switch(b.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((b=b.placementTemplate)&&b.length){for(var a=0,c=0;c<b.length;c++)a+=b[c];b.length&1&&(a*=
2);return a}}return 0};b.fromCIMInsidePolygon=function(b){var a=b.markerPlacement,c=a.stepX/2,d=a.stepY/2,c={xmin:-c,xmax:c,ymin:-d,ymax:d};b=e.__assign({type:b.type},b);b.markerPlacement=null;b.anchorPoint=null;return{type:"CIMVectorMarker",frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",symbolLayers:[b]}}],size:a.stepY}};b.getFillColor=function(a){if(!a)return null;switch(a.type){case "CIMPolygonSymbol":if(a.symbolLayers){var c=0;for(a=a.symbolLayers;c<
a.length;c++){var d=b.getFillColor(a[c]);if(null!=d)return d}}break;case "CIMTextSymbol":return b.getFillColor(a.symbol);case "CIMSolidFill":return a.color}};b.getStrokeColor=function(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers){var c=0;for(a=a.symbolLayers;c<a.length;c++){var d=b.getStrokeColor(a[c]);if(void 0!==d)return d}}break;case "CIMTextSymbol":return b.getStrokeColor(a.symbol);case "CIMSolidStroke":return a.color}};b.getStrokeWidth=function(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers){var c=
0;for(a=a.symbolLayers;c<a.length;c++){var d=b.getStrokeWidth(a[c]);if(void 0!==d)return d}}break;case "CIMTextSymbol":return b.getStrokeWidth(a.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return a.width}};b.getSize=function(a){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var c=0;if(a.symbolLayers){var d=0;for(a=a.symbolLayers;d<a.length;d++){var f=b.getSize(a[d]);f>c&&(c=f)}}return c;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return a.width;
case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return a.size}};b.getMarkerScaleRatio=function(b){if(b)switch(b.type){case "CIMVectorMarker":if(!1!==b.scaleSymbolsProportionally&&b.frame)return b.size/(b.frame.ymax-b.frame.ymin)}return 1};return b}();a.CIMSymbolHelper=g;g=function(){function a(){}a.rasterizeSimpleFill=function(b,a,c){"solid"!==a&&"none"!==a&&"esriSFSSolid"!==a&&"esriSFSNull"!==a||console.error("Unexpected: style does not require rasterization");c=f.nextPowerOfTwo(Math.ceil(c));
var d=16*c,e=2*c;b.width=d;b.height=d;var m=b.getContext("2d");m.strokeStyle="#FFFFFF";m.lineWidth=c;m.beginPath();if("vertical"===a||"cross"===a||"esriSFSCross"===a||"esriSFSVertical"===a)m.moveTo(d/2,-e),m.lineTo(d/2,d+e);if("horizontal"===a||"cross"===a||"esriSFSCross"===a||"esriSFSHorizontal"===a)m.moveTo(-e,d/2),m.lineTo(d+e,d/2);if("forward-diagonal"===a||"diagonal-cross"===a||"esriSFSDiagonalCross"===a||"esriSFSForwardDiagonal"===a)m.moveTo(-e,-e),m.lineTo(d+e,d+e),m.moveTo(d-e,-e),m.lineTo(d+
e,e),m.moveTo(-e,d-e),m.lineTo(e,d+e);if("backward-diagonal"===a||"diagonal-cross"===a||"esriSFSBackwardDiagonal"===a||"esriSFSDiagonalCross"===a)m.moveTo(d+e,-e),m.lineTo(-e,d+e),m.moveTo(e,-e),m.lineTo(-e,e),m.moveTo(d+e,d-e),m.lineTo(d-e,d+e);m.stroke();a=m.getImageData(0,0,b.width,b.height);a=new Uint8Array(a.data);for(d=0;d<a.length;d+=4)c=a[d+3]/255,a[d]*=c,a[d+1]*=c,a[d+2]*=c;return[a,b.width,b.height]};a.rasterizeSimpleLine=function(b,a){switch(a){case "butt":a="Butt";break;case "square":a=
"Square";break;default:a="Round"}var c="Butt"===a;switch(b){case "dash":case "esriSLSDash":b=c?[4,3]:[3,4];break;case "dash-dot":case "esriSLSDashDot":b=c?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":b=c?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":b=c?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":b=c?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":b=c?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":b=
c?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":b=c?[4,1,1,1]:[3,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":b=c?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":b=c?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":t.error("Unexpected: style does not require rasterization");b=[0,0];break;default:t.error("Tried to rasterize SLS, but found an unexpected style: "+b+"!"),b=[0,0]}return this.rasterizeDash(b,a)};a.rasterizeDash=
function(a,c){var d="Butt"===c,f="Square"===c;c=!d&&!f;for(var e=0,m=0;m<a.length;m++)var h=a[m],e=e+h;for(var e=15*e,q=31*e,m=new Float32Array(q),k=c?225:15,h=0;h<q;++h)m[h]=k;for(var k=q=0,g=!0,r=0;r<a.length;r++){for(var h=a[r],q=k,k=k+15*h,n=q;n<k;){for(var t=0;31>t;){var h=t*e+n,v=c?(t-15)*(t-15):Math.abs(t-15);m[h]=g?d?Math.max(Math.max(q+7.5-n,v),Math.max(n-k+7.5,v)):v:c?Math.min((n-q)*(n-q)+v,(n-k)*(n-k)+v):f?Math.min(Math.max(n-q,v),Math.max(k-n,v)):Math.min(Math.max(n-q+7.5,v),Math.max(k+
7.5-n,v));t++}n++}g=!g}a=m.length;d=new Uint8Array(4*a);for(h=0;h<a;++h)b.packFloatRGBA((c?Math.sqrt(m[h]):m[h])/15,d,4*h);return[d,e,31]};return a}();a.SymbolHelper=g;g=function(){function b(){}b.findApplicableOverrides=function(a,c,d){if(c){if(a.primitiveName){for(var f=!1,e=0;e<d.length;e++){var m=d[e];if(m.primitiveName===a.primitiveName){f=!0;break}}if(!f)for(f=0;f<c.length;f++)m=c[f],m.primitiveName===a.primitiveName&&d.push(m)}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(f=
0,e=a.effects;f<e.length;f++)m=e[f],b.findApplicableOverrides(m,c,d);if(a.symbolLayers)for(m=0,a=a.symbolLayers;m<a.length;m++)b.findApplicableOverrides(a[m],c,d);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(a.effects)for(f=0,e=a.effects;f<e.length;f++)m=e[f],b.findApplicableOverrides(m,c,d);a.markerPlacement&&
b.findApplicableOverrides(a.markerPlacement,c,d);if("CIMVectorMarker"===a.type){if(a.markerGraphics)for(m=0,a=a.markerGraphics;m<a.length;m++)f=a[m],b.findApplicableOverrides(f,c,d),b.findApplicableOverrides(f.symbol,c,d)}else"CIMCharacterMarker"===a.type?b.findApplicableOverrides(a.symbol,c,d):"CIMHatchFill"===a.type&&b.findApplicableOverrides(a.lineSymbol,c,d)}}};b.applyOverrides=function(a,c,d,f){if(c){if(a.primitiveName)for(var e=0;e<c.length;e++){var m=c[e];if(m.primitiveName===a.primitiveName){var h;
h=(h=m.propertyName)?h.charAt(0).toLowerCase()+h.substr(1):h;f&&f.push({cim:a,nocapPropertyName:h,value:a[h]});m.expression&&(m.value=b.toValue(m.propertyName,m.expression));if(d){for(var q=!1,l=0,k=d;l<k.length;l++)k[l].primitiveName===a.primitiveName&&(q=!0);q||d.push(m)}a[h]=m.value}}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(m=0,h=a.effects;m<h.length;m++)e=h[m],b.applyOverrides(e,c,d,f);if(a.symbolLayers)for(e=0,a=a.symbolLayers;e<a.length;e++)b.applyOverrides(a[e],
c,d,f);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(a.effects)for(m=0,h=a.effects;m<h.length;m++)e=h[m],b.applyOverrides(e,c,d,f);if("CIMVectorMarker"===a.type&&a.markerGraphics)for(e=0,a=a.markerGraphics;e<a.length;e++)m=a[e],b.applyOverrides(m,c,d,f),b.applyOverrides(m.symbol,c,d,f)}}};b.restoreOverrides=function(b){for(var a=0;a<b.length;a++){var c=b[a];c.cim[c.nocapPropertyName]=c.value}};b.buildOverrideKey=function(b){for(var a="",c=0;c<b.length;c++){var d=b[c];void 0!==
d.value&&(a+=""+d.primitiveName+d.propertyName+JSON.stringify(d.value))}return a};b.toValue=function(b,a){return"DashTemplate"===b?a.split(" ").map(function(b){return Number(b)}):"Color"===b?(b=(new k(a)).toRgba(),b[3]*=255,b):a};return b}();a.OverrideHelper=g})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.EmptyPlacementCursor=a.Placement=void 0;g=function(){function a(){this.setIdentity()}a.prototype.getAngle=
function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,e){this.tx=a;this.ty=e};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,e){this.rz=void 0;this.rz_c=a;this.rz_s=e};a.prototype.setRotate=function(a){this.rz=a;this.rz_s=this.rz_c=void 0};
a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=a};return a}();a.Placement=g;g=function(){function a(){}a.prototype.next=function(){return null};return a}();a.EmptyPlacementCursor=g})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("require exports tslib ../../core/Logger ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./Rect".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q){Object.defineProperty(a,"__esModule",{value:!0});a.CanvasDrawHelper=a.EnvDrawHelper=a.CIMSymbolDrawHelper=a.Transformation=a.C_DEG_TO_RAD=void 0;a.C_DEG_TO_RAD=Math.PI/180;var u=k.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),t=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var b=this._t;return[b[0]*a[0]+b[1]*a[1]+b[2],b[3]*
a[0]+b[4]*a[1]+b[5]]};a.createScale=function(b,c){return new a([b,0,0,0,c,0])};a.prototype.scale=function(a,b){var c=this._t;c[0]*=a;c[1]*=a;c[2]*=a;c[3]*=b;c[4]*=b;c[5]*=b;return this};a.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(b,c){return new a([0,0,b,0,0,c])};a.prototype.translate=function(a,b){var c=this._t;c[2]+=a;c[5]+=b;return this};a.createRotate=function(b){var c=Math.cos(b);b=Math.sin(b);return new a([c,-b,
0,b,c,0])};a.prototype.rotate=function(b){return this.multiply(a.createRotate(b))};a.prototype.multiply=function(a){var b=this._t;a=a._t;var c=b[1]*a[0]+b[4]*a[1],d=b[2]*a[0]+b[5]*a[1]+a[2],f=b[0]*a[3]+b[3]*a[4],e=b[1]*a[3]+b[4]*a[4],h=b[2]*a[3]+b[5]*a[4]+a[5];b[0]=b[0]*a[0]+b[3]*a[1];b[1]=c;b[2]=d;b[3]=f;b[4]=e;b[5]=h;return this};return a}();a.Transformation=t;g=function(){function e(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||t.createIdentity());this._sizeTransfos.push(a?
a.scaleRatio():1)}e.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};e.prototype.transformSize=function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};e.prototype.back=function(){return this._transfos[this._transfos.length-1]};e.prototype.push=function(a,b){b=b?a.scaleRatio():1;a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)};e.prototype.pop=function(){this._transfos.splice(-1,
1);this._sizeTransfos.splice(-1,1)};e.prototype.drawSymbol=function(a,b){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,b)}};e.prototype.drawMultiLayerSymbol=function(a,b){if(a){var c=a.symbolLayers;if(c)if(a=a.effects){if(b=this.executeEffects(a,b))for(a=b.next();a;)this.drawSymbolLayers(c,a),a=b.next()}else this.drawSymbolLayers(c,b)}};e.prototype.executeEffects=function(a,c){c=new d.SimpleGeometryCursor(c);for(var f=0;f<a.length;f++){var e=
a[f],h=b.getEffectOperator(e);h&&(c=h.execute(c,e,1))}return c};e.prototype.drawSymbolLayers=function(a,b){for(var c=a.length;c--;){var d=a[c];if(d&&!1!==d.enable){var f=d.effects;if(f){if(f=this.executeEffects(f,b))for(var e=f.next();e;)this.drawSymbolLayer(d,e),e=f.next()}else this.drawSymbolLayer(d,b)}}};e.prototype.drawSymbolLayer=function(a,b){switch(a.type){case "CIMSolidFill":this.drawSolidFill(b,a.color);break;case "CIMHatchFill":this.drawHatchFill(a,b);break;case "CIMSolidStroke":this.drawSolidStroke(b,
a.color,a.width,a.capStyle,a.joinStyle,a.miterLimit);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(a,b)}};e.prototype.drawHatchFill=function(a,b){var c=this._buildHatchPolyline(a,b,1);c&&(this.pushClipPath(b),this.drawMultiLayerSymbol(a.lineSymbol,c),this.popClipPath())};e.prototype.drawMarkerLayer=function(a,d){var f=a.markerPlacement;if(f){var e=b.getPlacementOperator(f);if(e){var h="CIMMarkerPlacementInsidePolygon"===f.type;h&&this.pushClipPath(d);
if(d=e.execute(d,f,1))for(f=d.next();f;)this.drawMarker(a,f),f=d.next();h&&this.popClipPath()}}else h=new c.Placement,h.tx=d.x,h.ty=d.y,this.drawMarker(a,h)};e.prototype.drawMarker=function(a,b){switch(a.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(a,b);break;case "CIMVectorMarker":this.drawVectorMarker(a,b)}};e.prototype.drawPictureMarker=function(a,b){};e.prototype.drawVectorMarker=function(b,c){if(b){var d=b.markerGraphics;if(d){var f=b.size,e=b.frame,h=e?e.ymax-
e.ymin:0,f=f&&h?f/h:1,h=t.createIdentity();e&&h.translate(.5*-(e.xmax+e.xmin),.5*-(e.ymax+e.ymin));var q=b.anchorPoint;if(q){var m=q.x,q=q.y;"Absolute"!==b.anchorPointUnits&&e&&(m*=e.xmax-e.xmin,q*=e.ymax-e.ymin);h.translate(-m,-q)}1!==f&&h.scale(f,f);b.rotation&&h.rotate(b.rotation*a.C_DEG_TO_RAD);h.translate(b.offsetX||0,b.offsetY||0);h.translate(c.tx,c.ty);this.push(h,b.scaleSymbolsProportionally);for(b=0;b<d.length;b++)(c=d[b])&&c.symbol&&c.geometry||u.error("Invalid marker graphic",c),this.drawSymbol(c.symbol,
c.geometry);this.pop()}}};e.prototype._buildHatchPolyline=function(b,c,d){var e=(void 0!==b.separation?b.separation:4)*d,q=void 0!==b.rotation?b.rotation:0;if(0===e)return null;0>e&&(e=-e);for(var m=0,l=.5*e;m>l;)m-=e;for(;m<-l;)m+=e;m=h.create();f.getBoundsXY(m,c);m[0]-=l;m[1]-=l;m[2]+=l;m[3]+=l;for(var k=[[m[0],m[1]],[m[0],m[3]],[m[2],m[3]],[m[2],m[1]]];180<q;)q-=180;for(;0>q;)q+=180;var l=Math.cos(q*a.C_DEG_TO_RAD),g=Math.sin(q*a.C_DEG_TO_RAD),q=-e*g;c=e*l;var m=(void 0!==b.offsetX?b.offsetX*d:
0)*g-(void 0!==b.offsetY?b.offsetY*d:0)*l,n,r;n=b=Number.MAX_VALUE;r=d=-Number.MAX_VALUE;for(var t=0;t<k.length;t++){var u=k[t],v=u[0],G=u[1],u=l*v+g*G,v=-g*v+l*G;n=Math.min(n,u);b=Math.min(b,v);r=Math.max(r,u);d=Math.max(d,v)}b=Math.floor(b/e)*e;k=l*n-g*b-q*m/e;n=g*n+l*b-c*m/e;t=l*r-g*b-q*m/e;m=g*r+l*b-c*m/e;e=1+Math.round((d-b)/e);l=[];for(g=0;g<e;g++)k+=q,n+=c,t+=q,m+=c,l.push([[k,n],[t,m]]);return{paths:l}};return e}();a.CIMSymbolDrawHelper=g;k=function(a){function b(){var b=a.call(this)||this;
b.reset();return b}e.__extends(b,a);b.prototype.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};b.prototype.envelope=function(){return new q.default(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};b.prototype.drawSolidFill=function(b){!b||0<this._clipCount||(n.isPolygon(b)?this._processPath(b.rings,0):n.isPolyline(b)&&this._processPath(b.paths,0))};b.prototype.drawSolidStroke=function(b,a,c){!b||0<this._clipCount||(a=.5*this.transformSize(c),
n.isPolygon(b)?this._processPath(b.rings,a):n.isPolyline(b)&&this._processPath(b.paths,a))};b.prototype.pushClipPath=function(b){this.drawSolidFill(b);++this._clipCount};b.prototype.popClipPath=function(){--this._clipCount};b.prototype._processPath=function(b,a){if(b)for(var c=0;c<b.length;c++){var d=b[c],f=d?d.length:0;if(1<f){this._merge(this.transformPt(d[0]),a);for(var e=1;e<f;++e)this._merge(this.transformPt(d[e]),a)}}};b.prototype._merge=function(b,a){b[0]-a<this._xmin&&(this._xmin=b[0]-a);
b[0]+a>this._xmax&&(this._xmax=b[0]+a);b[1]-a<this._ymin&&(this._ymin=b[1]-a);b[1]+a>this._ymax&&(this._ymax=b[1]+a)};return b}(g);a.EnvDrawHelper=k;g=function(b){function a(a,c){c=b.call(this,c)||this;c._ctx=a;return c}e.__extends(a,b);a.prototype.drawSolidFill=function(b,a){if(b){if(n.isPolygon(b))this._buildPath(b.rings,!0);else if(n.isPolyline(b))this._buildPath(b.paths,!0);else return;b=this._ctx;b.fillStyle="string"===typeof a?a:"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+
","+a[3]/255+")";b.fill("evenodd")}};a.prototype.drawSolidStroke=function(b,a,c,d,f,e){if(b&&a&&0!==c){if(n.isPolygon(b))this._buildPath(b.rings,!0);else if(n.isPolyline(b))this._buildPath(b.paths,!1);else return;b=this._ctx;b.strokeStyle="string"===typeof a?a:"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+","+a[3]/255+")";b.lineWidth=this.transformSize(c)+.5;this._setCapStyle(d);this._setJoinStyle(f);b.miterLimit=e;b.stroke()}};a.prototype.pushClipPath=function(b){this._ctx.save();
n.isPolygon(b)?this._buildPath(b.rings,!0):n.isPolyline(b)&&this._buildPath(b.paths,!0);this._ctx.clip("evenodd")};a.prototype.popClipPath=function(){this._ctx.restore()};a.prototype._buildPath=function(b,a){var c=this._ctx;c.beginPath();if(b)for(var d=0;d<b.length;d++){var f=b[d],e=f?f.length:0;if(1<e){var h=this.transformPt(f[0]);c.moveTo(h[0],h[1]);for(var q=1;q<e;++q)h=this.transformPt(f[q]),c.lineTo(h[0],h[1]);a&&c.closePath()}}};a.prototype._setCapStyle=function(b){switch(b){case "Butt":this._ctx.lineCap=
"butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};a.prototype._setJoinStyle=function(b){switch(b){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin="round";break;case "Miter":this._ctx.lineJoin="miter"}};return a}(g);a.CanvasDrawHelper=g})},"esri/symbols/cim/CIMEffects":function(){define(["require","exports","../../core/lang"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.clone=a.SimpleGeometryCursor=
void 0;g=function(){function a(a){this._geometry=a}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a};return a}();a.SimpleGeometryCursor=g;a.clone=function(a){return e.clone(a)}})},"esri/symbols/cim/CIMOperators":function(){define("require exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l,w,p,y,z,C){Object.defineProperty(a,"__esModule",{value:!0});a.getPlacementOperator=a.getEffectOperator=void 0;a.getEffectOperator=function(a){if(!a)return null;switch(a.type){case "CIMGeometricEffectAddControlPoints":return e.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return k.EffectArrow.local();case "CIMGeometricEffectBuffer":return h.EffectBuffer.local();case "CIMGeometricEffectCut":return f.EffectCut.local();case "CIMGeometricEffectDashes":return n.EffectDashes.local();
case "CIMGeometricEffectDonut":return d.EffectDonut.local();case "CIMGeometricEffectJog":return b.EffectJog.local();case "CIMGeometricEffectMove":return c.EffectMove.local();case "CIMGeometricEffectOffset":return q.EffectOffset.local();case "CIMGeometricEffectReverse":return u.EffectReverse.local();case "CIMGeometricEffectRotate":return t.EffectRotate.local();case "CIMGeometricEffectScale":return r.EffectScale.local();case "CIMGeometricEffectWave":return m.EffectWave.local()}return null};a.getPlacementOperator=
function(b){if(!b)return null;switch(b.type){case "CIMMarkerPlacementAlongLineSameSize":return v.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return l.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return w.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return p.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return y.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return z.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return C.PlacementPolygonCenter.local()}return null}})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectAddControlPoints=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,
b,c)};a.instance=null;return a}();a.EffectAddControlPoints=g;var f=function(){function a(a,b,c){this._inputGeometries=a;this._angleTolerance=void 0!==b.angleTolerance?b.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(k.isPolygon(a))return this._isClosed=!0,a=e.clone(a),this._processMultipath(a.rings),a;if(k.isPolyline(a))return this._isClosed=!1,a=e.clone(a),this._processMultipath(a.paths),
a;if(k.isExtent(a)){if(this._maxCosAngle)return a;this._isClosed=!0;a=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];this._processPath(a);return{rings:[a]}}a=this._inputGeometries.next()}return null};a.prototype._processMultipath=function(a){if(a)for(var b=0;b<a.length;b++)this._processPath(a[b])};a.prototype._processPath=function(a){if(a){var b=a.length,c=a[0],d=void 0,f=void 0,e=void 0,k=void 0,m=void 0,g=void 0;this._isClosed&&++b;for(var l=1;l<b;++l){var n=void 0,
n=this._isClosed&&l===b-1?a[0]:a[l],p=n[0]-c[0],y=n[1]-c[1],z=Math.sqrt(p*p+y*y);1<l&&0<z&&0<e&&(d*p+f*y)/z/e<=this._maxCosAngle&&h.setId(c,1);1===l&&(k=p,m=y,g=z);0<z&&(c=n,d=p,f=y,e=z)}this._isClosed&&0<e&&0<g&&(d*k+f*m)/g/e<=this._maxCosAngle&&h.setId(a[0],1)}};return a}()})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(g,a,e,k,h){function f(a){if(a)for(var b=a.length-1;0<b;--b)a[b][0]-=a[b-
1][0],a[b][1]-=a[b-1][1]}function n(a){if(a)for(var b=0;b<a.length;b++)f(a[b])}function d(a){if(a)for(var b=a.length,c=1;c<b;++c)a[c][0]+=a[c-1][0],a[c][1]+=a[c-1][1]}function b(a){if(a)for(var b=0;b<a.length;b++)d(a[b])}function c(a){a&&(k.isPolygon(a)?b(a.rings):k.isPolyline(a)?b(a.paths):k.isMultipoint(a)&&d(a.points))}function q(a){a&&a.reverse()}function u(a){return{rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}Object.defineProperty(a,"__esModule",
{value:!0});a.PathGeometryCursor=a.PathTransformationCursor=a.setId=a.getId=a.isClosedPath=a.getCoord2D=a.reversePath=a.reverseMultipath=a.deltaEncodeGeometry=a.deltaDecodeGeometry=a.cloneAndDecodeGeometry=void 0;a.cloneAndDecodeGeometry=function(a){a=e.clone(a);c(a);return a};a.deltaDecodeGeometry=c;a.deltaEncodeGeometry=function(a){a&&(k.isPolygon(a)?n(a.rings):k.isPolyline(a)?n(a.paths):k.isMultipoint(a)&&f(a.points))};a.reverseMultipath=function(a){if(a)for(var b=0;b<a.length;b++)q(a[b])};a.reversePath=
q;a.getCoord2D=function(a,b,c){return[a[0]+(b[0]-a[0])*c,a[1]+(b[1]-a[1])*c]};a.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};a.getId=function(a){return a[4]};a.setId=function(a,b){a[4]=b};g=function(){function a(a,b,c,d){this.acceptPolygon=b;this.acceptPolyline=c;this.geomUnitsPerPoint=d;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(k.isPolygon(a)?b&&(this.multiPath=a.rings,this.isClosed=!0):k.isPolyline(a)?c&&(this.multiPath=
a.paths,this.isClosed=!1):k.isExtent(a)&&b&&(this.multiPath=u(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new h.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var a=this.processPath(this.multiPath[this.pathIndex]);if(a)return a}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}();a.PathTransformationCursor=
g;g=function(){function a(a,b,c,d){this.inputGeometries=a;this.acceptPolygon=b;this.acceptPolyline=c;this.geomUnitsPerPoint=d;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(k.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):k.isPolyline(a)?this.acceptPolyline&&(this.multiPath=a.paths,this.isClosed=!1):k.isExtent(a)&&this.acceptPolygon&&(this.multiPath=u(a).rings,this.isClosed=
!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();a.PathGeometryCursor=g})},"esri/symbols/cim/effects/EffectArrow":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],
function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectArrow=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,b,c)};a.instance=null;return a}();a.EffectArrow=g;var f=function(a){function d(b,c,d){b=a.call(this,b,!1,!0)||this;b._curveHelper=new h.CurveHelper;b._width=(void 0!==c.width?c.width:5)*d;b._arrowType=void 0!==c.geometricEffectArrowType?c.geometricEffectArrowType:
"OpenEnded";b._offsetFlattenError=h.PIXEL_TOLERANCE*d;return b}e.__extends(d,a);d.prototype.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case "Block":return this._constructSimpleArrow(a,!1);case "Crossed":return this._constructCrossedArrow(a)}};d.prototype._constructSimpleArrow=function(a,c){var b=this._curveHelper.calculatePathLength(a),d=this._width;b<2*d&&(d=b/2);b=this._curveHelper.getSubCurve(a,0,b-d);if(!b)return null;var f=d/2;if(this._curveHelper.isEmpty(b,
!1))return null;d=this._constructOffset(b,-f);if(!d)return null;b=this._constructOffset(b,f);if(!b)return null;var e=this._constructArrowBasePoint(d,-f/2);if(!e)return null;f=this._constructArrowBasePoint(b,f/2);if(!f)return null;a=a[a.length-1];c||(this._makeControlPoint(b,!0),this._makeControlPoint(d,!0));var m=new h.PathHelper;m.addPath(b,!0);m.lineTo(f);this._makeControlPoint(m.path());m.lineTo(a);this._makeControlPoint(m.path());m.lineTo(e);this._makeControlPoint(m.path());m.addPath(d,!1);return c?
{paths:[m.path()]}:(m.close(),{rings:[m.path()]})};d.prototype._constructCrossedArrow=function(a){var b=this._curveHelper.calculatePathLength(a),d=this._width;b<3.732050807568877*d&&(d=b/3.732050807568877);var f=this._curveHelper.getSubCurve(a,0,b-2.732050807568877*d);if(!f)return null;var e=d/2;if(this._curveHelper.isEmpty(f,!1))return null;var k=this._constructOffset(f,e);if(!k)return null;f=this._constructOffset(f,-e);if(!f)return null;b=this._curveHelper.getSubCurve(a,0,b-d);if(!b||this._curveHelper.isEmpty(b,
!1))return null;d=this._constructOffset(b,e);if(!d)return null;var m=this._constructOffset(b,-e);if(!m)return null;b=d[d.length-1];d=this._constructArrowBasePoint(d,e/2);if(!d)return null;var g=m[m.length-1],e=this._constructArrowBasePoint(m,-e/2);if(!e)return null;a=a[a.length-1];this._makeControlPoint(k,!1);this._makeControlPoint(f,!1);m=new h.PathHelper;m.addPath(k,!0);this._makeControlPoint(m.path());m.lineTo(g);m.lineTo(e);this._makeControlPoint(m.path());m.lineTo(a);this._makeControlPoint(m.path());
m.lineTo(d);this._makeControlPoint(m.path());m.lineTo(b);this._makeControlPoint(m.path());m.addPath(f,!1);return{paths:[m.path()]}};d.prototype._constructOffset=function(a,c){return this._curveHelper.offset(a,c,"Rounded",4,this._offsetFlattenError)};d.prototype._constructArrowBasePoint=function(a,c){if(!a||2>a.length)return null;var b=a[a.length-2];a=a[a.length-1];b=[a[0]-b[0],a[1]-b[1]];this._curveHelper.normalize(b);return[a[0]+b[1]*c,a[1]-b[0]*c]};d.prototype._makeControlPoint=function(a,c){void 0===
c&&(c=!1);c?k.setId(a[0],1):k.setId(a[a.length-1],1)};return d}(k.PathGeometryCursor)})},"esri/symbols/cim/CurveHelper":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.CurveHelper=a.PathHelper=a.PIXEL_TOLERANCE=void 0;a.PIXEL_TOLERANCE=.03;g=function(){function a(){this._path=[]}a.prototype.path=function(){return this._path};a.prototype.addPath=function(a,e){e||a.reverse();Array.prototype.push.apply(this._path,a);e||a.reverse()};a.mergePath=
function(a,e){e&&Array.prototype.push.apply(a,e)};a.prototype.startPath=function(a){this._path.push(a)};a.prototype.lineTo=function(a){this._path.push(a)};a.prototype.close=function(){var a=this._path;1<a.length&&(a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]||a.push([a[0][0],a[0][1]]))};return a}();a.PathHelper=g;g=function(){function a(a,e){void 0===a&&(a=0);void 0===e&&(e=!1)}a.prototype.normalize=function(a){var e=Math.sqrt(a[0]*a[0]+a[1]*a[1]);a[0]/=e;a[1]/=e};a.prototype.calculateLength=
function(a,e){var f=e[0]-a[0];a=e[1]-a[1];return Math.sqrt(f*f+a*a)};a.prototype.calculateSegLength=function(a,e){return this.calculateLength(a[e],a[e+1])};a.prototype.calculatePathLength=function(a){for(var e=0,f=a?a.length:0,g=0;g<f-1;++g)e+=this.calculateSegLength(a,g);return e};a.prototype.calculatePathArea=function(a){for(var e=0,f=a?a.length:0,g=0;g<f-1;++g)e+=(a[g+1][0]-a[g][0])*(a[g+1][1]+a[g][1]);return e/2};a.prototype.getCoord2D=function(a,e,f){return[a[0]+(e[0]-a[0])*f,a[1]+(e[1]-a[1])*
f]};a.prototype.getSegCoord2D=function(a,e,f){return this.getCoord2D(a[e],a[e+1],f)};a.prototype.getAngle=function(a,e,f){return Math.atan2(e[1]-a[1],e[0]-a[0])};a.prototype.getSegAngle=function(a,e,f){return this.getAngle(a[e],a[e+1],f)};a.prototype.getAngleCS=function(a,e,f){f=e[0]-a[0];a=e[1]-a[1];e=Math.sqrt(f*f+a*a);return 0<e?[f/e,a/e]:[1,0]};a.prototype.getSegAngleCS=function(a,e,f){return this.getAngleCS(a[e],a[e+1],f)};a.prototype.cut=function(a,e,f,g){f=0>=f?a[e]:this.getSegCoord2D(a,e,
f);a=1<=g?a[e+1]:this.getSegCoord2D(a,e,g);return[f,a]};a.prototype.addSegment=function(a,e,f){f&&a.push(e[0]);a.push(e[1])};a.prototype.getSubCurve=function(a,e,f){var h=[];return this.appendSubCurve(h,a,e,f)?h:null};a.prototype.appendSubCurve=function(a,e,f,g){for(var d=e?e.length-1:0,b=0,c=!0,h=0;h<d;){var k=this.calculateSegLength(e,h);if(0!==k){if(c){if(b+k>f){var n=(f-b)/k,r=1,m=!1;b+k>=g&&(r=(g-b)/k,m=!0);(n=this.cut(e,h,n,r))&&this.addSegment(a,n,c);if(m)break;c=!1}}else{if(b+k>g){(n=this.cut(e,
h,0,(g-b)/k))&&this.addSegment(a,n,c);break}this.addSegment(a,[e[h],e[h+1]],c)}b+=k}++h}return!0};a.prototype.getCIMPointAlong=function(a,e){for(var f=a?a.length-1:0,h=0,d=-1;d<f;){++d;var b=this.calculateSegLength(a,d);if(0!==b){if(h+b>e)return this.getCoord2D(a[d],a[d+1],(e-h)/b);h+=b}}return null};a.prototype.isEmpty=function(a,e){if(!a||1>=a.length)return!0;for(var f=a?a.length-1:0,h=-1;h<f;)if(++h,a[h+1][0]!==a[h][0]||a[h+1][1]!==a[h][1]||e&&a[h+1][2]!==a[h][2])return!1;return!0};a.prototype.offset=
function(a,e,f,g,d){d;if(!a||2>a.length)return null;d=a.length;var b=a[0][0]===a[d-1][0]&&a[0][1]===a[d-1][1];if(b){if(3>a.length)return null;--d}for(var c=[],h=b?a[d-1]:null,k=a[0],n=0;n<d;n++){var r=n===d-1?b?a[0]:null:a[n+1];if(h)if(r){var m=[r[0]-k[0],r[1]-k[1]];this.normalize(m);h=[k[0]-h[0],k[1]-h[1]];this.normalize(h);var v=h[0]*m[1]-h[1]*m[0],l=h[0]*m[0]+h[1]*m[1];if(0<=v===0>=e)v=[m[0]-h[0],m[1]-h[1]],this.normalize(v),l=Math.sqrt((1+l)/2),m=-Math.abs(e)/l,c.push([k[0]-v[0]*m,k[1]-v[1]*m]);
else switch(f){case "Mitered":if(l=Math.sqrt((1+l)/2),0<l&&1/l<g){v=[m[0]-h[0],m[1]-h[1]];this.normalize(v);m=Math.abs(e)/l;c.push([k[0]-v[0]*m,k[1]-v[1]*m]);break}case "Bevelled":c.push([k[0]+h[1]*e,k[1]-h[0]*e]);c.push([k[0]+m[1]*e,k[1]-m[0]*e]);break;case "Rounded":c.push([k[0]+h[1]*e,k[1]-h[0]*e]);for(var l=.2,w=1;5>w;w++,l+=.2)v=[h[1]*(1-l)+m[1]*l,-h[0]*(1-l)-m[0]*l],this.normalize(v),c.push([k[0]+v[0]*e,k[1]+v[1]*e]);c.push([k[0]+m[1]*e,k[1]-m[0]*e]);break;default:0>v?(c.push([k[0]+(h[1]+h[0])*
e,k[1]+(h[1]-h[0])*e]),c.push([k[0]+(m[1]-m[0])*e,k[1]-(m[0]+m[1])*e])):(l=Math.sqrt((1+Math.abs(l))/2),v=[m[0]-h[0],m[1]-h[1]],this.normalize(v),m=e/l,c.push([k[0]-v[0]*m,k[1]-v[1]*m]))}}else v=[k[0]-h[0],k[1]-h[1]],this.normalize(v),c.push([k[0]+v[1]*e,k[1]-v[0]*e]);else v=[r[0]-k[0],r[1]-k[1]],this.normalize(v),c.push([k[0]+v[1]*e,k[1]-v[0]*e]);h=k;k=r}b&&c.push([c[0][0],c[0][1]]);return c};return a}();a.CurveHelper=g})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["require","exports",
"../../../geometry/support/jsonUtils","../CurveHelper"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectBuffer=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,d,b){return new h(a,d,b)};a.instance=null;return a}();a.EffectBuffer=g;var h=function(){function a(a,d,b){this._inputGeometries=a;this._curveHelper=new k.CurveHelper;this._size=(void 0!==d.size?d.size:1)*b;this._offsetFlattenError=
k.PIXEL_TOLERANCE*b}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(e.isExtent(a))if(0<this._size){var d=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(d=this._curveHelper.offset(d,this._size,"Rounded",4,this._offsetFlattenError))return{rings:[d]}}else if(0>this._size){if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._size)return{xmin:a.xmin-this._size,xmax:a.xmax+this._size,ymin:a.ymin-this._size,ymax:a.ymax+this._size}}else return a;
if(e.isPolygon(a)){if(0===this._size)return a;for(var b=[],c=0,f=a.rings;c<f.length;c++)d=f[c],(d=this._curveHelper.offset(d,this._size,"Rounded",4,this._offsetFlattenError))&&b.push(d);if(b.length)return{rings:b}}if(e.isPolyline(a)&&0<this._size){b=[];c=0;for(f=a.paths;c<f.length;c++){var h=f[c];if(h&&1<h.length&&(d=this._curveHelper.offset(h,this._size,"Rounded",4,this._offsetFlattenError),h=this._curveHelper.offset(h,-this._size,"Rounded",4,this._offsetFlattenError),d&&h)){for(var g=h.length-1;0<=
g;g--)d.push(h[g]);d.push([d[0][0],d[0][1]]);b.push(d)}}if(b.length)return{rings:b}}e.isPoint(a);a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectCut":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectCut=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,
b,c)};a.instance=null;return a}();a.EffectCut=g;var f=function(a){function d(b,c,d){b=a.call(this,b,!0,!0)||this;b._curveHelper=new h.CurveHelper;b._beginCut=(void 0!==c.beginCut?c.beginCut:1)*d;b._endCut=(void 0!==c.endCut?c.endCut:1)*d;b._middleCut=(void 0!==c.middleCut?c.middleCut:0)*d;b._invert=void 0!==c.invert?c.invert:!1;0>b._beginCut&&(b._beginCut=0);0>b._endCut&&(b._endCut=0);0>b._middleCut&&(b._middleCut=0);return b}e.__extends(d,a);d.prototype.processPath=function(a){var b=this._beginCut,
d=this._endCut,f=this._middleCut,e=this._curveHelper.calculatePathLength(a),h=[];if(!this._invert)0===b&&0===d&&0===f?h.push(a):b+d+f>=e||(0===f?b=this._curveHelper.getSubCurve(a,b,e-d):((b=this._curveHelper.getSubCurve(a,b,.5*(e-f)))&&h.push(b),b=this._curveHelper.getSubCurve(a,.5*(e+f),e-d)),b&&h.push(b));else if(0!==b||0!==d||0!==f)b+d+f>=e?h.push(a):((b=this._curveHelper.getSubCurve(a,0,b))&&h.push(b),(b=this._curveHelper.getSubCurve(a,.5*(e-f),.5*(e+f)))&&h.push(b),(b=this._curveHelper.getSubCurve(a,
e-d,d))&&h.push(b));return 0===h.length?null:{paths:h}};return d}(k.PathGeometryCursor)})},"esri/symbols/cim/effects/EffectDashes":function(){define("require exports tslib ../CIMCursor ../CurveHelper ../GeometryWalker".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.EffectDashes=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,d){return new n(a,c,d)};a.instance=null;return a}();
a.EffectDashes=g;var n=function(a){function b(b,d,e){b=a.call(this,b,!0,!0)||this;b._walker=new f.GeometryWalker;b._walker.updateTolerance(e);b._endings=d.lineDashEnding;b._customDashPos=void 0!==d.offsetAlongLine?d.offsetAlongLine*e:0;b._offsetAtEnd=void 0!==d.customEndingOffset?d.customEndingOffset*e:0;b._pattern=new f.DashPattern;b._pattern.init(d.dashTemplate,!0);b._pattern.scale(e);return b}e.__extends(b,a);b.prototype.processPath=function(a){if(0===this._pattern.length())return this.iteratePath=
!1,{paths:[a]};if(!this.iteratePath){var b=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||(b=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var c=this._walker.calculatePathLength(a);if(this._pattern.isEmpty()||c<.1*this._pattern.length()||
!this._walker.init(a,this._pattern,b))return{paths:[a]}}if(this.iteratePath)a=this._pattern.nextValue();else{b=void 0;switch(this._endings){default:b=.5*this._pattern.firstValue();break;case "HalfGap":b=.5*-this._pattern.lastValue();break;case "FullGap":b=-this._pattern.lastValue();break;case "FullPattern":b=0;break;case "NoConstraint":case "Custom":b=-this._customDashPos}a=b/this._pattern.length();a-=Math.floor(a);b=a*this._pattern.length();this._pattern.reset();a=this._pattern.nextValue();for(c=
!1;b>=a;)b-=a,a=this._pattern.nextValue(),c=!c;a-=b;c?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),this._walker.nextPosition(a),a=this._pattern.nextValue())}(b=this._walker.nextCurve(a))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),h.PathHelper.mergePath(b,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||
this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(b=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,b=this._firstCurve,this._firstCurve=null);return{paths:[b]}};return b}(k.PathGeometryCursor)})},"esri/symbols/cim/GeometryWalker":function(){define(["require","exports","tslib","./CIMCursor","./CurveHelper"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.GeometryWalker=a.DashPattern=void 0;g=function(){function a(){this._values=
[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}a.prototype.isEmpty=function(){return 0===this._values.length};a.prototype.size=function(){return this._values.length};a.prototype.init=function(a,b,c){void 0===c&&(c=!0);this._setEmpty();if(!a||0===a.length)return!1;for(var d=0;d<a.length;d++){var f=Math.abs(a[d]);c&&1E-7>f&&(f=1E-7);this._values.push(f);this._length+=f}b&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=
-1;return!0};a.prototype.scale=function(a){for(var b=this._values?this._values.length:0,c=0;c<b;++c)this._values[c]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};a.prototype.addValue=function(a){this._length+=a;this._values.push(a)};a.prototype.firstValue=function(){return this._values[0]};a.prototype.lastValue=function(){return this._values[this._values.length-1]};a.prototype.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};
a.prototype.reset=function(){this._currentValue=-1};a.prototype.length=function(){return this._length};a.prototype._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return a}();a.DashPattern=g;var f=function(){function a(){this.reset()}a.prototype.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};a.prototype.isValid=function(){return-1!==this.segment};a.prototype.copyTo=function(a){a.segment=
this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return a}();g=function(a){function d(b,c){void 0===b&&(b=0);void 0===c&&(c=!1);b=a.call(this,b,c)||this;b._tolerance=h.PIXEL_TOLERANCE;b._currentPosition=new f;return b}e.__extends(d,a);d.prototype.updateTolerance=function(a){this._tolerance=h.PIXEL_TOLERANCE*a};d.prototype.init=function(a,c,d){void 0===d&&(d=!0);d?(this._patternLength=c.length(),this._partExtPtGap=c.extPtGap,
this._partCtrlPtGap=c.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=a;this._seg=-1;return this.setPosAtNextPart()};d.prototype.curPositionIsValid=function(){return this._currentPosition.isValid()};d.prototype.nextPosition=function(a,c){void 0===c&&(c=0);var b=new f;if(!this._nextPosition(a,b,null,c))return!1;b.copyTo(this._currentPosition);return!0};d.prototype.curPointAndAngle=function(a){a.pt=this._getPoint(this._currentPosition);
var b=this._getAngle(this._currentPosition),d=b[1];a.ca=b[0];a.sa=d};d.prototype.nextPointAndAngle=function(a,c,d){void 0===d&&(d=0);var b=new f;if(!this._nextPosition(a,b,null,d))return!1;b.copyTo(this._currentPosition);c.pt=this._getPoint(b);a=this._getAngle(b);d=a[1];c.ca=a[0];c.sa=d;return!0};d.prototype.nextCurve=function(a){if(0===a)return null;var b=[],d=new f;if(!this._nextPosition(a,d,b,1))return null;d.copyTo(this._currentPosition);return b};d.prototype.isPathEnd=function(){return this._currentPosition.isPathEnd};
d.prototype.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};d.prototype._nextPosition=function(a,c,d,f){if(this._currentPosition.isPathEnd)return!1;var b=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(b/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(c);c.abscissa+a*this._partLengthRatio>c.segmentLength+this._tolerance;)if(d&&(0===d.length&&(0===b?(b=this._path[c.segment],
d.push([b[0],b[1]])):d.push(this.getSegCoord2D(this._path,c.segment,b))),b=this._path[c.segment+1],d.push([b[0],b[1]])),b=0,a-=(c.segmentLength-c.abscissa)/this._partLengthRatio,this._partSegCount)c.segment=this.nextSegment(),c.segmentLength=this.calculateSegLength(this._path,c.segment),c.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===f)return!1;c.segmentLength=this.calculateSegLength(this._path,c.segment);c.isPartEnd=!0;1===f?(c.abscissa=c.segmentLength,c.isPathEnd=!0):
c.abscissa=c.segmentLength+a;return!0}this._currentPosition.copyTo(c)}c.abscissa+=a*this._partLengthRatio;d&&(0===d.length&&(0===b?(b=this._path[c.segment],d.push([b[0],b[1]])):d.push(this.getSegCoord2D(this._path,c.segment,b))),a=c.abscissa/c.segmentLength,1===a?(b=this._path[c.segment+1],d.push([b[0],b[1]])):d.push(this.getSegCoord2D(this._path,c.segment,a)));!this._partSegCount&&Math.abs(c.abscissa-c.segmentLength)<this._tolerance&&(c.isPathEnd=this._partIsLast,c.isPartEnd=!0);return!0};d.prototype._getPoint=
function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};d.prototype._getAngle=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};d.prototype.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;
this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this.nextSegment()),this._partSegCount++,1===k.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var a=this._partSegCount;a;)this.previousSegment(),--a;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=
0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;a=this.getStartPointIndex();this._ctrlPtBegin=1===k.getId(this._path[a]);a=a+this._partSegCount+1;a>=this._path.length&&(a=0);this._ctrlPtEnd=1===k.getId(this._path[a]);if(0<this._patternLength){var a=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,c=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap,d=Math.round((this._partLength-(a+c))/this._patternLength);0>=d&&(d=0<a+c?0:1);this._partLengthRatio=
this._partLength/(a+c+d*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};d.prototype.hasNextSegment=function(){return this._seg<this._path.length-2};d.prototype.previousSegment=function(){return--this._seg};d.prototype.nextSegment=function(){return++this._seg};d.prototype.getStartPointIndex=function(){return this._seg};d.prototype.getEndPointIndex=function(){return this._seg+1};return d}(h.CurveHelper);a.GeometryWalker=g})},"esri/symbols/cim/effects/EffectDonut":function(){define(["require",
"exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectDonut=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,d,b){return new h(a,d,b)};a.instance=null;return a}();a.EffectDonut=g;var h=function(){function a(a,d,b){this._inputGeometries=a;this._curveHelper=new k.CurveHelper;this._width=(void 0!==d.width?d.width:2)*b;switch(d.method){default:this._method=
"Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";break;case "Square":this._method="Square"}this._option=d.option;this._offsetFlattenError=k.PIXEL_TOLERANCE*b;this._option}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(e.isExtent(a)&&0<this._width){if(0>Math.min(a.xmax-a.xmin,a.ymax-a.ymin)-2*this._width)return a;var d=[];d.push([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]);
d.push([[a.xmin+this._width,a.ymin+this._width],[a.xmax-this._width,a.ymin+this._width],[a.xmax-this._width,a.ymax-this._width],[a.xmin+this._width,a.ymax-this._width],[a.xmin+this._width,a.ymin+this._width]]);return{rings:d}}if(e.isPolygon(a)&&0<this._width){for(var b=[],d=[],c=0,a=a.rings;c<a.length;c++){var f=a[c],h=this._curveHelper.calculatePathLength(f);0<h&&b.push(f);var g=this._curveHelper.offset(f,this._width,this._method,4,this._offsetFlattenError);g&&(0>h&&g.reverse(),d.push(g));0>h&&b.push(f)}if(d.length)return{rings:d}}a=
this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectJog":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectJog=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,b,c)};a.instance=null;return a}();a.EffectJog=g;var f=function(a){function d(b,c,d){b=
a.call(this,b,!1,!0)||this;b._curveHelper=new h.CurveHelper;b._length=(void 0!==c.length?c.length:20)*d;b._angle=void 0!==c.angle?c.angle:225;b._position=void 0!==c.position?c.position:50;0>b._length&&(b._length=-b._length);20>b._position&&(b._position=20);80<b._position&&(b._position=80);b._mirror=!1;return b}e.__extends(d,a);d.prototype.processPath=function(a){if(this._curveHelper.isEmpty(a,!1))return null;var b=a[0];a=a[a.length-1];this._curveHelper.normalize([a[0]-b[0],a[1]-b[1]]);var d=[b[0]+
(a[0]-b[0])*this._position/100,b[1]+(a[1]-b[1])*this._position/100],f=Math.cos((90-this._angle)/180*Math.PI),e=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(e=-e);this._mirror=!this._mirror;return{paths:[[b,[d[0]-this._length/2*f,d[1]-this._length/2*e],[d[0]+this._length/2*f,d[1]+this._length/2*e],a]]}};return d}(k.PathGeometryCursor)})},"esri/symbols/cim/effects/EffectMove":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(g,a,e,k){Object.defineProperty(a,
"__esModule",{value:!0});a.EffectMove=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,d,b){return new h(a,d,b)};a.instance=null;return a}();a.EffectMove=g;var h=function(){function a(a,d,b){this._inputGeometries=a;this._offsetX=void 0!==d.offsetX?d.offsetX*b:0;this._offsetY=void 0!==d.offsetY?-d.offsetY*b:0}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(k.isExtent(a))return{xmin:a.xmin+
this._offsetX,xmax:a.xmax+this._offsetX,ymin:a.ymin+this._offsetY,ymax:a.ymax+this._offsetY};if(k.isPolygon(a))return a=e.clone(a),this._moveMultipath(a.rings,this._offsetX,this._offsetY),a;if(k.isPolyline(a))return a=e.clone(a),this._moveMultipath(a.paths,this._offsetX,this._offsetY),a;if(k.isMultipoint(a))return a=e.clone(a),this._movePath(a.points,this._offsetX,this._offsetY),a;if(k.isPoint(a))return{x:a.x+this._offsetX,y:a.y+this._offsetY};a=this._inputGeometries.next()}return null};a.prototype._moveMultipath=
function(a,d,b){if(a)for(var c=0;c<a.length;c++)this._movePath(a[c],d,b)};a.prototype._movePath=function(a,d,b){if(a)for(var c=0;c<a.length;c++){var f=a[c];f[0]+=d;f[1]+=b}};return a}()})},"esri/symbols/cim/effects/EffectOffset":function(){define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.EffectOffset=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};
a.prototype.execute=function(a,d,b){return new h(a,d,b)};a.instance=null;return a}();a.EffectOffset=g;var h=function(){function a(a,d,b){this._inputGeometries=a;this._curveHelper=new k.CurveHelper;this._offset=(void 0!==d.offset?d.offset:1)*b;this._method=d.method;this._option=d.option;this._offsetFlattenError=k.PIXEL_TOLERANCE*b;this._option}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._offset)return a;if(e.isExtent(a)){if("Rounded"===this._method&&0<this._offset){var d=
[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];return(d=this._curveHelper.offset(d,this._offset,this._method,4,this._offsetFlattenError))?{rings:[d]}:null}if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._offset)return{xmin:a.xmin-this._offset,xmax:a.xmax+this._offset,ymin:a.ymin-this._offset,ymax:a.ymax+this._offset}}if(e.isPolygon(a)){for(var b=[],c=0,f=a.rings;c<f.length;c++)d=f[c],(d=this._curveHelper.offset(d,this._offset,this._method,4,this._offsetFlattenError))&&
b.push(d);if(b.length)return{rings:b}}if(e.isPolyline(a)){b=[];c=0;for(a=a.paths;c<a.length;c++)(f=this._curveHelper.offset(a[c],this._offset,this._method,4,this._offsetFlattenError))&&b.push(f);if(b.length)return{paths:b}}a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectReverse":function(){define(["require","exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});
a.EffectReverse=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,b,c)};a.instance=null;return a}();a.EffectReverse=g;var f=function(){function a(a,b,c){this._inputGeometries=a;this._reverse=void 0!==b.reverse?b.reverse:!0;c}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(!this._reverse)return a;if(k.isPolyline(a))return a=e.clone(a),h.reverseMultipath(a.paths),
a;a=this._inputGeometries.next()}return null};return a}()})},"esri/symbols/cim/effects/EffectRotate":function(){define("require exports ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.EffectRotate=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,
c,d){return new n(a,c,d)};a.instance=null;return a}();a.EffectRotate=g;var n=function(){function a(a,c,d){this._inputGeometries=a;this._rotateAngle=void 0!==c.angle?-c.angle*Math.PI/180:0;d}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var c=k.create();h.getBoundsXY(c,a);var d=(c[2]+c[0])/2,c=(c[3]+c[1])/2;if(f.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,
d,c),a;if(f.isPolygon(a))return a=e.clone(a),this._rotateMultipath(a.rings,d,c),a;if(f.isPolyline(a))return a=e.clone(a),this._rotateMultipath(a.paths,d,c),a;if(f.isMultipoint(a))return a=e.clone(a),this._rotatePath(a.points,d,c),a;if(f.isPoint(a))return a;a=this._inputGeometries.next()}return null};a.prototype._rotateMultipath=function(a,c,d){if(a)for(var b=0;b<a.length;b++)this._rotatePath(a[b],c,d)};a.prototype._rotatePath=function(a,c,d){if(a)for(var b=Math.cos(this._rotateAngle),f=Math.sin(this._rotateAngle),
e=0;e<a.length;e++){var h=a[e],g=h[0]-c,l=h[1]-d;h[0]=c+g*b-l*f;h[1]=d+g*f+l*b}};return a}()})},"esri/symbols/cim/effects/EffectScale":function(){define("require exports ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.EffectScale=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};
a.prototype.execute=function(a,c,d){return new n(a,c,d)};a.instance=null;return a}();a.EffectScale=g;var n=function(){function a(a,c,d){this._inputGeometries=a;this._xFactor=void 0!==c.xScaleFactor?c.xScaleFactor:1.15;this._yFactor=void 0!==c.yScaleFactor?c.yScaleFactor:1.15;d}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var c=k.create();h.getBoundsXY(c,a);var d=(c[2]+c[0])/2,c=(c[3]+c[1])/2;if(f.isExtent(a))return a={rings:[[[a.xmin,
a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,d,c),a;if(f.isPolygon(a))return a=e.clone(a),this._scaleMultipath(a.rings,d,c),a;if(f.isPolyline(a))return a=e.clone(a),this._scaleMultipath(a.paths,d,c),a;if(f.isMultipoint(a))return a=e.clone(a),this._scalePath(a.points,d,c),a;if(f.isPoint(a))return a;a=this._inputGeometries.next()}return null};a.prototype._scaleMultipath=function(a,c,d){if(a)for(var b=0;b<a.length;b++)this._scalePath(a[b],c,
d)};a.prototype._scalePath=function(a,c,d){if(a)for(var b=0;b<a.length;b++){var f=a[b],e=(f[1]-d)*this._yFactor;f[0]=c+(f[0]-c)*this._xFactor;f[1]=d+e}};return a}()})},"esri/symbols/cim/effects/EffectWave":function(){define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.EffectWave=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};
a.prototype.execute=function(a,b,c){return new f(a,b,c)};a.instance=null;return a}();a.EffectWave=g;var f=function(){function a(a,b,c){this._inputGeometries=a;this._height=(void 0!==b.amplitude?b.amplitude:2)*c;this._period=(void 0!==b.period?b.period:3)*c;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new h.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=
new h.GeometryWalker;this._walker.updateTolerance(c)}a.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period)return a;if(e.isPolyline(a)){var b=this._processGeom(a.paths);if(b.length)return{paths:b}}if(e.isPolygon(a)&&(a=this._processGeom(a.rings),a.length))return{rings:a};a=this._inputGeometries.next()}return null};a.prototype._processGeom=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(this._walker.init(d,this._pattern))switch(this._style){default:b.push(this._constructCurve(d,
!1));break;case "Square":b.push(this._constructSquare(d));break;case "Triangle":b.push(this._constructTriangle(d));break;case "Random":b.push(this._constructCurve(d,!0))}else b.push(d)}return b};a.prototype._constructCurve=function(a,b){var c=new k.PathHelper,d=this._walker.calculatePathLength(a),f=Math.round(d/this._period);0===f&&(f=1);var e=this._period/16,h=1/(16*f+1),d=2*Math.PI*d/(d/f),f=2*Math.PI*Math.random(),m=2*Math.PI*Math.random(),g=2*Math.PI*Math.random(),l=.75-Math.random()/2,n=.75-
Math.random()/2,p={};this._walker.curPointAndAngle(p);c.startPath(p.pt);for(var y=0;;)if(this._walker.nextPointAndAngle(e,p)){var z=y,y=y+h,C=void 0;if(b)var B=this._height/2*(1+.3*Math.sin(l*d*z+f)),C=B*Math.sin(d*z+m),C=C+B*Math.sin(n*d*z+g),C=C/2;else C=.5*this._height*Math.sin(.5*d*z);c.lineTo([p.pt[0]-C*p.sa,p.pt[1]+C*p.ca])}else{c.lineTo(a[a.length-1]);break}return c.path()};a.prototype._constructSquare=function(a){var b=new k.PathHelper;a=this._walker.calculatePathLength(a);a=Math.round(a/
this._period);0===a&&(a=1);for(a=!0;;){var c=!1;if(this._walker.curPositionIsValid()){var d={};this._walker.curPointAndAngle(d);var f={};if(this._walker.nextPointAndAngle(this._period,f)){var e={};this._walker.nextPointAndAngle(this._period,e)&&(a?(b.startPath(d.pt),a=!1):b.lineTo(d.pt),b.lineTo([d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca]),b.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),b.lineTo([f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca]),b.lineTo([e.pt[0]+
this._height/2*e.sa,e.pt[1]-this._height/2*e.ca]),c=!0)}}if(!c){b.lineTo(this._walker.getPathEnd());break}}return b.path()};a.prototype._constructTriangle=function(a){var b=new k.PathHelper;a=this._walker.calculatePathLength(a);a=Math.round(a/this._period);0===a&&(a=1);for(a=!0;;){var c=!1;if(this._walker.curPositionIsValid()){var d={};this._walker.curPointAndAngle(d);var f={};if(this._walker.nextPointAndAngle(this._period/2,f)){var e={};this._walker.nextPointAndAngle(this._period,e)&&(this._walker.nextPosition(this._period/
2)&&(a?(b.startPath(d.pt),a=!1):b.lineTo(d.pt),b.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),b.lineTo([e.pt[0]+this._height/2*e.sa,e.pt[1]-this._height/2*e.ca])),c=!0)}}if(!c){b.lineTo(this._walker.getPathEnd());break}}return b.path()};return a}()})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define("require exports tslib ../CIMCursor ../enums ../GeometryWalker".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementAlongLineSameSize=
void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,d){return new n(a,c,d)};a.instance=null;return a}();a.PlacementAlongLineSameSize=g;var n=function(a){function b(b,d,e){b=a.call(this,b,!0,!0)||this;b._grometryWalker=new f.GeometryWalker;b._grometryWalker.updateTolerance(e);b._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;b._offset=void 0!==d.offset?d.offset*e:0;b._originalEndings=d.endings;b._offsetAtEnd=
void 0!==d.customEndingOffset?d.customEndingOffset*e:0;b._position=void 0!==d.offsetAlongLine?d.offsetAlongLine*e:0;b._pattern=new f.DashPattern;b._pattern.init(d.placementTemplate,!1);b._pattern.scale(e);b._endings=b._originalEndings;return b}e.__extends(b,a);b.prototype.processPath=function(a){if(this._pattern.isEmpty())return null;var b;if(this.iteratePath)b=this._pattern.nextValue();else{this._endings=this._originalEndings===h.PlacementEndings.WithFullGap&&this.isClosed?h.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;var c=!0;b=void 0;switch(this._endings){case h.PlacementEndings.NoConstraint:b=-this._position;b=this._adjustPosition(b);c=!1;break;default:b=-this._pattern.lastValue()/2;break;case h.PlacementEndings.WithFullGap:b=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case h.PlacementEndings.WithMarkers:b=0;break;case h.PlacementEndings.Custom:b=-this._position,b=this._adjustPosition(b),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(a,
this._pattern,c))return null;this._pattern.reset();for(a=0;b>a;)b-=a,a=this._pattern.nextValue();b=a-b;this.iteratePath=!0}a={};if(!this._grometryWalker.nextPointAndAngle(b,a)||this._endings===h.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===h.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(a.pt[0]+this._offset*a.sa,a.pt[1]-this._offset*
a.ca);this._angleToLine&&this.internalPlacement.setRotateCS(a.ca,a.sa);return this.internalPlacement};b.prototype._adjustPosition=function(a){a/=this._pattern.length();a-=Math.floor(a);return a*this._pattern.length()};return b}(k.PathTransformationCursor)})},"esri/symbols/cim/enums":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementEndings=void 0;g=a.PlacementEndings||(a.PlacementEndings={});g.NoConstraint="NoConstraint";g.WithMarkers=
"WithMarkers";g.WithFullGap="WithFullGap";g.WithHalfGap="WithHalfGap";g.Custom="Custom"})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementAtExtremities=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,b,c)};a.instance=null;
return a}();a.PlacementAtExtremities=g;var f=function(a){function d(b,c,d){b=a.call(this,b,!1,!0)||this;b._curveHelper=new h.CurveHelper;b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*d:0;b._type=c.extremityPlacement;b._position=void 0!==c.offsetAlongLine?c.offsetAlongLine*d:0;b._beginProcessed=!1;return b}e.__extends(d,a);d.prototype.processPath=function(a){var b;switch(this._type){default:this._beginProcessed?(b=this._atExtremities(a,this._position,!1),
this.iteratePath=this._beginProcessed=!1):(b=this._atExtremities(a,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":b=this._atExtremities(a,this._position,!0);break;case "JustEnd":b=this._atExtremities(a,this._position,!1);case "None":}return b};d.prototype._atExtremities=function(a,c,d){var b=a.length;if(2>b)return null;for(var f=d?b:-1,e=d?1:-1,h=0,g=d?a[0]:a[b-1],b=d?1:b-2;b!==f;b+=e){d=g;var g=a[b],l=this._curveHelper.calculateLength(d,g);if(h+l>c)return c=(c-
h)/l,f=this._curveHelper.getAngleCS(d,g,c),a=f[0],f=f[1],g=k.getCoord2D(d,g,c),this.internalPlacement.setTranslate(g[0]-this._offset*f,g[1]+this._offset*a),this._angleToLine&&this.internalPlacement.setRotateCS(-a,-f),this.internalPlacement;h+=l}return null};return d}(k.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["require","exports","tslib","../CIMCursor","../GeometryWalker"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});
a.PlacementAtRatioPositions=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,b,c)};a.instance=null;return a}();a.PlacementAtRatioPositions=g;var f=function(a){function d(b,c,d){b=a.call(this,b,!0,!0)||this;b._walker=new h.GeometryWalker;b._walker.updateTolerance(d);b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*d:0;b._beginGap=void 0!==c.beginPosition?
c.beginPosition*d:0;b._endGap=void 0!==c.endPosition?c.endPosition*d:0;b._flipFirst=void 0!==c.flipFirst?c.flipFirst:!0;b._pattern=new h.DashPattern;b._pattern.init(c.positionArray,!1,!1);b._subPathLen=0;b._posCount=b._pattern.size();b._isFirst=!0;b._prevPos=0;return b}e.__extends(d,a);d.prototype.processPath=function(a){if(this._pattern.isEmpty())return null;var b;if(this.iteratePath)a=this._pattern.nextValue()*this._subPathLen,a=this._beginGap+a,b=a-this._prevPos,this._prevPos=a;else{this._posCount=
this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(a)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(a,this._pattern,!1))return null;this._pattern.reset();a=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+a;b=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(b,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]+
this._offset*a.sa,a.pt[1]-this._offset*a.ca);b=this._isFirst&&this._flipFirst;var d;this._angleToLine?(d=a.ca,a=a.sa):(d=1,a=0);b&&(d=-d,a=-a);this.internalPlacement.setRotateCS(d,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return d}(k.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["require","exports","../CIMPlacements"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});
a.PlacementInsidePolygon=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,e,d){return new k(a,e,d)};a.instance=null;return a}();a.PlacementInsidePolygon=g;var k=function(){function a(a,h,d){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==h.stepX?Math.abs(h.stepX):16)*d;this._stepY=(void 0!==h.stepY?Math.abs(h.stepY):16)*d;if(0!==this._stepX&&0!==this._stepY&&
a&&void 0!==a.rings&&a.rings){this._gridType=void 0!==h.gridType?h.gridType:"Fixed";if("Random"===this._gridType)this._randomness=void 0!==h.randomness?h.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==h.gridAngle?h.gridAngle:0;this._shiftOddRows=void 0!==h.shiftOddRows?h.shiftOddRows:!1;this._offsetX=void 0!==h.offsetX?h.offsetX*d:0;this._offsetY=void 0!==h.offsetY?h.offsetY*d:
0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=
new e.Placement;this._calculateMinMax(a);this._geometry=a}}a.prototype.next=function(){return this._geometry?this._nextInside():null};a.prototype._calculateMinMax=function(a){this._yMax=this._yMin=this._xMax=this._xMin=0;var f,d,b,c,e,h;b=c=Number.MAX_VALUE;e=h=-Number.MAX_VALUE;for(var g=0,k=a.rings;g<k.length;g++)for(var m=k[g],v=m?m.length:0,l=0;l<v;++l)f=m[l][0]-this._graphicOriginX-this._offsetX,d=m[l][1]-this._graphicOriginY-this._offsetY,a=this._cosAngle*f-this._sinAngle*d,f=this._sinAngle*
f+this._cosAngle*d,b=Math.min(b,a),e=Math.max(e,a),c=Math.min(c,f),h=Math.max(h,f);b+=this._graphicOriginX;e+=this._graphicOriginX;c+=this._graphicOriginY;h+=this._graphicOriginY;this._xMin=Math.round(b/this._stepX);this._xMax=Math.round(e/this._stepX);this._yMin=Math.round(c/this._stepY);this._yMax=Math.round(h/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};a.prototype._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;
this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var a=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(a+=.5*this._stepX);var e=this._currentY*this._stepY+this._offsetY;this._currentX++;var d=void 0,b=void 0;"Random"===this._gridType?(d=this._graphicOriginX+a+this._stepX*this._randomness*(.5-Math.random())*2/3,b=this._graphicOriginY+e+this._stepY*this._randomness*(.5-Math.random())*2/3):(d=this._graphicOriginX+this._cosAngle*a+this._sinAngle*
e,b=this._graphicOriginY-this._sinAngle*a+this._cosAngle*e);this._internalPlacement.setTranslate(d,b);return this._internalPlacement}};return a}()})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementOnLine=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,
b,c){return new f(a,b,c)};a.instance=null;return a}();a.PlacementOnLine=g;var f=function(a){function d(b,c,d){b=a.call(this,b,!0,!0)||this;b._curveHelper=new h.CurveHelper;b._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;b._offset=void 0!==c.offset?c.offset*d:0;b._relativeTo=c.relativeTo;b._position=void 0!==c.startPointOffset?c.startPointOffset*d:0;b._epsilon=.001*d;return b}e.__extends(d,a);d.prototype.processPath=function(a){var b=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||
(this._segmentCount=a.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var d=this._curSegment;this._curSegment++;var b=a[d-1],d=a[d],f=this._curveHelper.calculateLength(b,d);if(!(f<this._epsilon)){var f=.5+this._position/f,e=this._curveHelper.getAngleCS(b,d,f);a=e[0];e=e[1];b=k.getCoord2D(b,d,f);this.internalPlacement.setTranslate(b[0]-this._offset*e,b[1]+this._offset*a);this._angleToLine&&this.internalPlacement.setRotateCS(a,e);return this.internalPlacement}}this.iteratePath=
!1;return null}"LineEnd"===this._relativeTo&&k.reversePath(a);b=this.onLine(a,b);"LineEnd"===this._relativeTo&&k.reversePath(a);return b};d.prototype.onLine=function(a,c){var b,d=!1;switch(this._relativeTo){default:b=this._curveHelper.calculatePathLength(a)/2+c;break;case "LineBeginning":b=c;break;case "LineEnd":b=c,d=!0}for(var f=a.length,e=0,h=a[0],g=1;g<f;++g){c=h;var h=a[g],l=this._curveHelper.calculateLength(c,h);if(e+l>b)return f=(b-e)/l,b=this._curveHelper.getAngleCS(c,h,f),a=b[0],b=b[1],c=
k.getCoord2D(c,h,f),h=d?this._offset:-this._offset,this.internalPlacement.setTranslate(c[0]-h*b,c[1]+h*a),this._angleToLine&&(d?this.internalPlacement.setRotateCS(-a,-b):this.internalPlacement.setRotateCS(a,b)),this.internalPlacement;e+=l}return null};return d}(k.PathTransformationCursor)})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(g,a,e,k,h){function f(a,b){for(var c=Math.PI;Math.abs(b-a)>c+2E-15;)b=
b-a>c?b-2*c:b+2*c;return(a+b)/2}Object.defineProperty(a,"__esModule",{value:!0});a.PlacementOnVertices=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,c,d){return new n(a,c,d)};a.instance=null;return a}();a.PlacementOnVertices=g;var n=function(a){function b(b,d,f){b=a.call(this,b,!0,!0)||this;b._curveHelper=new h.CurveHelper;b._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;b._offset=void 0!==d.offset?
d.offset*f:0;b._endPoints=void 0!==d.placeOnEndPoints?d.placeOnEndPoints:!0;b._controlPoints=void 0!==d.placeOnControlPoints?d.placeOnControlPoints:!0;b._regularVertices=void 0!==d.placeOnRegularVertices?d.placeOnRegularVertices:!0;b._tags=[];b._tagIterator=0;return b}e.__extends(b,a);b.prototype.processPath=function(a){this.iteratePath||(this._preparePath(a),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;a=this._tags[this._tagIterator];
this._angleToLine&&this.internalPlacement.setRotate(a[2]);var b=a[0],c=a[1];if(0!==this._offset)var d=Math.cos(a[2]),b=b-this._offset*Math.sin(a[2]),c=c+this._offset*d;this.internalPlacement.setTranslate(b,c);this._tagIterator++;return this.internalPlacement};b.prototype._preparePath=function(a){this._tagIterator=this._tags.length=0;for(var b=k.isClosedPath(a),c=a.length-1,d=0,e=0,h=0,g=0,l=0,n,p;d<c;){d++;n=a[d-1];p=a[d];var y=k.getId(n),z=k.getId(p);if(this._angleToLine||0!==this._offset)g=this._curveHelper.getAngle(n,
p,0);1===d?b?(e=g,h=y):this._endPoints&&this._tags.push([n[0],n[1],g]):1===y?this._controlPoints&&this._tags.push([n[0],n[1],f(l,g)]):this._regularVertices&&this._tags.push([n[0],n[1],f(l,g)]);if(this._angleToLine||0!==this._offset)l=this._curveHelper.getAngle(n,p,1);d===c&&(b?1===z||1===h?this._controlPoints&&this._tags.push([p[0],p[1],f(l,e)]):this._regularVertices&&this._tags.push([p[0],p[1],f(l,e)]):this._endPoints&&this._tags.push([p[0],p[1],l]))}this._tagIterator=0};return b}(k.PathTransformationCursor)})},
"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["require","exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.PlacementPolygonCenter=void 0;g=function(){function a(){}a.local=function(){null===a.instance&&(a.instance=new a);return a.instance};a.prototype.execute=function(a,b,c){return new f(a,b,c)};a.instance=null;return a}();a.PlacementPolygonCenter=
g;var f=function(){function a(a,b,c){this._geometry=a;this._offsetX=void 0!==b.offsetX?b.offsetX*c:0;this._offsetY=void 0!==b.offsetY?b.offsetY*c:0;this._method=void 0!==b.method?b.method:"OnPolygon";this._internalPlacement=new h.Placement}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a&&void 0!==a.rings?this._polygonCenter(a):null};a.prototype._polygonCenter=function(a){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":var b=e.create();k.getBoundsXY(b,
a);this._internalPlacement.setTranslate((b[2]+b[0])/2+this._offsetX,(b[3]+b[1])/2-this._offsetY)}return this._internalPlacement};return a}()})},"esri/symbols/cim/Rect":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,f,g){void 0===a&&(a=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);this.x=a;this.y=e;this.width=f;this.height=g}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||
0>=this.height},enumerable:!1,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=g})},"esri/symbols/cim/packingUtils":function(){define(["require","exports"],function(g,a){function e(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});a.packFloatRGBA=void 0;var k=[1,256,65536,16777216],h=[1/256,1/65536,1/16777216,1/4294967296],
f=function(a,d){void 0===d&&(d=0);for(var b=0,c=0;4>c;c++)b+=a[d+c]*h[c];return b}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,d,b){void 0===b&&(b=0);a=0>a?0:a>f?f:a;for(var c=0;4>c;c++)d[b+c]=Math.floor(256*e(a*k[c]))}})},"esri/symbols/cim/SDFHelper":function(){define(["require","exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(g,a,e,k,h){function f(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;
return f(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var b=a[0];if(!b)break;a=b.geometry;if(!a)break;b=b.symbol;if(!b||"CIMPolygonSymbol"!==b.type&&"CIMLineSymbol"!==b.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===b.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function n(a){for(var b=Infinity,c=-Infinity,d=Infinity,f=-Infinity,e=0;e<a.length;e++)for(var h=0,m=a[e];h<m.length;h++){var g=m[h];g[0]<b&&(b=g[0]);g[0]>c&&(c=g[0]);g[1]<d&&(d=g[1]);
g[1]>f&&(f=g[1])}return[b,d,c,f]}Object.defineProperty(a,"__esModule",{value:!0});a.buildSDF=a.getSDFMetrics=a.getExtent=a.getSDFSymbol=a.getSDFInfo=void 0;a.getSDFInfo=f;a.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};a.getExtent=function(a){return a?a.rings?n(a.rings):a.paths?n(a.paths):e.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};a.getSDFMetrics=function(a,
b,c,f,e){var d=a[0],h=a[1],m=a[2];a=a[3];if(m<d||a<h)return[0,0,0];var g=m-d,l=a-h,m=Math.floor(31.5);a=(128-2*(m+1))/Math.max(g,l);var g=Math.round(g*a),l=Math.round(l*a)+2*m,k=1;b&&(k=l/a/(b.ymax-b.ymin));var p=0,q=0;f&&(e?b&&c&&0<b.ymax-b.ymin&&(p=f.x/((b.xmax-b.xmin)/(b.ymax-b.ymin)*c),q=f.y/c):(p=f.x,q=f.y));p=.5*(b.xmax+b.xmin)+p*(b.xmax-b.xmin);q=.5*(b.ymax+b.ymin)+q*(b.ymax-b.ymin);p=(p-d)*a+m;q=(q-h)*a+m;return[k,p/(g+2*m)-.5,-(q/l-.5)]};a.buildSDF=function(a){var b,c=a.geom;b=c?c.rings?
c.rings:c.paths?c.paths:void 0!==c.xmin&&void 0!==c.ymin&&void 0!==c.xmax&&void 0!==c.ymax?[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]:null:null;var d,c=Infinity,f=-Infinity,e=Infinity,g=-Infinity;for(d=0;d<b.length;d++)for(var m=0,n=b[d];m<n.length;m++){var l=n[m];l[0]<c&&(c=l[0]);l[0]>f&&(f=l[0]);l[1]<e&&(e=l[1]);l[1]>g&&(g=l[1])}d=new h.default(c,e,f-c,g-e);e=Math.floor(31.5);m=(128-2*(e+1))/Math.max(d.width,d.height);c=Math.round(d.width*m)+2*e;f=Math.round(d.height*
m)+2*e;g=[];for(n=0;n<b.length;n++){var w=b[n];if(w&&1<w.length){for(var l=[],p=0;p<w.length;p++){var y=w[p],z=y[0],y=y[1],z=z-d.x,y=y-d.y,z=z*m,y=y*m,z=z+(e-.5),y=y+(e-.5);l.push([z,y])}a.asFill&&(p=l.length-1,l[0][0]===l[p][0]&&l[0][1]===l[p][1]||l.push(l[0]));g.push(l)}}d=c*f;b=Array(d);n=e*e+1;for(m=0;m<d;++m)b[m]=n;for(n=0;n<g.length;n++)for(l=g[n],p=l.length,m=1;m<p;++m){var w=l[m-1],z=l[m],C=void 0,y=void 0;w[0]<z[0]?(C=w[0],y=z[0]):(C=z[0],y=w[0]);var B=void 0,E=void 0;w[1]<z[1]?(B=w[1],E=
z[1]):(B=z[1],E=w[1]);var x=Math.floor(C)-e,y=Math.floor(y)+e,B=Math.floor(B)-e,E=Math.floor(E)+e;0>x&&(x=0);y>c&&(y=c);0>B&&(B=0);E>f&&(E=f);for(var C=z[0]-w[0],A=z[1]-w[1],F=C*C+A*A;x<y;x++)for(var I=B;I<E;I++){var G=(x-w[0])*C+(I-w[1])*A,J=void 0,H=void 0;0>G?(J=w[0],H=w[1]):G>F?(J=z[0],H=z[1]):(G/=F,J=w[0]+G*C,H=w[1]+G*A);G=(x-J)*(x-J)+(I-H)*(I-H);J=(f-I-1)*c+x;G<b[J]&&(b[J]=G)}}for(m=0;m<d;++m)b[m]=Math.sqrt(b[m]);if(a.asFill)for(a=0;a<g.length;a++)for(d=g[a],m=d.length,n=1;n<m;++n)for(l=d[n-
1],p=d[n],z=w=void 0,l[0]<p[0]?(w=l[0],z=p[0]):(w=p[0],z=l[0]),y=B=void 0,l[1]<p[1]?(B=l[1],y=p[1]):(B=p[1],y=l[1]),w=Math.floor(w),z=Math.floor(z)+1,B=Math.floor(B),y=Math.floor(y)+1,w<e&&(w=e),z>c-e&&(z=c-e),B<e&&(B=e),y>f-e&&(y=f-e);B<y;++B)if(l[1]>B!==p[1]>B){E=(f-B-1)*c;for(C=w;C<z;++C)C<(p[0]-l[0])*(B-l[1])/(p[1]-l[1])+l[0]&&(b[E+C]=-b[E+C]);for(C=e;C<w;++C)b[E+C]=-b[E+C]}e*=2;g=b.length;a=new Uint8Array(4*g);for(d=0;d<g;++d)k.packFloatRGBA(.5-b[d]/e,a,4*d);return[a,c,f]}})},"esri/symbols/cim/utils":function(){define(["require",
"exports"],function(g,a){function e(a,e){"string"!==typeof a&&(a=String(a));switch(e){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.isCIMMarkerStrokePlacement=a.isCIMFill=a.isCIMStroke=a.isCIMMarker=a.toCIMSymbolJSON=a.fromCIMColor=a.resampleHermite=a._adjustTextCase=a.createLabelOverrideFunction=a.colorToArray=a.evaluateValueOrFunction=void 0;a.evaluateValueOrFunction=function(a,e,f,g){return"function"===
typeof a?a(e,f,g):a};a.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};a.createLabelOverrideFunction=function(a,h,f){var g=function(a){for(var b=a.length;b--;)if(-1===" /-,\n".indexOf(a.charAt(b)))return!1;return!0},d=[],b=0,c=-1;do c=h.indexOf("[",b),c>=b&&(c>b&&(b=h.substr(b,c-b),d.push([b,null,g(b)])),b=c+1,c=h.indexOf("]",b),c>=b&&(c>b&&(b=h.substr(b,c-b),(b=a[b])&&d.push([null,b,!1])),b=c+1));while(-1!==c);b<h.length-1&&(b=h.substr(b),d.push([b,null,g(b)]));return function(a){for(var b="",
c=null,h=0;h<d.length;h++){var g=d[h],k=g[0],l=g[1],g=g[2];if(k)g?c=k:(c&&(b+=c,c=null),b+=k);else if(k=a.attributes[l])c&&(b+=c,c=null),b+=k}return e(b,f)}};a._adjustTextCase=e;a.resampleHermite=function(a,e,f,g,d,b,c){void 0===c&&(c=!0);var h=e/d;f/=b;for(var k=Math.ceil(h/2),n=Math.ceil(f/2),r=0;r<b;r++)for(var m=0;m<d;m++){for(var v=4*(m+(c?b-r-1:r)*d),l=0,w=0,p=0,y=0,z=0,C=0,B=0,E=(r+.5)*f,x=Math.floor(r*f);x<(r+1)*f;x++)for(var A=Math.abs(E-(x+.5))/n,F=(m+.5)*h,A=A*A,I=Math.floor(m*h);I<(m+
1)*h;I++){var G=Math.abs(F-(I+.5))/k,l=Math.sqrt(A+G*G);-1<=l&&1>=l&&(l=2*l*l*l-3*l*l+1,0<l&&(G=4*(I+x*e),B+=l*a[G+3],p+=l,255>a[G+3]&&(l=l*a[G+3]/250),y+=l*a[G],z+=l*a[G+1],C+=l*a[G+2],w+=l))}g[v]=y/w;g[v+1]=z/w;g[v+2]=C/w;g[v+3]=B/p}};a.fromCIMColor=function(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}};a.toCIMSymbolJSON=function(a){var e;return null===(e=a.data)||void 0===e?void 0:e.symbol};a.isCIMMarker=function(a){return"CIMVectorMarker"===a.type||"CIMPictureMarker"===a.type||
"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};a.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};a.isCIMFill=function(a){return"CIMGradientFill"===a.type||"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===a.type};a.isCIMMarkerStrokePlacement=function(a){return"CIMMarkerPlacementAlongLineRandomSize"===a.type||
"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===a.type||"CIMMarkerPlacementAtRatioPositions"===a.type||"CIMMarkerPlacementOnLine"===a.type||"CIMMarkerPlacementOnVertices"===a.type}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(g,a){function e(a){a=a.toLowerCase().split(" ").join("-");switch(a){case "serif":return"noto-serif";
case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.getFontDecorationTop=a.getFullyQualifiedFontName=void 0;a.getFullyQualifiedFontName=function(a){var h;a:{if(a.weight)switch(a.weight.toLowerCase()){case "bold":case "bolder":h="-bold";break a}h=""}var f;a:{if(a.style)switch(a.style.toLowerCase()){case "italic":case "oblic":f="-italic";
break a}f=""}h+=f;return e(a.family)+(0<h.length?h:"-regular")};a.getFontDecorationTop=function(a){switch(a){case "underline":return-26;case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports tslib ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),function(g,a,e,k,h,f,n,d){function b(a){for(var b=new Set,c=0;c<a.length;c++)b.add(Math.floor(a[c]/256));return b}function c(a,b,c){a.has(b)||
a.set(b,c().then(function(){a.delete(b)}).catch(function(c){a.delete(b);h.throwIfNotAbortError(c)}));return a.get(b)}return function(){function a(a,b,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=b;this._glyphSource=c;this._binPack=new d(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}a.prototype.dispose=
function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._glyphData.length=0};a.prototype._initDecorationGlyph=function(){for(var a=[117,149,181,207,207,181,149,117],b=[],c=0;c<a.length;c++)for(var d=a[c],f=0;11>f;f++)b.push(d);a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(b)};this._recordGlyph(a)};a.prototype.getGlyphItems=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f=
this;return e.__generator(this,function(e){switch(e.label){case 0:return d=this._getGlyphCache(a),[4,this._fetchRanges(a,b,c)];case 1:return e.sent(),[2,b.map(function(b){return f._getMosaicItem(d,a,b)})]}})})};a.prototype.bind=function(a,b,c,d){var f=this._getTexture(a,c);f.setSamplingMode(b);this._dirties[c]&&(f.setData(this._glyphData[c]),this._dirties[c]=!1);a.bindTexture(f,d)};a.prototype._getGlyphCache=function(a){this._glyphCache[a]||(this._glyphCache[a]={});return this._glyphCache[a]};a.prototype._getTexture=
function(a,b){this._textures[b]||(this._textures[b]=new f.Texture(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[b]};a.prototype._invalidate=function(){this._dirties[this._currentPage]=!0};a.prototype._fetchRanges=function(a,c,d){return e.__awaiter(this,void 0,void 0,function(){var f,g,l=this;return e.__generator(this,function(e){switch(e.label){case 0:return f=b(c),g=[],f.forEach(function(b){g.push(l._fetchRange(a,
b,d))}),[4,h.all(g)];case 1:return e.sent(),[2]}})})};a.prototype._fetchRange=function(a,b,d){return e.__awaiter(this,void 0,void 0,function(){var f,h=this;return e.__generator(this,function(e){if(256<b)return[2,null];f=a+b;return[2,c(this._rangePromises,f,function(){return h._glyphSource.getRange(a,b,d)})]})})};a.prototype._getMosaicItem=function(a,b,c){if(!a[c]){b=this._glyphSource.getGlyph(b,c);if(!b||!b.metrics)return{rect:new n.default(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,
top:0},code:c,sdf:!0};var d=this._recordGlyph(b);a[c]={rect:d,page:this._currentPage,metrics:b.metrics,code:c,sdf:!0};this._invalidate()}return a[c]};a.prototype._getMosaicItemsStable=function(a,b,c){var d=this,f=[],e=c.map(function(a){return a});c.map(function(a){return a}).sort().map(function(c){return d._getMosaicItem(a,b,c)}).forEach(function(a){var b=e.indexOf(a.code);f[b]=a;e[b]=null});return f};a.prototype._recordGlyph=function(a){var b=a.metrics;if(0===b.width)b=new n.default(0,0,0,0);else{var c=
b.width+6,f=b.height+6,b=this._binPack.allocate(c,f);b.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new d(this.width-4,this.height-4),b=this._binPack.allocate(c,f));var e=this._glyphData[this._currentPage];a=a.bitmap;var h=void 0,g=void 0;if(a)for(var p=0;p<f;p++)for(var h=
c*p,g=this.width*(b.y+p)+b.x,q=0;q<c;q++)e[g+q]=a[h+q];k("esri-glyph-debug")&&this._showDebugPage(e)}return b};a.prototype._showDebugPage=function(a){var b=document.createElement("canvas"),c=b.getContext("2d"),d=new ImageData(this.width,this.height),f=d.data;b.width=this.width;b.height=this.height;b.style.border="1px solid black";for(var e=0;e<a.length;++e)f[4*e+0]=a[e],f[4*e+1]=0,f[4*e+2]=0,f[4*e+3]=255;c.putImageData(d,0,0);document.body.appendChild(b)};return a}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,f,g){void 0===a&&(a=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);this.x=a;this.y=e;this.width=f;this.height=g}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!1,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,
a.height)};return a}();a.default=g})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(g,a,e){return function(){function a(a,f){this._height=this._width=0;this._free=[];this._width=a;this._height=f;this._free.push(new e.default(0,0,a,f))}Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0});
a.prototype.allocate=function(a,f){if(a>this._width||f>this._height)return new e.default;for(var h=null,d=-1,b=0;b<this._free.length;++b){var c=this._free[b];a<=c.width&&f<=c.height&&(null===h||c.y<=h.y&&c.x<=h.x)&&(h=c,d=b)}if(null===h)return new e.default;this._free.splice(d,1);h.width<h.height?(h.width>a&&this._free.push(new e.default(h.x+a,h.y,h.width-a,f)),h.height>f&&this._free.push(new e.default(h.x,h.y+f,h.width,h.height-f))):(h.width>a&&this._free.push(new e.default(h.x+a,h.y,h.width-a,h.height)),
h.height>f&&this._free.push(new e.default(h.x,h.y+f,a,h.height-f)));return new e.default(h.x,h.y,a,f)};a.prototype.release=function(a){for(var f=0;f<this._free.length;++f){var e=this._free[f];if(e.y===a.y&&e.height===a.height&&e.x+e.width===a.x)e.width+=a.width;else if(e.x===a.x&&e.width===a.width&&e.y+e.height===a.y)e.height+=a.height;else if(a.y===e.y&&a.height===e.height&&a.x+a.width===e.x)e.x=a.x,e.width+=a.width;else if(a.x===e.x&&a.width===e.width&&a.y+a.height===e.y)e.y=a.y,e.height+=a.height;
else continue;this._free.splice(f,1);this.release(a)}this._free.push(a)};return a}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports tslib ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),function(g,a,e,k,h,f){var n=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),d=void 0,f=void 0,e=void 0,h=void 0,g=void 0,
k=void 0,p=void 0;c.next();)switch(c.tag()){case 1:d=c.getUInt32();break;case 2:f=c.getBytes();break;case 3:e=c.getUInt32();break;case 4:h=c.getUInt32();break;case 5:g=c.getSInt32();break;case 6:k=c.getSInt32();break;case 7:p=c.getUInt32();break;default:c.skip()}c.release();d&&(this._metrics[d]={width:e,height:h,left:g,top:k,advance:p},this._bitmaps[d]=f);break;default:b.skip()}b.release();break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};
return a}(),d=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function a(a){this._glyphInfo={};this._baseURL=a}a.prototype.getRange=function(a,b,d){var c=this._getFontStack(a);if(c.getRange(b))return f.resolve();var g=256*b,m=g+255;a=this._baseURL.replace("{fontstack}",a).replace("{range}",g+"-"+m);return k(a,e.__assign({responseType:"array-buffer"},d)).then(function(a){c.addRange(b,
new n(new h(new Uint8Array(a.data),new DataView(a.data))))})};a.prototype.getGlyph=function(a,b){if(a=this._getFontStack(a)){var c=Math.floor(b/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}};a.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new d);return b};return a}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils",
"./packingUtils"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){this.size=a;var d=document.createElement("canvas");d.width=d.height=a;this._context=d.getContext("2d");this._gridOuter=new Float64Array(a*a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=
this._v=null;this._svg&&(document.body.removeChild(this._svg),this._svg=null)};a.prototype.draw=function(a,d,b){var c=this;void 0===b&&(b=31);this._initSVG();var f=this._createSVGString(a);return e.create(function(a,e){var g=new Image;g.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(f);g.onload=function(){g.onload=null;c._context.clearRect(0,0,c.size,c.size);c._context.drawImage(g,0,0,c.size,c.size);for(var d=c._context.getImageData(0,0,c.size,c.size),f=new Uint8Array(c.size*c.size*
4),e=0;e<c.size*c.size;e++){var m=d.data[4*e+3]/255;c._gridOuter[e]=1===m?0:0===m?1E20:Math.pow(Math.max(0,.5-m),2);c._gridInner[e]=1===m?1E20:0===m?0:Math.pow(Math.max(0,m-.5),2)}c._edt(c._gridOuter,c.size,c.size);c._edt(c._gridInner,c.size,c.size);for(e=0;e<c.size*c.size;e++)h.packFloatRGBA(.5-(c._gridOuter[e]-c._gridInner[e])/(2*b),f,4*e);a(f)};var m=d&&d.signal;if(m)k.onAbort(m,function(){return e(k.createAbortError())})})};a.prototype._initSVG=function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg",
"svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",a);this._svg.appendChild(d);a=d.getBBox();var b=a.width/a.height,c=this.size/2,f,e,h;1<b?(e=f=c/a.width,h=this.size/4,b=c-1/b*c/2):(f=e=c/a.height,
h=c-c*b/2,b=this.size/4);d.setAttribute("style","transform: matrix("+f+", 0, 0, "+e+", "+(-a.x*f+h)+", "+(-a.y*e+b)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(d);return a};a.prototype._edt=function(a,d,b){for(var c=this._f,f=this._d,e=this._v,h=this._z,g=0;g<d;g++){for(var m=0;m<b;m++)c[m]=a[m*d+g];this._edt1d(c,f,e,h,b);for(m=0;m<b;m++)a[m*d+g]=f[m]}for(m=
0;m<b;m++){for(g=0;g<d;g++)c[g]=a[m*d+g];this._edt1d(c,f,e,h,d);for(g=0;g<d;g++)a[m*d+g]=Math.sqrt(f[g])}};a.prototype._edt1d=function(a,d,b,c,f){b[0]=0;c[0]=-1E20;c[1]=1E20;for(var e=1,h=0;e<f;e++){for(var g=(a[e]+e*e-(a[b[h]]+b[h]*b[h]))/(2*e-2*b[h]);g<=c[h];)h--,g=(a[e]+e*e-(a[b[h]]+b[h]*b[h]))/(2*e-2*b[h]);h++;b[h]=e;c[h]=g;c[h+1]=1E20}for(h=e=0;e<f;e++){for(;c[h+1]<e;)h++;d[e]=(e-b[h])*(e-b[h])+a[b[h]]}};return a}();a.default=g})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require",
"exports"],function(g,a){function e(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});a.packFloatRGBA=void 0;var k=[1,256,65536,16777216],h=[1/256,1/65536,1/16777216,1/4294967296],f=function(a,d){void 0===d&&(d=0);for(var b=0,c=0;4>c;c++)b+=a[d+c]*h[c];return b}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,d,b){void 0===b&&(b=0);a=0>a?0:a>f?f:a;for(var c=0;4>c;c++)d[b+c]=Math.floor(256*e(a*k[c]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/Error ../../../../core/has ../../../../core/maybe ../../../webgl ./definitions ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),
function(g,a,e,k,h,f,n,d,b,c){function q(a){return a&&"static"===a.type}return function(){function a(a,b,d,f){void 0===f&&(f=0);this._mosaicPages=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=k("fix-sprite-locations");this._testId=k("test-id");this._pageHeight=this._pageWidth=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=b||0>=d)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=b;this._pageHeight=
d;this._requestRender=a;0<f&&(this._maxItemSize=f);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){a=[];for(var e in this._fixSpriteLocationsTable[this._testId])b=this._fixSpriteLocationsTable[this._testId][e],a[b.page]=b.pageSize;for(e=0;e<a.length;e++)b=a[e],this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(b[0]*b[1])},size:[b[0],b[1]],dirty:!0,texture:void 0})}this._binPack=new c(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}a.prototype.getWidth=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[0]};a.prototype.getHeight=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[1]};a.prototype.getPageTexture=function(a){return a<this._mosaicPages.length?this._mosaicPages[a].texture:null};a.prototype.has=function(a){return this._mosaicRects.has(a)};
Object.defineProperty(a.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!1,configurable:!0});a.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};a.prototype.addSpriteItem=function(a,c,d,f,e,h){var g;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var m,l;q(d)?this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&this._fixSpriteLocationsTable[this._testId][a]?(g=this._fixSpriteLocationsTable[this._testId][a],m=g.rect,
l=g.page,g=g.pageSize):(g=this._allocateImage(c[0],c[1]),m=g[0],l=g[1],g=g[2]):(m=new b.default(0,0,c[0],c[1]),l=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:d,size:c,dirty:!0,texture:void 0}));if(0>=m.width||0>=m.height)return null;h={rect:m,width:c[0],height:c[1],sdf:e,simplePattern:h,pixelRatio:1,page:l};this._mosaicRects.set(a,h);q(d)&&this._copy({rect:m,spriteSize:c,spriteData:d.data,page:l,pageSize:g,repeat:f,sdf:e});return h};a.prototype.hasItemsToProcess=function(){return 0!==
this._spriteCopyQueue.length};a.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};a.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};a.prototype.getMosaicItemPosition=function(a){var b=(a=this.getSpriteItem(a))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;var c=n.SPRITE_PADDING,d=this._mosaicPages[a.page];return{size:[a.width,a.height],tl:[(b.x+c)/d[0],(b.y+c)/d[1]],br:[(b.x+
c+a.width)/d[0],(b.y+c+a.height)/d[1]],page:a.page}};a.prototype.bind=function(a,b,c,d){void 0===c&&(c=0);void 0===d&&(d=0);c=this._mosaicPages[c];var e=c.mosaicsData,g=c.texture;g||(g=c.size,g=q(e)?new f.Texture(a,{pixelFormat:6408,dataType:5121,width:g[0],height:g[1]},new Uint8Array(e.data.buffer)):new f.Texture(a,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:g[0],height:g[1]},null),c.texture=g);g.setSamplingMode(b);q(e)?(a.bindTexture(g,d),c.dirty&&(g.setData(new Uint8Array(e.data.buffer)),
g.generateMipmap())):(b=e.data,e=b.bindFrame(a,g,d),h.isSome(this._requestRender)&&e&&0<b.frameCount&&this._requestRender.requestRender(),b.bindFrame(a,g,d));c.dirty=!1};a._copyBits=function(a,b,c,d,f,e,h,g,k,q,n){var m=d*b+c;h=g*e+h;if(n)for(h-=e,n=-1;n<=q;n++,m=((n+q)%q+d)*b+c,h+=e)for(g=-1;g<=k;g++)f[h+g]=a[m+(g+k)%k];else for(n=0;n<q;n++){for(g=0;g<k;g++)f[h+g]=a[m+g];m+=b;h+=e}};a.prototype._copy=function(b){if(!(b.page>=this._mosaicPages.length)){var c=this._mosaicPages[b.page],d=c.mosaicsData;
if(!q(c.mosaicsData))throw new e("mapview-invalid-resource","unsuitable data type!");var f=b.spriteData;(d=d.data)&&f||console.error("Source or target images are uninitialized!");a._copyBits(f,b.spriteSize[0],0,0,d,b.pageSize[0],b.rect.x+n.SPRITE_PADDING,b.rect.y+n.SPRITE_PADDING,b.spriteSize[0],b.spriteSize[1],b.repeat);c.dirty=!0}};a.prototype._allocateImage=function(a,f){a+=2*n.SPRITE_PADDING;f+=2*n.SPRITE_PADDING;var e=Math.max(a,f);if(this._maxItemSize&&this._maxItemSize<e){var e=Math.pow(2,
Math.ceil(d.log2(a))),h=Math.pow(2,Math.ceil(d.log2(f)));a=new b.default(0,0,a,f);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(e*h)},size:[e,h],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-1,[e,h]]}e=this._binPack.allocate(a,f);return 0>=e.width?(e=this._mosaicPages[this._currentPage],!e.dirty&&q(e.mosaicsData)&&(e.mosaicsData=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*
this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new c(this._pageWidth,this._pageHeight),this._allocateImage(a,f)):[e,this._currentPage,[this._pageWidth,this._pageHeight]]};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._mosaicPages;a<b.length;a++){var c=b[a],d=c.texture;d&&d.dispose();c=c.mosaicsData;q(c)||c.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["require",
"exports","tslib","../../../../../core/Error","../../../../../core/promiseUtils"],function(g,a,e,k,h){function f(a){var b=a.constructor===Uint8Array?a:new Uint8Array(a);return w.some(function(a,c){return a!==b[c]})?!1:!0}function n(a,b){var f=new Uint8Array(b);if(w.some(function(a,b){return a!==f[b]}))return v;var e=!1;d(f,function(a){return!(e="acTL"===a)});if(!e)return l;var h=[],g=[],m=null,k=null,r=0;d(f,function(b,d,f,e){var l=new DataView(d.buffer);switch(b){case "IHDR":m=d.subarray(f+8,f+8+
e);a.width=l.getUint32(f+8);a.height=l.getUint32(f+12);break;case "acTL":a.numPlays=l.getUint32(f+8+4);break;case "fcTL":k&&(a.frames.push(k),r++);k=new p;k.width=l.getUint32(f+8+4);k.height=l.getUint32(f+8+8);k.left=l.getUint32(f+8+12);k.top=l.getUint32(f+8+16);b=l.getUint16(f+8+20);d=l.getUint16(f+8+22);0===d&&(d=100);k.delay=1E3*b/d;10>=k.delay&&(k.delay=100);a.playTime+=k.delay;k.disposeOp=l.getUint8(f+8+24);k.blendOp=l.getUint8(f+8+25);k.dataParts=[];0===r&&2===k.disposeOp&&(k.disposeOp=1);break;
case "fdAT":k&&k.dataParts.push(d.subarray(f+8+4,f+8+e));break;case "IDAT":k&&k.dataParts.push(d.subarray(f+8,f+8+e));break;case "IEND":g.push(c(d,f,12+e));break;default:h.push(c(d,f,12+e))}});if(0===a.frames.length)return l;a.frameCount=a.frames.length;var n=new Blob(h),z=new Blob(g);a.frames.forEach(function(a){var b=[];b.push(w);m.set(u(a.width),0);m.set(u(a.height),4);b.push(q("IHDR",m));b.push(n);a.dataParts.forEach(function(a){return b.push(q("IDAT",a))});b.push(z);a.data=new Blob(b,{type:"image/png"});
delete a.dataParts;b=null});return a}function d(a,b){var c=new DataView(a.buffer),d=8,f,e,h;do e=c.getUint32(d),f=d+4,f=Array.prototype.slice.call(a.subarray(f,f+4)),f=String.fromCharCode.apply(String,f),h=b(f,a,d,e),d+=12+e;while(!1!==h&&"IEND"!==f&&d<a.length)}function b(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}function c(a,b,c){var d=new Uint8Array(c);d.set(a.subarray(b,b+c));return d}function q(a,c){var d=a.length+c.length,f=new Uint8Array(d+8),e=
new DataView(f.buffer);e.setUint32(0,c.length);f.set(b(a),4);f.set(c,8);var h=4,g=d;void 0===h&&(h=0);void 0===g&&(g=f.length-h);a=-1;c=h;for(h+=g;c<h;c++)a=a>>>8^t[(a^f[c])&255];e.setUint32(d+4,a^-1);return f}function u(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])}Object.defineProperty(a,"__esModule",{value:!0});a.isAnimatedPNG=a.getPNGSize=a.isPNG=void 0;var t=new Uint32Array(256);for(g=0;256>g;g++){for(var r=g,m=0;8>m;m++)r=0!==(r&1)?3988292384^r>>>1:r>>>1;t[g]=r}var v=new k("Not a PNG"),
l=new k("Not an animated PNG"),w=new Uint8Array([137,80,78,71,13,10,26,10]);a.isPNG=f;a.getPNGSize=function(a){a=new Uint8Array(a);var b,c;d(a,function(a,d,f){d=new DataView(d.buffer);"IHDR"===a&&(b=d.getUint32(f+8),c=d.getUint32(f+12))});return[b,c]};a.isAnimatedPNG=function(a){a=new Uint8Array(a);if(!f(a))return!1;var b=!1;d(a,function(a){return!(b="acTL"===a)});return b};g=function(){function a(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=
1;this.currentFrameNumber=0;this._lastUsedFrame=-1}a.create=function(b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:d=new a,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,d._load(b,c)];case 2:return e.sent(),[3,4];case 3:return f=e.sent(),h.isAbortError(f)?[3,4]:[2,new k("invalid-resource","Could not load PNG: "+f.message)];case 4:return[2,d]}})})};a.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,
this._play())};a.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};a.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};a.prototype.bindFrame=function(a,b,c){a.bindTexture(b,c);a=this.frameChanged();if(!a)return!1;c=this.currentFrame;var d=c.frameData,f=b.descriptor;(c.left||c.top||c.width!==f.width||c.height!==f.height)&&b.setData(null);b.updateData(0,c.left,c.top,c.width,c.height,d);this.updateUsedFrame();return a};a.prototype.frameChanged=
function(){return this._lastUsedFrame!==this.currentFrameNumber};a.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};a.prototype._load=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var b,c,d=this;return e.__generator(this,function(f){switch(f.label){case 0:f.trys.push([0,2,,3]);b=n(this,a);if(b!==this)return[2,b];this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;return[4,h.all(this.frames.map(function(a){return a.createImage(d._resizeCanvas)}))];
case 1:return f.sent(),[3,3];case 2:return c=f.sent(),h.isAbortError(c)?[3,3]:[2,new k("invalid-resource","Could not parse PNG")];case 3:return this.play(),[2]}})})};a.prototype._play=function(){var a=this,b;if(0===this.playSpeed)this.pause();else{0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),b=this.currentFrameNumber,--b,0>b&&(b=this.frames.length-1),b=1*-this.frames[b].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=
this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed);var c=this.frames[this.currentFrameNumber];this.currentFrame={frameData:c.imageData,top:c.top,left:c.left,width:c.width,height:c.height};this.timerID=window.setTimeout(function(){return a._play()},b)}};return a}();a.default=g;var p=function(){function a(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}a.prototype.createImage=function(a){return e.__awaiter(this,
void 0,void 0,function(){var b=this;return e.__generator(this,function(c){return null!==this.imageData?[2]:[2,h.create(function(c,d){var f=URL.createObjectURL(b.data),e=document.createElement("img");e.onload=function(){URL.revokeObjectURL(f);var d;a.width=e.width;a.height=e.height;d=a.getContext("2d");d.drawImage(e,0,0,e.width,e.height);d=d.getImageData(0,0,e.width,e.height);d=new Uint8Array(d.data);for(var h,g=0;g<d.length;g+=4)h=d[g+3]/255,d[g]*=h,d[g+1]*=h,d[g+2]*=h;d=new ImageData(new Uint8ClampedArray(d.buffer),
e.width,e.height);b.imageData=d;c()};e.onerror=function(){URL.revokeObjectURL(f);b.imageData=null;d(Error("Image creation error"))};e.src=f})]})})};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["require","exports","tslib","../../../../../core/Error","../../../../../core/promiseUtils"],function(g,a,e,k,h){function f(a){if(!a||0===a.byteLength)return!1;a=a.constructor===Uint8Array?a:new Uint8Array(a);return 71===a[0]&&73===a[1]&&70===a[2]&&56===a[3]}Object.defineProperty(a,
"__esModule",{value:!0});a.isAnimatedGIF=a.getGIFSize=a.isGIF=void 0;a.isGIF=f;a.getGIFSize=function(a){var b=new Uint8ClampedArray(a),c=6;a=b[c++]+(b[c++]<<8);b=b[c++]+(b[c++]<<8);return[a,b]};a.isAnimatedGIF=function(a){if(!a||0===a.byteLength)return!1;a=new Uint8Array(a);if(!f(a))return!1;for(var b=0,c=0,d=a.length-9;c<d&&(0!==a[c]||33!==a[c+1]||249!==a[c+2]||4!==a[c+3]||0!==a[c+8]||44!==a[c+9]&&33!==a[c+9]||(b++,!(1<b)));++c);return 1<b};g=function(){function a(){this.playing=this.paused=!1;this.waitTillDone=
!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}a.create=function(b,c){return e.__awaiter(this,void 0,void 0,function(){var d,f;return e.__generator(this,function(e){switch(e.label){case 0:d=new a,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,d._load(b,c)];case 2:return e.sent(),
[3,4];case 3:return f=e.sent(),h.isAbortError(f)?[3,4]:[2,new k("invalid-resource","Could not load PNG: "+f.message)];case 4:return[2,d]}})})};a.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};a.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};a.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};a.prototype.bindFrame=function(a,c,d){a.bindTexture(c,d);if(a=this.frameChanged())d=this.currentFrame,
c.updateData(0,0,0,d.width,d.height,d.frameData),this.updateUsedFrame();return a};a.prototype.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};a.prototype.seek=function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;for(var b=0;a>this.frames[b].time+this.frames[b].delay&&b<this.frames.length;)b+=1;this.currentFrameNumber=b;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};
a.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};a.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};a.prototype._load=function(a,c){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),this.loading=!0,[4,this._parse(a,c)];case 1:return d.sent(),this.loading=!1,this.play(),[3,3];case 2:return b=d.sent(),h.isAbortError(b)?[3,3]:[2,new k("invalid-resource",
"Could not parse gif!")];case 3:return[2]}})})};a.prototype._parse=function(a,c){var b=this,d=new n(a);d.pos+=6;this.width=d.data[d.pos++]+(d.data[d.pos++]<<8);this.height=d.data[d.pos++]+(d.data[d.pos++]<<8);a=d.data[d.pos++];this.globalColourCount=1<<(a&7)+1;d.pos++;d.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,d));return h.create(function(a,f){setTimeout(function(){return b._parseBlock(d,a,f,c)},0)})};a.prototype._parseBlock=function(a,c,d,f){return e.__awaiter(this,
void 0,void 0,function(){var b,g=this;return e.__generator(this,function(e){if(f&&f.signal&&h.isAborted(f.signal))return d(h.createAbortError()),[2];b=a.data[a.pos++];if(44===b){if(this._parseImg(a),this.firstFrameOnly)return this._finishedLoading(),c(),[2]}else{if(59===b)return this._finishedLoading(),c(),[2];this._parseExt(a)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:a.pos,totalBytes:a.data.length,frame:this.frames.length});setTimeout(function(){return g._parseBlock(a,c,
d,f)},0);return[2]})})};a.prototype._parseColourTable=function(a,c){for(var b=[],d=0;d<a;d++)b.push([c.data[c.pos++],c.data[c.pos++],c.data[c.pos++]]);return b};a.prototype._parseImg=function(a){var b={};this.frames.push(b);b.disposalMethod=this.disposalMethod;b.time=this.length;b.delay=10*this.delayTime;this.length+=b.delay;b.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;b.leftPos=a.data[a.pos++]+(a.data[a.pos++]<<8);b.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);b.width=
a.data[a.pos++]+(a.data[a.pos++]<<8);b.height=a.data[a.pos++]+(a.data[a.pos++]<<8);var d=a.data[a.pos++];b.localColourTableFlag=d&128?!0:!1;b.localColourTableFlag&&(b.localColourTable=this._parseColourTable(1<<(d&7)+1,a));this.pixelBufSize!==b.width*b.height&&(this.pixelBuf=new Uint8Array(b.width*b.height),this.pixelBufSize=b.width*b.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());if(d&64){b.interlaced=!0;a=b.width;d=this.pixelBufSize/a;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=
new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);for(var f=0,e=0;4>e;e++)for(var h=this.interlaceOffsets[e];h<d;h+=this.interlaceSteps[e])this.deinterlaceBuf.set(this.pixelBuf.subarray(f,f+a),h*a),f+=a}else b.interlaced=!1;this._processFrame(b)};a.prototype._lzwDecode=function(a,c){var b,d,f,e,h,g,l,k,p,n;f=d=0;var z=[];e=1<<a;h=e+1;g=a+1;for(n=!1;!n;){k=l;for(b=l=0;b<g;b++)c[f>>3]&1<<(f&7)&&(l|=1<<b),f++;if(l===e){z=[];g=a+1;for(b=0;b<e;b++)z[b]=[b];z[e]=[];z[h]=null}else{if(l===
h){n=!0;break}l>=z.length?z.push(z[k].concat(z[k][0])):k!==e&&z.push(z[k].concat(z[l][0]));k=z[l];p=k.length;for(b=0;b<p;b++)this.pixelBuf[d++]=k[b];z.length===1<<g&&12>g&&g++}}};a.prototype._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=this.width;a.image.height=this.height;a.ctx=a.image.getContext("2d");var b=a.localColourTableFlag?a.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=a);var d=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?
!0:!1;d||a.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);for(var f=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),e=a.transparencyIndex,h=f.data,g=a.interlaced?this.deinterlaceBuf:this.pixelBuf,k=g.length,l=0,n,p,y=0;y<k;y++)n=g[y],p=b[n],e!==n?(h[l++]=p[0],h[l++]=p[1],h[l++]=p[2],h[l++]=255):(d&&(h[l+3]=0),l+=4);a.ctx.putImageData(f,a.leftPos,a.topPos);this.lastFrame=a};a.prototype._parseExt=function(a){var b=a.data[a.pos++];249===b?this._parseGCExt(a):254===b?this.comment+=
a.readSubBlocks():255===b?this._parseAppExt(a):(1===b&&(a.pos+=13),a.readSubBlocks())};a.prototype._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};a.prototype._parseGCExt=function(a){var b;a.pos++;b=a.data[a.pos++];this.disposalMethod=(b&28)>>2;this.transparencyGiven=b&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=a.data[a.pos++];a.pos++};a.prototype._finishedLoading=function(){this.loading=!1;this.frameCount=
this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};a.prototype._play=function(){var a=this,c;0===this.playSpeed?this.pause():(0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=
this.frames.length-1),c=this.currentFrameNumber,--c,0>c&&(c=this.frames.length-1),c=1*-this.frames[c].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,c=1*this.frames[this.currentFrameNumber].delay/this.playSpeed),this._setCurrentFrame(this.currentFrameNumber),this.timerID=window.setTimeout(function(){return a._play()},c))};a.prototype._setCurrentFrame=function(a){this.currentFrame={frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};
return a}();a.default=g;var n=function(){function a(a){this.pos=0;this.data=new Uint8ClampedArray(a);this.len=this.data.length}a.prototype.getString=function(a){for(var b="";a--;)b+=String.fromCharCode(this.data[this.pos++]);return b};a.prototype.readSubBlocks=function(){var a,c,d="";do for(c=a=this.data[this.pos++];c--;)d+=String.fromCharCode(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};a.prototype.readSubBlocksB=function(){var a,c,d=[];do for(c=a=this.data[this.pos++];c--;)d.push(this.data[this.pos++]);
while(0!==a&&this.pos<this.len);return d};return a}()})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","../../../../../core/BidiEngine"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.bidiText=void 0;var k=new e.default;a.bidiText=function(a){if(!k.hasBidiChar(a))return[a,!1];var f;f="rtl"===k.checkContextual(a)?"IDNNN":"ICNNN";return[k.bidiTransform(a,f,"VLYSN"),!0]}})},"esri/core/BidiEngine":function(){define(["require","exports","./bidiEngineTables"],
function(g,a,e){function k(a,b,c,e,g){var m=a;void 0===b&&(b=g.defInFormat);void 0===c&&(c=g.defOutFormat);void 0===e&&(e=g.defSwap);if(b!==c){var l=b.substring(0,1),p=c.substring(0,1),q;q=b.substring(1,4);var r=c.substring(1,4);"C"===q.charAt(0)&&(q=h(m),q="ltr"===q||"rtl"===q?q.toUpperCase():"L"===b.charAt(2)?"LTR":"RTL",b=l+q);"C"===r.charAt(0)&&(q=h(m),"rtl"===q?r="RTL":"ltr"===q?(m=m.split(""),m.reverse(),q=h(m.join("")),r=q.toUpperCase()):r="L"===c.charAt(2)?"LTR":"RTL",c=p+r)}if(b===c)return a;
p=b.substring(0,1);m=b.substring(1,4);l=c.substring(0,1);r=c.substring(1,4);g.inFormat=b;g.outFormat=c;g.swap=e;if("L"===p&&"VLTR"===c){if("LTR"===m)return g.dir=E,f(a,g);if("RTL"===m)return g.dir=x,f(a,g)}if("V"===p&&"V"===l)return g.dir="RTL"===m?x:E,d(a,g);if("L"===p&&"VRTL"===c)return g.dir="LTR"===m?E:x,a=f(a,g),d(a);if("VLTR"===b&&"LLTR"===c)return g.dir=E,f(a,g);if("V"===p&&"L"===l&&m!==r)return a=d(a),"RTL"===m?k(a,"LLTR","VLTR",e,g):k(a,"LRTL","VRTL",e,g);if("VRTL"===b&&"LRTL"===c)return k(a,
"LRTL","VRTL",e,g);"L"===p&&"L"===l&&(b=g.swap,g.swap=b.substr(0,1)+"N","RTL"===m?(g.dir=x,a=f(a,g),g.swap="N"+b.substr(1,2),g.dir=E,a=f(a,g)):(g.dir=E,a=f(a,g),g.swap="N"+b.substr(1,2),a=k(a,"VLTR","LRTL",g.swap,g)));return a}function h(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function f(a,b){a=a.split("");var c=[];n(a,c,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,2))for(var d=0;d<a.length;d++)if(1===c[d]){var f=
d,h;b:{h=a[d];for(var g=void 0,m=0,l=e.SwapTable.length-1;m<=l;)if(g=Math.floor((m+l)/2),h<e.SwapTable[g][0])l=g-1;else if(h>e.SwapTable[g][0])m=g+1;else{h=e.SwapTable[g][1];break b}}a[f]=h}q(2,a,c,b);q(1,a,c,b);y=c;return a.join("")}function n(a,b,c){var d=a.length,f=c.dir?e.impTabRtl:e.impTabLtr,h=0,g=-1,m=[],l=[];c.hiLevel=c.dir;c.lastArabic=!1;c.hasUbatAl=!1;c.hasUbatB=!1;c.hasUbatS=!1;for(var p=0;p<d;p++){var k=p,q=a[p].charCodeAt(0),r=e.PrimaryTable[q>>8];m[k]=r<e.TBBASE?r:e.UnicodeTable[r-
e.TBBASE][q&255]}for(k=0;k<d;k++){p=u(a,m,l,k,c);l[k]=p;h=f[h][p];p=h&240;h&=15;q=f[h][C];b[k]=q;if(0<p){if(16===p)for(p=g;p<k;p++)b[p]=1;g=-1}if(f[h][B])-1===g&&(g=k);else if(-1<g){for(p=g;p<k;p++)b[p]=q;g=-1}m[k]===e.UBAT_B&&(b[k]=0);c.hiLevel|=q}if(c.hasUbatS)for(a=0;a<d;a++)if(m[a]===e.UBAT_S)for(b[a]=c.dir,f=a-1;0<=f;f--)if(m[f]===e.UBAT_WS)b[f]=c.dir;else break}function d(a,b){a=a.split("");if(b){var c=[];n(a,c,b);y=c}a.reverse();w.reverse();return a.join("")}function b(a){for(var b=0;b<e.ArabicAlefBetIntervalsBegine.length;b++)if(a>=
e.ArabicAlefBetIntervalsBegine[b]&&a<=e.ArabicAlefBetIntervalsEnd[b])return!0;return!1}function c(a,c,d,f){for(;c*d<f&&r(a[c]);)c+=d;return c*d<f&&b(a[c])?!0:!1}function q(a,b,c,d){if(!(d.hiLevel<a))if(1!==a||d.dir!==x||d.hasUbatB){d=b.length;for(var f=0,e,h,g;f<d;){if(c[f]>=a){for(e=f+1;e<d&&c[e]>=a;)e++;for(h=e-1;f<h;f++,h--)g=b[f],b[f]=b[h],b[h]=g,g=w[f],w[f]=w[h],w[h]=g;f=e}f++}}else b.reverse(),w.reverse()}function u(a,b,c,d,f){return{UBAT_L:function(){f.lastArabic=!1;return e.UBAT_L},UBAT_R:function(){f.lastArabic=
!1;return e.UBAT_R},UBAT_ON:function(){return e.UBAT_ON},UBAT_AN:function(){return e.UBAT_AN},UBAT_EN:function(){return f.lastArabic?e.UBAT_AN:e.UBAT_EN},UBAT_AL:function(){f.lastArabic=!0;f.hasUbatAl=!0;return e.UBAT_R},UBAT_WS:function(){return e.UBAT_ON},UBAT_CS:function(){var a,h;if(1>d||d+1>=b.length||(a=c[d-1])!==e.UBAT_EN&&a!==e.UBAT_AN||(h=b[d+1])!==e.UBAT_EN&&h!==e.UBAT_AN)return e.UBAT_ON;f.lastArabic&&(h=e.UBAT_AN);return h===a?h:e.UBAT_ON},UBAT_ES:function(){return(0<d?c[d-1]:e.UBAT_B)===
e.UBAT_EN&&d+1<b.length&&b[d+1]===e.UBAT_EN?e.UBAT_EN:e.UBAT_ON},UBAT_ET:function(){if(0<d&&c[d-1]===e.UBAT_EN)return e.UBAT_EN;if(f.lastArabic)return e.UBAT_ON;for(var a=d+1,h=b.length;a<h&&b[a]===e.UBAT_ET;)a++;return a<h&&b[a]===e.UBAT_EN?e.UBAT_EN:e.UBAT_ON},UBAT_NSM:function(){if("VLTR"===f.inFormat){for(var h=b.length,g=d+1;g<h&&b[g]===e.UBAT_NSM;)g++;if(g<h&&(h=a[d].charCodeAt[0],g=b[g],(1425<=h&&2303>=h||64286===h)&&(g===e.UBAT_R||g===e.UBAT_AL)))return e.UBAT_R}return 1>d||b[d-1]===e.UBAT_B?
e.UBAT_ON:c[d-1]},UBAT_B:function(){f.lastArabic=!0;f.hasUbatB=!0;return f.dir},UBAT_S:function(){f.hasUbatS=!0;return e.UBAT_ON},UBAT_LRE:function(){f.lastArabic=!1;return e.UBAT_ON},UBAT_RLE:function(){f.lastArabic=!1;return e.UBAT_ON},UBAT_LRO:function(){f.lastArabic=!1;return e.UBAT_ON},UBAT_RLO:function(){f.lastArabic=!1;return e.UBAT_ON},UBAT_PDF:function(){f.lastArabic=!1;return e.UBAT_ON},UBAT_BN:function(){return e.UBAT_ON}}[e.TYPES_NAMES[b[d]]]()}function t(a,b){for(var c=0;c<e.BaseForm.length;c++)if(a===
e.BaseForm[c])return b[c];return a}function r(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function m(a){return"L"===a?"LTR":"R"===a?"RTL":"C"===a?"CLR":"D"===a?"CRL":""}function v(a,b){for(var c=0;c<e.AlefTable.length;c++)if(a===e.AlefTable[c])return b[c];return a}function l(a,b,c,d){for(var f=0;f<a.length;f++)if(a[f]>b||!c&&a[f]===b)a[f]+=d}Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=
[];this.levels=[]}a.prototype.bidiTransform=function(a,d,f){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var h=this.sourceToTarget,g=this.targetToSource,q=a.length;w=[];y=[];for(var n=0;n<q;n++)h[n]=n,g[n]=n,w[n]=n;if(!this.checkParameters(d,f))return a;d=this.inputFormat;f=this.outputFormat;var h=a,h=z,n=m(d.charAt(1)),g=m(f.charAt(1)),u="I"===d.charAt(0)?"L":d.charAt(0),q="I"===f.charAt(0)?"L":f.charAt(0),n=u+n,g=q+g,q=d.charAt(2)+f.charAt(2);h.defInFormat=n;h.defOutFormat=g;h.defSwap=
q;a=k(a,n,g,q,h);h=!1;if("R"===f.charAt(1))h=!0;else if("C"===f.charAt(1)||"D"===f.charAt(1))h="rtl"===this.checkContextual(a);g=this.sourceToTarget=w;q=Array(g.length);for(n=0;n<g.length;n++)q[g[n]]=n;p=this.targetToSource=q;if(d.charAt(3)===f.charAt(3))h=a;else if("S"===f.charAt(3))if(d=h,f=!0,0===a.length)h="";else{void 0===d&&(d=!0);void 0===f&&(f=!0);a=String(a);a=a.split("");var x=0,g=1,h=a.length;d||(x=a.length-1,g=-1,h=1);for(var q=h,n=f,B=0,h=[],u=0;x*g<q;x+=g)if(b(a[x])||r(a[x])){var C;
if(C="\u0644"===a[x])b:{for(var F=a,A=x+g,E=g,I=q;A*E<I&&r(F[A]);)A+=E;C=" ";if(A*E<I)for(C=F[A],F=0;F<e.AlefTable.length;F++)if(e.AlefTable[F]===C){C=!0;break b}C=!1}if(C){a[x]=0===B?v(a[x+g],e.LamAlefInialTableFE):v(a[x+g],e.LamAlefMedialTableFE);x+=g;B=a;C=x;F=g;for(A=q;C*F<A&&r(B[C]);)C+=F;C*F<A&&(B[C]=" ");n&&(h[u]=x,u++);B=0}else{C=a[x];if(1===B){F=x;if(c(a,x+g,g,q))b:for(A=a[x],E=0;E<e.BaseForm.length;E++){if(A===e.BaseForm[E]){A=e.MedialForm[E];break b}}else A=t(a[x],e.FinalForm);a[F]=A}else!0===
c(a,x+g,g,q)?a[x]=t(a[x],e.InitialForm):a[x]=t(a[x],e.IsolatedForm);r(C)||(B=1);b:{for(F=0;F<e.StandAlonForm.length;F++)if(e.StandAlonForm[F]===C){C=!0;break b}C=!1}!0===C&&(B=0)}}else B=0;g="";for(q=0;q<a.length;q++){if(n=f){b:{for(n=0;n<h.length;n++)if(h[n]===q)break b;n=-1}n=-1<n}n?(l(p,q,!d,-1),w.splice(q,1)):g+=a[q]}h=g}else if(d=a,f=h,a=!0,0===d.length)h="";else for(void 0===a&&(a=!0),void 0===f&&(f=!0),d=String(d),h="",g=d.split(""),q=0;q<d.length;q++)n=!1,"\ufe70"<=g[q]&&"\ufeff">g[q]?(u=
d.charCodeAt(q),"\ufef5"<=g[q]&&"\ufefc">=g[q]?(f?(0<q&&a&&" "===g[q-1]?h=h.substring(0,h.length-1)+"\u0644":(h+="\u0644",n=!0),h+=e.AlefTable[(u-65269)/2]):(h+=e.AlefTable[(u-65269)/2],h+="\u0644",q+1<d.length&&a&&" "===g[q+1]?q++:n=!0),n&&(l(p,q,!0,1),w.splice(q,0,w[q]))):h+=e.FETo06Table[u-65136]):h+=g[q];this.sourceToTarget=w;this.targetToSource=p;this.levels=y;return h};a.prototype._inputFormatSetter=function(a){if(!A.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=a};a.prototype._outputFormatSetter=function(a){if(!A.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a};a.prototype.checkParameters=function(a,b){a?this._inputFormatSetter(a):a=this.inputFormat;b?this._outputFormatSetter(b):b=this.outputFormat;return a===b?!1:!0};a.prototype.checkContextual=function(a){a=h(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(J){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a};a.prototype.hasBidiChar=
function(a){return F.test(a)};return a}();a.default=g;var w=[],p=[],y=[],z={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},C=5,B=6,E=0,x=1,A=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,F=/[\u0591-\u06ff\ufb1d-\ufefc]/})},"esri/core/bidiEngineTables":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.UnicodeTable=a.PrimaryTable=
a.TBBASE=a.TYPES_NAMES=a.UBAT_BN=a.UBAT_RLO=a.UBAT_LRO=a.UBAT_PDF=a.UBAT_RLE=a.UBAT_LRE=a.UBAT_NSM=a.UBAT_ET=a.UBAT_ES=a.UBAT_CS=a.UBAT_WS=a.UBAT_AL=a.UBAT_S=a.UBAT_B=a.UBAT_ON=a.UBAT_AN=a.UBAT_EN=a.UBAT_R=a.UBAT_L=a.impTabRtl=a.impTabLtr=a.ArabicAlefBetIntervalsEnd=a.ArabicAlefBetIntervalsBegine=a.FETo06Table=a.StandAlonForm=a.InitialForm=a.MedialForm=a.FinalForm=a.IsolatedForm=a.BaseForm=a.LamAlefMedialTableFE=a.LamAlefInialTableFE=a.AlefTable=a.SwapTable=void 0;a.SwapTable=[["(",")"],[")","("],
["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];a.AlefTable=["\u0622","\u0623",
"\u0625","\u0627"];a.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];a.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];a.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");a.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");
a.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");a.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
a.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");a.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");a.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
a.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];a.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];a.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];a.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];a.UBAT_L=0;a.UBAT_R=1;a.UBAT_EN=2;a.UBAT_AN=3;a.UBAT_ON=4;a.UBAT_B=5;a.UBAT_S=6;a.UBAT_AL=7;a.UBAT_WS=8;a.UBAT_CS=9;a.UBAT_ES=10;a.UBAT_ET=11;a.UBAT_NSM=12;a.UBAT_LRE=13;a.UBAT_RLE=14;a.UBAT_PDF=15;a.UBAT_LRO=16;
a.UBAT_RLO=17;a.UBAT_BN=18;a.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");a.TBBASE=100;g=a.UBAT_L;var e=a.UBAT_R,k=a.UBAT_EN,h=a.UBAT_AN,f=a.UBAT_ON,n=a.UBAT_B,d=a.UBAT_S,b=a.UBAT_AL,c=a.UBAT_WS,q=a.UBAT_CS,u=a.UBAT_ES,t=a.UBAT_ET,r=a.UBAT_NSM,m=a.UBAT_LRE,v=a.UBAT_RLE,l=a.UBAT_PDF,w=a.UBAT_LRO,p=a.UBAT_RLO,y=a.UBAT_BN;a.PrimaryTable=[a.TBBASE+0,g,g,g,g,a.TBBASE+1,
a.TBBASE+2,a.TBBASE+3,e,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a.TBBASE+4,f,f,f,g,f,g,f,g,f,f,f,g,g,f,f,g,g,g,g,g,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,g,g,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,g,g,f,f,g,g,f,f,g,g,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,
f,f,f,f,f,g,g,g,a.TBBASE+5,b,b,a.TBBASE+6,a.TBBASE+7];a.UnicodeTable=[[y,y,y,y,y,y,y,y,y,d,n,d,c,n,y,y,y,y,y,y,y,y,y,y,y,y,y,y,n,n,n,d,c,f,f,t,t,t,f,f,f,f,f,u,q,u,q,q,k,k,k,k,k,k,k,k,k,k,q,f,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,f,y,y,y,y,y,y,n,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,q,f,t,t,t,t,f,f,f,f,g,f,f,y,f,f,t,t,k,k,f,g,f,f,f,k,g,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,
f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,f,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,g,g,g,g,g,g,g,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,g,f,f,f,f,f,f,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,e,r,e,r,r,e,r,r,e,r,f,f,f,f,f,f,f,f,e,
e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,f,f,f,f,f,e,e,e,e,e,f,f,f,f,f,f,f,f,f,f,f],[h,h,h,h,f,f,f,f,b,t,t,b,q,b,f,f,r,r,r,r,r,r,r,r,r,r,r,b,f,f,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,h,h,h,h,h,h,h,h,h,h,t,h,h,b,b,b,r,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,
b,b,b,b,b,b,b,b,b,b,b,r,r,r,r,r,r,r,h,f,r,r,r,r,r,r,b,b,r,r,f,r,r,r,r,b,b,k,k,k,k,k,k,k,k,k,k,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,f,b,b,r,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,f,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,r,r,r,r,r,r,r,r,r,r,r,b,f,f,f,f,f,f,f,f,f,f,f,f,f,f,e,e,e,e,e,
e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,r,r,r,r,r,r,r,r,r,e,e,f,f,f,f,e,f,f,f,f,f],[c,c,c,c,c,c,c,c,c,c,c,y,y,y,g,e,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,c,n,m,v,l,w,p,q,t,t,t,t,t,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,q,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,c,y,y,y,y,y,f,f,f,f,f,y,y,y,y,y,y,k,g,f,f,k,k,k,k,k,k,u,u,f,f,f,g,k,k,k,k,k,k,k,k,k,k,u,u,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,f,f,f,f,f,
f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f],[g,g,g,g,g,g,g,f,f,f,f,f,f,f,f,f,f,f,f,g,g,g,g,g,f,f,f,f,f,e,r,e,e,e,e,e,e,e,e,e,e,u,e,e,e,e,e,e,e,e,e,e,e,e,e,f,e,e,e,e,e,f,e,f,e,e,f,e,e,f,e,e,e,e,e,e,e,e,e,e,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,
b,b,b,b,b,b,b,b,b,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,r,r,r,r,r,r,r,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,q,f,q,f,f,q,f,f,f,f,f,f,f,f,f,t,f,f,u,u,f,f,f,f,f,t,t,f,f,f,f,f,b,b,b,b,b,f,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,
b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,f,f,y],[f,f,f,t,t,t,f,f,f,f,f,u,q,u,q,q,k,k,k,k,k,k,k,k,k,k,q,f,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,f,f,f,f,f,f,f,f,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,f,f,f,g,g,g,g,g,g,f,f,g,g,g,g,g,g,f,f,g,g,g,g,g,g,f,f,g,g,g,f,f,f,t,t,f,f,f,t,t,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f]]})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.ok=void 0;a.ok=function(a,h){return a&&"name"in a?(h&&h.error(new e(a.name,a.message,a.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.keyFromSymbol=void 0;a.keyFromSymbol=function(a){switch(a.type){case "esriSMS":return a.style+"."+a.path;case "esriSLS":return a.style+"."+a.cap;case "esriSFS":return""+a.style;case "esriPFS":case "esriPMS":return a.imageData?a.imageData:""+a.url+a.width+a.height;default:return a.mosaicHash?a.mosaicHash:JSON.stringify(a)}}})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports tslib ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),
function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.AnimationEffect=void 0;g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=[];b._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:{a_position:0}};return b}e.__extends(b,a);b.prototype.dispose=function(){this._quad&&this._quad.dispose()};b.prototype.bind=function(){};b.prototype.unbind=function(){};b.prototype.draw=function(a,b){if(b.size){var c=a.context,d=a.renderingOptions;this._quad||
(this._quad=new f(c,[0,0,1,0,0,1,1,1]));var e=c.getBoundFramebufferObject(),g=c.getViewport(),q=g.x,l=g.y,n=g.width,g=g.height;b.bindTextures(c);var p=b.getBlock(h.ATTRIBUTE_DATA_ANIMATION);if(!k.isNone(p)){var y=p.getFBO(c),p=p.getFBO(c,1);c.setViewport(0,0,b.size,b.size);this._computeDelta(a,p,d.labelsAnimationTime);this._updateAnimationState(a,p,y);c.bindFramebuffer(e);c.setViewport(q,l,n,g)}}};b.prototype._computeDelta=function(a,b,d){var c=a.context,f=a.displayLevel,e=a.painter.materialManager.getProgram(a,
this._desc,["delta"]);c.bindFramebuffer(b);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(e);e.setUniform1i("u_maskTexture",h.TEXTURE_BINDING_ATTRIBUTE_DATA_0);e.setUniform1i("u_sourceTexture",h.TEXTURE_BINDING_ATTRIBUTE_DATA_1);e.setUniform1f("u_timeDelta",a.deltaTime);e.setUniform1f("u_animationTime",d/1E3);e.setUniform1f("u_zoomLevel",Math.round(10*f));this._quad.draw()};b.prototype._updateAnimationState=function(a,b,d){var c=a.context;a=a.painter.materialManager.getProgram(a,
this._desc,["update"]);c.bindTexture(b.colorTexture,1);c.bindProgram(a);a.setUniform1i("u_sourceTexture",1);c.bindFramebuffer(d);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._quad.draw()};return b}(n.Effect);a.AnimationEffect=g})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.Effect=void 0;g=function(){return function(){this.name=this.constructor.name}}();a.Effect=g})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../webgl ../enums ../VertexStream ../shaders/BlendPrograms".split(" "),
function(g,a,e,k,h,f,n,d,b){Object.defineProperty(a,"__esModule",{value:!0});a.BlendEffect=void 0;var c=k.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");g=function(){function a(){this._size=[0,0]}a.prototype.dispose=function(a){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._programCache&&(this._programCache.dispose(),this._programCache=null);this._quad&&(this._quad.dispose(),this._quad=null)};a.prototype.draw=function(a,d,
f,h,g){var m=a.context,k=a.drawPhase;this._setupShader(m);h&&"normal"!==h&&k!==n.WGLDrawPhase.LABEL?this._drawBlended(a,d,f,h,g):(a=this._programCache.getProgram(b.blend,"normal"))?(m.bindProgram(a),d.setSamplingMode(f),m.bindTexture(d,0),a.setUniform1i("u_layerTexture",0),a.setUniform1f("u_opacity",g),m.setBlendingEnabled(!0),m.setBlendFunction(1,771),d=this._quad,d.draw(),d.unbind()):c.error(new e("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'))};a.prototype._drawBlended=
function(a,d,f,g,k){var m=a.context,q=a.pixelRatio,p=a.inFadeTransition,r=a.state.size,n=m.getBoundFramebufferObject(),v;h.isSome(n)?(q=n.descriptor,v=q.width,q=q.height):(v=Math.round(q*r[0]),q=Math.round(q*r[1]));this._createOrResizeTexture(a,v,q);a=this._backBufferTexture;n.copyToTexture(0,0,v,q,0,0,a);m.setStencilTestEnabled(!1);m.setStencilWriteMask(0);m.setBlendingEnabled(!0);m.setDepthTestEnabled(!1);m.setDepthWriteEnabled(!1);(n=this._programCache.getProgram(b.blend,g))?(m.bindProgram(n),
a.setSamplingMode(f),m.bindTexture(a,0),n.setUniform1i("u_backbufferTexture",0),d.setSamplingMode(f),m.bindTexture(d,1),n.setUniform1i("u_layerTexture",1),n.setUniform1f("u_opacity",k),n.setUniform1f("u_inFadeOpacity",p?1:0),m.setBlendFunction(1,0),d=this._quad,d.draw(),d.unbind(),m.setBlendFunction(1,771)):c.error(new e("mapview-BlendEffect","Error creating shader program for blend mode "+g))};a.prototype._setupShader=function(a){this._programCache||(this._programCache=new f.ProgramCache(a),this._quad||
(this._quad=new d(a,[-1,-1,1,-1,-1,1,1,1])))};a.prototype._createOrResizeTexture=function(a,b,c){a=a.context;if(null===this._backBufferTexture||b!==this._size[0]||c!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(b,c):this._backBufferTexture=new f.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:b,height:c}),this._size[0]=b,this._size[1]=c};return a}();a.BlendEffect=g})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["require",
"exports","./sources/resolver"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.blend=void 0;a.blend={name:"blend",attributes:{a_pos:0,a_tex:1},shaders:function(a){return{vertexShader:"#define "+a.replace("-","_").toUpperCase()+"\n"+e.resolveIncludes("blend/blend.vert"),fragmentShader:"#define "+a.replace("-","_").toUpperCase()+"\n"+e.resolveIncludes("blend/blend.frag")}}}})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports tslib ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(g,a,e,k,h,f,n,d,b){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.defines=["highlight"];c._hlRenderer=new d.default;c._hlGradient=new n.default;c._width=void 0;c._height=void 0;c._hlSurfaces=new b.default;c._adjustedWidth=void 0;c._adjustedHeight=void 0;c._blitRenderer=new h.BitBlitRenderer;return c}e.__extends(c,a);c.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();
this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};c.prototype.bind=function(a){var b=a.context,c=a.painter,d=b.getViewport(),f=d.width,d=d.height,c=c.getFbos(f,d).effect0;this.setup(a,f,d);b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};c.prototype.unbind=function(){};c.prototype.setup=function(a,b,c){a=a.context;this._width=b;this._height=c;var d=b%4,f=c%4;b+=2>d?-d:4-d;c+=2>f?-f:4-f;this._adjustedWidth=b;this._adjustedHeight=c;this._boundFBO=a.getBoundFramebufferObject();
b=Math.round(.75*b);c=Math.round(.75*c);this._hlRenderer.setup(a,b,c);this._hlSurfaces.setup(a,b,c)};c.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};c.prototype.setHighlightOptions=
function(a){this._hlGradient.setHighlightOptions(a)};return c}(f.Effect);a.default=g})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(g,a,e,k,h,f){function n(a,b){b.fillColor[0]=a.color.r/255;b.fillColor[1]=a.color.g/255;b.fillColor[2]=a.color.b/255;b.fillColor[3]=a.color.a;a.haloColor?(b.outlineColor[0]=a.haloColor.r/255,b.outlineColor[1]=a.haloColor.g/
255,b.outlineColor[2]=a.haloColor.b/255,b.outlineColor[3]=a.haloColor.a):(b.outlineColor[0]=b.fillColor[0],b.outlineColor[1]=b.fillColor[1],b.outlineColor[2]=b.fillColor[2],b.outlineColor[3]=b.fillColor[3]);b.fillColor[3]*=a.fillOpacity;b.outlineColor[3]*=a.haloOpacity;b.fillColor[0]*=b.fillColor[3];b.fillColor[1]*=b.fillColor[3];b.fillColor[2]*=b.fillColor[3];b.outlineColor[0]*=b.outlineColor[3];b.outlineColor[1]*=b.outlineColor[3];b.outlineColor[2]*=b.outlineColor[3];b.outlineWidth=f.HIGHLIGHT_SIZING.outlineWidth;
b.outerHaloWidth=f.HIGHLIGHT_SIZING.outerHaloWidth;b.innerHaloWidth=f.HIGHLIGHT_SIZING.innerHaloWidth;b.outlinePosition=f.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(a,"__esModule",{value:!0});var d=e.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),b=[0,0,0,0];g=function(){function a(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:f.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:f.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:f.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:f.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*f.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}a.prototype.setHighlightOptions=function(a){function c(a,b,c){y[0]=(1-c)*a[0]+c*b[0];y[1]=(1-c)*a[1]+c*b[1];y[2]=(1-c)*a[2]+c*b[2];y[3]=(1-c)*a[3]+c*b[3]}var e,h=this._convertedHighlightOptions;n(a,h);a=h.outlinePosition-h.outlineWidth/2-h.outerHaloWidth;var g=h.outlinePosition-h.outlineWidth/2,k=
h.outlinePosition+h.outlineWidth/2,l=h.outlinePosition+h.outlineWidth/2+h.innerHaloWidth,q=Math.sqrt(Math.PI/2)*f.SIGMAS[3],p=Math.abs(a)>q?Math.round(10*(Math.abs(a)-q))/10:0,q=Math.abs(l)>q?Math.round(10*(Math.abs(l)-q))/10:0;p&&!q?d.error("The outer rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!p&&q?d.error("The inner rim of the highlight is "+q+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
p&&q&&d.error("The highlight is "+Math.max(p,q)+"px away from the edge of the feature; consider reducing some width values.");for(var y=[void 0,void 0,void 0,void 0],p=this.texelData,q=0;q<f.SHADE_TEXTURE_SIZE;++q)e=a+q/(f.SHADE_TEXTURE_SIZE-1)*(l-a),e<a?(y[4*q+0]=0,y[4*q+1]=0,y[4*q+2]=0,y[4*q+3]=0):e<g?c(b,h.outlineColor,(e-a)/(g-a)):e<k?(e=h.outlineColor,y[0]=e[0],y[1]=e[1],y[2]=e[2],y[3]=e[3]):e<l?c(h.outlineColor,h.fillColor,(e-k)/(l-k)):(e=h.fillColor,y[4*q+0]=e[0],y[4*q+1]=e[1],y[4*q+2]=e[2],
y[4*q+3]=e[3]),p[4*q+0]=255*y[0],p[4*q+1]=255*y[1],p[4*q+2]=255*y[2],p[4*q+3]=255*y[3];this.minMaxDistance[0]=a;this.minMaxDistance[1]=l;this.shadeTexChanged=!0};a.prototype.applyHighlightOptions=function(a,b){this.shadeTex||(this.shadeTex=new k.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:f.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,f.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);a.bindTexture(this.shadeTex,
h.TEXTURE_BINDING_HIGHLIGHT_1);b.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return a}();a.default=g})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.HIGHLIGHT_SIZING=a.SHADE_TEXTURE_SIZE=a.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=a.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=a.SIGMAS=void 0;
a.SIGMAS=[void 0,void 0,void 0,1];a.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];a.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.SHADE_TEXTURE_SIZE=256;a.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(g,
a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.prototype.preBlur=function(a,b){a.bindTexture(b,k.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",h.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.finalBlur=function(a,b){a.bindTexture(b,k.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",h.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.renderHighlight=function(a,b,c){a.bindTexture(b,k.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);c.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};a.prototype._initialize=function(a,b,c){this._width=b;this._height=c;b=new e.BufferObject(a,34962,35044,(new Int8Array([-1,
-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);c=new e.VertexArrayObject(a,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:b});var d=e.createProgram(a,f.highlight);a=e.createProgram(a,f.blur);d.setUniform1i("u_texture",k.TEXTURE_BINDING_HIGHLIGHT_0);d.setUniform1i("u_shade",k.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform4fv("u_sigmas",h.SIGMAS);a.setUniform1i("u_texture",
k.TEXTURE_BINDING_HIGHLIGHT_0);a.setUniform4fv("u_sigmas",h.SIGMAS);this._resources={quadGeometry:b,quadVAO:c,highlightProgram:d,blurProgram:a}};a.prototype.setup=function(a,b,c){this._resources?(this._width=b,this._height=c):this._initialize(a,b,c)};return a}();a.default=g})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.blur=a.highlight=void 0;a.highlight={name:"highlight",
shaders:{vertexShader:e.resolveIncludes("highlight/textured.vert"),fragmentShader:e.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,a_texcoord:1}};a.blur={name:"blur",shaders:{vertexShader:e.resolveIncludes("highlight/textured.vert"),fragmentShader:e.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(g,a,e){function k(a,
f,g){f=new e.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:f,height:g,samplingMode:9729});a=new e.FramebufferObject(a,{colorTarget:0,depthStencilTarget:2},f);return[f,a]}Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),
this._resources=null)};a.prototype._initialize=function(a,e,d){this._width=e;this._height=d;var b=k(a,e,d),c=b[0],b=b[1];a=k(a,e,d);this._resources={sharedBlur1Tex:c,sharedBlur1Fbo:b,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};a.prototype.setup=function(a,e,d){!this._resources||this._width===e&&this._height===d||this.dispose();this._resources||this._initialize(a,e,d)};Object.defineProperty(a.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!1,configurable:!0});
Object.defineProperty(a.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!1,configurable:!0});return a}();a.default=g})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports tslib ../../../../../core/MapUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.HittestEffect=void 0;g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._lastSize=0;return b}e.__extends(b,a);b.prototype.dispose=function(){h.isSome(this._fbo)&&this._fbo.dispose()};b.prototype.bind=function(a){var b=a.context;a=a.painter;var c=b.getViewport();a=a.getFbos(c.width,c.height).effect0;b.bindFramebuffer(a);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};
b.prototype.unbind=function(){};b.prototype.draw=function(a,b,d){var c=this,e=a.context,h=a.state,g=a.pixelRatio;void 0===d&&(d=f.HITTEST_SEARCH_SIZE);var l=e.getBoundFramebufferObject(),q=h.size[1]*g,p=Math.round(d*g),n=p/2,z=p/2;this._ensureBuffer(p);b.forEach(function(a,d){var f=new Map;l.readPixels(Math.floor(d[0]*g-p/2),Math.floor(q-d[1]*g-p/2),p,p,6408,5121,c._buf);for(var e=0;e<c._buf32.length;e++){var h=c._buf32[e];if(4294967295!==h&&0!==h){var m=e%p,r=p-Math.floor(e/p),m=(n-m)*(n-m)+(z-r)*
(z-r),r=f.has(h)?f.get(h):4294967295;f.set(h,Math.min(m,r))}}f=k.pairsOfMap(f).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[0]});a.resolve(f);b.delete(d)})};b.prototype._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};return b}(n.Effect);a.HittestEffect=g})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define(["require","exports","tslib","@dojo/framework/shim/Promise"],
function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.EffectManager=void 0;var k={colorize:function(){return e.__awaiter(void 0,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(a,d){g(["./Colorize"],a,d)})];case 1:return[2,new (a.sent().Colorize)]}})})},blur:function(){return e.__awaiter(void 0,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(a,d){g(["./Blur"],
a,d)})];case 1:return[2,new (a.sent().Blur)]}})})},bloom:function(){return e.__awaiter(void 0,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(a,d){g(["./Bloom"],a,d)})];case 1:return[2,new (a.sent().Bloom)]}})})},opacity:function(){return e.__awaiter(void 0,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(a,d){g(["./Opacity"],a,d)})];case 1:return[2,new (a.sent().Opacity)]}})})},
"drop-shadow":function(){return e.__awaiter(void 0,void 0,void 0,function(){return e.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(a,d){g(["./DropShadow"],a,d)})];case 1:return[2,new (a.sent().DropShadow)]}})})}},h=function(){function a(a){this._requestRender=a;this._effectMap=new Map;this._effectPromiseMap=new Map}a.prototype.dispose=function(){this._requestRender&&(this._requestRender=null);this._effectMap.forEach(function(a){return a.dispose()});this._effectMap.clear();
this._effectPromiseMap.clear()};a.prototype.getPostProcessingEffects=function(a){if(!a||0===a.length)return[];for(var d=[],b=0;b<a.length;b++){var c=a[b],f=this._getPostProcessingEffectName(c),e=this._effectMap.get(f);e?d.push({postProcessingEffect:e,effect:c}):this._enablePostProcessingEffect(f)}return d};a.prototype._getPostProcessingEffectName=function(a){return"colorMatrix"in a?"colorize":"radial-blur"===a.type?"blur":a.type};a.prototype._enablePostProcessingEffect=function(a){return e.__awaiter(this,
void 0,void 0,function(){var d;return e.__generator(this,function(b){switch(b.label){case 0:return[4,this._loadPostProcessingEffect(a)];case 1:d=b.sent();if(!this._requestRender)return[2];this._effectMap.set(a,d);this._requestRender.requestRender();return[2]}})})};a.prototype._loadPostProcessingEffect=function(a){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){this._effectPromiseMap.has(a)||this._effectPromiseMap.set(a,k[a]());return[2,this._effectPromiseMap.get(a)]})})};
return a}();a.EffectManager=h})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,b){this.brushes=a;this.name=b.name;this.drawPhase=b.drawPhase||f.WGLDrawPhase.MAP;this._targetFn=b.target;this.effects=b.effects||[];this.has=b.has}a.prototype.render=function(a){var b=a.context,
c=a.profiler,d=this._targetFn(),f=this.drawPhase&a.drawPhase;c.recordPassStart(this.name);if(f&&(!this.has||k(this.has))){this._doRender(a,d);c.recordPassEnd();for(var f=0,e=this.effects;f<e.length;f++){var h=e[f];if(h.enable()){var g=h.apply;c.recordPassStart(this.name+"."+g.name);c.recordBrushStart(g.name);var h=h.args&&h.args(),n=b.getViewport(),l=n.x,w=n.y,p=n.width,n=n.height,y=b.getBoundFramebufferObject();g.bind(a,h);this._doRender(a,d,g.defines);g.draw(a,h);g.unbind(a,h);b.bindFramebuffer(y);
b.setViewport(l,w,p,n);c.recordBrushEnd();c.recordPassEnd()}}}};a.prototype._doRender=function(a,b,c){if(!h.isNone(b))if(e.isArrayLike(b))for(var d=0;d<b.length;d++){var f=b[d];if(f.visible)for(var g=0,k=this.brushes;g<k.length;g++){var m=k[g];a.profiler.recordBrushStart(m.name);m.prepareState(a,f,c);m.draw(a,f,c);a.profiler.recordBrushEnd()}}else for(d=0,f=this.brushes;d<f.length;d++)m=f[d],a.profiler.recordBrushStart(m.name),m.prepareState(a,b,c),m.draw(a,b,c),a.profiler.recordBrushEnd()};return a}();
a.default=g})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.Profiler=void 0;var d=h("esri-2d-profiler");g=function(){function a(a,b){var c=this;this._events=new k;this._entries=new Map;this._timings=new e.default(10);if(d){this._ext=n.load(a.gl,
{});this._debugOutput=b;var f=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof f[a]){var b=f[a],d=-1!==a.indexOf("draw");f[a]=function(){for(var e=[],h=0;h<arguments.length;h++)e[h]=arguments[h];c._events.emit("command",{container:c._currentContainer,pass:c._currentPass,brush:c._currentBrush,method:a,args:e,isDrawCommand:d});c._currentSummary&&(c._currentSummary.commands++,d&&c._currentSummary.drawCommands++);return b.apply(f,e)}}};for(var h in f)a(h)}}}Object.defineProperty(a.prototype,
"enableCommandLogging",{get:function(){return!("object"===typeof d&&d.disableCommands)},enumerable:!1,configurable:!0});a.prototype.recordContainerStart=function(a){d&&(this._currentContainer=a)};a.prototype.recordContainerEnd=function(){d&&(this._currentContainer=null)};a.prototype.recordPassStart=function(a){d&&(this._currentPass=a,this._initSummary())};a.prototype.recordPassEnd=function(){d&&(this._currentPass=null,this._emitSummary())};a.prototype.recordBrushStart=function(a){d&&(this._currentBrush=
a)};a.prototype.recordBrushEnd=function(){d&&(this._currentBrush=null)};a.prototype.recordStart=function(a){if(d&&f.isSome(this._ext)){if(this._entries.has(a)){var b=this._entries.get(a),c=this._ext.resultAvailable(b.query),e=this._ext.disjoint();if(c&&!e){c=this._ext.getResult(b.query)/1E6;e=0;if(f.isSome(this._timings.enqueue(c))){for(var e=this._timings.entries,h=e.length,g=0,k=0;k<e.length;k++)g+=e[k];e=g/h}c=c.toFixed(2);e=e?e.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+
a+", "+c+" ms ("+e+" last 10 avg)\n"+b.commandsLen+" Commands ("+b.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(b.summaries),console.log("Commands: ",b.commands),console.groupEnd()):console.log("Frame report for "+a+", "+c+" ms ("+e+" last 10 avg)");this._debugOutput.innerHTML=c+" ("+e+")"}c=0;for(b=b.handles;c<b.length;c++)b[c].remove();this._entries.delete(a)}var l={name:a,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};
this.enableCommandLogging&&(l.handles.push(this._events.on("command",function(a){l.commandsLen++;l.commands.push(a);a.isDrawCommand&&l.drawCommands++})),l.handles.push(this._events.on("summary",function(a){l.summaries.push(a)})));this._ext.beginTimeElapsed(l.query);this._entries.set(a,l)}};a.prototype.recordEnd=function(a){d&&f.isSome(this._ext)&&this._entries.has(a)&&this._ext.endTimeElapsed()};a.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,
pass:this._currentPass,drawCommands:0,commands:0})};a.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return a}();a.Profiler=g})},"esri/core/CircularArray":function(){define(["require","exports","./maybe"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){void 0===a&&(a=Number.POSITIVE_INFINITY);this._start=this.size=0;this.maxSize=a;this._buffer=isFinite(a)?Array(a):[]}Object.defineProperty(a.prototype,
"entries",{get:function(){return this._buffer},enumerable:!1,configurable:!0});a.prototype.enqueue=function(a){if(this.size===this.maxSize){var f=this._buffer[this._start];this._buffer[this._start]=a;this._start=(this._start+1)%this.maxSize;return f}isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=a:this._buffer[this._start+this.size++]=a;return null};a.prototype.dequeue=function(){if(0===this.size)return null;var a=this._buffer[this._start];this._buffer[this._start]=null;
this.size--;this._start=(this._start+1)%this.maxSize;return a};a.prototype.clear=function(){for(;e.isSome(this.dequeue()););};return a}();a.default=g})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.testSamplerPrecision=a.testWebGLDriver=void 0;var n=e.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),
d=function(){function b(a){this._ignoresSamplerPrecision=null;this._context=a}Object.defineProperty(b.prototype,"ignoresSamplerPrecision",{get:function(){k.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=a.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!1,configurable:!0});return b}();a.testWebGLDriver=function(a){return new d(a)};a.testSamplerPrecision=function(a){var b=new h.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,
wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),d=new Uint8Array(4),e=new f(a,[0,0,1,0,0,1,1,1]),g=new h.Program(a,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),k=new h.Texture(a,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));g.setUniform1i("u_texture",0);a.bindTexture(k,0);a.bindFramebuffer(b);a.bindProgram(g);var m=a.getViewport(),k=m.x,v=m.y,l=m.width,m=m.height;a.setViewport(0,0,1,1);e.draw();a.setViewport(k,v,l,m);b.readPixels(0,0,1,1,6408,5121,d);g.dispose();e.dispose();
b.dispose();(a=255!==d[0]||255!==d[1]||255!==d[2]||255!==d[3])&&n.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+d[0]+"."+d[1]+"."+d[2]+"."+d[3]+"]");return a}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.stencil=void 0;a.stencil={name:"stencil",shaders:{vertexShader:e.resolveIncludes("stencil/stencil.vert"),fragmentShader:e.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/LabelManager":function(){define("require exports tslib ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q){Object.defineProperty(a,"__esModule",{value:!0});var u=n.getLogger("esri.views.2d.layers.labels.LabelManager");g=function(a){function f(b){b=a.call(this,b)||this;b._applyVisibilityPassThrottled=d.throttle(b._applyVisibilityPass,64,b);b.lastUpdateId=-1;b.updateRequested=!1;b.view=null;return b}e.__extends(f,a);f.prototype.initialize=function(){var a=this;this.collisionEngine=new c.CollisionEngine(this.view.featuresTilingScheme);this._layerViewSorter=new q.LayerViewSorter(function(b,
c){a.collisionEngine.registerLayerView(b,c);(c=b.tileRenderer)&&c.forEachTile(function(c){c.isDirty=!0;a.addTile(b,c)});a.requestUpdate()},function(b){a.collisionEngine.unregisterLayerView(b);a.requestUpdate()});this.handles.add(this.view.allLayerViews.on("change",function(b){a._layerViewSorter.update(b)}))};f.prototype.destroy=function(){this._layerViewSorter.destroy();this.collisionEngine=this._layerViewSorter=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=null};
Object.defineProperty(f.prototype,"updating",{get:function(){return this.updateRequested},enumerable:!1,configurable:!0});f.prototype.update=function(a){this._applyVisibilityPassThrottled(a)};f.prototype.viewChange=function(){this.requestUpdate()};f.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};f.prototype.processUpdate=function(a){this._set("updateParameters",a);this.updateRequested&&(this.updateRequested=!1,this.update(a))};f.prototype.addTile=
function(a,b){this.collisionEngine.addTile(a,b)};f.prototype.removeTile=function(a,b){this.collisionEngine.removeTile(a,b)};f.prototype._applyVisibilityPass=function(a){try{var b=this.view.featuresTilingScheme.getClosestInfoForScale(a.state.scale).level;this.collisionEngine.run(a,b)}catch(l){u.error(new h("mapview-labeling","Encountered an error during label decluttering",l))}};e.__decorate([b.property()],f.prototype,"updateRequested",void 0);e.__decorate([b.property({readOnly:!0})],f.prototype,"updateParameters",
void 0);e.__decorate([b.property({dependsOn:["updateRequested"]})],f.prototype,"updating",null);e.__decorate([b.property()],f.prototype,"view",void 0);return f=e.__decorate([b.subclass("esri.views.2d.layers.labels.LabelManager")],f)}(f.HandleOwnerMixin(k));a.default=g})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/MapUtils ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),
function(g,a,e,k,h,f,n,d,b){Object.defineProperty(a,"__esModule",{value:!0});a.CollisionEngine=void 0;var c=n.TILE_SIZE/n.COLLISION_BUCKET_SIZE,q=k.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");g=function(){function a(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(a.prototype,"collisionInfos",{get:function(){return h.valuesOfMap(this._layers)},enumerable:!1,configurable:!0});a.prototype.registerLayerView=function(a,
c){if(!this._layers.has(a)){var d=b.default.create(a,c,this.collisionInfos,this._tilingScheme);this._layers.set(a,d);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(d.index)})}};a.prototype.unregisterLayerView=function(a){var c=this;if(this._layers.has(a)){var d=this._layers.get(a);b.default.delete(d.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,b){var f=a.getTile(d.index);f&&(a.onUnregisterLayer(d.index),a.canDelete()&&c._collisionBuckets.delete(b),
f.reference&&(f.reference.isDirty=!1))})}};a.prototype.addTile=function(a,b){var c=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(c)||this._collisionBuckets.set(c,new d.default(b.key,this._layers.size)),a=this._getIndex(a),this._collisionBuckets.get(c).getTile(a).reference=b)};a.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(a=this._getIndex(a),b=this._collisionBuckets.get(b).getTile(a),b.dirty=!1,b.reference=null)};a.prototype.run=function(a,c){var d=
h.valuesOfMap(this._collisionBuckets).sort(function(a,b){return a.key.compareRowMajor(b.key)}),f=!0,g=a.renderingOptions.labelCollisionsEnabled&&!this._didError,k=this.collisionInfos;try{for(var p=0;p<d.length;p++){var r=d[p],f=f||r.isDirty;r.computeNeighbors(this._collisionBuckets);for(var n=0;n<this._layers.size;n++){var t=b.default.find(n,k);r.reset(a,f,t)}}for(a=0;a<this._layers.size;a++)for(t=b.default.find(a,k),f=0,p=d;f<p.length;f++)r=p[f],this._run(g,r,t,c)}catch(B){q.error(new e("mapview-labeling",
"Encountered an error during decluttering. Disabling collisions",B)),this._didError=!0}for(c=0;c<d.length;c++)r=d[c],r.ready()};a.prototype._run=function(a,b,c,d){var f=b.getReference(c.index);f&&f.hasData&&(f.key.level!==d?this._resetLabelsMinZoom(b,c):this._runVisibility(a,b,f,c,d))};a.prototype._resetLabelsMinZoom=function(a,b){if(a&&"polyline"!==b.geometryType&&(a=a.getReference(b.index))&&a.hasData){b=b.layerView.tileRenderer.featuresView.attributeView;var c=0;for(a=a.displayObjects;c<a.length;c++)b.setLabelMinZoom(a[c].id,
255)}};a.prototype._checkLabelsVisible=function(a,b){var c=!b.effect||b.effect.excludedLabelsVisible||!!(a&n.EFFECT_FLAG_0);return(!b.filter||!!(a&n.FILTER_FLAG_0))&&c};a.prototype._runVisibility=function(a,b,c,d,f){var e=d.layerView.tileRenderer.featuresView.attributeView;c=c.displayObjects.sort(function(a,b){a=e.getLabelMinZoom(a.id);b=e.getLabelMinZoom(b.id);return a-b});for(var h=d.zoomRanges.some(function(a){return"none"===a.deconflictionStrategy}),g=0;g<c.length;g++){var l=c[g];if(l.metrics.length){var m=
"polyline"===d.geometryType?0:10*(f-1),k=e.getFilterFlags(l.id),q=this._checkLabelsVisible(k,d.layerView);if(a&&!h)for(var r=0;r<l.metrics.length;r++)k=l.metrics[r],k=q?-1!==k.minZoom?k.minZoom:this._computeLabelVisibility(l,k,d.index,b,k.baseZoom,f):255,m=Math.max(k,m);m=Math.max(m,0);e.setLabelMinZoom(l.id,m);q=0;for(l=l.metrics;q<l.length;q++)k=l[q],k.minZoom=m}}};a.prototype._computeLabelVisibility=function(a,b,d,f,e,h){for(var g=b.xBucket,l=b.yBucket,m=b.xOverflow,k=b.yOverflow,q=g-m,g=g+m+1,
m=l+k+1,l=l-k;l<m;l++)for(k=q;k<g;k++)if(!(k<-c||l<-c||k>c||l>c))for(var r=0;r<=d;r++){var n=this._getRelativeSubBucket(r,f,k,l);if(n)for(var w=0;w<n.length;w++){var v=n[w];if(r!==d||v.id!==a.id)v=this._compareLabels(b,v,e,h),e=Math.max(v,e)}}return e};a.prototype._compareLabels=function(a,b,c,d){if(-1===b.minZoom||b.minZoom>10*(d+1))return c;a=a.findCollisionDelta(b);d=f.clamp(Math.ceil(10*(a+d)),0,255);return b.minZoom>=d?c:Math.max(c,d)};a.prototype._getNeighboringTile=function(a,b,c,d){return(b=
b.neighbors[3*(1+d)+(1+c)])&&b.getTile(a)};a.prototype._getRelativeSubBucket=function(a,b,c,d){var e=f.sign(Math.floor(c/4)),h=f.sign(Math.floor(d/4));return(a=this._getNeighboringTile(a,b,e,h))&&a.reference&&a.index&&a.reference.hasData?a.index[d-4*h][c-4*e]:null};a.prototype._getIndex=function(a){return this._layers.get(a).index};return a}();a.CollisionEngine=g})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],
function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e){this.neighbors=Array(9);this._tiles=Array(e);for(var d=0;d<e;d++)this._tiles[d]=new k.default;this.key=a}Object.defineProperty(a.prototype,"isDirty",{get:function(){for(var a=0,e=this._tiles;a<e.length;a++)if(e[a].dirty)return!0;return!1},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._tiles.length},enumerable:!1,configurable:!0});a.prototype.getTile=
function(a){return this._tiles[a]};a.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};a.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};a.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};a.prototype.onLabelsRendered=function(){};a.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};a.prototype.add=function(a){this._add(a)};a.prototype.remove=function(a){this._remove(a)};a.prototype.canDelete=
function(){return 0===this._tiles.length};a.prototype.ready=function(){for(var a=0,e=this._tiles;a<e.length;a++)e[a].dirty=!1};a.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=
this._getNeighbor(a,1,1)};a.prototype.reset=function(a,e,d){var b=this._tiles[d.index];b&&b.reset(a,e,d)};a.prototype._add=function(a){var f=[];if(a>=this._tiles.length)this._tiles.push(new k.default);else{for(var d=0;d<this._tiles.length;d++)d===a&&f.push(new k.default),f.push(this._tiles[d]);this._tiles=f}};a.prototype._remove=function(a){for(var f=[],d=0;d<this._tiles.length;d++)d!==a&&f.push(this._tiles[d]);this._tiles=f};a.prototype._getNeighbor=function(a,h,d){var b=this.key;h=e.TileKey.getId(b.level,
b.row+d,b.col+h,b.world);return a.has(h)?a.get(h):null};return a}();a.default=g})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._reference=null}Object.defineProperty(a.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(a){this.reference&&this.reference.hasData&&
(a||this.reference.isDirty)&&(this.reference.isDirty=a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"reference",{get:function(){return this._reference},set:function(a){this._reference=a},enumerable:!1,configurable:!0});a.prototype.reset=function(a,f,g){a=a.state;var d=g.layerView.tileRenderer,b=this.reference;if(!b||!b.hasData)return!1;
f&&(b.isDirty=!0);f=b.transforms.labelMat2d;for(var c=f[4],h=f[5],k=0,n=b.displayObjects;k<n.length;k++)for(var r=n[k],m=d.featuresView.attributeView,m=g.hasVV()?m.getVVSize(r.id):0,v=0,r=r.metrics;v<r.length;v++){var l=r[v];g.hasVV()&&l.computeVVOffset(m,g.vvEval);var w=l.bounds.center,p=l.bounds.centerT;b.isDirty&&(l.minZoom=-1);var y=e.vec2.copy(p,l.anchor);a.rotation?e.vec2.transformMat2d(y,y,f):(p[0]=y[0]+c,p[1]=y[1]+h);e.vec2.add(p,y,w);p[0]+=l.offsetX;p[1]+=l.offsetY;if(l.boxes)for(w=0,p=l.boxes;w<
p.length;w++){var y=p[w],z=y.centerT;e.vec2.add(z,l.anchor,y.center);a.rotation?e.vec2.transformMat2d(z,z,f):(z[0]+=c,z[1]+=h)}}return!0};return a}();a.default=g})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports tslib ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),function(g,a,e,k,h,f,n){function d(a,b){var c=!!a.maxScale,d=!!a.minScale&&b.scaleToZoom(a.minScale)||0;b=c&&
b.scaleToZoom(a.maxScale)||255;return{deconflictionStrategy:a.deconflictionStrategy,minZoom:h.clamp(Math.floor(10*d),0,255),maxZoom:h.clamp(Math.floor(10*b),0,255)}}function b(a){return function(b){return f.pt2px(n.getSizeForValueSimple(b,a))}}function c(a){if(!a)return null;for(var c=0;c<a.length;c++){var d=a[c];if("size"===d.type)return b(d)}return null}Object.defineProperty(a,"__esModule",{value:!0});a.createLabelVVEvaluator=void 0;var q=function(a,b){return a.order-b.order},u=function(a,b){return a.index-
b.index},t=k.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");a.createLabelVVEvaluator=c;g=function(){function a(a,b,f,h){var g=this;this._vvHandle=null;var l=a.layer,k=l.geometryType,m=l.labelingInfo,q=l.renderer;q&&(this.vvEval=c("visualVariables"in q&&q.visualVariables));this._vvHandle=l.watch("renderer",function(a){a&&(g.vvEval=c("visualVariables"in a&&a.visualVariables))});l=(l=l.featureReduction)&&"cluster"===l.type&&l.labelingInfo;m=(m||[]).map(function(a){return d(a,h)});
l=(l||[]).map(function(a){return d(a,h)});this.layerView=a;this.geometryType=k;this.index=b;this.order=f;this.zoomRanges=e.__spreadArrays(m,l);this.layerView=a}a.prototype.hasVV=function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(b,c,d,f){d=d.sort(q);for(var e=!1,h=-1,g=0;g<d.length;g++){var l=d[g];!e&&l.order>c&&(h=l.index,e=!0);e&&l.index++}e||(h=d.length);return new a(b,
h,c,f)};a.delete=function(a,b){for(var c=b.sort(u),d=a+1;d<c.length;d++)b[d].index--;b[a].destroy();b.splice(a,1)};a.find=function(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(d.index===a)return d}t.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();a.default=g})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(g,
a,e,k){function h(a,c){switch(c.transformationType){case "additive":var b=f(c.minSize,a);return a+(b||c.minDataValue);case "constant":return b=(b=c.stops)&&b.length&&b[0].size,null==b&&(b=c.minSize),f(b,a);case "clamped-linear":var b=(a-c.minDataValue)/(c.maxDataValue-c.minDataValue),h=f(c.minSize,a),g=f(c.maxSize,a);a=a<=c.minDataValue?h:a>=c.maxDataValue?g:h+b*(g-h);return a;case "proportional":return b=a/c.minDataValue,h=f(c.minSize,a),a=f(c.maxSize,a),e.clamp(b*h,h,a);case "stops":return h=n(a,
c.cache.ipData),g=h[0],b=h[1],h=h[2],g===b?a=f(c.stops[g].size,a):(g=f(c.stops[g].size,a),a=f(c.stops[b].size,a),a=g+(a-g)*h),a;case "real-world-size":b=k.meterIn[c.valueUnit];h=f(c.minSize,a);g=f(c.maxSize,a);c=c.valueRepresentation;var r=null,r="area"===c?2*Math.sqrt(a/d)/b:"radius"===c||"distance"===c?2*a/b:a/b;return e.clamp(r,h,g);case "identity":return a;case "unknown":return null}}function f(a,c){return"number"===typeof a?a:h(c,a)}function n(a,c){if(c){var b=0,d=c.length-1;c.some(function(c,
f){if(a<c)return d=f,!0;b=f;return!1});return[b,d,(a-c[b])/(c[d]-c[b])]}}Object.defineProperty(a,"__esModule",{value:!0});a.getSizeForValueSimple=void 0;var d=Math.PI;a.getSizeForValueSimple=h})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","../../../../../core/Error","../../../../../core/Logger"],function(g,a,e,k){function h(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===a.declaredClass}
Object.defineProperty(a,"__esModule",{value:!0});a.LayerViewSorter=void 0;var f=k.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");g=function(){function a(a,b){this.registerLayer=a;this.unregisterLayer=b;this._layerViewState=new Map}a.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(b){return b.uid===a.uid})};a.prototype.update=function(a){for(var b=a.added,c=0,d=a.removed;c<d.length;c++)a=d[c],h(a)&&this._layerViewState.has(a)&&this._deleteState(a);for(c=
0;c<b.length;c++){a=b[c];if(d=h(a))a:if(a.layer&&a.layer.renderer)switch(a.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":case "dot-density":d=!0;break a;default:f.error(new e("mapview-labeling","Renderer of type "+a.layer.renderer.type+" does not currently support labeling")),d=!1}else d=!1;d&&!this._layerViewState.has(a)&&this._createState(a)}this._recomputeOrder()};a.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handles.forEach(function(a){return a.remove()})})};
a.prototype._createState=function(a){var b={priority:-1,handles:null};b.handles=[a.layer.watch("visible",this._recomputeOrder.bind(this)),a.layer.watch("labelsVisible",this._recomputeOrder.bind(this)),a.layer.watch("labelingInfo",this._recomputeOrder.bind(this)),a.layer.watch("featureReduction",this._recomputeOrder.bind(this))];this._layerViewState.set(a,b);return b};a.prototype._deleteState=function(a){if(this._layerViewState.has(a)){var b=this._layerViewState.get(a);b.handles.forEach(function(a){return a.remove()});
-1!==b.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};a.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(b,c){var d=c.view.map.allLayers.findIndex(function(a){return a.uid===c.layer.uid}),f=c.layer,e=f.featureReduction,e=e&&"cluster"===e.type&&e.labelsVisible&&e.labelingInfo&&e.labelingInfo.length,e=f.labelsVisible&&f.labelingInfo&&f.labelingInfo.length||e,d=f.visible&&e?4294967295-d:-1;d!==b.priority&&(b.priority=d,a.unregisterLayer(c),-1!==
d&&a.registerLayer(c,d))})};return a}();a.LayerViewSorter=g})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("require exports tslib ../../../../core/Accessor ../../../../core/HandleOwner ../../../../core/has ../../../../core/Identifiable ../../../../core/MapPool ../../../../core/MapUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators ../../../../geometry/Polygon ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/cimSymbolUtils ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/TileData ../../engine/webgl/WGLTile ../../engine/webgl/mesh/factories/matcherUtils ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/BidiText ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ../features/support/TileStore ./GraphicContainer ./GraphicProcessingQueue ./GraphicStore ./graphicsUtils ../../../layers/GraphicsView".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l,w,p,y,z,C,B,E,x,A,F,I,G,J,H,M,L,K,N,Q,O,T,R,V){function S(a,b,c){if(c.has(a))return c.get(a);b={tile:b,addedOrModified:[],removed:[]};c.set(a,b);return b}Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(b){b=a.call(this,b)||this;b._storage=new L.ComputedAttributeStorage;b._displayIds=new Map;b._tiles=new Map;b._graphicStoreUpdate=!1;b._graphicsSet=new Set;b._matcher=q.resolve(null);b._tileUpdateSet=new Set;b._tilesToUpdate=new Map;
b._graphicIdToAbortController=new Map;b._attached=!1;b._highlightIds=new Map;b._updatingGraphicsTimer=null;b._processing=!1;b._needsProcessing=!1;b._pendingUpdate={addOrModified:new Set,removed:new Set};b.lastUpdateId=-1;b.updateRequested=!1;b.graphicUpdateHandler=b.graphicUpdateHandler.bind(b);b.addOrUpdateGraphic=b.addOrUpdateGraphic.bind(b);b._processAnalyzedGraphics=b._processAnalyzedGraphics.bind(b);b._graphicsChangeHandler=b._graphicsChangeHandler.bind(b);return b}e.__extends(f,a);f.prototype._createMatcher=
function(a,b){a&&(a=H.createMatcherSchema({indexCount:0,fields:{}},"feature",a),this._matcher=F.createMatcher(a,b,null))};f.prototype._createDisplayId=function(a){this._displayIds.has(a)||this._displayIds.set(a,this._storage.createDisplayId());return this._displayIds.get(a)};f.prototype.initialize=function(){var a=this;this._tileStore=new N.default(this.view.featuresTilingScheme);this.container=new Q.default(this.view.featuresTilingScheme);this._attributeStore=new M.default({type:"local",initialize:function(b){return q.resolve(a.container.attributeView.initialize(b))},
update:function(b){return a.container.attributeView.requestUpdate(b)},render:function(){return a.container.requestRender()}});this._graphicStore=new T.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,function(b){a._createDisplayId(b.uid);a._setFilterState(b.uid,b.visible)},function(b){var c=a._displayIds.get(b.uid);a._displayIds.delete(b.uid);a._storage.releaseDisplayId(c)});this._graphicProcessingQueue=new O.default({process:this.addOrUpdateGraphic});var b=new G.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),
!0);this._createMatcher(this.renderer,b);this._meshFactory=new I.WGLMeshFactory(null,this.uid,b);this._templateStore=b;this.watch("renderer",function(c){return a._createMatcher(c,b)});this._tileStore.on("update",this._onTileUpdate.bind(this));this.container.on("attach",function(){0<a.graphics.items.length&&a._graphicsChangeHandler({target:a.graphics,added:a.graphics.items,removed:[],moved:[]});a.handles.add(a.graphics.on("change",a._graphicsChangeHandler),"graphics");a._attached=!0;a.notifyChange("updating")});
this.container.on("detach",function(){a._graphicProcessingQueue&&a._graphicProcessingQueue.clear()})};f.prototype.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this.container.destroy();this._set("graphics",null);this._graphicProcessingQueue&&(this._graphicProcessingQueue.destroy(),this._graphicProcessingQueue=null);this._graphicStore.clear();this._tileStore.destroy();this._attributeStore=null};
Object.defineProperty(f.prototype,"updating",{get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._graphicProcessingQueue.updating||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size},enumerable:!1,configurable:!0});f.prototype.hitTest=function(a,b){if(!this.view||!this.view.position)return q.resolve();a=this.view.toMap(t.createScreenPoint(a,b));return this.searchFeatures(a).then(function(a){return a&&a.length?a[0]:null})};f.prototype.searchFeatures=function(a,b){var c=
this;void 0===b&&(b=2);return q.create(function(d){d(c._graphicStore.hitTest(a.x,a.y,b,c.view.state.resolution,c.view.state.rotation))})};f.prototype.update=function(a){a=a.state;var b=this.view.featuresTilingScheme.getClosestInfoForScale(a.scale).level;this._graphicStore.updateLevel(b);this._tileStore.setViewState(a);this._graphicStoreUpdate=!0;this.updateRequested=!1};f.prototype.viewChange=function(){this.requestUpdate()};f.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=
!0,this.requestUpdateCallback())};f.prototype.processUpdate=function(a){this.updateRequested&&(this.updateRequested=!1,this.update(a))};f.prototype.graphicUpdateHandler=function(a){var b=a.newValue,c=a.graphic;switch(a.property){case "geometry":case "symbol":this._graphicProcessingQueue.push(c,"update");break;case "visible":this._setFilterState(c.uid,b),this._attributeStore.sendUpdates()}};f.prototype.addHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=
this._highlightIds.get(c);this._highlightIds.set(c,d+1)}else this._highlightIds.set(c,1)}this._updateHighlight()};f.prototype.removeHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=this._highlightIds.get(c)-1;0===d?this._highlightIds.delete(c):this._highlightIds.set(c,d)}}this._updateHighlight()};f.prototype._updateHighlight=function(){var a=this,c=b.keysOfMap(this._highlightIds),d=c.map(function(b){return a._displayIds.get(b)});this._attributeStore.setHighlight(c,
d)};f.prototype._getIntersectingTiles=function(a){return(a=this._graphicStore.getBounds(a))&&0!==l.width(a)&&0!==l.height(a)?this._tileStore.boundsIntersections(a):[]};f.prototype._updateTile=function(a){var b=this,c=a.tile,d=this._getGraphicsData(this._templateStore,c,a.addedOrModified);return this._processGraphics(d).then(function(d){b._patchTile(c.key,{type:"update",addOrUpdate:d,remove:a.removed,end:!0});return d})};f.prototype._patchTile=function(a,b){this._tiles.has(a)&&(a=this._tiles.get(a),
this.container.onTileData(a,b),this.container.requestRender())};f.prototype._graphicsChangeHandler=function(a){for(var b=0,c=a.added;b<c.length;b++){var d=c[b];this._pendingUpdate.addOrModified.add(d)}b=0;for(c=a.moved;b<c.length;b++)d=c[b],this._pendingUpdate.addOrModified.add(d);b=0;for(a=a.removed;b<a.length;b++)d=a[b],this._pendingUpdate.addOrModified.has(d)?this._pendingUpdate.addOrModified.delete(d):this._pendingUpdate.removed.add(d);this._processing?this._needsProcessing=!0:this._updateGraphics()};
f.prototype._getFeaturesToUpdate=function(){for(var a=this,b={addOrModified:[],removed:[]},c=0,d=this.graphics.items;c<d.length;c++){var f=d[c];this._pendingUpdate.addOrModified.has(f)&&b.addOrModified.push(f)}this._pendingUpdate.removed.forEach(function(c){a._graphicStore.has(c)&&b.removed.push(c)});this._pendingUpdate.addOrModified.clear();this._pendingUpdate.removed.clear();return b};f.prototype._updateGraphics=function(){return e.__awaiter(this,void 0,void 0,function(){var a,b,c,d,f,h,g,l,p,k,
m,n,r,w,z,v,y,t,x,u,B,C,F,A=this;return e.__generator(this,function(e){switch(e.label){case 0:this._processing=!0,a=this._getFeaturesToUpdate(),b=a.addOrModified,c=a.removed,d=this._tilesToUpdate,e.label=1;case 1:e.trys.push([1,4,,5]);this._graphicStoreUpdate||(h=this.view.state,g=this.view.featuresTilingScheme.getClosestInfoForScale(h.scale).level,this._graphicStore.updateLevel(g),this._tileStore.setViewState(h));l=[];p=Array(b.length);for(k=0;k<b.length;k++)m=b[k],p[k]=m,this._graphicsSet.add(m),
l.push(this.addGraphic(m));n=0;for(r=c;n<r.length;n++){w=r[n];this._abortProcessingGraphic(w.uid);z=this._getIntersectingTiles(w);v=0;for(y=z;v<y.length;v++)t=y[v],f=t.key.id,x=S(f,t,d),x.removed.push(this._displayIds.get(w.uid));this._graphicsSet.delete(w);this._graphicStore.remove(w)}this._flipUpdatingGraphics();return[4,q.all(l)];case 2:e.sent();u=void 0;for(k=0;k<p.length;k++)for(u=p[k],z=this._getIntersectingTiles(u),B=0,C=z;B<C.length;B++)t=C[B],f=t.key.id,x=S(f,t,d),x.addedOrModified.push(u);
this._graphicStore.updateZ();F=[];d.forEach(function(a){return F.push(A._updateTile(a))});return[4,q.all(F)];case 3:return e.sent(),[3,5];case 4:return e.sent(),[3,5];case 5:return d.clear(),this.notifyChange("updating"),this._processing=!1,this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics()),[2]}})})};f.prototype._getArcadeInfo=function(a){var b=(a.attributes?Object.keys(a.attributes):[]).map(function(b){return{name:b,alias:b,type:"string"===typeof a.attributes[b]?"esriFieldTypeString":
"esriFieldTypeDouble"}});return c.isNone(a.geometry)?null:{geometryType:p.getJsonType(a.geometry),spatialReference:v.fromJSON(a.geometry.spatialReference),fields:b}};f.prototype._getSymbolForGraphic=function(a,b){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){return c.isSome(a.symbol)?[2,a.symbol]:c.isSome(this.renderer)?[2,this.renderer.getSymbolAsync(a,{scale:this.view.scale,abortOptions:b})]:[2,this._getNullSymbol(a)]})})};f.prototype._getSymbolResources=
function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,h,g,l,p,k,m;return e.__generator(this,function(e){switch(e.label){case 0:if(!this.container.stage)return[2,q.resolve(null)];c=this._getArcadeInfo(a);return[4,this._getSymbolForGraphic(a,b)];case 1:return d=e.sent(),f=H.createSymbolSchema(d),[4,C.expandSymbol(f,c,b)];case 2:h=e.sent();if("esriTS"!==h.type)return[3,4];g=[];l=J.bidiText(h.text)[0];for(p=0;p<l.length;p++)g.push(l.charCodeAt(p));k={symbol:h,id:0,glyphIds:g};return[4,
this.container.getMaterialItems([k])];case 3:return m=e.sent()[0].mosaicItem,[2,{symbol:h,mosaicItem:m}];case 4:return[2,{symbol:h,mosaicItem:null}]}})})};f.prototype._projectAndNormalizeGeometry=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,d,f,h=this;return e.__generator(this,function(e){if(c.isNone(a.geometry))return[2,q.resolve(null)];b=a.geometry;p.isPolygon(b)?(d=b.rings,b.rings=d):p.isPolyline(b)?(f=b.paths,b.paths=f):p.isExtent(b)&&(b=m.fromExtent(b));return[2,z.checkProjectionSupport(b.spatialReference,
this.view.spatialReference).then(function(){var a=R.normalizeCentralMeridian(b),a=z.project(a,b.spatialReference,h.view.spatialReference);w.closeRingsAndFixWinding(a);return a})]})})};f.prototype._onTileUpdate=function(a){var b=y.getInfo(this.view.spatialReference);if(a.added&&0<a.added.length)for(var c=0,d=a.added;c<d.length;c++)this._addNewTile(d[c],b);if(a.removed&&0<a.removed.length)for(b=0,a=a.removed;b<a.length;b++)this._removeTile(a[b].key)};f.prototype.addOrUpdateGraphic=function(a,b,c){return this._addOrUpdateGraphic(a,
b,c)};f.prototype.addGraphic=function(a){var b=this;this._abortProcessingGraphic(a.uid);var c=u.createAbortController();this._graphicIdToAbortController.set(a.uid,c);return this._addOrUpdateGraphic(a,"add",{signal:c.signal}).then(function(){b._graphicIdToAbortController.delete(a.uid)}).catch(function(c){b._graphicIdToAbortController.delete(a.uid);if(!q.isAbortError(c))throw c;})};f.prototype._addOrUpdateGraphic=function(a,b,c){var d=this,f=this._projectAndNormalizeGeometry(a),e=this._getSymbolResources(a,
c);return q.all([f,e]).then(function(f){var e=f[0];f=f[1];return"add"===b?d._addProjectedGraphic(a,f,e):d._updateGraphic(a,f,e,c)})};f.prototype._addProjectedGraphic=function(a,b,c){this._graphicsSet.has(a)&&this._graphicStore.addOrModify(a,b,c)};f.prototype._updateGraphic=function(a,b,c,f){var e=this;if(!this._graphicStore.has(a)||q.isAborted(f))return q.resolve();c=this._graphicStore.update(a,b,c);b=c.oldBounds;c=c.newBounds;var h=0===l.width(b)&&0===l.height(b),g=0===l.width(c)&&0===l.height(c),
h=h?[]:this._tileStore.boundsIntersections(b);b=g?[]:this._tileStore.boundsIntersections(c);c=d.acquire();for(var p=0;p<h.length;p++)g=h[p],c.set(g.key,{addOrUpdate:null,remove:[this._displayIds.get(a.uid)]});for(h=0;h<b.length;h++)g=b[h],p=this._getGraphicData(this._templateStore,g,a),c.has(g.key)?(g=c.get(g.key),g.remove.length=0,g.addOrUpdate=p):c.set(g.key,{addOrUpdate:p,remove:null});var k=[];c.forEach(function(a,b){var c=e._processGraphics(a.addOrUpdate,f).then(function(c){e._patchTile(b,{type:"update",
addOrUpdate:c,remove:a.remove,end:!0})});k.push(c)});d.release(c);return q.all(k).then(function(){})};f.prototype._addTile=function(a,b){var c=l.create();this.view.featuresTilingScheme.getTileBounds(c,a);c=new A.WGLTile(a,c,!0);b={type:"update",clear:!0,addOrUpdate:b,remove:[],end:!0};this._tiles.set(a,c);this.container.addChild(c);c.setData(b)};f.prototype._addNewTile=function(a,b){var c=this,d=this._graphicStore.queryTileData(this._templateStore,a);if(b){b=Math.round((b.valid[1]-b.valid[0])/a.resolution);
for(var f=0;f<d.length;f++){var e=d[f];e.geometry&&p.isPoint(e.geometry)&&this._wrapPoints(e,b)}}var h=a.key;this._tileUpdateSet.add(a.key);this.notifyChange("updating");this._processGraphics(d).then(function(a){c._addTile(h,a);c._tileUpdateSet.delete(h);c.notifyChange("updating")}).catch(function(a){c._tileUpdateSet.delete(h);c.notifyChange("updating");if(!q.isAbortError(a))throw a;})};f.prototype._removeTile=function(a){if(this._tiles.has(a)){var b=this._tiles.get(a);this.container.removeChild(b);
b.destroy();this._tiles.delete(a)}};f.prototype._setFilterState=function(a,b){var c=this._displayIds.get(a);a=this._attributeStore.getHighlightFlag(a);this._attributeStore.setData(c,0,0,a|(b?E.FILTER_FLAG_0:0))};f.prototype._getGraphicsData=function(a,b,c){var d=y.getInfo(this.view.spatialReference);a=this._graphicStore.getGraphicsData(a,b,c);if(d)for(b=Math.round((d.valid[1]-d.valid[0])/b.resolution),d=0;d<a.length;d++)c=a[d],c.geometry&&p.isPoint(c.geometry)&&this._wrapPoints(c,b);a.sort(function(a,
b){return a.insertAfter-b.insertAfter});return a};f.prototype._getGraphicData=function(a,b,c){a=this._graphicStore.getGraphicData(a,b,c);c=[a];var d=y.getInfo(this.view.spatialReference);d&&(b=Math.round((d.valid[1]-d.valid[0])/b.resolution),a.geometry&&p.isPoint(a.geometry)&&this._wrapPoints(a,b));return c};f.prototype._wrapPoints=function(a,b){var c=a.geometry;512===b?20>c.x?a.geometry={points:[[c.x,c.y],[b,0]]}:492<c.x&&(a.geometry={points:[[c.x,c.y],[-b,0]]}):-20>c.x?a.geometry={points:[[c.x,
c.y],[b,0]]}:532<c.x&&(a.geometry={points:[[c.x,c.y],[-b,0]]})};f.prototype._processGraphics=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,h,g,l;return e.__generator(this,function(e){switch(e.label){case 0:c=a&&a.length;if(!c||!this._meshFactory)return[2,null];d=K.GraphicsReader.from(a);f=this._meshFactory;g=(h=f).analyzeGraphics;l=[d];return[4,this._matcher];case 1:return[4,g.apply(h,l.concat([e.sent(),null,null,b]))];case 2:return e.sent(),this._attributeStore.sendUpdates(),
[2,this._processAnalyzedGraphics(d)]}})})};f.prototype._processAnalyzedGraphics=function(a){var b=this._meshFactory,c=b.createMeshData(a.getApproximateSize());for(a=a.getCursor();a.next();){var d=a.readGraphic();d.insertAfter=-1===d.insertAfter?-1:this._displayIds.get(d.insertAfter);d.displayId=this._displayIds.get(d.attributes[this.uid]);b.writeGraphic(c,a)}b={};c.encode(b,[]);return x.TileData.decode(b)};f.prototype._abortProcessingGraphic=function(a){this._graphicIdToAbortController.has(a)&&this._graphicIdToAbortController.get(a).abort()};
f.prototype._getNullSymbol=function(a){a=a.geometry;return p.isPolyline(a)?B.errorPolylineSymbol2D:p.isPolygon(a)||p.isExtent(a)?B.errorPolygonSymbol2D:B.errorPointSymbol2D};f.prototype._flipUpdatingGraphics=function(){var a=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(function(){a._updatingGraphicsTimer=null;a.notifyChange("updating")},160);this.notifyChange("updating")};e.__decorate([r.property()],f.prototype,"_graphicProcessingQueue",
void 0);e.__decorate([r.property({constructOnly:!0})],f.prototype,"requestUpdateCallback",void 0);e.__decorate([r.property({constructOnly:!0})],f.prototype,"graphics",void 0);e.__decorate([r.property({dependsOn:["_graphicProcessingQueue.updating"]})],f.prototype,"updating",null);e.__decorate([r.property()],f.prototype,"view",void 0);e.__decorate([r.property()],f.prototype,"updateRequested",void 0);return f=e.__decorate([r.subclass("esri.views.2d.layers.support.GraphicsView2D")],f)}(V.GraphicsView(h.HandleOwnerMixin(n.IdentifiableMixin(k))));
a.default=g})},"esri/core/MapPool":function(){define(["require","exports","./ObjectPool"],function(g,a,e){g=function(){function a(a,h){void 0===a&&(a=50);void 0===h&&(h=50);this._pool=new e(Map,void 0,function(a){return a.clear()},h,a)}a.prototype.acquire=function(){return this._pool.acquire()};a.prototype.release=function(a){this._pool.release(a)};a.acquire=function(){return k.acquire()};a.release=function(a){return k.release(a)};return a}();var k=new g(100);return g})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(g,a,e,k,h,f,n,d,b){function c(a,b){var c;if(!b)return null;if("x"in b){var d={x:0,y:0};a=a(b.x,b.y,r);d.x=a[0];d.y=a[1];null!=b.z&&(d.z=b.z);null!=b.m&&(d.m=b.m);return d}if("xmin"in b)return d={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,r),d.xmin=c[0],d.ymin=c[1],a=a(b.xmax,b.ymax,r),d.xmax=a[0],d.ymax=a[1],b.hasZ&&(d.zmin=b.zmin,d.zmax=b.zmax,d.hasZ=!0),b.hasM&&(d.mmin=b.mmin,d.mmax=b.mmax,d.hasM=!0),d;if("rings"in b)return{rings:q(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:q(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:u(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function q(a,b){for(var c=[],d=0;d<a.length;d++)c.push(u(a[d],b));return c}function u(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],e=b(f[0],f[1],[0,0]);c.push(e);2<f.length&&e.push(f[2]);3<f.length&&e.push(f[3])}return c}function t(a,c){return!d.isValid(a)||!d.isValid(c)||d.equals(a,c)||b.canProject(a,c)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});a.projectMany=a.project=a.checkProjectionSupport=
a.doesBrowserSupportProjection=void 0;var r=[0,0];a.doesBrowserSupportProjection=function(a,b){return t(a,b)?f.isSupported():!0};a.checkProjectionSupport=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,h;return e.__generator(this,function(e){if(!b)return[2];if(Array.isArray(a)){c=0;for(d=a;c<d.length;c++)if(h=d[c],t(h.geometry&&h.geometry.spatialReference,b)){if(f.isSupported())return[2,f.load()];throw new k("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,
outSpatialReference:b});}return[2]}if(!t(a,b))return[2];if(f.isSupported())return[2,f.load()];throw new k("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});})})};var m=c.bind(null,b.lngLatToXY),v=c.bind(null,b.xyToLngLat);a.project=function(a,c,e){if(!a)return a;e||(e=c,c=a.spatialReference);return d.isValid(c)&&d.isValid(e)&&!d.equals(c,e)?b.canProject(c,e)?d.isWebMercator(e)?m(a):v(a):f.projectMany(n.jsonAdapter,[a],c,e,null)[0]:a};var l=
new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){var f,g=this;return e.__generator(this,function(e){a&&a.length&&b&&c&&!d.equals(b,c)||h.resolve(a);f={geometries:a,inSpatialReference:b,outSpatialReference:c,resolve:null};this._jobs.push(f);return[2,h.create(function(a){f.resolve=a;null===g._timer&&(g._timer=setTimeout(g._process,10))})]})})};a.prototype._process=function(){this._timer=
null;var a=this._jobs.shift();if(a){var c=a.geometries,e=a.inSpatialReference,h=a.outSpatialReference,a=a.resolve;b.canProject(e,h)?d.isWebMercator(h)?a(c.map(m)):a(c.map(v)):a(f.projectMany(n.jsonAdapter,c,e,h,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){return[2,l.push(a,b,c)]})})}})},"esri/geometry/geometryAdapters/json":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.jsonAdapter=void 0;a.jsonAdapter={convertToGEGeometry:function(a,b){return null==b?null:a.convertJSONToGeometry(b)},exportPoint:function(a,b,c){c=new e(a.getPointX(b),a.getPointY(b),c);var d=a.hasZ(b),f=a.hasM(b);d&&(c.z=a.getPointZ(b));f&&(c.m=a.getPointM(b));return c},exportPolygon:function(a,b,c){return new k(a.exportPaths(b),c,a.hasZ(b),a.hasM(b))},exportPolyline:function(a,b,c){return new h(a.exportPaths(b),c,a.hasZ(b),
a.hasM(b))},exportMultipoint:function(a,b,c){return new f(a.exportPoints(b),c,a.hasZ(b),a.hasM(b))},exportExtent:function(a,b,c){var d=a.hasZ(b),f=a.hasM(b);c=new n(a.getXMin(b),a.getYMin(b),a.getXMax(b),a.getYMax(b),c);d&&(d=a.getZExtent(b),c.zmin=d.vmin,c.zmax=d.vmax);f&&(a=a.getMExtent(b),c.mmin=a.vmin,c.mmax=a.vmax);return c}};var e=function(){return function(a,b,c){this.x=a;this.y=b;this.spatialReference=c;this.m=this.z=void 0}}(),k=function(){return function(a,b,c,f){this.rings=a;this.spatialReference=
b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);f&&(this.hasM=f)}}(),h=function(){return function(a,b,c,f){this.paths=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);f&&(this.hasM=f)}}(),f=function(){return function(a,b,c,f){this.points=a;this.spatialReference=b;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);f&&(this.hasM=f)}}(),n=function(){return function(a,b,c,f,e){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=f;this.spatialReference=e;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},
"esri/symbols/cim/cimSymbolUtils":function(){define("require exports tslib ../../symbols ../../core/promiseUtils ./cimAnalyzer ./ExpandedCIM".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.expandSymbol=a.expandSymbols=void 0;a.expandSymbols=function(b,c,d){return e.__awaiter(void 0,void 0,void 0,function(){return e.__generator(this,function(f){return[2,h.all(b.map(function(b){return a.expandSymbol(b,c,d)}))]})})};var d=function(a,c){return e.__awaiter(void 0,
void 0,void 0,function(){var b;return e.__generator(this,function(d){switch(d.label){case 0:return b=n.ExpandedCIM.bind,[4,f.analyzeCIMSymbol(a.data,c)];case 1:return[2,new (b.apply(n.ExpandedCIM,[void 0,d.sent(),a.data,a.rendererKey]))]}})})};a.expandSymbol=function(a,c,f){return e.__awaiter(void 0,void 0,void 0,function(){var b,h,g;return e.__generator(this,function(e){switch(e.label){case 0:if(!a)return[2,null];if("cim"===a.type)return[2,d(a,c)];if("web-style"!==a.type)return[3,2];b=k.WebStyleSymbol.fromJSON(a);
g={type:"cim"};return[4,b.fetchCIMSymbol(f)];case 1:return h=(g.data=e.sent().data,g.rendererKey=a.rendererKey,g),[2,d(h,c)];case 2:return[2,a]}})})}})},"esri/symbols/cim/cimAnalyzer":function(){define("require exports tslib ../../Color ../../core/Logger ../../core/promiseUtils ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./SDFHelper ./utils ../../views/2d/arcade/callExpressionWithFeature".split(" "),function(g,a,e,k,h,f,n,d,b,c,q,u,t){function r(a){switch(a){case "Butt":return 0;
case "Square":return 2;default:return 1}}function m(a){switch(a){case "Bevel":return 0;case "Miter":return 2;default:return 1}}function v(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function l(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function w(a){var b="normal",c="normal";a&&(a=a.toLowerCase(),-1!==a.indexOf("italic")?b="italic":-1!==a.indexOf("oblique")&&
(b="oblique"),-1!==a.indexOf("bold")?c="bold":-1!==a.indexOf("light")&&(c="lighter"));return{style:b,weight:c}}function p(a,b,c,d){var f;a[b]?f=a[b]:(f={},a[b]=f);f[c]=d}function y(a){return(a=a.markerPlacement)&&a.angleToLine?1:0}function z(a,b,f,e,h,g){if(a){var l=a.symbolLayers;if(l){var k,p=c.CIMSymbolHelper.getSize(a);"CIMPointSymbol"===a.type&&"Map"===a.angleAlignment&&(k=1);for(var q=l.length;q--;){var n=l[q];if(n&&!1!==n.enable){var w=[];c.OverrideHelper.findApplicableOverrides(n,b,w);switch(n.type){case "CIMSolidFill":C(n,
f,w,e,h);break;case "CIMPictureFill":B(n,f,w,e,h);break;case "CIMHatchFill":E(n,f,w,e,h);break;case "CIMGradientFill":var z=f,v=e,t=h,u=d.numericHash(JSON.stringify(n)).toString();t.push({type:"fill",templateHash:u,materialHash:0===w.length?u:N(u,z,w,v),cim:n,materialOverrides:null,colorLocked:n.colorLocked,effects:n.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1});break;case "CIMSolidStroke":x(n,f,w,e,h,"CIMPolygonSymbol"===a.type,p);break;case "CIMPictureStroke":A(n,
f,w,e,h,"CIMPolygonSymbol"===a.type,p);break;case "CIMGradientStroke":var z=f,v=e,t=h,u="CIMPolygonSymbol"===a.type,H=p,L=n.primitiveName,O=void 0!==n.width?n.width:4,S=r(n.capStyle),W=m(n.joinStyle),T=n.miterLimit,R=d.numericHash(JSON.stringify(n)).toString();t.push({type:"line",templateHash:R,materialHash:0===w.length?R:N(R,z,w,v),cim:n,materialOverrides:null,isOutline:u,colorLocked:n.colorLocked,effects:n.effects,color:{r:128,g:128,b:128,a:1},width:K(L,z,"Width",v,O),cap:K(L,z,"CapStyle",v,S),
join:K(L,z,"JoinStyle",v,W),miterLimit:K(L,z,"MiterLimit",v,T),referenceWidth:H,zOrder:M(n.name),isDashed:!1});break;case "CIMCharacterMarker":F(n,f,w,e,h);break;case "CIMPictureMarker":if(F(n,f,w,e,h))break;"CIMLineSymbol"===a.type&&(k=y(n));I(n,f,w,e,h,k,p);break;case "CIMVectorMarker":if(F(n,f,w,e,h))break;"CIMLineSymbol"===a.type&&(k=y(n));z=f;v=e;t=h;u=k;H=p;L=g;if(W=n.markerGraphics)for(O=0,n.scaleSymbolsProportionally&&(S=n.frame)&&(O=S.ymax-S.ymin),S=0;S<W.length;S++)if(T=W[S])if(R=T.symbol)switch(R.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":J(n,
T,w,z,v,t,u,H,O,L);break;case "CIMTextSymbol":G(n,T,z,w,v,t,u,H,O)}break;default:Q.error("Cannot analyze CIM layer",n.type)}}}}}}function C(a,b,c,f,e){var h=a.primitiveName,g=u.fromCIMColor(a.color),l=d.numericHash(JSON.stringify(a)).toString();e.push({type:"fill",templateHash:l,materialHash:0===c.length?l:function(){return l},cim:a,materialOverrides:null,colorLocked:a.colorLocked,color:K(h,b,"Color",f,g,L),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:a.effects})}function B(a,b,c,f,e){var h=
a.primitiveName,g=a.tintColor?u.fromCIMColor(a.tintColor):{r:255,g:255,b:255,a:1},l=d.numericHash(JSON.stringify(a)).toString(),k=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString();e.push({type:"fill",templateHash:l,materialHash:0===c.length?k:function(){return k},cim:a,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,color:K(h,b,"TintColor",f,g,L),height:K(h,b,"Height",f,a.height),scaleX:K(h,b,"ScaleX",f,a.scaleX),angle:K(h,b,"Rotation",f,a.rotation),offsetX:K(h,
b,"OffsetX",f,a.offsetX),offsetY:K(h,b,"OffsetY",f,a.offsetY)})}function E(a,b,c,f,e){var h=["Rotation","OffsetX","OffsetY"],g=c.filter(function(b){return b.primitiveName!==a.primitiveName&&-1===h.indexOf(b.propertyName)}),l=a.primitiveName,k=d.numericHash(JSON.stringify(a)).toString(),m=d.numericHash(""+a.separation+JSON.stringify(a.lineSymbol)).toString();e.push({type:"fill",templateHash:k,materialHash:0===c.length?m:N(m,b,g,f),cim:a,materialOverrides:g,colorLocked:a.colorLocked,effects:a.effects,
color:{r:255,g:255,b:255,a:1},height:K(l,b,"Separation",f,a.separation),scaleX:1,angle:K(l,b,"Rotation",f,a.rotation),offsetX:K(l,b,"OffsetX",f,a.offsetX),offsetY:K(l,b,"OffsetY",f,a.offsetY)})}function x(a,b,c,f,e,h,g){var l=d.numericHash(JSON.stringify(a)).toString(),k=a.primitiveName,p=u.fromCIMColor(a.color),q=void 0!==a.width?a.width:4,n=r(a.capStyle),w=m(a.joinStyle),z=a.miterLimit;e.push({type:"line",templateHash:l,materialHash:0===c.length?l:function(){return l},cim:a,materialOverrides:null,
isOutline:h,colorLocked:a.colorLocked,effects:a.effects,color:K(k,b,"Color",f,p,L),width:K(k,b,"Width",f,q),cap:K(k,b,"CapStyle",f,n),join:K(k,b,"JoinStyle",f,w),miterLimit:K(k,b,"MiterLimit",f,z),referenceWidth:g,zOrder:M(a.name),isDashed:!1})}function A(a,b,c,f,e,h,g){var l=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),k=a.primitiveName,p=u.fromCIMColor(a.tintColor),q=void 0!==a.width?a.width:4,n=r(a.capStyle),w=m(a.joinStyle),z=a.miterLimit,v=d.numericHash(JSON.stringify(a)).toString();
e.push({type:"line",templateHash:v,materialHash:0===c.length?l:function(){return l},cim:a,materialOverrides:null,isOutline:h,colorLocked:a.colorLocked,effects:a.effects,color:K(k,b,"TintColor",f,p,L),width:K(k,b,"Width",f,q),cap:K(k,b,"CapStyle",f,n),join:K(k,b,"JoinStyle",f,w),miterLimit:K(k,b,"MiterLimit",f,z),referenceWidth:g,zOrder:M(a.name),isDashed:!1})}function F(a,b,c,f,e){var h=a.markerPlacement;if(!h||"CIMMarkerPlacementInsidePolygon"!==h.type)return!1;var g=["Rotation","OffsetX","OffsetY"],
l=c.filter(function(b){return b.primitiveName!==a.primitiveName&&-1===g.indexOf(b.propertyName)}),k=d.numericHash(JSON.stringify(a)).toString();e.push({type:"fill",templateHash:k,materialHash:0===c.length?k:N(k,b,l,f),cim:a,materialOverrides:l,colorLocked:a.colorLocked,effects:a.effects,color:{r:255,g:255,b:255,a:1},height:K(h.primitiveName,b,"StepY",f,h.stepY),scaleX:1,angle:K(h.primitiveName,b,"GridAngle",f,h.gridAngle),offsetX:K(h.primitiveName,b,"OffsetX",f,h.offsetX),offsetY:K(h.primitiveName,
b,"OffsetY",f,h.offsetY)});return!0}function I(a,b,c,f,e,h,g){for(var l=a.primitiveName,k=a.size,m=a.scaleX,p=a.rotation,q=a.offsetX,n=a.offsetY,r=u.fromCIMColor(a.tintColor),w=d.numericHash(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),z=!1,v="",t=0;t<c.length;t++){var y=c[t];y.primitiveName===l&&(void 0!==y.value?v+="-"+y.primitiveName+"-"+y.propertyName+"-"+JSON.stringify(y.value):y.valueExpressionInfo&&(z=!0))}e.push({type:"marker",templateHash:d.numericHash(JSON.stringify(a)+v).toString(),
materialHash:z?function(){return w}:w,cim:a,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:!1,alignment:h,size:K(l,b,"Size",f,k),scaleX:K(l,b,"ScaleX",f,m),rotation:K(l,b,"Rotation",f,p),offsetX:K(l,b,"OffsetX",f,q),offsetY:K(l,b,"OffsetY",f,n),color:K(l,b,"TintColor",f,r,L),anchorPoint:a.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:a.rotateClockwise,referenceSize:g,
sizeRatio:1,markerPlacement:a.markerPlacement})}function G(a,b,f,h,g,k,m,p,q){c.OverrideHelper.findApplicableOverrides(b,h,[]);var n=b.geometry;if("x"in n&&"y"in n){var r=b.symbol,z;z=r.underline?"underline":r.strikethrough?"line-through":"none";var t=w(r.fontStyleName);r.font=e.__assign({family:r.fontFamilyName,decoration:z},t);var y=a.frame,x=a.size/q;q=a.primitiveName;z=(r.height||0)*x;var t=r.angle||0,B=((r.offsetX||0)+(n.x-.5*(y.xmin+y.xmax)))*x,n=((r.offsetY||0)+(n.y-.5*(y.ymin+y.ymax)))*x,
y=u.fromCIMColor(c.CIMSymbolHelper.getFillColor(r)),C=u.fromCIMColor(c.CIMSymbolHelper.getStrokeColor(r)),F=c.CIMSymbolHelper.getStrokeWidth(r);F||(C=u.fromCIMColor(c.CIMSymbolHelper.getFillColor(r.haloSymbol)),F=r.haloSize*x);for(var x="",A=0;A<h.length;A++){var E=h[A];E.primitiveName===q&&void 0!==E.value&&(x+="-"+E.primitiveName+"-"+E.propertyName+"-"+JSON.stringify(E.value))}h=JSON.stringify(a.effects)+Number(a.colorLocked)+JSON.stringify(a.anchorPoint)+a.anchorPointUnits+JSON.stringify(a.markerPlacement);
h=d.numericHash(JSON.stringify(b)+h+x).toString();k.push({type:"text",templateHash:h,materialHash:function(){return d.numericHash(JSON.stringify(r.font)).toString()},cim:r,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,alignment:m,anchorPoint:{x:a.anchorPoint?a.anchorPoint.x:0,y:a.anchorPoint?a.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits,fontName:r.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:K(q,f,"Size",g,z),angle:K(q,f,"Rotation",
g,t),offsetX:K(q,f,"OffsetX",g,B),offsetY:K(q,f,"OffsetY",g,n),horizontalAlignment:v(r.horizontalAlignment),verticalAlignment:l(r.verticalAlignment),text:K(b.primitiveName,f,"TextString",g,b.textString,u._adjustTextCase,r.textCase),color:y,outlineColor:C,outlineSize:F,referenceSize:p,sizeRatio:1,markerPlacement:a.markerPlacement})}}function J(a,b,f,h,g,l,k,m,p,n){var r=b.geometry;if(r){var w=b.symbol.symbolLayers;if(w)if(n)H(a,b,h,f,g,l,k,m,p);else{var z=w.length;for(n=function(){var n=w[z];if(!n||
!1===n.enable)return"continue";switch(n.type){case "CIMSolidFill":case "CIMSolidStroke":var v=q.getExtent(r);if(!v)return"continue";var t=q.getSDFMetrics(v,a.frame,a.size,a.anchorPoint,"Relative"!==a.anchorPointUnits),v=t[0],y=t[1],t=t[2],x="CIMSolidFill"===n.type,B={type:"sdf",geom:r,asFill:x},C=a.primitiveName,F=a.size,A=a.rotation||0,E=a.offsetX,I=a.offsetY,G=n.primitiveName,M=x?u.fromCIMColor(c.CIMSymbolHelper.getFillColor(n)):u.fromCIMColor(c.CIMSymbolHelper.getStrokeColor(n)),J=x?{r:0,g:0,b:0,
a:0}:u.fromCIMColor(c.CIMSymbolHelper.getStrokeColor(n)),S=c.CIMSymbolHelper.getStrokeWidth(n);if(!x&&!S)break;for(var x=!1,Z="",N=0;N<f.length;N++){var O=f[N];if(O.primitiveName===G||O.primitiveName===C)void 0!==O.value?Z+="-"+O.primitiveName+"-"+O.propertyName+"-"+JSON.stringify(O.value):O.valueExpressionInfo&&(x=!0)}var C=JSON.stringify(e.__assign(e.__assign({},a),{markerGraphics:null})),aa=d.numericHash(JSON.stringify(B)).toString(),n={type:"marker",templateHash:d.numericHash(JSON.stringify(b)+
JSON.stringify(n)+C+Z).toString(),materialHash:x?function(){return aa}:aa,cim:B,materialOverrides:null,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:k,anchorPoint:{x:y,y:t},isAbsoluteAnchorPoint:!1,size:K(a.primitiveName,h,"Size",g,F),rotation:K(a.primitiveName,h,"Rotation",g,A),offsetX:K(a.primitiveName,h,"OffsetX",g,E),offsetY:K(a.primitiveName,h,"OffsetY",g,I),scaleX:1,frameHeight:p,rotateClockwise:a.rotateClockwise,referenceSize:m,
sizeRatio:v,color:K(G,h,"Color",g,M,L),outlineColor:K(G,h,"Color",g,J,L),outlineWidth:K(G,h,"Width",g,S),markerPlacement:a.markerPlacement};l.push(n);break;default:H(a,b,h,f,g,l,k,m,p)}};z--;)n()}}}function H(a,b,f,e,h,g,l,k,m){b={type:a.type,enable:!0,name:a.name,colorLocked:a.colorLocked,primitiveName:a.primitiveName,anchorPoint:a.anchorPoint,anchorPointUnits:a.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:a.rotateClockwise,rotation:0,size:a.size,billboardMode3D:a.billboardMode3D,depth3D:a.depth3D,
frame:a.frame,markerGraphics:[b],scaleSymbolsProportionally:a.scaleSymbolsProportionally,respectFrame:a.respectFrame,clippingPath:a.clippingPath,effects:a.effects};for(var p=[],q=["Rotation","OffsetX","OffsetY"],p=e.filter(function(b){return b.primitiveName!==a.primitiveName||-1===q.indexOf(b.propertyName)}),r="",w=0;w<e.length;w++){var z=e[w];void 0!==z.value&&(r+="-"+z.primitiveName+"-"+z.propertyName+"-"+JSON.stringify(z.value))}z=c.CIMSymbolHelper.getTextureAnchor(b);e=z[0];var w=z[1],z=z[2],
v=a.primitiveName,t=a.rotation||0,y=a.offsetX||0,x=a.offsetY||0,r=d.numericHash(JSON.stringify(b)+r).toString();f={type:"marker",templateHash:r,materialHash:0===p.length?r:N(r,f,p,h),cim:b,materialOverrides:p,colorLocked:a.colorLocked,effects:a.effects,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:e,y:w},isAbsoluteAnchorPoint:!1,size:a.size,rotation:K(v,f,"Rotation",h,t),offsetX:K(v,f,"OffsetX",h,y),offsetY:K(v,f,"OffsetY",h,x),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,
g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:m,rotateClockwise:a.rotateClockwise,referenceSize:k,sizeRatio:z/n.pt2px(a.size),markerPlacement:a.markerPlacement};g.push(f)}function M(a){return a&&0===a.indexOf("Level_")?parseInt(a.substr(6),10):0}function L(a){if(!a||0===a.length)return null;a=(new k(a)).toRgba();return{r:a[0],g:a[1],b:a[2],a:a[3]}}function K(a,c,d,f,e,h,g){if(a=c[a]){var l=a[d];if("string"===typeof l||"number"===typeof l||l instanceof Array)return h?h.call(null,l,g):l;if(null!=
l&&l instanceof b.default)return function(a,b,c){a=t.default(l,a,{$view:c},f.geometryType,b);null!==a&&h&&(a=h.call(null,a,g));return null!==a?a:e}}return e}function N(a,f,e,h){for(var g=function(a){if(a.valueExpressionInfo){var c=f[a.primitiveName]&&f[a.primitiveName][a.propertyName];c instanceof b.default&&(a.fn=function(a,b,d){return t.default(c,a,{$view:d},h.geometryType,b)})}},l=0;l<e.length;l++)g(e[l]);return function(b,f,h){for(var g=0;g<e.length;g++){var l=e[g];l.fn&&(l.value=l.fn(b,f,h))}return d.numericHash(a+
c.OverrideHelper.buildOverrideKey(e)).toString()}}Object.defineProperty(a,"__esModule",{value:!0});a.analyzeCIMResource=a.analyzeCIMSymbol=void 0;var Q=h.getLogger("esri.symbols.cim.cimAnalyzer");a.analyzeCIMSymbol=function(a,c,d,h){return e.__awaiter(this,void 0,void 0,function(){var g,l,k,m,q,n,r,w,v;return e.__generator(this,function(e){switch(e.label){case 0:g=d?d:[];if(!a)return[2,g];m={};if("CIMSymbolReference"!==a.type)return[3,3];l=a.symbol;k=a.primitiveOverrides;if(!k)return[3,2];q=[];n=
function(a){var d=a.valueExpressionInfo;d&&c?(d=b.createRendererExpression(d.expression,c.spatialReference,c.fields).then(function(b){b&&p(m,a.primitiveName,a.propertyName,b)}),q.push(d)):null!=a.value&&p(m,a.primitiveName,a.propertyName,a.value)};r=0;for(w=k;r<w.length;r++)v=w[r],n(v);return[4,f.all(q)];case 1:e.sent(),e.label=2;case 2:return[3,4];case 3:return Q.error("Expect cim type to be 'CIMSymbolReference'"),[2,g];case 4:switch(l.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":z(l,
k,m,c,g,h)}return[2,g]}})})};a.analyzeCIMResource=function(a,b){if(!b||0===b.length)return a;a=JSON.parse(JSON.stringify(a));c.OverrideHelper.applyOverrides(a,b);return a}})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define("require exports tslib ../../../core/Error ../../../core/Logger ../../../geometry/support/quantizationUtils".split(" "),function(g,a,e,k,h,f){function n(a){var b={};switch(a){case "esriGeometryPoint":return function(a,c,d,e){return f.unquantizePoint(c,b,a,d,e)};
case "esriGeometryPolygon":return function(a,c,d,e){return f.unquantizePolygon(c,b,a,d,e)};case "esriGeometryPolyline":return function(a,c,d,e){return f.unquantizePolyline(c,b,a,d,e)};case "esriGeometryMultipoint":return function(a,c,d,e){return f.unquantizeMultipoint(c,b,a,d,e)};default:return h.getLogger("esri.views.2d.support.arcadeOnDemand").error(new k("mapview-arcade","Unable to handle geometryType: "+a)),function(a){return a}}}Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a,
c,f,g,k){if(a.referencesGeometry()&&k){var b=k.transform,m=k.hasZ;k=k.hasM;d.has(g)||d.set(g,n(g));g=d.get(g)(c.geometry,b,m,k);c=e.__assign(e.__assign({},c),{geometry:g})}c=a.repurposeFeature(c);try{return a.evaluate(e.__assign(e.__assign({},f),{$feature:c}))}catch(v){return h.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",v),null}};var d=new Map})},"esri/geometry/support/quantizationUtils":function(){define(["require","exports","./jsonUtils"],function(g,
a,e){function k(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function h(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function f(a,b,c){for(var d=[],f,e,g,l,m=0;m<c.length;m++){var p=c[m];if(0<m){if(g=k(a,p[0]),l=h(a,p[1]),g!==f||l!==e)d.push(b(p,g-f,l-e)),f=g,e=l}else f=k(a,p[0]),e=h(a,p[1]),d.push(b(p,f,e))}return 0<d.length?d:null}function n(a,b,c,d){return f(a,c?d?A:x:d?x:E,b)}function d(a,b,c,d){var e=[];c=c?d?A:x:d?x:E;for(d=0;d<b.length;d++){var h=f(a,c,b[d]);h&&3<=h.length&&
e.push(h)}return e.length?e:null}function b(a,b,c,d){var e=[];c=c?d?A:x:d?x:E;for(d=0;d<b.length;d++){var h=f(a,c,b[d]);h&&2<=h.length&&e.push(h)}return e.length?e:null}function c(a,b){return b*a.scale[0]+a.translate[0]}function q(a,b){return a.translate[1]-b*a.scale[1]}function u(a,b,d){var f=Array(d.length);if(!d.length)return f;var e=a.scale,h=e[0],e=e[1],g=c(a,d[0][0]);a=q(a,d[0][1]);f[0]=b(d[0],g,a);for(var l=1;l<d.length;l++){var k=d[l],g=g+k[0]*h;a-=k[1]*e;f[l]=b(k,g,a)}return f}function t(a,
b,c){for(var d=Array(c.length),f=0;f<c.length;f++)d[f]=u(a,b,c[f]);return d}function r(a,b,c,d){return u(a,c?d?A:x:d?x:E,b)}function m(a,b,c,d){return t(a,c?d?A:x:d?x:E,b)}function v(a,b,c,d){return t(a,c?d?A:x:d?x:E,b)}function l(a,b,c){var d=c[0],f=d[0],d=d[1],e=Math.min(f,b[0]),h=Math.min(d,b[1]),g=Math.max(f,b[2]);b=Math.max(d,b[3]);for(var l=1;l<c.length;l++){var k=c[l],m=k[0],k=k[1],f=f+m,d=d+k;0>m&&(e=Math.min(e,f));0<m&&(g=Math.max(g,f));0>k?h=Math.min(h,d):0<k&&(b=Math.max(b,d))}a[0]=e;a[1]=
h;a[2]=g;a[3]=b;return a}function w(a,b){if(!b.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(var c=0;c<b.length;c++)l(a,a,b[c]);return a}function p(a,b,c,d,f){b.xmin=k(a,c.xmin);b.ymin=h(a,c.ymin);b.xmax=k(a,c.xmax);b.ymax=h(a,c.ymax);b!==c&&(d&&(b.zmin=c.zmin,b.zmax=c.zmax),f&&(b.mmin=c.mmin,b.mmax=c.mmax));return b}function y(a,b,c,d,f){b.points=n(a,c.points,d,f);return b}function z(a,b,c,d,f){b.x=k(a,c.x);b.y=h(a,c.y);b!==c&&(d&&(b.z=c.z),f&&(b.m=
c.m));return b}function C(a,b,c,f,e){a=d(a,c.rings,f,e);if(!a)return null;b.rings=a;return b}function B(a,c,d,f,e){a=b(a,d.paths,f,e);if(!a)return null;c.paths=a;return c}Object.defineProperty(a,"__esModule",{value:!0});a.unquantizePolyline=a.unquantizePolygon=a.unquantizePoint=a.unquantizeMultipoint=a.unquantizeExtent=a.quantizeGeometry=a.quantizePolyline=a.quantizePolygon=a.quantizePoint=a.quantizeMultipoint=a.quantizeExtent=a.getQuantizedBoundsRings=a.getQuantizedBoundsPaths=a.getQuantizedBoundsPoints=
a.getQuantizedBoundsCoordsArrayArray=a.getQuantizedBoundsCoordsArray=a.unquantizeRings=a.unquantizePaths=a.unquantizePoints=a.unquantizeBounds=a.unquantizeCoordsArrayArray=a.unquantizeCoordsArray=a.unquantizeY=a.unquantizeX=a.quantizePaths=a.quantizeRings=a.quantizePoints=a.quantizeBounds=a.quantizeY=a.quantizeX=a.equals=a.toQuantizationTransform=void 0;var E=function(a,b,c){return[b,c]},x=function(a,b,c){return[b,c,a[2]]},A=function(a,b,c){return[b,c,a[2],a[3]]};a.toQuantizationTransform=function(a){return a?
{originPosition:"upper-left"===a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,b){if(a===b||null==a&&null==b)return!0;if(null==a||null==b)return!1;var c,d,f,e;a&&"upperLeft"===a.originPosition?(c=a.translate[0],d=a.translate[1],a=a.scale[0]):(c=a.extent.xmin,d=a.extent.ymax,a=a.tolerance);b&&"upperLeft"===b.originPosition?(f=b.translate[0],e=b.translate[1],b=
b.scale[0]):(f=b.extent.xmin,e=b.extent.ymax,b=b.tolerance);return c===f&&d===e&&a===b};a.quantizeX=k;a.quantizeY=h;a.quantizeBounds=function(a,b,c){b[0]=k(a,c[0]);b[3]=h(a,c[1]);b[2]=k(a,c[2]);b[1]=h(a,c[3]);return b};a.quantizePoints=n;a.quantizeRings=d;a.quantizePaths=b;a.unquantizeX=c;a.unquantizeY=q;a.unquantizeCoordsArray=u;a.unquantizeCoordsArrayArray=t;a.unquantizeBounds=function(a,b,d){return d?(b[0]=c(a,d[0]),b[1]=q(a,d[3]),b[2]=c(a,d[2]),b[3]=q(a,d[1]),b):[c(a,b[0]),q(a,b[3]),c(a,b[2]),
q(a,b[1])]};a.unquantizePoints=r;a.unquantizePaths=m;a.unquantizeRings=v;a.getQuantizedBoundsCoordsArray=l;a.getQuantizedBoundsCoordsArrayArray=w;a.getQuantizedBoundsPoints=function(a){var b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return l(b,b,a)};a.getQuantizedBoundsPaths=function(a){return w([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return w([0,0,0,0],a)};a.quantizeExtent=p;a.quantizeMultipoint=y;a.quantizePoint=z;a.quantizePolygon=
C;a.quantizePolyline=B;a.quantizeGeometry=function(a,b){return a&&b?e.isPoint(b)?z(a,{},b,!1,!1):e.isPolyline(b)?B(a,{},b,!1,!1):e.isPolygon(b)?C(a,{},b,!1,!1):e.isMultipoint(b)?y(a,{},b,!1,!1):e.isExtent(b)?p(a,{},b,!1,!1):null:null};a.unquantizeExtent=function(a,b,d,f,e){b.xmin=c(a,d.xmin);b.ymin=q(a,d.ymin);b.xmax=c(a,d.xmax);b.ymax=q(a,d.ymax);b!==d&&(f&&(b.zmin=d.zmin,b.zmax=d.zmax),e&&(b.mmin=d.mmin,b.mmax=d.mmax));return b};a.unquantizeMultipoint=function(a,b,c,d,f){b.points=r(a,c.points,d,
f);return b};a.unquantizePoint=function(a,b,d,f,e){b.x=c(a,d.x);b.y=q(a,d.y);b!==d&&(f&&(b.z=d.z),e&&(b.m=d.m));return b};a.unquantizePolygon=function(a,b,c,d,f){b.rings=v(a,c.rings,d,f);return b};a.unquantizePolyline=function(a,b,c,d,f){b.paths=m(a,c.paths,d,f);return b}})},"esri/symbols/cim/ExpandedCIM":function(){define(["require","exports","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});
a.ExpandedCIM=void 0;var h={marker:e.WGLGeometryType.MARKER,fill:e.WGLGeometryType.FILL,line:e.WGLGeometryType.LINE,text:e.WGLGeometryType.TEXT};g=function(){function a(a,d,b){this.layers=a;this.data=d;this.hash=this._createHash();this.rendererKey=b;for(d=0;d<a.length;d++)b=a[d],b.materialKey=k.createMaterialKey(h[b.type],this.rendererKey,!1,!1)}Object.defineProperty(a.prototype,"type",{get:function(){return"expanded-cim"},enumerable:!1,configurable:!0});a.prototype._createHash=function(){for(var a=
"",d=0,b=this.layers;d<b.length;d++)a+=b[d].templateHash;return a};return a}();a.ExpandedCIM=g})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayRecord ./mesh/MeshData ./mesh/VertexBuffer ./util/Writer".split(" "),function(g,a,e,k,h,f,n,d,b,c,q){Object.defineProperty(a,"__esModule",{value:!0});a.TileData=void 0;var u=new e.default,t=new e.default;g=function(){function a(){this.tileBufferData=
this.tileDisplayData=null}a.prototype.reshuffle=function(){u.reset();for(var b=h.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),c=0;c<b.length;c++)for(var d=b[c],e=0,g=d;e<g.length;e++){var q=g[e];q&&u.needMore(q.geometryType,q.meshData?q.meshData.vertexCount:q.vertexCount,q.meshData?q.meshData.indexData.length:q.indexCount)}e=b.length;c=new k;for(g=0;g<e;++g){c.geometries[g].indexBuffer=new Uint32Array(Math.round(1.5*u.indicesFor(g)));var q=[],r;for(r in this.tileBufferData.geometries[g].vertexBuffer)q.push(this.tileBufferData.geometries[g].vertexBuffer[r].stride);
var q=a._computeVertexAlignment(q),d=Math.round(1.5*u.verticesFor(g)),q=a._align(d,q),C;for(C in this.tileBufferData.geometries[g].vertexBuffer)d=this.tileBufferData.geometries[g].vertexBuffer[C].stride,c.geometries[g].vertexBuffer[C]={stride:d,data:n.allocateTypedArrayBuffer(q,d)}}t.reset();this.tileDisplayData.displayList.clear();for(g=0;g<e;++g){d=b[g];r=0;for(C=d;r<C.length;r++){q=C[r];if(q.meshData)q.writeMeshDataToBuffers(t.verticesFor(g),c.geometries[g].vertexBuffer,t.indicesFor(g),c.geometries[g].indexBuffer),
q.meshData=null;else{var B=this.tileBufferData.geometries[g].vertexBuffer,E=this.tileBufferData.geometries[g].indexBuffer,x=c.geometries[g].vertexBuffer,A=c.geometries[g].indexBuffer,F=t.verticesFor(g),I=t.indicesFor(g);f.copyMeshData(F,I,x,A,q,B,E);q.vertexFrom=F;q.indexFrom=I}t.needMore(g,q.vertexCount,q.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(d)}if(this.tileDisplayData.displayList.unified)for(b=0,e=this.tileDisplayData.displayObjects;b<e.length;b++)this.tileDisplayData.displayList.addToList(e[b].displayRecords);
this.tileBufferData=c};a.prototype.reshuffleV2=function(b,c,d){var e=b.addOrUpdate.tileDisplayData.displayObjects,h=this.tileDisplayData.displayObjects;u.reset();for(var g=0;g<h.length;g++)for(var l=h[g],m=0;m<l.displayRecords.length;m++){var q=l.displayRecords[m];u.needMore(q.geometryType,q.vertexCount,q.indexCount)}for(g=c;g<e.length;g++)for(var l=e[g],r=g===c?d:0,m=r;m<l.displayRecords.length;m++)q=l.displayRecords[m],u.needMore(q.geometryType,q.vertexCount,q.indexCount);for(var v=new k,g=0;5>
g;g++){v.geometries[g].indexBuffer=new Uint32Array(Math.round(1.5*u.indicesFor(g)));var l=[],r=this.tileBufferData.geometries[g].vertexBuffer,A;for(A in r)l.push(r[A].stride);var l=a._computeVertexAlignment(l),m=Math.round(1.5*u.verticesFor(g)),l=a._align(m,l),F;for(F in r)m=r[F].stride,q=n.allocateTypedArrayBuffer(l,m),v.geometries[g].vertexBuffer[F]={stride:m,data:q}}t.reset();this.tileDisplayData.displayList.clear();for(g=0;g<h.length;g++)for(l=h[g],m=0;m<l.displayRecords.length;m++){q=l.displayRecords[m];
A=q.geometryType;r=this.tileBufferData.geometries[A].vertexBuffer;F=this.tileBufferData.geometries[A].indexBuffer;var I=v.geometries[A].vertexBuffer,G=v.geometries[A].indexBuffer,J=t.verticesFor(A),H=t.indicesFor(A);f.copyMeshData(J,H,I,G,q,r,F);q.vertexFrom=J;q.indexFrom=H;t.needMore(A,q.vertexCount,q.indexCount);this.tileDisplayData.displayList.addToList(q)}if(0!==d)for(l=e[c],m=0;m<d;m++)q=l.displayRecords[m],A=q.geometryType,r=this.tileBufferData.geometries[A].vertexBuffer,F=this.tileBufferData.geometries[A].indexBuffer,
I=v.geometries[A].vertexBuffer,G=v.geometries[A].indexBuffer,J=t.verticesFor(A),H=t.indicesFor(A),f.copyMeshData(J,H,I,G,q,r,F),q.vertexFrom=J,q.indexFrom=H,t.needMore(A,q.vertexCount,q.indexCount),this.tileDisplayData.displayList.addToList(q);for(g=c;g<e.length;g++){l=e[g];for(m=r=g===c?d:0;m<l.displayRecords.length;m++)q=l.displayRecords[m],A=q.geometryType,h=b.addOrUpdate.tileBufferData.geometries[A],r=h.vertexBuffer,F=h.indexBuffer,I=v.geometries[A].vertexBuffer,G=v.geometries[A].indexBuffer,
J=t.verticesFor(A),H=t.indicesFor(A),f.copyMeshData(J,H,I,G,q,r,F),q.vertexFrom=J,q.indexFrom=H,t.needMore(A,q.vertexCount,q.indexCount),this.tileDisplayData.displayList.addToList(q);this.tileDisplayData.hasRegistry&&this.tileDisplayData.displayObjectRegistry.set(l.id,l);this.tileDisplayData.displayObjects.push(l)}this.tileBufferData=v};a.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var c=this.tileBufferData.geometries[b];a[b]={};for(var d in c.vertexBuffer)a[b][d]=
c.vertexBuffer[d].stride}return a};a.prototype.clone=function(){var b=new a;b.tileBufferData=this.tileBufferData.clone();b.tileDisplayData=this.tileDisplayData.clone();return b};a.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};a.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),c=this.tileDisplayData.serialize(new q.default(Int32Array,
this._guessSize())).buffer();b.push(c);return{result:{displayData:c,bufferData:a},transferList:b}};a.decode=function(d){var f=b.MeshData.deserializeDisplayObjects(d),e={},h;for(h in d.vertexBuffersMap)e[h]=c.VertexBuffers.decode(d.vertexBuffersMap[h]);return a.fromMeshData({displayObjects:f,vertexBuffersMap:e})};a.fromMeshData=function(b){var c=new a,d=new h.default,f=new k;d.displayObjects=b.displayObjects;for(var e in b.vertexBuffersMap){var g=b.vertexBuffersMap[e];f.geometries[e].indexBuffer=g.indexBuffer;
f.geometries[e].vertexBuffer=g.namedBuffers}c.tileDisplayData=d;c.tileBufferData=f;return c};a.bind=function(b,c){var d=new a;d.tileDisplayData=b;d.tileBufferData=c;return d};a.create=function(b,c){var f=new a;f.tileDisplayData=new h.default;f.tileDisplayData.displayObjects=b;for(var e=[0,0,0,0,0],g=[0,0,0,0,0],m=[[],[],[],[],[]],q=0;q<b.length;q++)for(var r=0,v=b[q].displayRecords;r<v.length;r++){var t=v[r];m[t.geometryType].push(t);e[t.geometryType]+=t.meshData.vertexCount;g[t.geometryType]+=t.meshData.indexData.length}b=
new k;c=[c.fill||{},c.line||{},c.icon||{},c.text||{},c.label||{}];for(q=0;5>q;q++){var r=new Uint32Array(g[q]),v=c[q],t=e[q],x={},u=void 0;for(u in v){var F={data:n.allocateTypedArrayBuffer(t,v[u]),stride:v[u]};x[u]=F}v=x;d.writeAllMeshDataToBuffers(m[q],v,r);b.geometries[q]={indexBuffer:r,vertexBuffer:v}}f.tileBufferData=b;return f};a._align=function(a,b){var c=a%b;return 0===c?a:a+(b-c)};a._computeVertexAlignment=function(a){for(var b=!1,c=!1,d=0;d<a.length;d++){var f=a[d];2===f%4?b=!0:0!==f%4&&
(c=!0)}return c?4:b?2:1};return a}();a.TileData=g})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._byGeometryType=null}Object.defineProperty(a.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!1,configurable:!0});a.prototype.reset=function(){this._byGeometryType=null};a.prototype.verticesFor=function(a){return this._byGeometryType?this._byGeometryType[a].vertices:
0};a.prototype.indicesFor=function(a){return this._byGeometryType?this._byGeometryType[a].indices:0};a.prototype.needMore=function(a,e,f){if(e||f)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),a=this._byGeometryType[a],a.vertices+=e,a.indices+=f};return a}();a.default=g})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports","./Utils"],function(g,a,e){return function(){function a(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.prototype.clone=function(){for(var e=new a,f=0;f<this.geometries.length;f++){var g=this.geometries[f],d=e.geometries[f];d.indexBuffer=g.indexBuffer.slice();d.vertexBuffer={};for(var b in g.vertexBuffer){var c=g.vertexBuffer[b],k=c.stride;d.vertexBuffer[b]={data:c.data.slice(),stride:k}}}return e};a.deserialize=
function(g){for(var f=new a,h=0;5>h;++h){f.geometries[h].indexBuffer=new Uint32Array(g.geometries[h].indexBuffer);f.geometries[h].vertexBuffer={};for(var d in g.geometries[h].vertexBuffer)f.geometries[h].vertexBuffer[d]={data:e.allocateTypedArrayBufferwithData(g.geometries[h].vertexBuffer[d].data,g.geometries[h].vertexBuffer[d].stride),stride:g.geometries[h].vertexBuffer[d].stride}}return f};a.prototype.serialize=function(){for(var a={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},f=0;5>f;++f)for(var e in this.geometries[f].vertexBuffer)a.geometries[f].vertexBuffer[e]={data:this.geometries[f].vertexBuffer[e].data.buffer,stride:this.geometries[f].vertexBuffer[e].stride};return a};a.prototype.getBuffers=
function(){for(var a=[],f=0;5>f;++f){a.push(this.geometries[f].indexBuffer.buffer);for(var e in this.geometries[f].vertexBuffer)a.push(this.geometries[f].vertexBuffer[e].data.buffer)}return a};return a}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(g,a,e,k,h){function f(a){for(var d=[[],[],[],[],[]],b=0;b<a.length;b++)for(var c=0,f=a[b].displayRecords;c<f.length;c++){var e=f[c];
d[e.geometryType].push(e)}return d}Object.defineProperty(a,"__esModule",{value:!0});a.groupRecordsByGeometryType=void 0;a.groupRecordsByGeometryType=f;g=function(){function a(){}Object.defineProperty(a.prototype,"hasRegistry",{get:function(){return!!this._displayObjectRegistry},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,b=this.displayObjects;a<b.length;a++){var c=
b[a];this._displayObjectRegistry.set(c.id,c)}}return this._displayObjectRegistry},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"displayList",{get:function(){return this._displayList},enumerable:!1,configurable:!0});a.prototype.computeDisplayList=function(a){this._displayList=new e(a);if(a){a=0;for(var b=this.displayObjects;a<b.length;a++)for(var c=0,d=b[a].displayRecords;c<d.length;c++)this._displayList.addToList(d[c])}else for(a=f(this.displayObjects),b=a.length,c=0;c<b;++c)this._displayList.addToList(a[c])};
a.prototype.clone=function(){var d=new a;this.displayObjects&&(d.displayObjects=this.displayObjects.map(function(a){return a.clone()}));return d};a.prototype.serialize=function(a){h.serializeList(a,this.displayObjects);return a};a.prototype._deserializeObjects=function(a){for(var b=a.readInt32(),b=Array(b),c=new Map,d=0;d<b.length;++d){var f=k.deserialize(a);b[d]=f;c.set(f.id,f)}this.displayObjects=b;this._displayList=null;this._displayObjectRegistry=c};a.deserialize=function(d){var b=new a;b._deserializeObjects(d);
return b};return a}();a.default=g})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports","tslib","../../../../core/Logger","./enums"],function(g,a,e,k,h){function f(a,b,c){for(var d=[],f=3;f<arguments.length;f++)d[f-3]=arguments[f];b<a.length?a.splice.apply(a,e.__spreadArrays([b,c],d)):a.push.apply(a,d)}var n=k.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");g=new Map;g.set(h.WGLDrawPhase.MAP,[h.WGLGeometryType.FILL,h.WGLGeometryType.LINE,h.WGLGeometryType.MARKER,
h.WGLGeometryType.TEXT]);g.set(h.WGLDrawPhase.LABEL,[h.WGLGeometryType.LABEL]);g.set(h.WGLDrawPhase.LABEL_ALPHA,[h.WGLGeometryType.LABEL]);g=function(){function a(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}a.prototype.replay=function(a,b,c){if(this.unified)for(var d=0,f=this.symbolLevels;d<f.length;d++)for(var e=0,g=f[d].zLevels;e<g.length;e++){var h=g[e].geometryDPInfo,k;for(k in h)if(h[k])for(var m=0,q=h[k];m<q.length;m++){var n=q[m],r=a.painter.getGeometryBrush(n.geometryType),t=
b.getGeometry(n.geometryType);r.prepareState(a,b);r.drawGeometry(a,b,n,t,c)}}};Object.defineProperty(a.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!1,configurable:!0});a.prototype.clear=function(){this.symbolLevels.length=0};a.prototype.addToList=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._addToList(a[c],b);else this._addToList(a,b)};a.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var b=null,c=0;c<
a.length;c++)b=this._removeFromList(a[c]);return b};a.prototype.byType=function(a,b){for(var c=0,d=this.symbolLevels;c<d.length;c++)for(var f=0,e=d[c].zLevels;f<e.length;f++){var g=e[f].geometryDPInfo,h=this.getDPInfoType(a);if(g[h])for(var k=0,g=g[h];k<g.length;k++)b(g[k])}};a.prototype.clone=function(){for(var b=new a(this.unified),c=0,d=this.symbolLevels;c<d.length;c++)b.symbolLevels.push(d[c].clone());return b};a.prototype.splitAfter=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,
a.geometryType),c=b.length,f=a.indexFrom+a.indexCount,e=0;e<c;++e){var g=b[e];if(g.geometryType===a.geometryType&&f>g.indexFrom&&f<=g.indexFrom+g.indexCount)return f<g.indexFrom+g.indexCount&&(a=new d,a.geometryType=g.geometryType,a.materialKey=g.materialKey,a.indexFrom=f,a.indexCount=g.indexFrom+g.indexCount-f,b.splice(e+1,0,a),g.indexCount=f-g.indexFrom),e}};a.prototype._addToList=function(a,b){var c=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType);b=null!=b?b:c.length-1;var e=0<=b&&
b<c.length?c[b]:null;null===e||e.materialKey!==a.materialKey||e.indexFrom+e.indexCount!==a.indexFrom||this.unified&&e.geometryType!==a.geometryType?(e=new d,e.indexFrom=a.indexFrom,e.indexCount=a.indexCount,e.materialKey=a.materialKey,e.geometryType=a.geometryType,f(c,b+1,0,e)):e.indexCount+=a.indexCount};a.prototype._removeFromList=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,e=void 0,g=0;g<c;++g){var h=b[g];if(a.indexFrom+a.indexCount>h.indexFrom&&
a.indexFrom<h.indexFrom+h.indexCount&&(!this.unified||h.geometryType===a.geometryType)){e=g;break}}if(void 0!==e){h=b[e];if(a.indexFrom===h.indexFrom)return h.indexCount-=a.indexCount,h.indexFrom+=a.indexCount,0===h.indexCount&&f(b,e,1),e-1;if(a.indexFrom+a.indexCount===h.indexFrom+h.indexCount)return h.indexCount-=a.indexCount,0===h.indexCount?(f(b,e,1),e-1):e;var c=h.indexFrom,g=a.indexFrom-h.indexFrom,k=a.indexCount;a=h.indexFrom+h.indexCount-(a.indexFrom+a.indexCount);h.indexCount=g;var q=new d;
q.geometryType=h.geometryType;q.materialKey=h.materialKey;q.indexFrom=c+g+k;q.indexCount=a;f(b,e+1,0,q);return e}return null};a.prototype._getDisplayList=function(a,d,f){for(var e,g=this.symbolLevels.length,k=0;k<g;k++)if(this.symbolLevels[k].symbolLevel===a){e=this.symbolLevels[k];break}e||(e=new q,e.symbolLevel=a,this.symbolLevels.push(e));var m;a=e.zLevels.length;for(g=0;g<a;g++)if(e.zLevels[g].zLevel===d){m=e.zLevels[g];break}m||(m=new c,m.geometryDPInfo=new b,m.zLevel=d,e.zLevels.push(m));var n;
if(this.unified)m.geometryDPInfo.unified||(m.geometryDPInfo.unified=[]),n=m.geometryDPInfo.unified;else switch(f){case h.WGLGeometryType.FILL:m.geometryDPInfo.fill||(m.geometryDPInfo.fill=[]);n=m.geometryDPInfo.fill;break;case h.WGLGeometryType.LINE:m.geometryDPInfo.line||(m.geometryDPInfo.line=[]);n=m.geometryDPInfo.line;break;case h.WGLGeometryType.MARKER:m.geometryDPInfo.marker||(m.geometryDPInfo.marker=[]);n=m.geometryDPInfo.marker;break;case h.WGLGeometryType.TEXT:m.geometryDPInfo.text||(m.geometryDPInfo.text=
[]);n=m.geometryDPInfo.text;break;case h.WGLGeometryType.LABEL:m.geometryDPInfo.label||(m.geometryDPInfo.label=[]);n=m.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+f+"'.")}return n};a.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case h.WGLGeometryType.FILL:return"fill";case h.WGLGeometryType.LINE:return"line";case h.WGLGeometryType.MARKER:return"marker";case h.WGLGeometryType.TEXT:return"text";case h.WGLGeometryType.LABEL:return"label";
default:n.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return a}();var d=function(){function a(){this.materialKey=null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var b=new a;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return a}(),b=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var b=new a;b.fill=
this.fill&&this.fill.map(function(a){return a.clone()});b.line=this.line&&this.line.map(function(a){return a.clone()});b.marker=this.marker&&this.marker.map(function(a){return a.clone()});b.text=this.text&&this.text.map(function(a){return a.clone()});b.label=this.label&&this.label.map(function(a){return a.clone()});b.unified=this.unified&&this.unified.map(function(a){return a.clone()});return b};return a}(),c=function(){function a(){this.geometryDPInfo=new b}a.prototype.clone=function(){var b=new a;
b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return a}(),q=function(){function a(){this.zLevels=[]}a.prototype.clone=function(){var b=new a;b.symbolLevel=this.symbolLevel;for(var c=0,d=this.zLevels;c<d.length;c++)b.zLevels.push(d[c].clone());return b};return a}();return g})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(g,a,e,k,h){return function(){function a(a){this.insertAfter=
null;this.id=a;this.displayRecords=[];this.metrics=[]}a.prototype.copy=function(){var f=new a(this.id);f.set(this);return f};a.prototype.clone=function(){var f=new a(this.id);f.displayRecords=this.displayRecords.map(function(a){return a.clone()});f.metrics=this.metrics.map(function(a){return a.clone()});f.insertAfter=this.insertAfter;return f};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=
function(a){a.push(this.id);h.serializeList(a,this.metrics);h.serializeList(a,this.displayRecords);return a};a.deserialize=function(f){var d=f.readInt32(),b=new a(d),d={id:d},c=h.deserializeList(f,k.default);c.length&&(b.metrics=c);b.displayRecords=h.deserializeList(f,e,d);return b};return a}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(g,a,e,k){return function(){function a(a,e,d,b,c){void 0===b&&(b=0);void 0===c&&(c=0);
this.id=a;this.geometryType=e;this.materialKey=d;this.minZoom=b;this.maxZoom=c;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!1,configurable:!0});a.prototype.clone=function(){return this.copy()};a.prototype.copy=function(){var f=new a(this.id,this.geometryType,this.materialKey);f.vertexFrom=this.vertexFrom;
f.vertexCount=this.vertexCount;f.indexFrom=this.indexFrom;f.indexCount=this.indexCount;f.zOrder=this.zOrder;f.symbolLevel=this.symbolLevel;f.meshData=this.meshData;f.minZoom=this.minZoom;f.maxZoom=this.maxZoom;return f};a.prototype.setMeshDataFromBuffers=function(a,g,d){var b=new e,c;for(c in g){for(var f=g[c].stride,h=g[c].data,n=[],r=k.strideToPackingFactor(f),m=0;m<f*a.vertexCount/r;++m)n[m]=h[m+f*a.vertexFrom/r];b.vertexData.set(c,n)}for(m=b.indexData.length=0;m<a.indexCount;++m)b.indexData[m]=
d[m+a.indexFrom]-a.vertexFrom;b.vertexCount=a.vertexCount;this.meshData=b};a.prototype.readMeshDataFromBuffers=function(a,g){this.meshData?this.meshData.clear():this.meshData=new e;for(var d in a){for(var b=a[d].stride,c=a[d].data,f=[],h=k.strideToPackingFactor(b),n=0;n<b*this.vertexCount/h;++n)f[n]=c[n+b*this.vertexFrom/h];this.meshData.vertexData.set(d,f)}for(n=this.meshData.indexData.length=0;n<this.indexCount;++n)this.meshData.indexData[n]=g[n+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=
this.vertexCount};a.prototype.writeMeshDataToBuffers=function(a,e,d,b){for(var c in e)for(var f=e[c].stride,g=this.meshData.vertexData.get(c),h=e[c].data,n=k.strideToPackingFactor(f),m=0;m<f*this.meshData.vertexCount/n;++m)h[m+f*a/n]=g[m];for(m=0;m<this.meshData.indexData.length;++m)b[m+d]=this.meshData.indexData[m]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=d;this.indexCount=this.meshData.indexData.length};a.writeAllMeshDataToBuffers=function(a,e,d){for(var b=0,
c=0,f=0;f<a.length;f++){var g=a[f];g.writeMeshDataToBuffers(b,e,c,d);b+=g.vertexCount;c+=g.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};a.deserialize=function(f,e){var d=f.readInt32(),
b=f.readInt32();e=new a(e.id,d,b);e.vertexFrom=f.readInt32();e.vertexCount=f.readInt32();e.indexFrom=f.readInt32();e.indexCount=f.readInt32();e.minZoom=f.readInt32();e.maxZoom=f.readInt32();return e};return a}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(g,a){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};a.prototype.update=
function(a,e,f){for(var g in a)this.vertexData.set(g,a[g]);for(g in this.vertexData)null===a[g]&&this.vertexData.delete(g);this.vertexCount=e;this.indexData=f};return a}()})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});var d=e.getLogger("esri/views/2d/engine/webgl/collisions/Metric");
g=function(){function a(a,b,d,f,e){this.id=a;this.range=b;this.boxes=null;this.minZoom=-1;this.placementPadding=this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=k.vec2f32.fromValues(d,f);this.baseZoom=e}a.prototype.add=function(a,b,d){a.x+=b;a.y+=d;this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):this.bounds=a};a.prototype.computeIndex=function(){var a=Math.floor(this.anchor[1]/h.COLLISION_BUCKET_SIZE);
this.xBucket=Math.floor(this.anchor[0]/h.COLLISION_BUCKET_SIZE);this.yBucket=a;a=h.TILE_SIZE/h.COLLISION_BUCKET_SIZE;this.hasVV?this.yOverflow=this.xOverflow=a:(this.xOverflow=Math.min(a,Math.ceil(2*this.bounds.width/h.COLLISION_BUCKET_SIZE)),this.yOverflow=Math.min(a,Math.ceil(2*this.bounds.height/h.COLLISION_BUCKET_SIZE)))};a.prototype.findCollisionDelta=function(a){var b=this.bounds.findCollisionDelta(a.bounds),c=this.boxes&&this.boxes.length,d=a.boxes&&a.boxes.length;return Math.abs(b)>h.COLLISION_MAX_ZOOM_DELTA||
!c&&!d?b:c&&d?this._boxesToBoxes(a):c?this._boxesToBox(a):this._boxToBoxes(a)};a.prototype.computeVVOffset=function(a,b){b||d.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+b);var c=this.size;this.hasVV&&(a=b(a),c=isNaN(a)||null==a||Infinity===a?this.size:a);this._computeOffset(c)};a.prototype.setPlacementOffset=function(a,b,d,f,e){this.hasVV=a;this.size=b;this.placementPadding=Math.round(d);this.directionX=f;this.directionY=e};a.prototype.clone=
function(){var b=new a(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);b.minZoom=this.minZoom;this.bounds&&(b.bounds=this.bounds.clone());this.boxes&&(b.boxes=this.boxes.map(function(a){return a.clone()}));b.xBucket=this.xBucket;b.yBucket=this.yBucket;b.xOverflow=this.xOverflow;b.yOverflow=this.yOverflow;b.hasVV=this.hasVV;b.size=this.size;b.directionX=this.directionX;b.directionY=this.directionY;b.offsetX=this.offsetX;b.offsetY=this.offsetY;return b};a.prototype._boxToBoxes=function(a){var b=
-Infinity,c=0;for(a=a.boxes;c<a.length;c++)var d=this.bounds.findCollisionDelta(a[c]),b=Math.max(d,b);return b};a.prototype._boxesToBox=function(a){for(var b=this.boxes[0].findCollisionDelta(a.bounds),c=1;c<this.boxes.length;c++)var d=this.boxes[c].findCollisionDelta(a.bounds),b=Math.max(d,b);return b};a.prototype._boxesToBoxes=function(a){for(var b=-Infinity,c=0;c<this.boxes.length;c++)for(var d=this.boxes[c],f=0,e=a.boxes;f<e.length;f++)var g=d.findCollisionDelta(e[f]),b=Math.max(g,b);return b};
a.prototype._computeOffset=function(a){this.offsetX=this.directionX*(a/2+this.placementPadding);this.offsetY=this.directionY*(a/2+this.placementPadding)};a.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?1:0);a.push(this.size);a.writeF32(this.directionX);a.writeF32(this.directionY);a.push(this.offsetX);a.push(this.offsetY);a.push(this.placementPadding);
n.serializeList(a,this.boxes);return a};a.deserialize=function(b){var c=b.readInt32(),d=f.default.deserialize(b),e=b.readInt32(),g=b.readInt32(),h={from:e,count:g},k=b.readInt32(),l=b.readInt32(),w=b.readInt32(),e=b.readInt32(),g=b.readInt32(),p=b.readF32(),y=b.readF32(),z=b.readInt32(),C=b.readInt32(),B=b.readInt32();b=n.deserializeList(b,f.default);c=new a(c,h,k,l,w);c.bounds=d;c.boxes=b;c.setPlacementOffset(!!e,g,B,p,y);c.offsetX=z;c.offsetY=C;c.computeIndex();e||c._computeOffset(g);return c};
return a}();a.default=g})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,d,b){this.center=k.vec2f32.fromValues(a,e);this.centerT=k.vec2f32.create();this.halfWidth=d/2;this.halfHeight=b/2;this.width=d;this.height=b}Object.defineProperty(a.prototype,"x",{get:function(){return this.center[0]},
set:function(a){this.center[0]=a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"blX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"blY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"trX",
{get:function(){return this.center[0]-this.halfWidth},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"trY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xmin",{get:function(){return this.x-this.halfWidth},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xmax",{get:function(){return this.x+this.halfWidth},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"ymin",{get:function(){return this.y-
this.halfHeight},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"ymax",{get:function(){return this.y+this.halfHeight},enumerable:!1,configurable:!0});a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};a.prototype.findCollisionDelta=function(a,g){void 0===g&&(g=4);return e.log2(Math.min((a.halfWidth+this.halfWidth+
g)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight+g)/Math.abs(a.centerT[1]-this.centerT[1])))};a.prototype.extend=function(a){var f=Math.min(this.xmin,a.xmin),d=Math.min(this.ymin,a.ymin),b=Math.max(this.xmax,a.xmax)-f;a=Math.max(this.ymax,a.ymax)-d;this.width=b;this.height=a;this.halfWidth=b/2;this.halfHeight=a/2;this.x=f+b/2;this.y=d+a/2};a.deserialize=function(f){var e=f.readF32(),d=f.readF32(),b=f.readInt32();f=f.readInt32();return new a(e,d,b,f)};return a}();a.default=g})},
"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.deserializeList=a.serializeList=void 0;a.serializeList=function(a,g){if(null===g)a.push(0);else{a.push(g.length);for(var e=0;e<g.length;e++)g[e].serialize(a);return a}};a.deserializeList=function(a,g,h){for(var f=a.readInt32(),f=Array(f),e=0;e<f.length;e++)f[e]=g.deserialize(a,h);return f}})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("require exports ../WGLDisplayObject ../WGLDisplayRecord ../collisions/Metric ../util/Reader ../util/serializationUtils ../util/Writer".split(" "),
function(g,a,e,k,h,f,n,d){Object.defineProperty(a,"__esModule",{value:!0});a.MeshData=void 0;g=function(){function a(a,b){this.vertexVectorsMap=a;this._currentIndex=-1;this._currentMetricOffset=this._currentRecordOffset=0;a=4*(8*b.records+1);var c=4*(20*b.metrics+1);this._bufDisplayObjects=new d.default(Uint32Array,4*(4*b.features+1)+4);this._bufDisplayRecords=new d.default(Uint32Array,a+4);this._bufMetrics=new d.default(Uint32Array,c+4);this._bufDisplayObjects.push(0);this._bufDisplayRecords.push(0);
this._bufMetrics.push(0)}Object.defineProperty(a.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!1,configurable:!0});a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.currentDisplayRecordCount=function(){return this._bufDisplayRecords[this._currentRecordOffset]};
a.prototype.writeDisplayObject=function(a,b){this._bufDisplayObjects.incr(0);this._currentIndex=this._bufDisplayObjects.push(a);this._bufDisplayObjects.push(b);this._bufDisplayObjects.push(0);this._bufDisplayObjects.push(0);this._currentMetricOffset=this._currentRecordOffset=0};a.prototype.hasDisplayRecords=function(){return 0!==this._currentRecordOffset};a.prototype.endDisplayObject=function(){this.hasDisplayRecords()||this._rollbackDisplayObject()};a.prototype.writeDisplayRecord=function(a,b,d,
f,e,g,h,l){void 0===h&&(h=0);void 0===l&&(l=0);0===this._currentRecordOffset&&(this._currentRecordOffset=this._bufDisplayRecords.push(0),this._bufDisplayObjects.setValue(this._currentIndex+2,this._currentRecordOffset));this._bufDisplayRecords.incr(this._currentRecordOffset);this._bufDisplayRecords.push(a);this._bufDisplayRecords.push(b);this._bufDisplayRecords.push(d);this._bufDisplayRecords.push(f);this._bufDisplayRecords.push(e);this._bufDisplayRecords.push(g);this._bufDisplayRecords.push(h);this._bufDisplayRecords.push(l)};
a.prototype.writeMetrics=function(a){0===this._currentMetricOffset&&(this._bufDisplayObjects.setValue(this._currentIndex+3,this._bufMetrics.length),this._currentMetricOffset=this._bufMetrics.length);n.serializeList(this._bufMetrics,a)};a.deserializeDisplayObjects=function(a){var b=a.bufMetrics,c=a.bufRecords;a=new f.default(a.bufDisplayObjects);var c=new f.default(c),b=new f.default(b),d=[],g=a.readInt32();c.readInt32();for(b.readInt32();g--;){var m=a.readInt32(),v=a.readInt32(),l=a.readInt32(),w=
a.readInt32(),p=new e(m);0!==v&&(p.insertAfter=v);0!==l&&(p.displayRecords=n.deserializeList(c,k,{id:m}));0!==w&&(p.metrics=n.deserializeList(b,h.default));d.push(p)}return d};a.prototype.encode=function(a,b){for(var c={},d=0;d<this.vertexVectorsMap.length;d++){var f=this.vertexVectorsMap[d];c[d]={};f.transfer(c[d],b)}a.bufDisplayObjects=this._bufDisplayObjects.buffer();a.bufRecords=this._bufDisplayRecords.buffer();a.bufMetrics=this._bufMetrics.buffer();b.push(a.bufDisplayObjects);b.push(a.bufMetrics);
b.push(a.bufRecords);a.vertexBuffersMap=c;this.destroy()};a.prototype.destroy=function(){this._bufMetrics=this._bufDisplayRecords=this._bufDisplayObjects=this.vertexVectorsMap=null};a.prototype._rollbackDisplayObject=function(){this._bufDisplayObjects.decr(0);this._bufDisplayObjects.seek(this._bufDisplayObjects.length-4);this._currentIndex=this._bufDisplayObjects.length};return a}();a.MeshData=g})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,
"__esModule",{value:!0});g=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();a.default=g})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e){this._pos=
0;e=e?this._roundToNearest(e,a.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(e);this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!1,configurable:!0});a.prototype._roundToNearest=function(a,e){a=Math.round(a);return a+(e-a%e)};a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=this._roundToNearest(1.5*(this._array.byteLength+a*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);
a=new ArrayBuffer(a);var e=new this._ctor(a);e.set(this._buffer,0);this._array=a;this._buffer=e}};a.prototype.writeF32=function(a){this._ensureSize(1);var e=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return e};a.prototype.push=function(a){this._ensureSize(1);var e=this._pos;this._buffer[this._pos++]=a;return e};a.prototype.writeFixed=function(a){this._buffer[this._pos++]=a};a.prototype.setValue=function(a,e){this._buffer[a]=e};a.prototype.getValue=function(a){return this._buffer[a]};
a.prototype.incr=function(a){this._buffer[a]++};a.prototype.decr=function(a){this._buffer[a]--};a.prototype.writeRegion=function(a){this._ensureSize(a.length);var e=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return e};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.toArray=function(){for(var a=this._array,e=[],f=0;f<a.byteLength/4;f++)e.push(a[f]);return e};a.prototype.seek=function(a){this._pos=a};a.prototype.destroy=function(){this._buffer=
this._array=null};return a}();a.default=g})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.VertexBuffers=void 0;var k=function(){function a(a,e,d){this.data=a;this.stride=e;this.vertexCount=d}a.decode=function(f){var g=e.allocateTypedArrayBufferwithData(f.data,f.stride);return new a(g,f.stride,f.vertexCount)};a.fromVertexVector=function(f){var g=e.allocateTypedArrayBufferwithData(f.data.buffer(),
f.stride);return new a(g,f.stride,f.vertexCount)};return a}();a.default=k;g=function(){function a(a,e,d){this.geometryType=a;this.indexBuffer=new Uint32Array(e);this.namedBuffers=d}a.decode=function(f){var e=f.geometryType,d=f.indexBuffer,b={},c;for(c in f.namedBuffers)b[c]=k.decode(f.namedBuffers[c]);return new a(e,d,b)};a.fromVertexVectors=function(f){var e=f.geometryType,d=f.indexVector.buffer(),b={},c;for(c in f.namedVectors)b[c]=k.fromVertexVector(f.namedVectors[c]);return new a(e,d,b)};return a}();
a.VertexBuffers=g})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports tslib ../../../../core/CircularArray ../../../../core/has ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./enums ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l){Object.defineProperty(a,
"__esModule",{value:!0});a.WGLTile=void 0;var w=new Set;g=function(a){function g(b,c,f){void 0===f&&(f=!1);b=a.call(this,b,c,[q.TILE_SIZE,q.TILE_SIZE])||this;b._data=null;b._displayList=null;b._wglBuffers=null;b._deferPatches=!1;b._dirtyMap=new u.default;b._labelIndex=null;b._lastCommitTime=0;b._patchQueue=new k.default(100);b.fader=new m.default;b._dirty=!0;b._replaceBuffers=!1;b._uploadsLocked=!1;b._hasData=!1;b._invalidated=!1;b.transforms.labelMat2d=d.mat2df32.create();b._ensureCorrectZOrder=
f;b._deferPatches=!f;return b}e.__extends(g,a);g.prototype.destroy=function(){a.prototype.destroy.call(this);this.clear()};Object.defineProperty(g.prototype,"displayObjects",{get:function(){var a;return null!==(a=this._displayObjects)&&void 0!==a?a:[]},enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){this._dirty=a;this.requestRender()},enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,"hasData",{get:function(){return!!this._hasData},
enumerable:!1,configurable:!0});Object.defineProperty(g.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!1,configurable:!0});g.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};g.prototype.getDisplayList=function(){return this._displayList};g.prototype.setTransform=function(d,f){a.prototype.setTransform.call(this,d,f);var e=this.transforms.labelMat2d;f=d.getScreenTransform(e,f);var g=c.vec2f32.create();b.vec2.transformMat2d(g,
this.coords,f);n.mat2d.identity(e);n.mat2d.translate(e,e,g);n.mat2d.multiply(e,d.viewMat2d,e)};g.prototype.setData=function(a){var b=a.addOrUpdate,c=a.remove;a.clear&&(this.clear(),this._patchQueue.clear(),this._hasData=!1);"replace"===a.type&&(this._replaceBuffers=!0,this._patchQueue.clear(),this._data=null);!this._data&&b&&b.tileDisplayData.displayObjects.length?(b.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new u.default,this._dispRecStore=t.default.fromTileData(b,
this._dirtyMap),this._data=b,this._dirtyMap.markAllDirty(),this._hasData=!0,a.end&&this.ready()):this._data?b&&b.tileDisplayData.displayObjects.length||c.length?this._deferPatches?this._patchQueue.enqueue(a):this._doPatchData(a):a.end&&this.ready():a.end&&this.ready();a.end&&!this._data&&this.clear();this.requestRender();this.emit("change")};g.prototype.lockUploads=function(){this._uploadsLocked=!0};g.prototype.unlockUploads=function(){this._uploadsLocked=!1;this.requestRender()};g.prototype.commitChanges=
function(a){if(!a.time||a.time!==this._lastCommitTime){this._lastCommitTime=a.time;this.fader.step()||this.requestRender();if(this._patchQueue.size){var b=this._patchQueue.dequeue();f.isSome(b)&&(b.end&&this.ready(),this._doPatchData(b),this.requestRender(),this._hasData=!0)}if(this._uploadsLocked)this.requestRender();else if(this.visible&&this._data){if(this._replaceBuffers)for(this._wglBuffers&&this._wglBuffers.dispose(),this._wglBuffers=null,this._replaceBuffers=!1;this._patchQueue.size;)b=this._patchQueue.dequeue(),
f.isSome(b)&&(b.end&&this.ready(),this._doPatchData(b),this._hasData=!0);this._wglBuffers||(this._wglBuffers=new l.default(a.context));if(this._dirtyMap.hasDirty()||this._invalidated)this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._rebuildLabelIndex(),this._dirtyMap.markAllClean()}}};g.prototype.clear=function(){this._dispRecStore=
this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};g.prototype._doPatchData=function(a){try{if("new"===a.type){if(!a.addOrUpdate)return;this._invalidated=!0;var b=this._bulkAddFeatures(a);b&&(this._dirtyMap.markAllDirty(),this._data.reshuffleV2(a,b.objectIndex,b.recordIndex),this._dispRecStore=t.default.fromTileData(this._data,this._dirtyMap))}else this._invalidated=!0,this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=
t.default.fromTileData(this._data,this._dirtyMap))}catch(B){}this.requestRender()};g.prototype._rebuildLabelIndex=function(){var a,b;if(null!==(b=null===(a=this._data)||void 0===a?void 0:a.tileBufferData.geometries[r.WGLGeometryType.LABEL])&&void 0!==b&&b.indexBuffer.length)for(this.isDirty=!0,this._labelIndex=this._initLabelIndex(),a=0,b=this.displayObjects;a<b.length;a++)for(var c=0,d=b[a].metrics;c<d.length;c++)this._insertIntoLabelIndex(d[c])};g.prototype._insertIntoLabelIndex=function(a){0>a.xBucket||
0>a.yBucket||3<a.yBucket||3<a.xBucket||this.labelIndex[a.yBucket][a.xBucket].push(a)};g.prototype._initLabelIndex=function(){for(var a=[],b=0;b<q.TILE_SIZE/q.COLLISION_BUCKET_SIZE;b++){a.push([]);for(var c=0;c<q.TILE_SIZE/q.COLLISION_BUCKET_SIZE;c++)a[b].push([])}return a};g.prototype._bulkAddFeatures=function(a){for(var b=a.addOrUpdate.tileDisplayData.displayObjects,c=this._data.tileDisplayData.displayObjects,d=0;d<b.length;d++){for(var f=b[d],e=0;e<f.displayRecords.length;++e){var g=f.displayRecords[e];
if(!this._dispRecStore.tryAddMeshData(g,a.addOrUpdate.tileBufferData.geometries[g.geometryType]))return{objectIndex:d,recordIndex:e}}this._data.tileDisplayData.hasRegistry&&this._data.tileDisplayData.displayObjectRegistry.set(f.id,f);c.push(f)}return null};g.prototype._patchData=function(a){for(var b=!0,c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],d=(a.remove||[]).slice(),f=0;f<c.length;f++){var e=c[f];null!=e.insertAfter&&d.push(e.id)}for(e=0;e<
d.length;e++){var g=d[e];if(f=this._data.tileDisplayData.displayObjectRegistry.get(g)){this._data.tileDisplayData.displayList.removeFromList(f.displayRecords);for(var h=0,l=f.displayRecords;h<l.length;h++)this._dispRecStore.delete(l[h]);this._data.tileDisplayData.displayObjectRegistry.delete(g);f=this._data.tileDisplayData.displayObjects.indexOf(f);this._data.tileDisplayData.displayObjects.splice(f,1)}}for(d=0;d<c.length;d++){e=c[d];f=this._data.tileDisplayData.displayObjectRegistry.get(e.id);g=void 0;
if(f){h=f.displayRecords;f.set(e);f.displayRecords=h;h=f.displayRecords.length;for(l=0;l<h;++l){var k=f.displayRecords[l],m=e.displayRecords[l];if(l>=e.displayRecords.length||k.geometryType!==m.geometryType||k.symbolLevel!==m.symbolLevel||k.zOrder!==m.zOrder||k.materialKey!==m.materialKey)this._dispRecStore.delete(f.displayRecords[l]),l<e.displayRecords.length&&(f.displayRecords[l]=void 0)}f.displayRecords.length=e.displayRecords.length;f.metrics=e.metrics}else if(f=e.copy(),f.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(e.id,
f),l=void 0,k=this._data.tileDisplayData.displayObjects,null!=f.insertAfter?(g={},0<=f.insertAfter?(h=this._data.tileDisplayData.displayObjectRegistry.get(f.insertAfter))?(l=k.indexOf(h)+1,l<k.length?k.splice(l,0,f):(k.push(f),l=k.length)):(k.push(f),l=k.length):(k.unshift(f),l=0)):(k.push(f),l=k.length),g){m=void 0;if(this._data.tileDisplayData.displayList.unified)m=0<e.displayRecords.length?1:0;else{w.clear();for(var m=0,p=e.displayRecords;m<p.length;m++)h=this._data.tileDisplayData.displayList.getDPInfoType(p[m].geometryType),
w.add(h);m=w.size}p=0;for(--l;0<=l&&p<m;--l)for(var q=k[l].displayRecords.length-1;0<=q&&p<m;--q){var n=k[l].displayRecords[q],h=this._data.tileDisplayData.displayList.getDPInfoType(n.geometryType);g[h]||(g[h]=n,++p)}}p=e.displayRecords.length;for(l=0;l<p;++l){m=e.displayRecords[l];(k=f.displayRecords[l])?(k.meshData=m.meshData,k.materialKey=m.materialKey):(k=m.copy(),k.vertexFrom=void 0,k.indexFrom=void 0,f.displayRecords[l]=k);var q=m.geometryType,h=this._data.tileDisplayData.displayList.getDPInfoType(q),
n=a.addOrUpdate.tileBufferData.geometries[q],q=n.vertexBuffer,n=n.indexBuffer,r=void 0;g&&(r=g[h]?this._data.tileDisplayData.displayList.splitAfter(g[h]):-1);b=this._dispRecStore.setMeshData(k,m,q,n,r)&&b;g&&null!=k.indexFrom&&null!=k.indexFrom&&(g[h]=k)}}return b};return g}(v.TiledDisplayObject);a.WGLTile=g})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(g,a,e){function k(a,f,e){if(!a.allDirty)if(null!=a.from&&null!=a.count){var d=Math.min(a.from,
f);f=Math.max(a.from+a.count,f+e)-d;a.from=d;a.count=f}else a.from=f,a.count=e}Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){this._dirties=e.createGeometryData(function(){return{indices:{from:null,count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}a.prototype.hasDirty=function(){for(var a=0,e=this._dirties;a<e.length;a++){var d=e[a];if(null!==d.data.indices.count||d.data.indices.allDirty)return!0}return!1};a.prototype.markAllClean=
function(){for(var a=0,e=this._dirties;a<e.length;a++){var d=e[a];d.data.indices.from=null;d.data.indices.count=null;d.data.indices.allDirty=!1;for(var b in d.buffers)d.buffers[b].data.vertices.from=null,d.buffers[b].data.vertices.count=null,d.buffers[b].data.vertices.allDirty=!1}};a.prototype.markAllDirty=function(){for(var a=0,e=this._dirties;a<e.length;a++){var d=e[a];d.data.indices.allDirty=!0;for(var b in d.buffers)d.buffers[b].data.vertices.allDirty=!0}};a.prototype.forEach=function(a){for(var f=
0;f<this._dirties.length;++f){var d=this._dirties[f],b={},c;for(c in d.buffers){var e=d.buffers[c].data.vertices;if(e.allDirty||null!=e.from&&null!=e.count&&0<e.count)b[c]=e}d=d.data.indices;e=void 0;e=d.allDirty||null!=d.from&&null!=d.count&&0<d.count?{indices:d,vertices:b}:{indices:null,vertices:b};(e.indices||0<Object.keys(e).length)&&a(e,f)}};a.prototype.markDirtyIndices=function(a,e,d){k(this._dirties[a].data.indices,e,d)};a.prototype.markDirtyVertices=function(a,e,d,b){k(this._dirties[a].buffers[e].data.vertices,
d,b)};return a}();a.default=g})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});var f=["FILL","LINE","MARKER","TEXT","LABEL"];g=function(){function a(a,b,c,f){this._strides=a;this._displayList=b;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=c;for(var d in a){this._freeListsAndStorage[d]={vtxFreeList:f?new k.FreeList(f):null,idxFreeList:f?
new k.FreeList(f):null,vertexBuffers:{},indexBuffer:f?new Uint32Array(f):null};for(var e in a[d])this._freeListsAndStorage[d].vertexBuffers[e]={data:f?h.allocateTypedArrayBuffer(f,a[d][e]):null,stride:a[d][e]}}}a.fromTileData=function(d,b){for(var c=d.getStrides(),e={},g=0;g<c.length;g++)e[f[g]]=c[g];for(var c=[0,0,0,0,0],g=[0,0,0,0,0],n=0,r=d.tileDisplayData.displayObjects;n<r.length;n++)for(var m=0,v=r[n].displayRecords;m<v.length;m++){var l=v[m];c[l.geometryType]=Math.max(c[l.geometryType],l.vertexFrom+
l.vertexCount);g[l.geometryType]=Math.max(g[l.geometryType],l.indexFrom+l.indexCount)}b=new a(e,d.tileDisplayData.displayList,b,null);for(e=0;e<d.tileBufferData.geometries.length;++e){n=c[e];m=g[e];v=d.tileBufferData.geometries[e];r=b._storageFor(f[e]);l=d.tileBufferData.geometries[e].indexBuffer;r.indexBuffer=l;r.idxFreeList=new k.FreeList(l.length);r.idxFreeList.allocate(m);var m=void 0,w;for(w in v.vertexBuffer)v=d.tileBufferData.geometries[e].vertexBuffer[w],r.vertexBuffers[w].data=v.data,r.vertexBuffers[w].stride=
v.stride,l=h.strideToPackingFactor(v.stride),v=v.data.length*l/v.stride,m||(m=v);r.vtxFreeList=new k.FreeList(m);r.vtxFreeList.allocate(n)}return b};a.prototype.delete=function(a){var b=f[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};a.prototype.setMeshData=function(a,b,c,e,g){var d=f[a.geometryType];a.meshData=null;var k=void 0,m=void 0;void 0===a.vertexFrom?
(m=b.vertexCount,k=this._allocateVertices(d,m)):b.vertexCount>a.vertexCount?(this._freeVertices(d,a.vertexFrom,a.vertexCount),m=b.vertexCount,k=this._allocateVertices(d,m)):b.vertexCount===a.vertexCount?(k=a.vertexFrom,m=a.vertexCount):(this._freeVertices(d,a.vertexFrom+b.vertexCount,a.vertexCount-b.vertexCount),k=a.vertexFrom,m=b.vertexCount);var q=!0,l=void 0,n=void 0,p=void 0;void 0===a.indexFrom?(l=g,p=b.indexCount,n=this._allocateIndices(d,p)):b.indexCount>a.indexCount?(l=this._displayList.removeFromList(a),
this._freeIndices(d,a.indexFrom,a.indexCount),p=b.indexCount,n=this._allocateIndices(d,p)):b.indexCount===a.indexCount?(q=!1,n=a.indexFrom,p=a.indexCount):(l=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom+b.indexCount,a.indexCount-b.indexCount),n=a.indexFrom,p=b.indexCount);if(-1!==k&&-1!==n){g=this._storageFor(d);h.copyMeshData(k,n,g.vertexBuffers,g.indexBuffer,b,c,e);a.vertexFrom=k;a.indexFrom=n;a.vertexCount=b.vertexCount;a.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,
a.indexFrom,a.indexCount);for(var y in c)this._dirtyMap.markDirtyVertices(a.geometryType,y,a.vertexFrom,a.vertexCount)}q&&this._displayList.addToList(a,l);return!0}-1!==k&&this._freeVertices(d,k,m);-1!==n&&this._freeIndices(d,n,p);a.setMeshDataFromBuffers(b,c,e);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};a.prototype.tryAddMeshData=function(a,b){var c=b.vertexBuffer;b=b.indexBuffer;var d=f[a.geometryType],e=this._allocateVertices(d,a.vertexCount);if(-1===e)return this._freeVertices(d,
e,a.vertexCount),!1;var g=this._allocateIndices(d,a.indexCount);if(-1===g)return this._freeVertices(d,e,a.vertexCount),this._freeIndices(d,g,a.indexCount),!1;d=this._storageFor(d);h.copyMeshData(e,g,d.vertexBuffers,d.indexBuffer,a,c,b);a.vertexFrom=e;a.indexFrom=g;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var k in c)this._dirtyMap.markDirtyVertices(a.geometryType,k,e,a.vertexCount)}this._displayList.addToList(a);return!0};a.prototype._allocateVertices=
function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};a.prototype._freeVertices=function(a,b,c){this._storageFor(a).vtxFreeList.free(b,c)};a.prototype._freeIndices=function(a,b,c){this._storageFor(a).idxFreeList.free(b,c)};a.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:b};a.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};
a.prototype._stridesFor=function(a,b){return this._strides[a][b]};return a}();a.default=g})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.FreeList=void 0;var e=function(){function a(a){this._largestRange=null;this._parent=a;this._updateLargestRange()}Object.defineProperty(a.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!1,configurable:!0});a.prototype.rangeCreated=function(a){if(!this._largestRange||
a.count>this._largestRange.count)this._largestRange=a};a.prototype.rangeResized=function(a,e){if(a===this._largestRange)a.count<e&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.findBestRange=function(a){for(var e=this._parent._freeHead,g=null;null!==e;)e.count>=a&&(!g||e.count-a<g.count-a)&&(g=e),e=e.next;return g};a.prototype.findAdjacentRanges=function(a,e){for(var f=!0,d=!1,b=null,c=this._parent._freeHead;f&&!d;){var g=
null!==c?c.from:this._parent._size;a>=(null!==b?b.from+b.count:0)&&a+e<=g?(f=!1,d=!0):null!==c?(b=c,c=c.next):f=!1}return[b,c]};a.prototype._updateLargestRange=function(){for(var a=null,e=this._parent._freeHead;null!==e;){if(!a||e.count>a.count)a=e;e=e.next}this._largestRange=a};return a}();g=function(){function a(a,f){this._allocated=0;this._size=a;this._freeHead=0<a?{from:0,count:a,prev:null,next:null}:null;this._bookKeeper=f||new e(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}
a.prototype.allocate=function(e){var f=this._bookKeeper.findBestRange(e);if(null===f)return-1;var g=f.from,d=f.count;f.from+=e;f.count-=e;this._bookKeeper.rangeResized(f,g,d);this._allocated+=e;0===f.count&&(e=null!==f.prev?this._freeHead:f.next,a._removeRange(f),this._freeHead=e);return g};a.prototype.free=function(e,f){var g=this._bookKeeper.findAdjacentRanges(e,f),d=g[0],g=g[1];e={from:e,count:f,prev:d,next:g};null!==d&&(d.next=e);null!==g&&(g.prev=e);this._bookKeeper.rangeCreated(e);this._allocated-=
f;if(null!==g&&e.from+e.count===g.from){f=e.from;var b=e.count;a._fuse(e,g);a._removeRange(g);this._bookKeeper.rangeResized(e,f,b);this._bookKeeper.rangeResized(g,void 0,0)}null!==d&&d.from+d.count===e.from&&(f=d.from,b=d.count,a._fuse(d,e),a._removeRange(e),this._bookKeeper.rangeResized(d,f,b),this._bookKeeper.rangeResized(e,void 0,0));this._freeHead=null!==e.prev?this._freeHead:e};Object.defineProperty(a.prototype,"fragmentation",{get:function(){var a=this._size-this._allocated;return 0===a?0:1-
this._bookKeeper.largestRange.count/a},enumerable:!1,configurable:!0});a._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};a._fuse=function(a,e){a.count+=e.count;a.next=e.next;e.from+=e.count;e.count=0;null!==e.next&&(e.next.prev=a)};return a}();a.FreeList=g})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a){void 0===
a&&(a=400);this.duration=a;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(a.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0});a.prototype.reset=function(){this._value=this._elapsed=this._lastTime=0};a.prototype.step=function(){var a=performance.now();if(0===this._lastTime)return this._lastTime=a,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=a-this._lastTime;this._lastTime=a;this._value=Math.min(this._elapsed/
this.duration,1);return!1};return a}();a.default=g})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports tslib ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),function(g,a,e,k,h,f,n,d){Object.defineProperty(a,"__esModule",{value:!0});a.TiledDisplayObject=void 0;g=function(a){function b(b,c,e,g){void 0===g&&(g=e);var h=a.call(this)||this;h.triangleCountReportedInDebug=
0;h.transforms={dvs:f.mat3f32.create(),tileMat3:f.mat3f32.create()};h.triangleCount=0;h.key=new d(b);h.bounds=c;h.size=e;h.coordRange=g;return h}e.__extends(b,a);b.prototype.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(b.prototype,"coords",{get:function(){return this._coords},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"bounds",{get:function(){return this._bounds},set:function(a){this._coords=[a[0],a[3]];this._bounds=a},enumerable:!1,
configurable:!0});b.prototype.setTransform=function(a,b){b/=a.resolution*a.pixelRatio;var c=this.transforms.tileMat3,d=a.toScreenNoRotation([0,0],this.coords);h.mat3.set(c,this.size[0]/this.coordRange[0]*b,0,0,0,this.size[1]/this.coordRange[1]*b,0,d[0],d[1],1);h.mat3.multiply(this.transforms.dvs,a.displayViewMat3,c)};return b}(n.DisplayObject);a.TiledDisplayObject=g})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(g,a,e,k){Object.defineProperty(a,
"__esModule",{value:!0});g=function(){function a(a){this.geometryMap=k.createGeometryData(function(){return{indexBuffer:e.BufferObject.createIndex(a,35044),vao:null}},function(f,d){return{vertexBuffer:e.BufferObject.createVertex(a,k.C_VBO_INFO[d])}})}a.prototype.dispose=function(){for(var a=0;5>a;a++){var e=this.geometryMap[a];if(e){e.data.vao&&e.data.vao.dispose(!1);e.data.indexBuffer&&e.data.indexBuffer.dispose();for(var d in e.buffers)e.buffers[d]&&e.buffers[d].data.vertexBuffer.dispose()}}};a.prototype.get=
function(a){var e=this.geometryMap[a];a={};for(var d in e.buffers)a[d]=e.buffers[d].data.vertexBuffer;return{indexBuffer:e.data.indexBuffer,get vao(){return e.data.vao},set vao(a){e.data.vao=a},vertexBufferMap:a}};a.prototype.has=function(a){return null!=this.geometryMap[a]};a.prototype.upload=function(a,e){var d=this;e.forEach(function(b,c){d._upload(b,c,a)})};a.prototype._upload=function(a,e,d){a.indices&&(a.indices.allDirty?this._uploadIndices(d,e):null!=a.indices.from&&null!=a.indices.count&&
this._uploadIndices(d,e,a.indices.from,a.indices.count));if(a.vertices){a=a.vertices;for(var b in a){var c=a[b];c.allDirty?this._uploadVertices(d,e,b):null!=c.from&&null!=c.count&&this._uploadVertices(d,e,b,c.from,c.count)}}};a.prototype._uploadVertices=function(a,e,d,b,c){var f=this.geometryMap[e];f&&(e=a.geometries[e].vertexBuffer[d])&&(a=e.stride,e=e.data.buffer,f.buffers[d]&&0<e.byteLength&&(null!=b&&null!=c?f.buffers[d].data.vertexBuffer.setSubData(e,b*a,b*a,(b+c)*a):f.buffers[d].data.vertexBuffer.setData(e)))};
a.prototype._uploadIndices=function(a,e,d,b){var c=this.geometryMap[e];c&&(a=a.geometries[e].indexBuffer.buffer,c.data.indexBuffer&&0<a.byteLength&&(null!=d&&null!=b?c.data.indexBuffer.setSubData(a,4*d,4*d,4*(d+b)):c.data.indexBuffer.setData(a)))};return a}();a.default=g})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,
"__esModule",{value:!0});a.createMatcher=void 0;var n=h.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");a.createMatcher=function(a,b,c){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(d){switch(a.type){case "simple":return[2,f.FeatureMatcher.fromBasicRenderer(a,b,c)];case "map":return[2,f.MapMatcher.fromUVRenderer(a,b,c)];case "interval":return[2,f.IntervalMatcher.fromCBRenderer(a,b,c)];case "dictionary":return[2,f.DictionaryMatcher.fromDictionaryRenderer(a,
b,c)];default:return n.error(new k("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/cimSymbolUtils ../../../../../symbols/cim/utils ../../../arcade/callExpressionWithFeature ../../../layers/features/schemaUtils @dojo/framework/shim/Promise".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u){function t(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,f;return e.__generator(this,function(e){switch(e.label){case 0:return c=a||1,"number"===typeof c?[2,function(a,b,d){return c}]:[4,d.createRendererExpression(c,b.spatialReference,b.fields)];case 1:return f=e.sent(),[2,function(a,c,d){return q.default(f,a,{$view:d},b.geometryType,c)||1}]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.DictionaryMatcher=a.MapMatcher=a.IntervalMatcher=a.FeatureMatcher=
void 0;var r=h.getLogger("esri/views/2d/engine/webgl/util/Matcher");h=function(){function a(){this.type="feature";this._defaultResult=null}a.fromBasicRenderer=function(c,d,f){return e.__awaiter(this,void 0,void 0,function(){var g,h,l;return e.__generator(this,function(e){switch(e.label){case 0:return g=new a,c.symbol?[4,b.expandSymbol(c.symbol,f)]:[3,2];case 1:h=e.sent(),l=d.createTemplateGroup(h,null),g.setDefault(l),e.label=2;case 2:return[2,g]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=
function(){return this._defaultResult};a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=function(a,b,c,d,e){return this.getDefault()};a.prototype.analyze=function(a,b,c,d,f){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(a){return[2,null]})})};return a}();a.FeatureMatcher=h;var m=function(a){function c(b,c,d,e){var f=a.call(this)||this;f.type="interval";f._intervals=[];f._isMaxInclusive=c;f._fieldIndex=e;f._field=b;f._normalizationInfo=
d;return f}e.__extends(c,a);c.fromCBRenderer=function(a,d,f){return e.__awaiter(this,void 0,void 0,function(){var g,h,l,k,m,p,q,r,w,v,y=this;return e.__generator(this,function(z){switch(z.label){case 0:return g=a.isMaxInclusive,h=a.normalizationField,l=a.normalizationTotal,k=a.normalizationType,m=a.field,p={normalizationField:h,normalizationTotal:l,normalizationType:k},q=new c(m,g,p,a.fieldIndex),[4,b.expandSymbol(a.backgroundFillSymbol,f)];case 1:return r=z.sent(),[4,n.all(a.intervals.map(function(a){return e.__awaiter(y,
void 0,void 0,function(){var c,g,h;return e.__generator(this,function(e){switch(e.label){case 0:return[4,b.expandSymbol(a.symbol,f)];case 1:return c=e.sent(),[4,d.createTemplateGroup(c,r)];case 2:return g=e.sent(),h={min:a.min,max:a.max},q.add(h,g),[2]}})})}))];case 2:return z.sent(),[4,b.expandSymbol(a.defaultSymbol,f)];case 3:return(w=z.sent())?[4,d.createTemplateGroup(w,r)]:[3,5];case 4:v=z.sent(),q.setDefault(v),z.label=5;case 5:return[2,q]}})})};c.prototype.add=function(a,b){this._intervals.push({interval:a,
result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};c.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};c.prototype.match=function(a,b,c,d,e){if(null==this._fieldIndex&&!this._field)return this.getDefault();a=null!=this._fieldIndex?b.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(b);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++)if(d=this._intervals[b],c=
d.interval,d=d.result,e=this._isMaxInclusive?a<=c.max:a<c.max,a>=c.min&&e)return d;return this.getDefault()};c.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};c.prototype._getValueFromField=function(a){var b=a.readAttribute(this._field);if(!this._needsNormalization())return b;var c=this._normalizationInfo,d=c.normalizationField,e=c.normalizationTotal,c=c.normalizationType;a=!!d&&a.readAttribute(d);
if(c)switch(c){case "esriNormalizeByField":return(a||void 0)&&b/a;case "esriNormalizeByLog":return Math.log(b)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return b/e*100;default:r.error("Found unknown normalization type: "+c)}else r.error("Normalization is required, but no type was set!")};return c}(h);a.IntervalMatcher=m;m=function(a){function c(b,c,d){var e=a.call(this)||this;e.type="map";e._nullResult=null;e._resultsMap=new Map;e._fieldsIndex=d;e._fields=b;e._seperator=c||"";return e}e.__extends(c,
a);c.fromUVRenderer=function(a,d,f){return e.__awaiter(this,void 0,void 0,function(){var g,h,l,k,m,p,q=this;return e.__generator(this,function(r){switch(r.label){case 0:return g=a.fieldDelimiter,h=[a.field],a.field2&&h.push(a.field2),a.field3&&h.push(a.field3),[4,b.expandSymbol(a.backgroundFillSymbol,f)];case 1:return l=r.sent(),k=new c(h,g,a.fieldIndex),[4,n.all(a.map.map(function(a){return e.__awaiter(q,void 0,void 0,function(){var c,g;return e.__generator(this,function(e){switch(e.label){case 0:return[4,
b.expandSymbol(a.symbol,f)];case 1:return c=e.sent(),[4,d.createTemplateGroup(c,l)];case 2:return g=e.sent(),"\x3cNull\x3e"===a.value?k.setNullResult(g):k.add(a.value,g),[2]}})})}))];case 2:return r.sent(),[4,b.expandSymbol(a.defaultSymbol,f)];case 3:return(m=r.sent())?[4,d.createTemplateGroup(m,l)]:[3,5];case 4:p=r.sent(),k.setDefault(p),r.label=5;case 5:return[2,k]}})})};c.prototype.setNullResult=function(a){this._nullResult=a};c.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};
c.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};c.prototype.match=function(a,b,c,d,e){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();a=null!=this._fieldsIndex?b.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(b);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};
c.prototype._getValueFromFields=function(a){for(var b=[],c=0,d=this._fields;c<d.length;c++){var e=a.readAttribute(d[c]);b.push(e)}return b.join(this._seperator)};return c}(h);a.MapMatcher=m;h=function(a){function d(b,c,d,e){var g=a.call(this)||this;g.type="dictionary";g._groupIdCache=new f(100);g._renderer=b;g._fieldMap=b.fieldMap;g._symbolFields=b.getSymbolFields();g._templates=c;g._info=d;g._scaleFn=e;return g}e.__extends(d,a);d.fromDictionaryRenderer=function(a,b,c){return e.__awaiter(this,void 0,
void 0,function(){var f,h,l;return e.__generator(this,function(e){switch(e.label){case 0:return[4,new Promise(function(a,b){g(["../../../../../renderers/DictionaryRenderer"],a,b)})];case 1:return f=e.sent(),h=f.fromJSON(a.renderer),[4,h.fetchResources({spatialReference:c.spatialReference,fields:c.fields})];case 2:return e.sent(),[4,t(h.scaleExpression,c)];case 3:return l=e.sent(),[2,new d(h,b,c,l)]}})})};d.prototype._analyzeFeature=function(a,d,f,g){return e.__awaiter(this,void 0,void 0,function(){var h,
l,m,p,q,n,v,w,z=this;return e.__generator(this,function(x){switch(x.label){case 0:h=a.readLegacyFeature();l=this._scaleFn(h,d,f);m=this._attributeHash(h)+"-"+l;if(p=this._groupIdCache.get(m))return[2,p];q=e.__assign(e.__assign({},f),{spatialReference:this._info.spatialReference,abortOptions:g,fields:this._info.fields});return[4,this._renderer.getSymbolAsync(h,q)];case 1:return n=x.sent(),v=u.createSymbolSchema(n,this._renderer),w=b.expandSymbol(v,this._info,g).then(function(a){if("expanded-cim"!==
a.type)return r.error(new k("mapview-bad-type","Found unexpected type "+a.type+" in dictionary response")),null;a.hash+="-"+l;for(var b=0,d=a.layers;b<d.length;b++){var e=d[b];e.scaleFactor=l;e.templateHash+="-"+l;"text"===e.type&&"string"===typeof e.text&&-1<e.text.indexOf("[")&&(e.text=c.createLabelOverrideFunction(z._fieldMap,e.text,e.cim.textCase))}return z._templates.createTemplateGroup(a,null)}),this._groupIdCache.put(m,w,1),[2,w]}})})};d.prototype.analyze=function(a,b,c,d,f){return e.__awaiter(this,
void 0,void 0,function(){var a,g;return e.__generator(this,function(e){a=b.getCursor();for(g=[];a.next();)g.push(this._analyzeFeature(a,c,d,f));return[2,n.all(g)]})})};d.prototype.match=function(a,b,c,d,e){return null};d.prototype._attributeHash=function(a){for(var b="",c=0,d=this._symbolFields;c<d.length;c++){var e=this._fieldMap[d[c]];e&&(b+=a.attributes[e]+"-")}return b};return d}(h);a.DictionaryMatcher=h})},"esri/views/2d/layers/features/schemaUtils":function(){define("require exports tslib ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../symbols/support/jsonUtils ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/materialKey/MaterialKey ../../engine/webgl/util/vvFlagUtils ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l){function w(a){var b;switch(a.type){case "line-marker":return{type:"line-marker",color:null===(b=a.color)||void 0===b?void 0:b.toJSON(),placement:a.placement,style:a.style};default:return c.fromJSON(a.toJSON()).toJSON()}}function p(a,b,c){if(!a)return null;var f=0,g=!1;d.isSome(b)&&"visualVariables"in b&&(f=r.getVVFlags(b.visualVariables||[]),g="dot-density"===b.type);switch(a.type){case "simple-fill":case "picture-fill":return y(a,f,g,c);case "simple-marker":case "picture-marker":return b=
t.createMaterialKey(q.WGLGeometryType.MARKER,f,!1,!1),c=c?t.hydrateMaterialKey(b):b,b=w(a),e.__assign(e.__assign({materialKey:c,hash:a.hash()},b),{angle:a.angle});case "simple-line":return z(a,f,c);case "text":return b=t.createMaterialKey(q.WGLGeometryType.TEXT,f,!1,!1),c=c?t.hydrateMaterialKey(b):b,b=w(a),e.__assign(e.__assign({materialKey:c,hash:a.hash()},b),{angle:a.angle});case "label":return b=t.createMaterialKey(q.WGLGeometryType.LABEL,f,!1,!1,a.labelPlacement),c=c?t.hydrateMaterialKey(b):b,
e.__assign(e.__assign({materialKey:c,hash:a.hash()},a.toJSON()),{labelPlacement:a.labelPlacement});case "cim":return{type:"cim",rendererKey:f,data:a.data};case "web-style":return e.__assign(e.__assign({},w(a)),{type:"web-style",hash:a.hash(),rendererKey:f});default:throw Error("symbol not supported "+a.type);}}function y(a,b,c,d){c=t.createMaterialKey(q.WGLGeometryType.FILL,b,!1,c);var f=d?t.hydrateMaterialKey(c):c,g=a.clone();c=g.outline;g.outline=null;a=[];f=e.__assign({materialKey:f,hash:g.hash()},
w(g));a.push(f);c&&(b=t.createMaterialKey(q.WGLGeometryType.LINE,b,!0,!1),d=d?t.hydrateMaterialKey(b):b,d=e.__assign({materialKey:d,hash:c.hash()},w(c)),a.push(d));return{type:"composite-symbol",layers:a,hash:a.reduce(function(a,b){return b.hash+a},"")}}function z(a,b,c){var d,f=t.createMaterialKey(q.WGLGeometryType.LINE,b,!1,!1),g=c?t.hydrateMaterialKey(f):f;a=a.clone();f=a.marker;a.marker=null;var h=[];h.push(e.__assign({materialKey:g,hash:a.hash()},w(a)));f&&(b=t.createMaterialKey(q.WGLGeometryType.MARKER,
b,!1,!1),c=c?t.hydrateMaterialKey(b):b,f.color=null!==(d=f.color)&&void 0!==d?d:a.color,h.push(e.__assign({materialKey:c,hash:f.hash(),lineWidth:a.width},w(f))));return{type:"composite-symbol",layers:h,hash:h.reduce(function(a,b){return b.hash+a},"")}}function C(a,b){var c=a.labelPlacement,d=V[b];if(!a.symbol)return R.warn("No LabelClass symbol specified."),!0;if(!d)return R.error(new k("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+b+" is not supported")),
!0;d.some(function(a){return a===c})||(d=d[0],c&&R.warn("Found invalid label placement type "+c+" for "+b+". Defaulting to "+d),a.labelPlacement=d);return!1}function B(a,b){a=f.clone(a);return a.some(function(a){return C(a,b)})?[]:a}function E(a,c,d){var e,f;void 0===d&&(d=!1);try{var g=J(a.layer,d),h={};g.map(function(c){a:{switch(c.target){case "feature":F(h,A(a),c);c=void 0;break a;case "aggregate":var d=a.layer.featureReduction;if("selection"===d.type)throw new k("ValidationError","Mapview does not support `selection` reduction type",
d);F(h,A(a),c);h.aggregate||(h.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:b.pt2px(d.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(b.pt2px(d.clusterMaxSize)/64),fields:c.aggregateFields}});x(h.aggregate,c.attributes.fields);c=void 0;break a}c=void 0}return c});return{source:{definitionExpression:a.layer.definitionExpression,fields:a.layer.fields.map(function(a){return a.toJSON()}),gdbVersion:"feature"===a.layer.type?a.layer.gdbVersion:void 0,historicMoment:"feature"===
a.layer.type?null===(e=a.layer.historicMoment)||void 0===e?void 0:e.getTime():void 0,outFields:a.availableFields,pixelBuffer:c,spatialReference:a.layer.spatialReference.toJSON(),timeExtent:null===(f=a.layer.timeExtent)||void 0===f?void 0:f.toJSON()},attributes:{fields:{},indexCount:0},processors:g,targets:h}}catch(Z){if("ValidationError"===Z.fieldName)return R.error(Z),null;throw Z;}}function x(a,b){for(var c in b){var d=b[c];if(d.target===a.name){var e=a.attributes[c];e?(e.context.mesh=e.context.mesh||
d.context.mesh,e.context.storage=e.context.storage||d.context.storage):a.attributes[c]=d}}return a}function A(a){var b,c,d,e,f;return[null!==(c=null===(b=a.filter)||void 0===b?void 0:b.toJSON())&&void 0!==c?c:null,null!==(f=null===(e=null===(d=a.effect)||void 0===d?void 0:d.filter)||void 0===e?void 0:e.toJSON())&&void 0!==f?f:null]}function F(a,b,c){a.feature||(a.feature={name:"feature",input:"source",filters:b,attributes:{}});x(a.feature,c.attributes.fields);return a}function I(a,b){return b.field?
G(a,e.__assign(e.__assign({},b),{type:"field",field:b.field})):b.valueExpression?G(a,e.__assign(e.__assign({},b),{type:"expression",valueExpression:b.valueExpression})):{field:null,fieldIndex:null}}function G(a,b){switch(b.type){case "expression":var c=b.valueExpression;if(!a.fields[c]){var d=a.indexCount++;a.fields[c]=e.__assign(e.__assign({},b),{name:c,fieldIndex:d})}a=a.fields[c];return{fieldIndex:a.fieldIndex};case "label-expression":return c=JSON.stringify(b.label),a.fields[c]||(d=a.indexCount++,
a.fields[c]=e.__assign(e.__assign({},b),{name:c,fieldIndex:d})),a=a.fields[c],{fieldIndex:a.fieldIndex};case "field":c=b.field;if("aggregate"===b.target&&a.fields[c])return{field:c};a.fields[c]=e.__assign(e.__assign({},b),{name:c});return{field:c};case "statistic":return a.fields[b.name]=e.__assign({},b),{field:b.name}}}function J(a,b){void 0===b&&(b=!1);var c=[],d=0;c.push(M(a,d++,b));return c}function H(a,b,c,d,f,g){void 0===g&&(g=!1);b=G(b,{type:"label-expression",target:d,context:{mesh:!0},resultType:"string",
label:{labelExpression:c.labelExpression,labelExpressionInfo:c.labelExpressionInfo?{expression:c.labelExpressionInfo.expression}:null,symbol:!!c.symbol,where:c.where}}).fieldIndex;return e.__assign(e.__assign({},p(c,a,g)),{fieldIndex:b,target:d,index:f})}function M(a,b,c){void 0===c&&(c=!1);var d={indexCount:0,fields:{}},f="featureReduction"in a&&a.featureReduction;b=f?"aggregate":"feature";switch(a.renderer.type){case "heatmap":var g=a.renderer;return{type:"heatmap",aggregateFields:[],attributes:d,
target:b,storage:null,mesh:{blurRadius:g.blurRadius,fieldOffset:g.fieldOffset,field:I(d,{target:b,field:g.field,resultType:"numeric"}).field}};default:var g=[],h="aggregate"===b?v.createClusterRenderer(g,a.renderer,f,null):a.renderer;L(d,g);var m=O(d,b,h,c),p=K(d,b,h),q=l.toJSONGeometryType(a.geometryType);a=a.labelsVisible&&a.labelingInfo||[];var r=[];if(f){if("selection"===f.type)throw new k("ValidationError","Mapview does not support `selection` reduction type",f);r=f&&f.labelsVisible&&f.labelingInfo||
[]}a=B(a,q);var r=B(r,q),n=0,f=e.__spreadArrays(a.map(function(a){return H(h,d,a,"feature",n++,c)}),r.map(function(a){return H(h,d,a,"aggregate",n++,c)}));return{type:"symbol",target:b,attributes:d,aggregateFields:g,storage:p,mesh:{matcher:m,labels:f}}}}function L(a,b){for(var c={mesh:!0,storage:!0},d=0;d<b.length;d++){var e=b[d],f=e.name,e=e.outStatistic,g=e.statisticType,h=e.onStatisticField,l=null,k=null,m=null;"onStatisticValueExpression"in e?k=G(a,{type:"expression",target:"feature",valueExpression:e.onStatisticValueExpression,
resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in e?(l=G(a,{type:"field",target:"feature",field:h,resultType:"numeric"}).field,m=e.onStatisticNormalizationField):l=G(a,{type:"field",target:"feature",field:h,resultType:"numeric"}).field;G(a,{type:"statistic",target:"aggregate",name:f,context:c,inField:l,inNormalizationField:m,inFieldIndex:k,statisticType:g})}}function K(a,b,c){switch(c.type){case "dot-density":return N(a,b,c.attributes);case "simple":case "class-breaks":case "unique-value":return Q(a,
b,c.visualVariables);case "heatmap":case "dictionary":return null}}function N(a,b,c){return c&&c.length?{type:"dot-density",mapping:c.map(function(c,d){c=I(a,{valueExpression:c.valueExpression,field:c.field,resultType:"numeric",target:b});return{binding:d,field:c.field,fieldIndex:c.fieldIndex}}),target:b}:{type:"dot-density",mapping:[],target:b}}function Q(a,b,c){if(!c||!c.length)return{type:"visual-variable",mapping:[],target:b};var d={storage:!0};return{type:"visual-variable",mapping:m.simplifyVisualVariables(c).map(function(c){var e,
f=u.getVVType(c.type),g=I(a,{target:b,valueExpression:c.valueExpression,field:c.field,context:d,resultType:"numeric"}),h=g.field,g=g.fieldIndex;switch(c.type){case "size":return"$view.scale"===c.valueExpression?null:{type:"size",binding:f,field:h,fieldIndex:g,normalizationField:I(a,{target:b,field:c.normalizationField,context:d,resultType:"numeric"}).field,valueRepresentation:null!==(e=c.valueRepresentation)&&void 0!==e?e:null};case "color":return{type:"color",binding:f,field:h,fieldIndex:g,normalizationField:I(a,
{target:b,field:c.normalizationField,context:d,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:f,field:h,fieldIndex:g,normalizationField:I(a,{target:b,field:c.normalizationField,context:d,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:f,field:h,fieldIndex:g}}}).filter(function(a){return a}),target:b}}function O(a,b,c,f){void 0===f&&(f=!1);a=d.unwrapOr(a,{indexCount:0,fields:{}});switch(c.type){case "simple":case "dot-density":a="dot-density"===
c.type;void 0===f&&(f=!1);var g=c.getSymbols();return{type:"simple",symbol:p(g.length?g[0]:null,c,f),isDotDensity:a};case "class-breaks":return T(a,b,c,f);case "unique-value":void 0===f&&(f=!1);var g=[],h=c.backgroundFillSymbol;b={target:b,context:{mesh:!0},resultType:"string"};if(c.field&&"string"!==typeof c.field)throw new k("ValidationError","Expected renderer.field to be a string",c);for(var l=I(a,e.__assign(e.__assign({},b),{field:c.field,valueExpression:c.valueExpression})),m=l.field,l=l.fieldIndex,
q=0,r=c.uniqueValueInfos;q<r.length;q++){var n=r[q];g.push({value:""+n.value,symbol:p(n.symbol,c,f)})}return{type:"map",attributes:a.fields,field:m,fieldIndex:l,field2:I(a,e.__assign(e.__assign({},b),{field:c.field2})).field,field3:I(a,e.__assign(e.__assign({},b),{field:c.field3})).field,fieldDelimiter:c.fieldDelimiter,backgroundFillSymbol:p(h,c),defaultSymbol:p(c.defaultSymbol,c),map:g};case "dictionary":return a=f,void 0===a&&(a=!1),{type:"dictionary",renderer:c.toJSON()}}}function T(a,b,c,d){void 0===
d&&(d=!1);var e=c.backgroundFillSymbol,f=I(a,{target:b,field:c.field,valueExpression:c.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});b=f.field;var f=f.fieldIndex,g=c.normalizationType,g="log"===g?"esriNormalizeByLog":"percent-of-total"===g?"esriNormalizeByPercentOfTotal":"field"===g?"esriNormalizeByField":null,h=c.classBreakInfos.map(function(a){return{symbol:p(a.symbol,c,d),min:a.minValue,max:a.maxValue}}).sort(function(a,b){return a.min-b.min});return{type:"interval",
attributes:a.fields,field:b,fieldIndex:f,backgroundFillSymbol:p(e,c,d),defaultSymbol:p(c.defaultSymbol,c,d),intervals:h,normalizationField:c.normalizationField,normalizationTotal:c.normalizationTotal,normalizationType:g,isMaxInclusive:c.isMaxInclusive}}Object.defineProperty(a,"__esModule",{value:!0});a.createMatcherSchema=a.createSchema=a.createSymbolSchema=void 0;var R=n.getLogger("esri.views.2d.layers.features.schemaUtils"),V={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),
esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};a.createSymbolSchema=p;a.createSchema=function(a,b){void 0===b&&(b=0);h("esri-2d-update-debug")&&console.debug("Created new schema",E(a,b,!0));return E(a,b)};a.createMatcherSchema=O})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.getVVFlags=void 0;
a.getVVFlags=function(a){if(!a)return e.WGLVVFlag.NONE;for(var f=0,g=0;g<a.length;g++){var d=a[g];if("size"===d.type){var b=k.getTypeOfSizeVisualVariable(d),f=f|b;"outline"===d.target&&(f|=b<<4)}else"color"===d.type?f|=e.WGLVVFlag.COLOR:"opacity"===d.type?f|=e.WGLVVFlag.OPACITY:"rotation"===d.type&&(f|=e.WGLVVFlag.ROTATION)}return f}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),function(g,
a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.getTypeOfSizeVisualVariable=void 0;var n=k.getLogger("esri.views.2d.engine.webgl");a.getTypeOfSizeVisualVariable=function(a){if(f.isNumber(a.minDataValue)&&f.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize)return h.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return h.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&
"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return h.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return h.WGLVVFlag.SIZE_UNIT_VALUE;n.error(new e("mapview-bad-type","Found invalid size VisualVariable",a));return h.WGLVVFlag.NONE}})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["require",
"exports","tslib","../../../../../core/Logger","../../../../../core/screenUtils"],function(g,a,e,k,h){function f(a){return("size"===a.type||"color"===a.type||"opacity"===a.type)&&null!=a.stops}function n(a){var b;var f=a.type;b=a.stops;if(!(8>=b.length))if(d.warn("Found "+b.length+" Visual Variable stops, but MapView only supports 8. Displayed stops will be simplified."),16<b.length){for(var g=b[0],k=b.slice(1),r=k.pop(),m=k[0].value,n=k[k.length-1].value,l=(n-m)/6,w=[];m<n;m+=l){for(var p=0;m>=k[p].value;)p++;
var y=k[p],z=b[p-1],C=m-z.value,y=y.value===z.value?1:C/(y.value-z.value);"color"===f?(z=k[p],p=b[p-1],C=z.color.clone(),C.r=(1-y)*p.color.r+y*C.r,C.g=(1-y)*p.color.g+y*C.g,C.b=(1-y)*p.color.b+y*C.b,C.a=(1-y)*p.color.a+y*C.a,w.push({value:m,color:C,label:z.label})):"size"===f?(z=k[p],C=b[p-1],p=h.toPt(z.size),C=h.toPt(C.size),w.push({value:m,size:(1-y)*C+y*p,label:z.label})):(z=k[p],w.push({value:m,opacity:(1-y)*b[p-1].opacity+y*z.opacity,label:z.label}))}b=e.__spreadArrays([g],w,[r])}else{f=b[0];
b=b.slice(1);for(g=b.pop();6<b.length;){r=k=0;for(n=1;n<b.length;n++)l=Math.abs(b[n].value-b[n-1].value),l>r&&(r=l,k=n);b.splice(k,1)}b=e.__spreadArrays([f],b,[g])}a.stops=b;return a}Object.defineProperty(a,"__esModule",{value:!0});a.simplifyVisualVariables=a.simplifyVVRenderer=void 0;var d=k.getLogger("esri.renderers.visualVariables.support.utils");a.simplifyVVRenderer=function(a){if(!("visualVariables"in a&&a.visualVariables&&a.visualVariables.length))return a;a=a.clone();var b=a.visualVariables.map(function(a){return f(a)?
n(a):a});a.visualVariables=b;return a};a.simplifyVisualVariables=function(a){return a.map(function(a){return f(a)?n(a.clone()):a})}})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports tslib ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),function(g,
a,e,k,h,f,n,d,b,c,q){function u(a,b,c){switch(a){case "avg":case "avg_angle":return"cluster_avg_"+b;case "mode":return"cluster_type_"+b;case "norm":return a=b.toLowerCase()+",norm:field,"+c.toLowerCase(),"cluster_avg_"+d.createMD5Hash(a)}}function t(a,b){var c=b.name,e=b.outStatistic,f=e.onStatisticField,g=e.onStatisticValueExpression,e=e.statisticType;g?(b=d.createMD5Hash(g.toLowerCase()),a.push({name:c,outStatistic:{onStatisticField:b,onStatisticValueExpression:g,statisticType:e}})):f?a.push({name:c,
outStatistic:{onStatisticField:f,statisticType:e}}):v.error(new k("mapview-unsupported-field","Unable to handle field",{field:b}))}function r(a,b,c){var e=d.createMD5Hash(b),f="mode"===c?"cluster_type_"+e:"cluster_avg_"+e;a.some(function(a){return a.name===f})||a.push({name:f,outStatistic:{onStatisticField:e,onStatisticValueExpression:b,statisticType:c}});return f}function m(a,b,c,d){if("cluster_count"===b||a.some(function(a){return a.name===b}))return b;var e=u(c,b,d);a.some(function(a){return a.name===
e})||("norm"===c?a.push({name:e,outStatistic:{onStatisticField:b,onStatisticNormalizationField:d,statisticType:c}}):a.push({name:e,outStatistic:{onStatisticField:b,statisticType:c}}));return e}Object.defineProperty(a,"__esModule",{value:!0});a.isClusterCompatibleRenderer=a.createClusterCountSizeVariable=a.hasClusterCountVV=a.findSizeVV=a.createClusterRenderer=void 0;var v=f.getLogger("esri.views.2d.layers.support.clusterUtils");h.add("esri-cluster-arcade-enabled",1);var l=h("esri-cluster-arcade-enabled");
a.createClusterRenderer=function(b,c,d,e){c=c.clone();if(!a.isClusterCompatibleRenderer(c))return c;if(d.fields)for(var f=0,g=d.fields;f<g.length;f++)t(b,g[f]);"visualVariables"in c&&(f=(c.visualVariables||[]).filter(function(a){return"$view.scale"!==a.valueExpression}),g=a.findSizeVV(f),f.forEach(function(a){"rotation"===a.type?a.field?a.field=m(b,a.field,"avg_angle"):a.valueExpression&&(a.field=r(b,a.valueExpression,"avg_angle"),a.valueExpression=null):a.normalizationField?(a.field=m(b,a.field,
"norm",a.normalizationField),a.normalizationField=null):a.field?a.field=m(b,a.field,"avg"):(a.field=r(b,a.valueExpression,"avg"),a.valueExpression=null)}),n.isNone(g)&&!a.hasClusterCountVV(f)&&(f.push(a.createClusterCountSizeVariable(d,e)),c.dynamicClusterSize=!0),c.visualVariables=f);switch(c.type){case "unique-value":c.field?c.field=m(b,c.field,"mode"):c.valueExpression&&(c.field=r(b,c.valueExpression,"mode"),c.valueExpression=null);break;case "class-breaks":c.normalizationField?(c.field=m(b,c.field,
"norm",c.normalizationField),c.normalizationField=null):c.field?c.field=m(b,c.field,"avg"):(c.field=r(b,c.valueExpression,"avg"),c.valueExpression=null)}return c};a.findSizeVV=function(a){for(var b=0;b<a.length;b++){var c=a[b];if("size"===c.type)return c}return null};a.hasClusterCountVV=function(a){for(var b=0;b<a.length;b++)if("cluster_count"===a[b].field)return!0;return!1};a.createClusterCountSizeVariable=function(a,d){var f=[new c({value:0,size:0}),new c({value:1})];if(n.isNone(d))return new b({field:"cluster_count",
stops:e.__spreadArrays(f,[new c({value:2,size:0})])});var g=Object.keys(d).reduce(function(b,g){var h;return e.__assign(e.__assign({},b),(h={},h[g]=e.__spreadArrays(f,[new c({value:Math.max(2,d[g].minValue),size:a.clusterMinSize}),new c({value:Math.max(3,d[g].maxValue),size:a.clusterMaxSize})]),h))},{});return new q.LevelDependentSizeVariable({field:"cluster_count",levels:g})};a.isClusterCompatibleRenderer=function(a){var b=function(b){return v.error(new k("Unsupported-renderer",b,{renderer:a}))};
if("unique-value"===a.type){if(a.field2||a.field3)return b("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===a.type){if(a.normalizationField){var c=a.normalizationType;if("field"!==c)return b("FeatureReductionCluster does not support a normalizationType of "+c),!1}}else if("simple"!==a.type)return b("FeatureReductionCluster does not support renderers of type "+a.type),!1;if(!l){if("valueExpression"in a&&a.valueExpression)return b("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),
!1;if(("visualVariables"in a&&a.visualVariables||[]).some(function(a){return!!("valueExpression"in a&&a.valueExpression)}))return b("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0}})},"esri/core/MD5":function(){define(["require","exports"],function(g,a){function e(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function k(a,b,c,f,g,h){a=e(e(b,a),e(f,h));return e(a<<g|a>>>32-
g,c)}function h(a,b,c,e,f,g,h){return k(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return k(b&e|c&~e,a,b,f,g,h)}function n(a,b,c,e,f,g,h){return k(c^(b|~e),a,b,f,g,h)}Object.defineProperty(a,"__esModule",{value:!0});a.createMD5Hash=a.outputTypes=void 0;a.outputTypes={Base64:0,Hex:1,String:2,Raw:3};a.createMD5Hash=function(d,b){void 0===b&&(b=a.outputTypes.Hex);b=b||a.outputTypes.Base64;for(var c=[],g=0,u=8*d.length;g<u;g+=8)c[g>>5]|=(d.charCodeAt(g/8)&255)<<g%32;d=8*d.length;c[d>>5]|=128<<d%32;
c[(d+64>>>9<<4)+14]=d;d=1732584193;for(var g=-271733879,u=-1732584194,t=271733878,r=0;r<c.length;r+=16){var m=d,v=g,l=u,w=t;d=h(d,g,u,t,c[r+0],7,-680876936);t=h(t,d,g,u,c[r+1],12,-389564586);u=h(u,t,d,g,c[r+2],17,606105819);g=h(g,u,t,d,c[r+3],22,-1044525330);d=h(d,g,u,t,c[r+4],7,-176418897);t=h(t,d,g,u,c[r+5],12,1200080426);u=h(u,t,d,g,c[r+6],17,-1473231341);g=h(g,u,t,d,c[r+7],22,-45705983);d=h(d,g,u,t,c[r+8],7,1770035416);t=h(t,d,g,u,c[r+9],12,-1958414417);u=h(u,t,d,g,c[r+10],17,-42063);g=h(g,u,
t,d,c[r+11],22,-1990404162);d=h(d,g,u,t,c[r+12],7,1804603682);t=h(t,d,g,u,c[r+13],12,-40341101);u=h(u,t,d,g,c[r+14],17,-1502002290);g=h(g,u,t,d,c[r+15],22,1236535329);d=f(d,g,u,t,c[r+1],5,-165796510);t=f(t,d,g,u,c[r+6],9,-1069501632);u=f(u,t,d,g,c[r+11],14,643717713);g=f(g,u,t,d,c[r+0],20,-373897302);d=f(d,g,u,t,c[r+5],5,-701558691);t=f(t,d,g,u,c[r+10],9,38016083);u=f(u,t,d,g,c[r+15],14,-660478335);g=f(g,u,t,d,c[r+4],20,-405537848);d=f(d,g,u,t,c[r+9],5,568446438);t=f(t,d,g,u,c[r+14],9,-1019803690);
u=f(u,t,d,g,c[r+3],14,-187363961);g=f(g,u,t,d,c[r+8],20,1163531501);d=f(d,g,u,t,c[r+13],5,-1444681467);t=f(t,d,g,u,c[r+2],9,-51403784);u=f(u,t,d,g,c[r+7],14,1735328473);g=f(g,u,t,d,c[r+12],20,-1926607734);d=k(g^u^t,d,g,c[r+5],4,-378558);t=k(d^g^u,t,d,c[r+8],11,-2022574463);u=k(t^d^g,u,t,c[r+11],16,1839030562);g=k(u^t^d,g,u,c[r+14],23,-35309556);d=k(g^u^t,d,g,c[r+1],4,-1530992060);t=k(d^g^u,t,d,c[r+4],11,1272893353);u=k(t^d^g,u,t,c[r+7],16,-155497632);g=k(u^t^d,g,u,c[r+10],23,-1094730640);d=k(g^u^
t,d,g,c[r+13],4,681279174);t=k(d^g^u,t,d,c[r+0],11,-358537222);u=k(t^d^g,u,t,c[r+3],16,-722521979);g=k(u^t^d,g,u,c[r+6],23,76029189);d=k(g^u^t,d,g,c[r+9],4,-640364487);t=k(d^g^u,t,d,c[r+12],11,-421815835);u=k(t^d^g,u,t,c[r+15],16,530742520);g=k(u^t^d,g,u,c[r+2],23,-995338651);d=n(d,g,u,t,c[r+0],6,-198630844);t=n(t,d,g,u,c[r+7],10,1126891415);u=n(u,t,d,g,c[r+14],15,-1416354905);g=n(g,u,t,d,c[r+5],21,-57434055);d=n(d,g,u,t,c[r+12],6,1700485571);t=n(t,d,g,u,c[r+3],10,-1894986606);u=n(u,t,d,g,c[r+10],
15,-1051523);g=n(g,u,t,d,c[r+1],21,-2054922799);d=n(d,g,u,t,c[r+8],6,1873313359);t=n(t,d,g,u,c[r+15],10,-30611744);u=n(u,t,d,g,c[r+6],15,-1560198380);g=n(g,u,t,d,c[r+13],21,1309151649);d=n(d,g,u,t,c[r+4],6,-145523070);t=n(t,d,g,u,c[r+11],10,-1120210379);u=n(u,t,d,g,c[r+2],15,718787259);g=n(g,u,t,d,c[r+9],21,-343485551);d=e(d,m);g=e(g,v);u=e(u,l);t=e(t,w)}c=[d,g,u,t];switch(b){case a.outputTypes.Raw:return c;case a.outputTypes.Hex:b=[];d=0;for(g=4*c.length;d<g;d++)b.push("0123456789abcdef".charAt(c[d>>
2]>>d%4*8+4&15)+"0123456789abcdef".charAt(c[d>>2]>>d%4*8&15));return b.join("");case a.outputTypes.String:b=[];d=0;for(g=32*c.length;d<g;d+=8)b.push(String.fromCharCode(c[d>>5]>>>d%32&255));return b.join("");case a.outputTypes.Base64:b=[];d=0;for(g=4*c.length;d<g;d+=3)for(u=(c[d>>2]>>d%4*8&255)<<16|(c[d+1>>2]>>(d+1)%4*8&255)<<8|c[d+2>>2]>>(d+2)%4*8&255,t=0;4>t;t++)8*d+6*t>32*c.length?b.push("\x3d"):b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>6*(3-t)&63));return b.join("")}}})},
"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports tslib ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.LevelDependentSizeVariable=void 0;g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);c=b;b.prototype.writeLevels=function(a,
b,c){for(var d in a){b.stops=this.levels[d];break}};b.prototype.clone=function(){return new c({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:n.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:n.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),
target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:k.clone(this.levels)})};var c;e.__decorate([h.property()],b.prototype,"levels",void 0);e.__decorate([h.writer("levels")],b.prototype,"writeLevels",null);return b=c=e.__decorate([h.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],b)}(f);a.LevelDependentSizeVariable=g})},"esri/views/2d/layers/support/util":function(){define(["require",
"exports","../../../../core/jsonMap"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.analyzeRings=a.toJSONGeometryType=void 0;var k=new e.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});a.toJSONGeometryType=function(a){return k.toJSON(a)};a.analyzeRings=function(a,e,g){for(var d=[],b=[],c=0,f=0,h=0;h<a.length;h++){var k=a[h],r=f,m=k[0][0],n=k[0][1];
d[f++]=m;d[f++]=n;for(var l=0,w=1;w<k.length;++w){var p=m,y=n,m=k[w][0],n=k[w][1],l=l+(n*p-m*y);d[f++]=m;d[f++]=n}e(l/2);0<l?(0<r-c&&(g(c,r,d,b),c=r),b.length=0):0>l?0<r-c?b.push(.5*(r-c)):f=r:f=r}0<f-c&&g(c,f,d,b)}})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports tslib ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../definitions ../../enums ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t){Object.defineProperty(a,"__esModule",{value:!0});a.WGLMeshFactory=void 0;g=function(){function a(a,b,c){this._isDD=!1;this._geometryType=a;this._idField=b;this._templateStore=c}a.prototype.update=function(a,b){this._isDD="simple"===a.mesh.matcher.type&&a.mesh.matcher.isDotDensity;h.isSome(a.mesh.labels)&&this._setLabelTemplates(a.mesh.labels,b)};a.prototype._setLabelTemplates=function(a,b){this._labelTemplates=a.map(function(a){return q.default.fromLabelClass(a,
b)})};Object.defineProperty(a.prototype,"templates",{get:function(){return this._templateStore},enumerable:!1,configurable:!0});a.prototype.createMeshData=function(a){var e=Array(5),f=this._labelTemplates&&0<this._labelTemplates.length,g="esriGeometryPolyline"===this._geometryType?n.HEURISTIC_GLYPHS_PER_LINE:n.HEURISTIC_GLYPHS_PER_FEATURE;e[d.WGLGeometryType.MARKER]=new c.VertexVectors(d.WGLGeometryType.MARKER,4*a);e[d.WGLGeometryType.FILL]=new c.VertexVectors(d.WGLGeometryType.FILL,a,this._isDD);
e[d.WGLGeometryType.LINE]=new c.VertexVectors(d.WGLGeometryType.LINE,a);e[d.WGLGeometryType.TEXT]=new c.VertexVectors(d.WGLGeometryType.TEXT,4*a);e[d.WGLGeometryType.LABEL]=new c.VertexVectors(d.WGLGeometryType.LABEL,f?4*g:0);return new b.MeshData(e,{features:a,records:a,metrics:0})};a.prototype.analyze=function(a,b,c,d,g){return e.__awaiter(this,void 0,void 0,function(){var h,l,k,m,p,q,r;return e.__generator(this,function(e){switch(e.label){case 0:return f.isAborted(g)?[2]:"dictionary"!==b.type?
[3,2]:[4,b.analyze(this._idField,a.copy(),c,d,g)];case 1:h=e.sent(),e.label=2;case 2:for(l=0;a.next();)if(k=void 0,k=h?h[l++]:b.match(this._idField,a,this._geometryType,c,d),a.setGroupId(k),t.isDynamicId(k))for(m=this._templateStore.getDynamicTemplateGroup(k),p=0,q=m;p<q.length;p++)(r=q[p])&&r.analyze&&r.analyze(this._templateStore,a,c,d);return[2,this._templateStore.finalize(g)]}})})};a.prototype.analyzeGraphics=function(a,b,c,d,g){return e.__awaiter(this,void 0,void 0,function(){var h,l,k,m,p,q;
return e.__generator(this,function(e){switch(e.label){case 0:if(f.isAborted(g))return[2];h=a.getCursor();return b?[4,b.analyze(this._idField,h.copy(),c,d,g)]:[3,2];case 1:e.sent(),e.label=2;case 2:for(;h.next();){l=h.getGroupId();if(null==l||-1===l)l=b.match(this._idField,h,h.geometryType,c,d),h.setGroupId(l);if(t.isDynamicId(l))for(k=this._templateStore.getDynamicTemplateGroup(l),m=0,p=k;m<p.length;m++)(q=p[m])&&q.analyze&&q.analyze(this._templateStore,h,c,d);h.setGroupId(l)}return[2,this._templateStore.finalize(g)]}})})};
a.prototype.writeGraphic=function(a,b){var c=b.getGroupId(),d=b.getDisplayId(),e=this._templateStore.getTemplateGroup(c),f=b.geometryType;if(null!=d){if(t.isDynamicId(c))for(var g=0;g<e.length;g++)c=e[g],c.bindFeature(b,null,null);if(e)for(a.writeDisplayObject(d,b.readGraphic().insertAfter),g=0;g<e.length;g++)if(c=e[g]){var h=a.get(c.geometryType);c.writeMesh(a,h,b,f,d)}}};a.prototype.writeCursor=function(a,b,c,d,e,f){var g=b.getGroupId(),k=b.getDisplayId(),l=this._templateStore.getTemplateGroup(g);
if(null!=k&&l){a.writeDisplayObject(k,0);if(t.isDynamicId(g))for(var m=0;m<l.length;m++)g=l[m],g.bindFeature(b,c,d);for(c=0;c<l.length;c++)g=l[c],d=a.get(g.geometryType),!g.needsPixelBuffer&&b.hasFilter()||g.writeMesh(a,d,b,this._geometryType,k);g=a.hasDisplayRecords();h.isSome(f)&&g&&(l=f&&this._findLabelRef(l),this._writeLabels(a,b,k,f,l,e));a.endDisplayObject()}};a.prototype._findLabelRef=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c instanceof u.default)return c}return null};a.prototype._writeLabels=
function(a,b,c,d,e,f){for(var g=0;g<d.length;g++){var k=d[g];if(h.isSome(k)&&k){var l=k.glyphs,m=k.rtl,k=this._labelTemplates[k.index],p=a.get(k.geometryType);k.bindReferenceTemplate(e);k.bindTextInfo(l,m);k.writeMesh(a,p,b,this._geometryType,c,f)}}};return a}();a.WGLMeshFactory=g})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.VertexVectors=
void 0;var f=function(){function a(a,b){this.data=a;this.stride=b}Object.defineProperty(a.prototype,"vertexCount",{get:function(){var a=this.data.length/(this.stride/4);a!==(a|0)&&console.debug("Corrupted stride");return a},enumerable:!1,configurable:!0});a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();a.default=f;g=function(){function a(a,b,c){void 0===c&&(c=!1);this.geometryType=a;this.indexVector=new h.default(Uint32Array,
6*b);this.namedVectors={};a=e.getStrides(a,c);for(var d in a){c=a[d];var g=void 0;switch(c%4){case 0:case 2:g=new h.default(Uint32Array,c*b);break;case 1:case 3:g=new h.default(Uint8Array,c*b)}this.namedVectors[d]=new f(g,c)}}a.prototype.get=function(a){return this.namedVectors[a].data};a.prototype.getVector=function(a){return this.namedVectors[a]};a.prototype.transfer=function(a,b){var c=this.indexVector.buffer(),d={};b.push(c);for(var e in this.namedVectors){var f=this.namedVectors[e];d[e]={};f.transfer(d[e],
b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=d;this.destroy()};a.prototype.intoBuffers=function(){var a=k.VertexBuffers.fromVertexVectors(this);this.destroy();return a};a.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return a}();a.VertexVectors=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../collisions/Metric ../../materialKey/MaterialKey ./meshUtils ./segmentUtils ./WGLTextTemplate".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l,w,p){Object.defineProperty(a,"__esModule",{value:!0});var y=h.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),z=function(a){var b=new Map;return function(c){b.has(c)||b.set(c,a(c));return b.get(c)}}(function(a){var b=0;if(0===a)return Infinity;for(;!(a%2);)b++,a/=2;return b}),C=function(a,b){return r.i1616to32(Math.round(8*a),Math.round(8*b))};g=function(a){function g(d,e,g,h){var k=a.call(this,d,g.font.size,g.haloSize||0,g.color&&q.premultiplyAlphaRGBAArray(g.color)||
0,g.haloColor&&q.premultiplyAlphaRGBAArray(g.haloColor)||0,g.horizontalAlignment,g.verticalAlignment,l.isMapAligned(e.labelPlacement)?1:0,g.font.decoration,!1,g.angle||0,g.xoffset,g.yoffset,g.lineWidth,g.lineHeight,null,null)||this;k._outLineLabelAngle=0;k._refPlacementPadding=0;k._refPlacementDirX=0;k._refPlacementDirY=0;k._refOffsetX=0;k._refOffsetY=0;k.geometryType=t.WGLGeometryType.LABEL;var m;m=!!e.minScale&&h.scaleToZoom(e.minScale)||0;m=f.clamp(m,0,25.5);h=!!e.maxScale&&h.scaleToZoom(e.maxScale)||
255;h=f.clamp(h,0,25.5);e=c.getAlignmentFromPlacement(e.labelPlacement);var p=e[1];k._xAlignD=e[0];k._yAlignD=p;k._minZoom=m;k._maxZoom=h;k._refPlacementPadding=b.pt2px(g.haloSize)+u.TEXT_PLACEMENT_PADDING;d=v.LabelMaterialKey.load(d);d.sdf=!0;k._materialKey=d.data;return k}e.__extends(g,a);g.fromLabelClass=function(a,b){if("center-along"===a.labelPlacement){var c=a.symbol;c.xoffset=0;c.yoffset=0;c.angle=0;c.font.decoration="none"}return new g(a.materialKey,a,a.symbol,b)};Object.defineProperty(g.prototype,
"_shapedBox",{get:function(){return d.unwrap(this._shapingInfo).bounds},enumerable:!1,configurable:!0});g.prototype.bindReferenceTemplate=function(a){var b=c.getXDirection(this._xAlignD),e=c.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(d.isNone(a))this._refSymbolAndPlacementOffset=r.i8888to32(0,0,Math.floor(127*b+127),Math.floor(127*e+127));else{if("circle"===a.boundsType&&(b||e))var f=Math.sqrt(b*b+e*e),b=b/f,e=e/f;f=Math.max(a.height,a.width);this._refSymbolAndPlacementOffset=
r.i8888to32(4*this._refPlacementPadding,f,Math.floor(127*b+127),Math.floor(127*e+127));this._referenceSize=f;this._refPlacementDirX=b;this._refPlacementDirY=e;this._refOffsetX=a.xOffset;this._refOffsetY=a.yOffset}};g.prototype.writeMesh=function(a,b,c,e,f,g){if(!d.isNone(this._shapingInfo)){var h=[],l=this._shapingInfo;if(c="esriGeometryPolygon"===c.geometryType?c.readLegacyCentroid():c.readLegacyGeometry()){this.current={out:a,outVecs:b,outMetrics:h,inId:f,inShaping:l,zoomLevel:g};switch(e){case "esriGeometryPolyline":this._placeLineLabels(c);
break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(c);break;default:b="Geometry of type "+e+" is not supported",void 0===b&&(b="mapview-labeling"),y.error(new k(b,"mapview-labeling"))}a.writeMetrics(this.current.outMetrics)}}};g.prototype._isVisible=function(a,b){var c=Math.floor(10*this.current.zoomLevel);return Math.floor(10*a)<=c&&c<=Math.floor(10*b)};g.prototype._placePointLabels=function(a){var b=this.current;this._writeGlyphs(b.out,b.outVecs,b.inId,a,b.outMetrics)};
g.prototype._placeLineLabels=function(a){a=w.smoothPaths(a.paths,this.current.inShaping.bounds.width);for(var b=this._placeSubdivGlyphs.bind(this),c=(this._shapedBox.width+128)/4,d=0;d<a.length;d++)w.pathDivide(a[d],c,b)};g.prototype._placeSubdivGlyphs=function(a,b,c,d){var e=z(b);c=n.log2(Math.min(c,d-c)/(4+this._shapedBox.width/4/2));e=Math.max(this._minZoom,this.current.zoomLevel+2-(0===b?c:Math.min(e,c)));c=this._shapedBox.width/2*Math.pow(2,this.current.zoomLevel-e);this.current.inShaping.isMultiline?
0===b&&this._placeStraight(a,e):this._placeCurved(a,e,c)};g.prototype._placeStraight=function(a,b){var c=this.current;this._writeGlyphs(c.out,c.outVecs,c.inId,a,c.outMetrics,b)};g.prototype._placeCurved=function(a,b,c){var d={from:this.current.out.currentDisplayRecordCount(),count:-1},d=new m.default(this.current.inId,d,a.x,a.y,b),e=a.clone(),f=(180/Math.PI*a.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*a.angle%360*(254/360));this._placeFirst(e,d,b,1);this._placeBack(a,e,d,b,c,1);
this._placeForward(a,e,d,b,c,1);this._outLineLabelAngle=Math.round(254/360*f);this._placeFirst(e,d,b,0);this._placeBack(a,e,d,b,c,0);this._placeForward(a,e,d,b,c,0);d.range.count=this.current.out.currentDisplayRecordCount()-d.range.from;d.bounds&&this.current.outMetrics.push(d)};g.prototype._placeBack=function(a,b,c,d,e,f){var g=a.clone();for(a=a.backwardLength+0;g.prev()&&!(a>=e);)this._placeOnSegment(g,b,c,a,d,-1,f),a+=g.length+0};g.prototype._placeForward=function(a,b,c,d,e,f){var g=a.clone();
for(a=a.remainingLength+0;g.next()&&!(a>=e);)this._placeOnSegment(g,b,c,a,d,1,f),a+=g.length+0};g.prototype._placeFirst=function(a,b,c,d){for(var e=this.current.inShaping,f=e.glyphs,g=this.current.zoomLevel,h=this.current,k=h.out,l=h.outVecs,h=h.inId,m=C(a.x,a.y),p=0;p<f.length;p++){var r=f[p],q=r.x>e.bounds.x?d:1-d,q=Math.max(0,g+n.log2(Math.abs(r.x+r.width/2-e.bounds.x)/(q*a.remainingLength+(1-q)*a.backwardLength+0))),q=Math.max(c,q);r.maxZoom=25;r.angle=a.angle+(1-d)*Math.PI;r.minZoom=q;this._writeGlyph(k,
l,r,h,m);d&&this._isVisible(r.minZoom,r.maxZoom)&&b.add(r.bounds,0,0)}};g.prototype._placeOnSegment=function(a,b,c,d,e,f,g){for(var h=this.current.inShaping.glyphs,k=this.current,l=k.out,m=k.outVecs,k=k.inId,p=this.current.inShaping,r=this.current.zoomLevel,q=C(a.x+a.dx/a.length*-f*d,a.y+a.dy/a.length*-f*d),v=0;v<h.length;v++){var z=h[v],w=z.x>p.bounds.x?g:1-g;if(w&&1===f||!w&&-1===f){var x=Math.abs(z.x+z.width/2-p.bounds.x),w=Math.max(0,r+n.log2(x/d)-.1),x=Math.max(e,r+n.log2(x/(d+a.length+0)));
0!==w&&(z.angle=a.angle+(1-g)*Math.PI,z.minZoom=x,z.maxZoom=w,this._writeGlyph(l,m,z,k,q),g&&this._isVisible(z.minZoom,z.maxZoom)&&c.add(z.bounds,a.x-b.x,a.y-b.y))}}};g.prototype._writeGlyphs=function(a,b,c,e,f,g){void 0===g&&(g=this._minZoom);var h=this._shapingInfo;if(!(d.isNone(h)||0>e.x||512<=e.x||0>e.y||512<=e.y)){var k=a.currentDisplayRecordCount(),l=C(e.x+this._refOffsetX,e.y-this._refOffsetY);e=new m.default(c,{from:k,count:-1},e.x+this._refOffsetX,e.y-this._refOffsetY,g);for(var k=0,p=h.glyphs;k<
p.length;k++){var r=p[k];r.minZoom=g;r.maxZoom=this._maxZoom;this._writeGlyph(a,b,r,c,l)}e.range.count=a.currentDisplayRecordCount()-e.range.from;e.bounds=h.boundsT;a=v.LabelMaterialKey.load(this._materialKey);e.setPlacementOffset(a.vvSizeFieldStops||a.vvSizeMinMaxValue||a.vvSizeScaleStops||a.vvSizeUnitValue,this._referenceSize,this._refPlacementPadding,this._refPlacementDirX,this._refPlacementDirY);f.push(e)}};g.prototype._writeGlyph=function(a,b,c,d,e){var f=v.MaterialKeyBase.load(this._materialKey);
f.textureBinding=c.textureBinding;var g=b.indexVector.length,h=b.getVector("geometry").vertexCount,k=this._writeIndices(b);b=this._writeVertex(b,d,e,c);a.writeDisplayRecord(this.geometryType,f.data,h,b,g,k)};g.prototype._writeVertexCommon=function(a,b,c,d){var e=this._color,f=this._haloColor,g=r.i8888to32(0,0,this._size,this._haloSize);d=r.i8888to32(Math.floor(10*Math.max(d.minZoom,this._minZoom)),Math.floor(10*Math.min(d.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);a.push(c);a.push(b);a.push(e);
a.push(f);a.push(g);a.push(this._refSymbolAndPlacementOffset);a.push(d)};return g}(p.default);a.default=g})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.getJustification=a.getYDirection=a.getXDirection=a.getAlignmentFromPlacement=a.getYAnchorDirection=a.getXAnchorDirection=a.VAlign=a.HAlign=void 0;var e;(function(a){a[a.Left=-1]="Left";a[a.Center=0]="Center";a[a.Right=1]="Right"})(e=a.HAlign||
(a.HAlign={}));var k;(function(a){a[a.Top=1]="Top";a[a.Center=0]="Center";a[a.Bottom=-1]="Bottom";a[a.Baseline=2]="Baseline"})(k=a.VAlign||(a.VAlign={}));a.getXAnchorDirection=function(a){switch(a){case "left":return e.Left;case "right":return e.Right;case "center":case "justify":return e.Center}};a.getYAnchorDirection=function(a){switch(a){case "top":return k.Top;case "middle":return k.Center;case "baseline":return k.Baseline;case "bottom":return k.Bottom}};a.getAlignmentFromPlacement=function(a){switch(a){case "above-left":return[e.Right,
k.Bottom];case "above-center":case "above-along":return[e.Center,k.Bottom];case "above-right":return[e.Left,k.Bottom];case "center-left":return[e.Right,k.Center];case "center-center":case "center-along":return[e.Center,k.Center];case "center-right":return[e.Left,k.Center];case "below-left":return[e.Right,k.Top];case "below-center":case "below-along":return[e.Center,k.Top];case "below-right":return[e.Left,k.Top];case "always-horizontal":return[e.Center,k.Baseline];default:return console.debug("Found invalid placement type "+
a),[e.Center,k.Center]}};a.getXDirection=function(a){switch(a){case e.Right:return-1;case e.Center:return 0;case e.Left:return 1;default:return console.debug("Found invalid horizontal alignment "+a),0}};a.getYDirection=function(a){switch(a){case k.Top:return 1;case k.Center:return 0;case k.Bottom:case k.Baseline:return-1;default:return console.debug("Found invalid vertical alignment "+a),0}};a.getJustification=function(a){switch(a){case "left":return e.Left;case "right":return e.Right;case "center":case "justify":return e.Center}}})},
"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["require","exports","../../../../../../core/maybe","./util"],function(g,a,e,k){function h(a){return a.length-1}function f(a){for(var b=0,c=0;c<h(a);c++)b+=n(a,c);return b}function n(a,b,d){void 0===d&&(d=1);b=a[b+1];a=b[0];b=b[1];return Math.sqrt(a*a+b*b)*d}function d(a,b,f,g,h){if(!(f<b)){var c=g.clone().seek(f/2);e.isNone(c)||(a(c.clone(),f,h),f=(f-b)/2,c=e.unwrap(c.seek(b/2)),d(a,b,f,g,h+1),d(a,b,f,c,h+1))}}Object.defineProperty(a,
"__esModule",{value:!0});a.smoothPaths=a.pathSubdivide=a.pathDivide=a.SegmentCursor=a.segmentLength=a.pathLength=a.segmentCount=a.segmentAt=void 0;a.segmentAt=function(a,b){return a[b+1]};a.segmentCount=h;a.pathLength=f;a.segmentLength=n;var b=function(){function a(a,b,c,d,e){this._segments=a;this._index=b;this._distance=c;this._xStart=d;this._yStart=e;this._done=!1}a.create=function(b){return new a(b,0,0,b[0][0],b[0][1])};a.prototype.clone=function(){return new a(this._segments,this._index,this._distance,
this.xStart,this.yStart)};a.prototype.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||0===a._distance)};a.prototype.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=a._distance};a.prototype.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};Object.defineProperty(a.prototype,"_segment",{get:function(){return this._segments[this._index+
1]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){var a=this.dy,b=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(b=2*Math.PI-b);return b},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xStart",{get:function(){return this._xStart},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"yStart",{get:function(){return this._yStart},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"x",{get:function(){return this.xStart+
this.distance*this.dx},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this.yStart+this.distance*this.dy},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"dx",{get:function(){return this._segment[0]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"dy",{get:function(){return this._segment[1]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xMidpoint",{get:function(){return this.xStart+.5*this.dx},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"yMidpoint",{get:function(){return this.yStart+.5*this.dy},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xEnd",{get:function(){return this.xStart+this.dx},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"yEnd",{get:function(){return this.yStart+this.dy},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"length",{get:function(){var a=this.dx,b=this.dy;return Math.sqrt(a*a+b*b)},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"remainingLength",{get:function(){return this.length*(1-this._distance)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"backwardLength",{get:function(){return this.length*this._distance},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"distance",{get:function(){return this._distance},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"done",{get:function(){return this._done},enumerable:!1,configurable:!0});
a.prototype.hasPrev=function(){return 0<=this._index-1};a.prototype.hasNext=function(){return this._index+1<h(this._segments)};a.prototype.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};a.prototype.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};a.prototype._seekBackwards=function(a,b){var c=this.backwardLength;
if(a<=c)return this._distance=(c-a)/this.length,this;for(c=this.backwardLength;this.prev();){if(c+this.length>a)return this._seekBackwards(a-c);c+=this.length}this._distance=0;return b?this:null};a.prototype.seek=function(a,b){void 0===b&&(b=!1);if(0>a)return this._seekBackwards(Math.abs(a),b);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;for(var c=this.remainingLength;this.next();){if(c+this.length>a)return this.seek(a-c,b);c+=this.length}this._distance=
1;return b?this:null};return a}();a.SegmentCursor=b;a.pathDivide=function(a,d,e){var c=f(a);a=b.create(a);var g=c/2,h=Math.floor((c-d)/2/d);a.seek(g-h*d);for(var k=-h;k<=h;k++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&e(a.clone(),k,g+k*d,c),a.seek(d)};a.pathSubdivide=function(a,e,g){d(g,e,f(a),b.create(a),0)};a.smoothPaths=function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=[];e.push(d[0]);for(var f=1;f<d.length;f++){var g=e[f-1],h=g[0],g=g[1],h=h+d[f][0],g=g+d[f][1];e.push([h,g])}h=e;g=b;if(!(0>=g||(d=
h.length,3>d))){var f=[],n=0;f.push(0);for(var p=1;p<d;p++)n+=k.dist(h[p],h[p-1]),f.push(n);g=Math.min(g,.2*n);n=[];n.push(h[0][0]);n.push(h[0][1]);var q=h[d-1][0],z=h[d-1][1],p=k.sub([0,0],h[0],h[1]);k.normalize(p);h[0][0]+=g*p[0];h[0][1]+=g*p[1];k.sub(p,h[d-1],h[d-2]);k.normalize(p);h[d-1][0]+=g*p[0];h[d-1][1]+=g*p[1];for(p=1;p<d;p++)f[p]+=g;f[d-1]+=g;for(var C=.5*g,p=1;p<d-1;p++){for(var B=0,E=0,x=0,A=p-1;0<=A&&!(f[A+1]<f[p]-C);A--){var F=C+f[A+1]-f[p],I=f[A+1]-f[A],G=f[p]-f[A]<C?1:F/I;if(1E-6>
Math.abs(G))break;var J=G*G,H=G*F-.5*J*I,M=G*I/g,L=h[A+1],K=h[A][0]-L[0],N=h[A][1]-L[1],B=B+M/H*(L[0]*G*F+.5*J*(F*K-I*L[0])-J*G*I*K/3),E=E+M/H*(L[1]*G*F+.5*J*(F*N-I*L[1])-J*G*I*N/3),x=x+M}for(A=p+1;A<d&&!(f[A-1]>f[p]+C);A++){F=C-f[A-1]+f[p];I=f[A]-f[A-1];G=f[A]-f[p]<C?1:F/I;if(1E-6>Math.abs(G))break;J=G*G;H=G*F-.5*J*I;M=G*I/g;L=h[A-1];K=h[A][0]-L[0];N=h[A][1]-L[1];B+=M/H*(L[0]*G*F+.5*J*(F*K-I*L[0])-J*G*I*K/3);E+=M/H*(L[1]*G*F+.5*J*(F*N-I*L[1])-J*G*I*N/3);x+=M}n.push(B/x);n.push(E/x)}n.push(q);n.push(z);
for(A=p=0;p<d;p++)h[p][0]=n[A++],h[p][1]=n[A++]}d=[];d.push(e[0]);for(f=1;f<e.length;f++)h=e[f-1],p=h[0],n=h[1],g=e[f],h=g[0],g=g[1],d.push([Math.round(h-p),Math.round(g-n)]);a[c]=d}return a}})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["require","exports"],function(g,a){function e(a,e){return Math.sqrt(a*a+e*e)}Object.defineProperty(a,"__esModule",{value:!0});a.isPolygon=a.isPolyline=a.isPoint=a.isMultipoint=a.isExtent=a.getLimitCosine=a.isFunction=a.dist=a.normalize=a.len=
a.sub=void 0;a.sub=function(a,e,f){a[0]=e[0]-f[0];a[1]=e[1]-f[1];return a};a.len=e;a.normalize=function(a){var g=e(a[0],a[1]);a[0]/=g;a[1]/=g};a.dist=function(a,g){return e(a[0]-g[0],a[1]-g[1])};a.isFunction=function(a){return"function"===typeof a};a.getLimitCosine=function(a){return 1/Math.max(a,1)};a.isExtent=function(a){return void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax};a.isMultipoint=function(a){return void 0!==a.points};a.isPoint=function(a){return void 0!==a.x&&void 0!==
a.y};a.isPolyline=function(a){return void 0!==a.paths};a.isPolygon=function(a){return void 0!==a.rings}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),function(g,a,e,k,h,f,n,d,b,c){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(b,c,d,e,f,g,p,q,z,u,
B,E,x,A,F,I,G,J){void 0===J&&(J=!1);var l=a.call(this)||this;l._xOffset=k.pt2px(E);l._yOffset=k.pt2px(x);l._decoration=z||"none";l._color=e;l._haloColor=f;l._haloSize=Math.min(Math.floor(5*k.pt2px(k.toPt(d))),127);l._size=Math.min(Math.round(k.pt2px(c)),127);c=Math.min(Math.round(k.pt2px(c)),127);l._referenceSize=Math.round(Math.sqrt(256*c));l._scale=l._size/24;l._angle=B;l._justify=h.getJustification(g||"center");l._xAlignD=h.getXAnchorDirection(g||"center");l._yAlignD=h.getYAnchorDirection(p||"baseline");
l._baseline="baseline"===(p||"baseline");l._bitset=(1===q?1:0)|(u?1:0)<<1;b=n.MaterialKeyBase.load(b);b.sdf=!0;l._materialKey=b.data;l._lineWidth=k.pt2px(A)||512;l._lineHeight=F||1;l._textPlacement=I;l.effects=G;l._isCIM=J;return l}e.__extends(b,a);b.fromText=function(a,d){var e=new b(a.materialKey,a.font.size,a.haloSize||0,a.color&&f.premultiplyAlphaRGBAArray(a.color)||0,a.haloColor&&f.premultiplyAlphaRGBAArray(a.haloColor)||0,a.horizontalAlignment,a.verticalAlignment,0,a.font.decoration,!1,a.angle||
0,a.xoffset,a.yoffset,a.lineWidth,a.lineHeight,null,null,!1);a=c.bidiText(a.text)[1];e.bindTextInfo(d,a);return e};b.fromCIMText=function(a,d){var e=a.scaleFactor||1,e=new b(a.materialKey,a.size*a.sizeRatio*e,a.outlineSize*a.sizeRatio,f.premultiplyAlphaRGBA(a.color),f.premultiplyAlphaRGBA(a.outlineColor),a.horizontalAlignment,a.verticalAlignment,a.alignment,a.decoration,a.colorLocked,a.angle,a.offsetX*a.sizeRatio*e,a.offsetY*a.sizeRatio*e,512,1,a.markerPlacement,a.effects,!0);a=c.bidiText(a.text)[1];
e.bindTextInfo(d,a);return e};return b}(d.default(b.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(g,a,e,k,h,f,n,d,b,c,q,u){Object.defineProperty(a,
"__esModule",{value:!0});a.default=function(a){return function(a){function g(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];d=a.apply(this,d)||this;d._isCIM=!1;d.geometryType=b.WGLGeometryType.TEXT;d._aux=c.i8888to32(0,0,d._referenceSize,d._bitset);return d}e.__extends(g,a);g.prototype.bindTextInfo=function(a,b){var c=this;this._shapingInfo=a&&a.length?k.andThen(a,function(a){return u.shapeGlyphs(a,b,{scale:c._scale,angle:c._angle,xOffset:c._xOffset,yOffset:c._yOffset,hAlign:c._xAlignD,
vAlign:c._yAlignD,maxLineWidth:Math.max(32,Math.min(c._lineWidth,512)),lineHeight:d.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(c._lineHeight,4)),decoration:c._decoration,isCIM:c._isCIM})}):null};g.prototype.writeMeshWithGeometry=function(a,b,c,d,e,g){var h=this;if(k.isSome(this._textPlacement))return c=null!==g&&void 0!==g?g:c.readLegacyGeometry(),this._writePlacedText(a,b,e,c);if(c=g?f.deltaDecodeGeometry(f.convertFromGeometry(g),2):"esriGeometryPolygon"===d?c.readCentroid():c.readUnquantizedGeometry()){if(c.isPoint)return c=
c.coords,this._writeGlyphs(a,b,e,{x:c[0],y:c[1]});c.forEachVertex(function(c,d){return h._writeGlyphs(a,b,e,{x:c,y:d})})}};g.prototype._writePlacedText=function(a,b,d,e){var f=this._shapingInfo;if(!k.isNone(f)){var g=q.MaterialKeyBase.load(this._materialKey),l=k.unwrap(this._textPlacement);if(e=n.CIMMarkerPlacementHelper.getPlacement(e,l,h.pt2px(1))){var m;for(m=e.next();null!=m;){l=c.i1616to32(Math.round(8*m.tx),Math.round(8*m.ty));m=m.getAngle();f.setRotation(m);for(var p=0,r=f.glyphs;p<r.length;p++){var v=
r[p];g.textureBinding=v.textureBinding;var w=b.getVector("geometry").vertexCount,u=b.indexVector.length,t=this._writeIndices(b),v=this._writeVertex(b,d,l,v);a.writeDisplayRecord(this.geometryType,g.data,w,v,u,t)}f.setRotation(-m);m=e.next()}}}};g.prototype._writeGlyphs=function(a,b,d,e){var f=this._shapingInfo;if(!k.isNone(f)){var g=q.MaterialKeyBase.load(this._materialKey);e=c.i1616to32(Math.round(8*e.x),Math.round(8*e.y));for(var h=0,f=f.glyphs;h<f.length;h++){var l=f[h];g.textureBinding=l.textureBinding;
var m=b.getVector("geometry").vertexCount,p=b.indexVector.length,r=this._writeIndices(b),l=this._writeVertex(b,d,e,l);a.writeDisplayRecord(this.geometryType,g.data,m,l,p,r)}}};g.prototype._writeVertexCommon=function(a,b,d,e){e=this._color;var f=this._haloColor,g=c.i8888to32(0,0,this._referenceSize,this._bitset),h=c.i8888to32(0,0,this._size,this._haloSize);a.push(d);a.push(b);a.push(e);a.push(f);a.push(h);a.push(g)};g.prototype._writeVertex=function(a,b,c,d){a=a.get("geometry");this._writeVertexCommon(a,
b,c,d);a.push(d.offsets.upperLeft);a.push(d.texcoords.upperLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.upperRight);a.push(d.texcoords.upperRight);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerLeft);a.push(d.texcoords.lowerLeft);this._writeVertexCommon(a,b,c,d);a.push(d.offsets.lowerRight);a.push(d.texcoords.lowerRight);return 4};g.prototype._writeIndices=function(a){var b=a.getVector("geometry").vertexCount;a=a.indexVector;a.push(b+0);a.push(b+1);a.push(b+2);a.push(b+1);a.push(b+
3);a.push(b+2);return 6};return g}(a)}})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(g,a,e,k,h,f,n,d){function b(a,b){return a?b?4:3:b?3:2}function c(a,b,c,d){if(a){if(c)return b&&d?Z:Y;if(b&&d)return ha}else if(b&&d)return Y;return da}function q(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function u(a,
b){return Math.round((a.translate[1]-b)/a.scale[1])}function t(a,b){return b*a.scale[0]+a.translate[0]}function r(a,b){return a.translate[1]-b*a.scale[1]}function m(a){a=a.coords;return{x:a[0],y:a[1]}}function v(a,b){a.coords[0]=b.x;a.coords[1]=b.y;return a}function l(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function w(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;return a}function p(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function y(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.m;
return a}function z(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function C(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;a.coords[3]=b.m;return a}function B(a,b){return a&&b?C:a?w:b?y:v}function E(a,b,c,e,g){c=B(c,e);for(e=0;e<b.length;e++){var h=b[e],k=h.geometry,h=h.attributes,l=void 0;k&&(l=c(new d.default,k));a.push(new f.default(l,h,null,h[g]))}return a}function x(a,b,c,d){for(var e=0;e<b.length;e++){var f=b[e],g=f.geometry,f=f.attributes,h=void 0;g&&(h=A(g,c,d));a.push({attributes:f,
geometry:h})}return a}function A(a,c,d){if(!a)return null;for(var e=b(c,d),f=[],g=0;g<a.coords.length;g+=e){for(var h=[],k=0;k<e;k++)h.push(a.coords[g+k]);f.push(h)}return c?d?{points:f,hasZ:c,hasM:d}:{points:f,hasZ:c}:d?{points:f,hasM:d}:{points:f}}function F(a,c,e,g,h){e=b(e,g);for(g=0;g<c.length;g++){var k=c[g],l=k.geometry,k=k.attributes,m=void 0;l&&(m=I(new d.default,l,e));a.push(new f.default(m,k,null,k[h]))}return a}function I(a,c,d){void 0===d&&(d=b(c.hasZ,c.hasM));a.lengths[0]=c.points.length;
var e=a.coords,f=0,g=0;for(c=c.points;g<c.length;g++)for(var h=c[g],k=0;k<d;k++)e[f++]=h[k];return a}function G(a,c,d){if(!a)return null;var e=b(c,d),f=a.coords,g=[],h=0,k=0;for(a=a.lengths;k<a.length;k++){for(var l=a[k],m=[],p=0;p<l;p++){for(var r=[],n=0;n<e;n++)r.push(f[h++]);m.push(r)}g.push(m)}return c?d?{paths:g,hasZ:c,hasM:d}:{paths:g,hasZ:c}:d?{paths:g,hasM:d}:{paths:g}}function J(a,c,e,g,h){e=b(e,g);for(g=0;g<c.length;g++){var k=c[g],l=k.geometry,k=k.attributes,m=void 0;l&&(m=H(new d.default,
l,e));a.push(new f.default(m,k,null,k[h]))}return a}function H(a,c,d){void 0===d&&(d=b(c.hasZ,c.hasM));var e=a.lengths,f=a.coords,g=0,h=0;for(c=c.paths;h<c.length;h++){for(var k=c[h],l=0,m=k;l<m.length;l++)for(var p=m[l],r=0;r<d;r++)f[g++]=p[r];e.push(k.length)}return a}function M(a,c,d){if(!a)return null;var e=b(c,d),f=a.coords,g=[],h=0,k=0;for(a=a.lengths;k<a.length;k++){for(var l=a[k],m=[],p=0;p<l;p++){for(var r=[],n=0;n<e;n++)r.push(f[h++]);m.push(r)}g.push(m)}return c?d?{rings:g,hasZ:c,hasM:d}:
{rings:g,hasZ:c}:d?{rings:g,hasM:d}:{rings:g}}function L(a,b,c,e,g){for(var h=0;h<b.length;h++){var k=b[h],l=k.geometry,m=k.centroid,k=k.attributes,p=void 0;l&&(p=K(new d.default,l,c,e));m?a.push(new f.default(p,k,v(new d.default,m),k[g])):a.push(new f.default(p,k,null,k[g]))}return a}function K(a,b,c,d){void 0===c&&(c=b.hasZ);void 0===d&&(d=b.hasM);N(a,b.rings,c,d);return a}function N(a,c,d,e){d=b(d,e);e=a.lengths;for(var f=a.coords,g=0,h=e.length=f.length=0;h<c.length;h++){for(var k=c[h],l=0,m=
k;l<m.length;l++)for(var p=m[l],r=0;r<d;r++)f[g++]=p[r];e.push(k.length)}return a}function Q(a,b,c,d,g,h){a.length=0;if(!c){for(c=0;c<b.length;c++)d=b[c],a.push(new f.default(null,d.attributes,null,d.attributes[h]));return a}switch(c){case "esriGeometryPoint":return E(a,b,d,g,h);case "esriGeometryMultipoint":return F(a,b,d,g,h);case "esriGeometryPolyline":return J(a,b,d,g,h);case "esriGeometryPolygon":return L(a,b,d,g,h);default:X.error("convertToFeatureSet:unknown-geometry",new e("Unable to parse unknown geometry type '"+
c+"'")),a.length=0}return a}function O(a,b,c,d){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(b){case "esriGeometryPoint":return b=m,c&&d?b=z:c?b=l:d&&(b=p),b(a);case "esriGeometryMultipoint":return A(a,c,d);case "esriGeometryPolyline":return G(a,c,d);case "esriGeometryPolygon":return M(a,c,d);default:X.error("convertToGeometry:unknown-geometry",new e("Unable to parse unknown geometry type '"+b+"'"))}}function T(a,b,c,d,f){a.length=0;switch(c){case "esriGeometryPoint":c=m;d&&f?c=z:d?c=
l:f&&(c=p);for(d=0;d<b.length;d++){var g=b[d];f=g.geometry;g=g.attributes;f=f?c(f):null;a.push({attributes:g,geometry:f})}break;case "esriGeometryMultipoint":return x(a,b,d,f);case "esriGeometryPolyline":for(c=0;c<b.length;c++){var h=b[c],g=h.geometry,h=h.attributes,k=void 0;g&&(k=G(g,d,f));a.push({attributes:h,geometry:k})}break;case "esriGeometryPolygon":for(c=0;c<b.length;c++){var k=b[c],h=k.geometry,g=k.attributes,r=k.centroid,k=void 0;h&&(k=M(h,d,f));r?(h=m(r),a.push({attributes:g,centroid:h,
geometry:k})):a.push({attributes:g,geometry:k})}break;default:X.error("convertToFeatureSet:unknown-geometry",new e("Unable to parse unknown geometry type '"+c+"'"))}return a}function R(a,d,e,f,g,h,k,l){void 0===k&&(k=e);void 0===l&&(l=f);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!d||!d.coords.length)return null;g=ca[g];var m=d.coords;d=d.lengths;var p=b(e,f),r=b(e&&k,f&&l);e=c(e,f,k,l);if(!d.length)return e(a.coords,m,0,0,q(h,m[0]),u(h,m[1])),a.lengths.length&&
(a.lengths.length=0),a.coords.length=p,a;for(var n,z=0,w,v=0,x=0;x<d.length;x++){var y=d[x];if(!(y<g)){var B=0;w=v;l=f=q(h,m[z]);n=k=u(h,m[z+1]);e(a.coords,m,w,z,l,n);B++;z+=p;w+=r;for(var t=1;t<y;t++,z+=p)if(l=q(h,m[z]),n=u(h,m[z+1]),l!==f||n!==k)e(a.coords,m,w,z,l-f,n-k),w+=r,B++,f=l,k=n;B>=g&&(a.lengths.push(B),v=w)}}a.coords.length=v;return a.coords.length?a:null}function V(a,b,c,d,e,f,g){for(var h=d,k=0,l,m=f+c;m<g;m+=c){l=b[m];var p=b[m+1],r=b[g],n=b[g+1],q=b[f],z=b[f+1],w=r-q,v=n-z;if(0!==
w||0!==v){var x=((l-q)*w+(p-z)*v)/(w*w+v*v);1<x?(q=r,z=n):0<x&&(q+=w*x,z+=v*x)}w=l-q;v=p-z;l=w*w+v*v;l>h&&(k=m,h=l)}h>d&&(k-f>c&&V(a,b,c,d,e,f,k),e(a,b,a.length,k,b[k],b[k+1]),g-k>c&&V(a,b,c,d,e,k,g))}function S(a,c,d,e,f){var g=c.coords,h=c.lengths,k=d?e?Z:Y:e?Y:da;d=b(d,e);if(!g.length)return a!==c&&(a.lengths.length=0,a.coords.length=0),a;if(!h.length)return k(a.coords,g,0,0,t(f,g[0]),r(f,g[1])),a!==c&&(a.lengths.length=0,a.coords.length=d),a;var l=f.scale;e=l[0];for(var l=l[1],m=0,p=0;p<h.length;p++){var n=
h[p];a.lengths[p]=n;var q=t(f,g[m]),z=r(f,g[m+1]);k(a.coords,g,m,m,q,z);for(var m=m+d,w=1;w<n;w++,m+=d)q+=g[m]*e,z-=g[m+1]*l,k(a.coords,g,m,m,q,z)}a!==c&&(a.lengths.length=h.length,a.coords.length=g.length);return a}function W(a,b,c,d){for(var e=0,f=a[d*b],g=a[d*(b+1)],h=1;h<c;h++)var k=f+a[d*(b+h)],l=g+a[d*(b+h)+1],m=(k-f)*(l+g),f=k,g=l,e=e+m;return.5*e}Object.defineProperty(a,"__esModule",{value:!0});a.deltaDecodeGeometry=a.deltaEncodeGeometry=a.getQuantizedArea=a.getSignedQuantizedRingArea=a.removeCollinearVectices=
a.removeZMValues=a.unquantizeOptimizedGeometry=a.getQuantizedBoundsOptimizedGeometry=a.getBoundsOptimizedGeometry=a.generalizeOptimizedGeometry=a.quantizeOptimizedGeometry=a.quantizeOptimizedFeatureSet=a.unquantizeOptimizedFeatureSet=a.convertFromFeatureSet=a.convertToFeatureSet=a.convertToFeatures=a.convertToGeometry=a.convertFromGeometry=a.convertToFeature=a.convertFromGraphics=a.convertFromFeatures=a.convertFromFeature=a.convertFromNestedArray=a.convertFromPolygon=a.convertToPolygon=a.convertFromPolyline=
a.convertFromPolylineFeatures=a.convertToPolyline=a.convertFromMultipoint=a.convertFromMultipointFeatures=a.convertToMultipoint=a.convertToMultipointFeatures=a.convertFromPoint=a.convertFromPointFeatures=a.convertToPoint=a.unquantizeY=a.unquantizeX=a.quantizeY=a.quantizeX=void 0;var X=k.getLogger("esri.tasks.support.optimizedFeatureSet"),ca={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},da=function(a,b,c,d,e,f){a[c]=e;a[c+1]=f},Y=function(a,b,c,d,e,f){a[c]=
e;a[c+1]=f;a[c+2]=b[d+2]},ha=function(a,b,c,d,e,f){a[c]=e;a[c+1]=f;a[c+2]=b[d+3]},Z=function(a,b,c,d,e,f){a[c]=e;a[c+1]=f;a[c+2]=b[d+2];a[c+3]=b[d+3]};a.quantizeX=q;a.quantizeY=u;a.unquantizeX=t;a.unquantizeY=r;a.convertToPoint=function(a,b,c){return a?b?c?z(a):l(a):c?p(a):m(a):null};a.convertFromPointFeatures=E;a.convertFromPoint=function(a,b,c){void 0===c&&(c=B(null!=b.z,null!=b.m));return c(a,b)};a.convertToMultipointFeatures=x;a.convertToMultipoint=A;a.convertFromMultipointFeatures=F;a.convertFromMultipoint=
I;a.convertToPolyline=G;a.convertFromPolylineFeatures=J;a.convertFromPolyline=H;a.convertToPolygon=M;a.convertFromPolygon=K;a.convertFromNestedArray=N;var aa=[],ea=[];a.convertFromFeature=function(a,b,c,d,e){aa[0]=a;a=Q(ea,aa,b,c,d,e)[0];aa.length=ea.length=0;return a};a.convertFromFeatures=Q;a.convertFromGraphics=function(a,b,c,d,f,g){var h=a.length;switch(c){case "esriGeometryPoint":E(a,b,d,f,g);break;case "esriGeometryMultipoint":F(a,b,d,f,g);break;case "esriGeometryPolyline":J(a,b,d,f,g);break;
case "esriGeometryPolygon":L(a,b,d,f,g);break;default:X.error("convertToFeatureSet:unknown-geometry",new e("Unable to parse unknown geometry type '"+c+"'"))}for(d=0;d<b.length;d++)a[d+h].geometryType=c,a[d+h].insertAfter=b[d].insertAfter,a[d+h].groupId=b[d].groupId;return a};a.convertToFeature=function(a,b,c,d){ea[0]=a;T(aa,ea,b,c,d);a=aa[0];aa.length=ea.length=0;return a};a.convertFromGeometry=function(a,c,f){if(!a)return null;var g=new d.default;"hasZ"in a&&null==c&&(c=a.hasZ);"hasM"in a&&null==
f&&(f=a.hasM);if(h.isPoint(a))return B(null!=c?c:null!=a.z,null!=f?f:null!=a.m)(g,a);if(h.isPolygon(a))return K(g,a,c,f);if(h.isPolyline(a))return H(g,a,b(c,f));if(h.isMultipoint(a))return I(g,a,b(c,f));X.error("convertFromGeometry:unknown-geometry",new e("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=O;a.convertToFeatures=T;a.convertToFeatureSet=function(a){var b=a.objectIdFieldName,c=a.spatialReference,d=a.transform,e=a.fields,f=a.hasM,g=a.hasZ,h=a.geometryType,k=a.exceededTransferLimit,
l=a.uniqueIdField,m=a.queryGeometry,p=a.queryGeometryType;a=T([],a.features,h,g,f);m=O(m,p,!1,!1);b={features:a,fields:e,geometryType:h,objectIdFieldName:b,spatialReference:c,uniqueIdField:l,queryGeometry:m};d&&(b.transform=d);k&&(b.exceededTransferLimit=k);f&&(b.hasM=f);g&&(b.hasZ=g);return b};a.convertFromFeatureSet=function(a,b){var c=new n.default,d=a.hasM,f=a.hasZ,g=a.features,h=a.objectIdFieldName,k=a.spatialReference,l=a.geometryType,m=a.exceededTransferLimit,p=a.transform;if(a=a.fields)c.fields=
a;c.geometryType=l;c.objectIdFieldName=h||b;c.spatialReference=k;if(!c.objectIdFieldName)return X.error(new e("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),c;g&&Q(c.features,g,l,f,d,c.objectIdFieldName);m&&(c.exceededTransferLimit=m);d&&(c.hasM=d);f&&(c.hasZ=f);p&&(c.transform=p);return c};a.unquantizeOptimizedFeatureSet=function(a){var b=a.transform,c=a.hasM,d=a.hasZ;if(!b)return a;for(var e=0,f=a.features;e<f.length;e++){var g=f[e];g.geometry&&S(g.geometry,g.geometry,
c,d,b);g.centroid&&S(g.centroid,g.centroid,c,d,b)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,b){var c=b.geometryType,e=b.features,f=b.hasM,g=b.hasZ;if(!a)return b;for(var h=0;h<e.length;h++){var k=e[h],l=k.weakClone();l.geometry=new d.default;R(l.geometry,k.geometry,f,g,c,a);k.centroid&&(l.centroid=new d.default,R(l.centroid,k.centroid,f,g,"esriGeometryPoint",a));e[h]=l}b.transform=a;return b};a.quantizeOptimizedGeometry=R;a.generalizeOptimizedGeometry=function(a,d,e,f,g,
h,k,l){void 0===k&&(k=e);void 0===l&&(l=f);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!d||!d.coords.length)return null;g=ca[g];var m=d.coords;d=d.lengths;var p=b(e,f),r=b(e&&k,f&&l);e=c(e,f,k,l);if(!d.length)return e(a.coords,m,0,0,m[0],m[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=p,a;f=0;h*=h;for(k=0;k<d.length;k++){l=d[k];if(!(l<g)){var n=a.coords.length/r,q=f,z=f+(l-1)*p;e(a.coords,m,a.coords.length,q,m[q],m[q+1]);V(a.coords,m,p,h,e,q,z);e(a.coords,
m,a.coords.length,z,m[z],m[z+1]);q=a.coords.length/r-n;q>=g?a.lengths.push(q):a.coords.length=n*r}f+=l*p}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,c,d,e){if(!c||!c.coords||!c.coords.length)return null;d=b(d,e);var f=e=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;if(c&&c.coords){c=c.coords;for(var k=0;k<c.length;k+=d){var l=c[k],m=c[k+1];e=Math.min(e,l);g=Math.max(g,l);f=Math.min(f,m);h=Math.max(h,m)}}a[0]=e;a[1]=f;a[2]=g;a[3]=h;return a};
a.getQuantizedBoundsOptimizedGeometry=function(a,c,d,e){d=b(d,e);e=c.coords;var f=Number.POSITIVE_INFINITY,g=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=Number.NEGATIVE_INFINITY,l=0,m=0;for(c=c.lengths;m<c.length;m++)for(var p=c[m],r=e[l],n=e[l+1],f=Math.min(r,f),g=Math.min(n,g),h=Math.max(r,h),k=Math.max(n,k),l=l+d,q=1;q<p;q++,l+=d){var z=e[l],w=e[l+1],r=r+z,n=n+w;0>z&&(f=Math.min(f,r));0<z&&(h=Math.max(h,r));0>w?g=Math.min(g,n):0<w&&(k=Math.max(k,n))}a[0]=f;a[1]=g;a[2]=h;a[3]=k;return a};
a.unquantizeOptimizedGeometry=S;a.removeZMValues=function(a,d,e,f,g,h){var k,l=b(e,f);e=c(e,f,g,h);f=d.coords;a.coords.length=0;a.lengths.length=0;(k=a.lengths).push.apply(k,d.lengths);for(d=0;d<f.length;d+=l)e(a.coords,f,a.coords.length,d,f[d],f[d+1]);return a};a.removeCollinearVectices=function(a,d,e,f,g){if(!d||!d.coords||!d.coords.length)return null;e=ca[e];var h=d.coords;d=d.lengths;var k=c(f,g,f,g);f=b(f,g);for(var l=g=0,m=0,p=0,r=0;r<d.length;r++){var n=d[r],l=p;k(a.coords,h,l,g,h[g],h[g+1]);
g+=f;var q=h[g],z=h[g+1],w=q,v=z,x=z/q,l=l+f;k(a.coords,h,l,g,w,v);g+=f;for(var y=2;y<n;y++){var q=h[g],z=h[g+1],B=z/q,t=x===B||!isFinite(x)&&!isFinite(B),x=t&&isFinite(B)?0<=x&&0<=B||0>=x&&0>=B:0<=v&&0<=z||0>=v&&0>=z;t&&x?(w+=q,v+=z):(w=q,v=z,l+=f);k(a.coords,h,l,g,w,v);g+=f;x=B}l+=f;n=(l-p)/f;n>=e&&(a.lengths[m]=n,p=l,m++)}a.coords.length>p&&(a.coords.length=p);a.lengths.length>m&&(a.lengths.length=m);return a.coords.length&&a.lengths.length?a:null};a.getSignedQuantizedRingArea=W;a.getQuantizedArea=
function(a,b){var c=a.coords;a=a.lengths;for(var d=0,e=0,f=0;f<a.length;f++)e+=W(c,d,a[f],b),d+=f;return Math.abs(e)};a.deltaEncodeGeometry=function(a,b){var c=a.clone(),d=a.coords;a=a.lengths;for(var e=0,f=0;f<a.length;f++){for(var g=a[f],h=d[b*e],k=d[b*e+1],l=1;l<g;l++){var m=d[b*(e+l)],p=d[b*(e+l)+1],k=p-k;c.coords[b*(e+l)]=m-h;c.coords[b*(e+l)+1]=k;h=m;k=p}e+=g}return c};a.deltaDecodeGeometry=function(a,b){var c=a.clone(),d=a.coords;a=a.lengths;for(var e=0,f=0;f<a.length;f++){for(var g=a[f],h=
d[b*e],k=d[b*e+1],l=1;l<g;l++)h+=d[b*(e+l)],k+=d[b*(e+l)+1],c.coords[b*(e+l)]=h,c.coords[b*(e+l)+1]=k;e+=g}return c}})},"esri/layers/graphics/OptimizedFeature":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,f,g){void 0===a&&(a=null);void 0===e&&(e={});this.displayId=0;this.geohashIndexed=!1;this.geohashY=this.geohashX=0;this.geometry=a;e&&(this.attributes=e);f&&(this.centroid=f);null!=g&&(this.objectId=g)}Object.defineProperty(a.prototype,
"hasGeometry",{get:function(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)},enumerable:!1,configurable:!0});a.prototype.weakClone=function(){var e=new a(this.geometry,this.attributes,this.centroid,this.objectId);e.displayId=this.displayId;e.geohashIndexed=this.geohashIndexed;e.geohashX=this.geohashX;e.geohashY=this.geohashY;return e};return a}();a.default=g})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,
"__esModule",{value:!0});g=function(){function a(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}a.prototype.weakClone=function(){var e=new a;e.objectIdFieldName=this.objectIdFieldName;e.globalIdFieldName=this.globalIdFieldName;e.geohashFieldName=
this.geohashFieldName;e.geometryProperties=this.geometryProperties;e.geometryType=this.geometryType;e.spatialReference=this.spatialReference;e.hasZ=this.hasZ;e.hasM=this.hasM;e.features=this.features;e.fields=this.fields;e.transform=this.transform;e.exceededTransferLimit=this.exceededTransferLimit;e.uniqueIdField=this.uniqueIdField;e.queryGeometry=this.queryGeometry;e.queryGeometryType=this.queryGeometryType;return e};return a}();a.default=g})},"esri/layers/graphics/OptimizedGeometry":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,f){void 0===a&&(a=[]);void 0===e&&(e=[]);void 0===f&&(f=!1);this.lengths=a;this.coords=e;this.hasIndeterminateRingOrder=f}Object.defineProperty(a.prototype,"isPoint",{get:function(){return 0===this.lengths.length},enumerable:!1,configurable:!0});a.prototype.forEachVertex=function(a){var e=0;this.lengths.length||a(this.coords[0],this.coords[1]);for(var f=0;f<this.lengths.length;f++){for(var g=this.lengths[f],
d=0;d<g;d++)a(this.coords[2*(d+e)],this.coords[2*(d+e)+1]);e+=g}};a.prototype.clone=function(){return new a(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};return a}();a.default=g})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["require","exports","../CIMCursor","../CIMOperators"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.CIMMarkerPlacementHelper=void 0;g=function(){function a(){}a.getPlacement=function(a,g,d){var b=
k.getPlacementOperator(g);if(!b)return null;a=e.cloneAndDecodeGeometry(a);return b.execute(a,g,d)};return a}();a.CIMMarkerPlacementHelper=g})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(g,a,e,k,h,f,n,d,b,c){Object.defineProperty(a,"__esModule",{value:!0});a.shapeGlyphs=a.ShapingInfo=a.ShapedGlyph=void 0;var q=Math.PI/180,u=function(){function a(a,b,c,d){this._rotationT=k.mat2df32.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;var e=c.rect,f=new Float32Array(8);a*=d;b*=d;var g=c.code?e.width*d:c.metrics.width,h=c.code?e.height*d:c.metrics.height;f[0]=a;f[1]=b;f[2]=a+g;f[3]=b;f[4]=a;f[5]=b+h;f[6]=a+g;f[7]=b+h;this._data=f;this._setTextureCoords(e);this._scale=
d;this._mosaic=c;this.x=a;this.y=b}Object.defineProperty(a.prototype,"width",{get:function(){return this._mosaic.metrics.width*this._scale},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"mosaic",{get:function(){return this._mosaic},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"angle",{get:function(){return this._angle},set:function(a){this._angle=a;e.mat2d.identity(this._rotationT);e.mat2d.rotate(this._rotationT,this._rotationT,-a);this._setOffsets(this._data)},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xTopLeft",{get:function(){return this._data[0]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"yTopLeft",{get:function(){return this._data[1]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"xBottomRight",{get:function(){return this._data[6]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"yBottomRight",{get:function(){return this._data[7]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"texcoords",{get:function(){return this._texcoords},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this._mosaic.textureBinding},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"offsets",{get:function(){this._offsets||this._setOffsets(this._data);return this._offsets},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"char",{get:function(){return String.fromCharCode(this._mosaic.code)},enumerable:!1,configurable:!0});
Object.defineProperty(a.prototype,"code",{get:function(){return this._mosaic.code},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"bounds",{get:function(){var a=this._mosaic.metrics,b=a.width*this._scale,d=Math.abs(a.height)*this._scale,a=new Float32Array(8);a[0]=this.x;a[1]=this.y;a[2]=this.x+b;a[3]=this.y;a[4]=this.x;a[5]=this.y+d;a[6]=this.x+b;a[7]=this.y+d;b=e.mat2d.multiply(k.mat2df32.create(),this._rotationT,this._T);k.mat2df32.transformMany(a,a,b);for(var d=b=Infinity,f=
0,g=0,h=0;4>h;h++)var m=a[2*h],r=a[2*h+1],b=Math.min(b,m),d=Math.min(d,r),f=Math.max(f,m),g=Math.max(g,r);a=f-b;g-=d;return new c.default(b+a/2,d+g/2,a,g)},enumerable:!1,configurable:!0});a.prototype.setTransform=function(a){this._T=a;this._offsets=null};a.prototype._setOffsets=function(a){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});var b=this._offsets,c=new Float32Array(8),f=e.mat2d.multiply(k.mat2df32.create(),this._rotationT,this._T);k.mat2df32.transformMany(c,
a,f);b.upperLeft=d.i1616to32(8*c[0],8*c[1]);b.upperRight=d.i1616to32(8*c[2],8*c[3]);b.lowerLeft=d.i1616to32(8*c[4],8*c[5]);b.lowerRight=d.i1616to32(8*c[6],8*c[7])};a.prototype._setTextureCoords=function(a){var b=a.x,c=a.y,e=a.width;a=a.height;this._texcoords={upperLeft:d.i1616to32(b,c),upperRight:d.i1616to32(b+e,c),lowerLeft:d.i1616to32(b,c+a),lowerRight:d.i1616to32(b+e,c+a)}};return a}();a.ShapedGlyph=u;var t=function(a,c){return{code:0,page:0,sdf:!0,rect:new b.default(0,0,11,8),textureBinding:c,
metrics:{advance:0,height:4,width:a,left:0,top:0}}},r=function(){function a(a,b,c){this._rotation=0;this._decorate(a,b,c);this.glyphs=a;this.bounds=this._createBounds(a);this.isMultiline=1<b.length;this._hasRotation=0!==c.angle;this._T=this._createGlyphTransform(this.bounds,c);for(b=0;b<a.length;b++)a[b].setTransform(this._T)}a.prototype.setRotation=function(a){if(0!==a||0!==this._rotation){this._rotation=a;var b=this._T;a=e.mat2d.fromRotation(k.mat2df32.create(),a);e.mat2d.multiply(b,a,b);b=0;for(a=
this.glyphs;b<a.length;b++)a[b].setTransform(this._T)}};a.prototype._decorate=function(a,b,c){if(c.decoration&&"none"!==c.decoration&&a.length){var d=c.scale;c="underline"===c.decoration?30:20;for(var e=a[0].textureBinding,f=0;f<b.length;f++){var g=b[f];a.push(new u(g.startX*d,g.startY*d+c*d,t((g.width+g.glyphWidthEnd)*d,e),1))}}};Object.defineProperty(a.prototype,"boundsT",{get:function(){var a=this.bounds,b=h.vec2.set(f.vec2f32.create(),a.x,a.y);h.vec2.transformMat2d(b,b,this._T);return this._hasRotation?
(a=Math.max(a.width,a.height),new c.default(b[0],b[1],a,a)):new c.default(b[0],b[1],a.width,a.height)},enumerable:!1,configurable:!0});a.prototype._createBounds=function(a){for(var b=Infinity,d=Infinity,e=0,f=0,g=0;g<a.length;g++)var h=a[g],b=Math.min(b,h.xTopLeft),d=Math.min(d,h.yTopLeft),e=Math.max(e,h.xTopLeft+h.width),f=Math.max(f,h.yBottomRight);a=e-b;f-=d;return new c.default(b+a/2,d+f/2,a,f)};a.prototype._createGlyphTransform=function(a,b){var c=q*b.angle,d=k.mat2df32.create(),g=f.vec2f32.create();
e.mat2d.translate(d,d,h.vec2.set(g,b.xOffset,-b.yOffset));b.isCIM?e.mat2d.rotate(d,d,c):(e.mat2d.translate(d,d,h.vec2.set(g,a.x,a.y)),e.mat2d.rotate(d,d,c),e.mat2d.translate(d,d,h.vec2.set(g,-a.x,-a.y)));return d};return a}();a.ShapingInfo=r;var m=function(){return function(a,b,c,d,e,f){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,c));this.end=Math.max(0,Math.max(b,c));this.end<a.length&&(this.glyphWidthEnd=a[this.end].metrics.width);this.width=d;this.yMin=e;this.yMax=
f}}();a.shapeGlyphs=function(a,b,c){var d=c.scale,e=[],f=[],g=1/c.scale*c.maxLineWidth,h=b?a.length-1:0,k=b?-1:a.length;b=b?-1:1;for(var l=h,q=0,v=0,w=l,t=w,J=0,H=Infinity,M=0;l!==k;){var L=a[l],K=L.code,L=L.metrics,N=Math.abs(L.top);10!==K&&32!==K&&(H=Math.min(H,N),M=Math.max(M,N+L.height));10===K?(l!==h&&(f.push(new m(a,w,l-b,q,H,M)),H=Infinity,M=0),q=0,w=l+b,t=l+b,v=0):32===K?(t=l+b,v=0,J=L.advance,q+=L.advance):(q>g&&(t!==w?(K=t-2*b,q-=J,f.push(new m(a,w,K,q-v,H,M)),H=Infinity,M=0,w=t,q=v):(f.push(new m(a,
w,l-b,q,H,M)),H=Infinity,M=0,t=w=l,q=0)),q+=L.advance,v+=L.advance);l+=b}g=new m(a,w,l-b,q,H,M);0<=g.start&&g.end<a.length&&f.push(g);for(g=0;g<f.length;g++);h=f[0].yMin;k=c.vAlign;g=c.hAlign;b=k===n.VAlign.Baseline?1:0;h=(1-b)*-h+(f[f.length-1].yMax+c.lineHeight*(f.length-1)+("underline"===c.decoration?4:0)-h)/2*(b?0:k-1)+-26*(b?1:0);for(k=0;k<f.length;k++)for(l=f[k],v=l.start,b=l.end,l=l.width/2*(g+1)*-1-3,q=k*c.lineHeight+h-3,f[k].startX=l,f[k].startY=q;v<=b;v++)w=a[v],10!==w.code&&(t=new u(l+
w.metrics.left,q-w.metrics.top,w,d),l+=w.metrics.advance,e.push(t));return new r(e,f,c)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define("require exports ../../../../../../core/maybe ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/cim/effects/CIMEffectHelper ../../enums".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(){}Object.defineProperty(a.prototype,"needsPixelBuffer",{get:function(){return!!this.effects||
this.geometryType===f.WGLGeometryType.MARKER||this.geometryType===f.WGLGeometryType.TEXT||this.geometryType===f.WGLGeometryType.LABEL},enumerable:!1,configurable:!0});a.prototype.writeMesh=function(a,b,c,f,g){if(e.isNone(this.effects))return this.writeMeshWithGeometry(a,b,c,f,g);f=h.CIMEffectHelper.executeEffects(this.effects,c.readLegacyGeometry());for(var d=h.CIMEffectHelper.next(f);d;)this.writeMeshWithGeometry(a,b,c,k.getJsonType(d),g,d),d=h.CIMEffectHelper.next(f)};a.prototype.writeMeshWithGeometry=
function(a,b,c,e,f,g){};a.prototype.bindFeature=function(a,b,c){};return a}();a.default=g})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["require","exports","../CIMCursor","../CIMEffects","../CIMOperators"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.CIMEffectHelper=void 0;var f=96/72;g=function(){function a(){}a.executeEffects=function(a,b){b=e.cloneAndDecodeGeometry(b);b=new k.SimpleGeometryCursor(b);for(var c=0;c<a.length;c++){var d=a[c],g=h.getEffectOperator(d);
g&&(b=g.execute(b,d,f))}return b};a.next=function(a){a=a.next();e.deltaEncodeGeometry(a);return a};return a}();a.CIMEffectHelper=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../definitions ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function g(b,d,e,g,h,k,m,r,v,t,F,I,G,J,H,M,L,K,N,Q,O){var l=a.call(this)||this;l.angle=g;l.height=m;l.width=k;l.xOffset=d*N;l.yOffset=e*N;l._markerPlacement=Q;l.effects=O;l._anchorX=.5-(.5+M)*H.width/H.width;l._anchorY=.5-(.5+L)*H.height/H.height;d=(1===J?1:0)|(F?1:0)<<1|(G?1:0)<<2|(I?1:0)<<3;e=H&&H.sdf;b=u.MarkerMaterialKey.load(b);b.sdf=e;b.pattern=!0;b.textureBinding=H.textureBinding;l._materialKey=
b.data;l._fillColor=h;l._outlineColor=v;l._sizeOutlineWidth=q.i8888to32(Math.round(Math.min(Math.sqrt(128*k),255)),Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*t),255)),Math.round(Math.min(Math.sqrt(128*r),255)));h=H.rect.x+c.SPRITE_PADDING;r=H.rect.y+c.SPRITE_PADDING;v=h+H.width;H=r+H.height;l._texUpperLeft=q.i1616to32(h,r);l._texUpperRight=q.i1616to32(v,r);l._texBottomLeft=q.i1616to32(h,H);l._texBottomRight=q.i1616to32(v,H);k=k*K*N;m=m*K*N;l._bitestAndDistRatio=q.i8888to32(0,
0,d,Math.round(Math.min(64*K,255)));l._computedWidth=k;l._computedHeight=m;k=n.vec2f32.create();m=f.mat2df32.create();l._applyTransformation(m,k);return l}e.__extends(g,a);g.fromCIMMarker=function(a,b){var c=a.size,e=(b&&b.width||1)/(b&&b.height||1)*a.scaleX,f=a.scaleSymbolsProportionally&&a.frameHeight?c/a.frameHeight:1,l=d.premultiplyAlphaRGBA(a.color),m=d.premultiplyAlphaRGBA(a.outlineColor),r=h.pt2px(c),n=r*e,q=h.pt2px(a.offsetX||0),v=h.pt2px(a.offsetY||0),f=h.pt2px(a.outlineWidth||0)*f,w=a.alignment||
0,t=h.pt2px(a.referenceSize),u=a.rotation||0;a.rotateClockwise||(u=-u);var H=0,M=0,L=a.anchorPoint;L&&(a.isAbsoluteAnchorPoint?c&&(H=-L.x/(c*e),M=L.y/c):(H=L.x,M=L.y));return new g(a.materialKey,q,v,u,l,n,r,t,m,f,a.colorLocked,a.scaleSymbolsProportionally,!1,w,b,H,M,a.sizeRatio,k.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects)};g.fromPictureMarker=function(a,c){var d=Math.round(h.pt2px(a.width)),e=Math.round(h.pt2px(a.height)),f=b.PICTURE_FILL_COLOR,k=Math.round(h.pt2px(a.xoffset||0)),l=Math.round(h.pt2px(a.yoffset||
0));return new g(a.materialKey,k,l,a.angle,f,d,e,e,0,0,!1,!1,!1,0,c,0,0,1,1,null,null)};g.fromSimpleMarker=function(a,b){var c=d.premultiplyAlphaRGBAArray(a.color),e=Math.round(h.pt2px(a.size)),f=Math.round(h.pt2px(a.xoffset||0)),k=Math.round(h.pt2px(a.yoffset||0)),l=a.style,m=a.outline,r=(m&&m.color&&d.premultiplyAlphaRGBAArray(m.color))|0,m=(m&&m.width&&Math.round(h.pt2px(m.width)))|0;a=new g(a.materialKey,f,k,a.angle,c,e,e,e,r,m,!1,!1,"esriSMSCross"===l||"esriSMSX"===l,0,b,0,0,1.96875,1,null,null);
a.boundsType="esriSMSCircle"===l?"circle":"square";return a};g.fromLineSymbolMarker=function(a,b){var c=d.premultiplyAlphaRGBAArray(a.color),e=Math.round(h.pt2px(6*a.lineWidth)),f="cross"===a.style||"x"===a.style,k;switch(a.placement){case "begin-end":k="Both";break;case "begin":k="JustBegin";break;case "end":k="JustEnd";break;default:k="None"}k={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:k,offsetAlongLine:0};b=new g(a.materialKey,0,0,0,c,e,e,e/6,c,f?Math.round(h.pt2px(a.lineWidth)):
0,!1,!1,f,1,b,0,0,1.96875,1,k,null);b.boundsType="circle"===a.style?"circle":"square";return b};return g}(t.default(r.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports tslib ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../enums ../../number".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t){Object.defineProperty(a,"__esModule",{value:!0});var r=3.14159265359/180;a.default=function(a){return function(a){function g(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.angle=0;b.xOffset=0;b.yOffset=0;b.width=0;b.height=0;b.boundsType="square";b._anchorX=0;b._anchorY=0;b._computedWidth=0;b._computedHeight=0;b.geometryType=u.WGLGeometryType.MARKER;return b}e.__extends(g,a);g.prototype.writeMeshWithGeometry=function(a,b,d,
e,f,g){var h=this,l=b.indexVector,m=b.get("geometry"),p=b.getVector("geometry"),r=p.vertexCount,n=l.length;if(k.isSome(this._markerPlacement))d=null!==g&&void 0!==g?g:d.readLegacyGeometry(),this._writePlacedMarkers(m,l,r,f,d);else{d=g?c.deltaDecodeGeometry(c.convertFromGeometry(g),2):"esriGeometryPolygon"===e?d.readCentroid():d.readUnquantizedGeometry();if(!d)return;d.isPoint?(d=d.coords,this._writeVertices(m,f,this._getPos(d[0],d[1])),this._writeIndices(l,r)):d.forEachVertex(function(a,b){var c=
p.vertexCount;h._writeVertices(m,f,h._getPos(a,b));h._writeIndices(l,c)})}b=b.getVector("geometry").vertexCount-r;a.writeDisplayRecord(this.geometryType,this._materialKey,r,b,n,l.length-n)};g.prototype._applyTransformation=function(a,c,e){void 0===e&&(e=0);f.mat2d.identity(a);f.mat2d.translate(a,a,b.vec2f32.fromValues(this.xOffset,-this.yOffset));0!==this.angle+e&&f.mat2d.rotate(a,a,r*(this.angle+e));e=this._computedWidth;var g=this._computedHeight,h=(this._anchorX-.5)*e,k=(this._anchorY-.5)*g;d.vec2.set(c,
h,k);d.vec2.transformMat2d(c,c,a);this._offsetUpperLeft=t.i1616to32(16*c[0],16*c[1]);d.vec2.set(c,h+e,k);d.vec2.transformMat2d(c,c,a);this._offsetUpperRight=t.i1616to32(16*c[0],16*c[1]);d.vec2.set(c,h,k+g);d.vec2.transformMat2d(c,c,a);this._offsetBottomLeft=t.i1616to32(16*c[0],16*c[1]);d.vec2.set(c,h+e,k+g);d.vec2.transformMat2d(c,c,a);this._offsetBottomRight=t.i1616to32(16*c[0],16*c[1])};g.prototype._writePlacedMarkers=function(a,c,d,e,f){if(f=q.CIMMarkerPlacementHelper.getPlacement(f,k.unwrap(this._markerPlacement),
h.pt2px(1)))for(var g=b.vec2f32.create(),l=n.mat2df32.create(),m=0,p=f.next();null!=p;)-128<=p.tx&&640>=p.tx&&-128<=p.ty&&640>=p.ty&&(this._applyTransformation(l,g,p.getAngle()/r),this._writeVertices(a,e,this._getPos(p.tx,p.ty)),this._writeIndices(c,d+m),m+=4),p=f.next()};g.prototype._getPos=function(a,b){return t.i1616to32(Math.round(8*a),Math.round(8*b))};g.prototype._writeVertices=function(a,b,c){a.push(c);a.push(this._offsetUpperLeft);a.push(this._texUpperLeft);a.push(this._bitestAndDistRatio);
a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetUpperRight);a.push(this._texUpperRight);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetBottomLeft);a.push(this._texBottomLeft);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetBottomRight);
a.push(this._texBottomRight);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth)};g.prototype._writeIndices=function(a,b){a.push(b+0);a.push(b+1);a.push(b+2);a.push(b+1);a.push(b+3);a.push(b+2)};return g}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/schemaUtils ../../../../layers/features/textUtils".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l,w,p){function y(a,b){var c=a.length;a.push(null);b.then(function(b){return a[c]=b});return a}function z(a){return!!(a&1)}Object.defineProperty(a,"__esModule",{value:!0});a.WGLTemplateStore=a.isDynamicId=void 0;var C=h.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),B=[];a.isDynamicId=z;g=function(){function a(a,b){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=
[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new v.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!1,configurable:!0});a.prototype.createTemplateGroup=function(a,b){this._initErrorTemplates();var c=a.hash;if(this._symbolToTemplate.has(c))return this._symbolToTemplate.get(c);var d=[];b&&this._createMeshTemplates(d,b,!0);this._createMeshTemplates(d,a,!1);a=this._createGroupId("expanded-cim"===a.type);this._idToTemplateGroup.set(a,d);this._symbolToTemplate.set(c,
a);return a};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):B};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return B;z(a)||C.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.getMosaicItem=function(a,b){var c=this,d=this._createTemplateId(),e=f.create(function(a){return c._idToResolver.set(d,a)});this._fetchQueue.push({symbol:a,
id:d,glyphIds:b});return e};a.prototype.finalize=function(a){return this._fetchQueue.length||this._lock.isHeld()?v.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):f.resolve()};a.prototype._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],w.createSymbolSchema(n.errorPolygonSymbol2D),!1),marker:this._createMeshTemplates([],w.createSymbolSchema(n.errorPointSymbol2D),!1),line:this._createMeshTemplates([],w.createSymbolSchema(n.errorPolylineSymbol2D),
!1)})};a.prototype._fetchAllQueuedResources=function(a){var b=this;if(!this._fetchQueue.length)return f.resolve();var c=this._fetchQueue,d=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return f.all(d).then(function(){return b._fetchResource(c,a).then(function(a){for(var c=0;c<a.length;c++){var d=a[c],e=d.id,d=d.mosaicItem;b._idToResolver.get(e)(d);b._idToResolver.delete(e)}})}).catch(function(a){f.isAbortError(a)?b._fetchQueue=b._fetchQueue.concat(c):"worker:port-closed"!==a.name&&C.error(new k("mapview-template-store",
"Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._createSMS=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this.getMosaicItem(a)];case 1:return b=c.sent().spriteMosaicItem,l.ok(b,C)?[2,r.default.fromSimpleMarker(a,b)]:[2,this._markerError]}})})};
a.prototype._createPMS=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this.getMosaicItem(a)];case 1:return b=c.sent().spriteMosaicItem,l.ok(b,C)?[2,r.default.fromPictureMarker(a,b)]:[2,this._markerError]}})})};a.prototype._createSFS=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a)];case 1:return c=
d.sent().spriteMosaicItem,l.ok(c,C)?[2,u.default.fromSimpleFill(a,c,b)]:[2,this._fillError]}})})};a.prototype._createPFS=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){switch(d.label){case 0:return[4,this.getMosaicItem(a)];case 1:return c=d.sent().spriteMosaicItem,l.ok(c,C)?[2,u.default.fromPictureFill(a,c,b)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,
function(c){switch(c.label){case 0:return[4,this.getMosaicItem(a)];case 1:return b=c.sent().spriteMosaicItem,l.ok(b,C)?[2,t.default.fromSimpleLine(a,b,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createLMS=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this.getMosaicItem(a)];case 1:return b=c.sent().spriteMosaicItem,l.ok(b,C)?[2,r.default.fromLineSymbolMarker(a,b)]:[2,this._markerError]}})})};a.prototype._createTS=
function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this.getMosaicItem(a)];case 1:return b=c.sent().glyphMosaicItems,[2,m.default.fromText(a,b)]}})})};a.prototype._createCIMText=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return[4,this.getMosaicItem(a.cim,p.codepoints(a.text))];case 1:return b=c.sent().glyphMosaicItems,a.cim.mosaicHash=
a.materialHash,l.ok(b,C)?[2,m.default.fromCIMText(a,b)]:[2,this._textError]}})})};a.prototype._createCIMFill=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim)];case 1:return b=c.sent().spriteMosaicItem,l.ok(b,C)?[2,u.default.fromCIMFill(a,b)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;
return e.__generator(this,function(c){switch(c.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim)];case 1:return b=c.sent().spriteMosaicItem,l.ok(b,C)?[2,t.default.fromCIMLine(a,b,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getMosaicItem(a.cim)];case 1:return b=c.sent().spriteMosaicItem,
l.ok(b,C)?[2,r.default.fromCIMMarker(a,b)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c,d=this;return e.__generator(this,function(e){b=a.templateHash;if(this._cimTemplateCache.has(b))return[2,this._cimTemplateCache.get(b)];switch(a.type){case "marker":c=this._createCIMMarker(a);break;case "line":c=this._createCIMLine(a);break;case "fill":c=this._createCIMFill(a);break;case "text":c=this._createCIMText(a)}c.then(function(a){return d._cimTemplateCache.set(b,
a)});return[2,c]})})};a.prototype._createDynamicCIM=function(a){var e=a.templateHash;if(this._cimTemplateCache.has(e))return this._cimTemplateCache.get(e);var f;switch(a.type){case "marker":f=c.default.fromCIMMarker(a);break;case "line":f=b.default.fromCIMLine(a);break;case "fill":f=d.default.fromCIMFill(a);break;case "text":f=q.default.fromCIMText(a)}this._cimTemplateCache.set(e,f);return f};a.prototype._createPrimitiveMeshTemplates=function(a,b,c){switch(b.type){case "esriSMS":return y(a,this._createSMS(b));
case "esriPMS":return y(a,this._createPMS(b));case "esriSFS":return y(a,this._createSFS(b,c));case "line-marker":return y(a,this._createLMS(b));case "esriPFS":return y(a,this._createPFS(b,c));case "esriSLS":return y(a,this._createSLS(b,!1));case "esriTS":return y(a,this._createTS(b));default:return C.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),a}};a.prototype._createMeshTemplates=function(a,b,c){if(-1!==b.type.indexOf("3d"))return C.error("3D symbols are not supported with MapView"),
a;if("expanded-cim"===b.type){c=0;for(var d=b.layers;c<d.length;c++)b=d[c],"function"===typeof b.materialHash?a.push(this._createDynamicCIM(b)):y(a,this._createCIM(b));return a}if("composite-symbol"===b.type){for(var d=0,e=b.layers;d<e.length;d++)b=e[d],this._createPrimitiveMeshTemplates(a,b,c);return a}return"cim"===b.type||"label"===b.type||"web-style"===b.type?a:this._createPrimitiveMeshTemplates(a,b,c)};return a}();a.WGLTemplateStore=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("require exports tslib ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function g(b){var e=a.call(this,b)||this;if(q.isFunction(b.color))e._dynamicPropertyMap.set("_fillColor",function(a,c,d){return(a=b.color(a,c,d))&&f.premultiplyAlphaRGBA(a)||0});else{var g=b.color;e.fillColor=g&&f.premultiplyAlphaRGBA(g)||0}var k=0;q.isFunction(b.height)||(k=b.height||0);e._dynamicPropertyMap.set("_height",function(a,c,d){return q.isFunction(b.height)?b.height(a,c,d):k});var m=0;q.isFunction(b.offsetX)||
(m=h.pt2px(b.offsetX||0)+128,255<m&&(m=255));e._dynamicPropertyMap.set("_offsetX",function(a,c,d){return q.isFunction(b.offsetX)?(a=h.pt2px(b.offsetX(a,c,d))+128,255<a&&(a=255),a):m});var l=1;q.isFunction(b.scaleX)||(l=b.scaleX||1);e._dynamicPropertyMap.set("_scaleX",function(a,c,d){return q.isFunction(b.scaleX)?b.scaleX(a,c,d):l});var r=0;q.isFunction(b.offsetY)||(r=h.pt2px(-b.offsetY||0)+128,255<r&&(r=255));e._dynamicPropertyMap.set("_offsetY",function(a,c,d){return q.isFunction(b.offsetY)?(a=h.pt2px(-b.offsetY(a,
c,d))+128,255<a&&(a=255),a):r});var n=0;q.isFunction(b.angle)||(n=d.radToByte(b.angle)||0);e._dynamicPropertyMap.set("_angle",function(a,c,e){return q.isFunction(b.angle)?d.radToByte(b.angle(a,c,e)):n});e.effects=b.effects;e._cimFillLayer=b;e._fillMaterialKey=c.FillMaterialKey.load(b.materialKey);return e}e.__extends(g,a);g.fromCIMFill=function(a){return new g(a)};g.prototype.bindFeature=function(a,c,d){var e=this,f=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,b){e[b]=a(f,c,d)});
a=this._fillMaterialKey;var g=this._materialCache,m=this._cimFillLayer;this.aux3=b.i8888to32(0,0,this._angle,m.colorLocked?1:0);m=m.materialHash;m=m(f,c,d);m=g.get(m);g=null;m&&r.ok(m.spriteMosaicItem)&&(g=m.spriteMosaicItem);if(g){var l=g.rect,p=g.width,q=g.height,m=l.x+n.SPRITE_PADDING,l=l.y+n.SPRITE_PADDING,v=m+p,w=l+q,t=k.nextHighestPowerOfTwo(h.pt2px(this._height));255<t?t=255:0>=t&&(t=k.nextHighestPowerOfTwo(w-l));p=k.nextHighestPowerOfTwo(h.pt2px(this._height/q*p||0));255<p?p=255:0>=p&&(p=
k.nextHighestPowerOfTwo(v-m));q=this._scaleX;this.tl=b.i1616to32(m,l);this.br=b.i1616to32(v,w);this.aux1=b.i8888to32(p,t,this._offsetX,this._offsetY);this.aux2=b.i1616to32(128*q,128);a.sdf=g.sdf;a.pattern=!0;a.textureBinding=g.textureBinding}else this.aux2=this.aux1=this.br=this.tl=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data};return g}(u.default(t.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("require exports tslib ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(g,a,e,k,h,f,n,d){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return function(a){function b(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.forceLibtess=!1;b.geometryType=h.WGLGeometryType.FILL;return b}e.__extends(b,a);b.prototype.writeMeshWithGeometry=function(a,b,c,e,f,g){e=n.FillMaterialKey.load(this._materialKey);var h=b.indexVector;b=b.getVector("geometry");var m=b.vertexCount,l=h.length;if(g=g?k.deltaDecodeGeometry(k.convertFromGeometry(g),
2):c.readUnquantizedGeometry())if(g=d.clipMarshall(g)){var r=g.coords;if(this.forceLibtess||!d.triangulate(h,g,m))r=[],d.triangulateLibtess(r,h,g,m);this._write(b,c,f,r,e);a.writeDisplayRecord(this.geometryType,this._materialKey,m,b.vertexCount-m,l,h.length-l)}};b.prototype._write=function(a,b,c,d,e){for(var g=0;g<d.length;g+=2){var h=f.i1616to32(1*d[g],1*d[g+1]);a.data.push(h);a.data.push(c);e.dotDensity?a.data.writeF32(1/Math.abs(b.readGeometryArea())):(a.data.push(this.fillColor),a.data.push(this.tl),
a.data.push(this.br),a.data.push(this.aux1),a.data.push(this.aux2),a.data.push(this.aux3))}};return b}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("require exports ../../../../../../core/libs/earcut/earcut ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../TileClipper ../bufcut ../Tesselator".split(" "),function(g,a,e,k,h,f,n,d){function b(a,b,c){for(var d=0,e=1;e<c;e++)d+=(a[2*(b+e)]-a[2*(b+e-1)])*(a[2*(b+e)+1]+a[2*(b+e-1)+1]);return d}
function c(a,b,c,d,e){for(var f=0;c<d;c+=3)var g=2*(a.getValue(c)-e),h=2*(a.getValue(c+1)-e),k=2*(a.getValue(c+2)-e),f=f+Math.abs((b[g]-b[k])*(b[h+1]-b[g+1])-(b[g]-b[h])*(b[k+1]-b[g+1]));return f}function q(a,b,c,d,e,f,g,h){e=((a-e)*(f-h)-(b-h)*(e-g))/((a-c)*(f-h)-(b-d)*(e-g));return 0>e||1<e?null:{x:Math.round(a+e*(c-a)),y:Math.round(b+e*(d-b))}}Object.defineProperty(a,"__esModule",{value:!0});a.clip=a.clipMarshall=a.triangulateLibtess=a.triangulateEarcut=a.triangulate=a.triangleArea=a.area=void 0;
var u=new d.default,t=new f.TileClipper(0,0,0,1,128);t.setExtent(h.TILE_SIZE);a.area=b;a.triangleArea=c;a.triangulate=function(a,d,e){var f=d.coords,g=d.lengths;if(d.hasIndeterminateRingOrder)return!1;d=a.length;for(var h=0,k=0;k<g.length;){for(var m=k,r=g[k],k=b(f,h,r),q=[];++m<g.length;){var v=g[m],t=b(f,h+r,v);if(!(0<t))break;k+=t;q.push(h+r);r+=v}v=a.length;n.bufcut(a,f,h,h+r,q,2,e);q=c(a,f,v,a.length,e);k=Math.abs(k);if(1E-5<Math.abs((q-k)/Math.max(1E-7,k)))return a.seek(d),!1;k=m;h+=r}return!0};
a.triangulateEarcut=function(a,c,d){var f=c.coords,g=c.lengths;if(c.hasIndeterminateRingOrder)return!1;for(var h=0,k=0;k<g.length;){for(var m=k,r=g[k],k=[];++m<g.length;){var n=g[m];if(!(0<b(f,h+r,n)))break;k.push(h+r-h);r+=n}for(var q=c.coords.slice(2*h,2*(h+r)),n=0,k=e.earcut(q,k,2);n<k.length;n++)a.push(k[n]+d+h);k=m;h+=r}return!0};a.triangulateLibtess=function(a,b,c,d){var e=[],f=c.coords,g=c.lengths;u.beginPolygon(a,e);for(var h=a=0;h<g.length;h++){var k=c.lengths[h];u.beginContour();for(var m=
0;m<k;m++){var l=[f[2*(a+m)],f[2*(a+m)+1],0];u.addVertex(l,l)}u.endContour();a+=k}u.endPolygon();for(m=0;m<e.length;m++)b.push(e[m]+d)};a.clipMarshall=function(a){var b;a:{b=h.TILE_SIZE+128;for(var c=0,d=0;d<a.lengths.length;d++){for(var e=a.lengths[d],f=0;f<e;f++){var g=a.coords[2*(f+c)],r=a.coords[2*(f+c)+1];if(-128>g||g>b||-128>r||r>b){b=!0;break a}}c+=e}b=!1}if(!b)return a;t.reset(3);for(b=c=0;b<a.lengths.length;b++){d=a.lengths[b];e=a.coords[2*(0+c)];f=a.coords[2*(0+c)+1];t.moveTo(e,f);for(g=
1;g<d;g++)e=a.coords[2*(g+c)],f=a.coords[2*(g+c)+1],t.lineTo(e,f);t.close();c+=d}a=t.result(!1);if(!a)return null;c=[];d=[];for(e=0;e<a.length;e++){b=a[e];for(g=f=0;g<b.length;g++)r=b[g],d.push(r.x),d.push(r.y),f++;c.push(f)}return new k.default(c,d)};a.clip=function(a,b,c){void 0===c&&(c=0);var d=-c;b+=c;for(var e=c=0,f=0,g=0;g<a.lengths.length;g++){for(var h=a.lengths[g],k=f+h,m=0,n=null;c!==k;){for(var r=a.coords[2*c],v=a.coords[2*c++ +1],t=r<d||r>=b||v<d||v>=b,u=t;c!==k&&t===u;)t||(a.coords[2*
e]=r,a.coords[2*e++ +1]=v,m++),r=a.coords[2*c],v=a.coords[2*c++ +1],t=r<d||r>=b||v<d||v>=b;if(c===k)t?n&&(a.coords[2*e]=n.x,a.coords[2*e++ +1]=n.y,m++):(a.coords[2*e]=r,a.coords[2*e++ +1]=v,m++);else{var u=a.coords[2*(c-2)],G=a.coords[2*(c-2)+1];if(u=q(u,G,r,v,d,d,b,d)||q(u,G,r,v,b,d,b,b)||q(u,G,r,v,b,b,d,b)||q(u,G,r,v,d,d,d,b))a.coords[2*e]=u.x,a.coords[2*e++ +1]=u.y,m++,n||(n=u);t||(a.coords[2*e]=r,a.coords[2*e++ +1]=v,m++)}}a.lengths[g]=m;f+=h}}})},"esri/core/libs/earcut/earcut":function(){define(["require",
"exports"],function(g,a){function e(a,b,c,e,f){var g;if(f===0<r(a,b,c,e))for(f=b;f<c;f+=e)g=n(f,a[f],a[f+1],g);else for(f=c-e;f>=b;f-=e)g=n(f,a[f],a[f+1],g);g&&w(g,g.next)&&(d(g),g=g.next);return g}function k(a,b){void 0===b&&(b=a);if(!a)return a;var c;do if(c=!1,a.steiner||!w(a,a.next)&&0!==u(a.prev,a,a.next))a=a.next;else{d(a);a=b=a.prev;if(a===a.next)break;c=!0}while(c||a!==b);return b}function h(a,b,c,e,g,l,p){void 0===p&&(p=0);if(a){!p&&l&&(a=q(a,e,g,l));for(var r=a;a.prev!==a.next;){var n=a.prev,
z=a.next,x;if(l)x=f(a,e,g,l);else a:{x=a;var B=x.prev,C=x,A=x.next;if(0<=u(B,C,A))x=!1;else{for(var E=x.next.next,F=E,I=0;E!==x.prev&&(0===I||E!==F);){I++;if(m(B.x,B.y,C.x,C.y,A.x,A.y,E.x,E.y)&&0<=u(E.prev,E,E.next)){x=!1;break a}E=E.next}x=!0}}if(x)b.push(n.index/c),b.push(a.index/c),b.push(z.index/c),d(a),r=a=z.next;else if(a=z,a===r){if(!p)h(k(a),b,c,e,g,l,1);else if(1===p){p=b;r=c;n=a;do z=n.prev,x=n.next.next,!w(z,x)&&t(z,n,n.next,x)&&v(z,x)&&v(x,z)&&(p.push(z.index/r),p.push(n.index/r),p.push(x.index/
r),d(n),d(n.next),n=a=x),n=n.next;while(n!==a);a=n;h(a,b,c,e,g,l,2)}else if(2===p)a:{p=a;do{for(r=p.next.next;r!==p.prev;){if(n=p.index!==r.index){n=p;z=r;x=void 0;if(x=n.next.index!==z.index&&n.prev.index!==z.index){x=void 0;b:{x=n;do{if(x.index!==n.index&&x.next.index!==n.index&&x.index!==z.index&&x.next.index!==z.index&&t(x,x.next,n,z)){x=!0;break b}x=x.next}while(x!==n);x=!1}x=!x}B=void 0;if(B=x&&v(n,z)&&v(z,n)){x=n;B=!1;C=(n.x+z.x)/2;z=(n.y+z.y)/2;do x.y>z!==x.next.y>z&&x.next.y!==x.y&&C<(x.next.x-
x.x)*(z-x.y)/(x.next.y-x.y)+x.x&&(B=!B),x=x.next;while(x!==n)}n=B}if(n){a=y(p,r);p=k(p,p.next);a=k(a,a.next);h(p,b,c,e,g,l);h(a,b,c,e,g,l);break a}r=r.next}p=p.next}while(p!==a)}break}}}}function f(a,b,c,d){var e=a.prev,f=a.next;if(0<=u(e,a,f))return!1;var g=e.x>a.x?e.x>f.x?e.x:f.x:a.x>f.x?a.x:f.x,h=e.y>a.y?e.y>f.y?e.y:f.y:a.y>f.y?a.y:f.y,k=l(e.x<a.x?e.x<f.x?e.x:f.x:a.x<f.x?a.x:f.x,e.y<a.y?e.y<f.y?e.y:f.y:a.y<f.y?a.y:f.y,b,c,d);b=l(g,h,b,c,d);c=a.prevZ;for(d=a.nextZ;c&&c.z>=k&&d&&d.z<=b;){if(c!==
a.prev&&c!==a.next&&m(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=u(c.prev,c,c.next))return!1;c=c.prevZ;if(d!==a.prev&&d!==a.next&&m(e.x,e.y,a.x,a.y,f.x,f.y,d.x,d.y)&&0<=u(d.prev,d,d.next))return!1;d=d.nextZ}for(;c&&c.z>=k;){if(c!==a.prev&&c!==a.next&&m(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=u(c.prev,c,c.next))return!1;c=c.prevZ}for(;d&&d.z<=b;){if(d!==a.prev&&d!==a.next&&m(e.x,e.y,a.x,a.y,f.x,f.y,d.x,d.y)&&0<=u(d.prev,d,d.next))return!1;d=d.nextZ}return!0}function n(a,b,c,d){a=new z(a,b,c);d?(a.next=d.next,
a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function d(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function b(a){var b=a,c=a;do{if(b.x<c.x||b.x===c.x&&b.y<c.y)c=b;b=b.next}while(b!==a);return c}function c(a,b){var c=b,d=a.x,e=a.y,f=-Infinity,g;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var h=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(h<=d&&h>f){f=h;if(h===d){if(e===c.y)return c;if(e===c.next.y)return c.next}g=c.x<c.next.x?
c:c.next}}c=c.next}while(c!==b);if(!g)return null;if(d===f)return g.prev;b=g;for(var h=g.x,k=g.y,l=Infinity,p,c=g.next;c!==b;)d>=c.x&&c.x>=h&&d!==c.x&&m(e<k?d:f,e,h,k,e<k?f:d,e,c.x,c.y)&&(p=Math.abs(e-c.y)/(d-c.x),(p<l||p===l&&c.x>g.x)&&v(c,a)&&(g=c,l=p)),c=c.next;return g}function q(a,b,c,d){for(var e=void 0;e!==a;e=e.next){e=e||a;null===e.z&&(e.z=l(e.x,e.y,b,c,d));if(e.prev.next!==e||e.next.prev!==e)return e.prev.next=e,e.next.prev=e,q(a,b,c,d);e.prevZ=e.prev;e.nextZ=e.next}a.prevZ.nextZ=null;a.prevZ=
null;a:for(c=1;;){d=a;e=void 0;b=a=null;for(var f=0;d;){f++;for(var e=d,g=0;g<c&&e;g++)e=e.nextZ;for(var h=c;0<g||0<h&&e;){var k=void 0;0===g?(k=e,e=e.nextZ,h--):0!==h&&e?d.z<=e.z?(k=d,d=d.nextZ,g--):(k=e,e=e.nextZ,h--):(k=d,d=d.nextZ,g--);b?b.nextZ=k:a=k;k.prevZ=b;b=k}d=e}b.nextZ=null;c*=2;if(2>f)break a}return a}function u(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function t(a,b,c,d){return w(a,b)&&w(c,d)||w(a,d)&&w(c,b)?!0:0<u(a,b,c)!==0<u(a,b,d)&&0<u(c,d,a)!==0<u(c,d,b)}function r(a,
b,c,d){for(var e=0,f=c-d;b<c;b+=d)e+=(a[f]-a[b])*(a[b+1]+a[f+1]),f=b;return e}function m(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function v(a,b){return 0>u(a.prev,a,a.next)?0<=u(a,b,a.next)&&0<=u(a,a.prev,b):0>u(a,b,a.prev)||0>u(a,a.next,b)}function l(a,b,c,d,e){a=32767*(a-c)*e;b=32767*(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&
1431655765|((b|b<<1)&1431655765)<<1}function w(a,b){return a.x===b.x&&a.y===b.y}function p(a,b){return a.x-b.x}function y(a,b){var c=new z(a.index,a.x,a.y),d=new z(b.index,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}Object.defineProperty(a,"__esModule",{value:!0});a.deviation=a.earcut=void 0;a.earcut=function(a,d,f){var g=d&&d.length,m=g?d[0]*f:a.length,l=e(a,0,m,f,!0),n=[];if(!l||l.next===l.prev)return n;var r,q,z;if(g){for(var g=[],
v=0,t=d.length;v<t;v++){var w=e(a,d[v]*f,v<t-1?d[v+1]*f:a.length,f,!1);w===w.next&&(w.steiner=!0);g.push(b(w))}g.sort(p);for(d=0;d<g.length;d++){v=g[d];t=l;if(t=c(v,t))v=y(t,v),k(v,v.next);l=k(l,l.next)}}if(a.length>80*f){r=z=a[0];q=g=a[1];for(d=f;d<m;d+=f)v=a[d],t=a[d+1],r=Math.min(r,v),q=Math.min(q,t),z=Math.max(z,v),g=Math.max(g,t);z=Math.max(z-r,g-q);z=0!==z?1/z:0}h(l,n,f,r,q,z);return n};a.deviation=function(a,b,c,d){var e=b&&b.length,f=Math.abs(r(a,0,e?b[0]*c:a.length,c));if(e)for(var e=0,g=
b.length;e<g;e++)f-=Math.abs(r(a,b[e]*c,e<g-1?b[e+1]*c:a.length,c));for(e=b=0;e<d.length;e+=3){var g=d[e]*c,h=d[e+1]*c,k=d[e+2]*c;b+=Math.abs((a[g]-a[k])*(a[h+1]-a[g+1])-(a[g]-a[h])*(a[k+1]-a[g+1]))}return 0===f&&0===b?0:Math.abs((b-f)/f)};var z=function(){return function(a,b,c){this.index=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}}()})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./definitions","./Geometry","./GeometryUtils"],
function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.SimpleBuilder=a.TileClipper=void 0;var f=function(){return function(a,b,c){this.ratio=a;this.x=b;this.y=c}}();g=function(){function a(a,c,d,f,g){void 0===f&&(f=8);void 0===g&&(g=8);this.lines=[];this.starts=[];this.pixelRatio=f;this.pixelMargin=g;this.tileSize=e.TILE_SIZE*f;this.dz=a;this.yPos=c;this.xPos=d}a.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var b=this.pixelRatio*this.pixelMargin,b=b/
this.finalRatio;a>>=this.dz;b>a&&(b=a);this.margin=b;this.xmin=a*this.xPos-b;this.ymin=a*this.yPos-b;this.xmax=this.xmin+a+2*b;this.ymax=this.ymin+a+2*b};a.prototype.reset=function(a){this.type=a;this.lines=[];this.starts=[];this.line=null;this.start=0};a.prototype.moveTo=function(a,c){this._pushLine();this._prevIsIn=this._isIn(a,c);this._moveTo(a,c,this._prevIsIn);this._prevPt=new k.Point(a,c);this._firstPt=new k.Point(a,c);this._dist=0};a.prototype.lineTo=function(a,c){var b=this._isIn(a,c),d=new k.Point(a,
c),e=k.Point.distance(this._prevPt,d),g,h,n;if(b)this._prevIsIn?this._lineTo(a,c,!0):(g=this._prevPt,h=d,a=this._intersect(h,g),this.start=this._dist+e*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(h.x,h.y,!0));else if(this._prevIsIn)h=this._prevPt,g=d,a=this._intersect(h,g),this._lineTo(a.x,a.y,!0),this._lineTo(g.x,g.y,!1);else{var l=this._prevPt;if(!(l.x<=this.xmin&&d.x<=this.xmin||l.x>=this.xmax&&d.x>=this.xmax||l.y<=this.ymin&&d.y<=this.ymin||l.y>=this.ymax&&d.y>=this.ymax)){a=[];if(l.x<this.xmin&&
d.x>this.xmin||l.x>this.xmin&&d.x<this.xmin)c=(this.xmin-l.x)/(d.x-l.x),n=l.y+c*(d.y-l.y),n<=this.ymin?h=!1:n>=this.ymax?h=!0:a.push(new f(c,this.xmin,n));if(l.x<this.xmax&&d.x>this.xmax||l.x>this.xmax&&d.x<this.xmax)c=(this.xmax-l.x)/(d.x-l.x),n=l.y+c*(d.y-l.y),n<=this.ymin?h=!1:n>=this.ymax?h=!0:a.push(new f(c,this.xmax,n));if(l.y<this.ymin&&d.y>this.ymin||l.y>this.ymin&&d.y<this.ymin)c=(this.ymin-l.y)/(d.y-l.y),n=l.x+c*(d.x-l.x),n<=this.xmin?g=!1:n>=this.xmax?g=!0:a.push(new f(c,n,this.ymin));
if(l.y<this.ymax&&d.y>this.ymax||l.y>this.ymax&&d.y<this.ymax)c=(this.ymax-l.y)/(d.y-l.y),n=l.x+c*(d.x-l.x),n<=this.xmin?g=!1:n>=this.xmax?g=!0:a.push(new f(c,n,this.ymax));if(0===a.length)g?h?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):h?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<a.length&&a[0].ratio>a[1].ratio)this.start=this._dist+e*a[1].ratio,this._lineTo(a[1].x,a[1].y,!0),this._lineTo(a[0].x,a[0].y,!0);else for(this.start=
this._dist+e*a[0].ratio,g=0;g<a.length;g++)this._lineTo(a[g].x,a[g].y,!0)}this._lineTo(d.x,d.y,!1)}this._dist+=e;this._prevIsIn=b;this._prevPt=d};a.prototype.close=function(){if(2<this.line.length){var a=this._firstPt,c=this._prevPt;a.x===c.x&&a.y===c.y||this.lineTo(a.x,a.y);a=this.line;for(c=a.length;4<=c;)if(a[0].x===a[1].x&&a[0].x===a[c-2].x||a[0].y===a[1].y&&a[0].y===a[c-2].y)a.pop(),a[0].x=a[c-2].x,a[0].y=a[c-2].y,--c;else break}};a.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();
if(0===this.lines.length)return null;3===this.type&&a&&n.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};a.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,c=a.length;if(0===c)return null;for(var d=[],e=0;e<c;e++)d.push({line:a[e],start:this.starts[e]||0});return d};a.prototype._isIn=function(a,c){return a>=this.xmin&&a<=this.xmax&&c>=this.ymin&&c<=this.ymax};a.prototype._intersect=function(a,
c){var b,d,e;if(c.x>=this.xmin&&c.x<=this.xmax)d=c.y<=this.ymin?this.ymin:this.ymax,e=(d-a.y)/(c.y-a.y),b=a.x+e*(c.x-a.x);else if(c.y>=this.ymin&&c.y<=this.ymax)b=c.x<=this.xmin?this.xmin:this.xmax,e=(b-a.x)/(c.x-a.x),d=a.y+e*(c.y-a.y);else{d=c.y<=this.ymin?this.ymin:this.ymax;b=c.x<=this.xmin?this.xmin:this.xmax;var f=(b-a.x)/(c.x-a.x),g=(d-a.y)/(c.y-a.y);f<g?(e=f,d=a.y+f*(c.y-a.y)):(e=g,b=a.x+g*(c.x-a.x))}this._r=e;return new k.Point(b,d)};a.prototype._pushLine=function(){this.line&&(1===this.type?
0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};a.prototype._moveTo=function(a,c,d){3!==this.type?d&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line.push(new k.Point(a,c))):(d||(a<
this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line.push(new k.Point(a,c)),this._is_v=this._is_h=!1)};a.prototype._lineTo=function(a,c,d){if(3!==this.type)if(d){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);c=Math.round((c-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(d=this.line[this.line.length-
1],d.equals(a,c)))return;this.line.push(new k.Point(a,c))}else this.line&&0<this.line.length&&this._pushLine();else if(d||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){d=this.line[this.line.length-1];var b=d.x===a,e=d.y===c;b&&e||(this._is_h&&b?(d.x=a,d.y=c,d=this.line[this.line.length-2],
d.x===a&&d.y===c?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(d=this.line[this.line.length-2],this._is_h=d.x===a,this._is_v=d.y===c)):(this._is_h=d.x===a,this._is_v=d.y===c)):this._is_v&&e?(d.x=a,d.y=c,d=this.line[this.line.length-2],d.x===a&&d.y===c?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(d=this.line[this.line.length-2],this._is_h=d.x===a,this._is_v=d.y===c)):(this._is_h=d.x===a,this._is_v=d.y===c)):(this.line.push(new k.Point(a,c)),this._is_h=b,this._is_v=
e))}else this.line.push(new k.Point(a,c))};return a}();a.TileClipper=g;g=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};a.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,c){this.line&&this.lines.push(this.line);this.line=[];var b=this._ratio;this.line.push(new k.Point(Math.round(a*b),Math.round(c*b)))};a.prototype.lineTo=function(a,c){var b=this._ratio;this.line.push(new k.Point(Math.round(a*b),Math.round(c*
b)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;3===this.type&&1!==this._ratio&&n.simplify(4096,64,this.lines);return this.lines};return a}();a.SimpleBuilder=g;var n=function(){function a(){}a.simplify=function(b,c,d){if(d){var e=-c,f=b+c,g=-c,h=b+c;b=[];c=[];for(var k=d.length,l=0;l<k;++l){var n=d[l];if(n&&!(2>n.length))for(var p=n[0],q=void 0,
z=n.length,C=1;C<z;++C)q=n[C],p.x===q.x&&(p.x<=e&&(p.y>q.y?(b.push(l),b.push(C),b.push(0),b.push(-1)):(c.push(l),c.push(C),c.push(0),c.push(-1))),p.x>=f&&(p.y<q.y?(b.push(l),b.push(C),b.push(1),b.push(-1)):(c.push(l),c.push(C),c.push(1),c.push(-1)))),p.y===q.y&&(p.y<=g&&(p.x<q.x?(b.push(l),b.push(C),b.push(2),b.push(-1)):(c.push(l),c.push(C),c.push(2),c.push(-1))),p.y>=h&&(p.x>q.x?(b.push(l),b.push(C),b.push(3),b.push(-1)):(c.push(l),c.push(C),c.push(3),c.push(-1)))),p=q}0!==b.length&&0!==c.length&&
(a.fillParent(d,c,b),a.fillParent(d,b,c),e=[],a.calcDeltas(e,c,b),a.calcDeltas(e,b,c),a.addDeltas(e,d))}};a.fillParent=function(a,c,d){for(var b=d.length,e=c.length,f=0;f<e;f+=4){for(var g=c[f],k=c[f+1],l=c[f+2],n=a[g][k-1],g=a[g][k],k=8092,p=-1,q=0;q<b;q+=4)if(d[q+2]===l){var z=d[q],C=d[q+1],B=a[z][C-1],z=a[z][C];switch(l){case 0:case 1:h.between(n.y,B.y,z.y)&&h.between(g.y,B.y,z.y)&&(B=Math.abs(z.y-B.y),B<k&&(k=B,p=q));break;case 2:case 3:h.between(n.x,B.x,z.x)&&h.between(g.x,B.x,z.x)&&(B=Math.abs(z.x-
B.x),B<k&&(k=B,p=q))}}c[f+3]=p}};a.calcDeltas=function(b,c,d){for(var e=c.length,f=0;f<e;f+=4){var g=a.calcDelta(f,c,d,[]);b.push(c[f]);b.push(c[f+1]);b.push(c[f+2]);b.push(g)}};a.calcDelta=function(b,c,d,e){b=c[b+3];if(-1===b)return 0;var f=e.length;if(1<f&&e[f-2]===b)return 0;e.push(b);return a.calcDelta(b,d,c,e)+1};a.addDeltas=function(a,c){for(var b=a.length,d=0,e=0;e<b;e+=4){var f=a[e+3];f>d&&(d=f)}for(e=0;e<b;e+=4){var g=c[a[e]],h=a[e+1],f=d-a[e+3];switch(a[e+2]){case 0:g[h-1].x-=f;g[h].x-=
f;1===h&&(g[g.length-1].x-=f);h===g.length-1&&(g[0].x-=f);break;case 1:g[h-1].x+=f;g[h].x+=f;1===h&&(g[g.length-1].x+=f);h===g.length-1&&(g[0].x+=f);break;case 2:g[h-1].y-=f;g[h].y-=f;1===h&&(g[g.length-1].y-=f);h===g.length-1&&(g[0].y-=f);break;case 3:g[h-1].y+=f,g[h].y+=f,1===h&&(g[g.length-1].y+=f),h===g.length-1&&(g[0].y+=f)}}};return a}()})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.Point=void 0;
g=function(){function a(a,e){this.x=a;this.y=e}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.equals=function(a,e){return a===this.x&&e===this.y};a.prototype.isEqual=function(a){return a.x===this.x&&a.y===this.y};a.prototype.setCoords=function(a,e){this.x=a;this.y=e};a.prototype.normalize=function(){var a=this.x,e=this.y,a=Math.sqrt(a*a+e*e);this.x/=a;this.y/=a};a.prototype.rightPerpendicular=function(){var a=this.x;this.x=this.y;this.y=-a};a.prototype.move=function(a,e){this.x+=
a;this.y+=e};a.prototype.assign=function(a){this.x=a.x;this.y=a.y};a.prototype.assignAdd=function(a,e){this.x=a.x+e.x;this.y=a.y+e.y};a.prototype.assignSub=function(a,e){this.x=a.x-e.x;this.y=a.y-e.y};a.prototype.rotate=function(a,e){var f=this.x,g=this.y;this.x=f*a-g*e;this.y=f*e+g*a};a.prototype.scale=function(a){this.x*=a;this.y*=a};a.prototype.length=function(){var a=this.x,e=this.y;return Math.sqrt(a*a+e*e)};a.distance=function(a,e){var f=e.x-a.x;a=e.y-a.y;return Math.sqrt(f*f+a*a)};a.add=function(e,
g){return new a(e.x+g.x,e.y+g.y)};a.sub=function(e,g){return new a(e.x-g.x,e.y-g.y)};return a}();a.Point=g})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["require","exports"],function(g,a){function e(a,b,c,e,f,g,h){var k;c=0;for(var m=e,p=f-g;m<f;m+=g)c+=(a[p+b*g]-a[m+b*g])*(a[m+1+b*g]+a[p+1+b*g]),p=m;if(h===0<c)for(h=e;h<f;h+=g)k=n(h+b*g,a[h+b*g],a[h+1+b*g],k);else for(h=f-g;h>=e;h-=g)k=n(h+b*g,a[h+b*g],a[h+1+b*g],k);k&&l(k,k.next)&&(d(k),k=k.next);return k}function k(a,b){void 0===
b&&(b=a);if(!a)return a;var c;do if(c=!1,a.steiner||!l(a,a.next)&&0!==u(a.prev,a,a.next))a=a.next;else{d(a);a=b=a.prev;if(a===a.next)break;c=!0}while(c||a!==b);return b}function h(a,b,c,e,g,n,z,v){if(a){!v&&n&&(a=q(a,e,g,n));for(var w=a;a.prev!==a.next;){var y=a.prev,x=a.next,B;if(n)B=f(a,e,g,n);else a:{B=a;var A=B.prev,C=B,E=B.next;if(0<=u(A,C,E))B=!1;else{for(var F=B.next.next,I=F,G=0;F!==B.prev&&(0===G||F!==I);){G++;if(r(A.x,A.y,C.x,C.y,E.x,E.y,F.x,F.y)&&0<=u(F.prev,F,F.next)){B=!1;break a}F=F.next}B=
!0}}if(B)b.push(y.index/c+z),b.push(a.index/c+z),b.push(x.index/c+z),d(a),w=a=x.next;else if(a=x,a===w){if(!v)h(k(a),b,c,e,g,n,z,1);else if(1===v){v=b;w=c;y=z;x=a;do B=x.prev,A=x.next.next,!l(B,A)&&t(B,x,x.next,A)&&m(B,A)&&m(A,B)&&(v.push(B.index/w+y),v.push(x.index/w+y),v.push(A.index/w+y),d(x),d(x.next),x=a=A),x=x.next;while(x!==a);a=x;h(a,b,c,e,g,n,z,2)}else if(2===v)a:{v=a;do{for(w=v.next.next;w!==v.prev;){if(y=v.index!==w.index){y=v;x=w;B=void 0;if(B=y.next.index!==x.index&&y.prev.index!==x.index){B=
void 0;b:{B=y;do{if(B.index!==y.index&&B.next.index!==y.index&&B.index!==x.index&&B.next.index!==x.index&&t(B,B.next,y,x)){B=!0;break b}B=B.next}while(B!==y);B=!1}B=!B}A=void 0;if(A=B&&m(y,x)&&m(x,y)){B=y;A=!1;C=(y.x+x.x)/2;x=(y.y+x.y)/2;do B.y>x!==B.next.y>x&&B.next.y!==B.y&&C<(B.next.x-B.x)*(x-B.y)/(B.next.y-B.y)+B.x&&(A=!A),B=B.next;while(B!==y)}y=A}if(y){a=p(v,w);v=k(v,v.next);a=k(a,a.next);h(v,b,c,e,g,n,z,0);h(a,b,c,e,g,n,z,0);break a}w=w.next}v=v.next}while(v!==a)}break}}}}function f(a,b,c,
d){var e=a.prev,f=a.next;if(0<=u(e,a,f))return!1;var g=e.x>a.x?e.x>f.x?e.x:f.x:a.x>f.x?a.x:f.x,h=e.y>a.y?e.y>f.y?e.y:f.y:a.y>f.y?a.y:f.y,k=v(e.x<a.x?e.x<f.x?e.x:f.x:a.x<f.x?a.x:f.x,e.y<a.y?e.y<f.y?e.y:f.y:a.y<f.y?a.y:f.y,b,c,d);b=v(g,h,b,c,d);c=a.prevZ;for(d=a.nextZ;c&&c.z>=k&&d&&d.z<=b;){if(c!==a.prev&&c!==a.next&&r(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=u(c.prev,c,c.next))return!1;c=c.prevZ;if(d!==a.prev&&d!==a.next&&r(e.x,e.y,a.x,a.y,f.x,f.y,d.x,d.y)&&0<=u(d.prev,d,d.next))return!1;d=d.nextZ}for(;c&&
c.z>=k;){if(c!==a.prev&&c!==a.next&&r(e.x,e.y,a.x,a.y,f.x,f.y,c.x,c.y)&&0<=u(c.prev,c,c.next))return!1;c=c.prevZ}for(;d&&d.z<=b;){if(d!==a.prev&&d!==a.next&&r(e.x,e.y,a.x,a.y,f.x,f.y,d.x,d.y)&&0<=u(d.prev,d,d.next))return!1;d=d.nextZ}return!0}function n(a,b,c,d){a=y.create(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function d(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function b(a){var b=a,c=
a;do{if(b.x<c.x||b.x===c.x&&b.y<c.y)c=b;b=b.next}while(b!==a);return c}function c(a,b){var c=b,d=a.x,e=a.y,f=-Infinity,g;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var h=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(h<=d&&h>f){f=h;if(h===d){if(e===c.y)return c;if(e===c.next.y)return c.next}g=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!g)return null;if(d===f)return g.prev;b=g;for(var h=g.x,k=g.y,l=Infinity,p,c=g.next;c!==b;)d>=c.x&&c.x>=h&&d!==c.x&&r(e<k?d:f,e,h,k,e<k?f:d,e,c.x,c.y)&&(p=Math.abs(e-
c.y)/(d-c.x),(p<l||p===l&&c.x>g.x)&&m(c,a)&&(g=c,l=p)),c=c.next;return g}function q(a,b,c,d){for(var e=void 0;e!==a;e=e.next){e=e||a;null===e.z&&(e.z=v(e.x,e.y,b,c,d));if(e.prev.next!==e||e.next.prev!==e)return e.prev.next=e,e.next.prev=e,q(a,b,c,d);e.prevZ=e.prev;e.nextZ=e.next}a.prevZ.nextZ=null;a.prevZ=null;a:for(c=1;;){d=a;e=void 0;b=a=null;for(var f=0;d;){f++;for(var e=d,g=0;g<c&&e;g++)e=e.nextZ;for(var h=c;0<g||0<h&&e;){var k=void 0;0===g?(k=e,e=e.nextZ,h--):0!==h&&e?d.z<=e.z?(k=d,d=d.nextZ,
g--):(k=e,e=e.nextZ,h--):(k=d,d=d.nextZ,g--);b?b.nextZ=k:a=k;k.prevZ=b;b=k}d=e}b.nextZ=null;c*=2;if(2>f)break a}return a}function u(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function t(a,b,c,d){return l(a,b)&&l(c,d)||l(a,d)&&l(c,b)?!0:0<u(a,b,c)!==0<u(a,b,d)&&0<u(c,d,a)!==0<u(c,d,b)}function r(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function m(a,b){return 0>u(a.prev,a,a.next)?0<=u(a,b,a.next)&&0<=u(a,a.prev,b):0>u(a,b,a.prev)||
0>u(a,a.next,b)}function v(a,b,c,d,e){a=32767*(a-c)*e;b=32767*(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function l(a,b){return a.x===b.x&&a.y===b.y}function w(a,b){return a.x-b.x}function p(a,b){var c=y.create(a.index,a.x,a.y),d=y.create(b.index,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}Object.defineProperty(a,
"__esModule",{value:!0});a.bufcut=void 0;a.bufcut=function(a,d,f,g,l,m,n){C=0;var r=(g-f)*m,q=l&&l.length,z=q?(l[0]-f)*m:r,v=e(d,f,g,0,z,m,!0);if(v&&v.next!==v.prev){var t,y,u;if(q){for(var q=[],x=0,B=l.length;x<B;x++){var A=e(d,f,g,l[x]*m,x<B-1?l[x+1]*m:g*m,m,!1);A===A.next&&(A.steiner=!0);q.push(b(A))}q.sort(w);for(g=0;g<q.length;g++){l=q[g];x=v;if(x=c(l,x))l=p(x,l),k(l,l.next);v=k(v,v.next)}}if(r>80*m){t=r=d[0+f*m];y=u=d[1+f*m];for(q=m;q<z;q+=m)g=d[q+f*m],l=d[q+1+f*m],t=Math.min(t,g),y=Math.min(y,
l),r=Math.max(r,g),u=Math.max(u,l);u=Math.max(r-t,u-y);u=0!==u?1/u:0}h(v,a,m,t,y,u,n,0)}};var y=function(){function a(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}a.create=function(a,b,c){var d=z[C++];d.index=a;d.x=b;d.y=c;d.prev=null;d.next=null;d.z=null;d.prevZ=null;d.nextZ=null;d.steiner=!1;return d};return a}(),z=[],C=0;for(g=0;8096>g;g++)z.push(new y)})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger",
"../../../../../core/libs/libtess/libtess"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});var h=e.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");g=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new k.GluTesselator;this.glu.gluTessCallback(k.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_END,
this._endcallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(k.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));this.glu.gluTessProperty(k.gluEnum.GLU_TESS_WINDING_RULE,k.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,d){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=
this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=d};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};a.prototype.addVertex=function(a,d){this.glu.gluTessVertex(a,d)};a.prototype._vertexCallback=function(a,d){d[d.length]=a[0];d[d.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=
0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){h.error("Encountered error during tesselation: "+
a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();a.default=g})},"esri/core/libs/libtess/libtess":function(){define([],function(){var g={DEBUG:!1,assert:function(a,e){if(g.DEBUG&&!a)throw Error("Assertion failed"+(e?": "+e:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,
GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,
GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};g.geom.vertEq=function(a,e){return a.s===e.s&&a.t===e.t};g.geom.vertLeq=function(a,e){return a.s<e.s||a.s===e.s&&a.t<=e.t};g.geom.edgeEval=function(a,e,k){g.assert(g.geom.vertLeq(a,e)&&g.geom.vertLeq(e,
k));var h=e.s-a.s,f=k.s-e.s;return 0<h+f?h<f?e.t-a.t+h/(h+f)*(a.t-k.t):e.t-k.t+f/(h+f)*(k.t-a.t):0};g.geom.edgeSign=function(a,e,k){g.assert(g.geom.vertLeq(a,e)&&g.geom.vertLeq(e,k));var h=e.s-a.s,f=k.s-e.s;return 0<h+f?(e.t-k.t)*h+(e.t-a.t)*f:0};g.geom.transLeq=function(a,e){return a.t<e.t||a.t===e.t&&a.s<=e.s};g.geom.transEval=function(a,e,k){g.assert(g.geom.transLeq(a,e)&&g.geom.transLeq(e,k));var h=e.t-a.t,f=k.t-e.t;return 0<h+f?h<f?e.s-a.s+h/(h+f)*(a.s-k.s):e.s-k.s+f/(h+f)*(k.s-a.s):0};g.geom.transSign=
function(a,e,k){g.assert(g.geom.transLeq(a,e)&&g.geom.transLeq(e,k));var h=e.t-a.t,f=k.t-e.t;return 0<h+f?(e.s-k.s)*h+(e.s-a.s)*f:0};g.geom.edgeGoesLeft=function(a){return g.geom.vertLeq(a.dst(),a.org)};g.geom.edgeGoesRight=function(a){return g.geom.vertLeq(a.org,a.dst())};g.geom.vertL1dist=function(a,e){return Math.abs(a.s-e.s)+Math.abs(a.t-e.t)};g.geom.vertCCW=function(a,e,g){return 0<=a.s*(e.t-g.t)+e.s*(g.t-a.t)+g.s*(a.t-e.t)};g.geom.interpolate_=function(a,e,g,h){a=0>a?0:a;g=0>g?0:g;return a<=
g?0===g?(e+h)/2:e+a/(a+g)*(h-e):h+g/(a+g)*(e-h)};g.geom.edgeIntersect=function(a,e,k,h,f){var n,d;g.geom.vertLeq(a,e)||(n=a,a=e,e=n);g.geom.vertLeq(k,h)||(n=k,k=h,h=n);g.geom.vertLeq(a,k)||(n=a,a=k,k=n,n=e,e=h,h=n);g.geom.vertLeq(k,e)?g.geom.vertLeq(e,h)?(n=g.geom.edgeEval(a,k,e),d=g.geom.edgeEval(k,e,h),0>n+d&&(n=-n,d=-d),f.s=g.geom.interpolate_(n,k.s,d,e.s)):(n=g.geom.edgeSign(a,k,e),d=-g.geom.edgeSign(a,h,e),0>n+d&&(n=-n,d=-d),f.s=g.geom.interpolate_(n,k.s,d,h.s)):f.s=(k.s+e.s)/2;g.geom.transLeq(a,
e)||(n=a,a=e,e=n);g.geom.transLeq(k,h)||(n=k,k=h,h=n);g.geom.transLeq(a,k)||(n=a,a=k,k=n,n=e,e=h,h=n);g.geom.transLeq(k,e)?g.geom.transLeq(e,h)?(n=g.geom.transEval(a,k,e),d=g.geom.transEval(k,e,h),0>n+d&&(n=-n,d=-d),f.t=g.geom.interpolate_(n,k.t,d,e.t)):(n=g.geom.transSign(a,k,e),d=-g.geom.transSign(a,h,e),0>n+d&&(n=-n,d=-d),f.t=g.geom.interpolate_(n,k.t,d,h.t)):f.t=(k.t+e.t)/2};g.mesh={};g.mesh.makeEdge=function(a){var e=g.mesh.makeEdgePair_(a.eHead);g.mesh.makeVertex_(e,a.vHead);g.mesh.makeVertex_(e.sym,
a.vHead);g.mesh.makeFace_(e,a.fHead);return e};g.mesh.meshSplice=function(a,e){var k=!1,h=!1;a!==e&&(e.org!==a.org&&(h=!0,g.mesh.killVertex_(e.org,a.org)),e.lFace!==a.lFace&&(k=!0,g.mesh.killFace_(e.lFace,a.lFace)),g.mesh.splice_(e,a),h||(g.mesh.makeVertex_(e,a.org),a.org.anEdge=a),k||(g.mesh.makeFace_(e,a.lFace),a.lFace.anEdge=a))};g.mesh.deleteEdge=function(a){var e=a.sym,k=!1;a.lFace!==a.rFace()&&(k=!0,g.mesh.killFace_(a.lFace,a.rFace()));a.oNext===a?g.mesh.killVertex_(a.org,null):(a.rFace().anEdge=
a.oPrev(),a.org.anEdge=a.oNext,g.mesh.splice_(a,a.oPrev()),k||g.mesh.makeFace_(a,a.lFace));e.oNext===e?(g.mesh.killVertex_(e.org,null),g.mesh.killFace_(e.lFace,null)):(a.lFace.anEdge=e.oPrev(),e.org.anEdge=e.oNext,g.mesh.splice_(e,e.oPrev()));g.mesh.killEdge_(a)};g.mesh.addEdgeVertex=function(a){var e=g.mesh.makeEdgePair_(a),k=e.sym;g.mesh.splice_(e,a.lNext);e.org=a.dst();g.mesh.makeVertex_(k,e.org);e.lFace=k.lFace=a.lFace;return e};g.mesh.splitEdge=function(a){var e=g.mesh.addEdgeVertex(a).sym;g.mesh.splice_(a.sym,
a.sym.oPrev());g.mesh.splice_(a.sym,e);a.sym.org=e.org;e.dst().anEdge=e.sym;e.sym.lFace=a.rFace();e.winding=a.winding;e.sym.winding=a.sym.winding;return e};g.mesh.connect=function(a,e){var k=!1,h=g.mesh.makeEdgePair_(a),f=h.sym;e.lFace!==a.lFace&&(k=!0,g.mesh.killFace_(e.lFace,a.lFace));g.mesh.splice_(h,a.lNext);g.mesh.splice_(f,e);h.org=a.dst();f.org=e.org;h.lFace=f.lFace=a.lFace;a.lFace.anEdge=f;k||g.mesh.makeFace_(h,a.lFace);return h};g.mesh.zapFace=function(a){var e=a.anEdge,k=e.lNext,h;do if(h=
k,k=h.lNext,h.lFace=null,null===h.rFace()){h.oNext===h?g.mesh.killVertex_(h.org,null):(h.org.anEdge=h.oNext,g.mesh.splice_(h,h.oPrev()));var f=h.sym;f.oNext===f?g.mesh.killVertex_(f.org,null):(f.org.anEdge=f.oNext,g.mesh.splice_(f,f.oPrev()));g.mesh.killEdge_(h)}while(h!==e);e=a.prev;a=a.next;a.prev=e;e.next=a};g.mesh.meshUnion=function(a,e){var g=a.fHead,h=a.vHead,f=a.eHead,n=e.fHead,d=e.vHead;e=e.eHead;n.next!==n&&(g.prev.next=n.next,n.next.prev=g.prev,n.prev.next=g,g.prev=n.prev);d.next!==d&&(h.prev.next=
d.next,d.next.prev=h.prev,d.prev.next=h,h.prev=d.prev);e.next!==e&&(f.sym.next.sym.next=e.next,e.next.sym.next=f.sym.next,e.sym.next.sym.next=f,f.sym.next=e.sym.next);return a};g.mesh.deleteMesh=function(a){};g.mesh.makeEdgePair_=function(a){var e=new g.GluHalfEdge,k=new g.GluHalfEdge,h=a.sym.next;k.next=h;h.sym.next=e;e.next=a;a.sym.next=k;e.sym=k;e.oNext=e;e.lNext=k;k.sym=e;k.oNext=k;return k.lNext=e};g.mesh.splice_=function(a,e){var g=a.oNext,h=e.oNext;g.sym.lNext=e;h.sym.lNext=a;a.oNext=h;e.oNext=
g};g.mesh.makeVertex_=function(a,e){var k=e.prev,h=new g.GluVertex(e,k);k.next=h;e.prev=h;e=h.anEdge=a;do e.org=h,e=e.oNext;while(e!==a)};g.mesh.makeFace_=function(a,e){var k=e.prev,h=new g.GluFace(e,k);k.next=h;e.prev=h;h.anEdge=a;h.inside=e.inside;e=a;do e.lFace=h,e=e.lNext;while(e!==a)};g.mesh.killEdge_=function(a){var e=a.next;a=a.sym.next;e.sym.next=a;a.sym.next=e};g.mesh.killVertex_=function(a,e){var g=a.anEdge,h=g;do h.org=e,h=h.oNext;while(h!==g);e=a.prev;a=a.next;a.prev=e;e.next=a};g.mesh.killFace_=
function(a,e){var g=a.anEdge,h=g;do h.lFace=e,h=h.lNext;while(h!==g);e=a.prev;a=a.next;a.prev=e;e.next=a};g.normal={};g.normal.S_UNIT_X_=1;g.normal.S_UNIT_Y_=0;g.normal.projectPolygon=function(a,e,k,h){var f=!1,n=[e,k,h];0===e&&0===k&&0===h&&(g.normal.computeNormal_(a,n),f=!0);k=g.normal.longAxis_(n);e=a.mesh.vHead;if(g.TRUE_PROJECT){g.normal.normalize_(n);h=[0,0,0];var d=[0,0,0];h[k]=0;h[(k+1)%3]=g.normal.S_UNIT_X_;h[(k+2)%3]=g.normal.S_UNIT_Y_;k=g.normal.dot_(h,n);h[0]-=k*n[0];h[1]-=k*n[1];h[2]-=
k*n[2];g.normal.normalize_(h);d[0]=n[1]*h[2]-n[2]*h[1];d[1]=n[2]*h[0]-n[0]*h[2];d[2]=n[0]*h[1]-n[1]*h[0];g.normal.normalize_(d);for(n=e.next;n!==e;n=n.next)n.s=g.normal.dot_(n.coords,h),n.t=g.normal.dot_(n.coords,d)}else for(h=(k+1)%3,d=(k+2)%3,k=0<n[k]?1:-1,n=e.next;n!==e;n=n.next)n.s=n.coords[h],n.t=k*n.coords[d];f&&g.normal.checkOrientation_(a)};g.normal.dot_=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]};g.normal.normalize_=function(a){var e=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];g.assert(0<e);e=
Math.sqrt(e);a[0]/=e;a[1]/=e;a[2]/=e};g.normal.longAxis_=function(a){var e=0;Math.abs(a[1])>Math.abs(a[0])&&(e=1);Math.abs(a[2])>Math.abs(a[e])&&(e=2);return e};g.normal.computeNormal_=function(a,e){var k=[-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD],h=[2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD],f=[],n=[],d;a=a.mesh.vHead;for(d=a.next;d!==a;d=d.next)for(var b=0;3>b;++b){var c=d.coords[b];c<h[b]&&(h[b]=c,n[b]=d);c>k[b]&&(k[b]=c,f[b]=d)}d=0;k[1]-
h[1]>k[0]-h[0]&&(d=1);k[2]-h[2]>k[d]-h[d]&&(d=2);if(h[d]>=k[d])e[0]=0,e[1]=0,e[2]=1;else{k=0;h=n[d];f=f[d];n=[0,0,0];h=[h.coords[0]-f.coords[0],h.coords[1]-f.coords[1],h.coords[2]-f.coords[2]];b=[0,0,0];for(d=a.next;d!==a;d=d.next)b[0]=d.coords[0]-f.coords[0],b[1]=d.coords[1]-f.coords[1],b[2]=d.coords[2]-f.coords[2],n[0]=h[1]*b[2]-h[2]*b[1],n[1]=h[2]*b[0]-h[0]*b[2],n[2]=h[0]*b[1]-h[1]*b[0],c=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],c>k&&(k=c,e[0]=n[0],e[1]=n[1],e[2]=n[2]);0>=k&&(e[0]=e[1]=e[2]=0,e[g.normal.longAxis_(h)]=
1)}};g.normal.checkOrientation_=function(a){for(var e=0,g=a.mesh.fHead,h=g.next;h!==g;h=h.next){var f=h.anEdge;if(!(0>=f.winding)){do e+=(f.org.s-f.dst().s)*(f.org.t+f.dst().t),f=f.lNext;while(f!==h.anEdge)}}if(0>e)for(a=a.mesh.vHead,e=a.next;e!==a;e=e.next)e.t=-e.t};g.render={};g.render.renderMesh=function(a,e,k){for(var h=!1,f=-1,n=e.fHead.prev;n!==e.fHead;n=n.prev)if(n.inside){h||(a.callBeginCallback(g.primitiveType.GL_TRIANGLES),h=!0);var d=n.anEdge;g.assert(d.lNext.lNext.lNext===d,"renderMesh called with non-triangulated mesh");
do{if(k){var b=d.rFace().inside?0:1;f!==b&&(f=b,a.callEdgeFlagCallback(!!f))}a.callVertexCallback(d.org.data);d=d.lNext}while(d!==n.anEdge)}h&&a.callEndCallback()};g.render.renderBoundary=function(a,e){for(var k=e.fHead.next;k!==e.fHead;k=k.next)if(k.inside){a.callBeginCallback(g.primitiveType.GL_LINE_LOOP);var h=k.anEdge;do a.callVertexCallback(h.org.data),h=h.lNext;while(h!==k.anEdge);a.callEndCallback()}};g.sweep={};g.sweep.SENTINEL_COORD_=4*g.GLU_TESS_MAX_COORD;g.sweep.TOLERANCE_NONZERO_=!1;g.sweep.computeInterior=
function(a){a.fatalError=!1;g.sweep.removeDegenerateEdges_(a);g.sweep.initPriorityQ_(a);g.sweep.initEdgeDict_(a);for(var e;null!==(e=a.pq.extractMin());){for(;;){var k=a.pq.minimum();if(null===k||!g.geom.vertEq(k,e))break;k=a.pq.extractMin();g.sweep.spliceMergeVertices_(a,e.anEdge,k.anEdge)}g.sweep.sweepEvent_(a,e)}e=a.dict.getMin().getKey();a.event=e.eUp.org;g.sweep.doneEdgeDict_(a);g.sweep.donePriorityQ_(a);g.sweep.removeDegenerateFaces_(a.mesh);a.mesh.checkMesh()};g.sweep.addWinding_=function(a,
e){a.winding+=e.winding;a.sym.winding+=e.sym.winding};g.sweep.edgeLeq_=function(a,e,k){a=a.event;e=e.eUp;k=k.eUp;if(e.dst()===a)return k.dst()===a?g.geom.vertLeq(e.org,k.org)?0>=g.geom.edgeSign(k.dst(),e.org,k.org):0<=g.geom.edgeSign(e.dst(),k.org,e.org):0>=g.geom.edgeSign(k.dst(),a,k.org);if(k.dst()===a)return 0<=g.geom.edgeSign(e.dst(),a,e.org);e=g.geom.edgeEval(e.dst(),a,e.org);a=g.geom.edgeEval(k.dst(),a,k.org);return e>=a};g.sweep.deleteRegion_=function(a,e){e.fixUpperEdge&&g.assert(0===e.eUp.winding);
e.eUp.activeRegion=null;a.dict.deleteNode(e.nodeUp);e.nodeUp=null};g.sweep.fixUpperEdge_=function(a,e){g.assert(a.fixUpperEdge);g.mesh.deleteEdge(a.eUp);a.fixUpperEdge=!1;a.eUp=e;e.activeRegion=a};g.sweep.topLeftRegion_=function(a){var e=a.eUp.org;do a=a.regionAbove();while(a.eUp.org===e);a.fixUpperEdge&&(e=g.mesh.connect(a.regionBelow().eUp.sym,a.eUp.lNext),g.sweep.fixUpperEdge_(a,e),a=a.regionAbove());return a};g.sweep.topRightRegion_=function(a){var e=a.eUp.dst();do a=a.regionAbove();while(a.eUp.dst()===
e);return a};g.sweep.addRegionBelow_=function(a,e,k){var h=new g.ActiveRegion;h.eUp=k;h.nodeUp=a.dict.insertBefore(e.nodeUp,h);return k.activeRegion=h};g.sweep.isWindingInside_=function(a,e){switch(a.windingRule){case g.windingRule.GLU_TESS_WINDING_ODD:return 0!==(e&1);case g.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==e;case g.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<e;case g.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>e;case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=e||-2>=
e}g.assert(!1);return!1};g.sweep.computeWinding_=function(a,e){e.windingNumber=e.regionAbove().windingNumber+e.eUp.winding;e.inside=g.sweep.isWindingInside_(a,e.windingNumber)};g.sweep.finishRegion_=function(a,e){var k=e.eUp,h=k.lFace;h.inside=e.inside;h.anEdge=k;g.sweep.deleteRegion_(a,e)};g.sweep.finishLeftRegions_=function(a,e,k){var h=e;for(e=e.eUp;h!==k;){h.fixUpperEdge=!1;var f=h.regionBelow(),n=f.eUp;if(n.org!==e.org){if(!f.fixUpperEdge){g.sweep.finishRegion_(a,h);break}n=g.mesh.connect(e.lPrev(),
n.sym);g.sweep.fixUpperEdge_(f,n)}e.oNext!==n&&(g.mesh.meshSplice(n.oPrev(),n),g.mesh.meshSplice(e,n));g.sweep.finishRegion_(a,h);e=f.eUp;h=f}return e};g.sweep.addRightEdges_=function(a,e,k,h,f,n){var d=!0;do g.assert(g.geom.vertLeq(k.org,k.dst())),g.sweep.addRegionBelow_(a,e,k.sym),k=k.oNext;while(k!==h);for(null===f&&(f=e.regionBelow().eUp.rPrev());;){h=e.regionBelow();k=h.eUp.sym;if(k.org!==f.org)break;k.oNext!==f&&(g.mesh.meshSplice(k.oPrev(),k),g.mesh.meshSplice(f.oPrev(),k));h.windingNumber=
e.windingNumber-k.winding;h.inside=g.sweep.isWindingInside_(a,h.windingNumber);e.dirty=!0;!d&&g.sweep.checkForRightSplice_(a,e)&&(g.sweep.addWinding_(k,f),g.sweep.deleteRegion_(a,e),g.mesh.deleteEdge(f));d=!1;e=h;f=k}e.dirty=!0;g.assert(e.windingNumber-k.winding===h.windingNumber);n&&g.sweep.walkDirtyRegions_(a,e)};g.sweep.callCombine_=function(a,e,k,h,f){var n=[e.coords[0],e.coords[1],e.coords[2]];e.data=null;e.data=a.callCombineCallback(n,k,h);null===e.data&&(f?a.fatalError||(a.callErrorCallback(g.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),
a.fatalError=!0):e.data=k[0])};g.sweep.spliceMergeVertices_=function(a,e,k){var h=[null,null,null,null];h[0]=e.org.data;h[1]=k.org.data;g.sweep.callCombine_(a,e.org,h,[.5,.5,0,0],!1);g.mesh.meshSplice(e,k)};g.sweep.vertexWeights_=function(a,e,k,h,f){var n=g.geom.vertL1dist(e,a),d=g.geom.vertL1dist(k,a),b=f+1;h[f]=.5*d/(n+d);h[b]=.5*n/(n+d);a.coords[0]+=h[f]*e.coords[0]+h[b]*k.coords[0];a.coords[1]+=h[f]*e.coords[1]+h[b]*k.coords[1];a.coords[2]+=h[f]*e.coords[2]+h[b]*k.coords[2]};g.sweep.getIntersectData_=
function(a,e,k,h,f,n){var d=[0,0,0,0],b=[k.data,h.data,f.data,n.data];e.coords[0]=e.coords[1]=e.coords[2]=0;g.sweep.vertexWeights_(e,k,h,d,0);g.sweep.vertexWeights_(e,f,n,d,2);g.sweep.callCombine_(a,e,b,d,!0)};g.sweep.checkForRightSplice_=function(a,e){var k=e.regionBelow(),h=e.eUp,f=k.eUp;if(g.geom.vertLeq(h.org,f.org)){if(0<g.geom.edgeSign(f.dst(),h.org,f.org))return!1;g.geom.vertEq(h.org,f.org)?h.org!==f.org&&(a.pq.remove(h.org.pqHandle),g.sweep.spliceMergeVertices_(a,f.oPrev(),h)):(g.mesh.splitEdge(f.sym),
g.mesh.meshSplice(h,f.oPrev()),e.dirty=k.dirty=!0)}else{if(0>g.geom.edgeSign(h.dst(),f.org,h.org))return!1;e.regionAbove().dirty=e.dirty=!0;g.mesh.splitEdge(h.sym);g.mesh.meshSplice(f.oPrev(),h)}return!0};g.sweep.checkForLeftSplice_=function(a,e){var k=e.regionBelow();a=e.eUp;var h=k.eUp;g.assert(!g.geom.vertEq(a.dst(),h.dst()));if(g.geom.vertLeq(a.dst(),h.dst())){if(0>g.geom.edgeSign(a.dst(),h.dst(),a.org))return!1;e.regionAbove().dirty=e.dirty=!0;k=g.mesh.splitEdge(a);g.mesh.meshSplice(h.sym,k);
k.lFace.inside=e.inside}else{if(0<g.geom.edgeSign(h.dst(),a.dst(),h.org))return!1;e.dirty=k.dirty=!0;k=g.mesh.splitEdge(h);g.mesh.meshSplice(a.lNext,h.sym);k.rFace().inside=e.inside}return!0};g.sweep.checkForIntersect_=function(a,e){var k=e.regionBelow(),h=e.eUp,f=k.eUp,n=h.org,d=f.org,b=h.dst(),c=f.dst(),q=new g.GluVertex;g.assert(!g.geom.vertEq(c,b));g.assert(0>=g.geom.edgeSign(b,a.event,n));g.assert(0<=g.geom.edgeSign(c,a.event,d));g.assert(n!==a.event&&d!==a.event);g.assert(!e.fixUpperEdge&&!k.fixUpperEdge);
if(n===d||Math.min(n.t,b.t)>Math.max(d.t,c.t))return!1;if(g.geom.vertLeq(n,d)){if(0<g.geom.edgeSign(c,n,d))return!1}else if(0>g.geom.edgeSign(b,d,n))return!1;g.geom.edgeIntersect(b,n,c,d,q);g.assert(Math.min(n.t,b.t)<=q.t);g.assert(q.t<=Math.max(d.t,c.t));g.assert(Math.min(c.s,b.s)<=q.s);g.assert(q.s<=Math.max(d.s,n.s));g.geom.vertLeq(q,a.event)&&(q.s=a.event.s,q.t=a.event.t);var u=g.geom.vertLeq(n,d)?n:d;g.geom.vertLeq(u,q)&&(q.s=u.s,q.t=u.t);if(g.geom.vertEq(q,n)||g.geom.vertEq(q,d))return g.sweep.checkForRightSplice_(a,
e),!1;if(!g.geom.vertEq(b,a.event)&&0<=g.geom.edgeSign(b,a.event,q)||!g.geom.vertEq(c,a.event)&&0>=g.geom.edgeSign(c,a.event,q)){if(c===a.event)return g.mesh.splitEdge(h.sym),g.mesh.meshSplice(f.sym,h),e=g.sweep.topLeftRegion_(e),h=e.regionBelow().eUp,g.sweep.finishLeftRegions_(a,e.regionBelow(),k),g.sweep.addRightEdges_(a,e,h.oPrev(),h,h,!0),!0;if(b===a.event)return g.mesh.splitEdge(f.sym),g.mesh.meshSplice(h.lNext,f.oPrev()),k=e,e=g.sweep.topRightRegion_(e),n=e.regionBelow().eUp.rPrev(),k.eUp=f.oPrev(),
f=g.sweep.finishLeftRegions_(a,k,null),g.sweep.addRightEdges_(a,e,f.oNext,h.rPrev(),n,!0),!0;0<=g.geom.edgeSign(b,a.event,q)&&(e.regionAbove().dirty=e.dirty=!0,g.mesh.splitEdge(h.sym),h.org.s=a.event.s,h.org.t=a.event.t);0>=g.geom.edgeSign(c,a.event,q)&&(e.dirty=k.dirty=!0,g.mesh.splitEdge(f.sym),f.org.s=a.event.s,f.org.t=a.event.t);return!1}g.mesh.splitEdge(h.sym);g.mesh.splitEdge(f.sym);g.mesh.meshSplice(f.oPrev(),h);h.org.s=q.s;h.org.t=q.t;h.org.pqHandle=a.pq.insert(h.org);g.sweep.getIntersectData_(a,
h.org,n,b,d,c);e.regionAbove().dirty=e.dirty=k.dirty=!0;return!1};g.sweep.walkDirtyRegions_=function(a,e){for(var k=e.regionBelow();;){for(;k.dirty;)e=k,k=k.regionBelow();if(!e.dirty&&(k=e,e=e.regionAbove(),null===e||!e.dirty))break;e.dirty=!1;var h=e.eUp,f=k.eUp;h.dst()!==f.dst()&&g.sweep.checkForLeftSplice_(a,e)&&(k.fixUpperEdge?(g.sweep.deleteRegion_(a,k),g.mesh.deleteEdge(f),k=e.regionBelow(),f=k.eUp):e.fixUpperEdge&&(g.sweep.deleteRegion_(a,e),g.mesh.deleteEdge(h),e=k.regionAbove(),h=e.eUp));
if(h.org!==f.org)if(h.dst()===f.dst()||e.fixUpperEdge||k.fixUpperEdge||h.dst()!==a.event&&f.dst()!==a.event)g.sweep.checkForRightSplice_(a,e);else if(g.sweep.checkForIntersect_(a,e))break;h.org===f.org&&h.dst()===f.dst()&&(g.sweep.addWinding_(f,h),g.sweep.deleteRegion_(a,e),g.mesh.deleteEdge(h),e=k.regionAbove())}};g.sweep.connectRightVertex_=function(a,e,k){var h=k.oNext,f=e.regionBelow(),n=e.eUp,d=f.eUp,b=!1;n.dst()!==d.dst()&&g.sweep.checkForIntersect_(a,e);g.geom.vertEq(n.org,a.event)&&(g.mesh.meshSplice(h.oPrev(),
n),e=g.sweep.topLeftRegion_(e),h=e.regionBelow().eUp,g.sweep.finishLeftRegions_(a,e.regionBelow(),f),b=!0);g.geom.vertEq(d.org,a.event)&&(g.mesh.meshSplice(k,d.oPrev()),k=g.sweep.finishLeftRegions_(a,f,null),b=!0);b?g.sweep.addRightEdges_(a,e,k.oNext,h,h,!0):(h=g.geom.vertLeq(d.org,n.org)?d.oPrev():n,h=g.mesh.connect(k.lPrev(),h),g.sweep.addRightEdges_(a,e,h,h.oNext,h.oNext,!1),h.sym.activeRegion.fixUpperEdge=!0,g.sweep.walkDirtyRegions_(a,e))};g.sweep.connectLeftDegenerate_=function(a,e,k){var h=
e.eUp;if(g.geom.vertEq(h.org,k))g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_&&g.sweep.spliceMergeVertices_(a,h,k.anEdge);else if(g.geom.vertEq(h.dst(),k)){if(g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_){e=g.sweep.topRightRegion_(e);var h=e.regionBelow(),f=h.eUp.sym,n=f.oNext,d=n;h.fixUpperEdge&&(g.assert(n!==f),g.sweep.deleteRegion_(a,h),g.mesh.deleteEdge(f),f=n.oPrev());g.mesh.meshSplice(k.anEdge,f);g.geom.edgeGoesLeft(n)||(n=null);g.sweep.addRightEdges_(a,
e,f.oNext,d,n,!0)}}else g.mesh.splitEdge(h.sym),e.fixUpperEdge&&(g.mesh.deleteEdge(h.oNext),e.fixUpperEdge=!1),g.mesh.meshSplice(k.anEdge,h),g.sweep.sweepEvent_(a,k)};g.sweep.connectLeftVertex_=function(a,e){var k=new g.ActiveRegion;k.eUp=e.anEdge.sym;var k=a.dict.search(k).getKey(),h=k.regionBelow(),f=k.eUp,n=h.eUp;0===g.geom.edgeSign(f.dst(),e,f.org)?g.sweep.connectLeftDegenerate_(a,k,e):(h=g.geom.vertLeq(n.dst(),f.dst())?k:h,k.inside||h.fixUpperEdge?(f=h===k?g.mesh.connect(e.anEdge.sym,f.lNext):
g.mesh.connect(n.dNext(),e.anEdge).sym,h.fixUpperEdge?g.sweep.fixUpperEdge_(h,f):g.sweep.computeWinding_(a,g.sweep.addRegionBelow_(a,k,f)),g.sweep.sweepEvent_(a,e)):g.sweep.addRightEdges_(a,k,e.anEdge,e.anEdge,null,!0))};g.sweep.sweepEvent_=function(a,e){a.event=e;for(var k=e.anEdge;null===k.activeRegion;)if(k=k.oNext,k===e.anEdge){g.sweep.connectLeftVertex_(a,e);return}e=g.sweep.topLeftRegion_(k.activeRegion);var h=e.regionBelow(),k=h.eUp,h=g.sweep.finishLeftRegions_(a,h,null);h.oNext===k?g.sweep.connectRightVertex_(a,
e,h):g.sweep.addRightEdges_(a,e,h.oNext,k,k,!0)};g.sweep.addSentinel_=function(a,e){var k=new g.ActiveRegion,h=g.mesh.makeEdge(a.mesh);h.org.s=g.sweep.SENTINEL_COORD_;h.org.t=e;h.dst().s=-g.sweep.SENTINEL_COORD_;h.dst().t=e;a.event=h.dst();k.eUp=h;k.windingNumber=0;k.inside=!1;k.fixUpperEdge=!1;k.sentinel=!0;k.dirty=!1;k.nodeUp=a.dict.insert(k)};g.sweep.initEdgeDict_=function(a){a.dict=new g.Dict(a,g.sweep.edgeLeq_);g.sweep.addSentinel_(a,-g.sweep.SENTINEL_COORD_);g.sweep.addSentinel_(a,g.sweep.SENTINEL_COORD_)};
g.sweep.doneEdgeDict_=function(a){for(var e=0,k;null!==(k=a.dict.getMin().getKey());)k.sentinel||(g.assert(k.fixUpperEdge),g.assert(1===++e)),g.assert(0===k.windingNumber),g.sweep.deleteRegion_(a,k);a.dict=null};g.sweep.removeDegenerateEdges_=function(a){for(var e=a.mesh.eHead,k,h=e.next;h!==e;h=k){k=h.next;var f=h.lNext;g.geom.vertEq(h.org,h.dst())&&h.lNext.lNext!==h&&(g.sweep.spliceMergeVertices_(a,f,h),g.mesh.deleteEdge(h),h=f,f=h.lNext);if(f.lNext===h){if(f!==h){if(f===k||f===k.sym)k=k.next;g.mesh.deleteEdge(f)}if(h===
k||h===k.sym)k=k.next;g.mesh.deleteEdge(h)}}};g.sweep.initPriorityQ_=function(a){var e=new g.PriorityQ;a.pq=e;a=a.mesh.vHead;var k;for(k=a.next;k!==a;k=k.next)k.pqHandle=e.insert(k);e.init()};g.sweep.donePriorityQ_=function(a){a.pq.deleteQ();a.pq=null};g.sweep.removeDegenerateFaces_=function(a){for(var e,k=a.fHead.next;k!==a.fHead;k=e)e=k.next,k=k.anEdge,g.assert(k.lNext!==k),k.lNext.lNext===k&&(g.sweep.addWinding_(k.oNext,k),g.mesh.deleteEdge(k))};g.tessmono={};g.tessmono.tessellateMonoRegion_=function(a){a=
a.anEdge;for(g.assert(a.lNext!==a&&a.lNext.lNext!==a);g.geom.vertLeq(a.dst(),a.org);a=a.lPrev());for(;g.geom.vertLeq(a.org,a.dst());a=a.lNext);for(var e=a.lPrev(),k;a.lNext!==e;)if(g.geom.vertLeq(a.dst(),e.org)){for(;e.lNext!==a&&(g.geom.edgeGoesLeft(e.lNext)||0>=g.geom.edgeSign(e.org,e.dst(),e.lNext.dst()));)k=g.mesh.connect(e.lNext,e),e=k.sym;e=e.lPrev()}else{for(;e.lNext!==a&&(g.geom.edgeGoesRight(a.lPrev())||0<=g.geom.edgeSign(a.dst(),a.org,a.lPrev().org));)k=g.mesh.connect(a,a.lPrev()),a=k.sym;
a=a.lNext}for(g.assert(e.lNext!==a);e.lNext.lNext!==a;)k=g.mesh.connect(e.lNext,e),e=k.sym};g.tessmono.tessellateInterior=function(a){for(var e,k=a.fHead.next;k!==a.fHead;k=e)e=k.next,k.inside&&g.tessmono.tessellateMonoRegion_(k)};g.tessmono.discardExterior=function(a){for(var e,k=a.fHead.next;k!==a.fHead;k=e)e=k.next,k.inside||g.mesh.zapFace(k)};g.tessmono.setWindingNumber=function(a,e,k){for(var h,f=a.eHead.next;f!==a.eHead;f=h)h=f.next,f.rFace().inside!==f.lFace.inside?f.winding=f.lFace.inside?
e:-e:k?g.mesh.deleteEdge(f):f.winding=0};g.Dict=function(a,e){this.head_=new g.DictNode;this.frame_=a;this.leq_=e};g.Dict.prototype.deleteDict_=function(){};g.Dict.prototype.insertBefore=function(a,e){do a=a.prev;while(null!==a.key&&!this.leq_(this.frame_,a.key,e));e=new g.DictNode(e,a.next,a);a.next.prev=e;return a.next=e};g.Dict.prototype.insert=function(a){return this.insertBefore(this.head_,a)};g.Dict.prototype.deleteNode=function(a){a.next.prev=a.prev;a.prev.next=a.next};g.Dict.prototype.search=
function(a){var e=this.head_;do e=e.next;while(null!==e.key&&!this.leq_(this.frame_,a,e.key));return e};g.Dict.prototype.getMin=function(){return this.head_.next};g.Dict.prototype.getMax=function(){return this.head_.prev};g.DictNode=function(a,e,g){this.key=a||null;this.next=e||this;this.prev=g||this};g.DictNode.prototype.getKey=function(){return this.key};g.DictNode.prototype.getSuccessor=function(){return this.next};g.DictNode.prototype.getPredecessor=function(){return this.prev};g.GluTesselator=
function(){this.state_=g.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=g.windingRule.GLU_TESS_WINDING_ODD;this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};g.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};g.GluTesselator.prototype.gluDeleteTess=
function(){this.requireState_(g.GluTesselator.tessState_.T_DORMANT)};g.GluTesselator.prototype.gluTessProperty=function(a,e){switch(a){case g.gluEnum.GLU_TESS_TOLERANCE:return;case g.gluEnum.GLU_TESS_WINDING_RULE:switch(e){case g.windingRule.GLU_TESS_WINDING_ODD:case g.windingRule.GLU_TESS_WINDING_NONZERO:case g.windingRule.GLU_TESS_WINDING_POSITIVE:case g.windingRule.GLU_TESS_WINDING_NEGATIVE:case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=e;return}break;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=
!!e;return;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(g.gluEnum.GLU_INVALID_VALUE)};g.GluTesselator.prototype.gluGetTessProperty=function(a){switch(a){case g.gluEnum.GLU_TESS_TOLERANCE:return 0;case g.gluEnum.GLU_TESS_WINDING_RULE:return a=this.windingRule,g.assert(a===g.windingRule.GLU_TESS_WINDING_ODD||a===g.windingRule.GLU_TESS_WINDING_NONZERO||a===g.windingRule.GLU_TESS_WINDING_POSITIVE||a===g.windingRule.GLU_TESS_WINDING_NEGATIVE||a===g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),
a;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:return g.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}return!1};g.GluTesselator.prototype.gluTessNormal=function(a,e,g){this.normal_[0]=a;this.normal_[1]=e;this.normal_[2]=g};g.GluTesselator.prototype.gluTessCallback=function(a,e){e=e?e:null;switch(a){case g.gluEnum.GLU_TESS_BEGIN:case g.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=e;break;case g.gluEnum.GLU_TESS_EDGE_FLAG:case g.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=
e;break;case g.gluEnum.GLU_TESS_VERTEX:case g.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=e;break;case g.gluEnum.GLU_TESS_END:case g.gluEnum.GLU_TESS_END_DATA:this.endCallback_=e;break;case g.gluEnum.GLU_TESS_ERROR:case g.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=e;break;case g.gluEnum.GLU_TESS_COMBINE:case g.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=e;break;case g.gluEnum.GLU_TESS_MESH:this.meshCallback_=e;break;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}};g.GluTesselator.prototype.gluTessVertex=
function(a,e){var k=!1,h=[0,0,0];this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);for(var f=0;3>f;++f){var n=a[f];n<-g.GLU_TESS_MAX_COORD&&(n=-g.GLU_TESS_MAX_COORD,k=!0);n>g.GLU_TESS_MAX_COORD&&(n=g.GLU_TESS_MAX_COORD,k=!0);h[f]=n}k&&this.callErrorCallback(g.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(h,e)};g.GluTesselator.prototype.gluTessBeginPolygon=function(a){this.requireState_(g.GluTesselator.tessState_.T_DORMANT);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=
new g.GluMesh;this.polygonData_=a};g.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);this.state_=g.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};g.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON};g.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=g.GluTesselator.tessState_.T_DORMANT;g.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);g.sweep.computeInterior(this);if(!this.fatalError){var a=this.mesh;this.boundaryOnly_?g.tessmono.setWindingNumber(a,1,!0):g.tessmono.tessellateInterior(a);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?g.render.renderBoundary(this,this.mesh):g.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);
if(this.meshCallback_){g.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}g.mesh.deleteMesh(this.mesh);this.mesh=this.polygonData_=null};g.GluTesselator.prototype.requireState_=function(a){this.state_!==a&&this.gotoState_(a)};g.GluTesselator.prototype.gotoState_=function(a){for(;this.state_!==a;)if(this.state_<a)switch(this.state_){case g.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);
this.gluTessBeginPolygon(null);break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case g.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_CONTOUR);this.gluTessEndContour();break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};g.GluTesselator.prototype.addVertex_=
function(a,e){var k=this.lastEdge_;null===k?(k=g.mesh.makeEdge(this.mesh),g.mesh.meshSplice(k,k.sym)):(g.mesh.splitEdge(k),k=k.lNext);k.org.data=e;k.org.coords[0]=a[0];k.org.coords[1]=a[1];k.org.coords[2]=a[2];k.winding=1;k.sym.winding=-1;this.lastEdge_=k};g.GluTesselator.prototype.callBeginCallback=function(a){this.beginCallback_&&this.beginCallback_(a,this.polygonData_)};g.GluTesselator.prototype.callVertexCallback=function(a){this.vertexCallback_&&this.vertexCallback_(a,this.polygonData_)};g.GluTesselator.prototype.callEdgeFlagCallback=
function(a){this.edgeFlagCallback_&&this.edgeFlagCallback_(a,this.polygonData_)};g.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};g.GluTesselator.prototype.callCombineCallback=function(a,e,g){return this.combineCallback_?this.combineCallback_(a,e,g,this.polygonData_)||null:null};g.GluTesselator.prototype.callErrorCallback=function(a){this.errorCallback_&&this.errorCallback_(a,this.polygonData_)};g.GluFace=function(a,e){this.next=a||this;
this.prev=e||this;this.anEdge=null;this.inside=!1};g.GluHalfEdge=function(a){this.next=a||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};g.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};g.GluHalfEdge.prototype.dst=function(){return this.sym.org};g.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};g.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};g.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};
g.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};g.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};g.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};g.GluMesh=function(){this.vHead=new g.GluVertex;this.fHead=new g.GluFace;this.eHead=new g.GluHalfEdge;this.eHeadSym=new g.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};g.GluMesh.prototype.checkMesh=function(){if(g.DEBUG){var a=this.fHead,e=this.vHead,k=this.eHead,h,f;for(h=h=a;(f=
h.next)!==a;h=f){g.assert(f.prev===h);h=f.anEdge;do g.assert(h.sym!==h),g.assert(h.sym.sym===h),g.assert(h.lNext.oNext.sym===h),g.assert(h.oNext.sym.lNext===h),g.assert(h.lFace===f),h=h.lNext;while(h!==f.anEdge)}g.assert(f.prev===h&&null===f.anEdge);for(h=h=e;(a=h.next)!==e;h=a){g.assert(a.prev===h);h=a.anEdge;do g.assert(h.sym!==h),g.assert(h.sym.sym===h),g.assert(h.lNext.oNext.sym===h),g.assert(h.oNext.sym.lNext===h),g.assert(h.org===a),h=h.oNext;while(h!==a.anEdge)}g.assert(a.prev===h&&null===
a.anEdge&&null===a.data);for(e=e=k;(h=e.next)!==k;e=h)g.assert(h.sym.next===e.sym),g.assert(h.sym!==h),g.assert(h.sym.sym===h),g.assert(null!==h.org),g.assert(null!==h.dst()),g.assert(h.lNext.oNext.sym===h),g.assert(h.oNext.sym.lNext===h);g.assert(h.sym.next===e.sym&&h.sym===this.eHeadSym&&h.sym.sym===h&&null===h.org&&null===h.dst()&&null===h.lFace&&null===h.rFace())}};g.GluVertex=function(a,e){this.next=a||this;this.prev=e||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=
this.s=0};g.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new g.PriorityQHeap};g.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};g.PriorityQ.prototype.init=function(){this.order_=[];for(var a=0;a<this.size_;a++)this.order_[a]=a;a=function(a){return function(e,f){return g.geom.vertLeq(a[e],a[f])?1:-1}}(this.verts_);this.order_.sort(a);this.initialized_=!0;this.heap_.init();if(g.DEBUG)for(var e=0+this.size_-1,a=0;a<
e;++a)g.assert(g.geom.vertLeq(this.verts_[this.order_[a+1]],this.verts_[this.order_[a]]))};g.PriorityQ.prototype.insert=function(a){if(this.initialized_)return this.heap_.insert(a);var e=this.size_++;this.verts_[e]=a;return-(e+1)};g.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(g.geom.vertLeq(e,a))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&
null===this.verts_[this.order_[this.size_-1]]);return a};g.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(g.geom.vertLeq(e,a))return e}return a};g.PriorityQ.prototype.remove=function(a){if(0<=a)this.heap_.remove(a);else for(a=-(a+1),g.assert(a<this.verts_.length&&null!==this.verts_[a]),this.verts_[a]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-
1]];)--this.size_};g.PriorityQHeap=function(){this.heap_=g.PriorityQHeap.reallocNumeric_([0],g.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=g.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};g.PriorityQHeap.INIT_SIZE_=32;g.PriorityQHeap.reallocNumeric_=function(a,e){for(var g=Array(e),h=0;h<a.length;h++)g[h]=a[h];for(;h<e;h++)g[h]=0;return g};g.PriorityQHeap.prototype.init=function(){for(var a=this.size_;1<=a;--a)this.floatDown_(a);
this.initialized_=!0};g.PriorityQHeap.prototype.insert=function(a){var e=++this.size_;2*e>this.max_&&(this.max_*=2,this.handles_=g.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var k;0===this.freeList_?k=e:(k=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[k]=a;this.handles_[k]=e;this.heap_[e]=k;this.initialized_&&this.floatUp_(e);return k};g.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};g.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};
g.PriorityQHeap.prototype.extractMin=function(){var a=this.heap_,e=this.verts_,g=this.handles_,h=a[1],f=e[h];0<this.size_&&(a[1]=a[this.size_],g[a[1]]=1,e[h]=null,g[h]=this.freeList_,this.freeList_=h,0<--this.size_&&this.floatDown_(1));return f};g.PriorityQHeap.prototype.remove=function(a){var e=this.heap_,k=this.verts_,h=this.handles_;g.assert(1<=a&&a<=this.max_&&null!==k[a]);var f=h[a];e[f]=e[this.size_];h[e[f]]=f;f<=--this.size_&&(1>=f?this.floatDown_(f):g.geom.vertLeq(k[e[f>>1]],k[e[f]])?this.floatDown_(f):
this.floatUp_(f));k[a]=null;h[a]=this.freeList_;this.freeList_=a};g.PriorityQHeap.prototype.floatDown_=function(a){for(var e=this.heap_,k=this.verts_,h=this.handles_,f=e[a];;){var n=a<<1;n<this.size_&&g.geom.vertLeq(k[e[n+1]],k[e[n]])&&(n+=1);g.assert(n<=this.max_);var d=e[n];if(n>this.size_||g.geom.vertLeq(k[f],k[d])){e[a]=f;h[f]=a;break}e[a]=d;h[d]=a;a=n}};g.PriorityQHeap.prototype.floatUp_=function(a){for(var e=this.heap_,k=this.verts_,h=this.handles_,f=e[a];;){var n=a>>1,d=e[n];if(0===n||g.geom.vertLeq(k[d],
k[f])){e[a]=f;h[f]=a;break}e[a]=d;h[d]=a;a=n}};g.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};g.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};g.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),
function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});var d=k.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");g=function(a){function b(b){var c=a.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=b;return c}e.__extends(b,a);b.prototype.analyze=function(a,b,c,e){var g=this;b=b.readLegacyFeature();var k=this._materialCache,l=this._cimLayer.materialHash;if(!l)return d.error("A Dynamic mesh template must have a material hash value or function!"),
h.reject(null);var n="function"===typeof l?l(b,c,e):l;if(k.has(n))return a=k.get(n),h.resolve(a);if(this._ongoingMaterialRequestMap.has(n))return this._ongoingMaterialRequestMap.get(n);c=f.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);c.mosaicHash=n;a=a.getMosaicItem(c).then(function(a){g._ongoingMaterialRequestMap.delete(n);k.set(n,a);return a}).catch(function(a){g._ongoingMaterialRequestMap.delete(n);d.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(n,
a);return a};return b}(n.default);a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(g,a,e,k,h,f,n,d,b,c,q,u){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(c){var d=a.call(this,c)||this;d._cimLineLayer=
c;var e=0;b.isFunction(c.width)||(e=.5*k.pt2px(c.width));d._dynamicPropertyMap.set("_halfWidth",function(a,d,f){return b.isFunction(c.width)?.5*k.pt2px(c.width(a,d,f)):e});b.isFunction(c.cap)?d._dynamicPropertyMap.set("_capType",c.cap):d._capType=c.cap;b.isFunction(c.join)?d._dynamicPropertyMap.set("_joinType",c.join):d._joinType=c.join;if(b.isFunction(c.color))d._dynamicPropertyMap.set("_fillColor",function(a,b,d){return(a=c.color(a,b,d))&&h.premultiplyAlphaRGBA(a)||0});else{var f=c.color;d._fillColor=
f&&h.premultiplyAlphaRGBA(f)||0}b.isFunction(c.miterLimit)?d._dynamicPropertyMap.set("_miterLimitCosine",function(a,d,e){return b.getLimitCosine(c.miterLimit(a,d,e))}):d._miterLimitCosine=b.getLimitCosine(c.miterLimit);d._scaleFactor=c.scaleFactor||1;d._isDashed=c.isDashed;d.effects=c.effects;d.tessellationProperties._bitset=c.colorLocked?1:0;d._materialKey=c.materialKey;d._initializeTessellator(!0);return d}e.__extends(c,a);c.fromCIMLine=function(a){return new c(a)};c.prototype.bindFeature=function(a,
b,c){var e=this,g=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,d){e[d]=a(g,b,c)});this._halfWidth*=this._scaleFactor;a=this._materialCache;var h=this._cimLineLayer.materialHash,h=h(g,b,c),h=a.get(h);a=null;h&&u.ok(h.spriteMosaicItem)&&(a=h.spriteMosaicItem);if(a){this._hasPattern=!0;var k=a.rect,h=k.x+f.SPRITE_PADDING,k=k.y+f.SPRITE_PADDING,l=h+a.width,m=k+a.height;this.tessellationProperties._tl=n.i1616to32(h,k);this.tessellationProperties._br=n.i1616to32(l,m)}else this._hasPattern=
!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;h=d.LineMaterialKey.load(this._materialKey);a&&(h.sdf=a.sdf,h.pattern=!0,h.textureBinding=a.textureBinding);this._materialKey=h.data};return c}(c.default(q.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports tslib ../../../../../../core/has ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../materialKey/MaterialKey".split(" "),
function(g,a,e,k,h,f,n,d,b,c){Object.defineProperty(a,"__esModule",{value:!0});var q=h.TILE_SIZE+16,u=1/3.8,t=new d.TileClipper(0,0,0,1,16);t.setExtent(h.TILE_SIZE);var r=new Uint32Array(9),m=new Uint32Array(36),v=new Uint32Array(3),l=new Uint32Array(6),w=function(a){return function(b){var c=Math.ceil(1024*a._halfWidth),d=Math.ceil(1024*a._halfReferenceWidth);b.entry0=a.offset+a.vertexCount++;var e=n.i1616to32(b.distance,c),f=n.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),
Math.round(0),Math.round(-31)),g=n.i8888to32(0,0,0,a._bitset);m[0]=n.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);m[1]=a.id;m[2]=a._fillColor;m[3]=f;m[4]=e;m[5]=a._tl;m[6]=a._br;m[7]=g;m[8]=n.i1616to32(d,0);b.entry2=a.offset+a.vertexCount++;e=n.i1616to32(b.distance,c);f=n.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));g=n.i8888to32(0,0,0,a._bitset);m[9]=n.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);m[10]=a.id;m[11]=a._fillColor;m[12]=
f;m[13]=e;m[14]=a._tl;m[15]=a._br;m[16]=g;m[17]=n.i1616to32(d,0);b.exit0=a.offset+a.vertexCount++;e=n.i1616to32(b.distance,c);f=n.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));g=n.i8888to32(0,0,0,a._bitset);m[18]=n.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);m[19]=a.id;m[20]=a._fillColor;m[21]=f;m[22]=e;m[23]=a._tl;m[24]=a._br;m[25]=g;m[26]=n.i1616to32(d,0);b.exit2=a.offset+a.vertexCount++;e=n.i1616to32(b.distance,c);f=n.i8888to32(Math.round(31*
-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));g=n.i8888to32(0,0,0,a._bitset);m[27]=n.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);m[28]=a.id;m[29]=a._fillColor;m[30]=f;m[31]=e;m[32]=a._tl;m[33]=a._br;m[34]=g;m[35]=n.i1616to32(d,0);a.geometryBuf.writeRegion(m)}},p=function(a){return function(b){l[0]=b.leftExit0;l[1]=b.rightEntry0;l[2]=b.leftExit2;l[3]=b.rightEntry0;l[4]=b.rightEntry2;l[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(l)}},y=function(a){return function(b,
c,d,e,f,g,h,k,l){l=n.i1616to32(l,Math.ceil(1024*a._halfWidth));f=n.i8888to32(Math.round(31*f),Math.round(31*g),Math.round(31*h),Math.round(31*k));d=n.i8888to32(31*d,31*e,0,a._bitset);r[0]=n.i1616to32(8*b,8*c);r[1]=a.id;r[2]=a._fillColor;r[3]=f;r[4]=l;r[5]=a._tl;r[6]=a._br;r[7]=d;r[8]=n.i1616to32(Math.ceil(1024*a._halfReferenceWidth),0);a.geometryBuf.writeRegion(r);return a.offset+a.vertexCount++}},z=function(a){return function(b,c,d){v[0]=b;v[1]=c;v[2]=d;a.indexCount+=3;a.indexBuf.writeRegion(v)}};
a.default=function(a){return function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};b._tessellationOptions={};b.geometryType=f.WGLGeometryType.LINE;return b}e.__extends(d,a);d.prototype.writeMeshWithGeometry=function(a,b,c,d,e,f){var g=b.indexVector,
h=b.get("geometry");b=b.getVector("geometry").vertexCount;var k=g.length;if(c=null!==f&&void 0!==f?f:c.readLegacyGeometry()){switch(d){case "esriGeometryPolyline":d=this._clipLines(c.paths);if(0===d.length)return;this._write(g,h,b,e,d);break;case "esriGeometryPolygon":d=this._clipLines(c.rings);if(0===d.length)return;this._write(g,h,b,e,d)}a.writeDisplayRecord(this.geometryType,this._materialKey,b,this.tessellationProperties.vertexCount,k,this.tessellationProperties.indexCount)}};d.prototype._clipLines=
function(a){for(var b=[],c=!1,d=0;d<a.length;){var e=[],f=a[d];t.reset(2);var g=f[0],h=g[0],g=g[1];if(c)t.moveTo(h,g);else{if(-16>h||h>q||-16>g||g>q){c=!0;continue}e.push({x:h,y:g})}for(var k=!1,l=f.length,m=1;m<l;++m)if(h+=f[m][0],g+=f[m][1],c)t.lineTo(h,g);else{if(-16>h||h>q||-16>g||g>q){k=!0;break}e.push({x:h,y:g})}if(k)c=!0;else{if(c){if(e=t.resultWithStarts())for(c=0;c<e.length;c++)b.push(e[c])}else b.push({line:e,start:0});d++;c=!1}}return b};d.prototype._write=function(a,c,d,e,f){this.tessellationProperties.id=
e;this.tessellationProperties.indexBuf=a;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=c;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=d;for(a=0;a<f.length;a++)c=f[a],d=c.line,2>d.length||(this._tessellationOptions.initialDistance=c.start%65535,this._tessellationCallbacks instanceof b.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),b.tessellate(d,
this._tessellationOptions,this._tessellationCallbacks),b.cleanup())};d.prototype._initializeTessellator=function(a){var d=c.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!a&&this.tessellationProperties._halfWidth<h.THIN_LINE_THRESHOLD/2&&!(d.vvSizeFieldStops||d.vvSizeMinMaxValue||d.vvSizeScaleStops||d.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=
u;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=u;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:w(this.tessellationProperties),bridge:p(this.tessellationProperties)}:(a=new b.StandardTessellationCallbacks(y(this.tessellationProperties),z(this.tessellationProperties)),a.miterLimitCosine=this._miterLimitCosine,
a.textured=this._isDashed||this._hasPattern,a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a)};return d}(a)}})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["require","exports","./mesh/templates/util"],function(g,a,e){function k(){if(p.cosine<q.innerBisectorAutoSplitThreshold){p.splitInner=!0;p.gapInner=!0;var a=Math.max(q.innerBisectorAutoSplitThreshold,p.cosine),a=Math.sqrt(1-a*a)/a;p.leftInner.x=p.nextNormal.x+p.sign*a*p.outbound.x;p.leftInner.y=p.nextNormal.y+p.sign*
a*p.outbound.y;p.rightInner.x=p.prevNormal.x-p.sign*a*p.inbound.x;p.rightInner.y=p.prevNormal.y-p.sign*a*p.inbound.y}else q.enableInnerBisectorSplit&&(p.splitInner=!0,p.gapInner=!1,p.leftInner.x=p.rightInner.x=p.bisector.x/p.cosine,p.leftInner.y=p.rightInner.y=p.bisector.y/p.cosine);p.cosine<q.outerBisectorAutoSplitThreshold?(p.splitOuter=!0,p.gapOuter=!0,a=Math.max(q.outerBisectorAutoSplitThreshold,p.cosine),a=Math.sqrt(1-a*a)/a,p.leftOuter.x=p.prevNormal.x-p.sign*a*p.inbound.x,p.leftOuter.y=p.prevNormal.y-
p.sign*a*p.inbound.y,p.rightOuter.x=p.nextNormal.x+p.sign*a*p.outbound.x,p.rightOuter.y=p.nextNormal.y+p.sign*a*p.outbound.y):q.enableOuterBisectorSplit&&(p.splitOuter=!0,p.gapOuter=!1,p.leftOuter.x=p.rightOuter.x=p.bisector.x/p.cosine,p.leftOuter.y=p.rightOuter.y=p.bisector.y/p.cosine)}function h(){if(v)p.distance=0,v=p.isCap=p.isFirstVertex=p.isLastVertex=!1;else{if(0===r)if(p.isFirstVertex=0===t,w=c[t],0===t){if(r=0,p.closed){p.inbound.x=w.x-c[c.length-2].x;p.inbound.y=w.y-c[c.length-2].y;var a=
Math.sqrt(p.inbound.x*p.inbound.x+p.inbound.y*p.inbound.y);p.inbound.x/=a;p.inbound.y/=a}}else p.inbound.x=w.x-l.x,p.inbound.y=w.y-l.y,r=Math.sqrt(p.inbound.x*p.inbound.x+p.inbound.y*p.inbound.y),p.inbound.x/=r,p.inbound.y/=r;p.distance+r-m<=q.wrapDistance?(t<c.length-1?(p.outbound.x=c[t+1].x-w.x,p.outbound.y=c[t+1].y-w.y,a=Math.sqrt(p.outbound.x*p.outbound.x+p.outbound.y*p.outbound.y),p.outbound.x/=a,p.outbound.y/=a):p.closed?(p.outbound.x=c[1].x-w.x,p.outbound.y=c[1].y-w.y,a=Math.sqrt(p.outbound.x*
p.outbound.x+p.outbound.y*p.outbound.y),p.outbound.x/=a,p.outbound.y/=a):(p.outbound.x=p.inbound.x,p.outbound.y=p.inbound.y),0!==t||p.closed||(p.inbound.x=p.outbound.x,p.inbound.y=p.outbound.y),++t,p.isLastVertex=t===c.length,p.isCap=!p.closed&&(p.isFirstVertex||p.isLastVertex),p.distance+=r-m,m=r=0,v=p.distance+r-m===q.wrapDistance,p.currentVertex.x=w.x,p.currentVertex.y=w.y,l=w,w=null):(p.outbound.x=p.inbound.x,p.outbound.y=p.inbound.y,m+=q.wrapDistance-p.distance,p.distance=q.wrapDistance,v=!0,
a=m/r,p.currentVertex.x=(1-a)*l.x+a*w.x,p.currentVertex.y=(1-a)*l.y+a*w.y)}}function f(){p.prevNormal.x=-p.inbound.y;p.prevNormal.y=p.inbound.x;p.nextNormal.x=-p.outbound.y;p.nextNormal.y=p.outbound.x}function n(){f();p.bisector.x=p.prevNormal.x+p.nextNormal.x;p.bisector.y=p.prevNormal.y+p.nextNormal.y;var a=Math.sqrt(p.bisector.x*p.bisector.x+p.bisector.y*p.bisector.y);.001>a?(p.bisector.x=void 0,p.bisector.y=void 0,p.cosine=0,p.sign=void 0):(p.bisector.x/=a,p.bisector.y/=a,p.cosine=p.bisector.x*
p.nextNormal.x+p.bisector.y*p.nextNormal.y,p.sign=0<=p.prevNormal.x*p.nextNormal.y-p.prevNormal.y*p.nextNormal.x?1:-1)}function d(a){u.vertex(p);1===a?(p.leftEntry0=p.entry0,p.leftEntry1=p.entry1,p.leftEntry2=p.entry2,p.leftExit0=p.exit0,p.leftExit1=p.exit1,p.leftExit2=p.exit2):2===a&&(p.rightEntry0=p.entry0,p.rightEntry1=p.entry1,p.rightEntry2=p.entry2,p.rightExit0=p.exit0,p.rightExit1=p.exit1,p.rightExit2=p.exit2)}function b(a){u.vertex(p);1===a?(p.leftEntry0=p.entry0,p.leftEntry2=p.entry2,p.leftExit0=
p.exit0,p.leftExit2=p.exit2):2===a&&(p.rightEntry0=p.entry0,p.rightEntry2=p.entry2,p.rightExit0=p.exit0,p.rightExit2=p.exit2)}Object.defineProperty(a,"__esModule",{value:!0});a.ThinTessellationCallbacks=a.StandardTessellationCallbacks=a.splitVertex=a.cleanup=a.tessellate=a.TessellationState=void 0;g=function(){return function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};
this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}}}();a.TessellationState=g;a.tessellate=function(a,e,g){q.trackDistance=null!=e.trackDistance?e.trackDistance:!1;q.wrapDistance=null!=e.wrapDistance?e.wrapDistance:65535;q.thin=null!=e.thin?e.thin:!1;q.initialDistance=null!=e.initialDistance?e.initialDistance:
0;q.enableOuterBisectorSplit=null!=e.enableOuterBisectorSplit?e.enableOuterBisectorSplit:!1;q.outerBisectorAutoSplitThreshold=null!=e.outerBisectorAutoSplitThreshold?e.outerBisectorAutoSplitThreshold:0;q.enableInnerBisectorSplit=null!=e.enableOuterBisectorSplit?e.enableOuterBisectorSplit:!1;q.innerBisectorAutoSplitThreshold=null!=e.innerBisectorAutoSplitThreshold?e.innerBisectorAutoSplitThreshold:0;c=a;u=g;m=r=t=0;v=!1;w=l=null;p.currentVertex.x=null;p.currentVertex.y=null;p.distance=q.initialDistance;
a=c[0];e=c[c.length-1];p.canSplit=!1;p.closed=a.x===e.x&&a.y===e.y;if(!(2>c.length||2===c.length&&p.closed))if(q.thin)if(q.trackDistance)for(h(),f(),b(1);r-m>q.wrapDistance||t<c.length;)h(),f(),b(2),u.bridge(p),p.leftExit0=p.rightExit0,p.leftExit2=p.rightExit2;else for(;t<c.length;)0<t&&(p.inbound.x=p.outbound.x,p.inbound.y=p.outbound.y),t<c.length-1?(p.outbound.x=c[t+1].x-c[t].x,p.outbound.y=c[t+1].y-c[t].y,a=Math.sqrt(p.outbound.x*p.outbound.x+p.outbound.y*p.outbound.y),p.distance+=a,p.outbound.x/=
a,p.outbound.y/=a):(p.outbound.x=p.inbound.x,p.outbound.y=p.inbound.y),0===t&&(p.inbound.x=p.outbound.x,p.inbound.y=p.outbound.y),p.currentVertex.x=c[t].x,p.currentVertex.y=c[t].y,p.prevNormal.x=-p.inbound.y,p.prevNormal.y=p.inbound.x,p.nextNormal.x=-p.outbound.y,p.nextNormal.y=p.outbound.x,0===t?(u.vertex(p),p.leftEntry0=p.entry0,p.leftEntry2=p.entry2,p.leftExit0=p.exit0,p.leftExit2=p.exit2):(u.vertex(p),p.rightEntry0=p.entry0,p.rightEntry2=p.entry2,p.rightExit0=p.exit0,p.rightExit2=p.exit2,u.bridge(p),
p.leftExit0=p.rightExit0,p.leftExit2=p.rightExit2),++t;else{if(q.enableOuterBisectorSplit||0<q.outerBisectorAutoSplitThreshold||q.enableInnerBisectorSplit||0<q.innerBisectorAutoSplitThreshold)for(p.canSplit=!0,h(),n(),p.splitInner=p.gapInner=p.splitOuter=p.gapOuter=!1,d(1),p.closure0=p.leftEntry0,p.closure1=p.leftEntry1,p.closure2=p.leftEntry2;r-m>q.wrapDistance||t<c.length-1||t<c.length&&(!p.closed||q.trackDistance);)h(),n(),p.splitInner=p.gapInner=p.splitOuter=p.gapOuter=!1,d(2),u.bridge(p),p.leftExit0=
p.rightExit0,p.leftExit1=p.rightExit1,p.leftExit2=p.rightExit2;else for(h(),n(),d(1),p.closure0=p.leftEntry0,p.closure1=p.leftEntry1,p.closure2=p.leftEntry2;r-m>q.wrapDistance||t<c.length-1||t<c.length&&(!p.closed||q.trackDistance);)h(),n(),d(2),u.bridge(p),p.leftExit0=p.rightExit0,p.leftExit1=p.rightExit1,p.leftExit2=p.rightExit2;p.closed&&!q.trackDistance&&(p.rightEntry0=p.closure0,p.rightEntry1=p.closure1,p.rightEntry2=p.closure2,u.bridge(p),p.leftExit0=p.rightExit0,p.leftExit1=p.rightExit1,p.leftExit2=
p.rightExit2)}};a.cleanup=function(){u=c=null};a.splitVertex=k;var c,q={},u,t=void 0,r,m,v,l,w,p=new g;g=function(){function a(a,b){this.writeVertex=a;this.writeTriangle=b;this.capType=0;this.joinType=2;this.miterLimitCosine=e.getLimitCosine(2);this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}a.prototype.vertex=function(a){var b=2===this.joinType?this.miterLimitCosine:this.roundLimitCosine,c=a.isCap&&0!==this.capType,
d=!1;a.cosine>this.almostParallelCosine?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):a.cosine<1-this.almostParallelCosine?(d=!a.isCap&&this.joinOnUTurn,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.entry2=
this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.canSplit?(k(),0<a.sign?(a.splitInner?(a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.leftInner.x,a.leftInner.y,0,-1,a.distance),
a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.rightInner.x,a.rightInner.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<b?(d=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,
-a.nextNormal.y,0,1,a.distance)):a.splitOuter?(d=d||a.gapOuter,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.leftOuter.x,-a.leftOuter.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.rightOuter.x,-a.rightOuter.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.splitInner?(a.exit2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,a.outbound.x,a.outbound.y,-a.leftInner.x,-a.leftInner.y,0,1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.rightInner.x,-a.rightInner.y,0,1,a.distance)):a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<b?(d=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=
this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.splitOuter?(d=d||a.gapOuter,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.leftOuter.x,a.leftOuter.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.rightOuter.x,a.rightOuter.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/
a.cosine,0,-1,a.distance))):0<a.sign?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<b?(d=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,
0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<b?(d=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance));b=a.canSplit&&(a.splitInner||a.splitOuter)||d||c?a.entry1=a.exit1=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,0,0,0,0,a.distance):a.entry1=a.exit1=null;if(d&&1!==this.joinType)this.writeTriangle(b,0<a.sign?a.exit2:a.entry0,0<a.sign?a.entry2:a.exit0);else if(c&&1===this.capType||d&&1===this.joinType){var e=d=c=void 0,f=void 0,g=void 0,h=void 0;if(a.isCap){var l=Math.PI,g=Math.ceil(l/this.radsPerSlice),
h=l/g;a.isFirstVertex?(c=a.prevNormal.x,d=a.prevNormal.y,e=a.entry0,f=a.entry2):a.isLastVertex&&(c=-a.nextNormal.x,d=-a.nextNormal.y,e=a.exit2,f=a.exit0)}else l=2*Math.acos(a.cosine),g=Math.ceil(l/this.radsPerSlice),h=l/g,c=0<a.sign?-a.prevNormal.x:a.nextNormal.x,d=0<a.sign?-a.prevNormal.y:a.nextNormal.y,e=0<a.sign?a.entry2:a.exit0,f=0<a.sign?a.exit2:a.entry0;for(var l=Math.cos(h),h=Math.sin(h),m=h*c+l*d,c=l*c-h*d,d=m,p,m=void 0,n=0;n<g;++n)p=m,n<g-1&&(m=a.isCap?this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,c,d,a.isFirstVertex?-1:1,0,a.distance):this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,c,d,0,a.sign,a.distance)),this.writeTriangle(0===n?e:p,b,n===g-1?f:m),p=h*c+l*d,c=l*c-h*d,d=p}else c&&2===this.capType&&(c=a.isFirstVertex?1:-1,e=d=void 0,this.textured?(d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-c*a.inbound.x,a.prevNormal.y-c*a.inbound.y,-c,-1,a.distance),e=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-c*a.inbound.x,
-a.prevNormal.y-c*a.inbound.y,-c,1,a.distance)):(d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-c*a.inbound.x,a.prevNormal.y-c*a.inbound.y,0,-1,a.distance),e=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-c*a.inbound.x,-a.prevNormal.y-c*a.inbound.y,0,1,a.distance)),0<c?(this.writeTriangle(b,a.entry2,e),this.writeTriangle(b,e,d),this.writeTriangle(b,d,a.entry0)):(this.writeTriangle(b,e,a.exit2),this.writeTriangle(b,d,e),this.writeTriangle(b,a.exit0,
d)))};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,null!=a.leftExit1?a.leftExit1:a.leftExit2);this.writeTriangle(a.rightEntry0,null!=a.rightEntry1?a.rightEntry1:a.rightEntry2,null!=a.leftExit1?a.leftExit1:a.leftExit2);null!=a.leftExit1&&null!=a.rightEntry1?(this.writeTriangle(a.leftExit1,a.rightEntry1,a.leftExit2),this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)):null!=a.leftExit1?this.writeTriangle(a.leftExit1,a.rightEntry2,a.leftExit2):null!=a.rightEntry1&&
this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)};return a}();a.StandardTessellationCallbacks=g;g=function(){function a(a,b){this.writeVertex=a;this.writeTriangle=b}a.prototype.vertex=function(a){a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance);a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance);a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,
a.nextNormal.y,0,-1,a.distance);a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,a.leftExit2);this.writeTriangle(a.rightEntry0,a.rightEntry2,a.leftExit2)};return a}();a.ThinTessellationCallbacks=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports tslib ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l){Object.defineProperty(a,"__esModule",{value:!0});var w=b.vec2f32.create(),p=d.mat2df32.create(),y=h.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");g=function(a){function b(b){var d=a.call(this,b)||this;d._cimMarkerLayer=b;r.isFunction(b.color)?d._dynamicPropertyMap.set("_fillColor",function(a,d,e){return c.premultiplyAlphaRGBA(b.color(a,d,e))}):d._fillColor=c.premultiplyAlphaRGBA(b.color);r.isFunction(b.outlineColor)?d._dynamicPropertyMap.set("_outlineColor",
function(a,d,e){return c.premultiplyAlphaRGBA(b.outlineColor(a,d,e))}):d._outlineColor=c.premultiplyAlphaRGBA(b.outlineColor);r.isFunction(b.size)?d._dynamicPropertyMap.set("_size",function(a,c,d){return n.pt2px(b.size(a,c,d))}):d._size=n.pt2px(b.size);r.isFunction(b.scaleX)?d._dynamicPropertyMap.set("_scaleX",b.scaleX):d._scaleX=b.scaleX;r.isFunction(b.offsetX)?d._dynamicPropertyMap.set("xOffset",function(a,c,d){return n.pt2px(b.offsetX(a,c,d))}):d.xOffset=n.pt2px(b.offsetX);r.isFunction(b.offsetY)?
d._dynamicPropertyMap.set("yOffset",function(a,c,d){return n.pt2px(b.offsetY(a,c,d))}):d.yOffset=n.pt2px(b.offsetY);r.isFunction(b.outlineWidth)?d._dynamicPropertyMap.set("_outlineWidth",function(a,c,d){return n.pt2px(b.outlineWidth(a,c,d))}):d._outlineWidth=n.pt2px(b.outlineWidth);r.isFunction(b.rotation)?d._dynamicPropertyMap.set("_angle",b.rotation):d._angle=b.rotation;d._scaleFactor=f.unwrapOr(b.scaleFactor,1);d._markerPlacement=b.markerPlacement;d.effects=b.effects;d._bitSet=(1===b.alignment?
1:0)|(b.colorLocked?1:0)<<1|(b.scaleSymbolsProportionally?1:0)<<3;d._materialKey=b.materialKey;return d}e.__extends(b,a);b.fromCIMMarker=function(a){return new b(a)};b.prototype.bindFeature=function(a,b,c){var d=this,e=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,f){d[f]=a(e,b,c)});a=this._cimMarkerLayer.materialHash;a="function"===typeof a?a(e,b,c):a;if((a=this._materialCache.get(a))&&l.ok(a.spriteMosaicItem)&&a.spriteMosaicItem){a=a.spriteMosaicItem;var f=this._cimMarkerLayer.sizeRatio,
g=a.width/a.height*this._scaleX,h=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,m=this._size,r=m*g,v=this.xOffset,z=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var x=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/n.pt2px(this._cimMarkerLayer.frameHeight):1,C=this._outlineWidth*x,B=n.pt2px(this._cimMarkerLayer.referenceSize),E=x=0,R=this._cimMarkerLayer.anchorPoint;R&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?
this._size&&(x=-R.x/(this._size*g),E=R.y/this._size):(x=R.x,E=R.y));this._sizeOutlineWidth=u.i8888to32(Math.round(Math.min(Math.sqrt(128*r),255)),Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*C),255)),Math.round(Math.min(Math.sqrt(128*B),255)));this.angle=h;this._bitestAndDistRatio=u.i8888to32(0,0,this._bitSet,Math.round(Math.min(64*f,255)));g=a.rect.x+q.SPRITE_PADDING;h=a.rect.y+q.SPRITE_PADDING;C=g+a.width;B=h+a.height;this._texUpperLeft=u.i1616to32(g,h);this._texUpperRight=
u.i1616to32(C,h);this._texBottomLeft=u.i1616to32(g,B);this._texBottomRight=u.i1616to32(C,B);g=t.MarkerMaterialKey.load(this._materialKey);g.sdf=a.sdf;g.pattern=!0;g.textureBinding=a.textureBinding;this._materialKey=g.data;this._anchorX=.5-(.5+x)*a.width/a.width;this._anchorY=.5-(.5+E)*a.height/a.height;r=r*f*this._scaleFactor;m=m*f*this._scaleFactor;r*=a.rect.width/a.width;m*=a.rect.height/a.height;this._computedWidth=r;this._computedHeight=m;this._applyTransformation(p,w);this.xOffset=v;this.yOffset=
z}else y.error(new k("mapview-cim","Encountered an error when binding feature"))};return b}(m.default(v.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports tslib ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),function(g,a,e,k,h,f,n,d,b,c,q){Object.defineProperty(a,"__esModule",
{value:!0});g=function(a){function b(b){var c=a.call(this,b)||this;c._horizontalAlignment="center";c._verticalAlignment="middle";c._textToGlyphs=new Map;var e=b.scaleFactor||1;c._cimTextLayer=b;d.isFunction(b.color)?c._dynamicPropertyMap.set("_color",function(a,c,d){return f.premultiplyAlphaRGBA(b.color(a,c,d))}):c._color=f.premultiplyAlphaRGBA(b.color);d.isFunction(b.color)?c._dynamicPropertyMap.set("_haloColor",function(a,c,d){return f.premultiplyAlphaRGBA(b.outlineColor(a,c,d))}):c._haloColor=
f.premultiplyAlphaRGBA(b.outlineColor);var g;d.isFunction(b.size)||(g=Math.min(Math.round(k.pt2px(b.size*b.sizeRatio)),127));c._dynamicPropertyMap.set("_size",function(a,c,e){return d.isFunction(b.size)?Math.min(Math.round(k.pt2px(b.size(a,c,e)*b.sizeRatio)),127):g});d.isFunction(b.outlineSize)?c._dynamicPropertyMap.set("_haloSize",function(a,c,d){return Math.min(Math.floor(5*k.pt2px(b.outlineSize(a,c,d)*b.sizeRatio)),127)}):c._haloSize=Math.min(Math.floor(5*k.pt2px(b.outlineSize*b.sizeRatio)),127);
var h;d.isFunction(b.offsetX)||(h=Math.round(k.pt2px(b.offsetX*b.sizeRatio)));c._dynamicPropertyMap.set("_xOffset",function(a,c,e){return d.isFunction(b.offsetX)?Math.round(k.pt2px(b.offsetX(a,c,e)*b.sizeRatio)):h});var p;d.isFunction(b.offsetY)||(p=Math.round(k.pt2px(b.offsetY*b.sizeRatio)));c._dynamicPropertyMap.set("_yOffset",function(a,c,e){return d.isFunction(b.offsetY)?Math.round(k.pt2px(b.offsetY(a,c,e)*b.sizeRatio)):p});d.isFunction(b.angle)?c._dynamicPropertyMap.set("_angle",b.angle):c._angle=
b.angle;d.isFunction(b.horizontalAlignment)?c._dynamicPropertyMap.set("_horizontalAlignment",b.horizontalAlignment):c._horizontalAlignment=b.horizontalAlignment;d.isFunction(b.verticalAlignment)?c._dynamicPropertyMap.set("_verticalAlignment",b.verticalAlignment):c._verticalAlignment=b.verticalAlignment;c._scaleFactor=e;d.isFunction(b.text)?c._dynamicPropertyMap.set("_text",b.text):c._text=b.text;e=Math.min(Math.round(k.pt2px(b.referenceSize*b.sizeRatio)),127);c._referenceSize=Math.round(Math.sqrt(256*
e));c._materialKey=b.materialKey;e=n.TextMaterialKey.load(c._materialKey);e.sdf=!0;c._bitset=(1===b.alignment?1:0)|(b.colorLocked?1:0)<<1;c._materialKey=e.data;c._decoration="none";c._lineHeight=1;c._lineWidth=512;c._textPlacement=b.markerPlacement;c.effects=b.effects;c._isCIM=!0;return c}e.__extends(b,a);b.fromCIMText=function(a){return new b(a)};b.prototype.analyze=function(a,b,c,d){return e.__awaiter(this,void 0,void 0,function(){var f,g,h;return e.__generator(this,function(e){switch(e.label){case 0:return f=
b.readLegacyFeature(),e=this._cimTextLayer,g="string"===typeof e.text?e.text:"function"===typeof e.text?e.text(f,c,d):"",[4,a.getMosaicItem(this._cimTextLayer.cim,q.codepoints(g))];case 1:return h=e.sent(),this._textToGlyphs.set(g,h.glyphMosaicItems),[2,h]}})})};b.prototype.bindFeature=function(a,b,c){var d=this,e=a.readLegacyFeature();this._dynamicPropertyMap.forEach(function(a,f){d[f]=a(e,b,c)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=
this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=h.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=h.getYAnchorDirection(this._verticalAlignment||"baseline"),a=this._textToGlyphs.get(this._text),this.bindTextInfo(a,!1)):this._shapingInfo=null};return b}(b.default(c.default));a.default=g})},"esri/views/2d/layers/features/textUtils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.codepoints=void 0;a.codepoints=
function(a){for(var e=Array(a.length),g=0;g<a.length;g++)e[g]=a.charCodeAt(g);return e}})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports tslib ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(g,a,e,k,h,f,n,d,b,c,q,u){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function g(b,
d,e,f,g,h,k,n,q){var l=a.call(this)||this;l.effects=q;b=c.FillMaterialKey.load(b);d&&(b.sdf=d.sdf,b.pattern=!0,b.textureBinding=d.textureBinding);l.fillColor=e;l.tl=f;l.br=g;l.aux1=h;l.aux2=k;l.aux3=n;l._materialKey=b.data;return l}e.__extends(g,a);g.fromCIMFill=function(a,c){var e=a.color,e=e&&f.premultiplyAlphaRGBA(e)||0,m=a.materialKey;if(!c)return c=b.i8888to32(0,0,0,a.colorLocked?1:0),new g(m,null,e,0,0,0,0,c,a.effects);var p=c.rect,q=c.width,r=c.height,v=p.x+n.SPRITE_PADDING,t=p.y+n.SPRITE_PADDING,
u=v+q,x=t+r,p=k.nextHighestPowerOfTwo(h.pt2px(a.height||0));255<p?p=255:0>=p&&(p=k.nextHighestPowerOfTwo(x-t));r=k.nextHighestPowerOfTwo(h.pt2px(a.height/r*q||0));255<r?r=255:0>=r&&(r=k.nextHighestPowerOfTwo(u-v));var A=h.pt2px(a.offsetX||0)+128;255<A&&(A=255);var F=h.pt2px(-a.offsetY||0)+128;255<F&&(F=255);q=a.scaleX||1;v=b.i1616to32(v,t);u=b.i1616to32(u,x);p=b.i8888to32(r,p,A,F);x=b.i1616to32(128*q,128);q=b.i8888to32(0,0,d.degToByte(a.angle),a.colorLocked?1:0);return new g(m,c,e,v,u,p,x,q,a.effects)};
g.fromSimpleFill=function(a,c,d){void 0===d&&(d=!1);var e=a.color,e=e&&"esriSFSNull"!==a.style&&f.premultiplyAlphaRGBAArray(e)||0;d=b.i8888to32(0,0,0,d?255:0);a=a.materialKey;if(!c)return new g(a,null,e,0,0,0,0,d,null);var h=c.rect,l=h.x+n.SPRITE_PADDING,m=h.y+n.SPRITE_PADDING,q=l+c.width,r=m+c.height,h=b.i1616to32(l,m),v=b.i1616to32(q,r),l=b.i8888to32(k.nextHighestPowerOfTwo(q-l),k.nextHighestPowerOfTwo(r-m),0,0),m=b.i1616to32(128,128);return new g(a,c,e,h,v,l,m,d,null)};g.fromPictureFill=function(a,
c,d){void 0===d&&(d=!1);var e=n.PICTURE_FILL_COLOR,f=c.rect,l=f.x+n.SPRITE_PADDING,m=f.y+n.SPRITE_PADDING,f=l+c.width,q=m+c.height,l=b.i1616to32(l,m),f=b.i1616to32(f,q),q=k.nextHighestPowerOfTwo(h.pt2px(a.width));255<q&&(q=255);m=k.nextHighestPowerOfTwo(h.pt2px(a.height));255<m&&(m=255);var r=h.pt2px(a.xoffset)+128;255<r&&(r=255);var v=h.pt2px(-a.yoffset)+128;255<v&&(v=255);q=b.i8888to32(q,m,r,v);m=b.i1616to32(128*a.xscale,128*a.yscale);d=b.i8888to32(0,0,0,d?255:0);return new g(a.materialKey,c,e,
l,f,q,m,d,null)};return g}(q.default(u.default));a.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports tslib ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(g,a,e,k,h,f,n,d,b,c,q,u,t){Object.defineProperty(a,"__esModule",{value:!0});var r=k.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");
g=function(a){function g(b,d,e,f,g,h,k,m,n,r,v,t,u,J,H,M){var l=a.call(this)||this;b=c.LineMaterialKey.load(b);d&&(b.sdf=d.sdf,b.pattern=!0,b.textureBinding=d.textureBinding);l._capType=f;l._joinType=g;l._miterLimitCosine=q.getLimitCosine(h);l.tessellationProperties._fillColor=k;l.tessellationProperties._tl=m;l.tessellationProperties._br=n;l._hasPattern=r;l._isDashed=v;l._joinOnUTurn=H;l._isColorLocked=t;l._zOrder=J;l.effects=M;l._materialKey=b.data;l.tessellationProperties._bitset=t?1:0;l.tessellationProperties._halfWidth=
.5*e;l.tessellationProperties._halfReferenceWidth=.5*u;l._initializeTessellator(!1);return l}e.__extends(g,a);g.fromCIMLine=function(a,b,c){var e=a.color,k=a.scaleFactor||1,l=a.isDashed,m=a.cap;l&&1===m&&(m=2);var p=a.join,k=h.pt2px(a.width)*k,q=h.pt2px(a.referenceWidth),r=h.pt2px(a.miterLimit),e=e&&f.premultiplyAlphaRGBA(e)||0;if(!b)return new g(a.materialKey,b,k,m,p,r,e,0,0,!1,l,a.colorLocked,q,a.zOrder,c,a.effects);var v=b.rect,t=v.x+n.SPRITE_PADDING,w=v.y+n.SPRITE_PADDING,v=t+b.width,u=w+b.height,
t=d.i1616to32(t,w),v=d.i1616to32(v,u);return new g(a.materialKey,b,k,m,p,r,e,t,v,!0,l,a.colorLocked,q,a.zOrder,c,a.effects)};g.fromSimpleLine=function(a,c,e){var k=a.color,l="esriSLSSolid"!==a.style&&"esriSLSNull"!==a.style,m=b.getCapType(a.cap||"round",l),p=b.getJoinType(a.join||"round"),k=k&&"esriSLSNull"!==a.style&&f.premultiplyAlphaRGBAArray(k)||0;"esriSLSNull"===a.style&&(k=0);var q=h.pt2px(a.width),r=a.miterLimit;if(!c)return new g(a.materialKey,c,q,m,p,r,k,0,0,!1,l,!1,q,0,e,null);var v=c.rect,
t=v.x+n.SPRITE_PADDING,w=v.y+n.SPRITE_PADDING,v=t+c.width,u=w+c.height,t=d.i1616to32(t,w),v=d.i1616to32(v,u);return new g(a.materialKey,c,q,m,p,r,k,t,v,!0,l,!1,q,0,e,null)};g.fromPictureLineSymbol=function(a,b,c,d){r.error("PictureLineSymbol support does not exist!");return null};return g}(u.default(t.default));a.default=g})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});
a.withLock=void 0;g=function(){function a(){this._resolver=null}a.prototype.isHeld=function(){return!!this._resolver};a.prototype.acquire=function(){var a=this;return this._resolver?this._resolver.promise.then(function(){return a.acquire()}):(this._resolver=e.createResolver(),e.resolve())};a.prototype.release=function(){var a=this._resolver;this._resolver=null;a.resolve()};return a}();a.default=g;a.withLock=function(a,e,f){return a.acquire().then(function(){return e(f)}).then(function(){return a.release()}).catch(function(e){a.release();
throw e;})}})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports tslib ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils @dojo/framework/shim/Promise".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m){function v(a,b){return function(c){return b(a(c))}}Object.defineProperty(a,"__esModule",{value:!0});a.isAggregateId=a.DISPLAY_ID_TYPE_AGGREGATE=a.DISPLAY_ID_TYPE_FEATURE=void 0;var l=f.getLogger("esri.views.layers.2d.features.support.AttributeStore"),w=r.createDebugLogger(r.DEBUG_ATTR_UPDATES,l);a.DISPLAY_ID_TYPE_FEATURE=0;a.DISPLAY_ID_TYPE_AGGREGATE=1;a.isAggregateId=function(b){return(b&2147483648)>>>31===a.DISPLAY_ID_TYPE_AGGREGATE};var p=h("esri-shared-array-buffer"),
y=h("esri-webgl-texture-float"),z=h("esri-webgl-max-texture-size"),C=h("esri-atomics"),B=function(){function a(a,b,c,d){this.size=0;this.texelSize=4;var e=d.pixelType,f=d.layout;this.textureOnly=(d=d.textureOnly)||!1;this.pixelType=e;this._ctype=b;this.layout=f;this._resetRange();this._shared=a;this.size=c;d||(this.data=this._initData(e,c,a,b))}Object.defineProperty(a.prototype,"buffer",{get:function(){return d.andThen(this.data,function(a){return a.buffer})},enumerable:!1,configurable:!0});a.prototype.unsetComponentAllTexels=
function(a,b){for(var c=d.unwrap(this.data),e=0;e<this.size*this.size;e++)c[e*this.texelSize+a]&=~b;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};a.prototype.setComponentAllTexels=function(a,b){for(var c=d.unwrap(this.data),e=0;e<this.size*this.size;e++)c[e*this.texelSize+a]|=255&b;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};a.prototype.setComponent=function(a,b,c){for(var e=d.unwrap(this.data),f=0;f<c.length;f++){var g=c[f];e[g*this.texelSize+a]|=b;this.dirtyStart=Math.min(this.dirtyStart,
g);this.dirtyEnd=Math.max(this.dirtyEnd,g)}};a.prototype.setComponentTexel=function(a,b,c){d.unwrap(this.data)[c*this.texelSize+a]|=b;this.dirtyStart=Math.min(this.dirtyStart,c);this.dirtyEnd=Math.max(this.dirtyEnd,c)};a.prototype.unsetComponentTexel=function(a,b,c){d.unwrap(this.data)[c*this.texelSize+a]&=~b;this.dirtyStart=Math.min(this.dirtyStart,c);this.dirtyEnd=Math.max(this.dirtyEnd,c)};a.prototype.getData=function(a,b){a&=2147483647;return d.unwrap(this.data)[a*this.texelSize+b]};a.prototype.setData=
function(a,b,c){a&=2147483647;0===(this.layout&1<<b)?l.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[a*this.texelSize+b]=c,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.lock=function(){5121===this.pixelType&&this._shared&&C&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};a.prototype.unlock=function(){5121===this.pixelType&&this._shared&&C&&"local"!==this._ctype&&Atomics.store(this.data,
0,0)};a.prototype.expand=function(a){this.size=a;if(!this.textureOnly){a=this._initData(this.pixelType,a,this._shared,this._ctype);var b=d.unwrap(this.data);a.set(b);this.data=a}};a.prototype.toMessage=function(){var a=this.dirtyStart,b=this.dirtyEnd,c=this.texelSize;if(a>b)return null;this._resetRange();var e=!this._shared&&"local"!==this._ctype,f=this.pixelType,g=this.layout,h=d.unwrap(this.data);if(!h.slice){if(!e)return{start:a,end:b,data:null,pixelType:f,layout:g};c=new (t.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,
a*c,(b+1)*c));return{start:a,end:b,data:c,pixelType:f,layout:g}}c=e&&h.slice(a*c,(b+1)*c)||null;return{start:a,end:b,data:c,pixelType:f,layout:g}};a.prototype._initData=function(a,b,c,d){c=c&&"local"!==d?SharedArrayBuffer:ArrayBuffer;a=t.getPixelArrayCtor(a);b=new a(new c(b*b*4*a.BYTES_PER_ELEMENT));for(a=0;a<b.length;a+=4)b[a+1]=255;return b};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};return a}();f=function(){function f(a){this._attributeComputeMap=new Map;this._blocks=
[];this._filters=Array(u.MAX_FILTERS);this._targetType=0;this._abortController=b.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;var c=y?5126:5121;w("Creating AttributeStore "+(p?"with":"without")+" shared memory");this._client=a;this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:c,layout:15},{pixelType:c,layout:15}];this._blocks=this._blockDescriptors.map(function(){return null})}f.prototype.destroy=function(){this._abortController.abort()};
Object.defineProperty(f.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!1,configurable:!0});f.prototype.update=function(b,e){var f=c.diff(this._schema,e);if(b.targets.feature||b.targets.aggregate)b.storage.data=!0;if(f&&(h("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",f),b.storage.data=!0,this._schema=e,this._attributeComputeMap.clear(),
!d.isNone(e))){switch(e.target){case "feature":this._targetType=a.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=a.DISPLAY_ID_TYPE_AGGREGATE}b=0;for(e=e.mapping;b<e.length;b++)this._bindAttribute(e[b])}};f.prototype.onTileData=function(a,b){if(!d.isNone(b.addOrUpdate))for(a=b.addOrUpdate.getCursor();a.next();)b=a.getDisplayId(),this.setAttributeData(b,a)};f.prototype.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=
b.createAbortController()};f.prototype.setHighlight=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f,g,h;return e.__generator(this,function(e){switch(e.label){case 0:c=this._getBlock(0);d=b.map(function(a){return a&2147483647});c.lock();c.unsetComponentAllTexels(0,1);c.setComponent(0,1,d);c.unlock();this._idsToHighlight.clear();f=0;for(g=a;f<g.length;f++)h=g[f],this._idsToHighlight.add(h);return[4,this.sendUpdates()];case 1:return e.sent(),[2]}})})};f.prototype.updateFilters=
function(a,c){return e.__awaiter(this,void 0,void 0,function(){var d,f,g,k,l,m,p,n=this;return e.__generator(this,function(e){switch(e.label){case 0:return d=c.config,f=c.service,g=c.spatialReference,k=d.filters,l=k.map(function(a,b){return n._updateFilter(a,b,f,g)}),[4,b.all(l)];case 1:m=e.sent();if(p=m.some(function(a){return a}))a.storage.filters=!0,h("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed");return[2]}})})};f.prototype.setData=function(a,b,c,
d){this._ensureSizeForTexel(a&2147483647);this._getBlock(b).setData(a,c,d)};f.prototype.getData=function(a,b,c){return this._getBlock(b).getData(a,c)};f.prototype.getHighlightFlag=function(a){return this._idsToHighlight.has(a)?u.HIGHLIGHT_FLAG:0};f.prototype.setAttributeData=function(a,b){var c=this,d=a&2147483647;this._ensureSizeForTexel(d);this._getBlock(0).setData(d,0,this.getFilterFlags(b));if(this._targetType===(a&2147483648)>>>31){a=this._attributeComputeMap;var e=y?1:2;a.size&&a.forEach(function(a,
f){var g=f*e%4;f=c._getBlock(Math.floor(f*e/4)+u.ATTRIBUTE_DATA_VV);a=a(b);if(y)f.setData(d,g,a);else if(a===u.NAN_MAGIC_NUMBER)f.setData(d,g,255),f.setData(d,g+1,255);else{a=n.clamp(Math.round(a),-32767,32766)+32768;var h=(a&65280)>>8;f.setData(d,g,a&255);f.setData(d,g+1,h)}})}};f.prototype.sendUpdates=function(){var a=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=b.createResolver(),this._nextUpdate.promise;var c={blocks:this._blocks.map(function(a){return d.isSome(a)?
a.toMessage():null})};return this._currUpdate=this._createResources().then(function(){var b=function(){a._currUpdate=null;if(a._nextUpdate){var b=a._nextUpdate;a._nextUpdate=null;a.sendUpdates().then(function(){return b.resolve()})}},b=a._client.update(c,a._signal).then(b).catch(b);a._client.render(a._signal);return b}).catch(function(c){if(b.isAbortError(c))return a._createResourcesPromise=null,a._createResources();l.error(new k("mapview-attribute-store","Encountered an error during client update",
c));return b.resolve()})};f.prototype._ensureSizeForTexel=function(a){for(;a>=this._size*this._size&&!this._expand(););};f.prototype._bindAttribute=function(a){function b(){return a.normalizationField?function(b){var c=b.readAttribute(a.normalizationField);return c?b.readAttribute(a.field)/c:null}:function(b){return b.readAttribute(a.field)}}function c(){a.normalizationField&&l.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return function(b){return b.getComputedNumericAtIndex(a.fieldIndex)}}
var d;if(null!=a.fieldIndex)d=c();else if(a.field)d=b();else return;a.valueRepresentation&&(d=v(d,function(b){return m.getVisualVariableSizeValueRepresentationRatio(b,a.valueRepresentation)}));this._attributeComputeMap.set(a.binding,v(d,function(a){return null===a||isNaN(a)||Infinity===a?u.NAN_MAGIC_NUMBER:a}))};f.prototype._createResources=function(){var a=this;if(d.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(u.ATTRIBUTE_DATA_ANIMATION);w("Initializing AttributeStore");
var c={shared:p&&"local"!==this._client.type,size:this._size,blocks:d.mapMany(this._blocks,function(a){return{textureOnly:a.textureOnly,buffer:a.buffer,pixelType:a.pixelType}})};this._createResourcesPromise=c=this._client.initialize(c,this._signal).catch(function(c){b.isAbortError(c)?a._createResourcesPromise=null:l.error(new k("mapview-attribute-store","Encountered an error during client initialization",c))});c.then(function(){return d.isNone(a._createResourcesPromise)?a._createResources():void 0});
return c};f.prototype._getBlock=function(a){var b=this._blocks[a];if(d.isSome(b))return b;w("Initializing AttributeBlock at index "+a);b=new B(p,this._client.type,this._size,this._blockDescriptors[a]);this._blocks[a]=b;this._createResourcesPromise=null;return b};f.prototype._expand=function(){if(this._size<z){var a=this._size<<=1;w("Expanding block size to",a,this._blocks);d.forEachSome(this._blocks,function(b){return b.expand(a)});this._createResourcesPromise=null;this._size=a;return 0}l.error(new k("mapview-limitations",
"Maximum number of onscreen features exceeded."));return-1};f.prototype._updateFilter=function(a,b,c,f){return e.__awaiter(this,void 0,void 0,function(){var g,h,k,l,m;return e.__generator(this,function(e){switch(e.label){case 0:return g=this._filters[b],h=d.isSome(g)&&g.hash,!g&&!a||h===JSON.stringify(a)?[2,!1]:d.isNone(a)?(k=1<<b+1,l=this._getBlock(0),this._filters[b]=null,l.setComponentAllTexels(0,k),this.sendUpdates(),[2,!0]):[4,this._getFilter(b,c)];case 1:return m=e.sent(),[4,m.update(a,f)];
case 2:return e.sent(),[2,!0]}})})};f.prototype._getFilter=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,f,h;return e.__generator(this,function(e){switch(e.label){case 0:return c=this._filters[a],d.isSome(c)?[2,c]:[4,new Promise(function(a,b){g(["../../../../../layers/graphics/data/FeatureFilter"],a,b)})];case 1:return f=e.sent().default,h=new f({geometryType:b.geometryType,hasM:!1,hasZ:!1,timeInfo:b.timeInfo,fieldsIndex:new q(b.fields)}),this._filters[a]=h,[2,h]}})})};f.prototype.isVisible=
function(a){return!!(this._getBlock(0).getData(a,0)&2)};f.prototype.getFilterFlags=function(b){var c=0,e;e=(b.getDisplayId()&2147483648)>>>31===a.DISPLAY_ID_TYPE_AGGREGATE?254:255;for(var f=0;f<this._filters.length;f++)var g=this._filters[f],g=!(e&1<<f)||d.isNone(g)||g.check(b),c=c|(g?1:0)<<f;e=0;this._idsToHighlight.size&&(b=b.getObjectId(),e=this.getHighlightFlag(b));return c<<1|e};return f}();a.default=f})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require","exports","tslib"],
function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.DEBUG_ATTR_UPDATES=a.createDebugLogger=void 0;a.createDebugLogger=function(a,g){return a&&function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];return g.warn.apply(g,e.__spreadArrays(["DEBUG:"],a))}||function(){return null}};a.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("require exports tslib ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils ../../../../../3d/layers/support/FastSymbolUpdates".split(" "),
function(g,a,e,k,h,f,n,d,b){function c(a){return{value:a.value,size:k.toPt(a.size)}}function q(a){return a.map(function(a){return c(a)})}function u(a){return"string"===typeof a||"number"===typeof a?k.toPt(a):{type:"size",expression:a.expression,stops:q(a.stops)}}function t(a){var b={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof a.field)if(a.stops){if(8<a.stops.length)return null;var c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.values[a]=d.value;b.opacities[a]=
d.opacity}}else return null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].opacity,a=0;8>a;a++)b.values[a]=Infinity,b.opacities[a]=c;else return null;return b}Object.defineProperty(a,"__esModule",{value:!0});a.convertVisualVariables=a.getVisualVariablesFields=a.normalizeSizeElement=a.normalizeSizeStops=a.stopToSizeStop=a.getVisualVariableSizeValueRepresentationRatio=void 0;a.getVisualVariableSizeValueRepresentationRatio=function(a,b){if(!a||!b)return a;switch(b){case "radius":case "distance":return 2*
a;case "area":return Math.sqrt(a)}return a};a.stopToSizeStop=c;a.normalizeSizeStops=q;a.normalizeSizeElement=u;a.getVisualVariablesFields=function(a){var b=a&&0<a.length?{}:null;b&&a.forEach(function(a){var c=a.type;a.field&&(b[c]=a.field)});return b};var r=function(a){var b=[],c=[];a=q(a);for(var d=a.length,e=0;6>e;e++){var g=a[Math.min(e,d-1)];b.push(g.value);c.push(null==g.size?f.NAN_MAGIC_NUMBER:k.pt2px(g.size))}return{values:new Float32Array(b),sizes:new Float32Array(c)}};a.convertVisualVariables=
function(a){var c=a&&0<a.length?{}:null,f=c?{}:null;if(!c)return{vvFields:c,vvRanges:f};for(var g=0;g<a.length;g++){var k=a[g],m=k.type;k.field&&(c[m]=k.field);if("size"===m)switch(f.size||(f.size={}),d.getTypeOfSizeVisualVariable(k)){case n.WGLVVFlag.SIZE_MINMAX_VALUE:f.size.minMaxValue={minDataValue:k.minDataValue,maxDataValue:k.maxDataValue,minSize:u(k.minSize),maxSize:u(k.maxSize)};break;case n.WGLVVFlag.SIZE_SCALE_STOPS:f.size.scaleStops={stops:q(k.stops)};break;case n.WGLVVFlag.SIZE_FIELD_STOPS:if(k.levels){var m=
{},z;for(z in k.levels)m[z]=r(k.levels[z]);f.size.fieldStops={type:"level-dependent",levels:m}}else f.size.fieldStops=e.__assign({type:"static"},r(k.stops));break;case n.WGLVVFlag.SIZE_UNIT_VALUE:f.size.unitValue={unit:k.valueUnit,valueRepresentation:k.valueRepresentation}}else if("color"===m){if(k=b.convertVisualVariables([k],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}))for(f.color=k.color,k=0;32>k;k+=4)h.premultiplyAlpha(f.color.colors,k,!0)}else"opacity"===m?f.opacity=t(k):
"rotation"===m&&(f.rotation={type:k.rotationType})}return{vvFields:c,vvRanges:f}}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u){function t(a){return null!==a&&void 0!==a}function r(a){return"number"===typeof a}function m(a){return"string"===typeof a}function v(a,b){a&&a.push(b)}function l(a,b,c,d,e){var f=a.minSize,g=a.maxSize;if(a.expression)return v(e,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=d.symbolSize[c],b.minSize[c]=a,b.maxSize[c]=a,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(t(a.field)){if(t(a.stops)){if(2===a.stops.length&&
r(a.stops[0].size)&&r(a.stops[1].size))return w(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,b,c),b.type[c]=1,!0;v(e,"Could not convert size info: stops only supported with 2 elements");return!1}if(r(f)&&r(g)&&t(a.minDataValue)&&t(a.maxDataValue))return w(f,g,a.minDataValue,a.maxDataValue,b,c),b.type[c]=1,!0;if(null!=q.meterIn[a.valueUnit])return b.minSize[c]=-Infinity,b.maxSize[c]=Infinity,b.offset[c]=0,b.factor[c]=1/q.meterIn[a.valueUnit],b.type[c]=1,!0;if("unknown"===a.valueUnit)return v(e,
"Could not convert size info: proportional size not supported"),!1;v(e,"Could not convert size info: scale-dependent size not supported");return!1}if(!t(a.field)){if(a.stops&&a.stops[0]&&r(a.stops[0].size))return b.minSize[c]=a.stops[0].size,b.maxSize[c]=a.stops[0].size,b.offset[c]=b.minSize[c],b.factor[c]=0,b.type[c]=1,!0;if(r(f))return b.minSize[c]=f,b.maxSize[c]=f,b.offset[c]=f,b.factor[c]=0,b.type[c]=1,!0}v(e,"Could not convert size info: unsupported variant of sizeInfo");return!1}function w(a,
b,c,d,e,f){d=0<Math.abs(d-c)?(b-a)/(d-c):0;e.minSize[f]=0<d?a:b;e.maxSize[f]=0<d?b:a;e.offset[f]=a-c*d;e.factor[f]=d}function p(a,b,c,d){if(a.normalizationField||a.valueRepresentation)return v(d,"Could not convert size info: unsupported property"),null;var e=a.field;if(null!=e&&!m(e))return v(d,"Could not convert size info: field is not a string"),null;if(!b.size)b.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=
a.field;else if(a.field!==b.size.field)return v(d,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(e=l(a,b.size,0,c,d))?b:null;case "height":return(e=l(a,b.size,2,c,d))?b:null;case "depth":return(e=l(a,b.size,1,c,d))?b:null;case "width-and-depth":return(e=l(a,b.size,0,c,d))&&l(a,b.size,1,c,d),e?b:null;case null:case void 0:case "all":return(e=(e=(e=l(a,b.size,0,c,d))&&l(a,b.size,1,c,d))&&l(a,b.size,2,c,d))?b:null;default:return v(d,'Could not convert size info: unknown axis "'+
a.axis+'""'),null}}function y(a,b,c){for(var d=0;3>d;++d){var e=b.unitInMeters;1===a.type[d]&&(e*=b.modelSize[d],a.type[d]=2);a.minSize[d]/=e;a.maxSize[d]/=e;a.offset[d]/=e;a.factor[d]/=e}if(0!==a.type[0])b=0;else if(0!==a.type[1])b=1;else if(0!==a.type[2])b=2;else return v(c,"No size axis contains a valid size or scale"),!1;for(d=0;3>d;++d)0===a.type[d]&&(a.minSize[d]=a.minSize[b],a.maxSize[d]=a.maxSize[b],a.offset[d]=a.offset[b],a.factor[d]=a.factor[b],a.type[d]=a.type[b]);return!0}function z(a,
b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function C(a,b,c){if(a.normalizationField)return v(c,"Could not convert color info: unsupported property"),null;if(m(a.field))if(a.stops){if(8<a.stops.length)return v(c,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.color.values[a]=d.value;
z(b.color.colors,a,d.color)}}else return v(c,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].color,b.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.color.values[a]=Infinity,z(b.color.colors,a,c);else return v(c,"Could not convert color info: no field and no colors/stops"),null;return b}function B(a,b,c){if(a.normalizationField)return v(c,
"Could not convert opacity info: unsupported property"),null;if(m(a.field))if(a.stops){if(8<a.stops.length)return v(c,"Could not convert opacity info: too many opacity stops"),null;b.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.opacity.values[a]=d.value;b.opacity.opacityValues[a]=d.opacity}}else return v(c,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(c=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,b.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.opacity.values[a]=Infinity,b.opacity.opacityValues[a]=c;else return v(c,"Could not convert opacity info: no field and no opacities/stops"),null;return b}function E(a,b,c){a=2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function x(a,b,c){if(!m(a.field))return v(c,"Could not convert rotation info: field is not a string"),
null;if(!b.rotation)b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!b.rotation.field)b.rotation.field=a.field;else if(a.field!==b.rotation.field)return v(c,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return E(a,b.rotation,0),b;case "roll":return E(a,b.rotation,1),b;case null:case void 0:case "heading":return E(a,b.rotation,2),b;default:return v(c,'Could not convert rotation info: unknown axis "'+a.axis+'""'),
null}}function A(a,b,c){if(!a)return null;var d=!b.supportedTypes||!!b.supportedTypes.size,f=!b.supportedTypes||!!b.supportedTypes.color,g=!b.supportedTypes||!!b.supportedTypes.rotation,h=!!b.supportedTypes&&!!b.supportedTypes.opacity,k=a.reduce(function(a,k){if(!a)return a;if(k.valueExpression)return v(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(k.type){case "size":return d?p(k,a,b,c):a;case "color":return f?C(k,a,c):a;case "opacity":return h?B(k,a,c):null;
case "rotation":return g?x(k,a,c):a;default:return e.neverReached(k),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&k&&!k.size&&!k.color&&!k.opacity&&!k.rotation||k&&k.size&&!y(k.size,b,c)?null:k}function F(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function I(a,b){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},e=a&&null!=a.size;a&&a.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=a.size.minSize,c.vvSizeMaxSize=a.size.maxSize,c.vvSizeOffset=a.size.offset,c.vvSizeFactor=a.size.factor):a&&e&&(c.vvSizeValue=b.transformation.scale);if(a&&e){c.vvSymbolAnchor=b.transformation.anchor;c.vvSymbolRotationMatrix=f.mat3f64.create();
n.mat4.identity(J);var g=b.transformation.rotation[2],e=b.transformation.rotation[0],k=b.transformation.rotation[1];b=J;void 0===b&&(b=d.mat4f64.create());g=g||0;e=e||0;k=k||0;0!==g&&n.mat4.rotateZ(b,b,-g/180*Math.PI);0!==e&&n.mat4.rotateX(b,b,e/180*Math.PI);0!==k&&n.mat4.rotateY(b,b,k/180*Math.PI);h.mat3.fromMat4(c.vvSymbolRotationMatrix,J)}a&&a.color&&(c.vvColorEnabled=!0,c.vvColorValues=a.color.values,c.vvColorColors=a.color.colors);a&&a.opacity&&(c.vvOpacityEnabled=!0,c.vvOpacityValues=a.opacity.values,
c.vvOpacityOpacities=a.opacity.opacityValues);return c}Object.defineProperty(a,"__esModule",{value:!0});a.evaluateModelTransformScale=a.evaluateModelTransform=a.getMaterialParams=a.updateFastSymbolUpdatesState=a.initFastSymbolUpdatesState=a.convertVisualVariables=void 0;a.convertVisualVariables=A;a.initFastSymbolUpdatesState=function(a,b){return!a||u.DISABLE_FAST_UPDATES?{enabled:!1}:(a=A(a.visualVariables,b))?{enabled:!0,visualVariables:a,materialParameters:I(a,b),requiresShaderTransformation:a&&
null!=a.size}:{enabled:!1}};a.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var d=a.visualVariables;b=A(b.visualVariables,c);if(!(b&&F(d.size,b.size,"size")&&F(d.color,b.color,"color")&&F(d.rotation,b.rotation,"rotation")&&F(d.opacity,b.opacity,"opacity")))return!1;a.visualVariables=b;a.materialParameters=I(b,c);a.requiresShaderTransformation=b&&null!=b.size;return!0};a.getMaterialParams=I;var G;(function(a){var e=d.mat4f64.create(),f=c.vec3f64.create();a.evaluateModelTransform=
function(a,b,c){if(!a.vvSizeEnabled)return c;n.mat4.copy(e,c);c=a.vvSymbolRotationMatrix;n.mat4.set(J,c[0],c[1],c[2],0,c[3],c[4],c[5],0,c[6],c[7],c[8],0,0,0,0,1);n.mat4.multiply(e,e,J);for(c=0;3>c;++c)f[c]=k.clamp(a.vvSizeOffset[c]+b[0]*a.vvSizeFactor[c],a.vvSizeMinSize[c],a.vvSizeMaxSize[c]);n.mat4.scale(e,e,f);n.mat4.translate(e,e,a.vvSymbolAnchor);return e};a.evaluateModelTransformScale=function(a,c,d){if(!c.vvSizeEnabled)return b.vec3.set(a,1,1,1);for(var e=0;3>e;++e)a[e]=k.clamp(c.vvSizeOffset[e]+
d[0]*c.vvSizeFactor[e],c.vvSizeMinSize[e],c.vvSizeMaxSize[e]);return a}})(G||(G={}));var J=d.mat4f64.create();a.evaluateModelTransform=G.evaluateModelTransform;a.evaluateModelTransformScale=G.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f64=void 0;a.mat3f64=e})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],
function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.createView=a.fromValues=a.clone=a.create=void 0;a.create=function(){return[1,0,0,0,1,0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]};a.fromValues=function(a,g,h,f,n,d,b,c,q){return[a,g,h,f,n,d,b,c,q]};a.createView=function(a,g){return new Float64Array(a,g,9)}})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(g,a,e){Object.defineProperty(a,
"__esModule",{value:!0});a.mat4f64=void 0;a.mat4f64=e})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(g,a){function e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.IDENTITY=a.createView=a.fromValues=a.clone=a.create=void 0;a.create=e;a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]};a.fromValues=function(a,e,f,g,d,b,c,q,u,t,r,m,v,l,w,p){return[a,
e,f,g,d,b,c,q,u,t,r,m,v,l,w,p]};a.createView=function(a,e){return new Float64Array(a,e,16)};a.IDENTITY=e()})},"esri/views/3d/support/debugFlags":function(){define(["require","exports","tslib","../../../core/Accessor","../../../core/accessorSupport/decorators"],function(g,a,e,k,h){return new (function(a){function f(){var d=null!==a&&a.apply(this,arguments)||this;d.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;d.SCENEVIEW_LOCKING_LOG=!1;d.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;d.HIGHLIGHTS_PROFILE_TO_CONSOLE=
!1;d.DECONFLICTOR_SHOW_VISIBLE=!1;d.DECONFLICTOR_SHOW_INVISIBLE=!1;d.DECONFLICTOR_SHOW_GRID=!1;d.LABELS_SHOW_BORDER=!1;d.OVERLAY_DRAW_DEBUG_TEXTURE=!1;d.OVERLAY_SHOW_CENTER=!1;d.SHOW_POI=!1;d.TERRAIN_DEBUG_POPUP=!1;d.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;d.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1;d.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1;d.DRAW_MESH_GEOMETRY_NORMALS=!1;d.FEATURE_TILE_FETCH_SHOW_TILES=!1;d.FEATURE_TILE_TREE_SHOW_TILES=!1;d.I3S_TREE_SHOW_TILES=!1;d.I3S_SHOW_MODIFICATIONS=!1;d.ENABLE_PROFILE_DEPTH_RANGE=
!1;d.DISABLE_FAST_UPDATES=!1;d.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;d.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;d.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return d}e.__extends(f,a);e.__decorate([h.property()],f.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);e.__decorate([h.property()],f.prototype,"SCENEVIEW_LOCKING_LOG",void 0);e.__decorate([h.property()],f.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);e.__decorate([h.property()],f.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",
void 0);e.__decorate([h.property()],f.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0);e.__decorate([h.property()],f.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0);e.__decorate([h.property()],f.prototype,"DECONFLICTOR_SHOW_GRID",void 0);e.__decorate([h.property()],f.prototype,"LABELS_SHOW_BORDER",void 0);e.__decorate([h.property()],f.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0);e.__decorate([h.property()],f.prototype,"OVERLAY_SHOW_CENTER",void 0);e.__decorate([h.property()],f.prototype,"SHOW_POI",
void 0);e.__decorate([h.property()],f.prototype,"TERRAIN_DEBUG_POPUP",void 0);e.__decorate([h.property()],f.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);e.__decorate([h.property()],f.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);e.__decorate([h.property()],f.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);e.__decorate([h.property()],f.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0);e.__decorate([h.property()],f.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);
e.__decorate([h.property()],f.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);e.__decorate([h.property()],f.prototype,"I3S_TREE_SHOW_TILES",void 0);e.__decorate([h.property()],f.prototype,"I3S_SHOW_MODIFICATIONS",void 0);e.__decorate([h.property()],f.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);e.__decorate([h.property()],f.prototype,"DISABLE_FAST_UPDATES",void 0);e.__decorate([h.property()],f.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0);e.__decorate([h.property()],f.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",
void 0);e.__decorate([h.property()],f.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return f=e.__decorate([h.subclass("esri.views.3d.support.DebugFlags")],f)}(k))})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["require","exports","./displayIdUtils","./StaticBitSet"],function(g,a,e,k){function h(a,e,d){if(!(a.length>e))for(;a.length<=e;)a.push(d)}Object.defineProperty(a,"__esModule",{value:!0});a.ComputedAttributeStorage=void 0;g=function(){function a(){this._numerics=
[];this._strings=[];this._idGenerator=new e.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}a.prototype.createBitset=function(){var a=this._bitsets.length;this._bitsets.push(k.StaticBitSet.create(this._allocatedSize,2147483647));return a+1};a.prototype.getBitset=function(a){return this._bitsets[a-1]};a.prototype._expand=function(){this._allocatedSize<<=1;for(var a=0,d=this._bitsets;a<d.length;a++)d[a].resize(this._allocatedSize)};a.prototype._ensureNumeric=
function(a,d){this._numerics[a]||(this._numerics[a]=[]);h(this._numerics[a],d,0)};a.prototype._ensureInstanceId=function(a){h(this._instanceIds,a,0)};a.prototype._ensureString=function(a,d){this._strings[a]||(this._strings[a]=[]);h(this._strings[a],d,null)};a.prototype.createDisplayId=function(a){void 0===a&&(a=!1);var d=this._idGenerator.createId();d>this._allocatedSize&&this._expand();return((a?2147483648:0)|d)>>>0};a.prototype.releaseDisplayId=function(a){for(var d=0,b=this._bitsets;d<b.length;d++)b[d].unset(a);
return this._idGenerator.releaseId(a&2147483647)};a.prototype.getComputedNumeric=function(a,d){return this.getComputedNumericAtIndex(a&2147483647,0)};a.prototype.setComputedNumeric=function(a,d,b){return this.setComputedNumericAtIndex(a&2147483647,b,0)};a.prototype.getComputedString=function(a,d){return this.getComputedStringAtIndex(a&2147483647,0)};a.prototype.setComputedString=function(a,d,b){return this.setComputedStringAtIndex(a&2147483647,0,b)};a.prototype.getComputedNumericAtIndex=function(a,
d){a&=2147483647;this._ensureNumeric(d,a);return this._numerics[d][a]};a.prototype.setComputedNumericAtIndex=function(a,d,b){a&=2147483647;this._ensureNumeric(d,a);this._numerics[d][a]=b};a.prototype.getInstanceId=function(a){a&=2147483647;this._ensureInstanceId(a);return this._instanceIds[a]};a.prototype.setInstanceId=function(a,d){a&=2147483647;this._ensureInstanceId(a);this._instanceIds[a]=d};a.prototype.getComputedStringAtIndex=function(a,d){a&=2147483647;this._ensureString(d,a);return this._strings[d][a]};
a.prototype.setComputedStringAtIndex=function(a,d,b){a&=2147483647;this._ensureString(d,a);this._strings[d][a]=b};a.prototype.getXMin=function(a){return this._bounds[4*(a&2147483647)]};a.prototype.getYMin=function(a){return this._bounds[4*(a&2147483647)+1]};a.prototype.getXMax=function(a){return this._bounds[4*(a&2147483647)+2]};a.prototype.getYMax=function(a){return this._bounds[4*(a&2147483647)+3]};a.prototype.setBounds=function(a,d){d=d.readHydratedGeometry();if(!d||!d.coords.length)return!1;var b=
Infinity,c=Infinity,e=-Infinity,f=-Infinity;d.forEachVertex(function(a,d){b=Math.min(b,a);c=Math.min(c,d);e=Math.max(e,a);f=Math.max(f,d)});a&=2147483647;h(this._bounds,4*a+4,0);this._bounds[4*a]=b;this._bounds[4*a+1]=c;this._bounds[4*a+2]=e;this._bounds[4*a+3]=f;return!0};return a}();a.ComputedAttributeStorage=g})},"esri/views/2d/layers/features/support/displayIdUtils":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.DisplayIdGenerator=a.getDisplayIdIndex=
a.getDisplayIdType=a.DISPLAY_ID_TYPE_AGGREGATE=a.DISPLAY_ID_TYPE_FEATURE=void 0;a.DISPLAY_ID_TYPE_FEATURE=0;a.DISPLAY_ID_TYPE_AGGREGATE=1;a.getDisplayIdType=function(a){return(a&2147483648)>>>31};a.getDisplayIdIndex=function(a){return a&2147483647};g=function(){function a(){this._freeIds=[];this._idCounter=1}a.prototype.createId=function(a){void 0===a&&(a=!1);var e=this._getFreeId();return((a?2147483648:0)|e)>>>0};a.prototype.releaseId=function(a){this._freeIds.push(a)};a.prototype._getFreeId=function(){return this._freeIds.length?
this._freeIds.pop():this._idCounter++};return a}();a.DisplayIdGenerator=g})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.StaticBitSet=void 0;g=function(){function a(a,e){this._mask=0;this._buf=a;this._mask=e}a.fromBuffer=function(e,g){return new a(e,g)};a.create=function(e,g){void 0===g&&(g=4294967295);e=new Uint32Array(Math.ceil(e/32));return new a(e,g)};a.prototype._getIndex=function(a){return Math.floor(a/
32)};a.prototype.has=function(a){a&=this._mask;return!!(this._buf[this._getIndex(a)]&1<<a%32)};a.prototype.set=function(a){a&=this._mask;var e=this._getIndex(a);this._buf[e]|=1<<a%32};a.prototype.unset=function(a){a&=this._mask;var e=this._getIndex(a);this._buf[e]&=4294967295^1<<a%32};a.prototype.resize=function(a){var e=this._buf;a=new Uint32Array(Math.ceil(a/32));a.set(e);this._buf=a};a.prototype.or=function(a){for(var e=0;e<this._buf.length;e++)this._buf[e]|=a._buf[e];return this};a.prototype.and=
function(a){for(var e=0;e<this._buf.length;e++)this._buf[e]&=a._buf[e];return this};a.prototype.xor=function(a){for(var e=0;e<this._buf.length;e++)this._buf[e]^=a._buf[e];return this};a.prototype.ior=function(a){for(var e=0;e<this._buf.length;e++)this._buf[e]|=~a._buf[e];return this};a.prototype.iand=function(a){for(var e=0;e<this._buf.length;e++)this._buf[e]&=~a._buf[e];return this};a.prototype.ixor=function(a){for(var e=0;e<this._buf.length;e++)this._buf[e]^=~a._buf[e];return this};a.prototype.any=
function(){for(var a=0;a<this._buf.length;a++)if(this._buf[a])return!0;return!1};a.prototype.copy=function(a){for(var e=0;e<this._buf.length;e++)this._buf[e]=a._buf[e];return this};a.prototype.clone=function(){return new a(this._buf.slice(),this._mask)};a.prototype.clear=function(){for(var a=0;a<this._buf.length;a++)this._buf[a]=0};a.prototype.forEachSet=function(a){for(var e=0;e<this._buf.length;e++){var f=this._buf[e],g=32*e;if(f)for(;f;)f&1&&a(g),f>>>=1,g++}};a.prototype.countSet=function(){var a=
0;this.forEachSet(function(e){a++});return a};return a}();a.StaticBitSet=g})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("require exports tslib ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.GraphicsReader=void 0;g=function(a){function b(b,d){return a.call(this,b,d,null)||this}e.__extends(b,a);
b.from=function(a){var c=f.FeatureSetReader.createInstance(),d=[],e=0;for(a=a.filter(function(a){return!!a.geometry});e<a.length;e++){var g=a[e],m=k.getJsonType(g.geometry);h.convertFromGraphics(d,[g],m,!1,!1,"uid")}return new b(c,d)};Object.defineProperty(b.prototype,"geometryType",{get:function(){var a=this._current;return a?a.geometryType:null},enumerable:!1,configurable:!0});b.prototype.readGraphic=function(){return this._current};b.prototype.getCursor=function(){return this.copy()};b.prototype.copy=
function(){var a=new b(this.instance,this._features);this.copyInto(a);return a};return b}(n.FeatureSetReaderJSON);a.GraphicsReader=g})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("require exports ../../../../../geometry ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureSetReader=void 0;
var n=0;g=function(){function a(a){this.type="FeatureSetReader";this._ty=this._tx=this.instance=0;this._xmin=-1;this._ymax=this._ymin=this._xmax=0;this._joined=[];this.instance=a}a.createInstance=function(){n++;return n=65535<n?0:n};Object.defineProperty(a.prototype,"_hasFilter",{get:function(){return-1!==this._xmin},enumerable:!1,configurable:!0});a.prototype.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};a.prototype.getStorage=function(){return this._storage};
a.prototype.getComputedNumeric=function(a){return this.getComputedNumericAtIndex(0)};a.prototype.setComputedNumeric=function(a,c){return this.setComputedNumericAtIndex(c,0)};a.prototype.getComputedString=function(a){return this.getComputedStringAtIndex(0)};a.prototype.setComputedString=function(a,c){return this.setComputedStringAtIndex(0,c)};a.prototype.getComputedNumericAtIndex=function(a){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),a)};a.prototype.setComputedNumericAtIndex=
function(a,c){this._storage.setComputedNumericAtIndex(this.getDisplayId(),a,c)};a.prototype.getComputedStringAtIndex=function(a){return this._storage.getComputedStringAtIndex(this.getDisplayId(),a)};a.prototype.setComputedStringAtIndex=function(a,c){return this._storage.setComputedStringAtIndex(this.getDisplayId(),a,c)};a.prototype.transform=function(a,c){var b=this.copy();b._tx=a;b._ty=c;return b};a.prototype.extent=function(a,c,d,e){var b=this.copy();b._xmin=a;b._xmax=d;b._ymin=c;b._ymax=e;return b};
a.prototype.hasFilter=function(){return this._hasFilter};a.prototype.readAttribute=function(a,c){void 0===c&&(c=!1);var b=this._readAttribute(a,c);if(void 0!==b)return b;for(var b=0,d=this._joined;b<d.length;b++){var e=d[b];e.setIndex(this.getIndex());e=e._readAttribute(a,c);if(void 0!==e)return e}};a.prototype.readAttributes=function(){return this._readAttributes()};a.prototype.joinAttributes=function(a){this._joined.push(a)};a.prototype.readArcadeFeature=function(){return this};a.prototype.geometry=
function(){var a=this.readHydratedGeometry(),a=h.convertToGeometry(a,this.geometryType,this.hasZ,this.hasM),a=e.fromJSON(a);a.spatialReference=this._arcadeSpatialReference;return a};a.prototype.field=function(a){return this.readAttribute(a,!0)};a.prototype.hasField=function(a){return!0};a.prototype.setField=function(a,c){};a.prototype.keys=function(){return[]};a.prototype.castToText=function(){return""};a.prototype._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;
var a=this.readUnquantizedGeometry();if(!a||a.hasIndeterminateRingOrder)return null;var c=this.getQuantizationTransform();return k.getCentroidOptimizedGeometry(new f.default,a,this.hasM,this.hasZ,c)};a.prototype.copyInto=function(a){a._storage=this._storage;a._arcadeSpatialReference=this._arcadeSpatialReference;a._joined=this._joined;a._tx=this._tx;a._ty=this._ty;a._xmin=this._xmin;a._xmax=this._xmax;a._ymin=this._ymin;a._ymax=this._ymax};return a}();a.FeatureSetReader=g})},"esri/layers/graphics/centroid":function(){define(["require",
"exports"],function(g,a){function e(a,e,g,d,b,c,k){void 0===k&&(k=1);c=b?c?4:3:c?3:2;var f=g,h=g+c,n=0,m=0,q=g=0,l=0,w=0;for(--d;w<d;w++,f+=c,h+=c){var p=e[f],y=e[f+1],z=e[f+2],C=e[h],B=e[h+1],E=e[h+2],x=p*B-C*y,q=q+x,n=n+(p+C)*x,m=m+(y+B)*x;b&&(x=p*E-C*z,g+=(z+E)*x,l+=x);p<a[0]&&(a[0]=p);p>a[1]&&(a[1]=p);y<a[2]&&(a[2]=y);y>a[3]&&(a[3]=y);b&&(z<a[4]&&(a[4]=z),z>a[5]&&(a[5]=z))}0<q*k&&(q*=-1);0<l*k&&(l*=-1);if(!q)return null;a=[n,m,.5*q];b&&(a[3]=g,a[4]=.5*l);return a}function k(a,e,g,d,b){b=d?b?4:
3:b?3:2;for(var c=e,f=e+b,h=0,k=0,n=0,m=0,v=0,l=g-1;v<l;v++,c+=b,f+=b){var w=a[c],p=a[c+1],y=a[c+2],z=a[f],C=a[f+1],B=a[f+2],E;if(d){E=z-w;var x=C-p,A=B-y;E=Math.sqrt(E*E+x*x+A*A)}else E=z-w,x=C-p,E=Math.sqrt(E*E+x*x);E&&(h+=E,d?(w=[w+.5*(z-w),p+.5*(C-p),y+.5*(B-y)],k+=E*w[0],n+=E*w[1],m+=E*w[2]):(w=[w+.5*(z-w),p+.5*(C-p)],k+=E*w[0],n+=E*w[1]))}return 0<h?d?[k/h,n/h,m/h]:[k/h,n/h]:0<g?d?[a[e],a[e+1],a[e+2]]:[a[e],a[e+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.lineCentroid=a.getCentroidOptimizedGeometry=
void 0;a.getCentroidOptimizedGeometry=function(a,f,g,d,b){if(!f||!f.lengths.length)return null;var c="upperLeft"===(null===b||void 0===b?void 0:b.originPosition)?-1:1;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);b=a.coords;for(var h=[],n=g?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],
t=f.lengths,r=f.coords,m=g?d?4:3:d?3:2,v=0,l=0;l<t.length;l++){var w=t[l],p=e(n,r,v,w,g,d,c);p&&h.push(p);v+=w*m}h.sort(function(a,b){var d=c*a[2]-c*b[2];0===d&&g&&(d=a[4]-b[4]);return d});h.length&&(m=6*h[0][2],b[0]=h[0][0]/m,b[1]=h[0][1]/m,g&&(m=6*h[0][4],b[2]=0!==m?h[0][3]/m:0),b[0]<n[0]||b[0]>n[1]||b[1]<n[2]||b[1]>n[3]||g&&(b[2]<n[4]||b[2]>n[5]))&&(b.length=0);if(!b.length)if(f=f.lengths[0]?k(r,0,t[0],g,d):null)b[0]=f[0],b[1]=f[1],g&&2<f.length&&(b[2]=f[2]);else return null;return a};a.lineCentroid=
k})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("require exports tslib ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader".split(" "),function(g,a,e,k,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureSetReaderJSON=void 0;g=function(a){function d(b,c,d){b=a.call(this,b)||this;b._featureIndex=-1;b._dateFields=new Set;b._geometryType=d;b._features=c;return b}e.__extends(d,a);
d.fromFeatures=function(a,c,e){e=h.convertFromFeatures([],a,c,!1,!1,e);for(var b=0;b<e.length;b++)e[b].displayId=a[b].displayId;return d.fromOptimizedFeatures(e,c)};d.fromFeatureSet=function(a,c){a=k.convertFromFeatureSet(a,c);return d.fromOptimizedFeatureSet(a)};d.fromOptimizedFeatureSet=function(a){var b=d.fromOptimizedFeatures(a.features,a.geometryType);b._exceededTransferLimit=a.exceededTransferLimit;b._transform=a.transform;var e=0;for(a=a.fields;e<a.length;e++){var f=a[e];"esriFieldTypeDate"===
f.type&&b._dateFields.add(f.name)}return b};d.fromOptimizedFeatures=function(a,c,e){var b=f.FeatureSetReader.createInstance();a=new d(b,a,c);a._transform=e;return a};Object.defineProperty(d.prototype,"_current",{get:function(){return this._features[this._featureIndex]},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"geometryType",{get:function(){return this._geometryType},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasFeatures",{get:function(){return!!this._features.length},
enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasNext",{get:function(){return this._featureIndex+1<this._features.length},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"exceededTransferLimit",{get:function(){return this._exceededTransferLimit},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasZ",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"hasM",{get:function(){return!1},enumerable:!1,configurable:!0});
d.prototype.getApproximateSize=function(){return this._features.length};d.prototype.getCursor=function(){return this.copy()};d.prototype.getQuantizationTransform=function(){return this._transform};d.prototype.getAttributeHash=function(){var a="",c;for(c in this._current.attributes)a+=this._current.attributes[c];return a};d.prototype.getIndex=function(){return this._featureIndex};d.prototype.setIndex=function(a){this._featureIndex=a};d.prototype.getObjectId=function(){return this._current.objectId};
d.prototype.getDisplayId=function(){return this._current.displayId};d.prototype.setDisplayId=function(a){this._current.displayId=a};d.prototype.getGroupId=function(){return this._current.groupId};d.prototype.setGroupId=function(a){this._current.groupId=a};d.prototype.copy=function(){var a=new d(this.instance,this._features,this.geometryType);this.copyInto(a);return a};d.prototype.next=function(){if(!this._hasFilter)return++this._featureIndex<this._features.length;for(;++this._featureIndex<this._features.length&&
!this._passesFilter(););return this._featureIndex<this._features.length};d.prototype.readLegacyFeature=function(){return k.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};d.prototype.readOptimizedFeature=function(){return this._current};d.prototype.readLegacyPointGeometry=function(){var a=this.readGeometry();return a?{x:a.coords[0],y:a.coords[1]}:null};d.prototype.readLegacyGeometry=function(){var a=this.readGeometry();return k.convertToGeometry(a,this.geometryType,this.hasZ,
this.hasM)};d.prototype.readLegacyCentroid=function(){var a=this.readCentroid();return a?{x:a.coords[0],y:a.coords[1]}:null};d.prototype.readGeometryArea=function(){return k.getQuantizedArea(this._current.geometry,2)};d.prototype.readUnquantizedGeometry=function(){var a=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!a)return a;for(var a=a.clone(),c=a.coords,d=0,e=0,f=a.lengths;e<f.length;e++){for(var g=f[e],h=1;h<g;h++)c[2*(d+h)]+=c[2*(d+h)-2],c[2*(d+h)+1]+=c[2*(d+h)-1];d+=g}return a};
d.prototype.readHydratedGeometry=function(){var a=this._current.geometry;if(!a)return null;a=a.clone();k.unquantizeOptimizedGeometry(a,a,this.hasZ,this.hasM,this._transform);return a};d.prototype.getXHydrate=function(){var a=this._current.geometry.coords[0]+this._tx,c=this.getQuantizationTransform();return a*c.scale[0]+c.translate[0]};d.prototype.getYHydrate=function(){var a=this._current.geometry.coords[1]+this._ty,c=this.getQuantizationTransform();return c.translate[1]-a*c.scale[1]};d.prototype.readGeometry=
function(){if(!this._current.hasGeometry)return null;var a=this._current.geometry.clone();if(a.isPoint)return a.coords[0]+=this._tx,a.coords[1]+=this._ty,a;for(var c=0,d=0,e=a.lengths;d<e.length;d++){var f=e[d];a.coords[2*c]+=this._tx;a.coords[2*c+1]+=this._ty;c+=f}return a};d.prototype.readCentroid=function(){if(!this._current.hasGeometry)return null;if(!this._current.centroid){var a=this._computeCentroid();if(!a)return null;a.coords[0]-=this._tx;a.coords[1]-=this._ty;this._current.centroid=a}a=
this._current.centroid.clone();a.coords[0]+=this._tx;a.coords[1]+=this._ty;return a};d.prototype._readAttribute=function(a,c){var b=this._current.attributes[a];if(void 0!==b)return c&&this._dateFields.has(a)?new Date(b):b;c=this.readAttributes();a=a.toLocaleLowerCase().trim();for(var d in c)if(d.toLocaleLowerCase().trim()===a)return a=this._current.attributes[d],this._dateFields.has(d)?new Date(a):a};d.prototype.copyInto=function(b){a.prototype.copyInto.call(this,b);b._featureIndex=this._featureIndex;
b._transform=this._transform;b._dateFields=this._dateFields};d.prototype._readAttributes=function(){return this._current.attributes};d.prototype._passesFilter=function(){var a;if(!this._hasFilter)return!0;var c=0;a=0;switch(this.geometryType){case "esriGeometryPoint":c=this._current.geometry;if(!c)return!1;a=c.coords;c=a[0];a=a[1];break;case "esriGeometryPolygon":c=this.readCentroid();if(!c)return!1;a=c.coords;c=a[0];a=a[1];c-=this._tx;a-=this._ty;break;default:return!1}return c>=this._xmin&&c<=this._xmax&&
a>=this._ymin&&a<=this._ymax?!0:!1};return d}(f.FeatureSetReader);a.FeatureSetReaderJSON=g})},"esri/views/2d/layers/features/support/TileStore":function(){define("require exports tslib ../../../../../core/Evented ../../../../../core/has ../../../../../core/libs/rbush/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),function(g,a,e,k,h,f,n,d,b){Object.defineProperty(a,"__esModule",{value:!0});var c={added:[],removed:[]},q=new Set,u=new b(0,0,0,0);g=function(a){function b(b){var c=
a.call(this)||this;c._tiles=new Map;c._index=f(9,h("csp-restrictions")?function(a){return{minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);c.tiles=[];c.tileScheme=b;return c}e.__extends(b,a);b.prototype.destroy=function(){this.clear()};b.prototype.clear=function(){this.tiles.length=0;this._tiles.clear();this._index.clear()};b.prototype.has=function(a){return this._tiles.has(a)};b.prototype.get=function(a){return this._tiles.get(a)};
b.prototype.findByKey=function(a){return this._tiles.get(a.id)};b.prototype.intersections=function(a,b){var c="string"===typeof a?this.get(a):a;if(!c)return[];var d=b*c.resolution;b=c.bounds[0]-d;a=c.bounds[1]-d;for(var e=c.bounds[2]+d,c=c.bounds[3]+d,d=[],f=0,g=this._index.search({minX:b,minY:a,maxX:e,maxY:c});f<g.length;f++){var h=g[f],k=h.bounds.slice();k[0]=Math.max(k[0],b);k[1]=Math.max(k[1],a);k[2]=Math.min(k[2],e);k[3]=Math.min(k[3],c);0<k[2]-k[0]&&0<k[3]-k[1]&&d.push({bounds:k,tile:h})}return d};
b.prototype.boundsIntersections=function(a){return this._index.search({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]})};b.prototype.updateTiles=function(a){for(var b=this,c={added:[],removed:[]},d=0,e=a.added;d<e.length;d++){var f=e[d];if(!this.has(f)){var g=new n.default(this.tileScheme,f);this._tiles.set(f,g);this._index.insert(g);c.added.push(g)}}d=0;for(a=a.removed;d<a.length;d++)f=a[d],this.has(f)&&(g=this.get(f),this._tiles.delete(f),this._index.remove(g),c.removed.push(g));this.tiles.length=0;this._tiles.forEach(function(a){return b.tiles.push(a)});
(c.added.length||c.removed.length)&&this.emit("update",c)};b.prototype.setViewState=function(a){if(a=this.tileScheme.getTileCoverage(a,0)){var b=a.spans,e=a.lodInfo,f=e.level;if(0<b.length)for(var g=0;g<b.length;g++)for(var h=b[g],k=h.row,m=h.colTo,r=h.colFrom;r<=m;r++){var t=u.set(f,k,e.normalizeCol(r),e.getWorldForColumn(r)).id;q.add(t);this.has(t)||(h=new n.default(this.tileScheme,t),this._tiles.set(t,h),this._index.insert(h),this.tiles.push(h),c.added.push(h))}for(b=this.tiles.length-1;0<=b;b--)h=
this.tiles[b],q.has(h.id)||(this._tiles.delete(h.id),this.tiles.splice(b,1),this._index.remove(h),c.removed.push(h));(c.added.length||c.removed.length)&&this.emit("update",c);d.pool.release(a);q.clear();c.added.length=0;c.removed.length=0}};return b}(k);a.default=g})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(g){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));
c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function e(a,b){k(a,0,a.children.length,b,a)}function k(a,b,c,d,e){e||(e=u(null));e.minX=Infinity;e.minY=Infinity;e.maxX=-Infinity;e.maxY=-Infinity;for(var f;b<c;b++)f=a.children[b],h(e,a.leaf?d(f):f);return e}function h(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function f(a,b){return a.minX-b.minX}function n(a,b){return a.minY-b.minY}
function d(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function b(a){return a.maxX-a.minX+(a.maxY-a.minY)}function c(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function q(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function u(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function t(a,b,c,d,e){for(var f=[b,c],h;f.length;)c=f.pop(),b=f.pop(),c-b<=d||(h=b+Math.ceil((c-b)/d/2)*d,g(a,h,b,c,e),
f.push(b,h,h,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,d=[],e=this.toBBox;if(!q(a,b))return d;for(var f=[],g,h,k,n;b;){g=0;for(h=b.children.length;g<h;g++)k=b.children[g],n=b.leaf?e(k):k,q(a,n)&&(b.leaf?d.push(k):c(a,n)?this._all(k,d):f.push(k));b=f.pop()}return d},collides:function(a){var b=this.data,d=this.toBBox;if(!q(a,b))return!1;for(var e=[],f,g,h,k;b;){f=0;for(g=b.children.length;f<g;f++)if(h=b.children[f],k=b.leaf?d(h):h,q(a,k)){if(b.leaf||
c(a,k))return!0;e.push(h)}b=e.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},
clear:function(){this.data=u([]);return this},remove:function(a,b){if(!a)return this;for(var d=this.data,e=this.toBBox(a),f=[],g=[],h,k,m,n;d||f.length;){d||(d=f.pop(),k=f[f.length-1],h=g.pop(),n=!0);if(d.leaf){a:{m=a;var q=d.children,r=b;if(r){for(var t=0;t<q.length;t++)if(r(m,q[t])){m=t;break a}m=-1}else m=q.indexOf(m)}if(-1!==m){d.children.splice(m,1);f.push(d);this._condense(f);break}}n||d.leaf||!c(d,e)?k?(h++,d=k.children[h],n=!1):d=null:(f.push(d),g.push(h),h=0,k=d,d=d.children[0])}return this},
toBBox:function(a){return a},compareMinX:f,compareMinY:n,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,d){var f=c-b+1,g=this._maxEntries,h;if(f<=g)return h=u(a.slice(b,c+1)),e(h,this.toBBox),h;d||(d=Math.ceil(Math.log(f)/Math.log(g)),g=Math.ceil(f/Math.pow(g,d-1)));h=u([]);h.leaf=!1;h.height=d;var f=Math.ceil(f/g),g=f*Math.ceil(Math.sqrt(g)),
k,l,m;for(t(a,b,c,g,this.compareMinX);b<=c;b+=g)for(l=Math.min(b+g-1,c),t(a,b,l,f,this.compareMinY),k=b;k<=l;k+=f)m=Math.min(k+f-1,l),h.children.push(this._build(a,k,m,d-1));e(h,this.toBBox);return h},_chooseSubtree:function(a,b,c,e){for(var f,g,h,k,l,m,n,q;;){e.push(b);if(b.leaf||e.length-1===c)break;n=q=Infinity;f=0;for(g=b.children.length;f<g;f++)h=b.children[f],l=d(h),m=(Math.max(h.maxX,a.maxX)-Math.min(h.minX,a.minX))*(Math.max(h.maxY,a.maxY)-Math.min(h.minY,a.minY))-l,m<q?(q=m,n=l<n?l:n,k=h):
m===q&&l<n&&(n=l,k=h);b=k||b.children[0]}return b},_insert:function(a,b,c){var d=this.toBBox;c=c?a:d(a);var d=[],e=this._chooseSubtree(c,this.data,b,d);e.children.push(a);for(h(e,c);0<=b;)if(d[b].children.length>this._maxEntries)this._split(d,b),b--;else break;this._adjustParentBBoxes(c,d,b)},_split:function(a,b){var c=a[b],d=c.children.length,f=this._minEntries;this._chooseSplitAxis(c,f,d);d=this._chooseSplitIndex(c,f,d);d=u(c.children.splice(d,c.children.length-d));d.height=c.height;d.leaf=c.leaf;
e(c,this.toBBox);e(d,this.toBBox);b?a[b-1].children.push(d):this._splitRoot(c,d)},_splitRoot:function(a,b){this.data=u([a,b]);this.data.height=a.height+1;this.data.leaf=!1;e(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var e,f,g,h,m,n,q;m=n=Infinity;for(e=b;e<=c-b;e++)f=k(a,0,e,this.toBBox),g=k(a,e,c,this.toBBox),h=Math.max(0,Math.min(f.maxX,g.maxX)-Math.max(f.minX,g.minX))*Math.max(0,Math.min(f.maxY,g.maxY)-Math.max(f.minY,g.minY)),f=d(f)+d(g),h<m?(m=h,q=e,n=f<n?f:n):h===m&&f<n&&(n=
f,q=e);return q},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:f,e=a.leaf?this.compareMinY:n,g=this._allDistMargin(a,b,c,d);b=this._allDistMargin(a,b,c,e);g<b&&a.children.sort(d)},_allDistMargin:function(a,c,d,e){a.children.sort(e);e=this.toBBox;var f=k(a,0,c,e),g=k(a,d-c,d,e),l=b(f)+b(g),m,n;for(m=c;m<d-c;m++)n=a.children[m],h(f,a.leaf?e(n):n),l+=b(f);for(m=d-c-1;m>=c;m--)n=a.children[m],h(g,a.leaf?e(n):n),l+=b(g);return l},_adjustParentBBoxes:function(a,b,c){for(;0<=c;c--)h(b[c],
a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():e(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],
function(){function g(e,h,f,n,d){for(;n>f;){if(600<n-f){var b=n-f+1,c=h-f+1,k=Math.log(b),u=.5*Math.exp(2*k/3),k=.5*Math.sqrt(k*u*(b-u)/b)*(0>c-b/2?-1:1);g(e,h,Math.max(f,Math.floor(h-c*u/b+k)),Math.min(n,Math.floor(h+(b-c)*u/b+k)),d)}b=e[h];c=f;u=n;a(e,f,h);for(0<d(e[n],b)&&a(e,f,n);c<u;){a(e,c,u);c++;for(u--;0>d(e[c],b);)c++;for(;0<d(e[u],b);)u--}0===d(e[f],b)?a(e,f,u):(u++,a(e,u,n));u<=h&&(f=u+1);h<=u&&(n=u-1)}}function a(a,e,f){var g=a[e];a[e]=a[f];a[f]=g}function e(a,e){return a<e?-1:a>e?1:0}
return function(a,h,f,n,d){g(a,h,f||0,n||a.length-1,d||e)}})},"esri/views/2d/layers/features/support/Tile":function(){define("require exports ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),function(g,a,e,k,h,f,n){function d(a,c){var b=a.bounds,d=c.bounds;return a.key.id!==c.key.id&&a.key.world===c.key.world&&b[0]<=d[0]&&b[1]<=d[1]&&b[2]>=d[2]&&b[3]>=
d[3]}Object.defineProperty(a,"__esModule",{value:!0});a.Tile=a.isChildOf=a.isParentOf=void 0;a.isParentOf=d;a.isChildOf=function(a,c){return d(c,a)};g=function(){function a(a,b){this.key=new n(0,0,0,0);this.bounds=h.create();this.objectIds=new Set;this.key.set(b);b=a.getLODInfoAt(this.key);this.tileInfoView=a;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=b.resolution;this.scale=b.scale;this.level=b.level;this.needsClear=!0}Object.defineProperty(a.prototype,"id",{get:function(){return this.key.id},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"extent",{get:function(){return k.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"bbox",{get:function(){var a=this.bounds;return{minX:a[0],
minY:a[1],maxX:a[2],maxY:a[3]}},enumerable:!1,configurable:!0});a.prototype.clone=function(){return new a(this.tileInfoView,this.key)};a.prototype.neighbor=function(b,d){var c=this.key.clone(),e=1<<c.level;b=c.col+b;d=c.row+d;0>b?(c.col=b+e,--c.world):b>=e?(c.col=b-e,c.world+=1):c.col=b;c.row=d;return new a(this.tileInfoView,c)};a.prototype.createChildTiles=function(){for(var b=this.key.getChildKeys(),d=e.acquire(),f=0;f<b.length;f++)d[f]=new a(this.tileInfoView,b[f]);return d};a.prototype.getQuantizationParameters=
function(){return f.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};return a}();a.Tile=g;a.default=g})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["require","exports","tslib","../../engine/FeatureContainer"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function f(){return null!==
a&&a.apply(this,arguments)||this}e.__extends(f,a);Object.defineProperty(f.prototype,"hasLabels",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(f.prototype,"labelsVisible",{get:function(){return!1},enumerable:!1,configurable:!0});f.prototype._renderGraphics=function(a,d){for(var b=0,c=this.children;b<c.length;b++){var e=c[b];e.isReady&&e.hasData&&(e.commitChanges(a),a.context.setStencilFunction(514,e.stencilRef,255),e._displayList.replay(a,e,d))}};f.prototype.renderChildren=
function(e){var d=e.painter;this.children.some(function(a){return a.hasData})&&(a.prototype.renderChildren.call(this,e),this._renderGraphics(e),d=d.effects.highlight,d.bind(e),this._renderGraphics(e,d.defines),d.draw(e),d.unbind())};return f}(k.FeatureContainer);a.default=g})},"esri/views/2d/engine/FeatureContainer":function(){define("require exports tslib ../../../core/promiseUtils ../../../core/promiseUtils ../../../core/Queue ../../../geometry/support/aaBoundingRect ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/TileData ./webgl/WGLRendererInfo ./webgl/WGLTile".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u){Object.defineProperty(a,"__esModule",{value:!0});a.FeatureContainer=void 0;g=function(a){function b(b){b=a.call(this,b)||this;b._rendererInfo=new q.WGLRendererInfo;b._materialItemsRequestQueue=new f.default;b.attributeView=new d.AttributeStoreView;return b}e.__extends(b,a);b.prototype.destroy=function(){this.removeAllChildren();this.children.forEach(function(a){return a.destroy()});this.attributeView.destroy();this._materialItemsRequestQueue.clear()};b.prototype.setRendererInfo=
function(a,b,c){this._rendererInfo.setInfo(a,b,c);this.requestRender()};b.prototype.getMaterialItems=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c;return e.__generator(this,function(d){if(!a||0===a.length)return[2,null];c=k.createResolver();this._materialItemsRequestQueue.push({items:a,abortOptions:b,resolver:c});this.requestRender();return[2,c.promise]})})};b.prototype.onTileData=function(a,b){if(!(b.addOrUpdate&&"tileDisplayData"in b.addOrUpdate)){var d=b.addOrUpdate&&c.TileData.decode(b.addOrUpdate);
b=e.__assign(e.__assign({},b),{addOrUpdate:d})}a.setData(b);this.contains(a)||this.addChild(a);this.requestRender()};b.prototype.onTileError=function(a){a.clear();this.contains(a)||this.addChild(a)};b.prototype.doRender=function(b){b.context.capabilities.textureFloat;b.context.capabilities.vao;if(0<this._materialItemsRequestQueue.length)for(var c=this._materialItemsRequestQueue.pop();c;)this._processMaterialItemRequest(b,c),c=this._materialItemsRequestQueue.pop();a.prototype.doRender.call(this,b)};
b.prototype.renderChildren=function(b){for(var c=0,d=this.children;c<d.length;c++)d[c].commitChanges(b);this._rendererInfo.update(b.state);this.attributeView.bindTextures(b.context);a.prototype.renderChildren.call(this,b)};b.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(n.create(),a);return new u.WGLTile(a,b)};b.prototype.destroyTile=function(a){this.removeChild(a);a.destroy()};b.prototype.createRenderParams=function(b){return e.__assign(e.__assign({},a.prototype.createRenderParams.call(this,
b)),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})};b.prototype._processMaterialItemRequest=function(a,b){var c=this,d=b.items,e=b.abortOptions,f=b.resolver,g=a.painter,k=a.pixelRatio;a=d.map(function(a){return g.textureManager.rasterizeItem(a.symbol,k,a.glyphIds,e)});h.all(a).then(function(a){c.stage?(a=a.map(function(a,b){return{id:d[b].id,mosaicItem:a}}),f.resolve(a)):f.reject()},f.reject)};return b}(b.default);a.FeatureContainer=g})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports tslib ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t){Object.defineProperty(a,"__esModule",{value:!0});a.AttributeStoreView=void 0;var r=f.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),m=u.createDebugLogger(u.DEBUG_ATTR_UPDATES,r),v=function(){function a(a,b,c){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var d=a.buffer,e=a.pixelType;a=a.textureOnly;var f=q.getPixelArrayCtor(e);this.shared=c;this.pixelType=e;this.size=b;this.textureOnly=a;a||(this.data=new f(n.unwrap(d)));this._resetRange()}
a.prototype.destroy=function(){n.andThen(this._texture,function(a){return a.dispose()});var a=function(a){n.andThen(b._fbos[a],function(b){"0"===a&&b.detachColorTexture();b.dispose()});b._fbos[a]=null},b=this,c;for(c in this._fbos)a(c);this._texture=null};Object.defineProperty(a.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!1,configurable:!0});a.prototype.setData=
function(a,b,c){a&=2147483647;var d=n.unwrap(this.data);b=a*this.texelSize+b;!d||b>=d.length||(d[b]=c,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.getData=function(a,b){if(n.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+b;return!this.data||a>=this.data.length?null:this.data[a]};a.prototype.getTexture=function(a){var b=this;return n.unwrapOr(this._texture,function(){return b._initTexture(a)})};a.prototype.getFBO=function(a,b){void 0===
b&&(b=0);if(n.isNone(this._fbos[b])){var c=0===b?this.getTexture(a):this._textureDesc;this._fbos[b]=new t(a,{colorTarget:0,depthStencilTarget:0},c)}return this._fbos[b]};Object.defineProperty(a.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&h("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!1,configurable:!0});a.prototype.updateTexture=function(a){if(!this.locked)try{var b=this.dirtyStart,c=this.dirtyEnd;if(!(b>c)){this._resetRange();
var d=n.unwrap(this.data).buffer,e=this.getTexture(a),f=(b-b%this.size)/this.size,g=(c-c%this.size)/this.size,h=f*this.size*4,l=4*(this.size+g*this.size)-h,m=q.getPixelArrayCtor(this.pixelType),t=m.BYTES_PER_ELEMENT;try{new m(d,h*t,l)}catch(H){console.debug(H)}var v=new m(d,h*t,l),u=this.size;a=g-f+1;a>this.size?r.error(new k("mapview-webgl","Out-of-bounds index when updating AttributeData")):e.updateData(0,0,f,u,a,v)}}catch(H){console.debug(H)}};a.prototype.update=function(a){var b=a.data,c=a.start,
d=a.end;if(n.isSome(b))for(var e=this.data,f=c*this.texelSize,g=0;g<b.length;g++)a.layout&1<<g%this.texelSize&&(e[f+g]=b[g]);this.dirtyStart=Math.min(this.dirtyStart,c);this.dirtyEnd=Math.max(this.dirtyEnd,d)};a.prototype.resize=function(a,b){var c=this.size;this.size=b;this.textureOnly?c!==this.size&&(this._lastTexture=this._texture,this._texture=null):(b=q.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new b(n.unwrap(a.buffer)))};a.prototype._resetRange=function(){this.dirtyStart=2147483647;
this.dirtyEnd=0};a.prototype._initTexture=function(a){var c=new b.Texture(a,this._textureDesc,n.unwrapOr(this.data,void 0));if(n.isSome(this._lastTexture)&&this._fbos[0]){var d=this._lastTexture.descriptor.width,e=this._lastTexture.descriptor.height,f=this._lastTexture.descriptor.dataType,g=this._lastTexture.descriptor.pixelFormat,h=this.getFBO(a),k=q.getPixelBytes(f),l=q.getPixelArrayCtor(f),k=new ArrayBuffer(d*e*k*this.texelSize),l=new l(k),k=a.getBoundFramebufferObject(),m=a.getViewport(),r=m.x,
t=m.y,v=m.width,m=m.height;a.bindFramebuffer(h);h.readPixels(0,0,d,e,g,f,l);c.updateData(0,0,0,2*d,e/2,l);a.setViewport(r,t,v,m);a.bindFramebuffer(k)}this.destroy();return this._texture=c};return a}();g=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var b=a.blocks,c=a.shared,d=a.size;this.shared=c;this.size=d;m("Initializing AttributeStoreView",a);if(n.isNone(this._data))this._data=n.mapMany(b,function(a){return new v(a,d,c)});else for(a=
0;a<this._data.length;a++){var e=this._data[a],f=b[a];n.isSome(f)&&(n.isNone(e)?this._data[a]=new v(f,d,c):e.resize(f,d))}this._initialized=!0};a.prototype.destroy=function(){n.andThen(this._data,function(a){return n.mapMany(a,function(a){return a.destroy()})});n.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return n.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,b){this.setData(a,0,1,b)};a.prototype.getLabelMinZoom=
function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,c.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,b,c,d){if(!this._data)return 0;b=n.unwrap(this._data)[b];if(n.isNone(b))return 0;a=b.getData(a,c);return n.isSome(a)?a:d};a.prototype.setData=function(a,b,c,d){b=n.unwrap(this._data)[b];n.unwrap(b).setData(a,c,d)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=
function(){this._locked=!1};a.prototype.forceTextureUpload=function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){if(this._pendingAttributeUpdate)return r.error(new k("mapview-webgl","Tried to update attribute data with a pending update")),[2];b=d.createResolver();m("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:b};return[2,b.promise]})})};a.prototype.update=
function(){if(this._initialized&&n.isSome(this._pendingAttributeUpdate)){for(var a=this._pendingAttributeUpdate,b=a.data,a=a.resolver,c=n.unwrap(this._data),d=function(a){var d=b.blocks[a];n.andThen(c[a],function(b){return n.andThen(d,function(c){m("Updating block "+a,c);b.update(c)})})},e=0;e<b.blocks.length;e++)d(e);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var b=this._getDefaultTexture(a);if(this._initialized){var d=n.unwrap(this._data);if(!this._locked||
this._forceNextUpload)n.forEachSome(d,function(b){return b.updateTexture(a)}),this._forceNextUpload=!1;a.bindTexture(n.mapOr(d[0],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(n.mapOr(d[1],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(n.mapOr(d[2],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(n.mapOr(d[3],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(b,
c.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(b,c.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(b,c.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(b,c.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){n.isNone(this._defaultTexture)&&(this._defaultTexture=new b.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();a.AttributeStoreView=g})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports tslib ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),
function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.sortByLevel=void 0;a.sortByLevel=function(a,b){return 0!==a.key.level-b.key.level?a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:a.key.col-b.key.col};g=function(d){function b(a){var b=d.call(this)||this;b._tileInfoView=a;return b}e.__extends(b,d);b.prototype.renderChildren=function(b){this.sortChildren(a.sortByLevel);this.setStencilReference();d.prototype.renderChildren.call(this,b)};b.prototype.createRenderParams=
function(a){var b=a.state;return e.__assign(e.__assign({},d.prototype.createRenderParams.call(this,a)),{requiredLevel:this._tileInfoView.getClosestInfoForScale(b.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(b.scale)})};b.prototype.prepareRenderPasses=function(a){var b=this,c=a.registerRenderPass({name:"stencil",brushes:[n.default],drawPhase:k.WGLDrawPhase.DEBUG|k.WGLDrawPhase.MAP,target:function(){return b.getStencilTarget()}}),g=a.registerRenderPass({name:"tileInfo",brushes:[f.default],
drawPhase:k.WGLDrawPhase.DEBUG,target:function(){return b.children},has:"esri-tiles-debug"});return e.__spreadArrays(d.prototype.prepareRenderPasses.call(this,a),[c,g])};b.prototype.getStencilTarget=function(){return this.children};b.prototype.updateTransforms=function(a){for(var b=0,c=this.children;b<c.length;b++){var d=c[b],e=this._tileInfoView.getTileResolution(d.key);d.setTransform(a,e)}};b.prototype.setStencilReference=function(){for(var a=1,b=0,d=this.children;b<d.length;b++)d[b].stencilRef=
a++};return b}(h.default);a.default=g})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports tslib ../../../../core/has ../../../../core/maybe ../brushes ../Container ./ClippingInfo ./enums".split(" "),function(g,a,e,k,h,f,n,d,b){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.name=b.constructor.name;return b}e.__extends(c,a);Object.defineProperty(c.prototype,"clips",{set:function(a){this._clips=a;
this.children.forEach(function(b){return b.clips=a});this._updateClippingInfo()},enumerable:!1,configurable:!0});c.prototype.doRender=function(a){this.updateTransitionProperties(a.deltaTime);var c=this.createRenderParams(a),d=c.painter,e=c.globalOpacity,f=c.profiler,e=c.drawPhase===b.WGLDrawPhase.LABEL?1:e*this.computedOpacity;f.recordContainerStart(this.name);d.beforeRenderLayer(c,this._clippingInfos?255:0,e);this.updateTransforms(a.state);this.renderChildren(c);d.compositeLayer(c,e);f.recordContainerEnd()};
c.prototype.renderChildren=function(a){h.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(a.painter));for(var b=0,c=this._renderPasses;b<c.length;b++){var d=c[b];try{d.render(a)}catch(v){}}};c.prototype.createRenderParams=function(a){return a};c.prototype.prepareRenderPasses=function(a){var c=this;return[a.registerRenderPass({name:"clip",brushes:[f.brushes.clip],target:function(){return c._clippingInfos},drawPhase:b.WGLDrawPhase.MAP|b.WGLDrawPhase.LABEL|b.WGLDrawPhase.LABEL_ALPHA|
b.WGLDrawPhase.DEBUG})]};c.prototype.updateTransforms=function(a){for(var b=0,c=this.children;b<c.length;b++)c[b].setTransform(a)};c.prototype.onAttach=function(){a.prototype.onAttach.call(this);this._updateClippingInfo()};c.prototype.onDetach=function(){a.prototype.onDetach.call(this);this._updateClippingInfo()};c.prototype._updateClippingInfo=function(){var a=this;h.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(a){return a.destroy()}),this._clippingInfos=null);if(this.stage){var b=
this._clips;h.isSome(b)&&b.length&&(this._clippingInfos=b.items.map(function(b){return d.default.fromClipArea(a.stage,b)}));this.requestRender()}};return c}(n.Container);a.default=g})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),function(g,a,e,k,h,f,n,d,b){Object.defineProperty(a,"__esModule",{value:!0});var c=h.getLogger("esri.views.2d.engine.webgl.ClippingInfo");
g=function(a){function g(b,c){var d=a.call(this)||this;d._clip=c;d._cache={};d.stage=b;d._handle=c.watch("version",function(){return d._invalidate()});d.ready();return d}e.__extends(g,a);g.fromClipArea=function(a,b){return new g(a,b)};g.prototype._destroyGL=function(){f.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);f.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};g.prototype.destroy=function(){this._destroyGL();this._handle.remove()};g.prototype.getVAO=
function(a,c,d,e){var g=c.size,h=g[0],g=g[1];if("geometry"===this._clip.type||this._lastWidth!==h||this._lastHeight!==g)this._lastWidth=h,this._lastHeight=g,this._destroyGL();f.isNone(this._cache.vao)&&(c=this._createMesh(c,this._clip),h=c.getIndexBuffer(a),g=c.getVertexBuffers(a),this._cache.mesh=c,this._cache.vao=new b(a,d,e,g,h));return this._cache.vao};g.prototype._invalidate=function(){this._destroyGL();this.requestRender()};g.prototype._createScreenRect=function(a,b){var c=a.size;a=c[0];var c=
c[1],d="string"===typeof b.left?parseFloat(b.left)/100*a:b.left,e="string"===typeof b.right?parseFloat(b.right)/100*a:b.right,f="string"===typeof b.top?parseFloat(b.top)/100*c:b.top;b="string"===typeof b.bottom?parseFloat(b.bottom)/100*c:b.bottom;return{x:d,y:f,width:Math.max(a-e-d,0),height:Math.max(c-b-f,0)}};g.prototype._createMesh=function(a,b){switch(b.type){case "rect":return d.default.fromRect(this._createScreenRect(a,b));case "path":return d.default.fromPath(b);case "geometry":return d.default.fromGeometry(a,
b);default:return c.error(new k("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),d.default.fromRect({x:0,y:0,width:1,height:1})}};return g}(n.DisplayObject);a.default=g})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports tslib ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t){Object.defineProperty(a,"__esModule",{value:!0});var r=h.getLogger("esri.views.2d.engine.webgl.Mesh2D"),m=function(a,b){var c=a.coords;a=a.lengths;for(var d=[],e=0,f=0;e<a.length;f+=a[e],e+=1){for(var g=f,h=[];e<a.length-1;e+=1,f+=a[e]){for(var k=f+a[e],l=0,m=1;m<a[e+1];m++)l+=(c[2*(k+m)]-c[2*(k+m-1)])*(c[2*(k+m)+1]+c[2*(k+m-1)+1]);if(!(b?0<l:0>l))break;h.push(f+a[e]-g)}l=c.slice(2*g,2*(f+a[e]));k=0;for(h=n.earcut(l,h,2);k<h.length;k++)d.push(h[k]+g)}return d};
g=function(){function a(a,b,c,d){void 0===d&&(d=!1);this._cache={};this.vertices=a;this.indices=b;this.primitiveType=c;this.isMapSpace=d}a.fromRect=function(b){var c=b.x,d=b.y;return a.fromScreenExtent({xmin:c,ymin:d,xmax:c+b.width,ymax:d+b.height})};a.fromPath=function(b){var d=c.convertFromNestedArray(new q.default,b.path,!1,!1);b=d.coords;for(var d=new Uint32Array(m(d,!0)),e=new Uint32Array(b.length/2),f=0;f<e.length;f++)e[f]=u.i1616to32(Math.floor(b[2*f]),Math.floor(b[2*f+1]));return new a({geometry:e},
d,4)};a.fromGeometry=function(b,c){var d=c.geometry.type;switch(d){case "polygon":return a.fromPolygon(b,c.geometry);case "extent":return a.fromMapExtent(b,c.geometry);default:return r.error(new k("mapview-bad-type","Unable to create a mesh from type "+d,c)),a.fromRect({x:0,y:0,width:1,height:1})}};a.fromPolygon=function(e,f){var g=c.convertFromPolygon(new q.default,f,!1,!1);f=g.coords;for(var g=new Uint32Array(m(g,!1)),h=new Uint32Array(f.length/2),k=b.vec2f64.create(),l=b.vec2f64.create(),n=0;n<
h.length;n++)d.vec2.set(k,f[2*n],f[2*n+1]),e.toScreen(l,k),h[n]=u.i1616to32(Math.floor(l[0]),Math.floor(l[1]));return new a({geometry:h},g,4,!0)};a.fromScreenExtent=function(b){var c=b.xmin,d=b.xmax,e=b.ymin;b=b.ymax;c={geometry:new Uint32Array([u.i1616to32(c,e),u.i1616to32(d,e),u.i1616to32(c,b),u.i1616to32(c,b),u.i1616to32(d,e),u.i1616to32(d,b)])};d=new Uint32Array([0,1,2,3,4,5]);return new a(c,d,4)};a.fromMapExtent=function(b,c){var d=b.toScreen([0,0],[c.xmin,c.ymin]),e=d[0],d=d[1];c=b.toScreen([0,
0],[c.xmax,c.ymax]);b=c[0];c=c[1];e={geometry:new Uint32Array([u.i1616to32(e,d),u.i1616to32(b,d),u.i1616to32(e,c),u.i1616to32(e,c),u.i1616to32(b,d),u.i1616to32(b,c)])};d=new Uint32Array([0,1,2,3,4,5]);return new a(e,d,4)};a.prototype.destroy=function(){f.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var a in this._cache.vertexBuffers)f.isSome(this._cache.vertexBuffers[a])&&this._cache.vertexBuffers[a].dispose()};Object.defineProperty(a.prototype,"elementType",{get:function(){var a;
a:switch(this.indices.BYTES_PER_ELEMENT){case 1:a=5121;break a;case 2:a=5123;break a;case 4:a=5125;break a;default:throw new k("Cannot get DataType of array");}return a},enumerable:!1,configurable:!0});a.prototype.getIndexBuffer=function(a,b){void 0===b&&(b=35044);this._cache.indexBuffer||(this._cache.indexBuffer=t.createIndex(a,b,this.indices));return this._cache.indexBuffer};a.prototype.getVertexBuffers=function(a,b){var c=this;void 0===b&&(b=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=
Object.keys(this.vertices).reduce(function(d,f){var g;return e.__assign(e.__assign({},d),(g={},g[f]=t.createVertex(a,b,c.vertices[f]),g))},{}));return this._cache.vertexBuffers};return a}();a.default=g})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q){function u(a,b){var c=b.length;if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}function t(a,b,c){void 0===c&&(c=0);if(h.isNone(b))a[c+0]=0,a[c+1]=0,a[c+2]=0,a[c+3]=0;else{var d=b.g,e=b.b,f=b.a;a[c+0]=b.r*f/255;a[c+1]=d*f/255;a[c+2]=e*f/255;a[c+3]=f}}Object.defineProperty(a,"__esModule",{value:!0});a.WGLRendererInfo=void 0;var r=function(a,
b,c){for(var d=c*=16,e=0;d<Math.min(c+16,a.length);d++,e++)a[d]=b[e]},m=d.mat4f32.create();g=function(){function a(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*c.MAX_FILTERS);
this.insideOpacity=1;this.outsideEffect=new Float32Array(16*c.MAX_FILTERS);this.outsideOpacity=1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<c.MAX_FILTERS;a++)r(this.insideEffect,m,a),r(this.outsideEffect,m,a)}Object.defineProperty(a.prototype,"insideOpacities",{get:function(){this._buf0[0]=
1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!1,configurable:!0});a.prototype.getSizeVVFieldStops=function(a){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return h.unwrapOr(b.levels[a],function(){var c=Infinity,d=0,e;for(e in b.levels){var f=parseFloat(e),g=Math.abs(a-
f);g<c&&(c=g,d=f)}if(Infinity===c)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};c=Math.pow(2,(a-d)/2);d=h.unwrap(b.levels[d]);e=new Float32Array(d.values);e[2]*=c;e[3]*=c;return{sizes:h.unwrap(d.sizes),values:e}})}};Object.defineProperty(a.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!1,configurable:!0});a.prototype.update=function(a){h.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,a)};
a.prototype.setInfo=function(a,b,c){var d=this;h.isSome(c)?(c.forEach(function(a,b){return d._updateEffects(b,a)}),this.effectCount=c.length):this.effectCount=0;this._vvInfo=b;switch(a.type){case "dot-density":this._updateDotDensityInfo(a)}};a.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:k("esri-webgl-texture-float")}};a.prototype.getVariationHash=function(){return(this.ddDotBlending?
1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};a.prototype._updateEffects=function(a,b){a+=1;if(h.isSome(b)&&b.filter&&b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var c=b.parsedIncludedEffect;b=b.parsedExcludedEffect;h.isSome(c)?(r(this.insideEffect,c.getColorMatrix(),a),this.insideOpacity=c.getOpacity()):(r(this.insideEffect,m,a),this.insideOpacity=1);h.isSome(b)?(r(this.outsideEffect,b.getColorMatrix(),a),this.outsideOpacity=b.getOpacity()):(r(this.outsideEffect,
m,a),this.outsideOpacity=1)}else r(this.insideEffect,m,a),r(this.outsideEffect,m,a),this.outsideOpacity=this.insideOpacity=1};a.prototype._updateVisualVariables=function(a,c){var d=this._vvMaterialParameters;d.vvOpacityEnabled=!1;d.vvSizeEnabled=!1;d.vvColorEnabled=!1;d.vvRotationEnabled=!1;if(a){var e=a.size;if(e){d.vvSizeEnabled=!0;if(e.minMaxValue){var g=e.minMaxValue,h=void 0,k=void 0;q.isDefined(g.minSize)&&q.isDefined(g.maxSize)&&(q.isNumber(g.minSize)&&q.isNumber(g.maxSize)?(h=f.pt2px(g.minSize),
k=f.pt2px(g.maxSize)):(k=c.scale,h=f.pt2px(u(k,g.minSize.stops)),k=f.pt2px(u(k,g.maxSize.stops))));this.vvSizeMinMaxValue.set([g.minDataValue,g.maxDataValue,h,k])}e.scaleStops&&(this.vvSizeScaleStopsValue=f.pt2px(u(c.scale,e.scaleStops.stops)));e.unitValue&&(this.vvSizeUnitValueToPixelsRatio=n.getMetersPerUnitForSR(c.spatialReference)/b.meterIn[e.unitValue.unit]/c.resolution);e.fieldStops&&(this._vvSizeFieldStops=e.fieldStops)}if(c=a.color)d.vvColorEnabled=!0,this.vvColorValues.set(c.values),this.vvColors.set(c.colors);
if(c=a.opacity)d.vvOpacityEnabled=!0,this.vvOpacityValues.set(c.values),this.vvOpacities.set(c.opacities);if(a=a.rotation)d.vvRotationEnabled=!0,d.vvRotationType=a.type}};a.prototype._updateDotDensityInfo=function(a){var b=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var d=0;d<c.DOT_DENSITY_MAX_FIELDS;d++){var f=d>=b.length?new e([0,0,0,0]):b[d].color;t(this.ddColors,f,4*d)}for(d=0;8>
d;d++)this.ddActiveDots[d]=d<a.attributes.length?1:0;t(this.ddBackgroundColor,a.backgroundColor)};return a}();a.WGLRendererInfo=g})},"esri/views/2d/layers/graphics/GraphicProcessingQueue":function(){define("require exports tslib ../../../../core/Accessor ../../../../core/promiseUtils ../../../../core/scheduling ../../../../core/accessorSupport/decorators".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function b(b){b=a.call(this,b)||this;b._queue=
new Map;b._queueArray=[];b._onGoingGraphic=null;b._onGoingPromise=null;b._scheduledNextHandle=null;b._next=b._next.bind(b);b._finalize=b._finalize.bind(b);return b}e.__extends(b,a);Object.defineProperty(b.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"updating",{get:function(){return 0<this._queueArray.length||null!==this._onGoingPromise},enumerable:!1,configurable:!0});b.prototype.cancel=function(a){this._onGoingGraphic&&
this._onGoingGraphic.graphic===a&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null);if(this._queue.has(a)){var b=this._queue.get(a);this._queue.delete(a);a=this._queueArray.indexOf(b);this._queueArray.slice(a,1)}this._scheduleNext();this.notifyChange("updating")};b.prototype.clear=function(){this._queue.clear();this._queueArray.length=0;this._onGoingPromise&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null);this._cancelNext();
this.notifyChange("updating")};b.prototype.has=function(a){return this._queue.has(a)};b.prototype.isOngoing=function(a){return this._onGoingGraphic&&this._onGoingGraphic.graphic===a};b.prototype.push=function(a,b){this._queue.has(a)||(b={graphic:a,addOrUpdate:b},this._queueArray.push(b),this._queue.set(a,b),this._scheduleNext(),this.notifyChange("updating"))};b.prototype.refresh=function(){this.reset()};b.prototype.reset=function(){var a=this._onGoingGraphic;a&&this.push(a.graphic,a.addOrUpdate)};
b.prototype._finalize=function(){this._onGoingPromise=this._ongoingAbortController=this._onGoingGraphic=null;this.notifyChange("updating");this._scheduleNext()};b.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)};b.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=f.schedule(this._next))};b.prototype._next=function(){if(null==this._scheduledNextHandle||
0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var a=this._peek(),b=a.graphic,d=a.addOrUpdate,e=h.createAbortController();this._queue.delete(b);this._onGoingGraphic=a;this._onGoingPromise=this.process(b,d,{signal:e.signal});this._ongoingAbortController=e;this._onGoingPromise.then(this._finalize,this._finalize);this.notifyChange("updating")}};b.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()};e.__decorate([n.property({readOnly:!0})],
b.prototype,"length",null);e.__decorate([n.property({readOnly:!0})],b.prototype,"updating",null);e.__decorate([n.property({constructOnly:!0})],b.prototype,"process",void 0);return b=e.__decorate([n.subclass("esri.views.2d.layers.graphics.GraphicProcessingQueue")],b)}(k);a.default=g})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("require exports tslib ../../../../core/has ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/rbush/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/contains ../../../../geometry/support/extentUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ./GraphicStoreItem ./graphicsUtils".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r){function m(a,b,c,d,e){v.minX=b;v.minY=c;v.maxX=d;v.maxY=e;return a.search(v)}Object.defineProperty(a,"__esModule",{value:!0});var v={minX:0,minY:0,maxX:0,maxY:0},l=d.create(),w=[];g=function(){function a(a,b,c,d,e,g){this._graphics=d;this._onAdd=e;this._onRemove=g;this._index=n(9,k("csp-restrictions")?function(a){return{minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);this._itemByGraphic=
new Map;this._currentLevel=-Infinity;this._tileInfoView=a;this._uidFieldName=c;if(b=a.getClosestInfoForScale(b))this._currentLevel=b.level,this._resolution=this._tileInfoView.getTileResolution(b.level);this._metersPerUnit=f.getMetersPerUnit(a.spatialReference)}a.prototype.hitTest=function(a,e,f,g,k){a=u.normalizeMapX(a,this._tileInfoView.spatialReference);var n=.5*g*f;l[0]=a-n;l[1]=e-n;l[2]=a+n;l[3]=e+n;f=.5*g*(f+50);f=m(this._index,a-f,e-f,a+f,e+f);if(!f||0===f.length)return[];for(var n={x:a,y:e},
p=[],t,v=0;v<f.length;v++){var w=f[v];if(w.graphic.visible)switch(q.getJsonType(w.geometry)){case "esriGeometryPoint":t=w.symbol;if(!t)continue;var y=w.geometry,z=y.x,C=y.y,B=g*this._metersPerUnit,y=void 0;switch(t.type){case "esriTS":y=r.getTextSymbolBounds(z,C,t,w.size,g,k);break;case "expanded-cim":y=r.getCIMMarkerBounds(z,C,t,g,B,k);break;case "esriSMS":case "esriPMS":y=r.getMarkerSymbolBounds(z,C,t,g,B,k)}b.polygonContainsPoint(y,n)&&p.push(w);break;case "esriGeometryPolyline":t=w.symbol;if(!t||
!t.layers.length)continue;t=1.5*g*window.devicePixelRatio*h.pt2px(t.layers[0].width);r.isPointOnPolyline(w.geometry,a,e,t)&&p.push(w);break;case "esriGeometryEnvelope":t=w.geometry;t=d.fromValues(t.xmin,t.ymin,t.xmax,t.ymax);d.intersects(t,l)&&p.push(w);break;case "esriGeometryPolygon":if(b.polygonContainsPoint(w.geometry,n)){p.push(w);break}t=c.getPolygonExtent(w.geometry);if(Math.abs(t.ymax-t.ymin)<5*g||Math.abs(t.xmax-t.xmin)<5*g)t=d.fromValues(t.xmin,t.ymin,t.xmax,t.ymax),d.intersects(t,l)&&p.push(w);
break;case "esriGeometryMultipoint":if(t=w.symbol)for(z=w.geometry.points,y=void 0,C=0;C<z.length;C++)if(y="esriTS"===t.type?r.getTextSymbolBounds(z[C][0],z[C][1],t,w.size,g,k):r.getMarkerSymbolBounds(z[C][0],z[C][1],t,g,g*this._metersPerUnit,k),b.polygonContainsPoint(y,n)){p.push(w);break}}}p.sort(function(a,b){var c=r.graphicGeometryToNumber(a.graphic),d=r.graphicGeometryToNumber(b.graphic);return c===d?b.zorder-a.zorder:c-d});return p.map(function(a){return a.graphic})};a.prototype.getGraphicsData=
function(a,b,c){var d=m(this._index,b.bounds[0],b.bounds[1],b.bounds[2],b.bounds[3]);if(0===d.length||0===c.length)return[];d.sort(function(a,b){return a.zorder-b.zorder});d[0].insertAfter=-1;for(var f=1;f<d.length;f++)d[f].insertAfter=d[f-1].graphic.uid;d.sort(function(a,b){return a.graphic.uid-b.graphic.uid});c.sort(function(a,b){return a.uid-b.uid});var g=f=0,h,k=[];b={originPosition:"upperLeft",scale:[b.resolution,b.resolution],translate:[b.bounds[0],b.bounds[3]]};for(var l=0;l<c.length;l++){for(var n=
c[l],g=-2;f<d.length;)if(h=d[f],f++,n.uid===h.graphic.uid){g=h.insertAfter;break}if(h.geometry&&-2!==g){var p=h.getGeometryQuantized(b),q=e.__assign({},h.graphic.attributes);q[this._uidFieldName]=n.uid;null==h.groupId&&(h.groupId=a.createTemplateGroup(h.symbol,null));k.push({centroid:t.default.getCentroidQuantized(h,b),geometry:p,attributes:q,symbol:h.symbol,groupId:h.groupId,insertAfter:g})}}return k};a.prototype.getGraphicData=function(a,b,c){var d=this._itemByGraphic.get(c);if(!d)return null;var f=
m(this._index,b.bounds[0],b.bounds[1],b.bounds[2],b.bounds[3]);f.sort(function(a,b){return a.zorder-b.zorder});var g=f.indexOf(d),f=0===g||-1===g?-1:f[g-1].graphic.uid;b={originPosition:"upperLeft",scale:[b.resolution,b.resolution],translate:[b.bounds[0],b.bounds[3]]};var g=d.getGeometryQuantized(b),h=e.__assign({},d.graphic.attributes);h[this._uidFieldName]=c.uid;null==d.groupId&&(d.groupId=a.createTemplateGroup(d.symbol,null));return{centroid:t.default.getCentroidQuantized(d,b),geometry:g,attributes:h,
symbol:d.symbol,groupId:d.groupId,insertAfter:f}};a.prototype.queryTileData=function(a,b){var c=d.pad(b.bounds,50*b.resolution,d.create()),c=m(this._index,c[0],c[1],c[2],c[3]),e=[];this._createTileGraphics(e,a,c,{originPosition:"upperLeft",scale:[b.resolution,b.resolution],translate:[b.bounds[0],b.bounds[3]]});return e};a.prototype.has=function(a){return this._itemByGraphic.has(a)};a.prototype.getBounds=function(a){return this._itemByGraphic.has(a)?this._itemByGraphic.get(a).bounds:null};a.prototype.addOrModify=
function(a,b,c){if(a)return this.has(a)&&this.remove(a),this._onAdd(a),b=t.default.acquire(a,b,c,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),this._itemByGraphic.set(a,b),c&&this._index.insert(b),b.bounds};a.prototype.remove=function(a){if(this._itemByGraphic.has(a)){this._onRemove(a);var b=this._itemByGraphic.get(a);this._index.remove(b);this._itemByGraphic.delete(a)}};a.prototype.updateZ=function(){for(var a=this._graphics.items,b,c=0;c<a.length;c++)if(b=
a[c],b=this._itemByGraphic.get(b))b.zorder=c};a.prototype.update=function(a,b,c){var e=this._itemByGraphic.get(a);e.groupId=null;var f=d.clone(e.bounds);e.size[0]=e.size[1]=0;this._index.remove(e);e.set(a,b,c,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);c&&this._index.insert(e);return{oldBounds:f,newBounds:e.bounds}};a.prototype.updateLevel=function(a){var b=this;this._currentLevel!==a&&(this._currentLevel=a,this._resolution=this._tileInfoView.getTileResolution(a),
this._index.clear(),w.length=0,this._itemByGraphic.forEach(function(a){a.updateBounds(b._resolution,b._resolution*b._metersPerUnit,b._tileInfoView.spatialReference);a.geometry&&w.push(a)}),this._index.load(w))};a.prototype.clear=function(){this._itemByGraphic.clear();this._index.clear()};a.prototype._createTileGraphics=function(a,b,c,d){var f=this._uidFieldName;c.sort(function(a,b){return a.zorder-b.zorder});for(var g,h,k,l,m=0;m<c.length;m++){k=c[m];g=k.graphic;h=k.getGeometryQuantized(d);l=0===
m?-1:c[m-1].graphic.uid;var n=e.__assign({},k.graphic.attributes);n[f]=g.uid;null==k.groupId&&(k.groupId=b.createTemplateGroup(k.symbol,null));a.push({centroid:t.default.getCentroidQuantized(k,d),geometry:h,attributes:n,symbol:k.symbol,groupId:k.groupId,insertAfter:l})}};return a}();a.default=g})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("require exports ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./graphicsUtils".split(" "),
function(g,a,e,k,h,f,n,d,b,c){Object.defineProperty(a,"__esModule",{value:!0});var q=new b.default,u=new b.default;g=function(){function a(){this.bounds=k.create();this.graphic=null;this.size=[0,0,0,0]}a.acquire=function(b,c,d,e,f,g){void 0===b&&(b=null);var h;0===a._pool.length?h=new a:(h=a._pool.pop(),this._set.delete(h));h.acquire(b,c,d,e,f,g);return h};a.release=function(a){a&&!this._set.has(a)&&(a.release(),this._pool.push(a),this._set.add(a))};a.getCentroidQuantized=function(a,b){if(f.isPolygon(a.geometry)){var d=
a.symbol;if(e.isNone(d))return null;if(c.isMarkerSymbol(d.type))return a=h.polygonCentroid(a.geometry),n.quantizePoint(b,{},{x:a[0],y:a[1]},!1,!1)}return null};a.prototype.acquire=function(a,b,c,d,e,f){void 0===a&&(a=null);a&&this.set(a,b,c,d,e,f)};a.prototype.release=function(){this.geometry=this.symbolResource=this.graphic=null};Object.defineProperty(a.prototype,"symbol",{get:function(){return this.symbolResource.symbol},enumerable:!1,configurable:!0});a.prototype.set=function(a,b,c,d,e,f){this.graphic=
a;this.geometry=c;this.symbolResource=b;this.updateBounds(d,e,f)};a.prototype.updateBounds=function(a,b,d){c.getBounds(this.bounds,this.size,this.symbolResource,this.geometry,a,b,d)};a.prototype.getGeometryQuantized=function(a){if(f.isPolygon(this.geometry)){var b=this.geometry.rings;if(1===b.length&&2===b[0].length)return n.quantizeGeometry(a,{paths:[[b[0][0],b[0][1]]]})}else if(f.isPolyline(this.geometry))return q.coords.length=0,q.lengths.length=0,u.coords.length=0,u.lengths.length=0,d.convertFromPolyline(q,
this.geometry),d.generalizeOptimizedGeometry(u,q,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",a.scale[0]),d.quantizeOptimizedGeometry(q,u,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",a),d.convertToPolyline(q,this.geometry.hasZ,this.geometry.hasM);return n.quantizeGeometry(a,this.geometry)};a._pool=[];a._set=new Set;return a}();a.default=g})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("require exports ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/intersects ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolHelper ../../engine/webgl/alignmentUtils ../../engine/webgl/mesh/templates/shapingUtils ../../engine/webgl/util/BidiText".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u,t,r,m,v,l,w,p,y,z){function C(a,b,c,e,g,k){var l,m,n=h.pt2px(c.xoffset),p=h.pt2px(c.yoffset),q=N*c.angle;k*=N;switch(c.type){case "esriSMS":l=m=h.pt2px(c.size);break;case "esriPMS":l=h.pt2px(c.width),m=h.pt2px(c.height)}.04>g&&(e=.04*e/g);c=f.mat2d.identity(Q);f.mat2d.translate(c,c,d.vec2.set(O,a,b));f.mat2d.rotate(c,c,k-q);f.mat2d.scale(c,c,d.vec2.set(O,e,-e));f.mat2d.translate(c,c,d.vec2.set(O,n,-p));a=[0,0];d.vec2.transformMat2d(a,d.vec2.set(O,-.5*l,-.5*m),c);b=
[0,0];d.vec2.transformMat2d(b,d.vec2.set(O,-.5*l,.5*m),c);e=[0,0];d.vec2.transformMat2d(e,d.vec2.set(O,.5*l,-.5*m),c);n=[0,0];d.vec2.transformMat2d(n,d.vec2.set(O,.5*l,.5*m),c);return{rings:[[a,e,n,b,a]]}}function B(a,b,c,e,g,k){var l=w.CIMSymbolHelper.getEnvelope(c.data);if(!l)return null;.04>g&&(e=.04*e/g);g=h.pt2px(l.width);var m=h.pt2px(l.height);c=h.pt2px(l.x);var l=h.pt2px(l.y),n=0*N,p=N*k;k=f.mat2d.identity(Q);f.mat2d.translate(k,k,d.vec2.set(O,a,b));f.mat2d.rotate(k,k,p-n);f.mat2d.scale(k,
k,d.vec2.set(O,e,e));a=[0,0];d.vec2.transformMat2d(a,d.vec2.set(O,c,l+m),k);b=[0,0];d.vec2.transformMat2d(b,d.vec2.set(O,c,l),k);e=[0,0];d.vec2.transformMat2d(e,d.vec2.set(O,c+g,l+m),k);m=[0,0];d.vec2.transformMat2d(m,d.vec2.set(O,c+g,l),k);return{rings:[[a,e,m,b,a]]}}function E(a,b,c,e,g,k){var l=h.pt2px(c.xoffset),m=h.pt2px(c.yoffset);c=N*c.angle;var n=N*k;k=f.mat2d.identity(Q);f.mat2d.translate(k,k,d.vec2.set(O,a,b));f.mat2d.rotate(k,k,n);f.mat2d.scale(k,k,d.vec2.set(O,g,-g));a=e[0]+e[2]/2;b=e[1]+
e[3]/2;f.mat2d.translate(k,k,d.vec2.set(O,l,-m));f.mat2d.translate(k,k,d.vec2.set(O,a,b));f.mat2d.rotate(k,k,c);f.mat2d.translate(k,k,d.vec2.set(O,-a,-b));l=[0,0];d.vec2.transformMat2d(l,d.vec2.set(O,e[0],e[1]),k);m=[0,0];d.vec2.transformMat2d(m,d.vec2.set(O,e[0],e[1]+e[3]),k);c=[0,0];d.vec2.transformMat2d(c,d.vec2.set(O,e[0]+e[2],e[1]),k);a=[0,0];d.vec2.transformMat2d(a,d.vec2.set(O,e[0]+e[2],e[1]+e[3]),k);return{rings:[[l,c,a,m,l]]}}function x(a){switch(a.symbol.type){case "esriSFS":case "esriPFS":return(a=
a.symbol.outline)?a.width:0;case "esriSLS":return a.symbol.width;case "esriSMS":return a.symbol.size;case "esriPMS":return Math.max(a.symbol.width,a.symbol.height);case "esriTS":var b=[0,0,0,0];A(b,a.symbol,a.mosaicItem);return Math.max(b[2],b[3])+Math.max(Math.abs(b[0]),Math.abs(b[1]));case "expanded-cim":return a=w.CIMSymbolHelper.getEnvelope(a.symbol.data),Math.sqrt(a.width*a.width+a.height*a.height);case "composite-symbol":return a.symbol.layers.length?x({symbol:a.symbol.layers[a.symbol.layers.length-
1],mosaicItem:null}):0;default:return 0}}function A(a,b,c){if(!c||0===c.glyphMosaicItems.length)return a;var d=z.bidiText(b.text)[1];b=y.shapeGlyphs(c.glyphMosaicItems,d,{scale:h.pt2px(b.font.size)/24,angle:b.angle,xOffset:b.xoffset,yOffset:b.yoffset,hAlign:p.getXAnchorDirection(b.horizontalAlignment||"center"),vAlign:p.getYAnchorDirection(b.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(b.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(b.lineHeight||1,4)),decoration:b.font.decoration||
"none",isCIM:!1}).bounds;a[0]=b.x-b.halfWidth;a[1]=b.y-b.halfHeight;a[2]=b.width;a[3]=b.height;return a}function F(a,b){return Math.ceil((a-b)/(2*b))}function I(a,b){var c;c=r.isPolygon(a)?a.rings:a.paths;for(var d=0;d<c.length;d++)for(var e=0,f=c[d];e<f.length;e++)f[e][0]+=b;return a}function G(a,b){if(!b)return a;var c=J(a,b).map(function(a){return a.extent});return 2>c.length?c[0]||a:2<c.length?(a.xmin=b.valid[0],a.xmax=b.valid[1],a):{rings:c.map(function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],
[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]})}}function J(a,b){var c=[],d=a.ymin,e=a.ymax,f=a.xmax-a.xmin,g=a.xmin,h=a.xmax,k,l=b.valid,m=l[0],n=l[1];k=H(a.xmin,b);var p=k.x,l=k.frameId;k=H(a.xmax,b);b=k.x;a=k.frameId;k=p===b&&0<f;if(f>2*n){f={xmin:g<h?p:b,ymin:d,xmax:n,ymax:e};g={xmin:m,ymin:d,xmax:g<h?b:p,ymax:e};h={xmin:0,ymin:d,xmax:n,ymax:e};d={xmin:m,ymin:d,xmax:0,ymax:e};e=[];m=[];M(f,h)&&e.push(l);M(f,d)&&m.push(l);M(g,h)&&e.push(a);M(g,d)&&m.push(a);for(n=l+1;n<a;n++)e.push(n),m.push(n);
c.push({extent:f,frameIds:[l]},{extent:g,frameIds:[a]},{extent:h,frameIds:e},{extent:d,frameIds:m})}else p>b||k?c.push({extent:{xmin:p,ymin:d,xmax:n,ymax:e},frameIds:[l]},{extent:{xmin:m,ymin:d,xmax:b,ymax:e},frameIds:[a]}):c.push({extent:{xmin:p,ymin:d,xmax:b,ymax:e},frameIds:[l]});return c}function H(a,b){var c=b.valid;b=c[0];var d=c[1],c=2*d,e=0;a>d?(b=Math.ceil(Math.abs(a-d)/c),a-=b*c,e=b):a<b&&(b=Math.ceil(Math.abs(a-b)/c),a+=b*c,e=-b);return{x:a,frameId:e}}function M(a,b){var c=b.xmin,d=b.ymin,
e=b.xmax;b=b.ymax;return L(a,c,d)&&L(a,c,b)&&L(a,e,b)&&L(a,e,d)}function L(a,b,c){return b>=a.xmin&&b<=a.xmax&&c>=a.ymin&&c<=a.ymax?!0:!1}function K(a,b,c){if(Array.isArray(a)){var d=a[0];if(d>b){var e=F(d,b);a[0]=d+-2*e*b}else d<c&&(e=F(d,c),a[0]=d+-2*e*c)}else d=a.x,d>b?(e=F(d,b),a.x+=-2*e*b):d<c&&(e=F(d,c),a.x+=-2*e*c);return a}Object.defineProperty(a,"__esModule",{value:!0});a.getTextSymbolSize=a.normalizeCentralMeridian=a.getTextSymbolBounds=a.getCIMMarkerBounds=a.getMarkerSymbolBounds=a.isPointOnPolyline=
a.graphicGeometryToNumber=a.isMarkerSymbol=a.getBounds=void 0;var N=Math.PI/180,Q=n.mat2df32.create(),O=b.vec2f32.create(),T=q.create();a.getBounds=function(a,b,c,d,e,f,g){if(!d||!c.symbol)return a[0]=a[1]=a[2]=a[3]=0,b[0]=b[1]=b[2]=b[3]=0,a;if(r.isPoint(d)){var h=d.x;d=d.y;"esriTS"===c.symbol.type&&0===b[2]&&0===b[3]&&A(b,c.symbol,c.mosaicItem);c=c.symbol;var k;switch(c.type){case "esriSMS":case "esriPMS":k=C(h,d,c,e,f,0);break;case "esriTS":k=E(h,d,c,b,e,0);break;case "cim":case "CIMSymbolReference":case "expanded-cim":k=
B(h,d,c,e,f,0)}for(e=b=0;e<k.rings[0].length-1;e++)c=k.rings[0][e],c=(h-c[0])*(h-c[0])+(d-c[1])*(d-c[1]),b=Math.max(b,c);b=Math.sqrt(b);k=m.normalizeMapX(h-b,g);h=m.normalizeMapX(h+b,g);k>h&&(g=l.getInfo(g))&&(h=g.valid,g=h[1],k=h[0],h=g);a[0]=k;a[1]=d-b;a[2]=h;a[3]=d+b}else u.getBoundsXY(a,d),d=b[0],0===d&&(d=x(c),b[0]=d),d=e*d/2,a[0]-=d,a[1]-=d,a[2]+=d,a[3]+=d;return a};a.isMarkerSymbol=function(a){return"simple-marker"===a||"picture-marker"===a||"text"===a};a.graphicGeometryToNumber=function(a){switch(k.unwrap(a.geometry).type){case "polyline":return 1;
case "polygon":case "extent":return 2}return 0};var R=b.vec2f32.create(),V=b.vec2f32.create(),S=b.vec2f32.create(),W=b.vec2f32.create(),X=b.vec2f32.create(),ca=b.vec2f32.create(),da=b.vec2f32.create();a.isPointOnPolyline=function(a,b,c,e){d.vec2.set(S,b,c);a=a.paths;for(var f,g,h,k,l,m,n,p,q=Infinity,r=0;r<a.length;r++){var t=a[r];if(!(2>t.length))for(var v=1;v<t.length;v++)f=t[v-1][0],h=t[v-1][1],g=t[v][0],k=t[v][1],l=Math.min(f,g)-e,m=Math.min(h,k)-e,n=Math.max(f,g)+e,p=Math.max(h,k)+e,b<l||b>n||
c<m||c>p||(d.vec2.set(R,f,h),d.vec2.set(V,g,k),d.vec2.subtract(W,V,R),d.vec2.subtract(X,R,S),d.vec2.scale(ca,W,d.vec2.dot(W,X)/d.vec2.dot(W,W)),d.vec2.subtract(da,X,ca),f=d.vec2.dot(da,da),q>f&&(q=f))}return Math.sqrt(q)<=e};a.getMarkerSymbolBounds=C;a.getCIMMarkerBounds=B;a.getTextSymbolBounds=E;a.normalizeCentralMeridian=function(a){var b,c,d,e,f,g=null;if(!a)return null;if("mesh"===a.type)return a.toJSON();b=a.spatialReference;c=v.getInfo(b);if(!c)return a.toJSON();f=b.isWebMercator?102100:4326;
d=Y[f].maxX;e=Y[f].minX;b=Y[f].plus180Line;f=Y[f].minus180Line;var h,k=a.toJSON();r.isPoint(k)?h=K(k,d,e):r.isMultipoint(k)?(k.points=k.points.map(function(a){return K(a,d,e)}),h=k):r.isExtent(k)?h=G(k,c):r.isPolygon(k)||r.isPolyline(k)?(u.getBoundsXY(T,k),a={xmin:T[0],ymin:T[1],xmax:T[2],ymax:T[3]},c=2*F(a.xmin,e)*d,k=0===c?k:I(k,c),a.xmin+=c,a.xmax+=c,t.extentIntersectsPolyline(a,b)&&a.xmax!==d?g=k:t.extentIntersectsPolyline(a,f)&&a.xmin!==e?g=k:h=k):h=a.clone();return null!==g?(new ha).cut(g,d):
h};a.getTextSymbolSize=A;var Y={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:{paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:c.WebMercator},minus180Line:{paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:c.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:c.WGS84},minus180Line:{paths:[[[-180,
-180],[-180,180]]],spatialReference:c.WGS84}}},ha=function(){function a(){}a.prototype.cut=function(a,b){var c;if(a.rings)this.closed=!0,c=a.rings,this.minPts=4;else if(a.paths)this.closed=!1,c=a.paths,this.minPts=2;else return null;var d=c.length;b*=-2;for(var e=0;e<d;e++){var f=c[e];if(f&&f.length>=this.minPts){for(var g=[],h=0;h<f.length;h++){var k=f[h];g.push([k[0]+b,k[1]])}c.push(g)}}this.closed?a.rings=c:a.paths=c;return a};return a}()})},"esri/views/layers/GraphicsView":function(){define(["require",
"exports","tslib","../../core/accessorSupport/decorators"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.GraphicsView=void 0;a.GraphicsView=function(a){return function(a){function f(){var d=null!==a&&a.apply(this,arguments)||this;d.graphics=null;d.renderer=null;d.view=null;return d}e.__extends(f,a);e.__decorate([k.property()],f.prototype,"graphics",void 0);e.__decorate([k.property()],f.prototype,"renderer",void 0);e.__decorate([k.property()],f.prototype,"updating",void 0);e.__decorate([k.property()],
f.prototype,"view",void 0);return f=e.__decorate([k.subclass("esri.views.layers.GraphicsView")],f)}(a)}})},"esri/views/2d/navigation/MapViewNavigation":function(){define("require exports tslib ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),function(g,a,e,k,h,f,n,d,b,c,q,u){Object.defineProperty(a,"__esModule",{value:!0});var t=new k({targetGeometry:new n}),
r=[0,0];g=function(a){function g(b){b=a.call(this,b)||this;b._endTimer=null;b.animationManager=null;return b}e.__extends(g,a);g.prototype.initialize=function(){this.pan=new c({navigation:this});this.rotate=new u({navigation:this});this.pinch=new q({navigation:this});this.zoomBox=new b({view:this.view,navigation:this})};g.prototype.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};g.prototype.begin=function(){this._set("interacting",!0)};g.prototype.end=function(){this._lastEventTimestamp=
performance.now();this._startTimer(250)};g.prototype.zoom=function(a,b){void 0===b&&(b=this._getDefaultAnchor());return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(c){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>a?[2,this.zoomIn(b)]:[2,this.zoomOut(b)];this.setViewpoint(b,a,0,[0,0]);return[2]})})};g.prototype.zoomIn=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c;return e.__generator(this,
function(d){b=this.view;c=b.constraints.snapToNextScale(b.scale);return[2,this._zoomToScale(c,a)]})})};g.prototype.zoomOut=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,c;return e.__generator(this,function(d){b=this.view;c=b.constraints.snapToPreviousScale(b.scale);return[2,this._zoomToScale(c,a)]})})};g.prototype.setViewpoint=function(a,b,c,d){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,a,b,c,d);this.end()};g.prototype.setViewpointImmediate=
function(a,b,c,d){void 0===b&&(b=0);void 0===c&&(c=[0,0]);void 0===d&&(d=this._getDefaultAnchor());this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,d,a,b,c)};g.prototype.continousRotateClockwise=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){d.rotateBy(a,a,-1)})};g.prototype.continousRotateCounterclockwise=function(){var a=this.get("view.viewpoint");this.animationManager.animateContinous(a,function(a){d.rotateBy(a,
a,1)})};g.prototype.resetRotation=function(){this.view.rotation=0};g.prototype.continousPanLeft=function(){this._continuousPan([-10,0])};g.prototype.continousPanRight=function(){this._continuousPan([10,0])};g.prototype.continousPanUp=function(){this._continuousPan([0,10])};g.prototype.continousPanDown=function(){this._continuousPan([0,-10])};g.prototype.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=
null,this._set("interacting",!1))};g.prototype._continuousPan=function(a){var b=this,c=this.get("view.viewpoint");this.animationManager.animateContinous(c,function(c){d.translateBy(c,c,a);b.view.constraints.constrainByGeometry(c)})};g.prototype._startTimer=function(a){var b=this;return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(function(){b._endTimer=null;var a=performance.now()-b._lastEventTimestamp;250>a?b._endTimer=b._startTimer(a):b._set("interacting",!1)},a)};g.prototype._getDefaultAnchor=
function(){var a=this.view,b=a.size,a=a.padding,c=a.top,d=a.bottom;r[0]=.5*(b[0]-a.right+a.left);r[1]=.5*(b[1]-d+c);return r};g.prototype._zoomToScale=function(a,b){void 0===b&&(b=this._getDefaultAnchor());return e.__awaiter(this,void 0,void 0,function(){var c,f,g,h,k,l,m,n;return e.__generator(this,function(e){c=this.view;f=c.constraints;g=c.scale;h=c.viewpoint;k=c.size;l=c.padding;m=f.canZoomInTo(a);n=f.canZoomOutTo(a);if(a<g&&!m||a>g&&!n)return[2];d.padAndScaleAndRotateBy(t,h,a/g,0,b,k,l);f.constrainByGeometry(t);
return[2,c.goTo(t,{animate:!0})]})})};g.prototype._scaleRotateTranslateViewpoint=function(a,b,c,e,f){var g=this.view,h=g.size,k=g.padding,l=g.constraints,m=g.viewpoint,n=g.scale*c,g=l.canZoomInTo(n),n=l.canZoomOutTo(n);if(1>c&&!g||1<c&&!n)c=1;d.translateBy(m,m,f);d.padAndScaleAndRotateBy(a,m,c,e,b,h,k);return l.constrainByGeometry(a)};e.__decorate([f.property()],g.prototype,"animationManager",void 0);e.__decorate([f.property({type:Boolean,readOnly:!0})],g.prototype,"interacting",void 0);e.__decorate([f.property()],
g.prototype,"pan",void 0);e.__decorate([f.property()],g.prototype,"pinch",void 0);e.__decorate([f.property()],g.prototype,"rotate",void 0);e.__decorate([f.property()],g.prototype,"view",void 0);e.__decorate([f.property()],g.prototype,"zoomBox",void 0);return g=e.__decorate([f.subclass("esri.views.2d.navigation.MapViewNavigation")],g)}(h);a.default=g})},"esri/views/2d/navigation/ZoomBox":function(){define("require exports tslib ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators".split(" "),
function(g,a,e,k,h,f){return function(a){function d(b){b=a.call(this,b)||this;b._container=null;b._overlay=null;b._backgroundShape=null;b._boxShape=null;b._box={x:0,y:0,width:0,height:0};b._redraw=b._redraw.bind(b);return b}e.__extends(d,a);d.prototype.destroy=function(){this.view=null};Object.defineProperty(d.prototype,"view",{set:function(a){var b=this;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._destroyOverlay();this._set("view",a);a&&(a.on("drag",["Shift"],
function(a){return b._handleDrag(a,1)}),a.on("drag",["Shift","Ctrl"],function(a){return b._handleDrag(a,-1)}))},enumerable:!1,configurable:!0});d.prototype._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};d.prototype._update=function(a,c,d,e){this._box.x=a;this._box.y=c;this._box.width=d;this._box.height=e;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};d.prototype._end=function(a,c,d,e,f){var b=this.view;a=b.toMap(h.createScreenPoint(a+.5*d,
c+.5*e));d=Math.max(d/b.width,e/b.height);-1===f&&(d=1/d);this._destroyOverlay();this.navigation.end();b.goTo({center:a,scale:b.scale*d})};d.prototype._updateBox=function(a,c,d,e){var b=this._boxShape;b.setAttributeNS(null,"x",""+a);b.setAttributeNS(null,"y",""+c);b.setAttributeNS(null,"width",""+d);b.setAttributeNS(null,"height",""+e);b.setAttributeNS(null,"class","esri-zoom-box__outline")};d.prototype._updateBackground=function(a,c,d,e){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(a,
c,d,e,this.view.width,this.view.height))};d.prototype._createContainer=function(){var a=document.createElement("div");a.className="esri-zoom-box__container";this.view.root.appendChild(a);this._container=a};d.prototype._createOverlay=function(){var a=this.view.width,c=this.view.height,d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M 0 0 L "+a+" 0 L "+a+" "+c+" L 0 "+c+" Z");d.setAttributeNS(null,"class","esri-zoom-box__overlay-background");a=document.createElementNS("http://www.w3.org/2000/svg",
"rect");c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");c.setAttributeNS(null,"class","esri-zoom-box__overlay");c.appendChild(d);c.appendChild(a);this._container.appendChild(c);this._backgroundShape=d;this._boxShape=a;this._overlay=c};d.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=
this._backgroundShape=this._boxShape=this._overlay=null};d.prototype._toSVGPath=function(a,c,d,e,f,g){d=a+d;e=c+e;return"M 0 0 L "+f+" 0 L "+f+" "+g+" L 0 "+g+" ZM "+a+" "+c+" L "+a+" "+e+" L "+d+" "+e+" L "+d+" "+c+" Z"};d.prototype._handleDrag=function(a,c){var b=a.x,d=a.y,e=a.origin.x,f=a.origin.y,g;b>e?(g=e,e=b-e):(g=b,e-=b);d>f?(b=f,d-=f):(b=d,d=f-d);switch(a.action){case "start":this._start();break;case "update":this._update(g,b,e,d);break;case "end":this._end(g,b,e,d,c)}a.stopPropagation()};
d.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var a=this._box,c=a.x,d=a.y,e=a.width,a=a.height;this._updateBox(c,d,e,a);this._updateBackground(c,d,e,a);this._rafId=requestAnimationFrame(this._redraw)}};e.__decorate([f.property()],d.prototype,"navigation",void 0);e.__decorate([f.property()],d.prototype,"view",null);return d=e.__decorate([f.subclass("esri.views.2d.navigation.ZoomBox")],d)}(k)})},"esri/views/2d/navigation/actions/Pan":function(){define("require exports tslib ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/screenUtils ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u){return function(a){function f(b){var d=a.call(this,b)||this;d.animationTime=0;d.momentumEstimator=new u.PanPlanarMomentumEstimator(500,6,.92);d.momentum=null;d.tmpMomentum=c.vec3f64.create();d.momentumFinished=!1;d.viewpoint=new h({targetGeometry:new k.Point,scale:0,rotation:0});d.watch("momentumFinished",function(a){a&&d.navigation.stop()});return d}e.__extends(f,a);f.prototype.begin=function(a,b){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(b);
this.previousDrag=b};f.prototype.update=function(a,b){this.addToEstimator(b);var c=b.center.x,d=b.center.y,e=this.previousDrag,c=e?e.center.x-c:-c,d=e?d-e.center.y:d;a.viewpoint=q.translateBy(this.viewpoint,a.viewpoint,[c||0,d||0]);this.previousDrag=b};f.prototype.end=function(a,b){this.addToEstimator(b);this.momentum=a.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(a);this.previousDrag=null;this.navigation.end()};
f.prototype.addToEstimator=function(a){var b=a.center.x,d=a.center.y,e=n.createScreenPointArray(-b,d),b=c.vec3f64.fromValues(-b,d,0);this.momentumEstimator.add(e,b,.001*a.timestamp)};f.prototype.onAnimationUpdate=function(a){var c=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(d,e){c.momentumFinished=!c.momentum||c.momentum.isFinished(c.animationTime);e*=.001;if(!c.momentumFinished){var f=c.momentum.valueDelta(c.animationTime,e);b.vec3.scale(c.tmpMomentum,c.momentum.direction,
f);q.translateBy(d,d,c.tmpMomentum);a.constraints.constrainByGeometry(d)}c.animationTime+=e})};f.prototype.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};e.__decorate([d.property()],f.prototype,"momentumFinished",void 0);e.__decorate([d.property()],f.prototype,"viewpoint",void 0);e.__decorate([d.property()],f.prototype,"navigation",void 0);return f=e.__decorate([d.subclass("esri.views.2d.navigation.actions.Pan")],f)}(f)})},
"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("require exports tslib ../../core/libs/gl-matrix-2/vec3 ../../core/libs/gl-matrix-2/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});a.PanPlanarMomentumEstimator=a.PanPlanarMomentum=void 0;var d=function(a){function b(b,c,d,e,f){b=a.call(this,b,c,d)||this;b.sceneVelocity=e;b.direction=f;return b}e.__extends(b,a);b.prototype.value=function(b){return a.prototype.valueFromInitialVelocity.call(this,
this.sceneVelocity,b)};return b}(n.Momentum);a.PanPlanarMomentum=d;g=function(){function a(a,b,d){void 0===a&&(a=300);void 0===b&&(b=12);void 0===d&&(d=.84);this.minimumInitialVelocity=a;this.stopVelocity=b;this.friction=d;this.enabled=!0;this.time=new f.FilteredFiniteDifference(.6);this.screen=[new f.FilteredFiniteDifference(.4),new f.FilteredFiniteDifference(.4)];this.scene=[new f.FilteredFiniteDifference(.6),new f.FilteredFiniteDifference(.6),new f.FilteredFiniteDifference(.6)];this.tmpDirection=
h.vec3f64.create()}a.prototype.add=function(a,b,d){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(d)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(b[0]),this.scene[1].update(b[1]),this.scene[2].update(b[2]),this.time.update(d))};a.prototype.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();this.scene[1].reset();this.scene[2].reset();this.time.reset()};a.prototype.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;
var a=this.screen[0].filteredDelta,b=this.screen[1].filteredDelta,a=Math.sqrt(a*a+b*b)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};a.prototype.createMomentum=function(a,b,e){k.vec3.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);var c=k.vec3.length(this.tmpDirection);0<c&&k.vec3.scale(this.tmpDirection,this.tmpDirection,1/c);return new d(a,b,e,c/this.time.filteredDelta,
this.tmpDirection)};return a}();a.PanPlanarMomentumEstimator=g})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["require","exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.FilteredFiniteDifference=void 0;g=function(){function a(a){this.gain=a}a.prototype.update=function(a){if(this.hasLastValue){var e=this.computeDelta(a);this.updateDelta(e)}this.lastValue=a};a.prototype.reset=function(){this.filteredDelta=this.lastValue=void 0};Object.defineProperty(a.prototype,
"hasLastValue",{get:function(){return void 0!==this.lastValue},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hasFilteredDelta",{get:function(){return void 0!==this.filteredDelta},enumerable:!1,configurable:!0});a.prototype.computeDelta=function(a){return a-this.lastValue};a.prototype.updateDelta=function(a){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*a:a};return a}();a.FilteredFiniteDifference=g})},"esri/views/navigation/Momentum":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});a.Momentum=void 0;g=function(){function a(a,e,f){this._initialVelocity=a;this._stopVelocity=e;this._friction=f;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}Object.defineProperty(a.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0});a.prototype.isFinished=function(a){return a>this.duration};Object.defineProperty(a.prototype,
"friction",{get:function(){return this._friction},enumerable:!1,configurable:!0});a.prototype.value=function(a){return this.valueFromInitialVelocity(this._initialVelocity,a)};a.prototype.valueDelta=function(a,e){var f=this.value(a);return this.value(a+e)-f};a.prototype.valueFromInitialVelocity=function(a,e){e=Math.min(e,this.duration);var f=1-this.friction;return a*(Math.pow(f,e)-1)/Math.log(f)};return a}();a.Momentum=g})},"esri/views/2d/navigation/actions/Pinch":function(){define("require exports tslib ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator".split(" "),
function(g,a,e,k,h,f,n,d,b,c,q,u){return function(a){function f(b){var c=a.call(this,b)||this;c._animationTime=0;c._momentumFinished=!1;c._rotationMomentumEstimator=new q.RotationMomentumEstimator(.6,.15,.95);c._rotationDirection=1;c._zoomDirection=1;c._zoomMomentumEstimator=new u.ZoomMomentumEstimator;c._zoomOnly=null;c.zoomMomentum=null;c.rotateMomentum=null;c.viewpoint=new h({targetGeometry:new k.Point,scale:0,rotation:0});c.watch("_momentumFinished",function(a){a&&c.navigation.stop()});return c}
e.__extends(f,a);f.prototype.begin=function(a,b){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=b.angle;this._previousRadius=this._startRadius=b.radius;this._previousCenter=b.center;this._updateTimestamp=null;a.constraints.rotationEnabled&&this.addToRotateEstimator(0,b.timestamp);this.addToZoomEstimator(b,1)};f.prototype.update=function(a,b){null===this._updateTimestamp&&(this._updateTimestamp=
b.timestamp);var c=b.angle,d=b.radius,e=b.center,f=Math.abs(180*(c-this._startAngle)/Math.PI),g=Math.abs(d-this._startRadius),h=this._startRadius/d;if(this._previousRadius){var k=d/this._previousRadius,m=180*(c-this._previousAngle)/Math.PI;this._rotationDirection=0<=m?1:-1;this._zoomDirection=1<=k?1:-1;a.constraints.rotationEnabled?(null===this._zoomOnly&&200<b.timestamp-this._updateTimestamp&&(this._zoomOnly=0<g-f),null===this._zoomOnly||this._zoomOnly?m=0:this.addToRotateEstimator(c-this._startAngle,
b.timestamp)):m=0;this.addToZoomEstimator(b,h);this.navigation.setViewpoint([e.x,e.y],1/k,m,[this._previousCenter.x-e.x,e.y-this._previousCenter.y])}this._previousAngle=c;this._previousRadius=d;this._previousCenter=e};f.prototype.end=function(a){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(a);this.navigation.end()};f.prototype.addToRotateEstimator=
function(a,b){this._rotationMomentumEstimator.add(a,.001*b)};f.prototype.addToZoomEstimator=function(a,b){this._zoomMomentumEstimator.add(b,.001*a.timestamp)};f.prototype.canZoomIn=function(a){var b=a.scale;a=a.constraints.effectiveMaxScale;return 0===a||b>a};f.prototype.canZoomOut=function(a){var b=a.scale;a=a.constraints.effectiveMinScale;return 0===a||b<a};f.prototype.onAnimationUpdate=function(a){var e=this;this.navigation.animationManager.animateContinous(a.viewpoint,function(f,g){var h=!e.canZoomIn(a)&&
1<e._zoomDirection||!e.canZoomOut(a)&&1>e._zoomDirection,k=!e.rotateMomentum||e.rotateMomentum.isFinished(e._animationTime),h=h||!e.zoomMomentum||e.zoomMomentum.isFinished(e._animationTime);g*=.001;e._momentumFinished=k&&h;if(!e._momentumFinished){var k=e.rotateMomentum?Math.abs(e.rotateMomentum.valueDelta(e._animationTime,g))*e._rotationDirection*180/Math.PI:0,h=e.zoomMomentum?Math.abs(e.zoomMomentum.valueDelta(e._animationTime,g)):1,l=b.vec2f64.create(),m=b.vec2f64.create();if(e._previousCenter){d.vec2.set(l,
e._previousCenter.x,e._previousCenter.y);c.getPaddingScreenTranslation(m,a.size,a.padding);d.vec2.add(l,l,m);var m=a.constraints,n=a.scale,q=n*h;1>h&&!m.canZoomInTo(q)?(h=n/m.effectiveMaxScale,e.zoomMomentum=null,e.rotateMomentum=null):1<h&&!m.canZoomOutTo(q)&&(h=n/m.effectiveMinScale,e.zoomMomentum=null,e.rotateMomentum=null);c.scaleAndRotateBy(f,a.viewpoint,h,k,l,a.size);a.constraints.constrainByGeometry(f)}}e._animationTime+=g})};f.prototype.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};e.__decorate([n.property()],f.prototype,"_momentumFinished",void 0);e.__decorate([n.property()],f.prototype,"viewpoint",void 0);e.__decorate([n.property()],f.prototype,"navigation",void 0);return f=e.__decorate([n.subclass("esri.views.2d.navigation.actions.Pinch")],f)}(f)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["require",
"exports","tslib","./MomentumEstimator"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.RotationMomentumEstimator=void 0;g=function(a){function f(e,d,b,c){void 0===e&&(e=3);void 0===d&&(d=.01);void 0===b&&(b=.95);void 0===c&&(c=12);return a.call(this,e,d,b,c)||this}e.__extends(f,a);f.prototype.add=function(e,d){if(this.value.hasLastValue){var b=this.value.lastValue;for(e-=b;e>Math.PI;)e-=2*Math.PI;for(;e<-Math.PI;)e+=2*Math.PI;e=b+e}a.prototype.add.call(this,e,d)};return f}(k.MomentumEstimator);
a.RotationMomentumEstimator=g})},"esri/views/navigation/MomentumEstimator":function(){define(["require","exports","../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.MomentumEstimator=void 0;g=function(){function a(a,d,b,c){void 0===a&&(a=2.5);void 0===d&&(d=.01);void 0===b&&(b=.95);void 0===c&&(c=12);this.minimumInitialVelocity=a;this.stopVelocity=d;this.friction=b;this.maxVelocity=c;this.enabled=!0;this.value=new k.FilteredFiniteDifference(.8);
this.time=new k.FilteredFiniteDifference(.3)}a.prototype.add=function(a,d){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(d))return;if(this.value.hasFilteredDelta){var b=this.value.computeDelta(a);0>this.value.filteredDelta*b&&this.value.reset()}}this.time.update(d);this.value.update(a)}};a.prototype.reset=function(){this.value.reset();this.time.reset()};a.prototype.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;var a=this.value.filteredDelta/
this.time.filteredDelta,a=e.clamp(a,-this.maxVelocity,this.maxVelocity);return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};a.prototype.createMomentum=function(a,d,b){return new h.Momentum(a,d,b)};return a}();a.MomentumEstimator=g})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["require","exports","tslib","./Momentum","./MomentumEstimator"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.ZoomMomentumEstimator=
a.ZoomMomentum=void 0;var f=function(a){function d(b,c,d){return a.call(this,b,c,d)||this}e.__extends(d,a);d.prototype.value=function(b){b=a.prototype.value.call(this,b);return Math.exp(b)};d.prototype.valueDelta=function(b,c){var d=a.prototype.value.call(this,b);b=a.prototype.value.call(this,b+c);return Math.exp(b-d)};return d}(k.Momentum);a.ZoomMomentum=f;g=function(a){function d(b,c,d,e){void 0===b&&(b=2.5);void 0===c&&(c=.01);void 0===d&&(d=.95);void 0===e&&(e=12);return a.call(this,b,c,d,e)||
this}e.__extends(d,a);d.prototype.add=function(b,c){a.prototype.add.call(this,Math.log(b),c)};d.prototype.createMomentum=function(a,c,d){return new f(a,c,d)};return d}(h.MomentumEstimator);a.ZoomMomentumEstimator=g})},"esri/views/2d/navigation/actions/Rotate":function(){define("require exports tslib ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../viewpointUtils".split(" "),
function(g,a,e,k,h,f,n,d,b,c){var q=b.vec2f64.create(),u=b.vec2f64.create();return function(a){function f(c){c=a.call(this,c)||this;c._previousCenter=b.vec2f64.create();c.viewpoint=new h({targetGeometry:new k.Point,scale:0,rotation:0});return c}e.__extends(f,a);f.prototype.begin=function(a,b){this.navigation.begin();d.vec2.set(this._previousCenter,b.center.x,b.center.y)};f.prototype.update=function(a,b){var e=a.state,f=e.size,e=e.padding;d.vec2.set(q,b.center.x,b.center.y);c.getAnchor(u,f,e);a.viewpoint=
c.rotateBy(this.viewpoint,a.state.paddedViewState.viewpoint,c.angleBetween(u,this._previousCenter,q));d.vec2.copy(this._previousCenter,q)};f.prototype.end=function(){this.navigation.end()};e.__decorate([n.property()],f.prototype,"viewpoint",void 0);e.__decorate([n.property()],f.prototype,"navigation",void 0);return f=e.__decorate([n.subclass("esri.views.2d.actions.Rotate")],f)}(f)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("require exports tslib ../../../assets ../../../core/promiseUtils ../../webgl ../engine/DisplayObject ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms".split(" "),
function(g,a,e,k,h,f,n,d,b){Object.defineProperty(a,"__esModule",{value:!0});g=function(a){function c(){var b=a.call(this)||this;b.visible=!1;return b}e.__extends(c,a);c.prototype.destroy=function(){this._readbackTexture&&(this._readbackTexture.dispose(),this._readbackTexture=null,this._maskTexture.dispose(),this._maskTexture=null,this._overlayTexture.dispose(),this._overlayTexture=null,this._vertexArrayObject.dispose(),this._vertexArrayObject=null,this._program.dispose(),this._resourcesPromise=this._program=
null)};Object.defineProperty(c.prototype,"background",{get:function(){return this._background},set:function(a){this._background=a;this.requestRender()},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"magnifier",{get:function(){return this._magnifier},set:function(a){var b=this;this._magnifier=a;this._handle&&this._handle.remove();this._handle=a.watch("version",function(){b.visible=a.visible;b.requestRender()});this.visible=a.visible;this.requestRender()},enumerable:!1,configurable:!0});
c.prototype.doRender=function(a){var b,c=a.context;if(!this._resourcesPromise)this._resourcesPromise=this._loadResources("esri/images/magnifier/mask.png","esri/images/magnifier/overlay.png");else if(a.drawPhase===d.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(c);var e=this._magnifier,f=1/e.factor,g=Math.ceil(f*this.overlay.width),h=Math.ceil(f*this.overlay.height),k=a.state.size,n=a.pixelRatio,f=n*k[0];a=n*k[1];var q=e.position||{x:.5*k[0],y:.5*k[1]},k=n*q.x,n=a-n*q.y,q=.5*g,u=.5*h;
q>k?k=q:k>=f-q&&(k=f-q-1);u>n?n=u:n>=a-u&&(n=a-u-1);var q=k-q,u=n-u,B=this._readbackTexture;c.bindTexture(B,0);c.gl.copyTexImage2D(B.descriptor.target,0,B.descriptor.pixelFormat,q,u,g,h,0);b=(g=null===(b=this.background)||void 0===b?void 0:b.color)?[g.a*g.r/255,g.a*g.g/255,g.a*g.b/255,g.a]:[1,1,1,1];g=-1+(k+e.offsetX)/f*2;e=-1+(n-e.offsetY)/a*2;f=this.overlay.width/f*2;a=this.overlay.height/a*2;h=this._program;c.bindVAO(this._vertexArrayObject);c.bindTexture(this._overlayTexture,6);c.bindTexture(this._maskTexture,
7);c.bindProgram(h);h.setUniform4fv("u_background",b);h.setUniform1i("u_readbackTexture",0);h.setUniform1i("u_overlyTexture",6);h.setUniform1i("u_maskTexture",7);h.setUniform2f("u_drawPos",g,e);h.setUniform1f("u_width",f);h.setUniform1f("u_height",a);c.setStencilTestEnabled(!1);c.drawArrays(5,0,4);c.bindVAO()}};c.prototype._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};c.prototype._loadResources=function(a,b){return e.__awaiter(this,void 0,void 0,function(){var c,d,f;
return e.__generator(this,function(e){switch(e.label){case 0:return[4,h.all([k.fetchAsset(a,{responseType:"image"}),k.fetchAsset(b,{responseType:"image"})])];case 1:return c=e.sent(),d=c[0].data,f=c[1].data,this.mask=d,this.overlay=f,this.requestRender(),[2]}})})};c.prototype._updateResources=function(a){if(!this._readbackTexture){var c=1/this._magnifier.factor,d=Math.ceil(c*this.overlay.width),c=Math.ceil(c*this.overlay.height);this._program=b.createMagnifierProgram(a);var e=new Uint16Array([0,1,
0,0,1,1,1,0]);this._vertexArrayObject=new f.VertexArrayObject(a,b.magnifierProgramTemplate.attributes,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:f.BufferObject.createVertex(a,35044,e)});this._overlayTexture=new f.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.overlay);this._maskTexture=new f.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,
samplingMode:9728,flipped:!0},this.mask);this._readbackTexture=new f.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:d,height:c})}};return c}(n.DisplayObject);a.default=g})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,a,e,k){Object.defineProperty(a,"__esModule",{value:!0});a.createMagnifierProgram=a.magnifierProgramTemplate=
void 0;a.magnifierProgramTemplate={name:"magnifier",shaders:{vertexShader:k.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:k.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};a.createMagnifierProgram=function(g){return e.createProgram(g,a.magnifierProgramTemplate)}})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["require","exports","./factories/vec3f32"],function(g,a,e){Object.defineProperty(a,"__esModule",{value:!0});a.vec3f32=void 0;a.vec3f32=e})},"esri/core/libs/gl-matrix-2/factories/vec3f32":function(){define(["require",
"exports"],function(g,a){function e(){return new Float32Array(3)}function k(a,c,d){var b=new Float32Array(3);b[0]=a;b[1]=c;b[2]=d;return b}function h(){return k(1,1,1)}function f(){return k(1,0,0)}function n(){return k(0,1,0)}function d(){return k(0,0,1)}Object.defineProperty(a,"__esModule",{value:!0});a.UNIT_Z=a.UNIT_Y=a.UNIT_X=a.ONES=a.ZEROS=a.unitZ=a.unitY=a.unitX=a.ones=a.zeros=a.createView=a.fromValues=a.clone=a.create=void 0;a.create=e;a.clone=function(a){var b=new Float32Array(3);b[0]=a[0];
b[1]=a[1];b[2]=a[2];return b};a.fromValues=k;a.createView=function(a,c){return new Float32Array(a,c,3)};a.zeros=function(){return e()};a.ones=h;a.unitX=f;a.unitY=n;a.unitZ=d;a.ZEROS=e();a.ONES=h();a.UNIT_X=f();a.UNIT_Y=n();a.UNIT_Z=d()})},"esri/views/2d/engine/Bitmap":function(){define("require exports tslib ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(g,a,e,
k,h,f,n,d,b){function c(a){var b=document.createElement("canvas");b.width=a.width;b.height=a.height;a.render(b.getContext("2d"));return b}function q(a,b,c){var d={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};b&&c&&(d.width=b,d.height=c);return new n.Texture(a,d)}Object.defineProperty(a,"__esModule",{value:!0});a.Bitmap=void 0;g=function(a){function d(b,c){void 0===b&&(b=null);void 0===c&&(c=!0);var d=a.call(this)||this;d.requestRenderOnSourceChangedEnabled=c;d._textureInvalidated=
!0;d.stencilRef=0;d.coordScale=[1,1];d._height=void 0;d.pixelRatio=1;d.resolution=0;d.rotation=0;d._source=null;d._width=void 0;d.x=0;d.y=0;d.transforms={dvs:h.mat3f32.create()};d.source=b;d.requestRender=d.requestRender.bind(d);return d}e.__extends(d,a);Object.defineProperty(d.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return void 0!==this._height?
this._height:this.sourceHeight},set:function(a){this._height=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"source",{get:function(){return this._source},set:function(a){this._source=a;this.invalidateTexture()},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"sourceWidth",
{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(a){this._width=a},enumerable:!1,configurable:!0});d.prototype.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};d.prototype.setTransform=
function(a){var b=k.mat3.identity(this.transforms.dvs),c=a.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/a.resolution,e=d*this.width,d=d*this.height,g=Math.PI*this.rotation/180;k.mat3.translate(b,b,f.vec2f32.fromValues(c[0],c[1]));k.mat3.translate(b,b,f.vec2f32.fromValues(e/2,d/2));k.mat3.rotate(b,b,-g);k.mat3.translate(b,b,f.vec2f32.fromValues(-e/2,-d/2));k.mat3.scaleByVec2(b,b,f.vec2f32.fromValues(e,d));k.mat3.multiply(this.transforms.dvs,a.displayViewMat3,b)};d.prototype.setSamplingProfile=
function(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(a.samplingMode))};d.prototype.bind=function(a,b){this._texture&&a.context.bindTexture(this._texture,b)};d.prototype.updateTexture=function(a){var d;a=a.context;this.stage?this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||(this._texture=this.source?q(a,this.sourceWidth,this.sourceHeight):q(a)),(d=this.source)?(this._texture.resize(this.sourceWidth,
this.sourceHeight),d&&"render"in d?d instanceof b.default?(d=d.getRenderedRasterPixels(),this._texture.setData(d.renderedRasterPixels)):this._texture.setData(c(d)):!d||"render"in d||this._texture.setData(d),this.ready()):this._texture.setData(null)):(null===(d=this._texture)||void 0===d?void 0:d.dispose(),this._texture=null)};d.prototype.onAttach=function(){this.invalidateTexture()};d.prototype.onDetach=function(){this.invalidateTexture()};return d}(d.DisplayObject);a.Bitmap=g})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require",
"exports"],function(g,a){Object.defineProperty(a,"__esModule",{value:!0});g=function(){function a(a,e,f){this.pixelBlock=a;this.extent=e;this.originalPixelBlock=f}Object.defineProperty(a.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this.pixelBlock?this.pixelBlock.height:0},enumerable:!1,configurable:!0});a.prototype.render=function(a){var e=this.pixelBlock;if(e){var f=
this.filter({pixelBlock:e}),e=f.pixelBlock.getAsRGBA(),f=a.createImageData(f.pixelBlock.width,f.pixelBlock.height);f.data.set(e);a.putImageData(f,0,0)}};a.prototype.getRenderedRasterPixels=function(){var a=this.filter({pixelBlock:this.pixelBlock});return{width:a.pixelBlock.width,height:a.pixelBlock.height,renderedRasterPixels:new Uint8Array(a.pixelBlock.getAsRGBA().buffer)}};return a}();a.default=g})},"esri/views/2d/engine/BitmapContainer":function(){define(["require","exports","tslib","./brushes",
"./webgl/WGLContainer"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.BitmapContainer=void 0;g=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}e.__extends(f,a);f.prototype.prepareRenderPasses=function(d){var b=this,c=d.registerRenderPass({name:"bitmap",brushes:[k.brushes.bitmap],target:function(){return b.children}});return e.__spreadArrays(a.prototype.prepareRenderPasses.call(this,d),[c])};return f}(h.default);a.BitmapContainer=g})},"esri/views/2d/engine/BitmapTile":function(){define(["require",
"exports","tslib","./Bitmap","./webgl/TiledDisplayObject"],function(g,a,e,k,h){Object.defineProperty(a,"__esModule",{value:!0});a.BitmapTile=void 0;g=function(a){function f(d,b,c,e){void 0===e&&(e=null);var f=a.call(this,d,b,c,c)||this;f.bitmap=new k.Bitmap(e);f.bitmap.coordScale=c;f.bitmap.once("isReady",function(){return f.ready()});return f}e.__extends(f,a);Object.defineProperty(f.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!1,
configurable:!0});f.prototype.setTransform=function(d,b){a.prototype.setTransform.call(this,d,b);this.bitmap.transforms.dvs=this.transforms.dvs};f.prototype.onAttach=function(){this.bitmap.stage=this.stage};f.prototype.onDetach=function(){this.bitmap.stage=null};return f}(h.TiledDisplayObject);a.BitmapTile=g})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports tslib ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),
function(g,a,e,k,h,f,n,d){Object.defineProperty(a,"__esModule",{value:!0});a.BitmapTileContainer=void 0;g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}e.__extends(b,a);b.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(k.create(),a);return new h.BitmapTile(a,b,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var c=this,d=b.registerRenderPass({name:"bitmap (tile)",brushes:[f.brushes.bitmap],
target:function(){return c.children.map(function(a){return a.bitmap})},drawPhase:n.WGLDrawPhase.MAP});return e.__spreadArrays(a.prototype.prepareRenderPasses.call(this,b),[d])};b.prototype.doRender=function(b){this.visible&&b.drawPhase===n.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,b)};return b}(d.default);a.BitmapTileContainer=g})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(g,a,e){Object.defineProperty(a,"__esModule",
{value:!0});a.CollisionGrid=void 0;g=function(){function a(a,f){void 0===f&&(f=2);this._bucketSize=a;this._rowsLength=e.TILE_SIZE/a;this._colsLength=e.TILE_SIZE/a;this._elementsPerBucket=f;this._grid=this._initGrid()}a.prototype.checkOverlap=function(a,e){a=Math.floor(a/this._bucketSize);e=Math.floor(e/this._bucketSize);return 0>a||a>=this._rowsLength||0>e||e>=this._colsLength?!0:this._grid[e*this._colsLength+a]>=this._elementsPerBucket};a.prototype.markUsed=function(a,e){this._grid[Math.floor(e/
this._bucketSize)*this._colsLength+Math.floor(a/this._bucketSize)]+=1};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};return a}();a.CollisionGrid=g})},"*noref":1}});
define("require exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(g,a,e,k,h,f,n){Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"Stage",{enumerable:!0,get:function(){return e.Stage}});Object.defineProperty(a,"LabelManager",{enumerable:!0,get:function(){return k.default}});Object.defineProperty(a,"GraphicsView2D",{enumerable:!0,get:function(){return h.default}});Object.defineProperty(a,
"MapViewNavigation",{enumerable:!0,get:function(){return f.default}});Object.defineProperty(a,"MagnifierView2D",{enumerable:!0,get:function(){return n.default}})});