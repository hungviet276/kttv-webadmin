// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../core/accessorSupport/decorators ../../../geometry/support/aaBoundingRect ../tiling ./LayerView2D ./support/Display ../../layers/LayerView ../../layers/RefreshableLayerView".split(" "),function(B,C,d,f,r,t,u,v,w,x){var p=new Set,g=[],l=[],A=function(){return function(d,a,b,y,z,g,k,e,h){void 0===e&&(e=[0,0]);void 0===h&&(h=r.create());this.id=d;this.level=a;this.row=b;this.col=y;this.world=z;this.resolution=g;this.scale=k;this.coords=e;this.bounds=h}}();return function(m){function a(b){b=
m.call(this,b)||this;b._tileMap=new Map;b.container=new v.default(b);b.layer=null;b.tiles=[];return b}d.__extends(a,m);Object.defineProperty(a.prototype,"_tileInfoView",{get:function(){var b=this.layer&&this.layer.tileInfo;return b?new t.TileInfoView(b):null},enumerable:!1,configurable:!0});a.prototype.attach=function(){};a.prototype.detach=function(){};a.prototype.requestRender=function(){this.container.requestRender()};a.prototype.tilesChanged=function(b,a){};a.prototype.doRefresh=function(){return d.__awaiter(this,
void 0,void 0,function(){return d.__generator(this,function(b){return[2]})})};a.prototype.isUpdating=function(){return!1};a.prototype.update=function(b){var a=this._tileInfoView,d=this.tiles;if(a){a=a.getTileCoverage(b.state,0);b=a.spans;var a=a.lodInfo,f=a.level;if(b.length)for(var k=0;k<b.length;k++)for(var e=b[k],h=e.row,m=e.colTo,e=e.colFrom;e<=m;e++){var c=a.normalizeCol(e),q=a.getWorldForColumn(e),n=f+"/"+h+"/"+c+"/"+q;this._tileMap.has(n)||(c=new A(n,f,h,c,q,a.resolution,a.scale),a.getTileCoords(c.coords,
c,!1),a.getTileBounds(c.bounds,c,!0),this._tileMap.set(n,c),d.push(c),g.push(c));p.add(n)}}for(b=d.length-1;0<=b;b--)c=d[b],p.has(c.id)||(d.splice(b,1),l.push(c),this._tileMap.delete(c.id));if(g.length||l.length)this.tilesChanged(g,l),g.length=l.length=0;p.clear();this.requestRender()};a.prototype.moveStart=function(){};a.prototype.viewChange=function(){this.requestUpdate()};a.prototype.moveEnd=function(){};d.__decorate([f.property({dependsOn:["layer.loaded"]})],a.prototype,"_tileInfoView",null);
d.__decorate([f.property()],a.prototype,"layer",void 0);return a=d.__decorate([f.subclass("esri.views.2d.layers.BaseLayerView2D")],a)}(x.RefreshableLayerView(u.LayerView2DMixin(w)))});