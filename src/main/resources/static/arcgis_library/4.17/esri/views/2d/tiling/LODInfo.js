// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(r,t,p,q){function k(b,a,d){b[0]=a;b[1]=d;return b}var c=new q("0/0/0/0");return function(){function b(a,d,e,b,f,c,g,h,m,n,k,p){this.level=a;this.resolution=d;this.scale=e;this.origin=b;this.first=f;this.last=c;this.size=g;this.norm=h;this.worldStart=m;this.worldEnd=n;this.worldSize=k;this.wrap=p}b.create=function(a,d,e){var c=p.getInfo(a.spatialReference),f=[a.origin.x,a.origin.y],l=[a.size[0]*d.resolution,
a.size[1]*d.resolution],g=[-Infinity,-Infinity],h=[Infinity,Infinity],m=[Infinity,Infinity];e&&(k(g,Math.max(0,Math.floor((e.xmin-f[0])/l[0])),Math.max(0,Math.floor((f[1]-e.ymax)/l[1]))),k(h,Math.max(0,Math.floor((e.xmax-f[0])/l[0])),Math.max(0,Math.floor((f[1]-e.ymin)/l[1]))),k(m,h[0]-g[0]+1,h[1]-g[1]+1));var n;a.isWrappable?(a=[Math.ceil(Math.round((c.valid[1]-c.valid[0])/d.resolution)/a.size[0]),m[1]],c=[Math.floor((c.origin[0]-f[0])/l[0]),g[1]],e=[a[0]+c[0]-1,h[1]],n=!0):(c=g,e=h,a=m,n=!1);return new b(d.level,
d.resolution,d.scale,f,g,h,m,l,c,e,a,n)};b.prototype.normalizeCol=function(a){if(!this.wrap)return a;var d=this.worldSize[0];return 0>a?d-1-Math.abs((a+1)%d):a%d};b.prototype.denormalizeCol=function(a,d){return this.wrap?this.worldSize[0]*d+a:a};b.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};b.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};b.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+
this.first[0]+this.size[0]-1};b.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};b.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};b.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};b.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};b.prototype.getTileBounds=function(a,d,b){void 0===b&&(b=!1);c.set(d);var e=b?c.col:this.denormalizeCol(c.col,c.world),f=c.row;d=this.getXForColumn(e);b=this.getYForRow(f+
1);e=this.getXForColumn(e+1);f=this.getYForRow(f);a[0]=d;a[1]=b;a[2]=e;a[3]=f;return a};b.prototype.getTileCoords=function(a,b,e){void 0===e&&(e=!1);c.set(b);b=e?c.col:this.denormalizeCol(c.col,c.world);Array.isArray(a)?k(a,this.getXForColumn(b),this.getYForRow(c.row)):(a.x=this.getXForColumn(b),a.y=this.getYForRow(c.row));return a};return b}()});