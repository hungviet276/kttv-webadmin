// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","tslib","../../../../../core/Logger","../../../../../core/screenUtils"],function(y,h,r,w,t){function u(b){return("size"===b.type||"color"===b.type||"opacity"===b.type)&&null!=b.stops}function v(b){var a;var m=b.type;a=b.stops;if(!(8>=a.length))if(x.warn("Found "+a.length+" Visual Variable stops, but MapView only supports 8. Displayed stops will be simplified."),16<a.length){for(var h=a[0],f=a.slice(1),n=f.pop(),k=f[0].value,l=f[f.length-1].value,p=(l-k)/6,q=[];k<l;k+=p){for(var c=
0;k>=f[c].value;)c++;var d=f[c],g=a[c-1],e=k-g.value,d=d.value===g.value?1:e/(d.value-g.value);"color"===m?(g=f[c],c=a[c-1],e=g.color.clone(),e.r=(1-d)*c.color.r+d*e.r,e.g=(1-d)*c.color.g+d*e.g,e.b=(1-d)*c.color.b+d*e.b,e.a=(1-d)*c.color.a+d*e.a,q.push({value:k,color:e,label:g.label})):"size"===m?(g=f[c],e=a[c-1],c=t.toPt(g.size),e=t.toPt(e.size),q.push({value:k,size:(1-d)*e+d*c,label:g.label})):(g=f[c],q.push({value:k,opacity:(1-d)*a[c-1].opacity+d*g.opacity,label:g.label}))}a=r.__spreadArrays([h],
q,[n])}else{m=a[0];a=a.slice(1);for(h=a.pop();6<a.length;){n=f=0;for(l=1;l<a.length;l++)p=Math.abs(a[l].value-a[l-1].value),p>n&&(n=p,f=l);a.splice(f,1)}a=r.__spreadArrays([m],a,[h])}b.stops=a;return b}Object.defineProperty(h,"__esModule",{value:!0});h.simplifyVisualVariables=h.simplifyVVRenderer=void 0;var x=w.getLogger("esri.renderers.visualVariables.support.utils");h.simplifyVVRenderer=function(b){if(!("visualVariables"in b&&b.visualVariables&&b.visualVariables.length))return b;b=b.clone();var a=
b.visualVariables.map(function(a){return u(a)?v(a):a});b.visualVariables=a;return b};h.simplifyVisualVariables=function(b){return b.map(function(a){return u(a)?v(a.clone()):a})}});