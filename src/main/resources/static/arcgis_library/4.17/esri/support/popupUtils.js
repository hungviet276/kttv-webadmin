// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../PopupTemplate ../layers/support/fieldUtils ../popup/content ../popup/FieldInfo ../popup/support/FieldInfoFormat".split(" "),function(A,e,n,p,g,q,h){function r(a,b){var d=a;b&&(a=a.filter(function(a){return-1===b.indexOf(a.type)}));a===d&&(a=a.slice());a.sort(t);return a}function t(a,b){return"oid"===a.type?-1:"oid"===b.type?1:l(a)?-1:l(b)?1:(a.alias||a.name).toLocaleLowerCase().localeCompare((b.alias||b.name).toLocaleLowerCase())}function m(a,b){if(!a||!b)return!1;var d=
b.creationDateField,c=b.creatorField,f=b.editDateField;b=b.editorField;return-1!==[d&&d.toLowerCase(),c&&c.toLowerCase(),f&&f.toLowerCase(),b&&b.toLowerCase()].indexOf(a.toLowerCase())}function k(a,b){var d=a.editFieldsInfo,c=a.objectIdField;return r(a.fields,(null===b||void 0===b?void 0:b.ignoreFieldTypes)||u).map(function(a){var e=a.name,f;f=a.editable&&-1===v.indexOf(a.type)&&!m(a.name,d);return new q({fieldName:e,isEditable:f,label:a.alias,format:w(a),visible:x(a,{editFieldsInfo:d,objectIdField:c,
visibleFieldNames:null===b||void 0===b?void 0:b.visibleFieldNames})})})}function w(a){switch(a.type){case "small-integer":case "integer":case "single":return new h({digitSeparator:!0,places:0});case "double":return new h({digitSeparator:!0,places:2});case "date":return new h({dateFormat:"long-month-day-year"});default:return null}}function l(a){if("name"===(a.name&&a.name.toLowerCase())||"name"===(a.alias&&a.alias.toLowerCase()))return!0}Object.defineProperty(e,"__esModule",{value:!0});e.createFieldInfos=
e.createFieldsContent=e.createPopupTemplate=void 0;var y=["oid","global-id"],v=["oid","global-id","guid"];e.createPopupTemplate=function(a,b){var d=a.displayField,c=a.fields,e=a.title;if(!c)return null;a=k({editFieldsInfo:a.editFieldsInfo,fields:c,objectIdField:a.objectIdField},b);if(!a.length)return null;c={titleBase:e,fields:c,displayField:d};d=p.getDisplayFieldName(c);c=c.titleBase;d=d?c+": {"+d.trim()+"}":c;c=[new g.FieldsContent,new g.AttachmentsContent];return new n({title:d,content:c,fieldInfos:a})};
var z=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],x=function(a,b){var d=b.editFieldsInfo,c=b.objectIdField;return(b=b.visibleFieldNames)?b.has(a.name):m(a.name,d)?!1:c&&a.name===c?!1:-1<y.indexOf(a.type)?!1:!z.some(function(b){return b.test(a.name)})};e.createFieldsContent=function(a,b){return new g.FieldsContent({fieldInfos:k(a,b).filter(function(a){return a.visible})})};e.createFieldInfos=
k;var u=["geometry","blob","raster","guid","xml"]});