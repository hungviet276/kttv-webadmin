// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../core/maybe","../core/urlUtils"],function(n,d,g,e){function h(b,a){var c=a&&a.url&&a.url.path;b&&c&&(b=e.makeAbsolute(b,c,{preserveProtocolRelative:!0}),a.portalItem&&a.readResourcePaths&&(c=e.makeRelative(b,a.portalItem.itemUrl),l.test(c)&&a.readResourcePaths.push(a.portalItem.resourceFromPath(c).path)));return f(b,a&&a.portal)}function k(b,a){if(!b)return b;!e.isAbsolute(b)&&a&&a.blockedRelativeUrls&&a.blockedRelativeUrls.push(b);var c=e.makeAbsolute(b);if(a){var d=
a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.rootPath||a.url&&a.url.path;d&&(d=f(d,a.portal),c=e.makeRelative(f(c,a.portal),d,d),c!==b&&a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.writtenUrls.push(c))}b=c;c=(a=a&&a.portal)&&!a.isPortal&&a.urlKey&&a.customBaseUrl?e.changeDomain(b,a.urlKey+"."+a.customBaseUrl,a.portalHostname):b;e.isAbsolute(c)&&(c=e.normalize(c));return c}function f(b,a){if(!a||a.isPortal||!a.urlKey||!a.customBaseUrl)return b;var c=a.urlKey+"."+a.customBaseUrl;return e.hasSameOrigin(e.appUrl,
e.appUrl.scheme+"://"+c)?e.changeDomain(b,a.portalHostname,c):e.changeDomain(b,c,a.portalHostname)}Object.defineProperty(d,"__esModule",{value:!0});d.itemIdFromResourceUrl=d.write=d.read=d.toJSON=d.fromJSON=void 0;d.fromJSON=h;d.toJSON=k;d.read=function(b,a,c){return h(b,c)};d.write=function(b,a,c,d){b=k(b,d);void 0!==b&&(a[c]=b)};var m=/\/items\/([^\/]+)\/resources\//,l=/^\.\/resources\//;d.itemIdFromResourceUrl=function(b){b=g.isSome(b)?b.match(m):null;return g.isSome(b)?b[1]:null}});