// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../core/promiseUtils","../../../geometry/Extent","../../../layers/support/Field"],function(u,b,e,p,q){function f(a){return a instanceof Date}Object.defineProperty(b,"__esModule",{value:!0});b.stableStringify=b.extractServiceUrl=b.reduceArrayWithPromises=b.toEsriGeometryType=b.layerFieldEsriConstants=b.layerGeometryEsriRestConstants=b.layerGeometryEsriConstants=b.callback=b.errback=b.defaultMaxRecords=b.sameGeomType=b.convertLinearUnitsToCode=b.shapeExtent=b.convertSquareUnitsToCode=
b.cloneAttributes=b.equalityTest=b.isDate=b.isArray=b.isNumber=b.isBoolean=b.isString=b.IdState=b.esriFieldToJson=b.cloneField=b.FeatureServiceDatabaseType=void 0;(function(a){a[a.Standardised=0]="Standardised";a[a.StandardisedNoInterval=1]="StandardisedNoInterval";a[a.SqlServer=2]="SqlServer";a[a.Oracle=3]="Oracle";a[a.Postgres=4]="Postgres";a[a.PGDB=5]="PGDB";a[a.FILEGDB=6]="FILEGDB";a[a.NotEvaluated=7]="NotEvaluated"})(b.FeatureServiceDatabaseType||(b.FeatureServiceDatabaseType={}));b.cloneField=
function(a){return q.fromJSON(a.toJSON())};b.esriFieldToJson=function(a){return a.toJSON()};(function(a){a[a.InFeatureSet=0]="InFeatureSet";a[a.NotInFeatureSet=1]="NotInFeatureSet";a[a.Unknown=2]="Unknown"})(b.IdState||(b.IdState={}));b.isString=function(a){return"string"===typeof a||a instanceof String};b.isBoolean=function(a){return"boolean"===typeof a};b.isNumber=function(a){return"number"===typeof a};b.isArray=function(a){return a instanceof Array};b.isDate=f;b.equalityTest=function(a,b){return a===
b?!0:f(a)&&f(b)?a.getTime()===b.getTime():!1};b.cloneAttributes=function(a){var b={},c;for(c in a)b[c]=a[c];return b};b.convertSquareUnitsToCode=function(a){if(void 0===a)return null;if("number"===typeof a)return a;switch(a.toLowerCase()){case "meters":case "meter":return 109404;case "miles":case "mile":return 109413;case "kilometers":case "kilometer":case "km":return 109414}return null};b.shapeExtent=function(a){if(null===a)return null;switch(a.type){case "polygon":case "multipoint":case "polyline":return a.extent;
case "point":return new p({xmin:a.x,ymin:a.y,xmax:a.x,ymax:a.y,spatialReference:a.spatialReference});case "extent":return a}return null};b.convertLinearUnitsToCode=function(a){if(void 0===a)return null;if("number"===typeof a||"number"===typeof a)return a;switch(a.toLowerCase()){case "meters":case "meter":return 9001;case "miles":case "mile":return 9035;case "kilometers":case "kilometer":case "km":return 9036}return null};b.sameGeomType=function(a,b){return a===b||"point"===a&&"esriGeometryPoint"===
b||"polyline"===a&&"esriGeometryPolyline"===b||"polygon"===a&&"esriGeometryPolygon"===b||"extent"===a&&"esriGeometryEnvelope"===b||"multipoint"===a&&"esriGeometryMultipoint"===b||"point"===b&&"esriGeometryPoint"===a||"polyline"===b&&"esriGeometryPolyline"===a||"polygon"===b&&"esriGeometryPolygon"===a||"extent"===b&&"esriGeometryEnvelope"===a||"multipoint"===b&&"esriGeometryMultipoint"===a?!0:!1};b.defaultMaxRecords=1E3;b.errback=function(a){return function(b){a.reject(b)}};b.callback=function(a,b){return function(){try{a.apply(null,
arguments)}catch(c){b.reject(c)}}};b.layerGeometryEsriConstants={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",extent:"extent",esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",esriGeometryEnvelope:"extent",envelope:"extent"};b.layerGeometryEsriRestConstants={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",
esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryEnvelope:"esriGeometryEnvelope",envelope:"esriGeometryEnvelope"};b.layerFieldEsriConstants={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger","long":"esriFieldTypeLong",single:"esriFieldTypeSingle","double":"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate",oid:"esriFieldTypeOID",
geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID","global-id":"esriFieldTypeGlobalID",xml:"eesriFieldTypeXML",esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeOID:"esriFieldTypeOID",
esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",esriFieldTypeXML:"eesriFieldTypeXML"};b.toEsriGeometryType=function(a){switch(a){case "point":return"esriGeometryPoint";case "polygon":return"esriGeometryPolygon";case "multipoint":return"esriGeometryMultipoint";case "polyline":return"esriGeometryPolyline";default:return"esriGeometryPoint"}};
b.reduceArrayWithPromises=function(a,b){return e.create(function(g,r){var c=e.resolve(!0);a.reduce(function(a,g,h,k){return a.then(function(a){try{return b(a,g,h,k)}catch(t){return e.reject(t)}},function(a){return e.reject(a)})},c).then(g,r)})};b.extractServiceUrl=function(a){if(void 0===a)return"";a=a.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer");a=a.replace(/\/mapserver\/[0-9]*/i,"/MapServer");return a=a.split("?")[0]};b.stableStringify=function(a,b){b||(b={});"function"===typeof b&&(b={cmp:b});
var c="boolean"===typeof b.cycles?b.cycles:!1,e=b.cmp&&function(a){return function(b){return function(h,k){return a({key:h,value:b[h]},{key:k,value:b[k]})}}}(b.cmp),f=[];return function l(a){a&&a.toJSON&&"function"===typeof a.toJSON&&(a=a.toJSON());if(void 0!==a){if("number"===typeof a)return isFinite(a)?""+a:"null";if("object"!==typeof a)return JSON.stringify(a);var b,d;if(Array.isArray(a)){d="[";for(b=0;b<a.length;b++)b&&(d+=","),d+=l(a[b])||"null";return d+"]"}if(null===a)return"null";if(-1!==
f.indexOf(a)){if(c)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var h=f.push(a)-1,g=Object.keys(a).sort(e&&e(a));d="";for(b=0;b<g.length;b++){var m=g[b],n=l(a[m]);n&&(d&&(d+=","),d+=JSON.stringify(m)+":"+n)}f.splice(h,1);return"{"+d+"}"}}(a)}});