// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../geometry/Point","../../geometry/support/intersects"],function(x,e,p,u){function v(a,b,c){var d={x:0,y:0};b&&(d.z=0);c&&(d.m=0);for(var m=0,f=a[0],g=0;g<a.length;g++){var h=a[g],k;a:if(h.length!==f.length)k=!1;else{for(k=0;k<h.length;k++)if(h[k]!==f[k]){k=!1;break a}k=!0}if(!1===k){k=w(f,h,b);var e=h,l=b,n=c,q={x:(f[0]+e[0])/2,y:(f[1]+e[1])/2};l&&(q.z=(f[2]+e[2])/2);l&&n?q.m=(f[3]+e[3])/2:n&&(q.m=(f[2]+e[2])/2);f=q;f.x*=k;f.y*=k;d.x+=f.x;d.y+=f.y;b&&(f.z*=k,d.z+=
f.z);c&&(f.m*=k,d.m+=f.m);m+=k;f=h}}0<m?(d.x/=m,d.y/=m,b&&(d.z/=m),c&&(d.m/=m)):(d.x=a[0][0],d.y=a[0][1],b&&(d.z=a[0][2]),c&&b?d.m=a[0][3]:c&&(d.m=a[0][2]));return d}function w(a,b,c){var d=b[0]-a[0];a=b[1]-a[1];return c?(b=b[2]-b[2],Math.sqrt(d*d+a*a+b*b)):Math.sqrt(d*d+a*a)}function n(a,b,c){for(void 0===c&&(c=0);a<c;)a+=b;for(c+=b;a>=c;)a-=b;return a}function r(a,b){return Math.atan2(b.y-a.y,b.x-a.x)}function t(a,b,c){var d=a.x-b.x;a=a.y-b.y;var m=c.x-b.x;b=c.y-b.y;return Math.atan2(m*a-d*b,m*
d+b*a)}Object.defineProperty(e,"__esModule",{value:!0});e.pathsSelfIntersecting=e.bearingBetween2D=e.angleBetween2D=e.angleBetweenRad=e.bearing2D=e.angle2D=e.angleRad=e.centroidMultiPoint=e.centroidPolyline=void 0;e.centroidPolyline=function(a){for(var b={x:0,y:0,spatialReference:a.spatialReference.toJSON()},c={x:0,y:0,spatialReference:a.spatialReference.toJSON()},d=0,m=0,f=0;f<a.paths.length;f++)if(0!==a.paths[f].length){var g;g=a.paths[f];var h=!0===a.hasZ;if(1>=g.length)g=0;else{for(var k=0,e=
1;e<g.length;e++)k+=w(g[e-1],g[e],h);g=k}0===g?(h=v(a.paths[f],!0===a.hasZ,!0===a.hasM),b.x+=h.x,b.y+=h.y,!0===a.hasZ&&(b.z+=h.z),!0===a.hasM&&(b.m+=h.m),++d):(h=v(a.paths[f],!0===a.hasZ,!0===a.hasM),c.x+=h.x*g,c.y+=h.y*g,!0===a.hasZ&&(c.z+=h.z*g),!0===a.hasM&&(c.m+=h.m*g),m+=g)}return 0<m?(c.x/=m,c.y/=m,!0===a.hasZ&&(c.z/=m),!0===a.hasM&&(c.m/=m),new p(c)):0<d?(b.x/=d,b.y/=d,!0===a.hasZ&&(c.z/=d),!0===a.hasM&&(b.m/=d),new p(b)):null};e.centroidMultiPoint=function(a){if(0===a.points.length)return null;
for(var b=0,c=0,d=0,e=0,f=0;f<a.points.length;f++){var g=a.getPoint(f);!0===g.hasZ&&(d+=g.z);!0===g.hasM&&(e+=g.m);b+=g.x;c+=g.y;e+=g.m}b={x:b/a.points.length,y:c/a.points.length,spatialReference:null};b.spatialReference=a.spatialReference.toJSON();!0===a.hasZ&&(b.z=d/a.points.length);!0===a.hasM&&(b.m=e/a.points.length);return new p(b)};e.angleRad=r;e.angle2D=function(a,b){return n(r(a,b),2*Math.PI)*(180/Math.PI)};e.bearing2D=function(a,b){return n(Math.PI/2-r(a,b),2*Math.PI)*(180/Math.PI)};e.angleBetweenRad=
t;e.angleBetween2D=function(a,b,c){return n(t(a,b,c),2*Math.PI)*(180/Math.PI)};e.bearingBetween2D=function(a,b,c){return n(-1*t(a,b,c),2*Math.PI)*(180/Math.PI)};var l=[0,0];e.pathsSelfIntersecting=function(a){for(var b=0;b<a.length;b++){for(var c=a[b],d=0;d<c.length-1;d++)for(var e=c[d],f=c[d+1],g=b+1;g<a.length;g++)for(var h=0;h<a[g].length-1;h++){var k=a[g][h],n=a[g][h+1],p=u.segmentIntersects(e,f,k,n,l);if(p&&!(l[0]===e[0]&&l[1]===e[1]||l[0]===k[0]&&l[1]===k[1]||l[0]===f[0]&&l[1]===f[1]||l[0]===
n[0]&&l[1]===n[1]))return!0}h=c.length;if(!(3>h))for(d=0;d<=h-2;d++)for(e=c[d],f=c[d+1],g=d+2;g<=h-2;g++)if(k=c[g],n=c[g+1],(p=u.segmentIntersects(e,f,k,n,l))&&!(l[0]===e[0]&&l[1]===e[1]||l[0]===k[0]&&l[1]===k[1]||l[0]===f[0]&&l[1]===f[1]||l[0]===n[0]&&l[1]===n[1]))return!0}return!1}});