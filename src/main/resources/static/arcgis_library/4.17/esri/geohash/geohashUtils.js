// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports"],function(G,b){function v(a){return 57>=a?a-48:104>=a?a-88:107>=a?a-89:110>=a?a-90:a-91}function w(a,e,g){a[0]=e;a[1]=g;return a}function q(a,e){var g=(a[0]+a[1])/2,h=!e;a[0]=h*a[0]+e*g;a[1]=h*g+e*a[1]}function u(a,e){e=e>(a[0]+a[1])/2;q(a,e);return e}function B(a,e){for(var g=w(C,-90,90),h=w(D,-180,180),f=0;f<e.length;f++){var c=e.charCodeAt(f),c=v(c);0===f%2?(q(h,!!(16&c)),q(h,!!(4&c)),q(h,!!(1&c)),q(g,!!(8&c)),q(g,!!(2&c))):(q(g,!!(16&c)),q(g,!!(4&c)),q(g,!!(1&c)),q(h,
!!(8&c)),q(h,!!(2&c)))}a[0]=(g[0]+g[1])/2;a[1]=(h[0]+h[1])/2;return a}function y(a,e,g){for(var h="",f=w(C,-90,90),c=w(D,-180,180),l=0;l<g;l++){var d=0;l%2?(d|=u(f,a)<<4,d|=u(c,e)<<3,d|=u(f,a)<<2,d|=u(c,e)<<1,d|=u(f,a)<<0):(d|=u(c,e)<<4,d|=u(f,a)<<3,d|=u(c,e)<<2,d|=u(f,a)<<1,d|=u(c,e)<<0);h+="0123456789bcdefghjkmnpqrstuvwxyz"[d]}return h}function z(a){return 180/Math.pow(2,Math.floor(5*a/2))}function A(a){return 360/Math.pow(2,Math.ceil(5*a/2))}function E(a,e){return e?1&a|(4&a)>>1|(16&a)>>2:(2&a)>>
1|(8&a)>>2}function F(a,e){return e?(2&a)>>1|(8&a)>>2:1&a|(4&a)>>1|(16&a)>>2}function x(a,e,g){var h=!((a.length-1)%2),f=a.substring(0,a.length-1),c=v(a.charCodeAt(a.length-1)),l=0,d=0,b=0,k=0;h?(l=8,d=4,b=1&c|(4&c)>>1|(16&c)>>2,k=(2&c)>>1|(8&c)>>2):(l=4,d=8,k=1&c|(4&c)>>1|(16&c)>>2,b=(2&c)>>1|(8&c)>>2);e=b+e;c=k+g;g=Math.floor(e/l);k=Math.floor(c/d);l=e-g*l;d=c-k*d;h="0123456789bcdefghjkmnpqrstuvwxyz"[h?l&1|(d&1)<<1|(l&2)<<1|(d&2)<<2|(l&4)<<2:d&1|(l&1)<<1|(d&2)<<1|(l&2)<<2|(d&4)<<2];return 1<a.length&&
(g||k)?x(f,g,k)+h:f+h}Object.defineProperty(b,"__esModule",{value:!0});b.forEachIntersectingGeohash=b.getIntersectingGeohashes=b.getRelativeGeohash=b.unpackYBits=b.unpackXBits=b.lonDistPerGeohash=b.latDistPerGeohash=b.encodeGeohash=b.setGeohashBuf=b.setGeohashXY=b.decodeGeohashXY=b.convertGeohash32ToXY=b.decodeGeohash=b.encodeBase32Char=b.decodeBase32Char=void 0;var C=new Float64Array(2),D=new Float64Array(2);b.decodeBase32Char=v;b.encodeBase32Char=function(a){return"0123456789bcdefghjkmnpqrstuvwxyz"[a]};
b.decodeGeohash=B;b.convertGeohash32ToXY=function(a,e){for(var g=a=0,h=30,f=30,c=0;c<e.length;c++){var l=e.charCodeAt(c),d=v(l),l=0===c%2,b=E(d,l),d=F(d,l),h=h-(l?3:2),f=f-(l?2:3);a|=b<<h;g|=d<<f}return{geohashX:a,geohashY:g}};b.decodeGeohashXY=function(a,e){for(var g=-90,h=90,f=-180,c=180,l=0;l<e;l++){for(var d=Math.ceil((l+1)/2),b=Math.floor((l+1)/2),k=1-l%2,r=30-(3*d+2*b),p=30-(2*d+3*b),d=2*k+3*(1-k),b=(7*k+3*(1-k)<<r&a.geohashX)>>r,r=(3*k+7*(1-k)<<p&a.geohashY)>>p,k=3*k+2*(1-k)-1;0<=k;k--)var p=
(f+c)/2,n=b&1<<k?1:0,f=(1-n)*f+n*p,c=(1-n)*p+n*c;for(k=d-1;0<=k;k--)d=(g+h)/2,b=r&1<<k?1:0,g=(1-b)*g+b*d,h=(1-b)*d+b*h}return[f,g,c,h]};b.setGeohashXY=function(a,e,b,h){h%2&&(h+=1);for(var f=0,c=0,l=-90,d=90,g=-180,k=180,r=0;r<h/2;r++){for(var p=0;5>p;p++)var n=(g+k)/2,m=b>n?1:0,f=f|m<<29-(p+5*r),g=(1-m)*g+m*n,k=(1-m)*n+m*k;for(p=0;5>p;p++)n=(l+d)/2,m=e>n?1:0,c|=m<<29-(p+5*r),l=(1-m)*l+m*n,d=(1-m)*n+m*d}a.geohashX=f;a.geohashY=c};b.setGeohashBuf=function(a,b,g,h,f){f%2&&(f+=1);for(var c=0,e=0,d=-90,
q=90,k=-180,r=180,p=0;p<f/2;p++){for(var n=0;5>n;n++)var m=(k+r)/2,t=h>m?1:0,c=c|t<<29-(n+5*p),k=(1-t)*k+t*m,r=(1-t)*m+t*r;for(n=0;5>n;n++)m=(d+q)/2,t=g>m?1:0,e|=t<<29-(n+5*p),d=(1-t)*d+t*m,q=(1-t)*m+t*q}a[2*b]=c;a[2*b+1]=e};b.encodeGeohash=y;b.latDistPerGeohash=z;b.lonDistPerGeohash=A;b.unpackXBits=E;b.unpackYBits=F;b.getRelativeGeohash=x;b.getIntersectingGeohashes=function(a,b,g,h,f){g=Math.abs(g-a);h=Math.abs(h-b);var c=z(f),e=A(f);h=Math.ceil(h/e);g=Math.ceil(g/c);a=y(a,b,f);b=[];for(f=0;f<h;f++)for(c=
0;c<g;c++)b.push(x(a,f,c));return b};b.forEachIntersectingGeohash=function(a,b,g,h,f,c){var e=Math.abs(g-a),d=Math.abs(h-b),q=z(f),k=A(f),d=Math.ceil(d/k),e=Math.ceil(e/q);f=y(a,b,f);for(var r=0;r<d;r++)for(var p=0;p<e;p++){var n=x(f,r,p),m=B([0,0],n),t=m[0],m=m[1];c(n,Math.abs((Math.min(g,t+q/2)-Math.max(a,t-q/2))*(Math.min(h,m+k/2)-Math.max(b,m-k/2)))/(q*k))}}});