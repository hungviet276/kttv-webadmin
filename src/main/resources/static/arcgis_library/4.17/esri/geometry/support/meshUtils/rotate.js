// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/Logger ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f64 ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f64 ../../../core/libs/gl-matrix-2/quat ../../../core/libs/gl-matrix-2/quatf64 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../core/libs/gl-matrix-2/vec4f64 ./projection ../../../views/3d/support/pointUtils ../../../views/3d/support/projectionUtils".split(" "),function(I,f,
C,D,E,w,F,h,x,t,u,G,m,v,r){function n(b,d,a,e){void 0===e&&(e=u.vec3f64.ZEROS);if(b)for(w.mat4.identity(p),w.mat4.rotate(p,p,d[3],d),d=0;d<b.length;d+=a){for(var c=0;3>c;c++)k[c]=b[d+c]-e[c];t.vec3.transformMat4(k,k,p);for(c=0;3>c;c++)b[d+c]=k[c]+e[c]}}Object.defineProperty(f,"__esModule",{value:!0});f.axisAngleMultiply=f.axisAngleFrom=f.rotate=void 0;var H=C.getLogger("esri.geometry.support.meshUtils.rotate");f.rotate=function(b,d,a){if(b.vertexAttributes&&b.vertexAttributes.position&&0!==d[3]){var e=
b.spatialReference,c=a&&a.origin||b.extent.center;if(e.isWGS84||e.isWebMercator&&(!a||!1!==a.geographic)){a=b.spatialReference;e=y;v.pointToVector(c,e,r.SphericalECEFSpatialReference)||v.pointToVector(b.extent.center,e,r.SphericalECEFSpatialReference);var c=b.vertexAttributes.position,f=b.vertexAttributes.normal,q=b.vertexAttributes.tangent,l=new Float64Array(c.length),h=new Float32Array(f?f.length:0),k=new Float32Array(q?q.length:0);r.computeLinearTransformation(r.SphericalECEFSpatialReference,e,
p,r.SphericalECEFSpatialReference);D.mat3.fromMat4(z,p);var g=A;t.vec3.transformMat3(A,d,z);g[3]=d[3];m.projectToECEF(c,a,l);f&&m.projectNormalToECEF(f,c,l,a,h);q&&m.projectTangentToECEF(q,c,l,a,k);n(l,g,3,e);m.projectFromECEF(l,c,a);f&&(n(h,g,3),m.projectNormalFromECEF(h,c,l,a,f));q&&(n(k,g,4),m.projectTangentFromECEF(k,c,l,a,q))}else a=y,v.pointToVector(c,a,b.spatialReference)||(e=b.extent.center,a[0]=e.x,a[1]=e.y,a[2]=e.z,H.error("Failed to project specified origin (wkid:"+c.spatialReference.wkid+
") to mesh spatial reference (wkid:"+b.spatialReference.wkid+"). Using mesh extent.center instead")),n(b.vertexAttributes.position,d,3,a),n(b.vertexAttributes.normal,d,3),n(b.vertexAttributes.tangent,d,4);b.clearCache()}};f.axisAngleFrom=function(b,d,a){t.vec3.copy(a,b);a[3]=d;return a};f.axisAngleMultiply=function(b,d,a){h.quat.setAxisAngle(g,b,b[3]);h.quat.setAxisAngle(B,d,d[3]);h.quat.multiply(g,B,g);a[3]=h.quat.getAxisAngle(a,g);return a};var k=u.vec3f64.create(),A=G.vec4f64.create(),g=x.quatf64.create(),
B=x.quatf64.create(),p=F.mat4f64.create(),z=E.mat3f64.create(),y=u.vec3f64.create()});