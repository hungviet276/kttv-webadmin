// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/Logger ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f64 ../../../core/libs/gl-matrix-2/vec3f64 ./projection ../../../views/3d/support/pointUtils ../../../views/3d/support/projectionUtils".split(" "),function(y,k,x,p,t,u,l,m,e){Object.defineProperty(k,"__esModule",{value:!0});k.centerAt=void 0;var r=x.getLogger("esri.geometry.support.meshUtils.centerAt");k.centerAt=function(b,a,c){if(b.vertexAttributes&&b.vertexAttributes.position){var f=
b.spatialReference,d=c&&c.origin||b.extent.center;if(f.isWGS84||f.isWebMercator&&(!c||!1!==c.geographic)){c=b.spatialReference;var f=v,g=w;if(m.pointToVector(a,g,e.SphericalECEFSpatialReference)){m.pointToVector(d,f,e.SphericalECEFSpatialReference)||m.pointToVector(b.extent.center,f,e.SphericalECEFSpatialReference);d=b.vertexAttributes.position;a=b.vertexAttributes.normal;var n=new Float64Array(d.length),k=new Float32Array(a?a.length:0);l.projectToECEF(d,c,n);a&&l.projectNormalToECEF(a,d,n,c,k);e.computeLinearTransformation(e.SphericalECEFSpatialReference,
f,q,e.SphericalECEFSpatialReference);e.computeLinearTransformation(e.SphericalECEFSpatialReference,g,h,e.SphericalECEFSpatialReference);p.mat4.invert(q,q);p.mat4.multiply(h,h,q);l.transformBufferInPlace(n,h);p.mat4.invert(h,h);p.mat4.transpose(h,h);a&&l.transformBufferInPlace(k,h,!0);l.projectFromECEF(n,d,c);a&&l.projectNormalFromECEF(k,d,n,c,a);b.clearCache()}else r.error("Failed to project centerAt location (wkid:"+a.spatialReference.wkid+") to ECEF")}else if(c=v,f=w,m.pointToVector(a,f,b.spatialReference)){m.pointToVector(d,
c,b.spatialReference)||(a=b.extent.center,c[0]=a.x,c[1]=a.y,c[2]=a.z,r.error("Failed to project specified origin (wkid:"+d.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+"). Using mesh extent.center instead"));if(d=b.vertexAttributes.position)for(a=0;a<d.length;a+=3)for(g=0;3>g;g++)d[a+g]+=f[g]-c[g];b.clearCache()}else r.error("Failed to project centerAt location (wkid:"+a.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+")")}};
var w=u.vec3f64.create(),v=u.vec3f64.create(),q=t.mat4f64.create(),h=t.mat4f64.create()});