// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../../../core/compilerUtils ../../../../../core/Error ../../../../../core/maybe ../../../../../core/promiseUtils".split(" "),function(m,c,e,g,f,h,k){function l(a){if(a instanceof HTMLCanvasElement)return a;if(a instanceof HTMLVideoElement)return null;var b=document.createElement("canvas");b.width=a.width;b.height=a.height;var d=b.getContext("2d");a instanceof HTMLImageElement?d.drawImage(a,0,0,a.width,a.height):a instanceof ImageData?d.putImageData(a,a.width,a.height):
g.neverReached(a);return b}Object.defineProperty(c,"__esModule",{value:!0});c.isArrayBufferPNG=c.encodeBase64DataUri=c.imageToArrayBuffer=c.imageToDataURI=void 0;c.imageToDataURI=function(a){a=l(a);return h.isSome(a)?a.toDataURL():""};c.imageToArrayBuffer=function(a){return e.__awaiter(this,void 0,void 0,function(){var b,d,c=this;return e.__generator(this,function(g){b=l(a);if(h.isNone(b))throw new f("imageToArrayBuffer","Unsupported image type");d=function(a){return e.__awaiter(c,void 0,void 0,function(){var b,
c;return e.__generator(this,function(d){if(!a)throw new f("imageToArrayBuffer","Unable to convert image to PNG");b=new FileReader;c=k.create(function(a){b.addEventListener("loadend",function(){a(b.result)})});b.readAsArrayBuffer(a);return[2,c]})})};if(b.toBlob)return[2,k.create(function(a,c){b.toBlob(function(b){d(b).then(a,c)},"image/png")})];if("msToBlob"in b)return[2,d(b.msToBlob())];throw new f("imageToArrayBuffer","Could not convert canvas to blob");})})};c.encodeBase64DataUri=function(a){var b=
[];a=new Uint8Array(a);for(var c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return"data:application/octet-stream;base64,"+btoa(b.join(""))};c.isArrayBufferPNG=function(a){if(8>a.byteLength)return!1;a=new Uint8Array(a);return 137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]&&13===a[4]&&10===a[5]&&26===a[6]&&10===a[7]}});