// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../../Logger ../../../object ../../../Warning ../../metadata ./type".split(" "),function(G,k,y,z,A,B,C){function t(a){var b,c,d,e=null!==(b=a.ndimArray)&&void 0!==b?b:0;if(1<e)return D(a);if(1===e)return u(a);if("type"in a&&v(a.type)){b=null===(d=null===(c=a.type.prototype)||void 0===c?void 0:c.itemType)||void 0===d?void 0:d.Type;var h=u("function"===typeof b?{type:b}:{types:b});return function(b,c,e){return(b=h(b,c,e))?new a.type(b):b}}return m(a)}function m(a){return"type"in
a?E(a.type):F(a.types)}function E(a){return a.prototype.read?function(b,c,d){if(null==b)return b;c=typeof b;if("object"!==c)q.error("Expected JSON value of type 'object' to deserialize type '"+a.prototype.declaredClass+"', but got '"+c+"'");else return c=new a,c.read(b,d),c}:a.fromJSON}function w(a,b,c,d){return 0!==d&&Array.isArray(b)?b.map(function(b){return w(a,b,c,d-1)}):a(b,void 0,c)}function D(a){var b,c=m(a),d=w.bind(null,c),e=null!==(b=a.ndimArray)&&void 0!==b?b:0;return function(a,b,c){if(null==
a)return a;a=d(a,c,e);b=e;for(c=a;0<b&&Array.isArray(c);)b--,c=c[0];if(void 0!==c)for(c=0;c<b;c++)a=[a];return a}}function u(a){var b=m(a);return function(a,d,e){if(null==a)return a;if(Array.isArray(a)){d=[];for(var c=0;c<a.length;c++){var l=b(a[c],void 0,e);void 0!==l&&d.push(l)}return d}a=b(a,void 0,e);return void 0!==a?[a]:void 0}}function v(a){return C.isCollection(a)?(a=a.prototype.itemType)&&a.Type?"function"===typeof a.Type?r(a.Type):x(a.Type):!1:!1}function r(a){return Array.isArray(a)?!1:
!!a&&a.prototype&&("read"in a.prototype||"fromJSON"in a||v(a))}function x(a){for(var b in a.typeMap)if(!r(a.typeMap[b]))return!1;return!0}function F(a){var b,c=null,d=null!==(b=a.errorContext)&&void 0!==b?b:"type";return function(b,h,l){if(null==b)return b;h=typeof b;if("object"!==h)q.error("Expected JSON value of type 'object' to deserialize, but got '"+h+"'");else{if(!c){var f,e;h={};for(var k in a.typeMap){var p=a.typeMap[k],g=B.getOwnClassMetadata(p.prototype);if("function"!==typeof a.key&&(g=
g.properties[a.key]))if((null===(f=g.json)||void 0===f?0:f.type)&&Array.isArray(g.json.type)&&1===g.json.type.length&&"string"===typeof g.json.type[0]&&(h[g.json.type[0]]=p),(g=null===(e=g.json)||void 0===e?void 0:e.write)&&g.writer){var n=g.target,n="string"===typeof n?n:a.key,m={};g.writer(k,m,n);m[n]&&(h[m[n]]=p)}else h[k]=p}c=h}f=a.key;if("string"===typeof f){if(e=(f=b[f])?c[f]:a.defaultKeyValue?a.typeMap[a.defaultKeyValue]:void 0)return f=new e,f.read(b,l),f;f="Type '"+(f||"unknown")+"' is not supported";
l&&l.messages&&b&&l.messages.push(new A(d+":unsupported",f,{definition:b,context:l}));q.error(f)}}}}Object.defineProperty(k,"__esModule",{value:!0});k.createTypeReader=k.create=void 0;var q=y.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");k.create=function(a,b,c){var d,e;!a||!c&&!b.read||null!==(d=b.read)&&void 0!==d&&d.reader||!1===(null===(e=b.read)||void 0===e?void 0:e.enabled)||(c="types"in a?x(a.types):r(a.type),c&&z.setDeepValue("read.reader",t(a),b))};k.createTypeReader=
t});