// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../factories/vec3f64","./common"],function(Q,d,O,x){function K(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function L(a,b,c){var e=b[0],h=b[1],k=b[2],g=b[3],m=b[4],f=b[5],l=b[6],n=b[7],q=b[8],d=b[9],p=b[10],u=b[11],t=b[12],v=b[13],C=b[14];b=b[15];var w=c[0],y=c[1],z=c[2],A=c[3];a[0]=w*e+y*m+z*q+A*t;a[1]=w*h+y*f+z*d+A*v;a[2]=w*k+y*l+z*p+A*C;a[3]=w*g+y*n+z*u+A*b;w=c[4];y=c[5];z=c[6];A=
c[7];a[4]=w*e+y*m+z*q+A*t;a[5]=w*h+y*f+z*d+A*v;a[6]=w*k+y*l+z*p+A*C;a[7]=w*g+y*n+z*u+A*b;w=c[8];y=c[9];z=c[10];A=c[11];a[8]=w*e+y*m+z*q+A*t;a[9]=w*h+y*f+z*d+A*v;a[10]=w*k+y*l+z*p+A*C;a[11]=w*g+y*n+z*u+A*b;w=c[12];y=c[13];z=c[14];A=c[15];a[12]=w*e+y*m+z*q+A*t;a[13]=w*h+y*f+z*d+A*v;a[14]=w*k+y*l+z*p+A*C;a[15]=w*g+y*n+z*u+A*b;return a}function M(a,b,c){var e=b[0],h=b[1],k=b[2],g=b[3],m=e+e,f=h+h,l=k+k;b=e*m;var n=e*f,e=e*l,q=h*f,h=h*l,k=k*l,m=g*m,f=g*f,g=g*l;a[0]=1-(q+k);a[1]=n+g;a[2]=e-f;a[3]=0;a[4]=
n-g;a[5]=1-(b+k);a[6]=h+m;a[7]=0;a[8]=e+f;a[9]=h-m;a[10]=1-(b+q);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a}function N(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];a[13]=b[13]-c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a}Object.defineProperty(d,"__esModule",{value:!0});d.sub=d.mul=d.equals=d.exactEquals=d.multiplyScalarAndAdd=
d.multiplyScalar=d.subtract=d.add=d.frob=d.str=d.targetTo=d.lookAt=d.ortho=d.perspectiveFromFieldOfView=d.perspective=d.frustum=d.fromQuat=d.fromRotationTranslationScaleOrigin=d.fromRotationTranslationScale=d.getRotation=d.getScaling=d.getTranslation=d.fromQuat2=d.fromRotationTranslation=d.fromZRotation=d.fromYRotation=d.fromXRotation=d.fromRotation=d.fromScaling=d.fromTranslation=d.rotateZ=d.rotateY=d.rotateX=d.rotate=d.scale=d.translate=d.multiply=d.determinant=d.adjoint=d.invert=d.transpose=d.identity=
d.set=d.copy=void 0;d.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};d.set=function(a,b,c,e,h,k,g,m,f,l,n,q,d,p,u,t,v){a[0]=b;a[1]=c;a[2]=e;a[3]=h;a[4]=k;a[5]=g;a[6]=m;a[7]=f;a[8]=l;a[9]=n;a[10]=q;a[11]=d;a[12]=p;a[13]=u;a[14]=t;a[15]=v;return a};d.identity=K;d.transpose=function(a,b){if(a===b){var c=b[1],e=b[2],h=b[3],k=b[6],g=b[7],m=b[11];a[1]=
b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=e;a[9]=k;a[11]=b[14];a[12]=h;a[13]=g;a[14]=m}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};d.invert=function(a,b){var c=b[0],e=b[1],h=b[2],k=b[3],g=b[4],m=b[5],f=b[6],l=b[7],n=b[8],d=b[9],r=b[10],p=b[11],u=b[12],t=b[13],v=b[14];b=b[15];var C=c*m-e*g,w=c*f-h*g,y=c*l-k*g,z=e*f-h*m,A=e*l-k*m,x=h*l-k*f,D=
n*t-d*u,E=n*v-r*u,F=n*b-p*u,G=d*v-r*t,H=d*b-p*t,I=r*b-p*v,B=C*I-w*H+y*G+z*F-A*E+x*D;if(!B)return null;B=1/B;a[0]=(m*I-f*H+l*G)*B;a[1]=(h*H-e*I-k*G)*B;a[2]=(t*x-v*A+b*z)*B;a[3]=(r*A-d*x-p*z)*B;a[4]=(f*F-g*I-l*E)*B;a[5]=(c*I-h*F+k*E)*B;a[6]=(v*y-u*x-b*w)*B;a[7]=(n*x-r*y+p*w)*B;a[8]=(g*H-m*F+l*D)*B;a[9]=(e*F-c*H-k*D)*B;a[10]=(u*A-t*y+b*C)*B;a[11]=(d*y-n*A-p*C)*B;a[12]=(m*E-g*G-f*D)*B;a[13]=(c*G-e*E+h*D)*B;a[14]=(t*w-u*z-v*C)*B;a[15]=(n*z-d*w+r*C)*B;return a};d.adjoint=function(a,b){var c=b[0],e=b[1],
h=b[2],k=b[3],g=b[4],m=b[5],f=b[6],l=b[7],n=b[8],d=b[9],r=b[10],p=b[11],u=b[12],t=b[13],v=b[14];b=b[15];a[0]=m*(r*b-p*v)-d*(f*b-l*v)+t*(f*p-l*r);a[1]=-(e*(r*b-p*v)-d*(h*b-k*v)+t*(h*p-k*r));a[2]=e*(f*b-l*v)-m*(h*b-k*v)+t*(h*l-k*f);a[3]=-(e*(f*p-l*r)-m*(h*p-k*r)+d*(h*l-k*f));a[4]=-(g*(r*b-p*v)-n*(f*b-l*v)+u*(f*p-l*r));a[5]=c*(r*b-p*v)-n*(h*b-k*v)+u*(h*p-k*r);a[6]=-(c*(f*b-l*v)-g*(h*b-k*v)+u*(h*l-k*f));a[7]=c*(f*p-l*r)-g*(h*p-k*r)+n*(h*l-k*f);a[8]=g*(d*b-p*t)-n*(m*b-l*t)+u*(m*p-l*d);a[9]=-(c*(d*b-p*
t)-n*(e*b-k*t)+u*(e*p-k*d));a[10]=c*(m*b-l*t)-g*(e*b-k*t)+u*(e*l-k*m);a[11]=-(c*(m*p-l*d)-g*(e*p-k*d)+n*(e*l-k*m));a[12]=-(g*(d*v-r*t)-n*(m*v-f*t)+u*(m*r-f*d));a[13]=c*(d*v-r*t)-n*(e*v-h*t)+u*(e*r-h*d);a[14]=-(c*(m*v-f*t)-g*(e*v-h*t)+u*(e*f-h*m));a[15]=c*(m*r-f*d)-g*(e*r-h*d)+n*(e*f-h*m);return a};d.determinant=function(a){var b=a[0],c=a[1],e=a[2],h=a[3],k=a[4],g=a[5],m=a[6],f=a[7],d=a[8],n=a[9],q=a[10],r=a[11],p=a[12],u=a[13],t=a[14];a=a[15];return(b*g-c*k)*(q*a-r*t)-(b*m-e*k)*(n*a-r*u)+(b*f-h*k)*
(n*t-q*u)+(c*m-e*g)*(d*a-r*p)-(c*f-h*g)*(d*t-q*p)+(e*f-h*m)*(d*u-n*p)};d.multiply=L;d.translate=function(a,b,c){var e=c[0],h=c[1];c=c[2];var k=void 0,g=void 0,m=void 0,f=void 0,d=void 0,n=void 0,q=void 0,r=void 0,p=void 0,u=void 0,t=void 0,v=void 0;b===a?(a[12]=b[0]*e+b[4]*h+b[8]*c+b[12],a[13]=b[1]*e+b[5]*h+b[9]*c+b[13],a[14]=b[2]*e+b[6]*h+b[10]*c+b[14],a[15]=b[3]*e+b[7]*h+b[11]*c+b[15]):(k=b[0],g=b[1],m=b[2],f=b[3],d=b[4],n=b[5],q=b[6],r=b[7],p=b[8],u=b[9],t=b[10],v=b[11],a[0]=k,a[1]=g,a[2]=m,a[3]=
f,a[4]=d,a[5]=n,a[6]=q,a[7]=r,a[8]=p,a[9]=u,a[10]=t,a[11]=v,a[12]=k*e+d*h+p*c+b[12],a[13]=g*e+n*h+u*c+b[13],a[14]=m*e+q*h+t*c+b[14],a[15]=f*e+r*h+v*c+b[15]);return a};d.scale=function(a,b,c){var e=c[0],h=c[1];c=c[2];a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;a[3]=b[3]*e;a[4]=b[4]*h;a[5]=b[5]*h;a[6]=b[6]*h;a[7]=b[7]*h;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};d.rotate=function(a,b,c,e){var h=e[0],k=e[1];e=e[2];var g=Math.sqrt(h*h+k*k+e*e),
d=void 0,f=void 0,l=void 0,n=void 0,q=void 0,r=void 0,p=void 0,u=void 0,t=void 0,v=void 0,C=void 0,w=void 0,y=void 0,z=void 0,A=void 0,J=void 0,D=void 0,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0,f=d=void 0;if(g<x.EPSILON)return null;g=1/g;h*=g;k*=g;e*=g;d=Math.sin(c);f=Math.cos(c);l=1-f;n=b[0];q=b[1];r=b[2];p=b[3];u=b[4];t=b[5];v=b[6];C=b[7];w=b[8];y=b[9];z=b[10];A=b[11];J=h*h*l+f;D=k*h*l+e*d;E=e*h*l-k*d;F=h*k*l-e*d;G=k*k*l+f;H=e*k*l+h*d;I=h*e*l+k*d;d=k*e*l-h*d;f=e*e*l+f;a[0]=n*J+u*D+w*E;a[1]=
q*J+t*D+y*E;a[2]=r*J+v*D+z*E;a[3]=p*J+C*D+A*E;a[4]=n*F+u*G+w*H;a[5]=q*F+t*G+y*H;a[6]=r*F+v*G+z*H;a[7]=p*F+C*G+A*H;a[8]=n*I+u*d+w*f;a[9]=q*I+t*d+y*f;a[10]=r*I+v*d+z*f;a[11]=p*I+C*d+A*f;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};d.rotateX=function(a,b,c){var e=Math.sin(c);c=Math.cos(c);var h=b[4],k=b[5],d=b[6],m=b[7],f=b[8],l=b[9],n=b[10],q=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=h*c+f*e;a[5]=k*c+l*e;a[6]=d*
c+n*e;a[7]=m*c+q*e;a[8]=f*c-h*e;a[9]=l*c-k*e;a[10]=n*c-d*e;a[11]=q*c-m*e;return a};d.rotateY=function(a,b,c){var e=Math.sin(c);c=Math.cos(c);var h=b[0],k=b[1],d=b[2],m=b[3],f=b[8],l=b[9],n=b[10],q=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=h*c-f*e;a[1]=k*c-l*e;a[2]=d*c-n*e;a[3]=m*c-q*e;a[8]=h*e+f*c;a[9]=k*e+l*c;a[10]=d*e+n*c;a[11]=m*e+q*c;return a};d.rotateZ=function(a,b,c){var e=Math.sin(c);c=Math.cos(c);var h=b[0],d=b[1],g=b[2],m=
b[3],f=b[4],l=b[5],n=b[6],q=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=h*c+f*e;a[1]=d*c+l*e;a[2]=g*c+n*e;a[3]=m*c+q*e;a[4]=f*c-h*e;a[5]=l*c-d*e;a[6]=n*c-g*e;a[7]=q*c-m*e;return a};d.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};d.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=
0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};d.fromRotation=function(a,b,c){var e=c[0],h=c[1];c=c[2];var d=Math.sqrt(e*e+h*h+c*c),g=void 0,m=void 0,f=void 0;if(d<x.EPSILON)return null;d=1/d;e*=d;h*=d;c*=d;g=Math.sin(b);m=Math.cos(b);f=1-m;a[0]=e*e*f+m;a[1]=h*e*f+c*g;a[2]=c*e*f-h*g;a[3]=0;a[4]=e*h*f-c*g;a[5]=h*h*f+m;a[6]=c*h*f+e*g;a[7]=0;a[8]=e*c*f+h*g;a[9]=h*c*f-e*g;a[10]=c*c*f+m;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};d.fromXRotation=function(a,b){var c=
Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};d.fromYRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};d.fromZRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a};d.fromRotationTranslation=M;d.fromQuat2=function(a,b){var c=P,e=-b[0],h=-b[1],d=-b[2],g=b[3],m=b[4],f=b[5],l=b[6],n=b[7],q=e*e+h*h+d*d+g*g;0<q?(c[0]=2*(m*g+n*e+f*d-l*h)/q,c[1]=2*(f*g+n*h+l*e-m*d)/q,c[2]=2*(l*g+n*d+m*h-f*e)/q):(c[0]=2*(m*g+n*e+f*d-l*h),c[1]=2*(f*g+n*h+l*e-m*d),c[2]=2*(l*g+n*d+m*h-f*e));M(a,b,c);return a};var P=O.create();d.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};d.getScaling=function(a,b){var c=b[0],e=b[1],d=b[2],
k=b[4],g=b[5],m=b[6],f=b[8],l=b[9];b=b[10];a[0]=Math.sqrt(c*c+e*e+d*d);a[1]=Math.sqrt(k*k+g*g+m*m);a[2]=Math.sqrt(f*f+l*l+b*b);return a};d.getRotation=function(a,b){var c=b[0]+b[5]+b[10],e=0;0<c?(e=2*Math.sqrt(c+1),a[3]=.25*e,a[0]=(b[6]-b[9])/e,a[1]=(b[8]-b[2])/e,a[2]=(b[1]-b[4])/e):b[0]>b[5]&&b[0]>b[10]?(e=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/e,a[0]=.25*e,a[1]=(b[1]+b[4])/e,a[2]=(b[8]+b[2])/e):b[5]>b[10]?(e=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/e,a[0]=(b[1]+b[4])/e,a[1]=.25*
e,a[2]=(b[6]+b[9])/e):(e=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/e,a[0]=(b[8]+b[2])/e,a[1]=(b[6]+b[9])/e,a[2]=.25*e);return a};d.fromRotationTranslationScale=function(a,b,c,e){var d=b[0],k=b[1],g=b[2],m=b[3],f=d+d,l=k+k,n=g+g;b=d*f;var q=d*l,d=d*n,r=k*l,k=k*n,g=g*n,f=m*f,l=m*l,m=m*n,n=e[0],p=e[1];e=e[2];a[0]=(1-(r+g))*n;a[1]=(q+m)*n;a[2]=(d-l)*n;a[3]=0;a[4]=(q-m)*p;a[5]=(1-(b+g))*p;a[6]=(k+f)*p;a[7]=0;a[8]=(d+l)*e;a[9]=(k-f)*e;a[10]=(1-(b+r))*e;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=
1;return a};d.fromRotationTranslationScaleOrigin=function(a,b,c,e,d){var h=b[0],g=b[1],m=b[2],f=b[3],l=h+h,n=g+g,q=m+m;b=h*l;var r=h*n,p=h*q,h=g*n,g=g*q,u=m*q,m=f*l,n=f*n,t=f*q,v=e[0],x=e[1],q=e[2];e=d[0];f=d[1];d=d[2];var l=(1-(h+u))*v,w=(r+t)*v,v=(p-n)*v,r=(r-t)*x,u=(1-(b+u))*x,x=(g+m)*x,p=(p+n)*q,g=(g-m)*q;b=(1-(b+h))*q;a[0]=l;a[1]=w;a[2]=v;a[3]=0;a[4]=r;a[5]=u;a[6]=x;a[7]=0;a[8]=p;a[9]=g;a[10]=b;a[11]=0;a[12]=c[0]+e-(l*e+r*f+p*d);a[13]=c[1]+f-(w*e+u*f+g*d);a[14]=c[2]+d-(v*e+x*f+b*d);a[15]=1;return a};
d.fromQuat=function(a,b){var c=b[0],e=b[1],d=b[2];b=b[3];var k=c+c,g=e+e,m=d+d,c=c*k,f=e*k,e=e*g,l=d*k,n=d*g,d=d*m,k=b*k,g=b*g;b*=m;a[0]=1-e-d;a[1]=f+b;a[2]=l-g;a[3]=0;a[4]=f-b;a[5]=1-c-d;a[6]=n+k;a[7]=0;a[8]=l+g;a[9]=n-k;a[10]=1-c-e;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};d.frustum=function(a,b,c,e,d,k,g){var h=1/(c-b),f=1/(d-e),l=1/(k-g);a[0]=2*k*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*k*f;a[6]=0;a[7]=0;a[8]=(c+b)*h;a[9]=(d+e)*f;a[10]=(g+k)*l;a[11]=-1;a[12]=0;a[13]=0;a[14]=g*k*2*l;a[15]=
0;return a};d.perspective=function(a,b,c,e,d){b=1/Math.tan(b/2);var h=void 0;a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;null!=d&&Infinity!==d?(h=1/(e-d),a[10]=(d+e)*h,a[14]=2*d*e*h):(a[10]=-1,a[14]=-2*e);return a};d.perspectiveFromFieldOfView=function(a,b,c,e){var d=Math.tan(b.upDegrees*Math.PI/180),k=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var m=2/(g+b),f=2/(d+k);
a[0]=m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=f;a[6]=0;a[7]=0;a[8]=-((g-b)*m*.5);a[9]=(d-k)*f*.5;a[10]=e/(c-e);a[11]=-1;a[12]=0;a[13]=0;a[14]=e*c/(c-e);a[15]=0;return a};d.ortho=function(a,b,c,e,d,k,g){var h=1/(b-c),f=1/(e-d),l=1/(k-g);a[0]=-2*h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*f;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(b+c)*h;a[13]=(d+e)*f;a[14]=(g+k)*l;a[15]=1;return a};d.lookAt=function(a,b,c,e){var d=void 0,k=void 0,g=void 0,m=void 0,f=void 0,l=void 0,n=void 0,q=void 0,r=void 0,p=void 0,
u=b[0],t=b[1];b=b[2];g=e[0];m=e[1];e=e[2];n=c[0];q=c[1];c=c[2];if(Math.abs(u-n)<x.EPSILON&&Math.abs(t-q)<x.EPSILON&&Math.abs(b-c)<x.EPSILON)return K(a);n=u-n;q=t-q;r=b-c;p=1/Math.sqrt(n*n+q*q+r*r);n*=p;q*=p;r*=p;d=m*r-e*q;k=e*n-g*r;g=g*q-m*n;(p=Math.sqrt(d*d+k*k+g*g))?(p=1/p,d*=p,k*=p,g*=p):g=k=d=0;m=q*g-r*k;f=r*d-n*g;l=n*k-q*d;(p=Math.sqrt(m*m+f*f+l*l))?(p=1/p,m*=p,f*=p,l*=p):l=f=m=0;a[0]=d;a[1]=m;a[2]=n;a[3]=0;a[4]=k;a[5]=f;a[6]=q;a[7]=0;a[8]=g;a[9]=l;a[10]=r;a[11]=0;a[12]=-(d*u+k*t+g*b);a[13]=
-(m*u+f*t+l*b);a[14]=-(n*u+q*t+r*b);a[15]=1;return a};d.targetTo=function(a,b,c,e){var d=b[0],k=b[1];b=b[2];var g=e[0],m=e[1],f=e[2];e=d-c[0];var l=k-c[1];c=b-c[2];var n=e*e+l*l+c*c;0<n&&(n=1/Math.sqrt(n),e*=n,l*=n,c*=n);var q=m*c-f*l,f=f*e-g*c,g=g*l-m*e,n=q*q+f*f+g*g;0<n&&(n=1/Math.sqrt(n),q*=n,f*=n,g*=n);a[0]=q;a[1]=f;a[2]=g;a[3]=0;a[4]=l*g-c*f;a[5]=c*q-e*g;a[6]=e*f-l*q;a[7]=0;a[8]=e;a[9]=l;a[10]=c;a[11]=0;a[12]=d;a[13]=k;a[14]=b;a[15]=1;return a};d.str=function(a){return"mat4("+a[0]+", "+a[1]+
", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};d.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};d.add=function(a,b,c){a[0]=b[0]+c[0];
a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a};d.subtract=N;d.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*
c;return a};d.multiplyScalarAndAdd=function(a,b,c,e){a[0]=b[0]+c[0]*e;a[1]=b[1]+c[1]*e;a[2]=b[2]+c[2]*e;a[3]=b[3]+c[3]*e;a[4]=b[4]+c[4]*e;a[5]=b[5]+c[5]*e;a[6]=b[6]+c[6]*e;a[7]=b[7]+c[7]*e;a[8]=b[8]+c[8]*e;a[9]=b[9]+c[9]*e;a[10]=b[10]+c[10]*e;a[11]=b[11]+c[11]*e;a[12]=b[12]+c[12]*e;a[13]=b[13]+c[13]*e;a[14]=b[14]+c[14]*e;a[15]=b[15]+c[15]*e;return a};d.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&
a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};d.equals=function(a,b){var c=a[0],e=a[1],d=a[2],k=a[3],g=a[4],m=a[5],f=a[6],l=a[7],n=a[8],q=a[9],r=a[10],p=a[11],u=a[12],t=a[13],v=a[14];a=a[15];var C=b[0],w=b[1],y=b[2],z=b[3],A=b[4],J=b[5],D=b[6],E=b[7],F=b[8],G=b[9],H=b[10],I=b[11],B=b[12],K=b[13],L=b[14];b=b[15];return Math.abs(c-C)<=x.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(e-w)<=x.EPSILON*Math.max(1,Math.abs(e),Math.abs(w))&&
Math.abs(d-y)<=x.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(k-z)<=x.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(g-A)<=x.EPSILON*Math.max(1,Math.abs(g),Math.abs(A))&&Math.abs(m-J)<=x.EPSILON*Math.max(1,Math.abs(m),Math.abs(J))&&Math.abs(f-D)<=x.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(l-E)<=x.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(n-F)<=x.EPSILON*Math.max(1,Math.abs(n),Math.abs(F))&&Math.abs(q-G)<=x.EPSILON*Math.max(1,Math.abs(q),Math.abs(G))&&Math.abs(r-
H)<=x.EPSILON*Math.max(1,Math.abs(r),Math.abs(H))&&Math.abs(p-I)<=x.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(u-B)<=x.EPSILON*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(t-K)<=x.EPSILON*Math.max(1,Math.abs(t),Math.abs(K))&&Math.abs(v-L)<=x.EPSILON*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(a-b)<=x.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};d.mul=L;d.sub=N});