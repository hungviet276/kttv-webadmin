// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","./events","./lang","./promiseUtils"],function(B,a,q,r,n){function k(e,c,d,b,a){a=e.watch(c,function(c,a,f,l){if(!d||d(c))null===b||void 0===b?void 0:b.call(e,c,a,f,l)},a);if(Array.isArray(c))for(var f=0;f<c.length;f++){var g=e.get(c[f]);d&&d(g)&&(null===b||void 0===b?void 0:b.call(e,g,g,c,e))}else g=e.get(c),d&&d(g)&&(null===b||void 0===b?void 0:b.call(e,g,g,c,e));return a}function h(e,c,d,b,a){function f(){m&&(m.remove(),m=null)}var g="function"===typeof b?b:null,p="object"===
typeof b?b:null;"boolean"===typeof b&&(a=b);var h=!1,m,l=n.createDeferred();n.onAbort(p,function(){f();l.reject(n.createAbortError())});b={then:l.promise.then.bind(l.promise),catch:l.promise.catch.bind(l.promise),remove:f};Object.freeze(b);m=k(e,c,d,function(b,c,a,d){h=!0;f();g&&g.call(e,b,c,a,d);l.resolve({value:b,oldValue:c,propertyName:a,target:d})},a);h&&f();return b}function t(e){return!!e}function u(e){return!e}function v(e){return!0===e}function w(e){return!1===e}function x(e){return void 0!==
e}function y(e){return void 0===e}function z(e,c,a,b){var d=Array.isArray(c)?c:-1<c.indexOf(",")?c.split(","):[c];c=e.watch(c,a,b);for(b=0;b<d.length;b++){var f=d[b].trim().replace(A,"$1"),g=e.get(f);a.call(e,g,g,f,e)}return c}Object.defineProperty(a,"__esModule",{value:!0});a.on=a.pausable=a.whenEqualOnce=a.whenEqual=a.whenUndefinedOnce=a.whenUndefined=a.whenDefinedOnce=a.whenDefined=a.whenFalseOnce=a.whenFalse=a.whenTrueOnce=a.whenTrue=a.whenNotOnce=a.whenNot=a.whenOnce=a.when=a.once=a.watch=a.init=
a.whenValidOnce=void 0;a.whenValidOnce=h;var A=/\?(\.|$)/g;a.init=z;a.watch=function(e,c,a,b){return e.watch(c,a,b)};a.once=function(e,c,a,b){return h(e,c,null,a,b)};a.when=function(e,a,d,b){return k(e,a,t,d,b)};a.whenOnce=function(e,a,d,b){return h(e,a,t,d,b)};a.whenNot=function(e,a,d,b){return k(e,a,u,d,b)};a.whenNotOnce=function(e,a,d,b){return h(e,a,u,d,b)};a.whenTrue=function(a,c,d,b){return k(a,c,v,d,b)};a.whenTrueOnce=function(a,c,d,b){return h(a,c,v,d,b)};a.whenFalse=function(a,c,d,b){return k(a,
c,w,d,b)};a.whenFalseOnce=function(a,c,d,b){return h(a,c,w,d,b)};a.whenDefined=function(a,c,d,b){return k(a,c,x,d,b)};a.whenDefinedOnce=function(a,c,d,b){return h(a,c,x,d,b)};a.whenUndefined=function(a,c,d,b){return k(a,c,y,d,b)};a.whenUndefinedOnce=function(a,c,d,b){return h(a,c,y,d,b)};a.whenEqual=function(a,c,d,b,h){return k(a,c,function(a){return r.equals(d,a)},b,h)};a.whenEqualOnce=function(a,c,d,b,p){return h(a,c,function(a){return r.equals(d,a)},b,p)};a.pausable=function(a,c,d,b){var e=!1,
f=a.watch(c,function(b,c,f,h){e||d.call(a,b,c,f,h)},b);return{remove:function(){f.remove()},pause:function(){e=!0},resume:function(){e=!1}}};a.on=function(a,c,d,b,h,f,g){function e(b){var c=k[b];c&&(f&&f(c.target,b,a,d),c.handle.remove(),delete k[b])}var k={},m=z(a,c,function(c,f,g){e(g);q.isEventTarget(c)&&(k[g]={handle:q.on(c,d,b),target:c},h&&h(c,g,a,d))},g);return{remove:function(){m.remove();for(var a in k)e(a)}}}});