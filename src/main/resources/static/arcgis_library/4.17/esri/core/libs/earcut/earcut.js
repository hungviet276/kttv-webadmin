// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports"],function(M,r){function D(a,c,b,e,d){var f;if(d===0<w(a,c,b,e))for(d=c;d<b;d+=e)f=E(d,a[d],a[d+1],f);else for(d=b-e;d>=c;d-=e)f=E(d,a[d],a[d+1],f);f&&t(f,f.next)&&(x(f),f=f.next);return f}function y(a,c){void 0===c&&(c=a);if(!a)return a;var b;do if(b=!1,a.steiner||!t(a,a.next)&&0!==n(a.prev,a,a.next))a=a.next;else{x(a);a=c=a.prev;if(a===a.next)break;b=!0}while(b||a!==c);return c}function z(a,c,b,e,d,f,h){void 0===h&&(h=0);if(a){!h&&f&&(a=F(a,e,d,f));for(var l=a;a.prev!==
a.next;){var k=a.prev,m=a.next,g;if(f)g=I(a,e,d,f);else a:{g=a;var p=g.prev,A=g,r=g.next;if(0<=n(p,A,r))g=!1;else{for(var q=g.next.next,w=q,v=0;q!==g.prev&&(0===v||q!==w);){v++;if(u(p.x,p.y,A.x,A.y,r.x,r.y,q.x,q.y)&&0<=n(q.prev,q,q.next)){g=!1;break a}q=q.next}g=!0}}if(g)c.push(k.index/b),c.push(a.index/b),c.push(m.index/b),x(a),l=a=m.next;else if(a=m,a===l){if(!h)z(y(a),c,b,e,d,f,1);else if(1===h){h=c;l=b;k=a;do m=k.prev,g=k.next.next,!t(m,g)&&G(m,k,k.next,g)&&B(m,g)&&B(g,m)&&(h.push(m.index/l),
h.push(k.index/l),h.push(g.index/l),x(k),x(k.next),k=a=g),k=k.next;while(k!==a);a=k;z(a,c,b,e,d,f,2)}else if(2===h)a:{h=a;do{for(l=h.next.next;l!==h.prev;){if(k=h.index!==l.index){k=h;m=l;g=void 0;if(g=k.next.index!==m.index&&k.prev.index!==m.index){g=void 0;b:{g=k;do{if(g.index!==k.index&&g.next.index!==k.index&&g.index!==m.index&&g.next.index!==m.index&&G(g,g.next,k,m)){g=!0;break b}g=g.next}while(g!==k);g=!1}g=!g}p=void 0;if(p=g&&B(k,m)&&B(m,k)){g=k;p=!1;A=(k.x+m.x)/2;m=(k.y+m.y)/2;do g.y>m!==
g.next.y>m&&g.next.y!==g.y&&A<(g.next.x-g.x)*(m-g.y)/(g.next.y-g.y)+g.x&&(p=!p),g=g.next;while(g!==k)}k=p}if(k){a=H(h,l);h=y(h,h.next);a=y(a,a.next);z(h,c,b,e,d,f);z(a,c,b,e,d,f);break a}l=l.next}h=h.next}while(h!==a)}break}}}}function I(a,c,b,e){var d=a.prev,f=a.next;if(0<=n(d,a,f))return!1;var h=d.x>a.x?d.x>f.x?d.x:f.x:a.x>f.x?a.x:f.x,l=d.y>a.y?d.y>f.y?d.y:f.y:a.y>f.y?a.y:f.y,k=v(d.x<a.x?d.x<f.x?d.x:f.x:a.x<f.x?a.x:f.x,d.y<a.y?d.y<f.y?d.y:f.y:a.y<f.y?a.y:f.y,c,b,e);c=v(h,l,c,b,e);b=a.prevZ;for(e=
a.nextZ;b&&b.z>=k&&e&&e.z<=c;){if(b!==a.prev&&b!==a.next&&u(d.x,d.y,a.x,a.y,f.x,f.y,b.x,b.y)&&0<=n(b.prev,b,b.next))return!1;b=b.prevZ;if(e!==a.prev&&e!==a.next&&u(d.x,d.y,a.x,a.y,f.x,f.y,e.x,e.y)&&0<=n(e.prev,e,e.next))return!1;e=e.nextZ}for(;b&&b.z>=k;){if(b!==a.prev&&b!==a.next&&u(d.x,d.y,a.x,a.y,f.x,f.y,b.x,b.y)&&0<=n(b.prev,b,b.next))return!1;b=b.prevZ}for(;e&&e.z<=c;){if(e!==a.prev&&e!==a.next&&u(d.x,d.y,a.x,a.y,f.x,f.y,e.x,e.y)&&0<=n(e.prev,e,e.next))return!1;e=e.nextZ}return!0}function E(a,
c,b,e){a=new C(a,c,b);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a}function x(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function J(a){var c=a,b=a;do{if(c.x<b.x||c.x===b.x&&c.y<b.y)b=c;c=c.next}while(c!==a);return b}function K(a,c){var b=c,e=a.x,d=a.y,f=-Infinity,h;do{if(d<=b.y&&d>=b.next.y&&b.next.y!==b.y){var l=b.x+(d-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(l<=e&&l>f){f=l;if(l===e){if(d===b.y)return b;
if(d===b.next.y)return b.next}h=b.x<b.next.x?b:b.next}}b=b.next}while(b!==c);if(!h)return null;if(e===f)return h.prev;c=h;for(var l=h.x,k=h.y,m=Infinity,g,b=h.next;b!==c;)e>=b.x&&b.x>=l&&e!==b.x&&u(d<k?e:f,d,l,k,d<k?f:e,d,b.x,b.y)&&(g=Math.abs(d-b.y)/(e-b.x),(g<m||g===m&&b.x>h.x)&&B(b,a)&&(h=b,m=g)),b=b.next;return h}function F(a,c,b,e){for(var d=void 0;d!==a;d=d.next){d=d||a;null===d.z&&(d.z=v(d.x,d.y,c,b,e));if(d.prev.next!==d||d.next.prev!==d)return d.prev.next=d,d.next.prev=d,F(a,c,b,e);d.prevZ=
d.prev;d.nextZ=d.next}a.prevZ.nextZ=null;a.prevZ=null;a:for(b=1;;){e=a;d=void 0;c=a=null;for(var f=0;e;){f++;for(var d=e,h=0;h<b&&d;h++)d=d.nextZ;for(var l=b;0<h||0<l&&d;){var k=void 0;0===h?(k=d,d=d.nextZ,l--):0!==l&&d?e.z<=d.z?(k=e,e=e.nextZ,h--):(k=d,d=d.nextZ,l--):(k=e,e=e.nextZ,h--);c?c.nextZ=k:a=k;k.prevZ=c;c=k}e=d}c.nextZ=null;b*=2;if(2>f)break a}return a}function n(a,c,b){return(c.y-a.y)*(b.x-c.x)-(c.x-a.x)*(b.y-c.y)}function G(a,c,b,e){return t(a,c)&&t(b,e)||t(a,e)&&t(b,c)?!0:0<n(a,c,b)!==
0<n(a,c,e)&&0<n(b,e,a)!==0<n(b,e,c)}function w(a,c,b,e){for(var d=0,f=b-e;c<b;c+=e)d+=(a[f]-a[c])*(a[c+1]+a[f+1]),f=c;return d}function u(a,c,b,e,d,f,h,l){return 0<=(d-h)*(c-l)-(a-h)*(f-l)&&0<=(a-h)*(e-l)-(b-h)*(c-l)&&0<=(b-h)*(f-l)-(d-h)*(e-l)}function B(a,c){return 0>n(a.prev,a,a.next)?0<=n(a,c,a.next)&&0<=n(a,a.prev,c):0>n(a,c,a.prev)||0>n(a,a.next,c)}function v(a,c,b,e,d){a=32767*(a-b)*d;c=32767*(c-e)*d;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<
4)&252645135;c=(c|c<<2)&858993459;return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1}function t(a,c){return a.x===c.x&&a.y===c.y}function L(a,c){return a.x-c.x}function H(a,c){var b=new C(a.index,a.x,a.y),e=new C(c.index,c.x,c.y),d=a.next,f=c.prev;a.next=c;c.prev=a;b.next=d;d.prev=b;e.next=b;b.prev=e;f.next=e;e.prev=f;return e}Object.defineProperty(r,"__esModule",{value:!0});r.deviation=r.earcut=void 0;r.earcut=function(a,c,b){var e=c&&c.length,d=e?c[0]*b:a.length,f=D(a,0,d,b,!0),h=[];if(!f||f.next===
f.prev)return h;var l,k,m;if(e){for(var e=[],g=0,p=c.length;g<p;g++){var n=D(a,c[g]*b,g<p-1?c[g+1]*b:a.length,b,!1);n===n.next&&(n.steiner=!0);e.push(J(n))}e.sort(L);for(c=0;c<e.length;c++){g=e[c];p=f;if(p=K(g,p))g=H(p,g),y(g,g.next);f=y(f,f.next)}}if(a.length>80*b){l=m=a[0];k=e=a[1];for(c=b;c<d;c+=b)g=a[c],p=a[c+1],l=Math.min(l,g),k=Math.min(k,p),m=Math.max(m,g),e=Math.max(e,p);m=Math.max(m-l,e-k);m=0!==m?1/m:0}z(f,h,b,l,k,m);return h};r.deviation=function(a,c,b,e){var d=c&&c.length,f=Math.abs(w(a,
0,d?c[0]*b:a.length,b));if(d)for(var d=0,h=c.length;d<h;d++)f-=Math.abs(w(a,c[d]*b,d<h-1?c[d+1]*b:a.length,b));for(d=c=0;d<e.length;d+=3){var h=e[d]*b,l=e[d+1]*b,k=e[d+2]*b;c+=Math.abs((a[h]-a[k])*(a[l+1]-a[h+1])-(a[h]-a[l])*(a[k+1]-a[h+1]))}return 0===f&&0===c?0:Math.abs((c-f)/f)};var C=function(){return function(a,c,b){this.index=a;this.x=c;this.y=b;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}}()});