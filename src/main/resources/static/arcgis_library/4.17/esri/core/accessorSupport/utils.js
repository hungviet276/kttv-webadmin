// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../handleUtils","../lang","../maybe"],function(q,b,m,n,p){function k(a,g,c){return g?Object.keys(g).reduce(function(a,b){var e=null,d="merge";c&&(e=c.path?c.path+"."+b:b,d=c.policy(e));if("replace"===d)return a[b]=g[b],a;if(void 0===a[b])return a[b]=n.clone(g[b]),a;var f=a[b],d=g[b];if(f===d)return a;if(Array.isArray(d)||Array.isArray(a))f=f?Array.isArray(f)?a[b]=f.concat():a[b]=[f]:a[b]=[],d&&(Array.isArray(d)||(d=[d]),d.forEach(function(a){-1===f.indexOf(a)&&f.push(a)}));
else if(d&&"object"===typeof d)if(c){var h=c.path;c.path=p.assumeNonNull(e);a[b]=k(f,d,c);c.path=h}else a[b]=k(f,d,null);else if(!a.hasOwnProperty(b)||g.hasOwnProperty(b))a[b]=d;return a},a||{}):a}function h(a){return Array.isArray(a)?a:a.split(".")}function l(a){if(Array.isArray(a)||-1<a.indexOf(",")){a=Array.isArray(a)?a:a.split(",");for(var b=0;b<a.length;b++)a[b]=a[b].trim();return 1===a.length?a[0]:a}return a.trim()}Object.defineProperty(b,"__esModule",{value:!0});b.once=b.parse=b.parseConditionalPath=
b.splitPath=b.pathToArray=b.pathToStringOrArray=b.merge=b.isPropertyDeclared=b.getProperties=void 0;b.getProperties=function(a){return a?a.__accessor__?a.__accessor__:a.propertyInvalidated?a:null:null};b.isPropertyDeclared=function(a,b){return null!=a&&a.metadatas&&null!=a.metadatas[b]};b.merge=function(a,b,c){return c?k(a,b,{policy:c,path:""}):k(a,b,null)};b.pathToStringOrArray=function(a){return!a||"string"===typeof a&&-1===a.indexOf(".")?a:h(a)};b.pathToArray=h;b.splitPath=l;b.parseConditionalPath=
function(a){if(-1===a.indexOf("?"))return null;a=h(a);for(var b=Array(a.length),c=0;c<a.length;c++){var e=a[c];b[c]="?"===e[e.length-1];b[c]&&(a[c]=e.slice(0,-1))}return{fullPath:a.join("."),conditional:b}};b.parse=function(a,b,c,e){b=l(b);return Array.isArray(b)?(b=b.map(function(b){return e(a,b.trim(),c)}),m.handlesGroup(b)):e(a,b.trim(),c)};b.once=function(a){var b=!1;return function(){b||(b=!0,a())}}});