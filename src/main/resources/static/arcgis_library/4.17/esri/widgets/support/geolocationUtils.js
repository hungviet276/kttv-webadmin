// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../config ../../core/Error ../../core/has ../../core/Logger ../../core/promiseUtils ../../geometry/Point ../../geometry/support/webMercatorUtils ../../portal/Portal ../../rest/geometryService ../../tasks/support/ProjectParameters".split(" "),function(x,e,g,h,k,m,f,n,p,q,r,t){function u(a,d,b){if(!d)return f.resolve(a);var c=d.spatialReference;return c.isWGS84?f.resolve(a):c.isWebMercator?f.resolve(p.geographicToWebMercator(a)):v(b).then(function(d){if(!d)throw new h("geometry-service:missing-url",
"Geometry service URL is missing");var e=new t({geometries:[a],outSR:c});return r.project(d,e,b).then(function(a){return a[0]})})}function v(a){if(g.geometryServiceUrl)return f.resolve(g.geometryServiceUrl);var d=q.getDefault();return d.load(a).catch(function(){}).then(function(){return d.get("helperServices.geometry.url")})}Object.defineProperty(e,"__esModule",{value:!0});e.positionToPoint=e.getCurrentPosition=e.supported=void 0;var l=m.getLogger("esri.core.geolocationUtils"),w={maximumAge:0,timeout:15E3,
enableHighAccuracy:!0};e.supported=function(){var a=k("esri-geolocation");a||l.warn("geolocation-unsupported","Geolocation unsupported.");a&&((a=k("esri-secure-context"))||l.warn("insecure-context","Geolocation requires a secure origin."));return a};e.getCurrentPosition=function(a){a||(a=w);return f.create(function(d,b){setTimeout(function(){return b(new h("geolocation:timeout","getting the current geolocation position timed out"))},15E3);navigator.geolocation.getCurrentPosition(d,b,a)})};e.positionToPoint=
function(a,d){var b=a.position;a=a.view;var c=b&&b.coords||{},c={accuracy:c.accuracy,altitude:c.altitude,altitudeAccuracy:c.altitudeAccuracy,heading:c.heading,latitude:c.latitude,longitude:c.longitude,speed:c.speed},b=b?{coords:c,timestamp:b.timestamp}:b;b=(b=b&&b.coords)?new n({longitude:b.longitude,latitude:b.latitude,z:b.altitude||null,spatialReference:{wkid:4326}}):null;return u(b,a,d)}});