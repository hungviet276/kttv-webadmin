// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../core/Collection ../../../core/events ../../../core/HandleOwner ../../../core/maybe ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../Widget ./GridViewModel ../../support/widget @dojo/framework/shim/Promise ./../../../libs/vaadin-grid/webcomponents".split(" "),function(n,v,c,p,h,q,r,k,d,t,u,e){new Promise(function(c,b){n(["./../../../libs/vaadin-grid/index"],c,b)});var l={selectionColumn:!0};return function(g){function b(a,b){a=g.call(this,
a,b)||this;a._grid=null;a._headerStyles="display: flex; font-weight: 400;";a._hostStyles='font-family: "Avenir Next", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 1em;';a._rowHoverStyles="background: #e2f1fb;";a.cellClassNameGenerator=null;a.columnReorderingEnabled=!0;a.dataProvider=null;a.itemIdPath=null;a.label=void 0;a.messages=null;a.pageSize=50;a.selectedItems=new p;a.size=null;a.rowDetailsRenderer=null;a.store=null;a.viewModel=new u;a.visibleElements=c.__assign({},l);return a}
c.__extends(b,g);b.prototype.initialize=function(){var a=this;this.handles.add([k.watch(this,"viewModel.size",function(){return a._updateGridSize()}),k.watch(this,"store.state",function(b,f){"ready"===b&&"loaded"===f&&a.refreshCache()})])};b.prototype.castVisibleElements=function(a){return c.__assign(c.__assign({},l),a)};b.prototype.render=function(){return e.tsx("div",{bind:this,class:this.classes("esri-grid","esri-widget")},e.tsx("div",{bind:this,class:"esri-grid__content"},this.renderGrid()))};
b.prototype.renderGrid=function(){return e.tsx("vaadin-grid",c.__assign({},this.getGridProps()),this.renderAllColumns())};b.prototype.renderAllColumns=function(){if("disabled"!==this.viewModel.state&&this.columns&&this.columns.length)return[this.renderSelectionColumn(),this.renderColumns()]};b.prototype.renderSelectionColumn=function(){return e.tsx("vaadin-grid-selection-column",{_selectAllHidden:!0,selectAll:!1,bind:this,hidden:!this.visibleElements.selectionColumn,sortable:!1,frozen:!e.isRTL()})};
b.prototype.renderColumns=function(){var a=this;return this.columns.items.map(function(b,f){return e.tsx("vaadin-grid-column",c.__assign({},a.getColumnProps(b,f)))})};b.prototype.getGridProps=function(){return{_safari:!1,class:"esri-grid__grid",id:this.id+"_grid",theme:"compact column-borders",ref:"grid",bind:this,afterCreate:this._afterGridCreate,afterUpdate:this._afterGridUpdate,columnReorderingAllowed:this.columnReorderingEnabled,pageSize:this.pageSize,size:this.size}};b.prototype.getColumnProps=
function(a,b){var m=a.autoWidth,c=a.direction,d=a.flexGrow,e=a.frozen,h=a.header,k=a.hidden,g=a.path,l=a.resizable,n=a.textAlign;a=a.width;b=this.id+"_"+name+"_"+(r.isSome(b)?b:g);return{autoWidth:m,direction:c,flexGrow:d,frozen:e,header:h,hidden:k,key:b,path:g,resizable:l,"text-align":n,width:"number"===typeof a?a+"px":a,bind:this,afterCreate:this._afterColumnCreateOrUpdate,afterUpdate:this._afterColumnCreateOrUpdate}};b.prototype.clearSelection=function(){this._clearSelection();this.scheduleRender()};
b.prototype.clearSort=function(){this.columns.forEach(function(a){return a.direction=null});this._grid&&(this._grid._sorters=[]);this.scheduleRender()};b.prototype.deselectItem=function(a){this._deselectRowByItem(a)};b.prototype.deselectRow=function(a){(a=this.viewModel.getRowItemAt(a))&&this._deselectRowByItem(a)};b.prototype.findColumn=function(){};b.prototype.generateCellClassNames=function(){var a;null===(a=this._grid)||void 0===a?void 0:a.generateCellClassNames()};b.prototype.getSlotElementByName=
function(a){var b,f;return null===(f=null===(b=this._grid)||void 0===b?void 0:b.shadowRoot)||void 0===f?void 0:f.querySelector("slot[name\x3d'"+a+"']")};b.prototype.hideColumn=function(a){var b;null===(b=this.viewModel)||void 0===b?void 0:b.hideColumn(a);this.scheduleRender()};b.prototype.notifyResize=function(){var a;null===(a=this._grid)||void 0===a?void 0:a.notifyResize()};b.prototype.recalculateColumnWidths=function(){var a;null===(a=this._grid)||void 0===a?void 0:a.recalculateColumnWidths()};
b.prototype.refresh=function(){var a,b;return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(m){switch(m.label){case 0:return this._clearSelection(),null===(a=this.store)||void 0===a?void 0:a.reset(),[4,null===(b=this.store)||void 0===b?void 0:b.load()];case 1:return m.sent(),this.refreshCache(),[2]}})})};b.prototype.refreshCache=function(){var a;null===(a=this._grid)||void 0===a?void 0:a.clearCache()};b.prototype.selectItem=function(a){this._selectRowByItem(a)};b.prototype.selectRow=
function(a){(a=this.viewModel.getRowItemAt(a))&&this._selectRowByItem(a)};b.prototype.showColumn=function(a){var b;null===(b=this.viewModel)||void 0===b?void 0:b.showColumn(a);this.scheduleRender()};b.prototype.sort=function(a){var b,c=a.path;a=a.direction;null===(b=this.viewModel)||void 0===b?void 0:b.sortColumn(c,a)};b.prototype._afterGridCreate=function(a){var b=this,c=this.dataProvider,d=this.itemIdPath,e=this.rowDetailsRenderer;a.cellClassNameGenerator=this.cellClassNameGenerator;a.dataProvider=
c;a.rowDetailsRenderer=e;a.itemIdPath=d;this._grid=a;customElements.whenDefined("vaadin-grid").then(function(){b._appendStyles();b._addGridEventListeners()})};b.prototype._afterGridUpdate=function(a){this._grid||(this._grid=a)};b.prototype._afterColumnCreateOrUpdate=function(a){this._syncColumnRenderers(a)};b.prototype._appendStyles=function(){var a,b=null===(a=this._grid)||void 0===a?void 0:a.shadowRoot;a=document.createElement("style");a.textContent="\n      :host { "+this._hostStyles+' }\n      [part~\x3d"header-cell"] ::slotted(vaadin-grid-cell-content) { '+
this._headerStyles+' }\n      [part~\x3d"row"]:hover [part~\x3d"body-cell"] { '+this._rowHoverStyles+" }\n    ";null===b||void 0===b?void 0:b.appendChild(a)};b.prototype._updateGridSize=function(){this._grid&&(this._grid.size=this.size||0,this.scheduleRender())};b.prototype._addGridEventListeners=function(){var a=this,b=this._grid;this.handles.add([h.on(b,"click",function(b){return a._onRowClick(b)}),h.on(b,"selected-items-changed",function(b){return a._onSelectionChange(b)})])};b.prototype._onRowClick=
function(a){var b=this._grid.getEventContext(event),c=b.section;b.item&&c&&"details"!==c&&"header"!==c&&this.emit("row-click",{context:b,native:a})};b.prototype._selectRowByItem=function(a){var b;null===(b=this._grid)||void 0===b?void 0:b.selectItem(a)};b.prototype._deselectRowByItem=function(a){var b;null===(b=this._grid)||void 0===b?void 0:b.deselectItem(a)};b.prototype._clearSelection=function(){var a=this,b;if(null===(b=this._grid)||void 0===b?0:b.selectedItems)this._grid.selectedItems.slice().forEach(function(b){return a._deselectRowByItem(b)}),
this._updateSelectionProps()};b.prototype._onSelectionChange=function(a){this._updateSelectionProps();"selectedItems.splices"===a.detail.path&&(a=a.detail.value.indexSplices[0],this.emit("selection-change",{index:a.index,added:a.object,removed:a.removed}))};b.prototype._updateSelectionProps=function(){this.selectedItems.length&&this.selectedItems.removeAll();this._grid&&this.selectedItems.addMany(this._grid.selectedItems)};b.prototype._syncColumnRenderers=function(a){var b=a.getAttribute("path"),
c=this.viewModel.findColumn(b);if(c)try{c.renderFunction&&(a.renderer=function(a,b,d){return c.renderFunction({root:a,column:b,rowData:d})}),c.footerRenderFunction&&(a.footerRenderer=function(a,b){return c.footerRenderFunction({root:a,column:b})}),c.headerRenderFunction&&(a.headerRenderer=function(a,b){return c.headerRenderFunction({root:a,column:b})})}catch(w){}};c.__decorate([d.property()],b.prototype,"_grid",void 0);c.__decorate([d.aliasOf("viewModel.cellClassNameGenerator")],b.prototype,"cellClassNameGenerator",
void 0);c.__decorate([d.aliasOf("viewModel.columns")],b.prototype,"columns",void 0);c.__decorate([d.aliasOf("viewModel.columnReorderingEnabled")],b.prototype,"columnReorderingEnabled",void 0);c.__decorate([d.aliasOf("viewModel.dataProvider")],b.prototype,"dataProvider",void 0);c.__decorate([d.property()],b.prototype,"itemIdPath",void 0);c.__decorate([d.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],b.prototype,"label",void 0);c.__decorate([d.property(),e.renderable(),e.messageBundle("esri/widgets/FeatureTable/t9n/FeatureTable")],
b.prototype,"messages",void 0);c.__decorate([d.aliasOf("viewModel.pageSize")],b.prototype,"pageSize",void 0);c.__decorate([d.property({readOnly:!0}),e.renderable()],b.prototype,"selectedItems",void 0);c.__decorate([d.aliasOf("viewModel.size")],b.prototype,"size",void 0);c.__decorate([d.aliasOf("viewModel.rowDetailsRenderer")],b.prototype,"rowDetailsRenderer",void 0);c.__decorate([d.aliasOf("viewModel.store")],b.prototype,"store",void 0);c.__decorate([d.property(),e.renderable("viewModel.cellClassNameGenerator viewModel.columnReorderingEnabled viewModel.columns viewModel.dataProvider viewModel.pageSize viewModel.rowDetailsRenderer viewModel.size viewModel.state viewModel.store".split(" "))],
b.prototype,"viewModel",void 0);c.__decorate([d.property(),e.renderable()],b.prototype,"visibleElements",void 0);c.__decorate([d.cast("visibleElements")],b.prototype,"castVisibleElements",null);c.__decorate([d.aliasOf("viewModel.findColumn")],b.prototype,"findColumn",null);return b=c.__decorate([d.subclass("esri.widgets.FeatureTable.Grid.Grid")],b)}(q.HandleOwnerMixin(t))});