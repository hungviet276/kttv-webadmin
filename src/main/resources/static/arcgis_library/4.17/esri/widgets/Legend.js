// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("require exports tslib ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./support/ActiveLayerInfo".split(" "),function(x,c,h,f,m,d,k,r,n,t){var p=d.ofType(t),b="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),
a=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(l){function g(e){e=l.call(this,e)||this;e._handles=new k;e._layerViewByLayerId={};e._layerInfosByLayerViewId={};e._activeLayerInfosByLayerViewId={};e._activeLayerInfosWithNoParent=new d;e.activeLayerInfos=new p;e.basemapLegendVisible=!1;e.groundLegendVisible=!1;e.keepCacheOnDestroy=!1;e.respectLayerVisibility=!0;e.layerInfos=[];e.view=null;return e}h.__extends(g,
l);g.prototype.initialize=function(){var e=this;this._handles.add(r.init(this,"view",this._viewHandles),"view");this._handles.add(f.onLocaleChange(function(){return e._refresh()}))};g.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Object.defineProperty(g.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!1,configurable:!0});g.prototype._viewHandles=function(){this._handles.remove("state");
this.view&&this._handles.add(r.init(this,"state",this._stateHandles),"state")};g.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};g.prototype._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};g.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,
this)};g.prototype._destroyViewActiveLayerInfo=function(e){this._handles.remove(e);var a=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e];a&&a.parent&&a.parent.children.remove(a)};g.prototype._watchPropertiesAndAllLayerViews=function(){var e=this.view.allLayerViews;e.length&&this._refresh();this._handles.add(e.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(r.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",
this._propertiesChangeHandle.bind(this)),"legend-properties")};g.prototype._allLayerViewsChangeHandle=function(e){var a=this;e.removed.forEach(function(e){return a._destroyViewActiveLayerInfo(e.uid)});this._refresh()};g.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();this._refresh()};g.prototype._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,
this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};g.prototype._sortActiveLayerInfos=function(e){var a=this;if(!(2>e.length)){var b=[];e.forEach(function(g){if(!g.parent){var d=g.layer.parent;(d=(d=d&&"uid"in d&&a._layerViewByLayerId[d.uid])&&a._activeLayerInfosByLayerViewId[d.uid])&&-1!==e.indexOf(d)&&(b.push(g),g.parent=d,d.children.add(g),a._sortActiveLayerInfos(d.children))}});e.removeMany(b);var g={};this.view.allLayerViews.forEach(function(e,
a){return g[e.layer.uid]=a});e.sort(function(e,a){return(g[a.layer.uid]||0)-(g[e.layer.uid]||0)})}};g.prototype._generateLayerViews=function(){var e=[];a.filter(this._filterLayerViews,this).map(this.get,this).filter(function(e){return null!=e}).forEach(this._collectLayerViews("layerViews",e));return e};g.prototype._filterLayerViews=function(e){var a=!this.groundLegendVisible&&"view.groundView.layerViews"===e;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===e||"view.basemapView.referenceLayerViews"===
e))&&!a};g.prototype._collectLayerViews=function(e,a){var b=function(g){g&&g.forEach(function(g){a.push(g);b(g[e])});return a};return b};g.prototype._filterLayerViewsByLayerInfos=function(e){var a=this,b=this.layerInfos;return b&&b.length?b.some(function(b){return a._hasLayerInfo(b,e)}):!0};g.prototype._hasLayerInfo=function(e,a){var b=this._isLayerUIDMatching(e.layer,a.layer.uid);b&&(this._layerInfosByLayerViewId[a.uid]=e);return b};g.prototype._isLayerUIDMatching=function(e,a){return e&&(e.uid===
a||this._hasLayerUID(e.layers,a))};g.prototype._hasLayerUID=function(e,a){var b=this;return e&&e.some(function(e){return b._isLayerUIDMatching(e,a)})};g.prototype._isLayerViewSupported=function(e){return-1<b.indexOf(e.layer.declaredClass)?(this._layerViewByLayerId[e.layer.uid]=e,!0):!1};g.prototype._generateActiveLayerInfo=function(e){var a=this;this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this._handles.remove(e.uid),this._handles.add(r.watch(e,"legendEnabled, layer.legendEnabled",function(){return a._layerActiveHandle(e)}),
e.uid))};g.prototype._layerActiveHandle=function(e){this._isLayerActive(e)&&(this._handles.remove(e.uid),this._buildActiveLayerInfo(e))};g.prototype._isLayerActive=function(e){return this.respectLayerVisibility?e.legendEnabled&&e.get("layer.legendEnabled"):!0};g.prototype._buildActiveLayerInfo=function(e){var a=this,b,g=e.layer,d=e.uid,l=this._layerInfosByLayerViewId[d],f=this._activeLayerInfosByLayerViewId[d];f||(f=new t({layer:g,layerView:e,title:l&&void 0!==l.title&&l.layer.uid===g.uid?l.title:
g.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:l&&l.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[d]=f);l=g.parent&&"uid"in g.parent&&this._layerViewByLayerId[null===(b=g.parent)||void 0===b?void 0:b.uid];f.parent=this._activeLayerInfosByLayerViewId[null===l||void 0===l?void 0:l.uid];if(!this._handles.has(d)){b=r.watch(g,"title",function(e){return a._titleHandle(e,f)});var l=r.watch(g,"renderer?, opacity",function(){return a._constructLegendElements(f)}),
p=r.whenTrue(this.view,"stationary",function(){return a._scaleHandle(f)}),c=r.watch(e,"_effectiveRenderer",function(){return a._constructLegendElements(f)});b=[b,l,p,c];this.respectLayerVisibility&&(e=r.watch(e,"legendEnabled",function(e){return a._legendEnabledHandle(e,f)}),g=r.watch(g,"legendEnabled",function(e){return a._legendEnabledHandle(e,f)}),b.push(e,g));this._handles.add(b,d)}f.isScaleDriven||this._constructLegendElements(f);this._addActiveLayerInfo(f)};g.prototype._titleHandle=function(a,
b){b.title=a;this._constructLegendElements(b)};g.prototype._legendEnabledHandle=function(a,b){a?this._addActiveLayerInfo(b):this._removeActiveLayerInfo(b)};g.prototype._scaleHandle=function(a){a.isScaleDriven&&this._constructLegendElements(a)};g.prototype._addActiveLayerInfo=function(a){var e=this,b,g=a.layer;if(this._isLayerActive(a.layerView)&&-1===this.activeLayerInfos.indexOf(a)){var d=a.parent;d?(-1===d.children.indexOf(a)&&d.children.push(a),this._sortActiveLayerInfos(d.children)):(d=null===
(b=this.layerInfos)||void 0===b?void 0:b.some(function(a){return a.layer.uid===g.uid}),g.parent&&"uid"in g.parent&&!d?this._activeLayerInfosWithNoParent.add(a):(this.activeLayerInfos.add(a),this._sortActiveLayerInfos(this.activeLayerInfos)));if(this._activeLayerInfosWithNoParent.length){var l=[];this._activeLayerInfosWithNoParent.forEach(function(a){var b=a.layer.parent,b=b&&"uid"in b&&e._layerViewByLayerId[null===b||void 0===b?void 0:b.uid];if(b=e._activeLayerInfosByLayerViewId[null===b||void 0===
b?void 0:b.uid])l.push(a),a.parent=b});l.length&&(this._activeLayerInfosWithNoParent.removeMany(l),l.forEach(function(a){return e._addActiveLayerInfo(a)}))}}};g.prototype._removeActiveLayerInfo=function(a){var e=a.parent;e?e.children.remove(a):this.activeLayerInfos.remove(a)};g.prototype._constructLegendElements=function(a){var e=this,b=a.layer;"featureCollections"in b&&b.featureCollections?a.buildLegendElementsForFeatureCollections(b.featureCollections):"renderer"in b&&b.renderer?a.buildLegendElementsForRenderer(b.renderer):
"url"in b&&b.url?a.buildLegendElementsForTools():a.children.forEach(function(a){return e._constructLegendElements(a)})};h.__decorate([n.property({type:p})],g.prototype,"activeLayerInfos",void 0);h.__decorate([n.property()],g.prototype,"basemapLegendVisible",void 0);h.__decorate([n.property()],g.prototype,"groundLegendVisible",void 0);h.__decorate([n.property()],g.prototype,"keepCacheOnDestroy",void 0);h.__decorate([n.property()],g.prototype,"respectLayerVisibility",void 0);h.__decorate([n.property()],
g.prototype,"layerInfos",void 0);h.__decorate([n.property({dependsOn:["view.ready"],readOnly:!0})],g.prototype,"state",null);h.__decorate([n.property()],g.prototype,"view",void 0);return g=h.__decorate([n.subclass("esri.widgets.Legend.LegendViewModel")],g)}(m)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports tslib ../../../Color ../../../request ../../../symbols ../../../core/Accessor ../../../core/addTokenParameter ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils @dojo/framework/shim/Promise".split(" "),
function(x,c,h,f,m,d,k,r,n,t,p,b,a,l,g,e,q,u,w,F,G,z,B,y,C,H,E,A,v,S,D,P){function J(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function Q(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function R(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function W(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function T(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function O(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function M(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function ca(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}function X(a){return"esri.layers.BuildingSceneLayer"===a.declaredClass}var U=a.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),K=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Y=new b.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),
Z={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},V=new d.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),pa=new d.SimpleFillSymbol({style:"solid"}),aa=new d.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}}),I={};return function(a){function b(b){b=a.call(this,b)||
this;b._handles=new p;b._hasColorRamp=!1;b._hasOpacityRamp=!1;b._hasSizeRamp=!1;b._webStyleSymbolCache=new Map;b._dotDensityUrlCache=new Map;b._scaleDrivenSizeVariable=null;b._hasClusterSizeVariable=!1;b.children=new t;b.layerView=null;b.layer=null;b.legendElements=[];b.parent=null;b.keepCacheOnDestroy=!1;b.respectLayerVisibility=!0;b.sublayerIds=[];b.title=null;b.view=null;return b}h.__extends(b,a);b.prototype.initialize=function(){var a=this,b=function(){return a.notifyChange("ready")};this._handles.add([u.on(this,
"children","change",function(e){var L=e.removed,g=a._handles;e.added.map(function(a){var e="activeLayerInfo-ready-watcher-"+a.layer.uid;g.add(u.init(a,"ready",b),e)});L.forEach(function(a){return g.remove(a.layer.uid)});b()})]);this.keepCacheOnDestroy||(I={})};b.prototype.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(I=null)};Object.defineProperty(b.prototype,"opacity",{get:function(){var a,
b=this.layer.opacity,e=null===(a=this.parent)||void 0===a?void 0:a.opacity;a=(a=this.layer.parent)&&"uid"in a?this._getParentLayerOpacity(a):null;return null!=e?e*b:null!=a?a*b:b},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"ready",{get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"scale",{get:function(){return this.view&&this.view.scale},enumerable:!1,
configurable:!0});Object.defineProperty(b.prototype,"isScaleDriven",{get:function(){var a=this,b=this.layer;if(null===b)return!1;if("featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type)return!0;if("renderer"in b&&b.renderer){if("dot-density"===b.renderer.type)return!0;var e=b.get("renderer.valueExpression");if(K.test(e))return!0;if(b=b.get("renderer.visualVariables"))return b.some(function(b){return a._isScaleDrivenSizeVariable(b)})}return this._isLayerScaleDriven(this.layer)},
enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!1,configurable:!0});b.prototype.buildLegendElementsForFeatureCollections=function(a){return h.__awaiter(this,void 0,void 0,function(){var b,e=this;return h.__generator(this,function(L){this.legendElements=[];b=a.map(function(a){if("esri.layers.FeatureLayer"===a.declaredClass)return e._buildRendererLegendElements(a.renderer,{title:a.title,mode:0});if(a.featureSet&&
a.featureSet.features.length){var b=a.layerDefinition,g=b&&b.drawingInfo,g=g&&z.fromJSON(g.renderer),b=Y.read(b.geometryType);return g?e._buildRendererLegendElements(g,{title:a.name,mode:0,geometryType:b}):(U.warn("drawingInfo not available!"),null)}return null});return[2,g.eachAlways(b).then(function(){})]})})};b.prototype.buildLegendElementsForRenderer=function(a){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(b){return[2,this._buildRendererLegendElements(a)]})})};
b.prototype.buildLegendElementsForTools=function(){return h.__awaiter(this,void 0,void 0,function(){var a,b=this;return h.__generator(this,function(e){switch(e.label){case 0:a=this.layer;if("esri.layers.WMTSLayer"!==a.declaredClass)return[3,1];this._constructLegendElementsForWMTSlayer();return[3,8];case 1:if("esri.layers.WMSLayer"!==a.declaredClass)return[3,2];this._constructLegendElementsForWMSSublayers();return[3,8];case 2:return X(a)?[4,this._constructLegendElementsForBuildingSceneLayer()]:[3,
4];case 3:return e.sent(),[3,8];case 4:return"esri.layers.MapImageLayer"===a.declaredClass||"esri.layers.TileLayer"===a.declaredClass||X(a)?[4,this._constructLegendElementsForSublayers()]:[3,6];case 5:return e.sent(),[3,8];case 6:return this._handles.remove("imageryLayers-watcher"),[4,this._getLegendLayers().then(function(e){b.legendElements=[];e.forEach(function(e){if("esri.layers.ImageryLayer"===a.declaredClass){var g=a.watch("renderingRule, bandIds",function(){I["default"]=null;b.buildLegendElementsForTools()});
b._handles.add(g,"imageryLayers-watcher")}(e=b._generateSymbolTableElementForLegendLayer(e))&&e.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(e.title=a.title),b.legendElements.push(e));b.notifyChange("ready")});b.notifyChange("ready")}).catch(function(a){U.warn("Request to server for legend has failed!",a)})];case 7:e.sent(),e.label=8;case 8:return[2]}})})};b.prototype._getParentLayerOpacity=function(a){var b=1,e=a.parent;e&&"uid"in e&&(b=this._getParentLayerOpacity(e));return a.opacity*
b};b.prototype._isGroupActive=function(){var a=this.children;return a.length?a.some(function(a){return a.ready}):!1};b.prototype._isScaleDrivenSizeVariable=function(a){if(a&&"size"!==a.type)return!1;var b=a.minSize,e=a.maxSize;return"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):"object"===typeof e&&e?this._isScaleDrivenSizeVariable(e):!!a.expression||K.test(a.valueExpression)};b.prototype._isLayerScaleDriven=function(a){var b=this;if("minScale"in a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;
if("sublayers"in a&&a.sublayers)return a.sublayers.some(function(a){return b._isLayerScaleDriven(a)});var e=a.parent;if(!1===a.loaded&&e&&"esri.layers.MapImageLayer"===e.declaredClass&&"source"in a&&a.source&&"map-layer"===a.source.type)for(var g=0,e=e.sourceJSON.layers;g<e.length;g++){var d=e[g];if(d.id===a.source.mapLayerId&&(0<d.minScale||0<d.maxScale))return!0}return!1};b.prototype._buildRendererLegendElements=function(a,b){void 0===b&&(b={});return h.__awaiter(this,void 0,void 0,function(){var e,
g;return h.__generator(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this._getRendererLegendElements(a,{title:b.title,geometryType:b.geometryType})];case 1:return e=d.sent(),0===b.mode?Array.prototype.push.apply(this.legendElements,e):this.legendElements=e,this.notifyChange("ready"),[3,3];case 2:return g=d.sent(),U.warn("error while building legend for layer!",g),[3,3];case 3:return[2]}})})};b.prototype._constructLegendElementsForWMTSlayer=function(){var a=this;this.legendElements=
[];this._handles.remove("wmts-activeLayer-watcher");var b=this.layer.activeLayer;this._handles.add(u.watch(this.layer,"activeLayer",function(){return a._constructLegendElementsForWMTSlayer()}),"wmts-activeLayer-watcher");if(b.styleId&&b.styles){var e=null;b.styles.some(function(a){return b.styleId===a.id?(e=a.legendUrl,!0):!1});e&&(this.legendElements=[{type:"symbol-table",title:b.title,infos:[{src:e,opacity:this.opacity}]}])}this.notifyChange("ready")};b.prototype._constructLegendElementsForWMSSublayers=
function(){var a=this;this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var b=this.layer,e=null;if(b.customParameters||b.customLayerParameters)e=h.__assign(h.__assign({},b.customParameters),b.customLayerParameters);this._handles.add(u.watch(this.layer,"sublayers",function(){return a._constructLegendElementsForWMSSublayers()}),"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(b.sublayers,e);this.notifyChange("ready")};b.prototype._generateLegendElementsForWMSSublayers=
function(a,b){var e=this,g=[];this._handles.add(a.on("change",function(){return e._constructLegendElementsForWMSSublayers()}),"wms-sublayers-watcher");a.forEach(function(a){var d=a.watch("title, visible, legendEnabled",function(){return e._constructLegendElementsForWMSSublayers()});e._handles.add(d,"wms-sublayers-watcher");a.visible&&a.legendEnabled&&(a=e._generateSymbolTableElementForWMSSublayer(a,b))&&a.infos.length&&g.unshift(a)});return g};b.prototype._generateSymbolTableElementForWMSSublayer=
function(a,b){return!a.legendUrl&&a.sublayers?(b=this._generateLegendElementsForWMSSublayers(a.sublayers,b).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:b}):this._generateSymbolTableElementForLegendUrl(a,b)};b.prototype._generateSymbolTableElementForLegendUrl=function(a,b){var e=a.legendUrl;if(e){var g={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};b&&(e+="?"+q.objectToQuery(b));g.infos.push({src:e,opacity:a.layer&&a.layer.opacity});return g}};b.prototype._getLegendLayers=
function(a){var b=(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",e=I&&I[b];return e?g.resolve(e):this._legendRequest(a).then(function(a){a=a.layers;return I[b]=a})};b.prototype._legendRequest=function(a){var b=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===b.declaredClass){var e=b.exportImageServiceParameters.renderingRule;e&&(a.renderingRule=JSON.stringify(e.toJSON()));b.bandIds&&(a.bandIds=b.bandIds.join());if(b.raster||b.viewId)a=h.__assign({raster:b.raster,
viewId:b.viewId},a)}e=b.url.replace(/(\/)+$/,"");"version"in b&&10.01<=b.version?(b=e.indexOf("?"),e=-1<b?e.substring(0,b)+"/legend"+e.substring(b):e+"/legend"):(b=e.toLowerCase().indexOf("/rest/"),b=e.substring(0,b)+e.substring(b+5,e.length),e="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(b)+"\x26returnbytes\x3dtrue");return m(e,{query:a}).then(function(a){return a.data})};b.prototype._constructLegendElementsForBuildingSceneLayer=function(){return h.__awaiter(this,void 0,
void 0,function(){var a,b,e,g=this;return h.__generator(this,function(d){switch(d.label){case 0:this.legendElements=[],this._handles.remove("sublayers-watcher"),a=this.layer,this._handles.add(u.watch(a,"sublayers",function(){return g._constructLegendElementsForBuildingSceneLayer()}),"sublayers-watcher"),d.label=1;case 1:return d.trys.push([1,3,,4]),b=this,[4,this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity)];case 2:return b.legendElements=d.sent(),this.notifyChange("ready"),
[3,4];case 3:return e=d.sent(),U.warn("Request to server for legend has failed!",e),[3,4];case 4:return[2]}})})};b.prototype._generateLegendElementsForBuildingSublayers=function(a,b){return h.__awaiter(this,void 0,void 0,function(){var e,g,d,l,f,p,L,c,D,q,k,C=this;return h.__generator(this,function(u){switch(u.label){case 0:e=[],this._handles.add(a.on("change",function(){return C._constructLegendElementsForBuildingSceneLayer()}),"sublayers-watcher"),g=a.toArray(),d=0,l=g,u.label=1;case 1:if(!(d<l.length))return[3,
6];f=l[d];p=f.watch("renderer, opacity, title, visible",function(){return C._constructLegendElementsForBuildingSceneLayer()});this._handles.add(p,"sublayers-watcher");if(!f.visible)return[3,5];L=f&&null!=f.opacity?f.opacity:null;c=null!=L?L*b:b;if("building-group"!==f.type)return[3,3];D={type:"symbol-table",title:f.title,infos:[]};return[4,this._generateLegendElementsForBuildingSublayers(f.sublayers,c)];case 2:return q=u.sent(),(k=D.infos).push.apply(k,q),e=h.__spreadArrays([D],e),[3,5];case 3:return f.renderer?
[4,this._getRendererLegendElements(f.renderer,{title:f.title,opacity:c,sublayer:f})]:[3,5];case 4:q=u.sent(),e=h.__spreadArrays(q,e),u.label=5;case 5:return d++,[3,1];case 6:return[2,e.filter(function(a){return!!a&&("infos"in a?0<a.infos.length:!0)})]}})})};b.prototype._constructLegendElementsForSublayers=function(){return h.__awaiter(this,void 0,void 0,function(){var a,b,e,g=this;return h.__generator(this,function(d){switch(d.label){case 0:this.legendElements=[],this._handles.remove("sublayers-watcher"),
a=this.layer,this._handles.add(u.watch(a,"sublayers",function(){return g._constructLegendElementsForSublayers}),"sublayers-watcher"),d.label=1;case 1:return d.trys.push([1,3,,4]),b=this,[4,this._generateLegendElementsForSublayers(a.sublayers,this.opacity)];case 2:return b.legendElements=d.sent(),this.notifyChange("ready"),[3,4];case 3:return e=d.sent(),U.warn("Request to server for legend has failed!",e),[3,4];case 4:return[2]}})})};b.prototype._generateLegendElementsForSublayers=function(a,b,e){return h.__awaiter(this,
void 0,void 0,function(){var g,d,l,f,p,c,L,D,q,k,u=this;return h.__generator(this,function(C){switch(C.label){case 0:g=[],this._handles.add(a.on("change",function(){return u._constructLegendElementsForSublayers()}),"sublayers-watcher"),d=a.toArray(),!e&&this.sublayerIds&&this.sublayerIds.length&&(l=this.layer,d=this.sublayerIds.map(function(a){return l.findSublayerById(a)}).filter(Boolean)),f=new F.ExportImageParameters({layer:this.layer}),p=f.hasDynamicLayers&&f.dynamicLayers||"default",f.destroy(),
c=function(a){var d,l,f,c,D;return h.__generator(this,function(q){switch(q.label){case 0:d=a.watch("renderer, opacity, title, visible, legendEnabled",function(b,g,d){(b=I&&I[p])&&!e&&(e=new Map,b.forEach(function(a){return e.set(a.layerId,a)}));b=null===e||void 0===e?void 0:e.get(a.id);("renderer"!==d||2<a.originIdOf("renderer")||!b)&&u._constructLegendElementsForSublayers()});L._handles.add(d,"sublayers-watcher");if(!a.visible||!a.legendEnabled)return[3,6];l=a&&null!=a.opacity?a.opacity:null;f=null!=
l?l*b:b;return a.renderer&&!a.sublayers&&2<a.originIdOf("renderer")?L.respectLayerVisibility&&!L._isSublayerInScale(a)?[3,3]:[4,a.load()]:[3,4];case 1:return q.sent(),[4,L._getRendererLegendElements(a.renderer,{title:a.title,opacity:f,sublayer:a})];case 2:c=q.sent(),g=h.__spreadArrays(c,g),q.label=3;case 3:return[3,6];case 4:return[4,L._generateSymbolTableElementForSublayer(a,f,e)];case 5:(D=q.sent())&&g.unshift(D),q.label=6;case 6:return[2]}})},L=this,D=0,q=d,C.label=1;case 1:if(!(D<q.length))return[3,
4];k=q[D];return[5,c(k)];case 2:C.sent(),C.label=3;case 3:return D++,[3,1];case 4:return[2,g.filter(function(a){return!!a&&("infos"in a?0<a.infos.length:!0)})]}})})};b.prototype._generateSymbolTableElementForSublayer=function(a,b,e){return h.__awaiter(this,void 0,void 0,function(){var g,d,l,f;return h.__generator(this,function(p){switch(p.label){case 0:if(e)return[3,4];e=new Map;g=new F.ExportImageParameters({layer:this.layer});p.label=1;case 1:return p.trys.push([1,,3,4]),[4,this._getLegendLayers(g)];
case 2:return d=p.sent(),d.forEach(function(a){return e.set(a.layerId,a)}),[3,4];case 3:return g.destroy(),[7];case 4:return(l=e.get(a.id))||!a.sublayers?[3,6]:[4,this._generateLegendElementsForSublayers(a.sublayers,b,e)];case 5:return f=p.sent(),[2,{type:"symbol-table",title:a.title,infos:f}];case 6:return[2,this._generateSymbolTableElementForLegendLayer(l,a,b)]}})})};b.prototype._generateSymbolTableElementForLegendLayer=function(a,b,e){var g=this;if(!a||!a.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,
b))return null;var d=b&&b.renderer,l=b&&b.title||a.layerName;d&&(d=b&&b.title||this._getRendererTitle(d,b))&&(l&&(d.title=l),l=d);l={type:"symbol-table",title:l,infos:[]};a.legendType&&(l.legendType=a.legendType);b=b?this._sanitizeLegendForSublayer(a.legend.slice(),b):a.legend;l.infos=b.map(function(b){var d=b.url;if(b.imageData&&0<b.imageData.length)d="data:image/png;base64,"+b.imageData;else if(0!==d.indexOf("http"))d=r.addTokenParameter(g.layer.url+"/"+a.layerId+"/images/"+d);else return null;
return{label:b.label,src:d,opacity:null==e?g.opacity:e,width:b.width,height:b.height}}).filter(function(a){return!!a});return l.infos.length?l:null};b.prototype._isSublayerInScale=function(a){var b=a.minScale||0;a=a.maxScale||0;return 0<b&&b<this.scale||a>this.scale?!1:!0};b.prototype._isLegendLayerInScale=function(a,b){b=b||this.layer;var e=null,g=null,d=!0;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==b.maxScale?(0===a.minScale&&b.tileInfo&&(e=b.tileInfo.lods[0].scale),0===a.maxScale&&b.tileInfo&&
(g=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(e=Math.min(b.minScale,a.minScale)||b.minScale||a.minScale,g=Math.max(b.maxScale,a.maxScale));if(0<e&&e<this.scale||g>this.scale)d=!1;return d};b.prototype._sanitizeLegendForSublayer=function(a,b){if("version"in this.layer&&10.1>this.layer.version||0===a.length)return a;b=b.renderer;var e=null,g=null;a.some(function(a){return a.values})&&a.some(function(a,b){a.values||(e=b,g=a,g.label||(g.label="others"));return null!=g});b?"unique-value"===b.type?
g&&(a.splice(e,1),a.push(g)):"class-breaks"===b.type&&(g&&a.splice(e,1),a.reverse(),g&&a.push(g)):g&&(a.splice(e,1),a.push(g));return a};b.prototype._getRendererLegendElements=function(a,b){void 0===b&&(b={});return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(e){return J(a)||Q(a)||R(a)||"raster-stretch"===a.type||"raster-colormap"===a.type||W(a)||T(a)||O(a)||M(a)||ca(a)||"vector-field"===a.type||"raster-shaded-relief"===a.type?T(a)||O(a)||M(a)||"esri.renderers.PointCloudRGBRenderer"===
a.declaredClass?[2,this._constructPointCloudRendererLegendElements(a,b)]:ca(a)?[2,this._constructDotDensityRendererLegendElements(a)]:[2,this._constructRendererLegendElements(a,b)]:(U.warn("Renderer not supported!"),[2,[]])})})};b.prototype._getPointCloudRendererTitle=function(a){return a.legendOptions&&a.legendOptions.title||a.field};b.prototype._constructPointCloudRendererLegendElements=function(a,b){var e=this;void 0===b&&(b={});b=b.title;var d=[],l=null,f=null;if(T(a))l={type:"symbol-table",title:b||
this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(function(a){l.infos.unshift({label:a.label||a.minValue+" - "+a.maxValue,value:[a.minValue,a.maxValue],symbol:e._getAppliedCloneSymbol(V,a.color)})});else if(O(a)){var f=a.stops,p=null;if(f.length&&(1===f.length&&(p=f[0].color),!p)){var c=f[0].value,D=f[f.length-1].value;null!=c&&null!=D&&(p=A.getColorFromPointCloudStops(c+(D-c)/2,f))}l={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(V,
p||V.color)}]};f=A.getRampStopsForPointCloud(a.stops);f={type:"color-ramp",title:b||this._getPointCloudRendererTitle(a),infos:f,preview:C.renderColorRampPreviewHTML(f.map(function(a){return a.color}))}}else M(a)&&(l={type:"symbol-table",title:b||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos.forEach(function(a){l.infos.push({label:a.label||a.values.join(", "),value:a.values.join(", "),symbol:e._getAppliedCloneSymbol(V,a.color)})}));l&&l.infos.length&&d.push(l);f&&f.infos.length&&
d.push(f);a=d.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return e._getSymbolPreview(a,e.opacity)});return g.eachAlways(a).then(function(){return d})};b.prototype._getElementInfoForDotDensity=function(a,b){var e=a.outline,e=a.dotSize+"-"+b+"-"+a.backgroundColor+"-"+(e&&JSON.stringify(e.toJSON())),g=this._dotDensityUrlCache;a=g.has(e)?g.get(e):C.renderDotDensityPreviewHTML(a,b);g.set(e,a);return{opacity:1,src:a.src,preview:a,width:a.width,
height:a.height}};b.prototype._constructDotDensityRendererLegendElements=function(a){var b=this,e=a.calculateDotValue(this.view.scale),d={type:"symbol-table",title:{value:e&&Math.round(e),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(function(e){var g=b._getElementInfoForDotDensity(a,e.color);g.label=e.label||e.valueExpressionTitle||e.field;d.infos.push(g)});return g.resolve([d])};b.prototype._constructRendererLegendElements=function(a,b){void 0===b&&(b={});return h.__awaiter(this,
void 0,void 0,function(){var e,f,p,c,D,q,k,u,m,w,L,M,r,n,O,P,B,y,H,t,A,E,F,qa,G,z,ca,X,U,T,I,x,K,ba,N,Z,Y,V,da,ia,ma,na,oa,ea=this;return h.__generator(this,function(h){switch(h.label){case 0:return e=b.title,p=(f=b.sublayer)||this.layer,[4,this._loadRenderer(a)];case 1:return c=h.sent(),this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1,this._scaleDrivenSizeVariable=null,[4,this._getVisualVariableLegendElements(c,p)];case 2:D=h.sent()||[];q={type:"symbol-table",title:e||this._getRendererTitle(c,
p),infos:[]};k=null;u=!1;m=new Set;if(!W(c))return[3,3];w=v.getHeatmapRampStops(c);D.push({type:"heatmap-ramp",title:e,infos:w,preview:C.renderColorRampPreviewHTML(w.map(function(a){return a.color}))});return[3,12];case 3:if(!R(c))return[3,4];if(M=(L=c&&c.authoringInfo)&&"relationship"===L.type){if(r=L.focus,n=L.numClasses,O=L.field1,P=L.field2,n&&O&&P){B=[O,P];y=S.getRotationAngleForFocus(r)||0;H=0;for(t=B;H<t.length;H++)A=t[H],E=A.field,F=A.normalizationField,G=(qa=A.label)||{field:this._getFieldAlias(E,
p),normField:F&&this._getFieldAlias(F,p)},z=aa.clone(),z.angle=y,q.infos.push({label:G,symbol:z}),m.add(z),y+=90;ca=S.getRelationshipRampElement({focus:r,numClasses:n,infos:c.uniqueValueInfos});D.unshift(ca)}}else X=c.field,c.uniqueValueInfos.forEach(function(a){if(a.symbol){var b=a.symbol.clone();"esri.layers.ImageryLayer"===ea.layer.declaredClass&&(b=d.SimpleMarkerSymbol.fromJSON({color:b.color,style:"square"}));q.infos.push({label:a.label||ea._getDomainName(X,a.value,p)||a.value,value:a.value,
symbol:b})}});c.defaultSymbol&&(q.infos.push({label:c.defaultLabel||"others",symbol:c.defaultSymbol}),u=!0);return[3,12];case 4:if(!Q(c))return[3,5];k=this._isUnclassedRenderer(c);if(U=!k||!this._hasSizeRamp)c.classBreakInfos.forEach(function(a){if(a.symbol){var b=a.symbol.clone();"esri.layers.ImageryLayer"===ea.layer.declaredClass&&(b=d.SimpleMarkerSymbol.fromJSON({color:b.color,style:"square"}));q.infos.unshift({label:a.label||(k?null:a.minValue+" - "+a.maxValue),value:[a.minValue,a.maxValue],symbol:b})}}),
k&&(q.title=null),this._updateInfosforClassedSizeRenderer(c,q.infos);c.defaultSymbol&&!k&&(q.infos.push({label:c.defaultLabel||"others",symbol:c.defaultSymbol}),u=!0);return[3,12];case 5:if("raster-stretch"!==c.type)return[3,11];if("esri.layers.ImageryTileLayer"!==this.layer.declaredClass&&"esri.layers.WCSLayer"!==this.layer.declaredClass)return[3,6];T=this._constructTileImageryStretchRendererElements(c);"stretch-ramp"===T.type?D.push(T):q.infos=T;return[3,10];case 6:return I=this.layer,K=x=void 0,
c.statistics&&c.statistics.length&&(x=c.statistics[0].min||c.statistics[0][0],K=c.statistics[0].max||c.statistics[0][1]),ba=[],Z=l.unwrap,I.renderingRule?[4,I.generateRasterInfo(I.renderingRule)]:[3,8];case 7:return Y=h.sent(),[3,9];case 8:Y=I.serviceRasterInfo,h.label=9;case 9:N=Z.apply(void 0,[Y]),V=N.keyProperties.BandProperties,1===N.bandCount?(x=x||N.statistics&&N.statistics[0].min,K=K||N.statistics&&N.statistics[0].max,x||K?D.push(this._getStretchLegendElements(c,{min:x,max:K})):this.buildLegendElementsForTools()):
I.bandIds&&1===I.bandIds.length?(x=x||N.statistics&&N.statistics[I.bandIds[0]].min,K=K||N.statistics&&N.statistics[I.bandIds[0]].max,x||K?D.push(this._getStretchLegendElements(c,{min:x,max:K})):this.buildLegendElementsForTools()):3<=N.bandCount?V&&V.length>=N.bandCount?I.bandIds&&3===I.bandIds.length?(ba=I.bandIds.map(function(a){return V[a].BandName}),q.infos=this._createSymbolTableElementMultiBand(ba)):"lerc"===I.format?(ba=[0,1,2].map(function(a){return V[a].BandName}),q.infos=this._createSymbolTableElementMultiBand(ba)):
this.buildLegendElementsForTools():"lerc"===I.format?(ba=["band1","band2","band3"],q.infos=this._createSymbolTableElementMultiBand(ba)):this.buildLegendElementsForTools():this.buildLegendElementsForTools(),h.label=10;case 10:return[3,12];case 11:if("raster-colormap"===c.type)c.colormapInfos.forEach(function(a){q.infos.push({label:a.label,value:a.value,symbol:ea._getAppliedCloneSymbol(pa,a.color)})});else if(J(c)){z=c.symbol;switch(b.geometryType){case "point":z="pointSymbol"in p&&p.pointSymbol;break;
case "polyline":z="lineSymbol"in p&&p.lineSymbol;break;case "polygon":z="polygonSymbol"in p&&p.polygonSymbol}c.symbol&&!this._hasSizeRamp&&q.infos.push({label:c.label,symbol:z})}else"vector-field"===c.type?(c.outputUnit&&(this.title="("+c.toJSON().outputUnit+")"),q.title=c.attributeField,da=c.getClassBreakInfos(),(null===da||void 0===da?0:da.length)?da.forEach(function(a){q.infos.push({label:a.minValue+" - "+a.maxValue,symbol:a.symbol})}):q.infos.push({label:c.attributeField,symbol:c.getDefaultSymbol()})):
"raster-shaded-relief"===c.type&&D.push(this._getStretchLegendElements(c,{min:0,max:255}));h.label=12;case 12:return ia=c.defaultSymbol,!ia||u||J(c)||k&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||D.push({type:"symbol-table",infos:[{label:c.defaultLabel||"others",symbol:ia}]}),q.infos.length&&D.unshift(q),ma=null==b.opacity?this.opacity:b.opacity,na=this._getSymbolConfig("visualVariables"in c&&c.visualVariables),oa=D.reduce(function(a,b){return a.concat(b.infos)},[]).filter(function(a){return!(!a||
!a.symbol)}).map(function(a){return ea._getSymbolPreview(a,ma,{applyScaleDrivenSize:!m.has(a.symbol),symbolConfig:na})}),c=null,[4,g.eachAlways(oa)];case 13:return h.sent(),[2,D]}})})};b.prototype._constructTileImageryStretchRendererElements=function(a){function b(a){var b,d=((null===(b=null===e||void 0===e?void 0:e.bandIds)||void 0===b?void 0:b.length)===g.bandCount?e.bandIds:Array.from(Array(Math.min(g.bandCount,3)).keys())).map(function(b){return a&&a[b]&&a[b].BandName||"band"+(b+1)});3>d.length?
d.push(d[1]):3<d.length&&d.splice(3);return d}var e=this.layer,g=e.rasterInfo,d=g.bandCount||a.statistics.length,l,f,c=[],c=g.keyProperties&&g.keyProperties.BandProperties;a.statistics&&a.statistics.length?(l=void 0!==a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],f=a.statistics[0].max||a.statistics[0][1]):"esri.layers.WCSLayer"===e.declaredClass&&(f=Z[e.rasterInfo.pixelType.toLowerCase()],l=f[0],f=f[1]);if(1===g.bandCount)return this._getStretchLegendElements(a,{min:l,max:f});c=c&&c.length>=
d?b(c):b();return this._createSymbolTableElementMultiBand(c)};b.prototype._getStretchLegendElements=function(a,b){a=A.getStrectchRampStops(a.colorRamp,b);return{type:"stretch-ramp",title:"",infos:a,preview:C.renderColorRampPreviewHTML(a.map(function(a){return a.color}))}};b.prototype._createSymbolTableElementMultiBand=function(a){var b=[],e=["red","green","blue"];a.forEach(function(a,g){b.push({label:{colorName:e[g],bandName:a},src:P.RGB_IMG_SOURCE[g],opacity:1})});return b};b.prototype._updateInfosforClassedSizeRenderer=
function(a,b){var e=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,g=a.classBreakInfos.some(function(a){return H.isVolumetricSymbol(a.symbol)});if(e&&g){var d=D.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;var l=(d-D.REAL_WORLD_MIN_SIZE)/(1<a?a-1:a);b.forEach(function(a,b){a.size=d-l*b})}};b.prototype._getSymbolConfig=function(a){var b=!1,e=!1;if(a)for(var g=0;g<a.length&&(!b||!e);g++){var d=a[g];"size"===d.type&&("height"===d.axis&&(b=!0),"width-and-depth"===d.axis&&(e=!0))}return b&&
e?"tall":null};b.prototype._getSymbolPreview=function(a,b,g){return h.__awaiter(this,void 0,void 0,function(){var d,l;return h.__generator(this,function(f){switch(f.label){case 0:return d=null==a.size&&this._hasSizeRamp?e.px2pt(22):a.size,this._scaleDrivenSizeVariable&&(null===g||void 0===g?0:g.applyScaleDrivenSize)?[4,new Promise(function(a,b){x(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})]:[3,2];case 1:l=f.sent().getSize,d=l(this._scaleDrivenSizeVariable,null,{view:this.view,
scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}),f.label=2;case 2:return[2,C.renderPreviewHTML(a.symbol,{size:d,opacity:b,scale:!1,symbolConfig:null===g||void 0===g?void 0:g.symbolConfig,rotation:a.symbol.angle}).then(function(b){a.preview=b;return a}).catch(function(){a.preview=null;return a})]}})})};b.prototype._loadRenderer=function(a){var b,e;return h.__awaiter(this,void 0,void 0,function(){var d,f,c,p,D,q,k,u,C,m,w,M,r=this;return h.__generator(this,function(h){switch(h.label){case 0:return d=
[],f=this.layer,a=a.clone(),this._hasClusterSizeVariable=!1,c="visualVariables"in a&&(null===(b=a.visualVariables)||void 0===b?void 0:b.some(function(a){return"size"===a.type&&"outline"!==a.target&&!K.test(a.valueExpression)})),a&&"visualVariables"in a&&!c&&"featureReduction"in f&&"cluster"===(null===(e=f.featureReduction)||void 0===e?void 0:e.type)&&(p=this.layerView._effectiveRenderer,D=l.unwrap(E.getClusterSizeVariable(p,this.view)))&&(q=f.featureReduction,"clusterMinSize"in q&&"clusterMaxSize"in
q&&(k=q.clusterMinSize,u=q.clusterMaxSize,D.legendOptions=new B({showLegend:k!==u})),C=a.visualVariables||[],a.visualVariables=C.concat([D]),this._hasClusterSizeVariable=!0),[4,this._getMedianColor(a)];case 1:m=h.sent();if(Q(a)||R(a))w=a.classBreakInfos||a.uniqueValueInfos,M=w.map(function(a){return r._fetchSymbol(a.symbol,m).then(function(b){a.symbol=b}).catch(function(){a.symbol=null})}),Array.prototype.push.apply(d,M);d.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:m).then(function(b){r._applySymbolToRenderer(a,
b,J(a))}).catch(function(){r._applySymbolToRenderer(a,null,J(a))}));return[2,g.eachAlways(d).then(function(){return a})]}})})};b.prototype._applySymbolToRenderer=function(a,b,e){e?a.symbol=b:a.defaultSymbol=b};b.prototype._getMedianColor=function(a){return h.__awaiter(this,void 0,void 0,function(){var b,e,g,d,f;return h.__generator(this,function(l){switch(l.label){case 0:if(!("visualVariables"in a&&a.visualVariables))return[2,null];b=n.find(a.visualVariables,function(a){return"color"===a.type});if(!b)return[2,
null];g=e=null;if(b.stops){if(1===b.stops.length)return[2,b.stops[0].color];e=b.stops[0].value;g=b.stops[b.stops.length-1].value}d=e+(g-e)/2;return[4,new Promise(function(a,b){x(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=l.sent().getColor,[2,f(b,d)]}})})};b.prototype._fetchSymbol=function(a,b){var e=this;if(!a)return g.reject();if("web-style"===a.type){var d=a.portal,d=a.name+"-"+a.styleName+"-"+a.styleUrl+"-"+(d&&d.url)+"-"+(d&&d.user&&d.user.username),
f=this._webStyleSymbolCache;f.has(d)||("2d"===this.view.type?f.set(d,a.fetchCIMSymbol()):f.set(d,a.fetchSymbol()));return f.get(d).then(function(a){return e._getAppliedCloneSymbol(a,b)}).catch(function(){U.warn("Fetching web-style failed!");return g.reject()})}return g.resolve(this._getAppliedCloneSymbol(a,b))};b.prototype._getAppliedCloneSymbol=function(a,b){if(!a||!b)return a;a=a.clone();var e=b&&b.toRgba();-1<a.type.indexOf("3d")?this._applyColorTo3dSymbol(a,e):"cim"===a.type?y.applyCIMSymbolColor(a,
b):a.color&&(a.color=new f(e||a.color));return a};b.prototype._applyColorTo3dSymbol=function(a,b){b&&a.symbolLayers.forEach(function(a){a&&(a.material||(a.material={}),a.material.color=new f(b))})};b.prototype._getVisualVariableLegendElements=function(a,b){return h.__awaiter(this,void 0,void 0,function(){var e,d,f,c,p,q,k,u,m,w,M,r,n=this;return h.__generator(this,function(O){switch(O.label){case 0:if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return[2,null];e=a.visualVariables;
d=[];f=[];c=[];p=0;for(q=e;p<q.length;p++)k=q[p],"color"===k.type?d.push(k):"size"===k.type?f.push(k):"opacity"===k.type&&c.push(k);u=h.__spreadArrays(d,f,c);0===d.length&&Q(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&(m=(M=a.classBreakInfos[0])&&M.symbol);0===d.length&&J(a)&&(m=a.symbol);m&&(-1<m.type.indexOf("3d")?(r=m.symbolLayers.getItemAt(0),"water"===r.type?l.isSome(r.color)&&(w=r.color):l.isSome(r.material)&&l.isSome(r.material.color)&&(w=r.material.color)):m.url||(w=m.color));return[4,
g.all(u.map(function(e){return h.__awaiter(n,void 0,void 0,function(){var d,g,f,l,c,p,q,k;return h.__generator(this,function(h){switch(h.label){case 0:if(e.legendOptions&&!1===e.legendOptions.showLegend)return[3,10];d=this._getRampTitle(e,b);g=null;l=(f="getField"in b&&b.getField&&b.getField(e.field))&&G.isDateField(f);return"color"!==e.type?[3,2]:[4,A.getRampStops(e,null,l)];case 1:return c=h.sent(),g={type:"color-ramp",title:d,infos:c,preview:C.renderColorRampPreviewHTML(c.map(function(a){return a.color}))},
this._hasColorRamp||(this._hasColorRamp=!(null==g.infos||!g.infos.length)),[3,9];case 2:if("size"!==e.type||"outline"===e.target)return[3,7];if(!K.test(e.valueExpression))return[3,3];this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=e);return[3,6];case 3:return p={type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):d},q=D.getRampStops,k=[a,e],[4,this._getMedianColor(a)];case 4:return[4,q.apply(void 0,k.concat([h.sent(),this.scale,this.view,l]))];case 5:g=(p.infos=
h.sent(),p),this._hasSizeRamp||(this._hasSizeRamp=!(null==g.infos||!g.infos.length)),h.label=6;case 6:return[3,9];case 7:return"opacity"!==e.type?[3,9]:[4,A.getRampStops(e,w,l)];case 8:c=h.sent(),g={type:"opacity-ramp",title:d,infos:c,preview:C.renderColorRampPreviewHTML(c.map(function(a){return a.color}))},this._hasOpacityRamp||(this._hasOpacityRamp=!(null==g.infos||!g.infos.length)),h.label=9;case 9:return[2,g&&g.infos?g:null];case 10:return[2,void 0]}})})}))];case 1:return[2,O.sent().filter(function(a){return!!a})]}})})};
b.prototype._getDomainName=function(a,b,e){return a&&"function"!==typeof a?(e=(a="getField"in e&&e.getField&&e.getField(a))&&"getFieldDomain"in e&&e.getFieldDomain?e.getFieldDomain(a.name):null)&&"coded-value"===e.type?e.getName(b):null:null};b.prototype._getClusterTitle=function(a){var b=this.layer;a=a.field;if("featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type&&(b=b.featureReduction,b=(b="popupTemplate"in b&&b.popupTemplate)&&b.fieldInfos))for(var e=0;e<b.length;e++){var g=
b[e];if(g.fieldName===a)return"cluster_count"===a?g.label||{showCount:!0}:g.label}return{showCount:!0}};b.prototype._getRampTitle=function(a,b){var e=a.field,g=a.normalizationField,d=!1,f=!1,l=!1,c=null,e="function"===typeof e?null:e,g="function"===typeof g?null:g,c=a.legendOptions&&a.legendOptions.title;if(null==c)if(a.valueExpressionTitle)c=a.valueExpressionTitle;else{if("renderer"in b&&b.renderer&&"authoringInfo"in b.renderer&&b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables)for(a=
b.renderer.authoringInfo.visualVariables,c=0;c<a.length;c++){var p=a[c];if("color"===p.type){if("ratio"===p.style){d=!0;break}if("percent"===p.style){f=!0;break}if("percent-of-total"===p.style){l=!0;break}}}c={field:e&&this._getFieldAlias(e,b),normField:g&&this._getFieldAlias(g,b),ratio:d,ratioPercent:f,ratioPercentTotal:l}}return c};b.prototype._getRendererTitle=function(a,b){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;
var e=a.field,g=null,d=null;Q(a)&&(g=a.normalizationField,d="percent-of-total"===a.normalizationType);e="function"===typeof e?null:e;g="function"===typeof g?null:g;a=null;if(e||g)a={field:e&&this._getFieldAlias(e,b),normField:g&&this._getFieldAlias(g,b),normByPct:d};return a};b.prototype._getFieldAlias=function(a,b){var e="popupTemplate"in b&&b.popupTemplate,e=e&&e.fieldInfos,g=null;e&&e.some(function(b){return a===b.fieldName?(g=b,!0):!1});e=null;"getField"in b&&b.getField?e=b.getField(a):"fieldsIndex"in
b&&b.fieldsIndex&&(e=b.fieldsIndex.get(a));b=g||e;var d=null;b&&(d=g&&g.label||e&&e.alias||"name"in b&&b.name||"fieldName"in b&&b.fieldName);return d};b.prototype._isUnclassedRenderer=function(a){var b=a.visualVariables,e=!1;Q(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&b&&(e=a.field?b.some(function(b){return!(!b||a.field!==b.field||(a.normalizationField||b.normalizationField)&&a.normalizationField!==b.normalizationField)}):!!b.length);return e};h.__decorate([w.property()],b.prototype,"children",
void 0);h.__decorate([w.property()],b.prototype,"layerView",void 0);h.__decorate([w.property()],b.prototype,"layer",void 0);h.__decorate([w.property()],b.prototype,"legendElements",void 0);h.__decorate([w.property({dependsOn:["parent","parent.opacity","layer","layer.opacity"],readOnly:!0})],b.prototype,"opacity",null);h.__decorate([w.property()],b.prototype,"parent",void 0);h.__decorate([w.property({readOnly:!0})],b.prototype,"ready",null);h.__decorate([w.property()],b.prototype,"keepCacheOnDestroy",
void 0);h.__decorate([w.property()],b.prototype,"respectLayerVisibility",void 0);h.__decorate([w.property({dependsOn:["view.scale"],readOnly:!0})],b.prototype,"scale",null);h.__decorate([w.property()],b.prototype,"sublayerIds",void 0);h.__decorate([w.property({dependsOn:["layer.renderer?.valueExpression?","layer.renderer?.visualVariables?","layer.featureReduction?","scale"],readOnly:!0})],b.prototype,"isScaleDriven",null);h.__decorate([w.property()],b.prototype,"title",void 0);h.__decorate([w.property({dependsOn:["ready"],
readOnly:!0,value:0})],b.prototype,"version",null);h.__decorate([w.property()],b.prototype,"view",void 0);return b=h.__decorate([w.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],b)}(k)})},"esri/layers/support/ExportImageParameters":function(){define("require exports tslib ../../core/Accessor ../../core/HandleOwner ../../core/accessorSupport/decorators ./commonProperties ./sublayerUtils ../../views/View".split(" "),function(x,c,h,f,m,d,k,r,n){Object.defineProperty(c,"__esModule",{value:!0});
c.ExportImageParameters=void 0;var t={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};x=function(f){function b(){var a=null!==f&&f.apply(this,arguments)||this;a._scale=null;a.view=null;return a}h.__extends(b,f);b.prototype.destroy=function(){this.layer=this.view=null};Object.defineProperty(b.prototype,
"dynamicLayers",{get:function(){if(!this.hasDynamicLayers)return null;var a=this.visibleSublayers.map(function(a){return a.toExportImageJSON()});return a.length?JSON.stringify(a):null},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"hasDynamicLayers",{get:function(){return this.layer&&r.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"layer",{set:function(a){var b=this;this._get("layer")!==
a&&(this._set("layer",a),this.handles.remove("layer"),a&&this.handles.add([a.allSublayers.on("change",function(){return b.notifyChange("visibleSublayers")}),a.on("sublayer-update",function(a){return b.notifyChange(t[a.propertyName])})],"layer"))},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"layers",{get:function(){var a=this.visibleSublayers;return a?a.length?"show:"+a.map(function(a){return a.id}).join(","):"show:-1":null},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"layerDefs",{get:function(){var a=this.visibleSublayers.filter(function(a){return null!=a.definitionExpression});return a.length?JSON.stringify(a.reduce(function(a,b){a[b.id]=b.definitionExpression;return a},{})):null},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(a){this.view||(this._scale=a,this.notifyChange("scale"))},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"version",{get:function(){this.layers;this.layerDefs;this.dynamicLayers;this.timeExtent;var a=this.layer;a&&(a.dpi,a.imageFormat,a.imageTransparency,a.gdbVersion);return(this._get("version")||0)+1},set:function(a){this._set("version",a)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"visibleSublayers",{get:function(){var a=this,b=[];if(!this.layer)return b;var g=this.layer.sublayers,e=function(g){var d=a.scale,f=0===g.minScale||d<=g.minScale,c=0===g.maxScale||d>=g.maxScale;g.visible&&
(0===d||f&&c)&&(g.sublayers?g.sublayers.forEach(e):b.unshift(g))};g&&g.forEach(e);g=this._get("visibleSublayers");return!g||g.length!==b.length||g.some(function(a,e){return b[e]!==a})?b:g},enumerable:!1,configurable:!0});b.prototype.toJSON=function(){var a=this.layer,a={dpi:a.dpi,format:a.imageFormat,transparent:a.imageTransparency,gdbVersion:a.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?a.dynamicLayers=this.dynamicLayers:a=h.__assign(h.__assign({},a),{layers:this.layers,layerDefs:this.layerDefs});
return a};h.__decorate([d.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],b.prototype,"dynamicLayers",null);h.__decorate([d.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],b.prototype,"hasDynamicLayers",null);h.__decorate([d.property()],b.prototype,"layer",null);h.__decorate([d.property({readOnly:!0,dependsOn:["visibleSublayers"]})],b.prototype,"layers",null);h.__decorate([d.property({readOnly:!0,dependsOn:["visibleSublayers"]})],
b.prototype,"layerDefs",null);h.__decorate([d.property({type:Number,dependsOn:["view.scale"]})],b.prototype,"scale",null);h.__decorate([d.property(k.combinedViewLayerTimeExtentProperty)],b.prototype,"timeExtent",void 0);h.__decorate([d.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion timeExtent".split(" ")})],b.prototype,"version",null);h.__decorate([d.property({type:n})],b.prototype,"view",void 0);h.__decorate([d.property({readOnly:!0,
dependsOn:["layer.sublayers","scale"]})],b.prototype,"visibleSublayers",null);return b=h.__decorate([d.subclass("esri.layers.mixins.ExportImageParameters")],b)}(m.HandleOwnerMixin(f));c.ExportImageParameters=x})},"esri/layers/support/sublayerUtils":function(){define(["require","exports"],function(x,c){function h(f,c){if(!f||!f.length)return!0;c=c.slice().reverse().flatten(function(d){return(d=d.sublayers)&&d.toArray().reverse()}).map(function(d){return d.id}).toArray();if(f.length>c.length)return!1;
for(var d=0,h=c.length,m=0;m<f.length;m++){for(var n=f[m].id;d<h&&c[d]!==n;)d++;if(d>=h)return!1}return!0}Object.defineProperty(c,"__esModule",{value:!0});c.isSublayerOverhaul=c.isExportDynamic=c.shouldWriteSublayerStructure=void 0;c.shouldWriteSublayerStructure=function(f,c,d){return c.flatten(function(d){return d.sublayers}).length!==f.length||f.some(function(f){return f.originIdOf("minScale")>d||f.originIdOf("maxScale")>d||f.originIdOf("renderer")>d||f.originIdOf("labelingInfo")>d||f.originIdOf("opacity")>
d||f.originIdOf("labelsVisible")>d||f.originIdOf("source")>d})?!0:!h(f,c)};c.isExportDynamic=function(f,c,d){return f.some(function(f){var c=f.source;return!(!c||"map-layer"===c.type&&c.mapLayerId===f.id&&(!c.gdbVersion||c.gdbVersion===d.gdbVersion))||2<f.originIdOf("renderer")||2<f.originIdOf("labelingInfo")||2<f.originIdOf("opacity")||2<f.originIdOf("labelsVisible")})?!0:!h(f,c)};c.isSublayerOverhaul=function(f){return!!f&&f.some(function(f){return null!=f.minScale||f.layerDefinition&&null!=f.layerDefinition.minScale})}})},
"esri/symbols/support/cimSymbolUtils":function(){define(["require","exports","../../Color","../cim/utils"],function(x,c,h,f){function m(a){var b=f.toCIMSymbolJSON(a);if("CIMTextSymbol"===b.type)return b.height;a=0;if(b.symbolLayers)for(var g=0,b=b.symbolLayers;g<b.length;g++){var e=b[g];f.isCIMMarker(e)&&e.size>a?a=e.size:f.isCIMStroke(e)&&e.width>a?a=e.width:f.isCIMFill(e)}return a}function d(a,b,g){if("CIMTextSymbol"===a.type)a.height*=b;else{if(g&&a.effects){g=0;for(var e=a.effects;g<e.length;g++)n(e[g],
b)}if(a.symbolLayers)for(g=0,a=a.symbolLayers;g<a.length;g++)switch(e=a[g],e.type){case "CIMPictureMarker":case "CIMVectorMarker":k(e,b);break;case "CIMPictureStroke":case "CIMSolidStroke":e.width*=b;break;case "CIMPictureFill":e.height*=b;e.offsetX*=b;e.offsetY*=b;break;case "CIMHatchFill":d(e.lineSymbol,b,!0),e.offsetX*=b,e.offsetY*=b,e.separation*=b}}}function k(a,b){a.markerPlacement&&r(a.markerPlacement,b);a.offsetX*=b;a.offsetY*=b;a.anchorPoint&&"Absolute"===a.anchorPointUnits&&(a.anchorPoint=
{x:a.anchorPoint.x*b,y:a.anchorPoint.y*b});a.size*=b;if("CIMVectorMarker"===a.type&&a.markerGraphics)for(var g=0,e=a.markerGraphics;g<e.length;g++){var f=e[g];a.scaleSymbolsProportionally||d(f.symbol,b,!0)}}function r(a,b){f.isCIMMarkerStrokePlacement(a)&&(a.offset*=b);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset*=b;a.offsetAlongLine*=b;if(a.placementTemplate&&a.placementTemplate.length){var g=a.placementTemplate.map(function(a){return a*
b});a.placementTemplate=g}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset*=b;a.placementTemplate&&a.placementTemplate.length&&(g=a.placementTemplate.map(function(a){return a*b}),a.placementTemplate=g);break;case "CIMMarkerPlacementOnLine":a.startPointOffset*=b;break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine*=b;break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition*=b;a.endPosition*=b;break;case "CIMMarkerPlacementPolygonCenter":a.offsetX*=b;a.offsetY*=
b;break;case "CIMMarkerPlacementInsidePolygon":a.offsetX*=b,a.offsetY*=b,a.stepX*=b,a.stepY*=b}}function n(a,b){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width*=b;break;case "CIMGeometricEffectBuffer":a.size*=b;break;case "CIMGeometricEffectCut":a.beginCut*=b;a.endCut*=b;a.middleCut*=b;break;case "CIMGeometricEffectDashes":a.customEndingOffset*=b;a.offsetAlongLine*=b;if(a.dashTemplate&&a.dashTemplate.length){var g=a.dashTemplate.map(function(a){return a*b});a.dashTemplate=
g}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length*=b;break;case "CIMGeometricEffectMove":a.offsetX*=b;a.offsetY*=b;break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset*=b;break;case "CIMGeometricEffectRegularPolygon":a.radius*=b;break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth*=b;a.length*=b;a.toWidth*=b;break;case "CIMGeometricEffectWave":a.amplitude*=b,a.period*=b}}function t(a,b){var g;g="CIMTextSymbol"===
a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(g.symbolLayers){var e=0;for(g=g.symbolLayers;e<g.length;e++){var d=g[e];if(!(d.colorLocked||a&&(f.isCIMStroke(d)||f.isCIMMarker(d)&&d.markerPlacement&&f.isCIMMarkerStrokePlacement(d.markerPlacement))))switch(d.type){case "CIMVectorMarker":d.markerGraphics.forEach(function(a){t(a.symbol,b)});break;case "CIMSolidStroke":case "CIMSolidFill":p(b,d.color);break;case "CIMHatchFill":t(d.lineSymbol,b)}}}}function p(a,b){for(var g=0;g<a.length;g++)if(a[g].join(".")===
b.join("."))return;a.push(b)}function b(a,d){var g;g="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type?!0:!1;if(g.symbolLayers){var e=0;for(g=g.symbolLayers;e<g.length;e++){var c=g[e];if(!(c.colorLocked||a&&(f.isCIMStroke(c)||f.isCIMMarker(c)&&c.markerPlacement&&f.isCIMMarkerStrokePlacement(c.markerPlacement)))){var p=d.toArray(0);switch(c.type){case "CIMVectorMarker":c.markerGraphics.forEach(function(a){b(a.symbol,d)});break;case "CIMSolidStroke":case "CIMSolidFill":c.color=p;break;
case "CIMHatchFill":b(c.lineSymbol,d)}}}}}Object.defineProperty(c,"__esModule",{value:!0});c.applyCIMSymbolRotation=c.getCIMSymbolRotation=c.applyCIMSymbolColor=c.getCIMSymbolColor=c.scaleCIMMarker=c.scaleCIMSymbolTo=c.getCIMSymbolSize=void 0;c.getCIMSymbolSize=m;c.scaleCIMSymbolTo=function(a,b){var g=f.toCIMSymbolJSON(a);a=m(a);if(0===a)if("CIMTextSymbol"===g.type)g.height=b;else{if(g.symbolLayers)for(a=0,g=g.symbolLayers;a<g.length;a++){var e=g[a];switch(e.type){case "CIMPictureMarker":case "CIMVectorMarker":e.size=
b;break;case "CIMPictureStroke":case "CIMSolidStroke":e.width=b}}}else d(g,b/a,!1)};c.scaleCIMMarker=k;c.getCIMSymbolColor=function(a){a=f.toCIMSymbolJSON(a);var b=[];t(a,b);return b.length?new h(f.fromCIMColor(b[0])):null};c.applyCIMSymbolColor=function(a,d){d instanceof h||(d=new h(d));a=f.toCIMSymbolJSON(a);b(a,d)};c.getCIMSymbolRotation=function(a){a=f.toCIMSymbolJSON(a);return"CIMTextSymbol"===a.type||"CIMPointSymbol"===a.type?a.angle||0:0};c.applyCIMSymbolRotation=function(a,b){a=f.toCIMSymbolJSON(a);
if("CIMTextSymbol"===a.type)a.angle=b;else if("CIMPointSymbol"===a.type&&a.symbolLayers)for(var d=b-(a.angle||0),e=0,c=a.symbolLayers;e<c.length;e++){var p=c[e];if(f.isCIMMarker(p)){var h=p.rotation||0,h=p.rotateClockwise?h-d:h+d;p.rotation=h}a.angle=b}}})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(x,c){function h(f,c){"string"!==typeof f&&(f=String(f));switch(c){case "LowerCase":return f.toLowerCase();case "Allcaps":return f.toUpperCase();default:return f}}Object.defineProperty(c,
"__esModule",{value:!0});c.isCIMMarkerStrokePlacement=c.isCIMFill=c.isCIMStroke=c.isCIMMarker=c.toCIMSymbolJSON=c.fromCIMColor=c.resampleHermite=c._adjustTextCase=c.createLabelOverrideFunction=c.colorToArray=c.evaluateValueOrFunction=void 0;c.evaluateValueOrFunction=function(f,c,d,h){return"function"===typeof f?f(c,d,h):f};c.colorToArray=function(f){return[f.r,f.g,f.b,f.a]};c.createLabelOverrideFunction=function(f,c,d){var k=function(d){for(var b=d.length;b--;)if(-1===" /-,\n".indexOf(d.charAt(b)))return!1;
return!0},m=[],n=0,t=-1;do t=c.indexOf("[",n),t>=n&&(t>n&&(n=c.substr(n,t-n),m.push([n,null,k(n)])),n=t+1,t=c.indexOf("]",n),t>=n&&(t>n&&(n=c.substr(n,t-n),(n=f[n])&&m.push([null,n,!1])),n=t+1));while(-1!==t);n<c.length-1&&(n=c.substr(n),m.push([n,null,k(n)]));return function(c){for(var b="",a=null,f=0;f<m.length;f++){var g=m[f],e=g[0],p=g[1],g=g[2];if(e)g?a=e:(a&&(b+=a,a=null),b+=e);else if(e=c.attributes[p])a&&(b+=a,a=null),b+=e}return h(b,d)}};c._adjustTextCase=h;c.resampleHermite=function(c,h,
d,k,r,n,t){void 0===t&&(t=!0);var f=h/r;d/=n;for(var b=Math.ceil(f/2),a=Math.ceil(d/2),l=0;l<n;l++)for(var g=0;g<r;g++){for(var e=4*(g+(t?n-l-1:l)*r),q=0,u=0,m=0,F=0,G=0,z=0,B=0,y=(l+.5)*d,C=Math.floor(l*d);C<(l+1)*d;C++)for(var H=Math.abs(y-(C+.5))/a,E=(g+.5)*f,H=H*H,A=Math.floor(g*f);A<(g+1)*f;A++){var v=Math.abs(E-(A+.5))/b,q=Math.sqrt(H+v*v);-1<=q&&1>=q&&(q=2*q*q*q-3*q*q+1,0<q&&(v=4*(A+C*h),B+=q*c[v+3],m+=q,255>c[v+3]&&(q=q*c[v+3]/250),F+=q*c[v],G+=q*c[v+1],z+=q*c[v+2],u+=q))}k[e]=F/u;k[e+1]=
G/u;k[e+2]=z/u;k[e+3]=B/m}};c.fromCIMColor=function(c){return c?{r:c[0],g:c[1],b:c[2],a:c[3]/255}:{r:0,g:0,b:0,a:0}};c.toCIMSymbolJSON=function(c){var f;return null===(f=c.data)||void 0===f?void 0:f.symbol};c.isCIMMarker=function(c){return"CIMVectorMarker"===c.type||"CIMPictureMarker"===c.type||"CIMBarChartMarker"===c.type||"CIMCharacterMarker"===c.type||"CIMPieChartMarker"===c.type||"CIMStackedBarChartMarker"===c.type};c.isCIMStroke=function(c){return"CIMGradientStroke"===c.type||"CIMPictureStroke"===
c.type||"CIMSolidStroke"===c.type};c.isCIMFill=function(c){return"CIMGradientFill"===c.type||"CIMHatchFill"===c.type||"CIMPictureFill"===c.type||"CIMSolidFill"===c.type||"CIMWaterFill"===c.type};c.isCIMMarkerStrokePlacement=function(c){return"CIMMarkerPlacementAlongLineRandomSize"===c.type||"CIMMarkerPlacementAlongLineSameSize"===c.type||"CIMMarkerPlacementAlongLineVariableSize"===c.type||"CIMMarkerPlacementAtExtremities"===c.type||"CIMMarkerPlacementAtMeasuredUnits"===c.type||"CIMMarkerPlacementAtRatioPositions"===
c.type||"CIMMarkerPlacementOnLine"===c.type||"CIMMarkerPlacementOnVertices"===c.type}})},"esri/symbols/support/symbolUtils":function(){define("require exports tslib ../../core/compilerUtils ../../core/maybe ../../support/arcadeOnDemand ./utils @dojo/framework/shim/Promise".split(" "),function(x,c,h,f,m,d,k){function r(d,b){return h.__awaiter(this,void 0,void 0,function(){var a,c,g,e,p;return h.__generator(this,function(h){switch(h.label){case 0:a=d.type;switch(a){case "web-style":return[3,1];case "label-3d":return[3,
3];case "line-3d":return[3,3];case "mesh-3d":return[3,3];case "point-3d":return[3,3];case "polygon-3d":return[3,3];case "simple-marker":return[3,5];case "simple-line":return[3,5];case "simple-fill":return[3,5];case "picture-marker":return[3,5];case "picture-fill":return[3,5];case "text":return[3,5];case "cim":return[3,7]}return[3,9];case 1:return[4,new Promise(function(a,b){x(["./previewWebStyleSymbol"],a,b)})];case 2:return c=h.sent().previewWebStyleSymbol,[2,c(d,r,b)];case 3:return[4,new Promise(function(a,
b){x(["./previewSymbol3D"],a,b)})];case 4:return g=h.sent().previewSymbol3D,[2,g(d,b)];case 5:return[4,new Promise(function(a,b){x(["./previewSymbol2D"],a,b)})];case 6:return e=h.sent().previewSymbol2D,[2,e(d,b)];case 7:return[4,new Promise(function(a,b){x(["./previewCIMSymbol"],a,b)})];case 8:return p=h.sent().previewCIMSymbol,[2,p(d,b)];case 9:return f.neverReached(d),[2,void 0]}})})}function n(d){return d&&"opacity"in d?d.opacity*n(d.parent):1}Object.defineProperty(c,"__esModule",{value:!0});c.getDisplayedSymbol=
c.renderPreviewHTML=c.renderColorRampPreviewHTML=c.renderDotDensityPreviewHTML=void 0;var t=null;c.renderDotDensityPreviewHTML=function(d,b,a){var c=d.backgroundColor,g=d.outline;d=d.dotSize;var e=a&&a.swatchSize||22,f=Math.round(e*e/Math.pow(d,2)*.8),p=window.devicePixelRatio;a=document.createElement("canvas");var h=e*p;a.width=h;a.height=h;a.style.width=a.width/p+"px";a.style.height=a.height/p+"px";var k=a.getContext("2d");c&&(k.fillStyle=c.toCss(!0),k.fillRect(0,0,h,h),k.fill());k.fillStyle=b.toCss(!0);
if(t&&t.length/2===f)for(b=0;b<2*f;b+=2){var c=t[b],m=t[b+1];k.fillRect(c,m,d*p,d*p);k.fill()}else for(t=[],b=0;b<2*f;b+=2)c=Math.floor(Math.random()*(h-0+1)+0),m=Math.floor(Math.random()*(h-0+1)+0),t.push(c,m),k.fillRect(c,m,d*p,d*p),k.fill();g&&(g.color&&(k.strokeStyle=g.color.toCss(!0)),k.lineWidth=g.width,k.strokeRect(0,0,h,h));g=new Image(e,e);g.src=a.toDataURL();return g};c.renderColorRampPreviewHTML=function(d,b){void 0===b&&(b={});var a="horizontal"===b.align,c=b.width,c=void 0===c?a?75:24:
c,g=b.height,g=void 0===g?a?24:75:g;b=b.gradient;var e=void 0===b?!0:b;b=window.devicePixelRatio;var f=c*b,h=g*b;b=document.createElement("canvas");b.width=f;b.height=h;b.style.width=c+"px";b.style.height=g+"px";var p=b.getContext("2d"),k=a?f:0,m=a?0:h;if(e){var r=p.createLinearGradient(0,0,k,m),n=1/(d.length-1);d.forEach(function(a,b){return r.addColorStop(b*n,a.toString())});p.fillStyle=r;p.fillRect(0,0,f,h)}else for(e=a?f/d.length:f,f=a?h:h/d.length,m=k=h=0;m<d.length;m++)p.fillStyle=d[m].toString(),
p.fillRect(h,k,e,f),h=a?h+e:0,k=a?0:k+f;d=document.createElement("div");d.style.width=c+"px";d.style.height=g+"px";d.appendChild(b);return d};c.renderPreviewHTML=r;c.getDisplayedSymbol=function(c,b){return h.__awaiter(this,void 0,void 0,function(){var a,f,g,e,p,u,w,r,t,z,B,y,C,H,E,A,v,S,D,P,J,Q,R;return h.__generator(this,function(l){switch(l.label){case 0:if(!c)return[2,void 0];a=n(c.layer||c.sourceLayer);return!m.isSome(c.symbol)||m.isSome(b)&&!0===b.ignoreGraphicSymbol?[3,4]:"web-style"!==c.symbol.type?
[3,2]:[4,c.symbol.fetchSymbol(m.isSome(b)?b.abortOptions:null)];case 1:return g=l.sent(),[3,3];case 2:g=c.symbol.clone(),l.label=3;case 3:return f=g,k.applyColorToSymbol(f,null,a),[2,f];case 4:return e=m.isSome(b)&&b.renderer||c.get("layer.renderer")||c.get("sourceLayer.renderer"),[4,e.getSymbolAsync(c)];case 5:return(p=l.sent())?"web-style"!==p.type?[3,7]:[4,p.fetchSymbol(m.isSome(b)?b.abortOptions:null)]:[2,void 0];case 6:return p=l.sent(),[3,8];case 7:p=p.clone(),l.label=8;case 8:if(!("visualVariables"in
e)||"visualVariables"in e&&!e.visualVariables||"visualVariables"in e&&e.visualVariables&&!e.visualVariables.length)return[2,p];if(!e.arcadeRequiredForVisualVariables||!m.isNone(b)&&!m.isNone(b.arcade))return[3,10];w=u=h.__assign({},m.unwrap(b));return[4,d.loadArcade()];case 9:w.arcade=l.sent(),b=u,l.label=10;case 10:return[4,new Promise(function(a,b){x(["../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 11:r=l.sent();t=[];z=[];B=[];y=[];C=0;for(H=e.visualVariables;C<H.length;C++)switch(E=
H[C],E.type){case "color":t.push(E);break;case "opacity":z.push(E);break;case "rotation":y.push(E);break;case "size":E.target||B.push(E)}v=(A=!!t.length&&t[t.length-1])?r.getColor(A,c,b):null;D=(S=!!z.length&&z[z.length-1])?r.getOpacity(S,c,b):null;null!=a&&(D=null!=D?D*a:a);k.applyColorToSymbol(p,v,D);if(!B.length)return[3,13];P=r.getAllSizes(B,c,b);return[4,k.applySizesToSymbol(p,P)];case 12:l.sent(),l.label=13;case 13:J=0;for(Q=y;J<Q.length;J++)R=Q[J],k.applyRotationToSymbol(p,r.getRotationAngle(R,
c,b),R.axis);return[2,p]}})})}})},"esri/symbols/support/utils":function(){define("require exports tslib ../../Color ../../symbols ../../core/asyncUtils ../../core/compilerUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../core/libs/gl-matrix-2/vec3f64 ./gfxUtils ./Symbol3DMaterial @dojo/framework/shim/Promise".split(" "),function(x,c,h,f,m,d,k,r,n,t,p,b,a){function l(a,b){if(null==b)return a;a=a.toRgba();a[3]*=b;return new f(a)}function g(b,e,d){if(b=b.symbolLayers){var c=function(a){a=
n.isSome(a)?a:null;e=e||a||null!=d&&y;return l(e,d)};b.forEach(function(b){if("object"!==b.type||null==b.resource.href||e)if("water"===b.type)b.color=c(b.color);else{var g=n.isSome(b.material)?b.material.color:null,g=c(g);n.isNone(b.material)?b.material=new a.default({color:g}):b.material.color=g;null!=d&&"outline"in b&&n.isSome(b.outline)&&n.isSome(b.outline.color)&&(b.outline.color=l(b.outline.color,d))}})}}function e(a,b){return h.__awaiter(this,void 0,void 0,function(){var e,g=this;return h.__generator(this,
function(c){switch(c.label){case 0:return(e=a.symbolLayers)?[4,d.forEach(e,function(a){return h.__awaiter(g,void 0,void 0,function(){return h.__generator(this,function(e){return[2,q(a,b)]})})})]:[2];case 1:return c.sent(),[2]}})})}function q(a,b){return h.__awaiter(this,void 0,void 0,function(){var e;return h.__generator(this,function(d){switch(d.label){case 0:e=a.type;switch(e){case "extrude":return[3,1];case "icon":return[3,2];case "line":return[3,2];case "text":return[3,2];case "path":return[3,
3];case "object":return[3,4];case "fill":return[3,6];case "water":return[3,6]}return[3,7];case 1:return a.size="number"===typeof b[2]?b[2]:0,[3,8];case 2:return d=u(b),n.isSome(d)&&(a.size=d),[3,8];case 3:return d=F(b,p.vec3f64.ONES,[a.width,void 0,a.height]),a.width=z(b[0],a.width,1,d),a.height=z(b[2],a.height,1,d),[3,8];case 4:return[4,w(a,b)];case 5:return d.sent(),[3,8];case 6:return[3,8];case 7:k.neverReached(a),d.label=8;case 8:return[2]}})})}function u(a){for(var b=0;b<a.length;b++){var e=
a[b];if("number"===typeof e)return e}return null}function w(a,b){return h.__awaiter(this,void 0,void 0,function(){var e,d,g,c;return h.__generator(this,function(f){switch(f.label){case 0:return[4,G(a)];case 1:return e=f.sent(),d=e.resourceSize,g=e.symbolSize,c=F(b,d,g),a.width=z(b[0],g[0],d[0],c),a.depth=z(b[1],g[1],d[1],c),a.height=z(b[2],g[2],d[2],c),[2]}})})}function F(a,b,e){for(var d=0;3>d;d++){var g=a[d];switch(g){case "symbol-value":return null!=e[d]?e[d]/b[d]:1;case "proportional":break;default:if(g&&
b[d])return g/b[d]}}return 1}function G(a){return h.__awaiter(this,void 0,void 0,function(){var b,e,d,g,c,f,p,k;return h.__generator(this,function(h){switch(h.label){case 0:return[4,new Promise(function(a,b){x(["./symbolLayerUtils"],a,b)})];case 1:return b=h.sent(),[4,b.computeObjectLayerResourceSize(a,10)];case 2:e=h.sent();d=a.width;g=a.height;c=a.depth;f=[d,c,g];p=1;for(k=0;3>k;k++)if(null!=f[k]){p=f[k]/e[k];break}for(k=0;3>k;k++)null==f[k]&&(f[k]=e[k]*p);return[2,{resourceSize:e,symbolSize:f}]}})})}
function z(a,b,e,d){switch(a){case "proportional":return e*d;case "symbol-value":return null!=b?b:e;default:return a}}Object.defineProperty(c,"__esModule",{value:!0});c.applyRotationToSymbol=c.applySizesToSymbol=c.applyColorToSymbol=c.applyOpacityToColor=c.getIconHref=c.isVolumetricSymbol=c.getSymbolOutlineSize=void 0;var B=/\/resource\/(.*?)\.svg$/,y=new f("white");c.getSymbolOutlineSize=function(a){if(!a)return 0;if(m.isSymbol3D(a)){var e=a.symbolLayers&&a.symbolLayers.length;e?(a=a.symbolLayers.getItemAt(e-
1),a="outline"in a?n.get(a,"outline","size"):void 0):a=void 0;return n.isSome(a)?a:0}return(a=b.getStroke(a))&&t.px2pt(a.width)||0};c.isVolumetricSymbol=function(a){if(!a||!a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(function(a){return"object"===a.type});case "line-3d":return a.symbolLayers.some(function(a){return"path"===a.type});case "polygon-3d":return a.symbolLayers.some(function(a){return"object"===a.type||"extrude"===a.type});default:return!1}};c.getIconHref=
function(a,b){b=b.resource.href;return!r("esri-canvas-svg-support")&&a.styleOrigin&&B.test(b)?b.replace(B,"/resource/png/$1.png"):b};c.applyOpacityToColor=l;c.applyColorToSymbol=function(a,b,e){if(a&&(b||null!=e))if(b&&(b=new f(b)),m.isSymbol3D(a))g(a,b,e);else if(m.isSymbol2D(a)){if(b=b||a.color)a.color=l(b,e);null!=e&&"outline"in a&&a.outline&&a.outline.color&&(a.outline.color=l(a.outline.color,e))}};c.applySizesToSymbol=function(a,b){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,
function(d){if(!a||!b)return[2];if(m.isSymbol3D(a))return[2,e(a,b)];if(m.isSymbol2D(a)&&(d=u(b),!n.isNone(d)))switch(a.type){case "simple-marker":a.size=d;break;case "picture-marker":var g=a.width/a.height;1<g?(a.width=d,a.height=d*g):(a.width=d*g,a.height=d);break;case "simple-line":a.width=d;break;case "text":a.font.size=d;break;case "simple-fill":case "picture-fill":break;case "cim":break;default:k.neverReached(a)}return[2]})})};c.applyRotationToSymbol=function(a,b,e){a&&null!=b&&(m.isSymbol3D(a)?
(a=a.symbolLayers)&&a.forEach(function(a){if(a&&"object"===a.type)switch(e){case "tilt":a.tilt=b;break;case "roll":a.roll=b;break;default:a.heading=b}}):!m.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle=b))}})},"esri/symbols/support/gfxUtils":function(){define("require exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/promiseUtils ../../core/screenUtils ./cimSymbolUtils".split(" "),function(x,c,h,f,m,d,k,r,n){function t(a){if(!a)return null;
var b;switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":b=t(a.outline);break;case "simple-line":var e=r.pt2px(a.width);"none"!==a.style&&0!==e&&(b={color:a.color,style:g(a.style),width:e,cap:a.cap,join:"miter"===a.join?r.pt2px(a.miterLimit):a.join});break;default:b=null}return b}Object.defineProperty(c,"__esModule",{value:!0});c.defaultThematicColor=c.getStroke=c.getPatternUrlWithColor=c.getFill=c.getSVGBaselineShift=c.getSVGBaseline=c.getSVGAlign=void 0;var p=h.getAssetUrl("esri/symbols/patterns/"),
b={left:"start",center:"middle",right:"end",justify:"start"},a={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},l=new d(1E3);c.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&b[a.toLowerCase()]||"middle"};c.getSVGBaseline=function(b){return(b=b.verticalAlignment)&&a[b.toLowerCase()]||"alphabetic"};c.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};c.getFill=function(a){var b=a.style,e=null;if(a)switch(a.type){case "simple-marker":"cross"!==
b&&"x"!==b&&(e=a.color);break;case "simple-fill":"solid"===b?e=a.color:"none"!==b&&(e={type:"pattern",x:0,y:0,src:p+b+".png",width:5,height:5});break;case "picture-fill":e={type:"pattern",src:a.url,width:r.pt2px(a.width)*a.xscale,height:r.pt2px(a.height)*a.yscale,x:r.pt2px(a.xoffset),y:r.pt2px(a.yoffset)};break;case "text":e=a.color;break;case "cim":e=n.getCIMSymbolColor(a)}return e};c.getPatternUrlWithColor=function(a,b){var e=a+"-"+b;return void 0!==l.get(e)?k.resolve(l.get(e)):m(a,{responseType:"image"}).then(function(a){a=
a.data;var d=a.naturalWidth,g=a.naturalHeight,c=document.createElement("canvas");c.width=d;c.height=g;var f=c.getContext("2d");f.fillStyle=b;f.fillRect(0,0,d,g);f.globalCompositeOperation="destination-in";f.drawImage(a,0,0);a=c.toDataURL();l.put(e,a);return a})};c.getStroke=t;var g=function(){var a={};return function(b){if(a[b])return a[b];var e=b.replace(/-/g,"");return a[b]=e}}();c.defaultThematicColor=new f([128,128,128])})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],
function(x,c,h){return function(){function c(c,d){this._storage=new h.MemCacheStorage;this._storage.maxSize=c;d&&this._storage.registerRemoveFunc("",d)}c.prototype.put=function(c,d){this._storage.put(c,d,1,1)};c.prototype.pop=function(c){return this._storage.pop(c)};c.prototype.get=function(c){return this._storage.get(c)};c.prototype.clear=function(){this._storage.clearAll()};c.prototype.destroy=function(){this._storage.clearAll()};return c}()})},"esri/widgets/Legend/support/clusterUtils":function(){define(["require",
"exports","../../../core/arrayUtils","../../../renderers/visualVariables/SizeVariable"],function(x,c,h,f){Object.defineProperty(c,"__esModule",{value:!0});c.getClusterSizeVariable=void 0;var m=function(d,c){d=d.featuresTilingScheme.getClosestInfoForScale(d.scale).level;return c.levels?c.levels[d]:null};c.getClusterSizeVariable=function(d,c){if(!(d&&"visualVariables"in d&&d.visualVariables))return null;d=h.find(d.visualVariables,function(d){return"size"===d.type});return(c=m(c,d))?new f({field:d.field,
minSize:c[2].size,minDataValue:c[2].value,maxSize:c[3].size,maxDataValue:c[3].value}):null}})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports tslib ../../../Color ../../../core/promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(x,c,h,f,m,d){function k(b,a){var c=[],g=b.length-1;5===b.length?c.push(0,2,4):c.push(0,g);return b.map(function(b,f){return-1<c.indexOf(f)?d.createStopLabel(b,f,g,a):null})}function r(b,a,d){void 0===d&&(d=p);return h.__awaiter(this,
void 0,void 0,function(){var c,e;return h.__generator(this,function(g){switch(g.label){case 0:return c=new f(d),[4,new Promise(function(a,b){x(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return e=g.sent().getOpacity(a,b),null!=e&&(c.a=e),[2,c]}})})}function n(b,a){b=t(b,a);var d=b.startIndex,c=b.endIndex;if(d===c)return a[d].color;a=f.blendColors(a[d].color,a[c].color,b.weight);return new f(a)}function t(b,a){var d=0,c=a.length-1;a.some(function(a,g){if(b<a.value)return c=
g,!0;d=g;return!1});return{startIndex:d,endIndex:c,weight:(b-a[d].value)/(a[c].value-a[d].value)}}Object.defineProperty(c,"__esModule",{value:!0});c.getStrectchRampStops=c.getColorFromPointCloudStops=c.getRampStopsForPointCloud=c.getRampStops=void 0;var p=new f([64,64,64]);c.getRampStops=function(b,a,d){return h.__awaiter(this,void 0,void 0,function(){var c,e,f,p,l,n,t,z,B=this;return h.__generator(this,function(g){switch(g.label){case 0:c=!1;e=[];f=[];b.stops&&(p=b.stops,e=p.map(function(a){return a.value}),
(c=p.some(function(a){return!!a.label}))&&(f=p.map(function(a){return a.label})));l=e[0];n=e[e.length-1];if(null==l&&null==n)return[2,null];t=c?null:k(e,d);return[4,m.all(e.map(function(e,d){return h.__awaiter(B,void 0,void 0,function(){var g,p,k;return h.__generator(this,function(h){switch(h.label){case 0:return"opacity"!==b.type?[3,2]:[4,r(e,b,a)];case 1:return p=h.sent(),[3,4];case 2:return[4,new Promise(function(a,b){x(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];
case 3:p=h.sent().getColor(b,e),h.label=4;case 4:return g=p,k=c?f[d]:t[d],[2,{value:e,color:g,label:k}]}})})}))];case 1:return z=g.sent(),[2,z.reverse()]}})})};c.getRampStopsForPointCloud=function(b){var a=!1,d=[],c=[],d=b.map(function(a){return a.value});(a=b.some(function(a){return!!a.label}))&&(c=b.map(function(a){return a.label}));var e=d[d.length-1];if(null==d[0]&&null==e)return null;var f=a?null:k(d,!1);return d.map(function(e,d){var g=n(e,b);return{value:e,color:g,label:a?c[d]:f[d]}}).reverse()};
c.getColorFromPointCloudStops=n;c.getStrectchRampStops=function(b,a){var d=[];if(b&&"multipart"===b.type)b.colorRamps.reverse().forEach(function(e,c){0===c?d.push({value:a.max,color:new f(e.toColor),label:"high"}):d.push({value:null,color:new f(e.toColor),label:""});c===b.colorRamps.length-1?d.push({value:a.min,color:new f(e.fromColor),label:"low"}):d.push({value:null,color:new f(e.fromColor),label:""})});else{var c=void 0,e=void 0;b&&"algorithmic"===b.type?(c=b.fromColor,e=b.toColor):(c=[0,0,0,1],
e=[255,255,255,1]);d=[{value:a.max,color:new f(e),label:"high"},{value:a.min,color:new f(c),label:"low"}]}return d}})},"esri/widgets/Legend/support/utils":function(){define(["require","exports","../../../intl/date","../../../renderers/support/numberUtils"],function(x,c,h,f){Object.defineProperty(c,"__esModule",{value:!0});c.RGB_IMG_SOURCE=c.createStopLabel=void 0;var m=h.convertDateFormatToIntlOptions("short-date");c.createStopLabel=function(d,c,r,n){var k="";0===c?k="\x3c ":c===r&&(k="\x3e ");c=
null;c=n?h.formatDate(d,m):f.format(d);return k+c};c.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"]})},
"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["require","exports","../../../renderers/support/HeatmapColorStop"],function(x,c,h){Object.defineProperty(c,"__esModule",{value:!0});c.getHeatmapRampStops=void 0;c.getHeatmapRampStops=function(c){c=c.colorStops;var f=c.length-1;if(c&&c[0]){var d=c[f];d&&1!==d.ratio&&(c=c.slice(0),c.push(new h({ratio:1,color:d.color})),f++)}return c.map(function(d,c){var h="";0===c?h="low":c===f&&(h="high");return{color:d.color,label:h,ratio:d.ratio}}).reverse()}})},
"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["require","exports","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(x,c,h,f){function m(d){if(d){var c=d.type;return-1<c.indexOf("3d")?f.getSymbolLayerFill(d.symbolLayers.getItemAt(0)):"simple-line"===c||"simple-marker"===d.type&&("x"===d.style||"cross"===d.style)?(d=h.getStroke(d))&&d.color:h.getFill(d)}}function d(d,c){var b=c.HH.label,a=c.LL.label,f=c.HL.label;c=c.LH.label;switch(d){case "HH":return{top:b,
bottom:a,left:f,right:c};case "HL":return{top:f,bottom:c,left:a,right:b};case "LL":return{top:a,bottom:b,left:c,right:f};case "LH":return{top:c,bottom:f,left:b,right:a};default:return{top:b,bottom:a,left:f,right:c}}}function k(d){var c=r[d];d&&null==c&&(c=r.HH);return c||0}Object.defineProperty(c,"__esModule",{value:!0});c.getRotationAngleForFocus=c.getRelationshipRampElement=void 0;var r={HH:315,HL:45,LL:135,LH:225},n={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],
4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};c.getRelationshipRampElement=function(c){var f=c.focus,b=c.numClasses,a=n[b],h={};c.infos.forEach(function(a){h[a.value]={label:a.label,fill:m(a.symbol)}});c=[];for(var g=0;g<b;g++){for(var e=[],q=0;q<b;q++)e.push(h[a[g][q]].fill);c.push(e)}a=d(f,h);return{type:"relationship-ramp",numClasses:b,focus:f,colors:c,labels:a,rotation:k(f)}};c.getRotationAngleForFocus=k})},"esri/symbols/support/previewSymbol3D":function(){define("require exports tslib ../../assets ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),
function(x,c,h,f,m,d,k,r,n,t,p,b,a,l,g,e,q,u){function w(a){var b=a.outline,e=n.isSome(a.material)?a.material.color:null,e=n.isSome(e)?e.toRgba().toString():null;if(n.isNone(b))return"fill"===a.type&&"255,255,255,1"===e?{color:"#bdc3c7",width:.75}:null;a=p.pt2px(b.size)||0;return{color:"rgba("+(n.isSome(b.color)?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function F(a,b){var e=b&&b.resource,e=e&&e.href;return a.thumbnail&&a.thumbnail.url?t.resolve(a.thumbnail.url):e&&"object"!==b.type?
t.resolve(u.getIconHref(a,b)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?q.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(a){return a}).then(function(a){return a&&a.thumbnail&&a.thumbnail.url||W}):t.resolve(W)}function G(a,b){void 0===b&&(b=1);var e=a.a;a=m.toHSV(a);b=m.toRGB({h:a.h,s:a.s/b,v:100-(100-a.v)/b});return[b.r,b.g,b.b,e]}function z(a,b){return Math.round(Math.min(Math.max(a+191.25*b,0),255))}function B(a){return"water"===
a.type?n.isNone(a.color)?null:a.color:n.isNone(a.material)||n.isNone(a.material.color)?null:a.material.color}function y(a,e){void 0===e&&(e=0);a=B(a);if(!a)return e=z(b.defaultThematicColor.r,e),[e,e,e,100];a=a.toRgba();for(var d=0;3>d;d++)a[d]=z(a[d],e);return a}function C(a,e){return h.__awaiter(this,void 0,void 0,function(){var d,c;return h.__generator(this,function(g){switch(g.label){case 0:return d=a.style,"none"===d?[2,null]:[4,b.getPatternUrlWithColor(""+R+d+".png",e.toCss(!0))];case 1:return c=
g.sent(),[2,{type:"pattern",x:0,y:0,src:c,width:5,height:5}]}})})}function H(a){return a.outline?w(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function E(a,b){a=B(a);if(!a)return null;var e;e="rgba("+(z(a.r,b)+",");e+=z(a.g,b)+",";e+=z(a.b,b)+",";return e+a.a+");"}function A(a,b){b=E(a,b);if(!b)return{};a=Math.min(a.size?p.pt2px(a.size):.75,80);return{color:b,width:a}}function v(a,b,e){e*=.75;return{type:"linear",x1:e?.25*e:0,y1:e?.5*e:0,x2:e||4,y2:e?.5*e:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}
function S(a){var b=a.depth,e=a.height;return(a=a.width)&&b&&e&&a===b&&a<e}function D(b,e,c){var f=[];if(!b)return f;switch(b.type){case "icon":var h=b.resource&&b.resource.primitive||a.defaultPrimitive;switch(h){case "circle":f.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:y(b,0),stroke:w(b)});break;case "square":f.push({shape:{type:"path",path:[{command:"M",values:[0,e]},{command:"L",values:[0,0]},{command:"L",values:[e,0]},{command:"L",values:[e,e]},{command:"Z",values:[]}]},fill:y(b,0),stroke:w(b)});
break;case "triangle":f.push({shape:{type:"path",path:[{command:"M",values:[0,e]},{command:"L",values:[.5*e,0]},{command:"L",values:[e,e]},{command:"Z",values:[]}]},fill:y(b,0),stroke:w(b)});break;case "cross":f.push({shape:{type:"path",path:[{command:"M",values:[.5*e,0]},{command:"L",values:[.5*e,e]},{command:"M",values:[0,.5*e]},{command:"L",values:[e,.5*e]}]},stroke:H(b)});break;case "x":f.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[e,e]},{command:"M",values:[e,
0]},{command:"L",values:[0,e]}]},stroke:H(b)});break;case "kite":f.push({shape:{type:"path",path:[{command:"M",values:[0,.5*e]},{command:"L",values:[.5*e,0]},{command:"L",values:[e,.5*e]},{command:"L",values:[.5*e,e]},{command:"Z",values:[]}]},fill:y(b,0),stroke:w(b)});break;default:d.neverReached(h)}break;case "object":switch(h=b.resource&&b.resource.primitive||l.defaultPrimitive,h){case "cone":h=y(b,0);b=y(b,-.6);b=v(h,b,c?20:e);e=g.getConeShapes(e,c);f.push({shape:e[0],fill:b});f.push({shape:e[1],
fill:b});break;case "inverted-cone":c=y(b,0);b=y(b,-.6);b=v(c,b,e);e=g.getInvertedConeShapes(e);f.push({shape:e[0],fill:b});f.push({shape:e[1],fill:c});break;case "cube":e=g.getCubeShapes(e,c);f.push({shape:e[0],fill:y(b,0)});f.push({shape:e[1],fill:y(b,-.3)});f.push({shape:e[2],fill:y(b,-.5)});break;case "cylinder":var h=y(b,0),p=y(b,-.6),h=v(h,p,c?20:e);e=g.getCylinderShapes(e,c);f.push({shape:e[0],fill:h});f.push({shape:e[1],fill:h});f.push({shape:e[2],fill:y(b,0)});break;case "diamond":e=g.getDiamondShapes(e);
f.push({shape:e[0],fill:y(b,-.3)});f.push({shape:e[1],fill:y(b,0)});f.push({shape:e[2],fill:y(b,-.3)});f.push({shape:e[3],fill:y(b,-.7)});break;case "sphere":c=y(b,0);b=y(b,-.6);b=v(c,b);b.x1=0;b.y1=0;b.x2=.25*e;b.y2=.25*e;f.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:b});break;case "tetrahedron":e=g.getTetrahedronShapes(e);f.push({shape:e[0],fill:y(b,-.3)});f.push({shape:e[1],fill:y(b,0)});f.push({shape:e[2],fill:y(b,-.6)});break;default:d.neverReached(h)}}return f}function P(a,b){var d=b&&
b.size?p.pt2px(b.size):null,c=b&&b.maxSize?p.pt2px(b.maxSize):null,g=b&&b.disableUpsampling,f=a.symbolLayers,h=[],k=0,l=0,m=f.getItemAt(f.length-1),q;m&&"icon"===m.type&&(q=m.size&&p.pt2px(m.size));f.forEach(function(f){if("icon"===f.type||"object"===f.type){var m="icon"===f.type?f.size&&p.pt2px(f.size):0,r=d||m?Math.ceil(Math.min(d||m,c||120)):22;if(f&&f.resource&&f.resource.href){var n=F(a,f).then(function(a){var b=f.get("material.color"),d;d="icon"===f.type?"multiply":"tint";return e.tintImageWithColor(a,
r,b,d,g)}).then(function(a){var b=a.width,e=a.height;k=Math.max(k,b);l=Math.max(l,e);return[{shape:{type:"image",x:0,y:0,width:b,height:e,src:a.url},fill:null,stroke:null}]});h.push(n)}else n=r,"icon"===f.type&&q&&d&&(n=m/q*r),m=b&&"tall"===b.symbolConfig||("object"===f.type?S(f):!1),k=Math.max(k,m?20:n),l=Math.max(l,n),h.push(t.resolve(D(f,n,m)))}});return t.eachAlways(h).then(function(a){var d=[];a.forEach(function(a){a.value?d.push(a.value):a.error&&T.warn("error while building swatchInfo!",a.error)});
return e.renderSymbol(d,[k,l],{node:b&&b.node,scale:!1,opacity:b&&b.opacity})})}function J(a,b){var d=a.symbolLayers,c=[];a=u.isVolumetricSymbol(a);var f=b&&b.size?p.pt2px(b.size):null,D=(b&&b.maxSize?p.pt2px(b.maxSize):null)||80,k=0,l=0,m;d.forEach(function(a,b){if(a&&("line"===a.type||"path"===a.type)){var e=[];switch(a.type){case "line":var d=A(a,0),p=d&&d.width||0;0===b&&(m=p);var q=Math.min(f||p,D);b=0===b?q:f?p/m*q:q;l=Math.max(l,b);k=Math.max(k,20<b?2*b:40);d.width=b;e.push({shape:{type:"path",
path:[{command:"M",values:[0,.5*l]},{command:"L",values:[k,.5*l]}]},stroke:d});break;case "path":b=Math.min(f||22,D);p=y(a,0);q=y(a,-.2);d=(d=E(a,-.4))?{color:d,width:1}:{};if("quad"===a.profile){var r=a.width||a.size;a=a.height||a.size;a=g.getPathSymbolShapes(r&&a?r/a:1);d=h.__assign(h.__assign({},d),{join:"bevel"});e.push({shape:a[0],fill:q,stroke:d});e.push({shape:a[1],fill:q,stroke:d});e.push({shape:a[2],fill:p,stroke:d})}else e.push({shape:g.shapes.pathSymbol3DLayer[0],fill:q,stroke:d}),e.push({shape:g.shapes.pathSymbol3DLayer[1],
fill:p,stroke:d});k=l=Math.max(l,b)}c.push(e)}});return t.resolve(e.renderSymbol(c,[k,l],{node:b&&b.node,scale:a,opacity:b&&b.opacity}))}function Q(a,b){return h.__awaiter(this,void 0,void 0,function(){var d,c,f,D,k,l,m,q,r,u,P,J,z,v,Q,H,F,E,R,M,x,T,O,W,S,ha,fa,ja,ka,la,ga;return h.__generator(this,function(K){switch(K.label){case 0:d=a.type,c="mesh-3d"===d,f=a.symbolLayers,D=b&&b.size?p.pt2px(b.size):null,k=b&&b.maxSize?p.pt2px(b.maxSize):null,l=D||22,m=[],r=q=0,u=!1,P=0,K.label=1;case 1:if(!(P<
f.length))return[3,10];J=f.getItemAt(P);z=[];if(c&&"fill"!==J.type)return[3,9];v=g.shapes.fill[0];Q=J.type;switch(Q){case "fill":return[3,2];case "line":return[3,5];case "extrude":return[3,6];case "water":return[3,7]}return[3,8];case 2:return H=w(J),F=Math.min(l,k||120),q=Math.max(q,F),r=Math.max(r,F),u=!0,E=y(J,0),R="pattern"in J&&J.pattern,M=B(J),!c&&n.isSome(R)&&"style"===R.type&&"solid"!==R.style&&M?[4,C(R,M)]:[3,4];case 3:E=K.sent(),K.label=4;case 4:return z.push({shape:v,fill:E,stroke:H}),[3,
8];case 5:return x=A(J,0),T={stroke:x,shape:v},q=Math.max(q,22),r=Math.max(r,22),z.push(T),[3,8];case 6:return O=h.__assign({join:"round"},A(J,-.4)),W=y(J,0),S=y(J,-.2),ha=Math.min(l,k||120),fa=g.getExtrudeSymbolShapes(ha),O.width=1,z.push({shape:fa[0],fill:S,stroke:O}),z.push({shape:fa[1],fill:S,stroke:O}),z.push({shape:fa[2],fill:W,stroke:O}),ja=22*.7+.5*ha,q=Math.max(q,22),r=Math.max(r,ja),[3,8];case 7:return M=B(J),W=G(M),ka=G(M,2),la=G(M,3),ga=g.getWaterSymbolShapes(),u=!0,z.push({shape:ga[0],
fill:W}),z.push({shape:ga[1],fill:ka}),z.push({shape:ga[2],fill:la}),F=Math.min(l,k||120),q=Math.max(q,F),r=Math.max(r,F),[3,8];case 8:m.push(z),K.label=9;case 9:return P++,[3,1];case 10:return[2,t.resolve(e.renderSymbol(m,[q,r],{node:b&&b.node,scale:u,opacity:b&&b.opacity}))]}})})}Object.defineProperty(c,"__esModule",{value:!0});c.previewSymbol3D=c.getPatternDescriptor=c.getSymbolLayerFill=void 0;var R=f.getAssetUrl("esri/symbols/patterns/"),W=f.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png"),
T=r.getLogger("esri.symbols.support.previewSymbol3D");c.getSymbolLayerFill=y;c.getPatternDescriptor=C;c.previewSymbol3D=function(a,b){if(0===a.symbolLayers.length)return t.reject(new k("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var e=null;switch(a.type){case "point-3d":e=P(a,b);break;case "line-3d":e=J(a,b);break;case "polygon-3d":case "mesh-3d":e=Q(a,b)}return e?e:t.reject(new k("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/core/colorUtils":function(){define(["require",
"exports"],function(x,c){function h(d,b){var a=[],c,g;if(d[0].length!==b.length)throw"dimensions do not match";var e=d.length,f=d[0].length,h=0;for(c=0;c<e;c++){for(g=h=0;g<f;g++)h+=d[c][g]*b[g];a.push(h)}return a}function f(d){d=[d.r/255,d.g/255,d.b/255].map(function(b){return.04045>=b?b/12.92:Math.pow((b+.055)/1.055,2.4)});d=h(n,d);return{x:100*d[0],y:100*d[1],z:100*d[2]}}function m(d){d=h(t,[d.x/100,d.y/100,d.z/100]).map(function(b){return Math.min(1,Math.max(.0031308>=b?12.92*b:1.055*Math.pow(b,
1/2.4)-.055,0))});return{r:Math.round(255*d[0]),g:Math.round(255*d[1]),b:Math.round(255*d[2])}}function d(d){d=[d.x/95.047,d.y/100,d.z/108.883].map(function(b){return b>Math.pow(6/29,3)?Math.pow(b,1/3):1/3*Math.pow(29/6,2)*b+4/29});return{l:116*d[1]-16,a:500*(d[0]-d[1]),b:200*(d[1]-d[2])}}function k(d){var b=d.l;d=[(b+16)/116+d.a/500,(b+16)/116,(b+16)/116-d.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*d[0],y:100*d[1],z:108.883*d[2]}}function r(d){if("r"in
d&&"g"in d&&"b"in d)return d;if("l"in d&&"c"in d&&"h"in d){var b=d.c,a=d.h;return m(k({l:d.l,a:b*Math.cos(a),b:b*Math.sin(a)}))}if("l"in d&&"a"in d&&"b"in d)return m(k(d));if("x"in d&&"y"in d&&"z"in d)return m(d);if("h"in d&&"s"in d&&"v"in d){a=(d.h+360)%360/60;b=d.v/100*255;d=d.s/100*b;var c=d*(1-Math.abs(a%2-1));switch(Math.floor(a)){case 0:a={r:d,g:c,b:0};break;case 1:a={r:c,g:d,b:0};break;case 2:a={r:0,g:d,b:c};break;case 3:a={r:0,g:c,b:d};break;case 4:a={r:c,g:0,b:d};break;case 5:case 6:a={r:d,
g:0,b:c};break;default:a={r:0,g:0,b:0}}a.r=Math.round(a.r+b-d);a.g=Math.round(a.g+b-d);a.b=Math.round(a.b+b-d);return a}return d}Object.defineProperty(c,"__esModule",{value:!0});c.darken=c.toXYZ=c.toLCH=c.toLAB=c.toHSV=c.toRGB=void 0;var n=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],t=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];c.toRGB=r;c.toHSV=function(d){if("h"in d&&"s"in d&&"v"in d)return d;var b=r(d);d=b.r;var a=b.g,c=b.b,b=Math.max(d,a,c),g=b-Math.min(d,
a,c);d=0===g?0:b===d?(a-c)/g%6:b===a?(c-d)/g+2:(d-a)/g+4;0>d&&(d+=6);return{h:60*d,s:100*(0===g?0:g/b),v:100/255*b}};c.toLAB=function(c){return"l"in c&&"a"in c&&"b"in c?c:d(f(r(c)))};c.toLCH=function(c){if(!("l"in c&&"c"in c&&"h"in c)){var b=d(f(r(c)));c=b.l;var a=b.a,h=b.b,b=Math.sqrt(a*a+h*h),a=Math.atan2(h,a),a=0<a?a:a+2*Math.PI;c={l:c,c:b,h:a}}return c};c.toXYZ=function(d){return"x"in d&&"y"in d&&"z"in d?d:f(r(d))};c.darken=function(c,b){c=d(f(c));c.l*=1-b;return m(k(c))}})},"esri/symbols/support/previewUtils":function(){define(["require",
"exports"],function(x,c){Object.defineProperty(c,"__esModule",{value:!0});c.getTetrahedronShapes=c.getDiamondShapes=c.getInvertedConeShapes=c.getConeShapes=c.getCylinderShapes=c.getCubeShapes=c.getWaterSymbolShapes=c.getExtrudeSymbolShapes=c.getPathSymbolShapes=c.shapes=void 0;c.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};c.getPathSymbolShapes=function(c){var f=22,h=22;1>c?f*=.75:1<c&&(h*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,h-11]},{command:"L",values:[f-11,h-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[f-11,22]},{command:"L",values:[f-11,h-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[f-11,h-
11]},{command:"L",values:[0,h-11]},{command:"L",values:[0,22]},{command:"L",values:[f-11,22]},{command:"Z",values:[]}]}]};c.getExtrudeSymbolShapes=function(c){c*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+c]},{command:"L",values:[0,22*.7+c-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+c]},{command:"L",values:[22,c]},{command:"L",values:[22,0]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};c.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
c.getCubeShapes=function(c,f){var h=f?20:c,d=f?4:6,d=h=22>=h?h-.5*d:h-d;f=f?.35*h:.5*h;return[{type:"path",path:[{command:"M",values:[.5*d,0]},{command:"L",values:[d,.5*f]},{command:"L",values:[.5*d,f]},{command:"L",values:[0,.5*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*f]},{command:"L",values:[.5*d,f]},{command:"L",values:[.5*d,c]},{command:"L",values:[0,c-.5*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*d,f]},{command:"L",values:[.5*d,
c]},{command:"L",values:[d,c-.5*f]},{command:"L",values:[d,.5*f]},{command:"Z",values:[]}]}]};c.getCylinderShapes=function(c,f){var h=f?20:c;f=f?4:6;h=22>=h?h-.5*f:h-f;f=.5*h;var d=.15*h;c-=d;return[{type:"ellipse",cx:.5*h,cy:c,rx:f,ry:d},{type:"path",path:[{command:"M",values:[0,d]},{command:"L",values:[0,c]},{command:"L",values:[h,c]},{command:"L",values:[h,d]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*h,cy:d,rx:f,ry:d}]};c.getConeShapes=function(c,f){var h=f?20:c;f=f?4:6;h=22>=h?h-.5*f:h-
f;f=.15*h;var d=h;c-=f;return[{type:"ellipse",cx:.5*h,cy:c,rx:.5*h,ry:f},{type:"path",path:[{command:"M",values:[.5*d,0]},{command:"L",values:[d,c]},{command:"L",values:[0,c]},{command:"Z",values:[]}]}]};c.getInvertedConeShapes=function(c){var f=c,f=22>f?f-3:f-6,h=.15*f,d=f;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[d,0]},{command:"L",values:[.5*d,c-h]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*f,cy:0,rx:.5*f,ry:h}]};c.getDiamondShapes=function(c){var f=c,f=22>
f?f-2:f-4,h=Math.floor(c/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[f,.5*c-h]},{command:"L",values:[.45*f-h,.5*c+h]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[.45*f-h,.5*c+h]},{command:"L",values:[0,.5*c-h]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*c-h]},{command:"L",values:[.45*f-h,.5*c+h]},{command:"L",values:[.45*f,c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*f,c]},{command:"L",values:[f,.5*c-h]},{command:"L",values:[.45*f-h,.5*c+h]},{command:"Z",values:[]}]}]};c.getTetrahedronShapes=function(c){var f=c,f=22>f?f-1:f-2;return[{type:"path",path:[{command:"M",values:[.45*c,0]},{command:"L",values:[c,f]},{command:"L",values:[.45*c,.6*f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*c,0]},{command:"L",values:[.45*c,.6*f]},{command:"L",values:[0,f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,f]},
{command:"L",values:[.45*c,.6*f]},{command:"L",values:[c,f]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ../../libs/maquette/index ./svgUtils".split(" "),function(x,c,h,f,m,d,k,r,n,t){function p(a,b,c){return a?f(a,{responseType:"image"}).then(function(a){a=a.data;var e=a.width,d=a.height,g=e/d,f=b;c&&(f=Math.min(f,Math.max(e,d)));return{image:a,
width:1>=g?Math.ceil(f*g):f,height:1>=g?f:Math.ceil(f/g)}}):r.reject(new d("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(c,"__esModule",{value:!0});c.tintImageWithColor=c.renderSymbol=void 0;var b=n.createProjector();c.renderSymbol=function(a,d,c){var e=Math.ceil(d[0]);d=Math.ceil(d[1]);if(!a.some(function(a){return!!a.length}))return null;var g=c&&c.node||document.createElement("div");null!=c.opacity&&(g.style.opacity=c.opacity.toString());b.append(g,t.renderSVG.bind(null,
a,e,d,c));return g};c.tintImageWithColor=function(a,b,d,e,c){return p(a,b,c).then(function(c){var g=c.width?c.width:b,f=c.height?c.height:b,q;if(q=c.image)q=d&&"ignore"!==e?"multiply"===e&&255===d.r&&255===d.g&&255===d.b&&1===d.a?!1:!0:!1;if(q){var l=c.image.width,r=c.image.height;(k("edge")||k("ie"))&&/\.svg$/i.test(a)&&(--l,--r);var p,n;p=Math.ceil(g);n=Math.ceil(f);q=document.createElement("canvas");q.width=p;q.height=n;q.style.width=p+"px";q.style.height=n+"px";q=q.getContext("2d");q.clearRect(0,
0,p,n);q.drawImage(c.image,0,0,l,r,0,0,g,f);c=q.getImageData(0,0,g,f);l=[d.r/255,d.g/255,d.b/255,d.a];r=m.toHSV(d);for(p=0;p<c.data.length;p+=4){n=c.data;var u=p,t=l,A=r;switch(e){case "multiply":n[u+0]*=t[0];n[u+1]*=t[1];n[u+2]*=t[2];n[u+3]*=t[3];break;default:var v=m.toHSV({r:n[u+0],g:n[u+1],b:n[u+2]});v.h=A.h;v.s=A.s;v.v=v.v/100*A.v;A=m.toRGB(v);n[u+0]=A.r;n[u+1]=A.g;n[u+2]=A.b;n[u+3]*=t[3]}}q.putImageData(c,0,0);a=q.canvas.toDataURL("image/png")}else(q=h.id&&h.id.findCredential(a))&&q.token&&
(c=-1===a.indexOf("?")?"?":"\x26",a=""+a+c+"token\x3d"+q.token);return{url:a,width:g,height:f}}).catch(function(){return{url:a,width:b,height:b}})}})},"esri/symbols/support/svgUtils":function(){define("require exports ../../Color ../../core/has ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ../../widgets/support/widget".split(" "),function(x,c,h,f,m,d,k){function r(a){return a.map(function(a){return a.command+" "+a.values.join(" ")}).join(" ").trim()}function n(a,b,e,
d){if(a){if("circle"===a.type)return k.tsx("circle",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return k.tsx("ellipse",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===
a.type)return k.tsx("rect",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return k.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?r(a.path):a.path,k.tsx("path",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,
"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4",d:a});if("text"===a.type)return k.tsx("text",{fill:b,"fill-rule":"evenodd",stroke:e.color,"stroke-width":e.width,"stroke-linecap":e.cap,"stroke-linejoin":e.join,"stroke-dasharray":e.dashArray,"stroke-miterlimit":"4","text-anchor":d.align,"text-decoration":d.decoration,kerning:d.kerning,rotate:d.rotate,"text-rendering":C,"font-style":d.font.style,"font-variant":d.font.variant,"font-weight":d.font.weight,
"font-size":d.font.size,"font-family":d.font.family,x:a.x,y:a.y},a.text)}return null}function t(a){var b={fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&"pattern"===a.type){var e="patternId-"+ ++B;b.fill="url(#"+e+")";b.pattern={id:e,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,href:a.src}}}else"type"in a&&"linear"===a.type?(e="linearGradientId-"+ ++y,b.fill="url(#"+e+")",b.linearGradient={id:e,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(function(a){return{offset:a.offset,
color:a.color&&(new h(a.color)).toString()}})}):a&&(a=new h(a),b.fill=a.toString());return b}function p(a){var b={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(b.width=a.width),a.cap&&(b.cap=a.cap),a.join&&(b.join=a.join.toString()),a.color&&(b.color=(new h(a.color)).toString()),a.style)){var e=null;a.style in S&&(e=S[a.style]);if(Array.isArray(e)){for(var e=e.slice(0),d=0;d<e.length;++d)e[d]*=a.width;if("butt"!==a.cap){for(d=0;d<e.length;d+=2)e[d]-=a.width,1>e[d]&&
(e[d]=1);for(d=1;d<e.length;d+=2)e[d]+=a.width}e=e.join(",")}b.dashArray=e}return b}function b(a,b){var e={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(e.align=a.align,e.decoration=a.decoration,e.kerning=a.kerning?"auto":"0",e.rotate=a.rotated?"90":"0",e.font.style=b.style||"normal",e.font.variant=b.variant||"normal",e.font.weight=b.weight||"normal",e.font.size=b.size&&b.size.toString()||"10pt",e.font.family=b.family||"serif");
return e}function a(a){var b=a.pattern;a=a.linearGradient;return b?k.tsx("pattern",{id:b.id,patternUnits:"userSpaceOnUse",x:b.x,y:b.y,width:b.width,height:b.height},k.tsx("image",{x:b.image.x,y:b.image.y,width:b.image.width,height:b.image.height,href:b.image.href})):a?(b=a.stops.map(function(a,b){return k.tsx("stop",{key:b+"-stop",offset:a.offset,"stop-color":a.color})}),k.tsx("linearGradient",{id:a.id,gradientUnits:"userSpaceOnUse",x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},b)):null}function l(a,b,e){return d.translate(a,
d.identity(a),[b,e])}function g(a,b,e,c,g){d.scale(a,d.identity(a),[b,e]);a[4]=a[4]*b-c*b+c;a[5]=a[5]*e-g*e+g;return a}function e(a,b,e,c){var g=b%360*Math.PI/180;d.rotate(a,d.identity(a),g);b=Math.cos(g);var g=Math.sin(g),f=a[4],h=a[5];a[4]=f*b-h*g+c*g-e*b+e;a[5]=h*b+f*g-e*g-c*b+c;return a}function q(a,b){A&&"left"in A?(A.left>a&&(A.left=a),A.right<a&&(A.right=a),A.top>b&&(A.top=b),A.bottom<b&&(A.bottom=b)):A={left:a,bottom:b,right:a,top:b}}function u(a){var b=a.args,e=b.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=
0;a<e;a+=2)q(b[a],b[a+1]);v.x=b[e-2];v.y=b[e-1];break;case "H":for(a=0;a<e;++a)q(b[a],v.y);v.x=b[e-1];break;case "V":for(a=0;a<e;++a)q(v.x,b[a]);v.y=b[e-1];break;case "m":a=0;"x"in v||(q(v.x=b[0],v.y=b[1]),a=2);for(;a<e;a+=2)q(v.x+=b[a],v.y+=b[a+1]);break;case "l":case "t":for(a=0;a<e;a+=2)q(v.x+=b[a],v.y+=b[a+1]);break;case "h":for(a=0;a<e;++a)q(v.x+=b[a],v.y);break;case "v":for(a=0;a<e;++a)q(v.x,v.y+=b[a]);break;case "c":for(a=0;a<e;a+=6)q(v.x+b[a],v.y+b[a+1]),q(v.x+b[a+2],v.y+b[a+3]),q(v.x+=b[a+
4],v.y+=b[a+5]);break;case "s":case "q":for(a=0;a<e;a+=4)q(v.x+b[a],v.y+b[a+1]),q(v.x+=b[a+2],v.y+=b[a+3]);break;case "A":for(a=0;a<e;a+=7)q(b[a+5],b[a+6]);v.x=b[e-2];v.y=b[e-1];break;case "a":for(a=0;a<e;a+=7)q(v.x+=b[a+5],v.y+=b[a+6])}}function w(a,b,e){var d=H[a.toLowerCase()];"number"===typeof d&&(d?b.length>=d&&(a={action:a,args:b.slice(0,b.length-b.length%d)},e.push(a),u(a)):(a={action:a,args:[]},e.push(a),u(a)))}function F(a){var b={x:0,y:0,width:0,height:0};if("circle"===a.type)b.x=a.cx-a.r,
b.y=a.cy-a.r,b.width=2*a.r,b.height=2*a.r;else if("ellipse"===a.type)b.x=a.cx-a.rx,b.y=a.cy-a.ry,b.width=2*a.rx,b.height=2*a.ry;else if("image"===a.type||"rect"===a.type)b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height;else if("path"===a.type){a=("string"!==typeof a.path?r(a.path):a.path).match(E);var e=[];A={};v={};if(a){for(var d="",c=[],g=a.length,f=0;f<g;++f){var h=a[f],k=parseFloat(h);isNaN(k)?(d&&w(d,c,e),c=[],d=h):c.push(k)}w(d,c,e);a={x:0,y:0,width:0,height:0};A&&"left"in A&&(a.x=A.left,
a.y=A.top,a.width=A.right-A.left,a.height=A.bottom-A.top)}else a=null;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height}return b}function G(a){for(var b={x:0,y:0,width:0,height:0},e=null,d=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY,g=0;g<a.length;g++){var f=a[g];e?(e.x=Math.min(e.x,f.x),e.y=Math.min(e.y,f.y),d=Math.max(d,f.x+f.width),c=Math.max(c,f.y+f.height)):(e=b,e.x=f.x,e.y=f.y,d=f.x+f.width,c=f.y+f.height)}e&&(e.width=d-e.x,e.height=c-e.y);return e}function z(a,b,c,f,h,k){var q=b/2,
p=c/2,r=a.width+f,n=a.height+f,u=m.mat2df32.create(),w=m.mat2df32.create(),B=!1;if(h&&0!==r&&0!==n){h=r/n;var B=b>c?b:c,y=1,t=1;isNaN(B)||(1<h?(y=B/r,t=B/h/n):(t=B/n,y=B*h/r));d.multiply(w,w,g(u,y,t,q,p));B=!0}h=a.x+(r-f)/2;a=a.y+(n-f)/2;d.multiply(w,w,l(u,q-h,p-a));!B&&(r>b||n>c)&&(q=r/b>n/c,b=(q?b:c)/(q?r:n),d.multiply(w,w,g(u,b,b,h,a)));k&&d.multiply(w,w,e(u,k,h,a));return"matrix("+w[0]+","+w[1]+","+w[2]+","+w[3]+","+w[4]+","+w[5]+")"}Object.defineProperty(c,"__esModule",{value:!0});c.renderSVG=
c.getTransformMatrix=c.computeBBox=c.getBoundingBox=c.renderDef=c.generateTextAttributes=c.generateStrokeAttributes=c.generateFillAttributes=c.renderShape=void 0;var B=0,y=0,C=f("chrome")?"auto":"optimizeLegibility",H={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},E=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,A={},v={},S={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],
longdashdotdot:[8,3,1,3,1,3]};c.renderShape=n;c.generateFillAttributes=t;c.generateStrokeAttributes=p;c.generateTextAttributes=b;c.renderDef=a;c.getBoundingBox=F;c.computeBBox=G;c.getTransformMatrix=z;c.renderSVG=function(e,d,c,g){for(var f=[],h=[],q=0;q<e.length;q++){for(var r=[],l=[],m=0,w=0,u=e[q];w<u.length;w++){var B=u[w],y=B.shape,v=B.fill,C=B.stroke,B=B.font,m=m+(C&&C.width||0),v=t(v),C=p(C),B="text"===y.type?b(y,B):null;f.push(a(v));r.push(n(y,v.fill,C,B));l.push(F(y))}l=z(G(l),d,c,m,g&&g.scale,
g&&g.rotation);h.push(k.tsx("g",{transform:l},r))}return k.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:d,height:c},k.tsx("defs",null,f),h)}})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require","exports","./factories/mat2df32"],function(x,c,h){Object.defineProperty(c,"__esModule",{value:!0});c.mat2df32=void 0;c.mat2df32=h})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(x,c){function h(c,h,d,k){var f=h[k];h=h[k+1];c[k]=d[0]*
f+d[2]*h+d[4];c[k+1]=d[1]*f+d[3]*h+d[5]}Object.defineProperty(c,"__esModule",{value:!0});c.transformMany=c.transform=c.createView=c.fromValues=c.clone=c.create=void 0;c.create=function(){var c=new Float32Array(6);c[0]=1;c[3]=1;return c};c.clone=function(c){var f=new Float32Array(6);f[0]=c[0];f[1]=c[1];f[2]=c[2];f[3]=c[3];f[4]=c[4];f[5]=c[5];return f};c.fromValues=function(c,h,d,k,r,n){var f=new Float32Array(6);f[0]=c;f[1]=h;f[2]=d;f[3]=k;f[4]=r;f[5]=n;return f};c.createView=function(c,h){return new Float32Array(c,
h,6)};c.transform=h;c.transformMany=function(c,m,d,k,r,n){void 0===k&&(k=0);void 0===r&&(r=0);void 0===n&&(n=2);for(r=r||m.length/n;k<r;k++)h(c,m,d,k*n)}})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(x,c,h){function f(d,c,f){var h=c[0],k=c[1],p=c[2],b=c[3],a=c[4];c=c[5];var l=f[0],g=f[1],e=f[2],q=f[3],r=f[4];f=f[5];d[0]=h*l+p*g;d[1]=k*l+b*g;d[2]=h*e+p*q;d[3]=k*e+b*q;d[4]=h*r+p*f+a;d[5]=k*r+b*f+c;return d}function m(d,c,f){d[0]=c[0]-f[0];d[1]=
c[1]-f[1];d[2]=c[2]-f[2];d[3]=c[3]-f[3];d[4]=c[4]-f[4];d[5]=c[5]-f[5];return d}Object.defineProperty(c,"__esModule",{value:!0});c.sub=c.mul=c.equals=c.exactEquals=c.multiplyScalarAndAdd=c.multiplyScalar=c.subtract=c.add=c.frob=c.str=c.fromTranslation=c.fromScaling=c.fromRotation=c.translate=c.scale=c.rotate=c.multiply=c.determinant=c.invert=c.set=c.identity=c.copy=void 0;c.copy=function(d,c){d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];return d};c.identity=function(d){d[0]=1;d[1]=0;
d[2]=0;d[3]=1;d[4]=0;d[5]=0;return d};c.set=function(d,c,f,h,m,p,b){d[0]=c;d[1]=f;d[2]=h;d[3]=m;d[4]=p;d[5]=b;return d};c.invert=function(d,c){var f=c[0],h=c[1],k=c[2],p=c[3],b=c[4];c=c[5];var a=f*p-h*k;if(!a)return null;a=1/a;d[0]=p*a;d[1]=-h*a;d[2]=-k*a;d[3]=f*a;d[4]=(k*c-p*b)*a;d[5]=(h*b-f*c)*a;return d};c.determinant=function(d){return d[0]*d[3]-d[1]*d[2]};c.multiply=f;c.rotate=function(d,c,f){var h=c[0],k=c[1],p=c[2],b=c[3],a=c[4];c=c[5];var l=Math.sin(f);f=Math.cos(f);d[0]=h*f+p*l;d[1]=k*f+
b*l;d[2]=h*-l+p*f;d[3]=k*-l+b*f;d[4]=a;d[5]=c;return d};c.scale=function(d,c,f){var h=c[1],k=c[2],p=c[3],b=c[4],a=c[5],l=f[0];f=f[1];d[0]=c[0]*l;d[1]=h*l;d[2]=k*f;d[3]=p*f;d[4]=b;d[5]=a;return d};c.translate=function(d,c,f){var h=c[0],k=c[1],p=c[2],b=c[3],a=c[4];c=c[5];var l=f[0];f=f[1];d[0]=h;d[1]=k;d[2]=p;d[3]=b;d[4]=h*l+p*f+a;d[5]=k*l+b*f+c;return d};c.fromRotation=function(c,f){var d=Math.sin(f);f=Math.cos(f);c[0]=f;c[1]=d;c[2]=-d;c[3]=f;c[4]=0;c[5]=0;return c};c.fromScaling=function(c,f){c[0]=
f[0];c[1]=0;c[2]=0;c[3]=f[1];c[4]=0;c[5]=0;return c};c.fromTranslation=function(c,f){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=f[0];c[5]=f[1];return c};c.str=function(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"};c.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+1)};c.add=function(c,f,h){c[0]=f[0]+h[0];c[1]=f[1]+h[1];c[2]=f[2]+h[2];c[3]=f[3]+h[3];c[4]=f[4]+h[4];c[5]=f[5]+h[5];return c};c.subtract=
m;c.multiplyScalar=function(c,f,h){c[0]=f[0]*h;c[1]=f[1]*h;c[2]=f[2]*h;c[3]=f[3]*h;c[4]=f[4]*h;c[5]=f[5]*h;return c};c.multiplyScalarAndAdd=function(c,f,h,n){c[0]=f[0]+h[0]*n;c[1]=f[1]+h[1]*n;c[2]=f[2]+h[2]*n;c[3]=f[3]+h[3]*n;c[4]=f[4]+h[4]*n;c[5]=f[5]+h[5]*n;return c};c.exactEquals=function(c,f){return c[0]===f[0]&&c[1]===f[1]&&c[2]===f[2]&&c[3]===f[3]&&c[4]===f[4]&&c[5]===f[5]};c.equals=function(c,f){var d=c[0],k=c[1],m=c[2],p=c[3],b=c[4];c=c[5];var a=f[0],l=f[1],g=f[2],e=f[3],q=f[4];f=f[5];return Math.abs(d-
a)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(a))&&Math.abs(k-l)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(l))&&Math.abs(m-g)<=h.EPSILON*Math.max(1,Math.abs(m),Math.abs(g))&&Math.abs(p-e)<=h.EPSILON*Math.max(1,Math.abs(p),Math.abs(e))&&Math.abs(b-q)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(q))&&Math.abs(c-f)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))};c.mul=f;c.sub=m})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports tslib ../../../Color ../../../symbols ../../../core/promiseUtils ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils @dojo/framework/shim/Promise".split(" "),
function(x,c,h,f,m,d,k,r,n,t){function p(a,b){var c=a.length-1;return a.map(function(a,e){return t.createStopLabel(a,e,c,b)})}function b(b,c){var e=null,d=null;"simple"===b.type?e=b.symbol:"class-breaks"===b.type?(e=(b=b.classBreakInfos)&&b[0]&&b[0].symbol,d=1<b.length):"unique-value"===b.type&&(e=(b=b.uniqueValueInfos)&&b[0]&&b[0].symbol,d=1<b.length);if(!e||a(e))return null;e=e.clone();if(c||d)-1<e.type.indexOf("3d")?l(e):(c=e,"cim"===c.type?r.applyCIMSymbolColor(c,new f(G)):-1!==c.type.indexOf("line")?
c.color=z:(c.color=F,"simple-marker"===c.type&&(c.outline={color:z,width:1.5})));return e}function a(a){return a?m.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill"):!1}function l(a){n.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:z}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:G}:(a.material={color:F},a.outline={color:z,size:1.5})}))}
function g(a,b,c,d){return h.__awaiter(this,void 0,void 0,function(){var f,g,l,p,n;return h.__generator(this,function(h){switch(h.label){case 0:return[4,new Promise(function(a,b){x(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:g=(f=h.sent().getSizeRangeAtScale(a,c,d))&&e(f);if(!f&&!g)return[2,void 0];l=g.map(function(b){var c=f.minSize,e=f.maxSize,d=a.minDataValue,g=a.maxDataValue;return b<=c?d:b>=e?g:(b-c)/(e-c)*(g-d)+d});l=k.round(l);p=1;h.label=2;case 2:return p<
l.length-1?[4,q(a,b,l[p],l[p-1],c,d)]:[3,5];case 3:if(n=h.sent())l[p]=n[0],g[p]=n[1];h.label=4;case 4:return p++,[3,2];case 5:return[2,l]}})})}function e(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],e=0;5>e;e++)c.push(b+a*e);return c}function q(a,b,c,e,d,f){return h.__awaiter(this,void 0,void 0,function(){var g,q,l,p,n,w,m,r,B,z,y,t,F,G,C,A,x,E,H,aa,I,N;return h.__generator(this,function(h){switch(h.label){case 0:return[4,u(a,b,c,d,f)];case 1:return g=h.sent(),[4,u(a,b,e,d,f)];case 2:q=h.sent(),
l=k.numDigits(c),p=l.fractional,n=20,w=l.integer,r=m=null,0<c&&1>c&&(m=Math.pow(10,p),c*=m,w=k.numDigits(c).integer),B=w-1,h.label=3;case 3:if(!(0<=B))return[3,8];z=Math.pow(10,B);y=Math.floor(c/z)*z;t=Math.ceil(c/z)*z;null!=m&&(y/=m,t/=m);F=(y+t)/2;N=k.round([y,F,t],{indexes:[1]});F=N[1];return[4,u(a,b,y,d,f)];case 4:return G=h.sent(),[4,u(a,b,t,d,f)];case 5:return C=h.sent(),[4,u(a,b,F,d,f)];case 6:A=h.sent();x=k.percentChange(g,G,q,null);E=k.percentChange(g,C,q,null);H=k.percentChange(g,A,q,null);
aa=x.previous<=n;I=E.previous<=n;aa&&I&&(x.previous<=E.previous?(aa=!0,I=!1):(I=!0,aa=!1));aa?r=[y,G]:I?r=[t,C]:H.previous<=n&&(r=[F,A]);if(r)return[3,8];h.label=7;case 7:return B--,[3,3];case 8:return[2,r]}})})}function u(a,b,c,e,d){return h.__awaiter(this,void 0,void 0,function(){var f;return h.__generator(this,function(g){switch(g.label){case 0:return[4,new Promise(function(a,b){x(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=g.sent().getSize,[2,f(a,
c,{scale:e,view:d,shape:"simple-marker"===b.type?b.style:null})]}})})}function w(a,b){a=a.clone();if(m.isSymbol3D(a))n.isVolumetricSymbol(a)||a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=b)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=b;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var c=a.width,e=a.height;a.height=b;a.width=c/e*b}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=b:"esri.symbols.TextSymbol"===a.declaredClass&&a.font&&
(a.font.size=b);return a}Object.defineProperty(c,"__esModule",{value:!0});c.getRampStops=c.REAL_WORLD_MIN_SIZE=c.REAL_WORLD_MAX_SIZE=void 0;c.REAL_WORLD_MAX_SIZE=30;c.REAL_WORLD_MIN_SIZE=12;var F=[255,255,255],G=[200,200,200],z=[128,128,128];c.getRampStops=function(a,e,f,q,l,m){return h.__awaiter(this,void 0,void 0,function(){var r,z,t,B,y,F,G,C,A,x,E,H,X,U,K,Y,Z,V=this;return h.__generator(this,function(v){switch(v.label){case 0:z=(r=e.legendOptions)&&r.customValues;t=b(a,f);B=!!t;y=!!z;F=null!=
e.minSize&&null!=e.maxSize;G=e.stops&&1<e.stops.length;C=!!e.target;if(!B||!(y||F||G&&!C))return[2,void 0];A=n.isVolumetricSymbol(t);H=E=x=null;if(!A||G)return[3,1];E=k.round([e.minDataValue,e.maxDataValue]);return[3,4];case 1:return(X=z)?[3,3]:[4,g(e,t,q,l)];case 2:X=v.sent(),v.label=3;case 3:E=X,v.label=4;case 4:!E&&G&&(E=e.stops.map(function(a){return a.value}),(x=e.stops.some(function(a){return!!a.label}))&&(H=e.stops.map(function(a){return a.label})));A&&E&&2<E.length&&(E=[E[0],E[E.length-1]]);
if(!E)return[2,null];U=[c.REAL_WORLD_MIN_SIZE,c.REAL_WORLD_MAX_SIZE];K=n.getSymbolOutlineSize(t);Y=x?null:p(E,m);return[4,d.all(E.map(function(a,b){return h.__awaiter(V,void 0,void 0,function(){var c,d,f,g;return h.__generator(this,function(h){switch(h.label){case 0:if(!A)return[3,1];f=U[b];return[3,3];case 1:return[4,u(e,t,a,q,l)];case 2:f=h.sent(),h.label=3;case 3:return c=f,d=w(t,c),g=x?H[b]:Y[b],[2,{value:a,symbol:d,label:g,size:c,outlineSize:K}]}})})}))];case 5:return Z=v.sent(),[2,Z.reverse()]}})})}})},
"esri/widgets/Legend/styles/Card":function(){define("require exports tslib ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators ../../../symbols/support/svgUtils ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),function(x,c,h,f,m,d,k,r,n,t,p,b){var a=window.devicePixelRatio;return function(c){function g(a,b){a=c.call(this,a,b)||this;a._handles=new m;a._hasIndicators=!1;a._selectedSectionName=null;a._sectionNames=
[];a._sectionMap=new Map;a.activeLayerInfos=null;a.layout="stack";a.messages=null;a.messagesCommon=null;a.type="card";a.view=null;return a}h.__extends(g,c);g.prototype.initialize=function(){var a=this;this.own([this.watch("activeLayerInfos",function(b){a._handles.removeAll();a._watchForSectionChanges(b)})])};g.prototype.destroy=function(){this._handles.destroy();this._handles=null};g.prototype.render=function(){var a,c=this;this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||
"stack"===this.layout;var d=this.activeLayerInfos,g=d&&d.toArray().map(function(a){return c._renderLegendForLayer(a)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;var h=this._sectionNames.length,d=this._sectionNames.map(function(a,e){var d;e=f.substitute(c.messagesCommon.pagination.pageText,{index:e+1,total:h});
return b.tsx("div",{key:a,"aria-label":e,title:e,tabIndex:0,onclick:c._selectSection,onkeydown:c._selectSection,bind:c,class:c.classes("esri-legend--card__carousel-indicator",(d={},d["esri-legend--card__carousel-indicator--activated"]=c._selectedSectionName===a,d)),"data-section-name":a})}),d=this._hasIndicators&&1<h?b.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation"},d):null,g=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):g&&g.length?
g:null,l=(a={},a["esri-legend--stacked"]=this._hasIndicators,a);return b.tsx("div",{class:this.classes("esri-legend--card",l)},d,g?g:b.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend))};g.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};g.prototype._watchForSectionChanges=function(a){var b=this;this._generateSectionNames();a&&(a.forEach(function(a){var c="activeLayerInfo-"+a.layer.uid+"-version-change";b._handles.remove(c);
b._watchForSectionChanges(a.children);b._handles.add(a.watch("version",function(){return b._generateSectionNames()}),c)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(a.on("change",function(){return b._watchForSectionChanges(a)}),"activeLayerInfos-collection-change"))};g.prototype._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};g.prototype._generateSectionNamesForActiveLayerInfo=
function(a){var b=this;a.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);a.legendElements&&a.legendElements.forEach(function(c,e){b._sectionNames.push("esri-legend--card__"+a.layer.uid+"-type-"+c.type+"-"+e)})};g.prototype._renderLegendForLayer=function(a){var c,e=this;if(!a.ready)return null;if(a.children.length)return c=a.children.map(function(a){return e._renderLegendForLayer(a)}).toArray(),b.tsx("div",{key:a.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},
b.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),c);var d=a.legendElements;if(d&&!d.length)return null;var f=d.some(function(a){return"relationship-ramp"===a.type}),d=d.map(function(b,c){return e._renderLegendForElement(b,a,c,f)}).filter(function(a){return!!a});if(!d.length)return null;var g=(c={},c["esri-legend--card__group-layer-child"]=!!a.parent,c);return b.tsx("div",{key:a.layer.uid,class:this.classes("esri-legend--card__service",g)},b.tsx("div",{class:"esri-legend--card__service-caption-container"},
b.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),b.tsx("div",{class:"esri-legend--card__service-content"},d))};g.prototype._renderLegendForElement=function(a,c,d,f){var e,g=this;void 0===f&&(f=!1);var h="color-ramp"===a.type,l="opacity-ramp"===a.type,q="size-ramp"===a.type,k=c.layer,n=a.title,m=null;"string"===typeof n?m=n:n&&(m=p.getTitle(this.messages,n,h||l),m=n.title?n.title+" ("+m+")":m);d="esri-legend--card__"+k.uid+"-type-"+a.type+"-"+d;n=this._hasIndicators?b.tsx("div",
null,b.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend--card__carousel-title")},c.title),b.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},m)):m?b.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},m):null;m=null;"symbol-table"===a.type?(q=a.infos.map(function(b,e){return g._renderLegendForElementInfo(b,c,a.legendType,e)}).filter(function(a){return!!a}),q.length&&(k=q[0].properties.classes&&q[0].properties.classes["esri-legend--card__symbol-row"],
f=(e={},e["esri-legend--card__label-container"]=!k&&!f,e["esri-legend--card__relationship-label-container"]=f,e),m=b.tsx("div",{key:d,class:"esri-legend--card__section"},n,b.tsx("div",{class:this.classes(f)},q)))):"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?m=b.tsx("div",{key:d,class:"esri-legend--card__section"},n,this._renderLegendForRamp(a,k.opacity)):q?m=b.tsx("div",{key:d,class:"esri-legend--card__section"},n,this._renderSizeRamp(a,k.opacity)):"relationship-ramp"===
a.type&&(m=b.tsx("div",{key:d,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},n,t.renderRelationshipRamp(a,this.id,k.opacity)));if(!m)return null;this._sectionMap.set(d,m);return m};g.prototype._renderLegendForElementInfo=function(a,c,d,f){var e,g,h,l,q,k=c.layer;if(a.type)return this._renderLegendForElement(a,c,f);c=p.isImageryStretchedLegend(k,d);if(a.symbol&&a.preview){if(-1===a.symbol.type.indexOf("simple-fill")){if(!a.label)return b.tsx("div",{key:f,
bind:a.preview,afterCreate:p.attachToNode});l=(e={},e["esri-legend--card__symbol-cell"]=this._hasIndicators,e);return b.tsx("div",{key:f,class:this.classes("esri-legend--card__layer-row",(g={},g["esri-legend--card__symbol-row"]=this._hasIndicators,g))},b.tsx("div",{class:this.classes(l),bind:a.preview,afterCreate:p.attachToNode}),b.tsx("div",{class:this.classes("esri-legend--card__image-label",(h={},h["esri-legend--card__label-cell"]=this._hasIndicators,h))},p.getTitle(this.messages,a.label,!1)||
""))}h=g=e=255;c=0;var n=d=255,m=255,r=0,w=a.symbol.color&&a.symbol.color.a,u=a.symbol.outline&&a.symbol.outline.color&&a.symbol.outline.color.a;w&&(e=a.symbol.color.r,g=a.symbol.color.g,h=a.symbol.color.b,c=a.symbol.color.a*k.opacity);u&&(d=a.symbol.outline.color.r,n=a.symbol.outline.color.g,m=a.symbol.outline.color.b,r=a.symbol.outline.color.a*k.opacity);l=(k=null!==(q=null===(l=a.symbol.color)||void 0===l?void 0:l.isBright)&&void 0!==q?q:!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return b.tsx("div",
{key:f,class:"esri-legend--card__layer-row"},b.tsx("div",{class:"esri-legend--card__label-element",styles:{background:w?"rgba("+e+", "+g+", "+h+", "+c+")":"none",color:k?"black":"white",textShadow:"-1px -1px 0 "+l+",\n                                              1px -1px 0 "+l+",\n                                              -1px 1px 0 "+l+",\n                                              1px 1px 0 "+l,border:u?"1px solid rgba("+d+", "+n+", "+m+", "+r+")":"none"}}," ",a.label," "))}if(a.src)return l=
this._renderImage(a,k,c),b.tsx("div",{key:f,class:"esri-legend--card__layer-row"},l,b.tsx("div",{class:"esri-legend--card__image-label"},a.label||""))};g.prototype._renderImage=function(a,c,d){var e,f=a.label,g=a.src,h=a.opacity;d=(e={},e["esri-legend--card__imagery-layer-image--stretched"]=d,e["esri-legend--card__symbol"]=!d,e);c={opacity:""+(null!=h?h:c.opacity)};return b.tsx("img",{alt:p.getTitle(this.messages,f,!1),src:g,border:0,width:a.width,height:a.height,class:this.classes(d),styles:c})};
g.prototype._renderSizeRampLines=function(c){c=c.infos;var e=c[0],f=c[c.length-1],g=e.symbol;c=this._hasIndicators;var e=d.pt2px(e.size+e.outlineSize)*a,f=d.pt2px(f.size+f.outlineSize)*a,h=c?e:e+50*a,l=c?e/2+50*a:e,k;g?-1<g.type.indexOf("3d")?(k=g.symbolLayers&&g.symbolLayers.length)?(k=g.symbolLayers.getItemAt(k-1).get("resource.primitive"),k="triangle"===k||"cone"===k||"tetrahedron"===k):k=void 0:k="triangle"===g.style:k=void 0;if(g)if(-1<g.type.indexOf("3d")){var n=g.symbolLayers&&g.symbolLayers.length;
n?(g=g.symbolLayers.getItemAt(n-1),g=g.resource&&g.resource.primitive,g="circle"===g||"cross"===g||"kite"===g||"sphere"===g||"cube"===g||"diamond"===g):g=void 0}else g=g.style,g="circle"===g||"diamond"===g||"cross"===g;else g=void 0;n=document.createElement("canvas");n.width=h;n.height=l;n.style.width=n.width/a+"px";n.style.height=n.height/a+"px";var m=n.getContext("2d");if(c){m.beginPath();var r=h/2-f/2;m.moveTo(0,0);m.lineTo(r,l);r=h/2+f/2;m.moveTo(h,0);m.lineTo(r,l)}else m.beginPath(),m.moveTo(0,
l/2-f/2),m.lineTo(h,0),m.moveTo(0,l/2+f/2),m.lineTo(h,l);m.strokeStyle="#ddd";m.stroke();return b.tsx("div",{bind:n,afterCreate:p.attachToNode,styles:c?{display:"flex",marginTop:"-"+(k?0:g?e/2:0)+"px",marginBottom:"-"+(k?f:g?f/2:0)+"px"}:{display:"flex",marginRight:"-"+(k?0:g?e/2:0)+"px",marginLeft:"-"+(k?0:g?f/2:0)+"px"}})};g.prototype._renderSizeRamp=function(a,c){var e,d=a.infos,f=d[0].label,g=d[d.length-1].label,h=d[0].preview,d=d[d.length-1].preview,l=this._hasIndicators,k={"flex-direction":l?
"column":"row-reverse"};h&&(h=h.cloneNode(!0),h.style.display="flex");d&&(d=d.cloneNode(!0),d.style.display="flex");c={opacity:null!=c?""+c:""};return b.tsx("div",{class:this.classes("esri-legend--card__layer-row",(e={},e["esri-legend--card__size-ramp-row"]=l,e))},b.tsx("div",{class:"esri-legend--card__ramp-label"},l?f:g),b.tsx("div",{class:"esri-legend--card__size-ramp-container",styles:k},b.tsx("div",{bind:h,afterCreate:p.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:c}),this._renderSizeRampLines(a),
b.tsx("div",{bind:d,afterCreate:p.attachToNode,class:"esri-legend--card__size-ramp-container",styles:c})),b.tsx("div",{class:"esri-legend--card__ramp-label"},l?g:f))};g.prototype._renderLegendForRamp=function(a,c){var e=a.infos,d="heatmap-ramp"===a.type,f=e.length-1,g=2<f&&!d?25*f:100,h=g+20,l=e.slice(0).reverse();l.forEach(function(a,b){a.offset=d?a.ratio:b/f});var k=l.length-1;a=(a=0!==l.length%2&&l[l.length/2|0])&&b.tsx("div",{class:"esri-legend--card__interval-separators-container"},b.tsx("div",
{class:"esri-legend--card__interval-separator"},"|"),b.tsx("div",{class:"esri-legend--card__ramp-label"},a.label));var n=e[e.length-1].label,e=e[0].label,p=null;null!=c&&(p="opacity: "+c);c=r.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:l[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:g,height:25},fill:{type:"linear",x1:10,y1:0,x2:g+10,y2:0,colors:l},stroke:{width:0}},{shape:{type:"path",path:"M"+(g+10)+" 0 L"+h+" 12.5 L"+(g+10)+" 25 Z"},fill:l[k].color,stroke:{width:0}}]],
h,25);g=this.messages;return b.tsx("div",{class:"esri-legend--card__layer-row"},b.tsx("div",{class:"esri-legend--card__ramp-label"},d?g[n]:n),b.tsx("div",{class:"esri-legend--card__symbol-container"},b.tsx("div",{style:p},c),a),b.tsx("div",{class:"esri-legend--card__ramp-label"},d?g[e]:e))};h.__decorate([b.renderable(),k.property()],g.prototype,"activeLayerInfos",void 0);h.__decorate([k.property()],g.prototype,"layout",void 0);h.__decorate([k.property(),b.renderable(),b.messageBundle("esri/widgets/Legend/t9n/Legend")],
g.prototype,"messages",void 0);h.__decorate([k.property(),b.renderable(),b.messageBundle("esri/t9n/common")],g.prototype,"messagesCommon",void 0);h.__decorate([k.property({readOnly:!0})],g.prototype,"type",void 0);h.__decorate([k.property()],g.prototype,"view",void 0);h.__decorate([b.accessibleHandler()],g.prototype,"_selectSection",null);return g=h.__decorate([k.subclass("esri.widgets.Legend.styles.Card")],g)}(n)})},"esri/widgets/Legend/styles/support/utils":function(){define(["require","exports",
"../../../../symbols/support/svgUtils","../../../support/widget"],function(x,c,h,f){function m(c,f,h){var d=h+"_arrowStart";h+="_arrowEnd";c="left"===c;var k={markerStart:null,markerEnd:null};switch(f){case "HL":c?k.markerStart="url(#"+h+")":k.markerEnd="url(#"+d+")";break;case "LL":k.markerStart="url(#"+h+")";break;case "LH":c?k.markerEnd="url(#"+d+")":k.markerStart="url(#"+h+")";break;default:k.markerEnd="url(#"+d+")"}return k}Object.defineProperty(c,"__esModule",{value:!0});c.renderRelationshipRamp=
void 0;c.renderRelationshipRamp=function(c,k,r){var d=c.labels,t=!!c.focus,p=void 0;void 0===p&&(p=60);var b=c.focus,a=c.numClasses,l=c.colors,g=c.rotation;c=!!b;var e=Math.sqrt(Math.pow(p,2)+Math.pow(p,2))+(c?0:5),q=null;null!=r&&(q="opacity: "+r);r=[];for(var u=[],w=[],x=(p||75)/a,G=0;G<a;G++)for(var z=G*x,B=0;B<a;B++){var y=B*x,C=h.generateFillAttributes(l[G][B]),H=h.generateStrokeAttributes(null),y={type:"rect",x:y,y:z,width:x,height:x};r.push(h.renderDef(C));u.push(h.renderShape(y,C.fill,H,null));
w.push(h.getBoundingBox(y))}a=null;c||(a="margin: -15px -15px -18px -15px");l=m("left",b,k);b=m("right",b,k);w=h.computeBBox(w);g=h.getTransformMatrix(w,e,e,0,!1,g);w=h.getTransformMatrix(w,e,e,0,!1,c?-45:null);k=f.tsx("div",{style:q,class:c?"esri-relationship-ramp--diamond__middle-column--ramp":"esri-relationship-ramp--square__table-cell"},f.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,style:a},f.tsx("defs",null,f.tsx("marker",{id:k+"_arrowStart",markerWidth:"10",markerHeight:"10",
refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},f.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),f.tsx("marker",{id:k+"_arrowEnd",markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},f.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),r),f.tsx("g",{transform:g},u),f.tsx("g",{transform:w},f.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":l.markerStart,
"marker-end":l.markerEnd,x1:-10,y1:p-15,x2:-10,y2:15}),f.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":b.markerStart,"marker-end":b.markerEnd,x1:15,y1:p+10,x2:p-15,y2:p+10}))));return t?f.tsx("div",{class:"esri-relationship-ramp--diamond__container"},f.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},d.left),f.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column"},f.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},d.top),
k,f.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},d.bottom)),f.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},d.right)):f.tsx("div",{class:"esri-relationship-ramp--square__table"},f.tsx("div",{class:"esri-relationship-ramp--square__table-row"},f.tsx("div",{class:f.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-bottom")},d.left),f.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),
f.tsx("div",{class:f.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-bottom")},d.top)),f.tsx("div",{class:"esri-relationship-ramp--square__table-row"},f.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),k,f.tsx("div",{class:"esri-relationship-ramp--square__table-cell"})),f.tsx("div",{class:"esri-relationship-ramp--square__table-row"},f.tsx("div",{class:f.classes("esri-relationship-ramp--square__table-cell",
"esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-top")},d.bottom),f.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),f.tsx("div",{class:f.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-top")},d.right)))}})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports","../../../intl"],function(x,c,h){Object.defineProperty(c,
"__esModule",{value:!0});c.isImageryStretchedLegend=c.isRendererTitle=c.getTitle=c.attachToNode=void 0;c.attachToNode=function(c){c.appendChild(this)};c.getTitle=function(c,m,d){if(m){if("string"===typeof m)return m;if("value"in m||"unit"in m)return h.substitute(c.dotValue,m);if("colorName"in m||"bandName"in m)return c[m.colorName]+": "+(c[m.bandName]||m.bandName);if("showCount"in m)return m.showCount?c.clusterCountTitle:null;var f=null;d?f=m.ratioPercentTotal?"showRatioPercentTotal":m.ratioPercent?
"showRatioPercent":m.ratio?"showRatio":m.normField?"showNormField":m.field?"showField":null:d||(f=m.normField?"showNormField":m.normByPct?"showNormPct":m.field?"showField":null);return f?h.substitute("showField"===f?"{field}":c[f],{field:m.field,normField:m.normField}):null}};c.isRendererTitle=function(c,h){return!h};c.isImageryStretchedLegend=function(c,h){return!!(h&&"Stretched"===h&&10.3<=c.version&&"esri.layers.ImageryLayer"===c.declaredClass)}})},"esri/widgets/Legend/styles/Classic":function(){define("require exports tslib ../../../intl ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),
function(x,c,h,f,m,d,k,r,n){return function(c){function d(b,a){b=c.call(this,b,a)||this;b.activeLayerInfos=null;b.messages=null;b.type="classic";return b}h.__extends(d,c);d.prototype.render=function(){var b=this,a=this.activeLayerInfos,a=a&&a.toArray().map(function(a){return b._renderLegendForLayer(a)}).filter(function(a){return!!a});return n.tsx("div",null,a&&a.length?a:n.tsx("div",{class:"esri-legend__message"},this.messages.noLegend))};d.prototype._renderLegendForLayer=function(b){var a,c=this;
if(!b.ready)return null;var d=!!b.children.length,e="esri-legend__"+b.layer.uid+"-version-"+b.version,f=b.title?n.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},b.title):null;if(d)return a=b.children.map(function(a){return c._renderLegendForLayer(a)}).toArray(),n.tsx("div",{key:e,class:this.classes("esri-legend__service","esri-legend__group-layer")},f,a);if((d=b.legendElements)&&!d.length)return null;d=d.map(function(a){return c._renderLegendForElement(a,b.layer)}).filter(function(a){return!!a});
if(!d.length)return null;var h=(a={},a["esri-legend__group-layer-child"]=!!b.parent,a);return n.tsx("div",{key:e,class:this.classes("esri-legend__service",h)},f,n.tsx("div",{class:"esri-legend__layer"},d))};d.prototype._renderLegendForElement=function(b,a,c){var d,e=this,f="color-ramp"===b.type,h="opacity-ramp"===b.type,l="size-ramp"===b.type,p=null;if("symbol-table"===b.type||l){var m=b.infos.map(function(c){return e._renderLegendForElementInfo(c,a,l,b.legendType)}).filter(function(a){return!!a});
m.length&&(p=n.tsx("div",{class:"esri-legend__layer-body"},m))}else"color-ramp"===b.type||"opacity-ramp"===b.type||"heatmap-ramp"===b.type||"stretch-ramp"===b.type?p=this._renderLegendForRamp(b,a.opacity):"relationship-ramp"===b.type&&(p=k.renderRelationshipRamp(b,this.id,a.opacity));if(!p)return null;var m=b.title,t=null;"string"===typeof m?t=m:m&&(t=r.getTitle(this.messages,m,f||h),t=r.isRendererTitle(m,f||h)&&m.title?m.title+" ("+t+")":t);f=c?"esri-legend__layer-child-table":"esri-legend__layer-table";
h=t?n.tsx("div",{class:"esri-legend__layer-caption"},t):null;c=(d={},d["esri-legend__layer-table--size-ramp"]=l||!c,d);return n.tsx("div",{class:this.classes(f,c)},h,p)};d.prototype._renderLegendForRamp=function(b,a){var c=this,d=b.infos,e="heatmap-ramp"===b.type,f="stretch-ramp"===b.type,h=b.preview;h.className="esri-legend__color-ramp "+("opacity-ramp"===b.type?"esri-legend__opacity-ramp":"");null!=a&&(h.style.opacity=a.toString());b=d.map(function(a){return n.tsx("div",{class:a.label?"esri-legend__ramp-label":
null},e?c.messages[a.label]:f?c._getStretchStopLabel(a):a.label)});a={height:h.style.height};return n.tsx("div",{class:"esri-legend__layer-row"},n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},n.tsx("div",{class:"esri-legend__ramps",bind:h,afterCreate:r.attachToNode})),n.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},n.tsx("div",{class:"esri-legend__ramp-labels",styles:a},b)))};d.prototype._getStretchStopLabel=function(b){return b.label?
this.messages[b.label]+": "+f.formatNumber(b.value,{style:"decimal",notation:-1<b.value.toString().indexOf("e")?"scientific":"standard"}):""};d.prototype._renderLegendForElementInfo=function(b,a,c,d){var e,f;if(b.type)return this._renderLegendForElement(b,a,!0);var g=null;d=r.isImageryStretchedLegend(a,d);b.symbol&&b.preview?g=n.tsx("div",{class:"esri-legend__symbol",bind:b.preview,afterCreate:r.attachToNode}):b.src&&(g=this._renderImage(b,a,d));if(!g)return null;a=(e={},e["esri-legend__imagery-layer-info--stretched"]=
d,e);c=(f={},f["esri-legend__imagery-layer-info--stretched"]=d,f["esri-legend__size-ramp"]=!d&&c,f);return n.tsx("div",{class:"esri-legend__layer-row"},n.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",c)},g),n.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",a)},r.getTitle(this.messages,b.label,!1)||""))};d.prototype._renderImage=function(b,a,c){var d,e=b.label,f=b.src,h=b.opacity;c=(d={},d["esri-legend__imagery-layer-image--stretched"]=
c,d["esri-legend__symbol"]=!c,d);a={opacity:""+(null!=h?h:a.opacity)};return n.tsx("img",{alt:r.getTitle(this.messages,e,!1),src:f,border:0,width:b.width,height:b.height,class:this.classes(c),styles:a})};h.__decorate([n.renderable(),m.property()],d.prototype,"activeLayerInfos",void 0);h.__decorate([m.property(),n.renderable(),n.messageBundle("esri/widgets/Legend/t9n/Legend")],d.prototype,"messages",void 0);h.__decorate([m.property({readOnly:!0})],d.prototype,"type",void 0);return d=h.__decorate([m.subclass("esri.widgets.Legend.styles.Classic")],
d)}(d)})},"*noref":1}});
define("require exports tslib ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/decorators/cast ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(x,c,h,f,m,d,k,r,n,t,p,b){return function(a){function c(b,c){b=a.call(this,b,c)||this;b._handles=new f;b.activeLayerInfos=null;b.basemapLegendVisible=!1;b.groundLegendVisible=!1;b.keepCacheOnDestroy=!1;b.respectLayerVisibility=!0;b.iconClass="esri-icon-layer-list";
b.label=void 0;b.layerInfos=null;b.messages=null;b.style=new p;b.view=null;b.viewModel=new n;return b}h.__extends(c,a);c.prototype.initialize=function(){var a=this;this.own(m.on(this,"activeLayerInfos","change",function(){return a._refreshActiveLayerInfos(a.activeLayerInfos)}),m.init(this,"style",function(b,c){c&&b!==c&&c.destroy();b&&(b.activeLayerInfos=a.activeLayerInfos,"card"===b.type&&(b.view=a.view))}))};c.prototype.destroy=function(){this._handles.destroy();this._handles=null};c.prototype.castStyle=
function(a){if(a instanceof t||a instanceof p)return a;if("string"===typeof a)return"card"===a?new t:new p;if(a&&"string"===typeof a.type){var b=h.__assign({},a);delete b.type;return new ("card"===a.type?t:p)(b)}return new p};c.prototype.render=function(){return b.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof p?"esri-widget--panel":null)},this.style.render())};c.prototype._refreshActiveLayerInfos=function(a){var b=this;this._handles.removeAll();a.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)});
this.scheduleRender()};c.prototype._renderOnActiveLayerInfoChange=function(a){var b=this,c=m.init(a,"version",function(){return b.scheduleRender()});this._handles.add(c,"version_"+a.layer.uid);c=m.on(a,"children","change",function(){a.children.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)})});this._handles.add(c,"children_"+a.layer.uid);a.children.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)})};h.__decorate([d.aliasOf("viewModel.activeLayerInfos"),b.renderable()],
c.prototype,"activeLayerInfos",void 0);h.__decorate([d.aliasOf("viewModel.basemapLegendVisible"),b.renderable()],c.prototype,"basemapLegendVisible",void 0);h.__decorate([d.aliasOf("viewModel.groundLegendVisible"),b.renderable()],c.prototype,"groundLegendVisible",void 0);h.__decorate([d.aliasOf("viewModel.keepCacheOnDestroy")],c.prototype,"keepCacheOnDestroy",void 0);h.__decorate([d.aliasOf("viewModel.respectLayerVisibility"),b.renderable()],c.prototype,"respectLayerVisibility",void 0);h.__decorate([d.property()],
c.prototype,"iconClass",void 0);h.__decorate([d.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],c.prototype,"label",void 0);h.__decorate([d.aliasOf("viewModel.layerInfos"),b.renderable()],c.prototype,"layerInfos",void 0);h.__decorate([d.property(),b.renderable(),b.messageBundle("esri/widgets/Legend/t9n/Legend")],c.prototype,"messages",void 0);h.__decorate([d.property(),b.renderable()],c.prototype,"style",void 0);h.__decorate([k.cast("style")],c.prototype,"castStyle",null);h.__decorate([d.aliasOf("viewModel.view"),
b.renderable()],c.prototype,"view",void 0);h.__decorate([d.property(),b.renderable(["view.size"])],c.prototype,"viewModel",void 0);return c=h.__decorate([d.subclass("esri.widgets.Legend")],c)}(r)});