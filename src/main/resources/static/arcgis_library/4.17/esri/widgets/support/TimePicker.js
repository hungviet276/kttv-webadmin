// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../intl ../../core/events ../../core/accessorSupport/decorators ../../intl/moment ../Widget ./TimePickerViewModel ./widget".split(" "),function(u,v,d,k,p,f,q,r,m,h){var l={hour:"numeric",minute:"numeric"},t=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","Tab"];return function(n){function b(a,c){a=n.call(this,a,c)||this;a._activeTime=null;a.label=void 0;a.messages=null;a.value=null;a.viewModel=new m;return a}d.__extends(b,n);b.prototype.loadLocale=function(){return d.__awaiter(this,
void 0,void 0,function(){var a;return d.__generator(this,function(c){switch(c.label){case 0:return a=this,[4,q.loadMoment()];case 1:return a._moment=c.sent(),[2]}})})};b.prototype.render=function(){var a=this._activeTime||this.viewModel.value;return h.tsx("div",{class:"esri-time-picker esri-widget"},h.tsx("input",{afterUpdate:this._handleInputUpdate,"aria-label":this.messages.inputTitle,bind:this,class:this.classes("esri-time-picker__input","esri-input"),onblur:this._handleInputBlur,onfocus:this._handleInputFocus,
onkeydown:this._handleInputKeydown,onclick:this._handleInputClick,onpaste:this._handleInputPaste,onwheel:this._handleInputWheel,value:k.formatDate(a.valueOf(),l)}))};b.prototype._handleInputBlur=function(){this._activeTime.isValid()&&(this.viewModel.value=this._activeTime.toDate());this._activePart=this._activeTime=null};b.prototype._handleInputUpdate=function(a){this._selectPart(a,this._activePart)};b.prototype._selectPart=function(a,c){var b=this._activeTime;if(b){var b=k.formatDate(b.valueOf(),
l),g=b.indexOf(":");if("hours"===c)a.setSelectionRange(0,g);else{var e=g+1,g=e+2;"minutes"===c?a.setSelectionRange(e,g):(b=b.length,"meridiem"===c&&a.setSelectionRange(g+1,b))}}};b.prototype._handleInputFocus=function(a){this._activePart="hours";this._activeTime=this._moment(this.viewModel.value).startOf("minute");this._selectPart(a.target,"hours")};b.prototype._caretIndexToPartName=function(a){var c=this._activeTime.format("LT"),b=c.indexOf(":"),c=c.indexOf(" ");return a<=b?"hours":a>b&&a<=c?"minutes":
"meridiem"};b.prototype._handleInputKeydown=function(a){var c=a.ctrlKey,b=a.metaKey,g=a.shiftKey,e=p.eventKey(a),d=this._activeTime,f=this._activePart,h=/\d/.test(e),k=/^a|p$/i.test(e),c=b||c;if(-1<t.indexOf(e)||h||"meridiem"===f&&k&&!c){if("ArrowLeft"===e)this._activePart=this._prevPart();else if("ArrowRight"===e)this._activePart=this._nextPart();else if("Tab"===e){d=g?this._prevPart():this._nextPart();if(d===this._activePart)return;this._activePart=d}else"ArrowUp"===e?this._shift("up",d,f):"ArrowDown"===
e?this._shift("down",d,f):h?this._setTime(d,f,Number(e)):k&&(g=e.toLowerCase(),e=d.hour(),("a"===g&&12<=e||"p"===g&&12>e)&&this._shift("up",d,f));a.preventDefault();a.stopImmediatePropagation()}else c||(a.preventDefault(),a.stopImmediatePropagation())};b.prototype._handleInputClick=function(a){a=a.target;this._activePart=null;this.renderNow();this._activePart=this._caretIndexToPartName(a.selectionStart)};b.prototype._getOrderedParts=function(){return-1<k.formatDate(this._activeTime.valueOf(),l).indexOf(" ")?
["hours","minutes","meridiem"]:["hours","minutes"]};b.prototype._prevPart=function(){var a=this._getOrderedParts(),c=a.indexOf(this._activePart)-1;return a[Math.max(c,0)]};b.prototype._nextPart=function(){var a=this._getOrderedParts(),c=a.indexOf(this._activePart)+1;return a[Math.min(c,a.length-1)]};b.prototype._setTime=function(a,c,b){if("hours"===c){c=-1<k.formatDate(a.valueOf(),l).indexOf(" ")?12:24;var d=""+a.hour()%c,e=Number(""+d+b);2===d.length||e>c?a.hour(b):e<=c&&a.hour(e)}else"minutes"===
c&&(c=""+a.minute(),d=Number(""+c+b),2===c.length||59<d?a.minute(b):59>d&&a.minute(d))};b.prototype._handleInputPaste=function(a){var b=a.clipboardData.getData("text/plain"),b=this._moment(b);b.isValid()&&(this._activeTime=b);a.preventDefault();a.stopImmediatePropagation()};b.prototype._handleInputWheel=function(a){this._shift(0>a.deltaY?"up":"down",this._activeTime,this._activePart)};b.prototype._shift=function(a,b,d){if(a&&b&&d)b["up"===a?"add":"subtract"]("meridiem"===d?12:1,"hours"===d?"hour":
"minutes"===d?"minute":"hours")};d.__decorate([f.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],b.prototype,"label",void 0);d.__decorate([f.property(),h.renderable(),h.messageBundle("esri/widgets/support/t9n/TimePicker")],b.prototype,"messages",void 0);d.__decorate([f.aliasOf("viewModel.value")],b.prototype,"value",void 0);d.__decorate([f.property({type:m}),h.renderable("viewModel.value")],b.prototype,"viewModel",void 0);return b=d.__decorate([f.subclass("esri.widgets.support.TimePicker")],
b)}(r)});