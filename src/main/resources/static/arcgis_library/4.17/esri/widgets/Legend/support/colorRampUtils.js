// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../Color ../../../core/promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(p,g,k,f,u,n){function q(a,d){var b=[],c=a.length-1;5===a.length?b.push(0,2,4):b.push(0,c);return a.map(function(a,h){return-1<b.indexOf(h)?n.createStopLabel(a,h,c,d):null})}function v(a,d,b){void 0===b&&(b=w);return k.__awaiter(this,void 0,void 0,function(){var c,e;return k.__generator(this,function(h){switch(h.label){case 0:return c=new f(b),[4,new Promise(function(a,
b){p(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return e=h.sent().getOpacity(d,a),null!=e&&(c.a=e),[2,c]}})})}function m(a,d){a=x(a,d);var b=a.startIndex,c=a.endIndex;if(b===c)return d[b].color;d=f.blendColors(d[b].color,d[c].color,a.weight);return new f(d)}function x(a,d){var b=0,c=d.length-1;d.some(function(d,h){if(a<d.value)return c=h,!0;b=h;return!1});return{startIndex:b,endIndex:c,weight:(a-d[b].value)/(d[c].value-d[b].value)}}Object.defineProperty(g,"__esModule",
{value:!0});g.getStrectchRampStops=g.getColorFromPointCloudStops=g.getRampStopsForPointCloud=g.getRampStops=void 0;var w=new f([64,64,64]);g.getRampStops=function(a,d,b){return k.__awaiter(this,void 0,void 0,function(){var c,e,h,l,f,g,m,t,n=this;return k.__generator(this,function(r){switch(r.label){case 0:c=!1;e=[];h=[];a.stops&&(l=a.stops,e=l.map(function(a){return a.value}),(c=l.some(function(a){return!!a.label}))&&(h=l.map(function(a){return a.label})));f=e[0];g=e[e.length-1];if(null==f&&null==
g)return[2,null];m=c?null:q(e,b);return[4,u.all(e.map(function(b,e){return k.__awaiter(n,void 0,void 0,function(){var l,f,g;return k.__generator(this,function(k){switch(k.label){case 0:return"opacity"!==a.type?[3,2]:[4,v(b,a,d)];case 1:return f=k.sent(),[3,4];case 2:return[4,new Promise(function(a,b){p(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 3:f=k.sent().getColor(a,b),k.label=4;case 4:return l=f,g=c?h[e]:m[e],[2,{value:b,color:l,label:g}]}})})}))];case 1:return t=
r.sent(),[2,t.reverse()]}})})};g.getRampStopsForPointCloud=function(a){var d=!1,b=[],c=[],b=a.map(function(a){return a.value});(d=a.some(function(a){return!!a.label}))&&(c=a.map(function(a){return a.label}));var e=b[b.length-1];if(null==b[0]&&null==e)return null;var h=d?null:q(b,!1);return b.map(function(b,e){var f=m(b,a);return{value:b,color:f,label:d?c[e]:h[e]}}).reverse()};g.getColorFromPointCloudStops=m;g.getStrectchRampStops=function(a,d){var b=[];if(a&&"multipart"===a.type)a.colorRamps.reverse().forEach(function(c,
e){0===e?b.push({value:d.max,color:new f(c.toColor),label:"high"}):b.push({value:null,color:new f(c.toColor),label:""});e===a.colorRamps.length-1?b.push({value:d.min,color:new f(c.fromColor),label:"low"}):b.push({value:null,color:new f(c.fromColor),label:""})});else{var c=void 0,e=void 0;a&&"algorithmic"===a.type?(c=a.fromColor,e=a.toColor):(c=[0,0,0,1],e=[255,255,255,1]);b=[{value:d.max,color:new f(e),label:"high"},{value:d.min,color:new f(c),label:"low"}]}return b}});