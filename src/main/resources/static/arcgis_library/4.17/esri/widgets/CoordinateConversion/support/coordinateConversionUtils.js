// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../geometry ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/webMercatorUtils ../../../tasks/support/ProjectParameters".split(" "),function(x,b,t,k,l,p,u,v){function q(a,d){d=r(d);return[a[0].toFixed(d),a[1].toFixed(d)]}function r(a){return 500<=a?6:500>a&&50<=a?7:50>a&&5<=a?8:9}function g(a){return"number"===typeof a&&isFinite(a)}function m(a){return a&&g(a.x)&&g(a.y)}function h(a,d){return a.spatialReference.isGeographic&&d?(a=q([a.x,a.y],
d),a[0]+", "+a[1]):a.x.toFixed(3)+", "+a.y.toFixed(3)}Object.defineProperty(b,"__esModule",{value:!0});b.isSupportedNotation=b.toGeoCoordinateString=b.project=b.pointToCoordinate=b.isValidPoint=b.fromXY=b.fromGeoCoordinateString=b.getDegreePrecision=b.clipLonLat=void 0;var w={utm:{conversionMode:"utmDefault",addSpaces:!0},usng:{numOfDigits:5,rounding:!1,addSpaces:!1},mgrs:{rounding:!1}},f=Array(3);b.clipLonLat=q;b.getDegreePrecision=r;b.fromGeoCoordinateString=function(a){var d=a.coordinate,c=a.spatialReference,
b=a.formatName;return a.geometryServicePromise.then(function(a){return a.fromGeoCoordinateString({strings:[d],sr:c,conversionType:b}).then(function(a){var b=new k.Point({x:a[0][0],y:a[0][1],spatialReference:c});if(!m(b))throw a;return b}).catch(function(a){throw new l("coordinate-conversion:from-geo-coordinate-string-failed","Failed to convert coordinate notation",{notationResult:a});})})};b.fromXY=function(a,b){var c=0<=a.indexOf(",")?",":" ",d=a.split(c).map(function(a){return(a=a.trim())?Number(a):
null});a=d[0];c=d[1];d=d[2];if(!g(a)||!g(c))return null;b=new k.Point({x:a,y:c,spatialReference:b||k.SpatialReference.WGS84});d&&(b.z=d,b.hasZ=!0);return b};b.isValidPoint=m;b.pointToCoordinate=h;b.project=function(a,b){var c=a.spatialReference,d=a.geometryServicePromise,e=a.location,n=a.scale;if(!c||e.spatialReference.wkid===c.wkid)return p.resolve({location:e,coordinate:h(e,n)});if((e.spatialReference.isWGS84||e.spatialReference.isWebMercator)&&(c.isWGS84||c.isWebMercator))return p.resolve({location:u.project(e,
c),coordinate:h(e,n)});if(f[0]===e&&f[1]===c.wkid)return f[2];f[0]=e;f[1]=c.wkid;a=d.then(function(a){return a.project(new v({geometries:[e],outSpatialReference:c}),{signal:b}).then(function(a){if(!m(a[0]))throw a[0];return{location:a[0],coordinate:h(a[0],n)}}).catch(function(a){throw new l("coordinate-conversion:projection-failed","Failed to project point",{projectionResult:a});})});return f[2]=a};b.toGeoCoordinateString=function(a){var b=a.formatName,c=a.location;a=a.geometryServicePromise;var f=
t.__assign({coordinates:[[c.x,c.y]],sr:c.spatialReference,conversionType:b},w[b]||{});return a.then(function(a){return a.toGeoCoordinateString(f).then(function(a){var b=a[0];if(!b)throw a;return b}).catch(function(a){throw new l("coordinate-conversion:to-geo-coordinate-string-failed","Failed to convert coordinate notation",{notationResult:a});})})};b.isSupportedNotation=function(a){return"dd"===a||"dms"===a||"ddm"===a||"mgrs"===a||"usng"===a||"utm"===a}});