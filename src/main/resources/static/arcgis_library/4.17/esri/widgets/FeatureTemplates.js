// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../core/deprecate ../core/HandleOwner ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./support/widget ../libs/intersection-observer/intersection-observer".split(" "),function(v,w,b,k,l,m,n,d,p,q,r,e){function t(b){return b.items?b.uid:b.layer.id}var u=m.getLogger("esri.widgets.FeatureTemplates"),g={filter:!0};return function(f){function c(a,c){a=f.call(this,a,c)||this;
a._iconIntersectionObserver=new IntersectionObserver(function(a,c){a.forEach(function(a){if(a.isIntersecting){var b=a.target;if(!b["data-has-icon"]){b["data-has-icon"]=!0;var h=b["data-item"];h.fetchThumbnail().then(function(){h.thumbnail&&b.appendChild(h.thumbnail)})}c.unobserve(b)}})});a.filterFunction=null;a.filterText="";a.groupBy=null;a.label=void 0;a.layers=null;a.messages=null;a.viewModel=new q;a.visibleElements=b.__assign({},g);a.renderItemIcon=a.renderItemIcon.bind(a);a._afterItemCreateOrUpdate=
a._afterItemCreateOrUpdate.bind(a);a._afterItemRemoved=a._afterItemRemoved.bind(a);return a}b.__extends(c,f);c.prototype.initialize=function(){var a=this,b=function(b){b=b.label;return!a.filterText||-1<b.toLowerCase().indexOf(a.filterText.toLowerCase())};this.own(n.init(this,"viewModel",function(c,d){c&&!c.filterFunction&&(a.filterFunction=b);d&&d!==c&&d.filterFunction===b&&(d.filterFunction=null)}))};c.prototype.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),
this._iconIntersectionObserver=null)};Object.defineProperty(c.prototype,"filterEnabled",{set:function(a){k.deprecatedProperty(u,"filterEnabled",{replacement:"visibleElements.filter",version:"4.15"});this.visibleElements=b.__assign(b.__assign({},this.visibleElements),{filter:a})},enumerable:!1,configurable:!0});c.prototype.castVisibleElements=function(a){return b.__assign(b.__assign({},g),a)};c.prototype.render=function(){var a=this,b=this.filterText,c=this.messages,d=this.viewModel,f=d.items,d=d.state,
g=this.visibleElements.filter;return e.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":c.widgetLabel},"loading"===d?this.renderLoader():"ready"===d?r.ItemList({id:this.id,identify:t,filterText:b,items:f,messages:{filterPlaceholder:c.filterPlaceholder,noItems:c.noItems,noMatches:c.noMatches},filterEnabled:g,onItemSelect:function(b){a.viewModel.select(b)},onFilterChange:function(b){a.filterText=b;a.viewModel.refresh()},renderIcon:this.renderItemIcon}):null)};c.prototype.renderItemIcon=
function(a){return e.tsx("span",{key:"icon",class:"esri-feature-templates__list-item-icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":a.item,"data-has-icon":!1})};c.prototype.renderLoader=function(){return e.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};c.prototype._afterItemCreateOrUpdate=function(a){this._iconIntersectionObserver.observe(a)};c.prototype._afterItemRemoved=function(a){this._iconIntersectionObserver.unobserve(a)};
b.__decorate([d.property(),e.renderable()],c.prototype,"filterEnabled",null);b.__decorate([d.aliasOf("viewModel.filterFunction")],c.prototype,"filterFunction",void 0);b.__decorate([d.property(),e.renderable()],c.prototype,"filterText",void 0);b.__decorate([d.aliasOf("viewModel.groupBy")],c.prototype,"groupBy",void 0);b.__decorate([d.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],c.prototype,"label",void 0);b.__decorate([d.aliasOf("viewModel.layers")],c.prototype,"layers",void 0);
b.__decorate([d.property(),e.renderable(),e.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],c.prototype,"messages",void 0);b.__decorate([d.property(),e.renderable(["viewModel.items","viewModel.state"]),e.vmEvent("select")],c.prototype,"viewModel",void 0);b.__decorate([d.property(),e.renderable()],c.prototype,"visibleElements",void 0);b.__decorate([d.cast("visibleElements")],c.prototype,"castVisibleElements",null);return c=b.__decorate([d.subclass("esri.widgets.FeatureTemplates")],
c)}(l.HandleOwnerMixin(p))});