// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../intl ../core/Collection ../core/domUtils ../core/Evented ../core/Handles ../core/Logger ../core/Promise ../core/promiseUtils ../core/watchUtils ../core/accessorSupport/decorators ../libs/maquette/index ./support/widget".split(" "),function(A,B,b,h,k,n,p,q,r,t,l,g,d,u,v){var w=r.getLogger("esri.widgets.Widget"),x=0,y=u.createProjector();return function(m){function a(e,a){var c=m.call(this,e,a)||this;c._attached=!1;c._internalHandles=new q;c._projector=y;c.domNode=null;
c.iconClass="esri-icon-checkbox-unchecked";c.label=c.declaredClass.split(".").pop();c.visible=!0;c._loadLocale=l.debounce(function(){return b.__awaiter(c,void 0,void 0,function(){var e=this;return b.__generator(this,function(a){switch(a.label){case 0:return this._messageBundleProps&&this._messageBundleProps.length?[4,l.eachAlways(this._messageBundleProps.map(function(a){var c=a.bundlePath,f=a.propertyName;return b.__awaiter(e,void 0,void 0,function(){var a,e;return b.__generator(this,function(b){switch(b.label){case 0:return a=
this,e=f,[4,h.loadMessageBundle(c)];case 1:return a[e]=b.sent(),[2]}})})})).then(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.error&&w.error("widget-intl:locale-error",e.declaredClass,c.error)}})]:[3,2];case 1:a.sent(),a.label=2;case 2:return[4,this.loadLocale()];case 3:return a.sent(),[2]}})})});var f="esri-widget-uid-"+Date.now().toString(16),z=c.render.bind(c),d=!1;c.render=function(){if(!d||c.destroyed)return null;var a=z();a.properties?a.properties.key||(a.properties.key=f):a.properties=
{key:f};return a};c.addResolvingPromise(c._resourcesFetch=c.beforeFirstRender().then(function(){d=!0;c._postInitialize()}));return c}b.__extends(a,m);a.prototype.normalizeCtorArgs=function(a,d){a=b.__assign({},a);d&&(a.container=d);return a};a.prototype.postInitialize=function(){};a.prototype.beforeFirstRender=function(){return this._loadLocale()};a.prototype.loadLocale=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(a){return[2]})})};a.prototype.destroy=
function(){this.destroyed||(this.viewModel&&(this.viewModel.destroy(),this.viewModel=null),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=function(){return null},this._projector=null)};Object.defineProperty(a.prototype,"container",{set:function(a){this._get("container")||this._set("container",a)},enumerable:!1,configurable:!0});a.prototype.castContainer=function(a){return n.byId(a)};Object.defineProperty(a.prototype,"id",
{get:function(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+x++},set:function(a){a&&this._set("id",a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"renderable",{get:function(){return this._resourcesFetch},enumerable:!1,configurable:!0});a.prototype.render=function(){throw Error("not implemented");};a.prototype.scheduleRender=function(){this.destroyed||this._projector.scheduleRender()};a.prototype.classes=function(){for(var a=[],b=0;b<
arguments.length;b++)a[b]=arguments[b];return v.classes.apply(this,a)};a.prototype.own=function(a){1<arguments.length&&(a=Array.prototype.slice.call(arguments));this._internalHandles.add(a)};a.prototype.renderNow=function(){this._projector.renderNow()};a.prototype._postInitialize=function(){var a=this,d,c;this.destroyed||((null===(d=this._renderableProps)||void 0===d?0:d.length)&&this._internalHandles.add(this._renderableProps.map(function(b){return g.init(a,b,function(a,c){var d=this;k.isCollection(c)&&
this._internalHandles.remove(this.declaredClass+":"+b+"-collection-change-event-listener");k.isCollection(a)&&(a=a.on("change",function(){return d.scheduleRender()}),this._internalHandles.add(a,this.declaredClass+":"+b+"-collection-change-event-listener"));this.scheduleRender()})})),(null===(c=this._delegatedEventNames)||void 0===c?0:c.length)&&this._internalHandles.add(g.init(this,"viewModel",function(b,c){c&&a._internalHandles.remove("delegated-events");b&&a._internalHandles.add(a._delegatedEventNames.map(function(c){return b.on(c,
function(b){a.emit(c,b)})}),"delegated-events")})),this.postInitialize(),this._internalHandles.add(h.onLocaleChange(function(){return b.__awaiter(a,void 0,void 0,function(){return b.__generator(this,function(a){switch(a.label){case 0:return[4,this._loadLocale()];case 1:return a.sent(),this.scheduleRender(),[2]}})})})),this._internalHandles.add(g.whenOnce(this,"container",function(c){return b.__awaiter(a,void 0,void 0,function(){return b.__generator(this,function(a){if(this.destroyed)return[2];this._attach(c);
return[2]})})})))};a.prototype._attach=function(a){a&&(this._projector.merge(a,this.render),this._attached=!0)};a.prototype._detach=function(a){a&&this._attached&&(this._projector.detach(this.render),a.parentNode&&a.parentNode.removeChild(a),this._attached=!1)};b.__decorate([d.property({value:null})],a.prototype,"container",null);b.__decorate([d.cast("container")],a.prototype,"castContainer",null);b.__decorate([d.property({aliasOf:"container"})],a.prototype,"domNode",void 0);b.__decorate([d.property()],
a.prototype,"iconClass",void 0);b.__decorate([d.property({dependsOn:["container"]})],a.prototype,"id",null);b.__decorate([d.property()],a.prototype,"label",void 0);b.__decorate([d.property()],a.prototype,"renderable",null);b.__decorate([d.property()],a.prototype,"viewModel",void 0);b.__decorate([d.property()],a.prototype,"visible",void 0);return a=b.__decorate([d.subclass("esri.widgets.Widget")],a)}(t.EsriPromiseMixin(p.EventedAccessor))});