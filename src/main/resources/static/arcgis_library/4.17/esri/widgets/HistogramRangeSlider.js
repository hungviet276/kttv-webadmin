// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../Color ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Histogram ./Slider ./Widget ./HistogramRangeSlider/HistogramRangeSliderViewModel ./smartMapping/support/utils ./support/widget".split(" "),function(u,v,d,h,k,e,l,n,p,q,r,t,f){return function(m){function a(b,g){b=m.call(this,b,g)||this;b._barElements=[];b._histogram=null;b._slider=null;b.average=null;b.barCreatedFunction=null;b.bins=null;b.dataLines=null;b.dataLineCreatedFunction=
null;b.excludedBarColor=new h("#d7e5f0");b.hasTimeData=null;b.includedBarColor=new h("#599dd4");b.label=void 0;b.labelFormatFunction=null;b.max=null;b.messages=null;b.min=null;b.precision=4;b.rangeType=null;b.standardDeviation=null;b.standardDeviationCount=1;b.values=null;b.viewModel=new r;return b}d.__extends(a,m);a.prototype.initialize=function(){var b=this,g=this.average,a=this.bins,c=this.hasTimeData,d=this.max,e=this.min,f=this.viewModel;this._updateBarFill=this._updateBarFill.bind(this);this._histogram=
new n({average:g,bins:a,barCreatedFunction:function(a,g){0===a&&(b._barElements=[]);b._barElements.push(g);b._updateBarFill(a,g);b.barCreatedFunction&&b.barCreatedFunction(a,g)},dataLines:this._getDataLines(),dataLineCreatedFunction:function(a,g){b.dataLineCreatedFunction&&b.dataLineCreatedFunction(a,g)},labelFormatFunction:this.labelFormatFunction,layout:"horizontal",max:d,min:e});this._slider=new p({labelFormatFunction:this.labelFormatFunction,layout:"horizontal",visibleElements:{labels:!0,rangeLabels:!0},
rangeLabelInputsEnabled:!c,viewModel:f});this.own(this._slider.on(["max-change","min-change"],function(a){return b.emit(a.type,a)}),this._slider.on(["segment-drag","thumb-change","thumb-drag"],function(a){b._updateBarFills();b.emit(a.type,a)}),k.watch(this,"bins",function(){var a=b._histogram,g=b.bins;if(g&&a.bins){var c=a.bins.length-g.length;b._barElements.splice(-c,c)}else b._barElements=[];a.set({bins:g});b._updateBarFills();b.scheduleRender()}),k.watch(this,["max","min","rangeType","values"],
function(){b._histogram.set({max:b.max,min:b.min});b._updateBarFills();b.scheduleRender()}),k.watch(this,["average","dataLines","standardDeviation","standardDeviationCount"],function(){b._histogram.set({average:b.average,dataLines:b._getDataLines()})}),k.watch(this,"labelFormatFunction",function(){b._histogram.set({labelFormatFunction:b.labelFormatFunction})}),k.watch(this,"hasTimeData",function(){b._slider.set({rangeLabelInputsEnabled:!b.hasTimeData})}))};a.prototype.generateWhereClause=function(b){return this.viewModel.generateWhereClause(b)};
a.prototype.render=function(){var b=this.viewModel,a=this.label,d=this.classes("esri-histogram-range-slider","esri-widget","esri-histogram-range-slider__range-type--"+this.rangeType,"disabled"===b.state?"esri-disabled":null);return f.tsx("div",{"aria-label":a,class:d},"disabled"===b.state?null:this.renderContent())};a.prototype.renderContent=function(){return[this.renderHistogram(),this.renderSlider()]};a.prototype.renderSlider=function(){return f.tsx("div",{key:this.id+"-slider-container",class:"esri-histogram-range-slider__slider-container"},
this._slider.render())};a.prototype.renderHistogram=function(){return f.tsx("div",{class:"esri-histogram-range-slider__histogram-container"},this._histogram.render())};a.prototype._getDataLines=function(){return d.__spreadArrays(this._getStandardDeviationDataLines(),this.dataLines||[])};a.prototype._getStandardDeviationDataLines=function(){return t.getDeviationValues(this.standardDeviation,this.average,this.standardDeviationCount).map(function(b){return{value:b}})};a.prototype._updateBarFills=function(){var b=
this;this._barElements.forEach(function(a,d){return b._updateBarFill(d,a)})};a.prototype._updateBarFill=function(b,a){a.setAttribute("fill",this._getFillForBar(b).toHex())};a.prototype._getFillForBar=function(b){var a=this.bins,d=this.rangeType,c=this.values;if(!(a&&a.length&&d&&c.length))return null;a=a[b];if(!a)return null;b=a.maxValue;var a=a.minValue,e=b-a;switch(d){case "equal":case "not-equal":return this.includedBarColor;case "less-than":case "at-most":return c[0]>a&&c[0]<b?this._getBlendedColor((c[0]-
a)/e):a<c[0]?this.includedBarColor:this.excludedBarColor;case "greater-than":case "at-least":return c[0]>a&&c[0]<b?this._getBlendedColor(1-(c[0]-a)/e):a>c[0]?this.includedBarColor:this.excludedBarColor;case "between":if(2===c.length)return c[0]>a&&c[0]<b?this._getBlendedColor(1-(c[0]-a)/e):c[1]>a&&c[1]<b?this._getBlendedColor((c[1]-a)/e):a>=c[0]&&b<=c[1]?this.includedBarColor:this.excludedBarColor;case "not-between":if(2===c.length)return c[0]>a&&c[0]<b?this._getBlendedColor((c[0]-a)/e):c[1]>a&&c[1]<
b?this._getBlendedColor(1-(c[1]-a)/e):a>c[0]&&b<c[1]?this.excludedBarColor:this.includedBarColor;default:return this.includedBarColor}};a.prototype._getBlendedColor=function(a){return h.blendColors(this.excludedBarColor,this.includedBarColor,a)};d.__decorate([e.aliasOf("viewModel.average")],a.prototype,"average",void 0);d.__decorate([e.property(),f.renderable()],a.prototype,"barCreatedFunction",void 0);d.__decorate([e.aliasOf("viewModel.bins")],a.prototype,"bins",void 0);d.__decorate([e.property(),
f.renderable()],a.prototype,"dataLines",void 0);d.__decorate([e.property(),f.renderable()],a.prototype,"dataLineCreatedFunction",void 0);d.__decorate([e.property({type:h,json:{type:[l.Integer],write:!0}})],a.prototype,"excludedBarColor",void 0);d.__decorate([e.aliasOf("viewModel.hasTimeData")],a.prototype,"hasTimeData",void 0);d.__decorate([e.property({type:h,json:{type:[l.Integer],write:!0}})],a.prototype,"includedBarColor",void 0);d.__decorate([e.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],a.prototype,"label",void 0);d.__decorate([e.aliasOf("viewModel.labelFormatFunction")],a.prototype,"labelFormatFunction",void 0);d.__decorate([e.aliasOf("viewModel.max")],a.prototype,"max",void 0);d.__decorate([e.property(),f.renderable(),f.messageBundle("esri/widgets/HistogramRangeSlider/t9n/HistogramRangeSlider")],a.prototype,"messages",void 0);d.__decorate([e.aliasOf("viewModel.min")],a.prototype,"min",void 0);d.__decorate([e.aliasOf("viewModel.precision")],a.prototype,"precision",
void 0);d.__decorate([e.aliasOf("viewModel.rangeType")],a.prototype,"rangeType",void 0);d.__decorate([e.aliasOf("viewModel.standardDeviation")],a.prototype,"standardDeviation",void 0);d.__decorate([e.property(),f.renderable()],a.prototype,"standardDeviationCount",void 0);d.__decorate([f.renderable(),e.aliasOf("viewModel.values")],a.prototype,"values",void 0);d.__decorate([e.property(),f.renderable("viewModel.average viewModel.hasTimeData viewModel.labelFormatFunction viewModel.max viewModel.min viewModel.precision viewModel.rangeType viewModel.standardDeviation viewModel.values".split(" "))],
a.prototype,"viewModel",void 0);return a=d.__decorate([e.subclass("esri.widgets.HistogramRangeSlider")],a)}(q)});