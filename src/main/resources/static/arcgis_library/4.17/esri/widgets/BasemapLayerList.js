// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../core/Collection ../core/deprecate ../core/events ../core/HandleOwner ../core/has ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ../libs/sortablejs/Sortable ./Widget ./BasemapLayerList/BasemapLayerListViewModel ./LayerList/ListItem ./LayerList/support/layerListUtils ./support/widget".split(" "),function(M,N,f,B,C,D,E,F,G,p,k,x,H,y,I,w,d){function v(d){var b=d.children;d.actionsOpen&&(d.actionsOpen=!1);b.forEach(function(a){return v(a)})}var J=
B.ofType(I),K=G.getLogger("esri.widgets.BasemapLayerList"),A={baseLayers:!0,referenceLayers:!0,statusIndicators:!0};return function(z){function b(a,c){a=z.call(this,a,c)||this;a._editingTitle=!1;a._editTitleInput=null;a._editTitleButton=null;a._focusOnElement=null;a._sortableBaseLayers=null;a._sortableReferenceLayers=null;a._sortableBaseLayersNode=null;a._sortableReferenceLayersNode=null;a._focusSortUid=null;a._newUI=F("esri-basemaplayerlist-new-ui");a.basemapTitle=null;a.baseListItemCreatedFunction=
null;a.editingEnabled=!1;a.iconClass="esri-icon-layers";a.label=void 0;a.messages=null;a.messagesCommon=null;a.multipleSelectionEnabled=!1;a.referenceListItemCreatedFunction=null;a.baseItems=null;a.referenceItems=null;a.selectedItems=new J;a.view=null;a.viewModel=new y;a.visibleElements=f.__assign({},A);return a}f.__extends(b,z);b.prototype.initialize=function(){var a=this,c=this.baseItems,h=this.referenceItems;this.own([p.on(this,"baseItems","change",function(){a._itemsChanged(c,"base-items");a._toggleSortingBaseLayers()}),
p.on(this,"referenceItems","change",function(){return a._itemsChanged(h,"reference-items")}),p.init(this,"editingEnabled",function(){return a._toggleSorting()})])};b.prototype.destroy=function(){this._destroyBaseSortable();this._destroyReferenceSortable()};Object.defineProperty(b.prototype,"statusIndicatorsVisible",{set:function(a){C.deprecatedProperty(K,"statusIndicatorsVisible",{replacement:"visibleElements.statusIndicators",version:"4.15"});this.visibleElements=f.__assign(f.__assign({},this.visibleElements),
{statusIndicators:a})},enumerable:!1,configurable:!0});b.prototype.castVisibleElements=function(a){return f.__assign(f.__assign({},A),a)};b.prototype.triggerAction=function(a,c){this.viewModel.triggerAction(a,c)};b.prototype.render=function(){var a,c=this.viewModel.state,c=(a={},a["esri-basemap-layer-list--new-ui"]=this._newUI,a["esri-hidden"]="loading"===c,a["esri-disabled"]="disabled"===c,a);a=this.renderReferenceSection();var h=this.renderBaseSection(),e=a&&h?d.tsx("hr",{class:"esri-basemap-layer-list__hr"}):
null;return d.tsx("div",{class:this.classes("esri-basemap-layer-list esri-widget esri-widget--panel",c)},this.renderTitleContainer(),a,e,h)};b.prototype.renderEditingInput=function(){var a=this.messages;return d.tsx("label",{class:"esri-basemap-layer-list__editing-input"},a.basemapTitle,d.tsx("input",{bind:this,class:"esri-input",title:a.basemapTitle,"aria-label":a.basemapTitle,placeholder:a.basemapTitle,type:"text",role:"textbox",value:this.viewModel.basemapTitle,afterCreate:this._storeEditTitleInput,
afterUpdate:this._focusEditElement}))};b.prototype.renderCancelButton=function(){var a=this.messagesCommon;return d.tsx("button",{title:a.cancel,"aria-label":a.cancel,type:"button",bind:this,class:this.classes("esri-button","esri-button--tertiary"),onclick:this._toggleEditingTitle},a.cancel)};b.prototype.renderSubmitButton=function(){var a=this.messagesCommon;return d.tsx("button",{title:a.form.submit,"aria-label":a.form.submit,type:"button",bind:this,class:"esri-button",onclick:this._formSubmit},
a.form.ok)};b.prototype.renderEditingForm=function(){return d.tsx("div",{class:"esri-basemap-layer-list__editing-card"},d.tsx("form",{bind:this,onsubmit:this._formSubmit},this.renderEditingInput(),d.tsx("div",{class:"esri-basemap-layer-list__editing-actions"},this.renderCancelButton(),this.renderSubmitButton())))};b.prototype.renderBasemapTitle=function(){var a=this.viewModel.basemapTitle;return d.tsx("h2",{class:this.classes("esri-widget__heading","esri-basemap-layer-list__main-heading")},a)};b.prototype.renderEditTitleButton=
function(){var a=this._editingTitle,c=this.messagesCommon;return this.editingEnabled&&!a?d.tsx("button",{bind:this,class:"esri-basemap-layer-list__edit-button",title:c.edit,"aria-label":c.edit,onclick:this._toggleEditingTitle,afterCreate:this._storeEditTitleButton,afterUpdate:this._focusEditElement,"data-node-ref":"_editButtonNode"},d.tsx("span",{"aria-hidden":"true",class:this.classes("esri-icon-edit","esri-basemap-layer-list__edit-button-icon")})):null};b.prototype.renderTitleContainer=function(){return d.tsx("div",
{class:"esri-basemap-layer-list__title-container"},this._editingTitle?this.renderEditingForm():this.renderBasemapTitle(),this.renderEditTitleButton())};b.prototype.renderNoLayersInfo=function(a,c){return d.tsx("div",{key:c,class:"esri-basemap-layer-list__no-items"},a)};b.prototype.renderList=function(a,c){var h=this;return d.tsx("ul",{key:c,"aria-label":this.messages.widgetLabel,role:this.editingEnabled&&a.length?"listbox":void 0,afterCreate:this._sortNodeCreated,afterRemoved:"reference"===c?this._destroyReferenceSortable:
this._destroyBaseSortable,"data-node-ref":c,bind:this,class:this.classes("esri-basemap-layer-list__list","esri-basemap-layer-list__list--root","esri-basemap-layer-list__list--independent")},a.map(function(e){return h.renderItem({item:e,parent:null,itemType:c,isOnlyChild:1===a.length})}))};b.prototype.renderBaseHeader=function(){return d.tsx("h3",{key:"base-heading",class:this.classes("esri-widget__heading","esri-basemap-layer-list__list-heading")},this.messages.baseHeading)};b.prototype.renderBaseSection=
function(){var a=this.messages;if(!this.visibleElements.baseLayers)return null;var c=this._getItems(this.baseItems);return[this.renderBaseHeader(),[0===c.length?this.renderNoLayersInfo(a.noBaseLayers,"base"):null,this.renderList(c,"base")]]};b.prototype.renderReferenceHeader=function(){return d.tsx("h3",{key:"reference-heading",class:this.classes("esri-widget__heading","esri-basemap-layer-list__list-heading")},this.messages.referenceHeading)};b.prototype.renderReferenceSection=function(){var a=this.messages;
if(!this.visibleElements.referenceLayers)return null;var c=this._getItems(this.referenceItems);return[this.renderReferenceHeader(),[0===c.length?this.renderNoLayersInfo(a.noReferenceLayers,"reference"):null,this.renderList(c,"reference")]]};b.prototype.renderChildrenToggle=function(a,c){var h,e=this.messagesCommon,b=!!a.error,b=!!a.children.length&&!b,g=(h={},h["esri-basemap-layer-list__child-toggle--open"]=a.open,h);h=a.open?e.collapse:e.expand;return b?d.tsx("span",{onclick:this._toggleChildrenClick,
onkeydown:this._toggleChildrenClick,"data-item":a,key:"toggle-children",class:this.classes("esri-basemap-layer-list__child-toggle",g),tabindex:"0",role:"button","aria-controls":c,"aria-label":h,title:h},d.tsx("span",{"aria-hidden":"true",class:this.classes("esri-basemap-layer-list__child-toggle-icon--closed","esri-icon-right-triangle-arrow")}),d.tsx("span",{"aria-hidden":"true",class:this.classes("esri-basemap-layer-list__child-toggle-icon--opened","esri-icon-down-arrow")}),d.tsx("span",{"aria-hidden":"true",
class:this.classes("esri-basemap-layer-list__child-toggle-icon--closed-rtl","esri-icon-left-triangle-arrow")})):null};b.prototype.renderError=function(a){return a.error?d.tsx("div",{key:"error",class:"esri-basemap-layer-list__item-error-message",role:"alert"},d.tsx("span",null,this.messages.layerError)):null};b.prototype.renderActionsMenuIcon=function(a,c){var h,b=this.messagesCommon,l=(h={},h["esri-basemap-layer-list__item-actions-menu-item--active"]=a.actionsOpen,h);h=a.actionsOpen?b.close:b.open;
return d.tsx("div",{key:"actions-menu-toggle","data-item":a,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes("esri-basemap-layer-list__item-actions-menu-item",l),tabindex:"0",role:"button","aria-controls":c,"aria-label":h,title:h},d.tsx("span",{"aria-hidden":"true",class:"esri-icon-handle-horizontal"}))};b.prototype.renderActionsMenu=function(a,c,h,b){var e=a.panel,e=e&&e.visible?this.renderPanelButton(e):null,g=(c=1===h&&this._getSingleActionButton(c))?
this.renderAction({item:a,action:c,singleAction:!0}):null;return(a=!c&&h?this.renderActionsMenuIcon(a,b):null)||e||c?d.tsx("div",{key:"actions-menu",class:"esri-basemap-layer-list__item-actions-menu"},e,g,a):null};b.prototype.renderChildList=function(a,c){var h,b=this,l=this.editingEnabled,g=a.visibilityMode,f=a.children,k=!!a.error,k=!!f.length&&!k,m=(h={},h["esri-basemap-layer-list__list--exclusive"]="exclusive"===g,h["esri-basemap-layer-list__list--inherited"]="inherited"===g,h["esri-basemap-layer-list__list--independent"]=
"inherited"!==g&&"exclusive"!==g,h);return k?d.tsx("ul",{bind:this,key:"list-items",id:c,"data-group":a.uid,"data-item":a,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,class:this.classes("esri-basemap-layer-list__list",m),"aria-expanded":a.open?"true":"false",role:l?"listbox":"exclusive"===g?"radiogroup":"group",hidden:a.open?null:!0},null===f||void 0===f?void 0:f.map(function(c){return b.renderItem({item:c,parent:a})}).toArray()):null};b.prototype.renderItemContent=function(a,
c,h){var b=this.id+"_"+a.uid,l=b+"_actions",b=b+"__list",g=a.panel,f=this._filterActions(a.actionsSections),k=this._countActions(f);return[d.tsx("div",{key:"list-item-container",class:"esri-basemap-layer-list__item-container"},this.renderChildrenToggle(a,b),this.renderLabel(a,c,h),this.renderActionsMenu(a,f,k,l)),this.renderError(a),k?this.renderActionsSections(a,f,l):null,g&&g.open?g.render():null,this.renderChildList(a,b)]};b.prototype.renderItem=function(a){var c,h,b,l,g=a.item,k=a.parent,r=a.itemType;
a=a.isOnlyChild;var m=this._newUI,n=this.editingEnabled,L=this.selectedItems,t=this.visibleElements,q=this.id+"_"+g.uid+"__title",u=!!g.error,p=!!g.children.length&&!u,m=(c={},c["esri-basemap-layer-list__item--has-children"]=p,c["esri-basemap-layer-list__item--error"]=!!u,c["esri-basemap-layer-list__item--updating"]=g.updating&&!k&&t.statusIndicators,c["esri-basemap-layer-list__item--invisible"]=m&&!g.visible,c["esri-basemap-layer-list__item--invisible-at-scale"]=!g.visibleAtCurrentScale,c["esri-basemap-layer-list__item--selectable"]=
n,c);return n?(c=(h={},h["data-layer-uid"]=null===(l=g.layer)||void 0===l?void 0:l.uid,h),d.tsx("li",f.__assign({key:"item-with-selection-"+g.uid,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes("esri-basemap-layer-list__item",m,(b={},b["esri-basemap-layer-list__item--only-child"]=a,b)),"aria-labelledby":q,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item-type":r,"data-item":g,tabIndex:0,"aria-selected":w.findSelectedItem(g,L)?"true":
"false",role:"option"},c),this.renderItemContent(g,k,q))):d.tsx("li",{key:"item-no-selection-"+g.uid,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes("esri-basemap-layer-list__item",m),"aria-labelledby":q},this.renderItemContent(g,k,q))};b.prototype.renderItemTitle=function(a,c){var b=this.messages,e=a.title||b.untitledLayer;a=a.visibleAtCurrentScale?e:e+" ("+b.layerInvisibleAtScale+")";return d.tsx("span",{key:"layer-title-container",id:c,title:a,"aria-label":a,
class:"esri-basemap-layer-list__item-title"},e)};b.prototype.renderItemToggleIcon=function(a,c){var b,e=this._newUI;c=c&&c.visibilityMode;a=(b={},b["esri-basemap-layer-list__item-toggle-icon"]=e,b["esri-basemap-layer-list__item-toggle-icon"]=e&&"exclusive"!==c,b["esri-basemap-layer-list__item-radio-icon"]=e&&"exclusive"===c,b["esri-icon-radio-checked"]="exclusive"===c&&a.visible,b["esri-icon-radio-unchecked"]="exclusive"===c&&!a.visible,b["esri-icon-visible"]="exclusive"!==c&&a.visible,b["esri-icon-non-visible"]=
"exclusive"!==c&&!a.visible,b);return d.tsx("span",{key:"item-toggle-icon",class:this.classes(a),"aria-hidden":"true"})};b.prototype.renderItemToggle=function(a,c,b){var h=c&&c.visibilityMode;return this.editingEnabled?d.tsx("span",{key:"item-toggle-selection-enabled",class:"esri-basemap-layer-list__item-toggle",bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":a,"data-parent-visibility":h,tabIndex:0,"aria-checked":a.visible?"true":"false",role:"exclusive"===h?
"radio":"switch","aria-labelledby":b},this.renderItemToggleIcon(a,c)):d.tsx("span",{key:"item-toggle",class:"esri-basemap-layer-list__item-toggle"},this.renderItemToggleIcon(a,c))};b.prototype.renderItemError=function(a){return a.error?d.tsx("span",{key:"notice-triangle","aria-hidden":"true",class:"esri-icon-notice-triangle"}):null};b.prototype.renderLabel=function(a,c,b){var h=this.editingEnabled,l=this._newUI,g=null===c||void 0===c?void 0:c.visibilityMode,f="exclusive"===g?"radio":"switch";c=[this.renderItemToggle(a,
c,b),this.renderItemTitle(a,b)];l&&c.reverse();h=h?d.tsx("div",{key:"item-label-no-selection-"+a.uid,class:"esri-basemap-layer-list__item-label"},c):d.tsx("div",{key:"item-label-with-selection-"+a.uid,class:"esri-basemap-layer-list__item-label",bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":a,"data-parent-visibility":g,tabIndex:0,"aria-checked":a.visible?"true":"false",role:f,"aria-labelledby":b},c);return"inherited"===g||a.error?d.tsx("div",{key:"item-label-container-"+
a.uid,class:"esri-basemap-layer-list__item-label"},this.renderItemError(a),this.renderItemTitle(a,b)):h};b.prototype.renderPanelButton=function(a){var c,b,e=a.className,l=a.open,g=a.title,e=a.image||e?e:"esri-icon-default-action",f=this._getIconImageStyles(a),l=(c={},c["esri-basemap-layer-list__item-actions-menu-item--active"]=l,c);c=(b={},b["esri-basemap-layer-list__item-action-image"]=!!f["background-image"],b);e&&(c[e]=!!e);return d.tsx("div",{key:a,bind:this,"data-panel":a,onclick:this._triggerPanel,
onkeydown:this._triggerPanel,class:this.classes("esri-basemap-layer-list__item-actions-menu-item",l),role:"button",tabindex:"0",title:g,"aria-label":g},d.tsx("span",{class:this.classes(c),styles:f}))};b.prototype.renderActionsSections=function(a,c,b){var h=this;c=c.toArray().map(function(c){return d.tsx("ul",{key:c,class:"esri-basemap-layer-list__item-actions-list"},h.renderActionSection(a,c))});return d.tsx("div",{role:"group","aria-expanded":a.actionsOpen?"true":"false",key:"actions-section",id:b,
class:"esri-basemap-layer-list__item-actions",hidden:a.actionsOpen?null:!0},c)};b.prototype.renderActionSection=function(a,c){var b=this;return(c&&c.toArray()).map(function(c){return b.renderAction({item:a,action:c})})};b.prototype.renderActionIcon=function(a){var c,b=a.active,e=a.className,l=this._getIconImageStyles(a);a="button"!==a.type||a.image||e?e:"esri-icon-default-action";e=(c={},c["esri-basemap-layer-list__item-action-image"]=!b&&!!l["background-image"],c["esri-icon-loading-indicator"]=b,
c["esri-rotating"]=b,c);a&&!b&&(e[a]=!0);return d.tsx("span",{key:"action-icon","aria-hidden":"true",class:this.classes("esri-basemap-layer-list__item-action-icon",e),styles:l})};b.prototype.renderActionTitle=function(a,c){return c?null:d.tsx("span",{key:"action-title",class:"esri-basemap-layer-list__item-action-title"},a)};b.prototype.renderAction=function(a){var c,b=a.item,e=a.action;a=a.singleAction;var l=e.active,g=e.disabled,f=e.title,l=(c={},c["esri-basemap-layer-list__item-actions-menu-item"]=
a&&"button"===e.type,c["esri-basemap-layer-list__item-action"]=l||!a&&"toggle"!==e.type,c["esri-basemap-layer-list__action-toggle"]=!l&&"toggle"===e.type,c["esri-basemap-layer-list__action-toggle--on"]=!l&&"toggle"===e.type&&e.value,c["esri-disabled-element"]=g,c);c=[this.renderActionIcon(e),this.renderActionTitle(f,a)];return a?d.tsx("div",{bind:this,"data-item":b,"data-action":e,role:"button",key:e,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",title:f,"aria-label":f},
c):d.tsx("li",{bind:this,"data-item":b,"data-action":e,key:e,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",role:"button",title:f,"aria-label":f},c)};b.prototype._filterActions=function(a){return a.map(function(a){return a.filter(function(a){return a.visible})})};b.prototype._destroyReferenceSortable=function(){var a=this._sortableReferenceLayers;(null===a||void 0===a?0:a.el)&&a.destroy();this._sortableReferenceLayersNode=null};b.prototype._destroyBaseSortable=function(){var a=
this._sortableBaseLayers;(null===a||void 0===a?0:a.el)&&a.destroy();this._sortableBaseLayersNode=null};b.prototype._toggleEditingTitle=function(){var a=!this._editingTitle;this._focusOnElement=(this._editingTitle=a)?"edit-input":"edit-button";this.scheduleRender()};b.prototype._storeEditTitleInput=function(a){this._editTitleInput=a;this._focusEditElement()};b.prototype._focusEditElement=function(){this._editTitleInput&&"edit-input"===this._focusOnElement&&(this._focusOnElement=null,this._editTitleInput.focus());
this._editTitleButton&&"edit-button"===this._focusOnElement&&(this._focusOnElement=null,this._editTitleButton.focus())};b.prototype._storeEditTitleButton=function(a){this._editTitleButton=a;this._focusEditElement()};b.prototype._formSubmit=function(a){a.preventDefault();if(a=this._editTitleInput)this.basemapTitle=a.value;this._toggleEditingTitle()};b.prototype._itemMovedList=function(a){this.viewModel.transferListItem({listItem:a.item["data-item"],from:a.from.dataset.nodeRef,to:a.to.dataset.nodeRef,
newIndex:a.newIndex})};b.prototype._toggleSortingBaseLayers=function(){var a=this,c=this._sortableBaseLayers,b=this._sortableBaseLayersNode;if(b){var e=!this.editingEnabled;if(c)c.option("disabled",e);else{var d=x.create(b,{dataIdAttr:"data-layer-uid",group:"root-layers",filter:".esri-basemap-layer-list__item--only-child",fallbackTolerance:4,disabled:e,onSort:function(){return a._sortLayersToItems({type:"base",itemIds:d.toArray()})},onAdd:function(c){return a._itemMovedList(c)},chosenClass:"esri-basemap-layer-list--chosen"});
this._sortableBaseLayers=d}}};b.prototype._toggleSortingReferenceLayers=function(){var a=this,c=this._sortableReferenceLayers,b=this._sortableReferenceLayersNode;if(b){var e=!this.editingEnabled;if(c)c.option("disabled",e);else{var d=x.create(b,{dataIdAttr:"data-layer-uid",group:"root-layers",disabled:e,fallbackTolerance:4,onSort:function(){return a._sortLayersToItems({type:"reference",itemIds:d.toArray()})},onAdd:function(c){return a._itemMovedList(c)},chosenClass:"esri-basemap-layer-list--chosen"});
this._sortableReferenceLayers=d}}};b.prototype._toggleSorting=function(){this._toggleSortingBaseLayers();this._toggleSortingReferenceLayers()};b.prototype._sortNodeCreated=function(a){var c=a.getAttribute("data-node-ref");"base"===c&&(this._sortableBaseLayersNode=a);"reference"===c&&(this._sortableReferenceLayersNode=a);this._toggleSorting()};b.prototype._getItems=function(a){var c=this;return a.toArray().filter(function(a){return c.errorsVisible||!a.error})};b.prototype._getSingleActionButton=function(a){return a.reduce(function(a){return a}).filter(function(a){return a&&
"button"===a.type}).getItemAt(0)};b.prototype._sortLayersToItems=function(a){var c=a.type,b=a.itemIds;(a="base"===c?this.get("view.map.basemap.baseLayers"):"reference"===c?this.get("view.map.basemap.referenceLayers"):null)&&a.sort(function(a,c){a=b.indexOf(a.uid);c=b.indexOf(c.uid);return a>c?-1:a<c?1:0})};b.prototype._focusListItem=function(a){var c,b=this._focusSortUid;a&&b&&(null===(c=a["data-item"].layer)||void 0===c?void 0:c.uid)===b&&(a.focus(),this._focusSortUid=null)};b.prototype._selectionKeydown=
function(a){var c,b,d,f,g,k,r=D.eventKey(a);if(-1===["ArrowDown","ArrowUp"].indexOf(r))this._toggleSelection(a);else{a.stopPropagation();var m=a.currentTarget,n=m["data-item"],m=m.dataset.itemType,p=this._sortableBaseLayers,t=this._sortableReferenceLayers;if(p="base"===m?p:"reference"===m?t:null){var t=w.findSelectedItem(n,this.selectedItems),q=p.toArray();a=q.indexOf(a.target.dataset.layerUid);var u=this.viewModel,v=u.baseItems,u=u.referenceItems;-1!==a&&("ArrowDown"===r?(r=a+1,(g=r>=q.length)&&
"reference"===m&&t?(this.viewModel.transferListItem({listItem:n,from:"reference",to:"base",newIndex:v.length}),this._focusSortUid=null===(c=n.layer)||void 0===c?void 0:c.uid,this.scheduleRender()):g&&"reference"===m?(n=v.getItemAt(0),this._focusSortUid=null===(b=null===n||void 0===n?void 0:n.layer)||void 0===b?void 0:b.uid,this.scheduleRender()):g||(t&&(q.splice(r,0,q.splice(a,1)[0]),p.sort(q),this._sortLayersToItems({type:m,itemIds:p.toArray()})),this._focusSortUid=null===(d=n.layer)||void 0===d?
void 0:d.uid,this.scheduleRender())):"ArrowUp"===r&&(r=a-1,(b=0>r)&&"base"===m&&t?1!==v.length&&(this.viewModel.transferListItem({listItem:n,from:"base",to:"reference",newIndex:0}),this._focusSortUid=null===(f=n.layer)||void 0===f?void 0:f.uid,this.scheduleRender()):b&&"base"===m?(n=u.getItemAt(u.length-1),this._focusSortUid=null===(g=null===n||void 0===n?void 0:n.layer)||void 0===g?void 0:g.uid,this.scheduleRender()):b||(t&&(q.splice(r,0,q.splice(a,1)[0]),p.sort(q),this._sortLayersToItems({type:m,
itemIds:p.toArray()})),this._focusSortUid=null===(k=n.layer)||void 0===k?void 0:k.uid,this.scheduleRender())))}}};b.prototype._watchActionSectionChanges=function(a,c){var b=this;this.handles.add(a.on("change",function(){return b.scheduleRender()}),c);a.forEach(function(a){return b._renderOnActionChanges(a,c)})};b.prototype._renderOnActionChanges=function(a,c){var b=this;"toggle"===a.type?this.handles.add([p.init(a,"className image id title visible value".split(" "),function(){return b.scheduleRender()})],
c):"slider"===a.type?this.handles.add([p.init(a,"className id title visible value displayValueEnabled max min step".split(" "),function(){return b.scheduleRender()})],c):this.handles.add([p.init(a,["className","image","id","title","visible"],function(){return b.scheduleRender()})],c)};b.prototype._renderOnItemChanges=function(a,c){var b=this;this.handles.add([p.init(a,"actionsOpen visible open updating title visibleAtCurrentScale error visibilityMode panel panel.title panel.content panel.className".split(" "),
function(){return b.scheduleRender()}),a.actionsSections.on("change",function(){return b.scheduleRender()}),a.children.on("change",function(){return b.scheduleRender()})],c);a.children.forEach(function(a){return b._renderOnItemChanges(a,c)});a.actionsSections.forEach(function(a){return b._watchActionSectionChanges(a,c)})};b.prototype._itemsChanged=function(a,c){var b=this;this.handles.remove(c);a.forEach(function(a){return b._renderOnItemChanges(a,c)});this.scheduleRender()};b.prototype._countActions=
function(a){return a.reduce(function(a,b){return a+b.length},0)};b.prototype._getIconImageStyles=function(a){a="esri.widgets.LayerList.ListItemPanel"===a.declaredClass||"esri.support.Action.ActionButton"===a.declaredClass||"esri.support.Action.ActionToggle"===a.declaredClass?a.image:null;return{"background-image":a?'url("'+a+'")':null}};b.prototype._toggleActionsOpen=function(a){a.stopPropagation();a=a.currentTarget["data-item"];var b=!a.actionsOpen,d=this.baseItems,e=this.referenceItems;b&&(d.forEach(function(a){return v(a)}),
e.forEach(function(a){return v(a)}));a.actionsOpen=b};b.prototype._triggerPanel=function(a){a.stopPropagation();if(a=a.currentTarget["data-panel"])a.open=!a.open};b.prototype._triggerAction=function(a){a.stopPropagation();var b=a.currentTarget;a=b["data-action"];b=b["data-item"];"toggle"===a.type&&(a.value=!a.value);this.triggerAction(a,b)};b.prototype._toggleVisibility=function(a){a.stopPropagation();var b=a.currentTarget;a=b.getAttribute("data-parent-visibility");b=b["data-item"];"exclusive"===
a&&b.visible||(b.visible=!b.visible)};b.prototype._toggleChildrenClick=function(a){a.stopPropagation();a=a.currentTarget["data-item"];a.open=!a.open};b.prototype._toggleSelection=function(a){a.stopPropagation();var b=this.selectedItems,d=this.multipleSelectionEnabled&&(a.metaKey||a.ctrlKey);a=a.currentTarget["data-item"];var e=w.findSelectedItem(a,b),f=b.length,g=e&&1===f;d?e?b.remove(e):b.add(a):f&&!g?(b.removeAll(),b.add(a)):e?b.remove(e):b.add(a)};f.__decorate([k.aliasOf("viewModel.basemapTitle")],
b.prototype,"basemapTitle",void 0);f.__decorate([k.aliasOf("viewModel.baseListItemCreatedFunction"),d.renderable()],b.prototype,"baseListItemCreatedFunction",void 0);f.__decorate([k.property(),d.renderable()],b.prototype,"editingEnabled",void 0);f.__decorate([k.property(),d.renderable()],b.prototype,"errorsVisible",void 0);f.__decorate([k.property()],b.prototype,"iconClass",void 0);f.__decorate([k.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],b.prototype,"label",void 0);f.__decorate([k.property(),
d.renderable(),d.messageBundle("esri/widgets/BasemapLayerList/t9n/BasemapLayerList")],b.prototype,"messages",void 0);f.__decorate([k.property(),d.renderable(),d.messageBundle("esri/t9n/common")],b.prototype,"messagesCommon",void 0);f.__decorate([k.property()],b.prototype,"multipleSelectionEnabled",void 0);f.__decorate([k.aliasOf("viewModel.referenceListItemCreatedFunction"),d.renderable()],b.prototype,"referenceListItemCreatedFunction",void 0);f.__decorate([k.aliasOf("viewModel.baseItems"),d.renderable()],
b.prototype,"baseItems",void 0);f.__decorate([k.aliasOf("viewModel.referenceItems"),d.renderable()],b.prototype,"referenceItems",void 0);f.__decorate([k.property(),d.renderable()],b.prototype,"selectedItems",void 0);f.__decorate([k.property(),d.renderable()],b.prototype,"statusIndicatorsVisible",null);f.__decorate([k.aliasOf("viewModel.view"),d.renderable()],b.prototype,"view",void 0);f.__decorate([d.vmEvent("trigger-action"),k.property({type:y}),d.renderable("viewModel.state")],b.prototype,"viewModel",
void 0);f.__decorate([k.property(),d.renderable()],b.prototype,"visibleElements",void 0);f.__decorate([k.cast("visibleElements")],b.prototype,"castVisibleElements",null);f.__decorate([d.accessibleHandler()],b.prototype,"_toggleActionsOpen",null);f.__decorate([d.accessibleHandler()],b.prototype,"_triggerPanel",null);f.__decorate([d.accessibleHandler()],b.prototype,"_triggerAction",null);f.__decorate([d.accessibleHandler()],b.prototype,"_toggleVisibility",null);f.__decorate([d.accessibleHandler()],
b.prototype,"_toggleChildrenClick",null);f.__decorate([d.accessibleHandler()],b.prototype,"_toggleSelection",null);return b=f.__decorate([k.subclass("esri.widgets.BasemapLayerList")],b)}(E.HandleOwnerMixin(H))});