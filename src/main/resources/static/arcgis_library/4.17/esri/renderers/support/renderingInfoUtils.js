// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../Color ../../core/maybe ../visualVariables/support/visualVariableUtils".split(" "),function(z,d,m,y,k,v){function p(c,b){if(!c||c.symbol)return null;b=b&&b.renderer;return c&&k.isSome(b)&&b.getObservationRenderer?b.getObservationRenderer(c):b}function w(c,b){if(k.isSome(c.symbol))return c.symbol;var a=p(c,b);return k.isSome(a)?a.getSymbol(c,b):null}function x(c,b){return m.__awaiter(this,void 0,void 0,function(){var a;return m.__generator(this,function(f){if(k.isSome(c.symbol))return[2,
c.symbol];a=p(c,b);return[2,k.isSome(a)&&a.getSymbolAsync(c,m.__assign(m.__assign({},b),{abortOptions:{signal:b.signal}}))]})})}Object.defineProperty(d,"__esModule",{value:!0});d.getDriverAxisSizeValueAny=d.getDriverAxisSizeValue=d.getRenderingInfoAsync=d.getSymbolAsync=d.getRenderingInfo=d.getSymbol=d.getRenderer=void 0;d.getRenderer=p;d.getSymbol=w;d.getRenderingInfo=function(c,b){var a=p(c,b),f=w(c,b);if(!f)return null;f={renderer:a,symbol:f};if(k.isNone(a)||!("visualVariables"in a)||!a.visualVariables)return f;
var e=["proportional","proportional","proportional"],d=0;for(c=v.getVisualVariableValues(a,c,b);d<c.length;d++)switch(a=c[d],b=a.variable,a=a.value,b.type){case "color":f.color=a.toRgba();break;case "size":if("outline"===b.target)f.outlineSize=a;else switch(a=b.useSymbolValue?"symbol-value":a,b.axis){case "width":e[0]=a;break;case "depth":e[1]=a;break;case "height":e[2]=a;break;case "width-and-depth":e[0]=e[1]=a;break;default:e[0]=e[1]=e[2]=a}break;case "opacity":f.opacity=a;break;case "rotation":switch(b.axis){case "tilt":f.tilt=
a;break;case "roll":f.roll=a;break;default:f.heading=a}}if("proportional"!==e[0]||"proportional"!==e[1]||"proportional"!==e[2])f.size=e;return f};d.getSymbolAsync=x;d.getRenderingInfoAsync=function(c,b){return m.__awaiter(this,void 0,void 0,function(){var a,d,e,k,g,r,t,u,h,l,q,n;return m.__generator(this,function(f){switch(f.label){case 0:return a=p(c,b),[4,x(c,b)];case 1:d=f.sent();if(!d)return[2,null];e={renderer:a,symbol:d};if(!(a&&"visualVariables"in a&&a.visualVariables))return[2,e];k=v.getVisualVariableValues(a,
c,b);g=["proportional","proportional","proportional"];r=0;for(t=k;r<t.length;r++)u=t[r],h=u.variable,l=u.value,"color"===h.type?e.color=y.toUnitRGBA(l):"size"===h.type?"outline"===h.target?e.outlineSize=l:(q=h.axis,n=h.useSymbolValue?"symbol-value":l,"width"===q?g[0]=n:"depth"===q?g[1]=n:"height"===q?g[2]=n:g[0]="width-and-depth"===q?g[1]=n:g[1]=g[2]=n):"opacity"===h.type?e.opacity=l:"rotation"===h.type&&"tilt"===h.axis?e.tilt=l:"rotation"===h.type&&"roll"===h.axis?e.roll=l:"rotation"===h.type&&(e.heading=
l);if(isFinite(g[0])||isFinite(g[1])||isFinite(g[2]))e.size=g;return[2,e]}})})};d.getDriverAxisSizeValue=function(c,b){void 0===b&&(b=0);c=c[b];return"number"===typeof c&&isFinite(c)?c:null};d.getDriverAxisSizeValueAny=function(c){for(var b=0;3>b;b++){var a=c[b];if("number"===typeof a)return isFinite(a)?a:0}return 0}});