// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../request ../core/accessorSupport/decorators ../geometry/SpatialReference ./Task ./support/AddressCandidate".split(" "),function(w,x,c,n,h,p,u,f){return function(m){function b(a){a=m.call(this,a)||this;a.outSpatialReference=null;a.url=null;return a}c.__extends(b,m);b.prototype.addressToLocations=function(a,e){var d=a.address,l=a.categories,g=a.countryCode,k=a.forStorage,b=a.location,h=a.locationType,v=a.magicKey,f=a.maxLocations,m=a.outFields;a=a.searchExtent;var p=
b?b.clone().normalize():null,r=a?a.shiftCentralMeridian():null,t=this.outSpatialReference,b=this.parsedUrl;a=this.requestOptions;l={f:"json",outSR:t?JSON.stringify(t.toJSON()):null,outFields:m?m.join(","):null,searchExtent:r?JSON.stringify(r.toJSON()):null,category:l?l.join(","):null,countryCode:g||null,magicKey:v||null,location:p,locationType:h||null,maxLocations:f||null,forStorage:k||null};d={query:this._encode(c.__assign(c.__assign(c.__assign({},b.query),d),l))};e=c.__assign(c.__assign(c.__assign({},
a),e),d);return n(b.path+"/findAddressCandidates",e).then(this._handleAddressToLocationsResponse)};b.prototype.suggestLocations=function(a,e){var d=this.parsedUrl,l=this.requestOptions,g=a.location,b=a.searchExtent,g=g?g.clone().normalize():null,b=b?b.shiftCentralMeridian():null;a={f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:b?JSON.stringify(b.toJSON()):null,category:a.categories?a.categories.join(","):null,countryCode:a.countryCode||null,location:g};a={query:this._encode(c.__assign(c.__assign({},
d.query),a))};e=c.__assign(c.__assign(c.__assign({},l),e),a);return n(d.path+"/suggest",e).then(this._handleSuggestLocationsResponse)};b.prototype.addressesToLocations=function(a,b){var d=this.outSpatialReference,e=this.parsedUrl,g=this.requestOptions,k=a.addresses,q=a.categories,h=a.locationType;a=a.countryCode;var f=[];Array.isArray(k)&&k.forEach(function(a){f.push({attributes:a})});d={category:q?q.join(","):null,sourceCountry:a||null,addresses:JSON.stringify({records:f}),locationType:h||null,f:"json",
outSR:d?JSON.stringify(d):null};d={query:this._encode(c.__assign(c.__assign({},e.query),d))};b=c.__assign(c.__assign(c.__assign({},g),b),d);return n(e.path+"/geocodeAddresses",b).then(this._handleAddressesToLocationsResponse)};b.prototype.locationToAddress=function(a,b){var d=a.locationType,e=(a=a.location)?a.clone().normalize():null,g="undefined"!==typeof e,k=this.outSpatialReference;a=this.parsedUrl;var f=this.requestOptions,d={outSR:k?JSON.stringify(k.toJSON()):null,location:g?JSON.stringify(e.toJSON()):
null,locationType:d||null,f:"json"},d={query:this._encode(c.__assign(c.__assign({},a.query),d))};b=c.__assign(c.__assign(c.__assign({},f),b),d);return n(a.path+"/reverseGeocode",b).then(this._handleLocationToAddressResponse)};b.prototype._handleAddressToLocationsResponse=function(a){a=a.data;if(!a)return[];var b=a.candidates,c=a.spatialReference;return b?b.map(function(a){if(a){var b=a.extent,d=a.location,e=b?b&&"number"===typeof b.xmin&&"number"===typeof b.ymin&&"number"===typeof b.xmax&&"number"===
typeof b.ymax:!0;if(d&&"number"===typeof d.x&&"number"===typeof d.y&&e)return b&&(b.spatialReference=c),d.spatialReference=c,f.fromJSON(a)}}):[]};b.prototype._handleSuggestLocationsResponse=function(a){return(a=a.data)?a.suggestions||[]:[]};b.prototype._handleAddressesToLocationsResponse=function(a){a=a.data;if(!a)return[];var b=a.locations,c=a.spatialReference;return b?b.map(function(a){var b=a.location;b&&(b.spatialReference=c);return f.fromJSON(a)}):[]};b.prototype._handleLocationToAddressResponse=
function(a){if(a=a.data){var b=a.address;return f.fromJSON({address:b&&b.Match_addr||"",attributes:b||{},location:a.location,score:100})}};c.__decorate([h.property({type:p})],b.prototype,"outSpatialReference",void 0);c.__decorate([h.property()],b.prototype,"url",void 0);return b=c.__decorate([h.subclass("esri.tasks.Locator")],b)}(u)});