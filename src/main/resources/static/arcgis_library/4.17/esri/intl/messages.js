// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../assets ../core/Error ../core/maybe ../core/promiseUtils ../core/SetUtils ./locale @dojo/framework/shim/Promise".split(" "),function(C,c,e,w,p,x,y,z,q){function r(a){if(!t.test(a))return null;var b=t.exec(a);a=b[1];b=b[2];b=a+(b?"-"+b.toUpperCase():"");return u.has(b)?b:u.has(a)?a:null}function A(a){return e.__awaiter(this,void 0,void 0,function(){var b,g,c,f,k,h,l,m,n;return e.__generator(this,function(d){switch(d.label){case 0:b=/^(.*)\/t9n\/(.*)$/g.exec(a);if(!b)throw new p("esri-intl:invalid-bundle",
'Missing "t9n" folder in locale bundle path "'+a+'"');g=b[1]+"/t9n/";c=b[2];f=q.getLocale();k=r(f);h=""+g+c+".json";l=k?""+g+c+"_"+k+".json":h;d.label=1;case 1:return d.trys.push([1,3,,8]),[4,v(l)];case 2:return m=d.sent(),[3,8];case 3:n=d.sent();if(l===h)throw n;d.label=4;case 4:return d.trys.push([4,6,,7]),[4,v(h)];case 5:return m=d.sent(),[3,7];case 6:throw d.sent(),new p("esri-intl:unknown-bundle",'Bundle "'+a+'" cannot be loaded',{error:n});case 7:return[3,8];case 8:return[2,m]}})})}function v(a){return e.__awaiter(this,
void 0,void 0,function(){var b;return e.__generator(this,function(g){switch(g.label){case 0:return x.isSome(c.test.fetchBundleAsset)?[2,c.test.fetchBundleAsset(a)]:[4,w.fetchAsset(a,{responseType:"json"})];case 1:return b=g.sent(),[2,b.data]}})})}Object.defineProperty(c,"__esModule",{value:!0});c.test=c.getKnownMessageBundleLocale=c.loadMessageBundle=void 0;var t=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,u=z.SetFromValues("ar bs ca cs da de el en es et fi fr he hi hr hu id it ja ko lt lv nb nl pl pt-BR pt-PT ro ru sl sr sv th tr uk vi zh-CN zh-HK zh-TW".split(" ")),
f=new Map;q.beforeLocaleChange(function(){f.clear()});c.loadMessageBundle=function(a){return e.__awaiter(this,void 0,void 0,function(){var b;return e.__generator(this,function(c){switch(c.label){case 0:return f.has(a)||f.set(a,A(a)),b=f.get(a),[4,B.add(b)];case 1:return c.sent(),[2,b]}})})};c.getKnownMessageBundleLocale=r;var B=new (function(){function a(){this._numLoading=0}a.prototype.waitForAll=function(){return e.__awaiter(this,void 0,void 0,function(){return e.__generator(this,function(b){switch(b.label){case 0:return this._dfd?
[4,this._dfd.promise]:[3,2];case 1:b.sent(),b.label=2;case 2:return[2]}})})};a.prototype.add=function(b){var a=this;this._increase();b.then(function(){return a._decrease()},function(){return a._decrease()});return this.waitForAll()};a.prototype._increase=function(){this._numLoading++;this._dfd||(this._dfd=y.createDeferred())};a.prototype._decrease=function(){this._numLoading=Math.max(this._numLoading-1,0);this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)};return a}());c.test={cache:f}});