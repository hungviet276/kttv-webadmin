// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../core/Accessor ../core/Error ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/decorators @dojo/framework/shim/Promise".split(" "),function(h,p,c,k,l,m,d,f,e){var n=m.getLogger("esri.portal.PortalItemResource");return function(g){function b(a){a=g.call(this,a)||this;a.portalItem=null;return a}c.__extends(b,g);b.prototype.normalizeCtorArgs=function(a){return a&&a.portalItem&&a.path?c.__assign(c.__assign({},a),{path:this.normalizePath(a.path,a.portalItem)}):
a};Object.defineProperty(b.prototype,"path",{set:function(a){d.isSome(a)&&f.isAbsolute(a)?n.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",a)},enumerable:!1,configurable:!0});b.prototype._castPath=function(a){return this.normalizePath(a,this.portalItem)};Object.defineProperty(b.prototype,"url",{get:function(){return this.portalItem&&this.path?this.portalItem.itemUrl+"/resources/"+this.path:null},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"itemRelativeUrl",{get:function(){return this.portalItem&&this.path?"./resources/"+this.path:null},enumerable:!1,configurable:!0});b.prototype.fetch=function(a,b){void 0===a&&(a="json");var c=this.url;if(d.isNone(c))throw new l("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(c,{responseType:a,signal:d.get(b,"signal")})};b.prototype.update=function(a,b){return c.__awaiter(this,void 0,void 0,function(){var d;return c.__generator(this,
function(c){switch(c.label){case 0:return[4,new Promise(function(a,b){h(["./support/resourceUtils"],a,b)})];case 1:return d=c.sent(),[2,d.addOrUpdateResource(this,"update",a,b)]}})})};b.prototype.hasPath=function(){return d.isSome(this.path)};b.prototype.normalizePath=function(a,b){if(d.isNone(a))return a;a=a.replace(/^\/+/,"");d.isSome(b)&&f.isAbsolute(a)&&(a=f.makeRelative(a,b.itemUrl));return a.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")};c.__decorate([e.property()],b.prototype,"portalItem",
void 0);c.__decorate([e.property({type:String,value:null})],b.prototype,"path",null);c.__decorate([e.cast("path")],b.prototype,"_castPath",null);c.__decorate([e.property({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],b.prototype,"url",null);c.__decorate([e.property({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],b.prototype,"itemRelativeUrl",null);return b=c.__decorate([e.subclass("esri.portal.PortalItemResource")],b)}(k)});