// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(z,a,r,q,k,c,e,b){function p(a,m){return a?m?4:3:m?3:2}function u(a,m,n,g){if(a){if(n)return m&&g?ha:T;if(m&&g)return ea}else if(m&&g)return T;return Z}function x(a,m){return Math.round((m-a.translate[0])/a.scale[0])}function d(a,m){return Math.round((a.translate[1]-
m)/a.scale[1])}function y(a,m){return m*a.scale[0]+a.translate[0]}function v(a,m){return a.translate[1]-m*a.scale[1]}function n(a){a=a.coords;return{x:a[0],y:a[1]}}function G(a,m){a.coords[0]=m.x;a.coords[1]=m.y;return a}function F(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function C(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.z;return a}function g(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function t(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.m;return a}function l(a){a=a.coords;return{x:a[0],
y:a[1],z:a[2],m:a[3]}}function H(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.z;a.coords[3]=m.m;return a}function O(a,m){return a&&m?H:a?C:m?t:G}function D(a,m,n,g,d){n=O(n,g);for(g=0;g<m.length;g++){var l=m[g],v=l.geometry,l=l.attributes,w=void 0;v&&(w=n(new b.default,v));a.push(new c.default(w,l,null,l[d]))}return a}function M(a,m,n,g){for(var d=0;d<m.length;d++){var b=m[d],c=b.geometry,b=b.attributes,l=void 0;c&&(l=N(c,n,g));a.push({attributes:b,geometry:l})}return a}function N(a,m,n){if(!a)return null;
for(var g=p(m,n),d=[],b=0;b<a.coords.length;b+=g){for(var c=[],l=0;l<g;l++)c.push(a.coords[b+l]);d.push(c)}return m?n?{points:d,hasZ:m,hasM:n}:{points:d,hasZ:m}:n?{points:d,hasM:n}:{points:d}}function J(a,m,n,g,d){n=p(n,g);for(g=0;g<m.length;g++){var l=m[g],v=l.geometry,l=l.attributes,w=void 0;v&&(w=I(new b.default,v,n));a.push(new c.default(w,l,null,l[d]))}return a}function I(a,m,n){void 0===n&&(n=p(m.hasZ,m.hasM));a.lengths[0]=m.points.length;var g=a.coords,d=0,b=0;for(m=m.points;b<m.length;b++)for(var c=
m[b],l=0;l<n;l++)g[d++]=c[l];return a}function w(a,m,n){if(!a)return null;var g=p(m,n),d=a.coords,b=[],l=0,c=0;for(a=a.lengths;c<a.length;c++){for(var v=a[c],w=[],e=0;e<v;e++){for(var t=[],k=0;k<g;k++)t.push(d[l++]);w.push(t)}b.push(w)}return m?n?{paths:b,hasZ:m,hasM:n}:{paths:b,hasZ:m}:n?{paths:b,hasM:n}:{paths:b}}function m(a,m,n,g,d){n=p(n,g);for(g=0;g<m.length;g++){var l=m[g],v=l.geometry,l=l.attributes,w=void 0;v&&(w=E(new b.default,v,n));a.push(new c.default(w,l,null,l[d]))}return a}function E(a,
m,n){void 0===n&&(n=p(m.hasZ,m.hasM));var g=a.lengths,d=a.coords,b=0,l=0;for(m=m.paths;l<m.length;l++){for(var c=m[l],v=0,w=c;v<w.length;v++)for(var e=w[v],t=0;t<n;t++)d[b++]=e[t];g.push(c.length)}return a}function ca(a,m,n){if(!a)return null;var g=p(m,n),d=a.coords,b=[],l=0,c=0;for(a=a.lengths;c<a.length;c++){for(var v=a[c],w=[],t=0;t<v;t++){for(var e=[],k=0;k<g;k++)e.push(d[l++]);w.push(e)}b.push(w)}return m?n?{rings:b,hasZ:m,hasM:n}:{rings:b,hasZ:m}:n?{rings:b,hasM:n}:{rings:b}}function va(a,m,
n,g,d){for(var l=0;l<m.length;l++){var v=m[l],w=v.geometry,t=v.centroid,v=v.attributes,e=void 0;w&&(e=na(new b.default,w,n,g));t?a.push(new c.default(e,v,G(new b.default,t),v[d])):a.push(new c.default(e,v,null,v[d]))}return a}function na(a,m,n,g){void 0===n&&(n=m.hasZ);void 0===g&&(g=m.hasM);oa(a,m.rings,n,g);return a}function oa(a,m,n,g){n=p(n,g);g=a.lengths;for(var d=a.coords,b=0,l=g.length=d.length=0;l<m.length;l++){for(var c=m[l],v=0,w=c;v<w.length;v++)for(var e=w[v],t=0;t<n;t++)d[b++]=e[t];g.push(c.length)}return a}
function L(a,n,g,d,b,l){a.length=0;if(!g){for(g=0;g<n.length;g++)d=n[g],a.push(new c.default(null,d.attributes,null,d.attributes[l]));return a}switch(g){case "esriGeometryPoint":return D(a,n,d,b,l);case "esriGeometryMultipoint":return J(a,n,d,b,l);case "esriGeometryPolyline":return m(a,n,d,b,l);case "esriGeometryPolygon":return va(a,n,d,b,l);default:X.error("convertToFeatureSet:unknown-geometry",new r("Unable to parse unknown geometry type '"+g+"'")),a.length=0}return a}function sa(a,m,d,b){a=a&&
("coords"in a?a:a.geometry);if(!a)return null;switch(m){case "esriGeometryPoint":return m=n,d&&b?m=l:d?m=F:b&&(m=g),m(a);case "esriGeometryMultipoint":return N(a,d,b);case "esriGeometryPolyline":return w(a,d,b);case "esriGeometryPolygon":return ca(a,d,b);default:X.error("convertToGeometry:unknown-geometry",new r("Unable to parse unknown geometry type '"+m+"'"))}}function pa(a,m,d,b,c){a.length=0;switch(d){case "esriGeometryPoint":d=n;b&&c?d=l:b?d=F:c&&(d=g);for(b=0;b<m.length;b++){var v=m[b];c=v.geometry;
v=v.attributes;c=c?d(c):null;a.push({attributes:v,geometry:c})}break;case "esriGeometryMultipoint":return M(a,m,b,c);case "esriGeometryPolyline":for(d=0;d<m.length;d++){var t=m[d],v=t.geometry,t=t.attributes,e=void 0;v&&(e=w(v,b,c));a.push({attributes:t,geometry:e})}break;case "esriGeometryPolygon":for(d=0;d<m.length;d++){var e=m[d],t=e.geometry,v=e.attributes,k=e.centroid,e=void 0;t&&(e=ca(t,b,c));k?(t=n(k),a.push({attributes:v,centroid:t,geometry:e})):a.push({attributes:v,geometry:e})}break;default:X.error("convertToFeatureSet:unknown-geometry",
new r("Unable to parse unknown geometry type '"+d+"'"))}return a}function U(a,m,n,g,b,l,c,v){void 0===c&&(c=n);void 0===v&&(v=g);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;b=Q[b];var t=m.coords;m=m.lengths;var w=p(n,g),e=p(n&&c,g&&v);n=u(n,g,c,v);if(!m.length)return n(a.coords,t,0,0,x(l,t[0]),d(l,t[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=w,a;for(var k,E=0,y,C=0,I=0;I<m.length;I++){var H=m[I];if(!(H<b)){var J=
0;y=C;v=g=x(l,t[E]);k=c=d(l,t[E+1]);n(a.coords,t,y,E,v,k);J++;E+=w;y+=e;for(var f=1;f<H;f++,E+=w)if(v=x(l,t[E]),k=d(l,t[E+1]),v!==g||k!==c)n(a.coords,t,y,E,v-g,k-c),y+=e,J++,g=v,c=k;J>=b&&(a.lengths.push(J),C=y)}}a.coords.length=C;return a.coords.length?a:null}function P(a,m,n,g,d,b,l){for(var c=g,v=0,t,w=b+n;w<l;w+=n){t=m[w];var e=m[w+1],k=m[l],E=m[l+1],p=m[b],y=m[b+1],u=k-p,C=E-y;if(0!==u||0!==C){var f=((t-p)*u+(e-y)*C)/(u*u+C*C);1<f?(p=k,y=E):0<f&&(p+=u*f,y+=C*f)}u=t-p;C=e-y;t=u*u+C*C;t>c&&(v=
w,c=t)}c>g&&(v-b>n&&P(a,m,n,g,d,b,v),d(a,m,a.length,v,m[v],m[v+1]),l-v>n&&P(a,m,n,g,d,v,l))}function R(a,m,n,g,d){var b=m.coords,l=m.lengths,c=n?g?ha:T:g?T:Z;n=p(n,g);if(!b.length)return a!==m&&(a.lengths.length=0,a.coords.length=0),a;if(!l.length)return c(a.coords,b,0,0,y(d,b[0]),v(d,b[1])),a!==m&&(a.lengths.length=0,a.coords.length=n),a;var t=d.scale;g=t[0];for(var t=t[1],w=0,e=0;e<l.length;e++){var k=l[e];a.lengths[e]=k;var E=y(d,b[w]),u=v(d,b[w+1]);c(a.coords,b,w,w,E,u);for(var w=w+n,C=1;C<k;C++,
w+=n)E+=b[w]*g,u-=b[w+1]*t,c(a.coords,b,w,w,E,u)}a!==m&&(a.lengths.length=l.length,a.coords.length=b.length);return a}function ja(a,m,n,g){for(var d=0,b=a[g*m],l=a[g*(m+1)],c=1;c<n;c++)var v=b+a[g*(m+c)],t=l+a[g*(m+c)+1],w=(v-b)*(t+l),b=v,l=t,d=d+w;return.5*d}Object.defineProperty(a,"__esModule",{value:!0});a.deltaDecodeGeometry=a.deltaEncodeGeometry=a.getQuantizedArea=a.getSignedQuantizedRingArea=a.removeCollinearVectices=a.removeZMValues=a.unquantizeOptimizedGeometry=a.getQuantizedBoundsOptimizedGeometry=
a.getBoundsOptimizedGeometry=a.generalizeOptimizedGeometry=a.quantizeOptimizedGeometry=a.quantizeOptimizedFeatureSet=a.unquantizeOptimizedFeatureSet=a.convertFromFeatureSet=a.convertToFeatureSet=a.convertToFeatures=a.convertToGeometry=a.convertFromGeometry=a.convertToFeature=a.convertFromGraphics=a.convertFromFeatures=a.convertFromFeature=a.convertFromNestedArray=a.convertFromPolygon=a.convertToPolygon=a.convertFromPolyline=a.convertFromPolylineFeatures=a.convertToPolyline=a.convertFromMultipoint=
a.convertFromMultipointFeatures=a.convertToMultipoint=a.convertToMultipointFeatures=a.convertFromPoint=a.convertFromPointFeatures=a.convertToPoint=a.unquantizeY=a.unquantizeX=a.quantizeY=a.quantizeX=void 0;var X=q.getLogger("esri.tasks.support.optimizedFeatureSet"),Q={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},Z=function(a,m,n,g,d,b){a[n]=d;a[n+1]=b},T=function(a,m,n,g,d,b){a[n]=d;a[n+1]=b;a[n+2]=m[g+2]},ea=function(a,m,n,g,d,b){a[n]=d;a[n+1]=b;a[n+
2]=m[g+3]},ha=function(a,m,n,g,d,b){a[n]=d;a[n+1]=b;a[n+2]=m[g+2];a[n+3]=m[g+3]};a.quantizeX=x;a.quantizeY=d;a.unquantizeX=y;a.unquantizeY=v;a.convertToPoint=function(a,m,d){return a?m?d?l(a):F(a):d?g(a):n(a):null};a.convertFromPointFeatures=D;a.convertFromPoint=function(a,m,n){void 0===n&&(n=O(null!=m.z,null!=m.m));return n(a,m)};a.convertToMultipointFeatures=M;a.convertToMultipoint=N;a.convertFromMultipointFeatures=J;a.convertFromMultipoint=I;a.convertToPolyline=w;a.convertFromPolylineFeatures=
m;a.convertFromPolyline=E;a.convertToPolygon=ca;a.convertFromPolygon=na;a.convertFromNestedArray=oa;var qa=[],ka=[];a.convertFromFeature=function(a,m,n,g,d){qa[0]=a;a=L(ka,qa,m,n,g,d)[0];qa.length=ka.length=0;return a};a.convertFromFeatures=L;a.convertFromGraphics=function(a,n,g,d,b,l){var c=a.length;switch(g){case "esriGeometryPoint":D(a,n,d,b,l);break;case "esriGeometryMultipoint":J(a,n,d,b,l);break;case "esriGeometryPolyline":m(a,n,d,b,l);break;case "esriGeometryPolygon":va(a,n,d,b,l);break;default:X.error("convertToFeatureSet:unknown-geometry",
new r("Unable to parse unknown geometry type '"+g+"'"))}for(d=0;d<n.length;d++)a[d+c].geometryType=g,a[d+c].insertAfter=n[d].insertAfter,a[d+c].groupId=n[d].groupId;return a};a.convertToFeature=function(a,m,n,g){ka[0]=a;pa(qa,ka,m,n,g);a=qa[0];qa.length=ka.length=0;return a};a.convertFromGeometry=function(a,m,n){if(!a)return null;var g=new b.default;"hasZ"in a&&null==m&&(m=a.hasZ);"hasM"in a&&null==n&&(n=a.hasM);if(k.isPoint(a))return O(null!=m?m:null!=a.z,null!=n?n:null!=a.m)(g,a);if(k.isPolygon(a))return na(g,
a,m,n);if(k.isPolyline(a))return E(g,a,p(m,n));if(k.isMultipoint(a))return I(g,a,p(m,n));X.error("convertFromGeometry:unknown-geometry",new r("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=sa;a.convertToFeatures=pa;a.convertToFeatureSet=function(a){var m=a.objectIdFieldName,n=a.spatialReference,g=a.transform,d=a.fields,b=a.hasM,l=a.hasZ,c=a.geometryType,v=a.exceededTransferLimit,t=a.uniqueIdField,w=a.queryGeometry,e=a.queryGeometryType;a=pa([],a.features,c,l,b);w=sa(w,e,!1,
!1);m={features:a,fields:d,geometryType:c,objectIdFieldName:m,spatialReference:n,uniqueIdField:t,queryGeometry:w};g&&(m.transform=g);v&&(m.exceededTransferLimit=v);b&&(m.hasM=b);l&&(m.hasZ=l);return m};a.convertFromFeatureSet=function(a,m){var n=new e.default,g=a.hasM,d=a.hasZ,b=a.features,l=a.objectIdFieldName,c=a.spatialReference,v=a.geometryType,w=a.exceededTransferLimit,t=a.transform;if(a=a.fields)n.fields=a;n.geometryType=v;n.objectIdFieldName=l||m;n.spatialReference=c;if(!n.objectIdFieldName)return X.error(new r("optimized-features:invalid-objectIdFieldName",
"objectIdFieldName is missing")),n;b&&L(n.features,b,v,d,g,n.objectIdFieldName);w&&(n.exceededTransferLimit=w);g&&(n.hasM=g);d&&(n.hasZ=d);t&&(n.transform=t);return n};a.unquantizeOptimizedFeatureSet=function(a){var m=a.transform,n=a.hasM,g=a.hasZ;if(!m)return a;for(var d=0,b=a.features;d<b.length;d++){var l=b[d];l.geometry&&R(l.geometry,l.geometry,n,g,m);l.centroid&&R(l.centroid,l.centroid,n,g,m)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,m){var n=m.geometryType,g=m.features,
d=m.hasM,l=m.hasZ;if(!a)return m;for(var c=0;c<g.length;c++){var v=g[c],w=v.weakClone();w.geometry=new b.default;U(w.geometry,v.geometry,d,l,n,a);v.centroid&&(w.centroid=new b.default,U(w.centroid,v.centroid,d,l,"esriGeometryPoint",a));g[c]=w}m.transform=a;return m};a.quantizeOptimizedGeometry=U;a.generalizeOptimizedGeometry=function(a,m,n,g,d,b,l,c){void 0===l&&(l=n);void 0===c&&(c=g);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;
d=Q[d];var v=m.coords;m=m.lengths;var w=p(n,g),t=p(n&&l,g&&c);n=u(n,g,l,c);if(!m.length)return n(a.coords,v,0,0,v[0],v[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=w,a;g=0;b*=b;for(l=0;l<m.length;l++){c=m[l];if(!(c<d)){var e=a.coords.length/t,k=g,E=g+(c-1)*w;n(a.coords,v,a.coords.length,k,v[k],v[k+1]);P(a.coords,v,w,b,n,k,E);n(a.coords,v,a.coords.length,E,v[E],v[E+1]);k=a.coords.length/t-e;k>=d?a.lengths.push(k):a.coords.length=e*t}g+=c*w}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=
function(a,m,n,g){if(!m||!m.coords||!m.coords.length)return null;n=p(n,g);var d=g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(m&&m.coords){m=m.coords;for(var c=0;c<m.length;c+=n){var v=m[c],w=m[c+1];g=Math.min(g,v);b=Math.max(b,v);d=Math.min(d,w);l=Math.max(l,w)}}a[0]=g;a[1]=d;a[2]=b;a[3]=l;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,m,n,g){n=p(n,g);g=m.coords;var d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,
c=Number.NEGATIVE_INFINITY,v=0,w=0;for(m=m.lengths;w<m.length;w++)for(var t=m[w],e=g[v],k=g[v+1],d=Math.min(e,d),b=Math.min(k,b),l=Math.max(e,l),c=Math.max(k,c),v=v+n,E=1;E<t;E++,v+=n){var y=g[v],u=g[v+1],e=e+y,k=k+u;0>y&&(d=Math.min(d,e));0<y&&(l=Math.max(l,e));0>u?b=Math.min(b,k):0<u&&(c=Math.max(c,k))}a[0]=d;a[1]=b;a[2]=l;a[3]=c;return a};a.unquantizeOptimizedGeometry=R;a.removeZMValues=function(a,m,n,g,d,b){var l,c=p(n,g);n=u(n,g,d,b);g=m.coords;a.coords.length=0;a.lengths.length=0;(l=a.lengths).push.apply(l,
m.lengths);for(m=0;m<g.length;m+=c)n(a.coords,g,a.coords.length,m,g[m],g[m+1]);return a};a.removeCollinearVectices=function(a,m,n,g,d){if(!m||!m.coords||!m.coords.length)return null;n=Q[n];var b=m.coords;m=m.lengths;var l=u(g,d,g,d);g=p(g,d);for(var c=d=0,v=0,w=0,t=0;t<m.length;t++){var e=m[t],c=w;l(a.coords,b,c,d,b[d],b[d+1]);d+=g;var k=b[d],E=b[d+1],y=k,C=E,I=E/k,c=c+g;l(a.coords,b,c,d,y,C);d+=g;for(var J=2;J<e;J++){var k=b[d],E=b[d+1],f=E/k,H=I===f||!isFinite(I)&&!isFinite(f),I=H&&isFinite(f)?
0<=I&&0<=f||0>=I&&0>=f:0<=C&&0<=E||0>=C&&0>=E;H&&I?(y+=k,C+=E):(y=k,C=E,c+=g);l(a.coords,b,c,d,y,C);d+=g;I=f}c+=g;e=(c-w)/g;e>=n&&(a.lengths[v]=e,w=c,v++)}a.coords.length>w&&(a.coords.length=w);a.lengths.length>v&&(a.lengths.length=v);return a.coords.length&&a.lengths.length?a:null};a.getSignedQuantizedRingArea=ja;a.getQuantizedArea=function(a,m){var n=a.coords;a=a.lengths;for(var g=0,d=0,b=0;b<a.length;b++)d+=ja(n,g,a[b],m),g+=b;return Math.abs(d)};a.deltaEncodeGeometry=function(a,m){var n=a.clone(),
g=a.coords;a=a.lengths;for(var d=0,b=0;b<a.length;b++){for(var l=a[b],c=g[m*d],v=g[m*d+1],w=1;w<l;w++){var t=g[m*(d+w)],e=g[m*(d+w)+1],v=e-v;n.coords[m*(d+w)]=t-c;n.coords[m*(d+w)+1]=v;c=t;v=e}d+=l}return n};a.deltaDecodeGeometry=function(a,m){var n=a.clone(),g=a.coords;a=a.lengths;for(var d=0,b=0;b<a.length;b++){for(var l=a[b],c=g[m*d],v=g[m*d+1],w=1;w<l;w++)c+=g[m*(d+w)],v+=g[m*(d+w)+1],n.coords[m*(d+w)]=c,n.coords[m*(d+w)+1]=v;d+=l}return n}})},"esri/layers/graphics/OptimizedFeature":function(){define(["require",
"exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,k,c,e){void 0===a&&(a=null);void 0===k&&(k={});this.displayId=0;this.geohashIndexed=!1;this.geohashY=this.geohashX=0;this.geometry=a;k&&(this.attributes=k);c&&(this.centroid=c);null!=e&&(this.objectId=e)}Object.defineProperty(a.prototype,"hasGeometry",{get:function(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)},enumerable:!1,configurable:!0});a.prototype.weakClone=function(){var q=
new a(this.geometry,this.attributes,this.centroid,this.objectId);q.displayId=this.displayId;q.geohashIndexed=this.geohashIndexed;q.geohashX=this.geohashX;q.geohashY=this.geohashY;return q};return a}();a.default=z})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=
null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}a.prototype.weakClone=function(){var q=new a;q.objectIdFieldName=this.objectIdFieldName;q.globalIdFieldName=this.globalIdFieldName;q.geohashFieldName=this.geohashFieldName;q.geometryProperties=this.geometryProperties;q.geometryType=this.geometryType;q.spatialReference=this.spatialReference;q.hasZ=this.hasZ;q.hasM=this.hasM;
q.features=this.features;q.fields=this.fields;q.transform=this.transform;q.exceededTransferLimit=this.exceededTransferLimit;q.uniqueIdField=this.uniqueIdField;q.queryGeometry=this.queryGeometry;q.queryGeometryType=this.queryGeometryType;return q};return a}();a.default=z})},"esri/layers/graphics/OptimizedGeometry":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,k,c){void 0===a&&(a=[]);void 0===k&&(k=[]);void 0===c&&(c=
!1);this.lengths=a;this.coords=k;this.hasIndeterminateRingOrder=c}Object.defineProperty(a.prototype,"isPoint",{get:function(){return 0===this.lengths.length},enumerable:!1,configurable:!0});a.prototype.forEachVertex=function(a){var k=0;this.lengths.length||a(this.coords[0],this.coords[1]);for(var c=0;c<this.lengths.length;c++){for(var e=this.lengths[c],b=0;b<e;b++)a(this.coords[2*(b+k)],this.coords[2*(b+k)+1]);k+=e}};a.prototype.clone=function(){return new a(this.lengths.slice(),this.coords.slice(),
this.hasIndeterminateRingOrder)};return a}();a.default=z})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./optimizedFeatureQueryEngineAdapter".split(" "),function(z,a,r,q,k,c,e,b,p,u,x){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a){this.geometryInfo=
a;this._boundsStore=new u.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new q;this.featureAdapter=x.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var d=b.create(b.NEGATIVE_INFINITY);this._featuresById.forEach(function(n){if(n=a._boundsStore.get(n.objectId))d[0]=Math.min(n[0],d[0]),d[1]=Math.min(n[1],d[1]),d[2]=Math.max(n[2],d[2]),d[3]=Math.max(n[3],d[3])});return d},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(d){d.geometry&&d.geometry.coords&&(a+=d.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!1,configurable:!0});a.prototype.add=function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var d=0;d<a.length;d++)this._add(a[d]);this._emitChanged()};a.prototype.clear=
function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var d=0;d<a.length;d++){var n=this._featuresById.get(a[d]);n&&this._remove(n)}this._emitChanged()};a.prototype.forEachBounds=function(a,d,n){for(var b=0;b<a.length;b++){var c=this._boundsStore.get(a[b].objectId);
c&&d(e.fromRect(n,c))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(d){return a(d)})};a.prototype.forEachInBounds=function(a,d){var n=this;this._boundsStore.forEachInBounds(a,function(a){d(n._featuresById.get(a))})};a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=
this,d=!1;this._featuresById.forEach(function(n,b){a._markedIds.has(b)||(d=!0,a._remove(n))});this._markedIds.clear();d&&this._emitChanged()};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var d=a.objectId;if(null==d)k.getLogger("esri.layers.graphics.data.FeatureStore").error(new r("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var n=this._featuresById.get(d),e;this._markedIds.add(d);if(n)a.displayId=n.displayId,
e=this._boundsStore.get(d),this._boundsStore.delete(d);else if(c.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(e=p.getBoundsOptimizedGeometry(e||b.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(d,e)):this._boundsStore.set(d,null);this._featuresById.set(d,a)}}};a.prototype._remove=function(a){if(c.isSome(this.onFeatureRemove))this.onFeatureRemove(a);this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);
this._featuresById.delete(a.objectId);return a};return a}();a.default=z})},"esri/core/Evented":function(){define("require exports tslib ./Accessor ./handleUtils ./accessorSupport/decorators/subclass".split(" "),function(z,a,r,q,k,c){var e=function(){function a(){this._emitter=new a.EventEmitter(this)}a.prototype.emit=function(a,b){return this._emitter.emit(a,b)};a.prototype.on=function(a,b){return this._emitter.on(a,b)};a.prototype.once=function(a,b){return this._emitter.once(a,b)};a.prototype.hasEventListener=
function(a){return this._emitter.hasEventListener(a)};return a}();(function(a){var b=function(){function a(a){void 0===a&&(a=null);this.target=a;this._listenersMap=null}a.prototype.clear=function(){this._listenersMap&&this._listenersMap.clear()};a.prototype.emit=function(a,b){a=this._listenersMap&&this._listenersMap.get(a);if(!a)return!1;var d=this.target||this;r.__spreadArrays(a).forEach(function(a){a.call(d,b)});return 0<a.length};a.prototype.on=function(a,b){var d=this;if(Array.isArray(a)){var n=
a.map(function(a){return d.on(a,b)});return k.handlesGroup(n)}if(-1<a.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);n=this._listenersMap.get(a)||[];n.push(b);this._listenersMap.set(a,n);return{remove:function(){var n=d._listenersMap&&d._listenersMap.get(a)||[],c=n.indexOf(b);0<=c&&n.splice(c,1)}}};a.prototype.once=function(a,b){var d;return d=this.on(a,function(a){d.remove();b.call(null,
a)})};a.prototype.hasEventListener=function(a){a=this._listenersMap&&this._listenersMap.get(a);return null!=a&&0<a.length};return a}();a.EventEmitter=b;a.EventedMixin=function(a){return function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._emitter=new b;return d}r.__extends(d,a);d.prototype.emit=function(a,n){return this._emitter.emit(a,n)};d.prototype.on=function(a,n){return this._emitter.on(a,n)};d.prototype.once=function(a,n){return this._emitter.once(a,n)};d.prototype.hasEventListener=
function(a){return this._emitter.hasEventListener(a)};return d=r.__decorate([c.subclass("esri.core.Evented")],d)}(a)};var u=function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._emitter=new e.EventEmitter(d);return d}r.__extends(d,a);d.prototype.emit=function(a,d){return this._emitter.emit(a,d)};d.prototype.on=function(a,d){return this._emitter.on(a,d)};d.prototype.once=function(a,d){return this._emitter.once(a,d)};d.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};
return d=r.__decorate([c.subclass("esri.core.Evented")],d)}(q);a.EventedAccessor=u})(e||(e={}));return e})},"esri/geometry/support/aaBoundingBox":function(){define(["require","exports","../../core/maybe","../Extent","./aaBoundingRect"],function(z,a,r,q,k){function c(n){void 0===n&&(n=a.ZERO);return[n[0],n[1],n[2],n[3],n[4],n[5]]}function e(a,d,b,e,g,t,l){void 0===l&&(l=c());l[0]=a;l[1]=d;l[2]=b;l[3]=e;l[4]=g;l[5]=t;return l}function b(a){return a[0]>=a[3]?0:a[3]-a[0]}function p(a){return a[1]>=a[4]?
0:a[4]-a[1]}function u(a){return a[2]>=a[5]?0:a[5]-a[2]}function x(a,d){return Math.max(d[0],a[0])<=Math.min(d[3],a[3])&&Math.max(d[1],a[1])<=Math.min(d[4],a[4])&&Math.max(d[2],a[2])<=Math.min(d[5],a[5])}function d(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];return a}function y(a){return 6===a.length}Object.defineProperty(a,"__esModule",{value:!0});a.ZERO=a.NEGATIVE_INFINITY=a.POSITIVE_INFINITY=a.wrap=a.equals=a.isPoint=a.is=a.fromRect=a.toRect=a.empty=a.set=a.setMax=a.setMin=
a.getMax=a.getMin=a.offset=a.intersectsClippingArea=a.intersects=a.contains=a.containsPointWithMargin=a.containsPoint=a.maximumDimension=a.size=a.center=a.diameter=a.height=a.depth=a.width=a.allFinite=a.expandWithNestedArray=a.expandWithOffset=a.expandWithBuffer=a.expand=a.expandPointInPlace=a.fromMinMax=a.toExtent=a.fromExtent=a.fromValues=a.create=void 0;a.create=c;a.fromValues=e;a.fromExtent=function(a,d){void 0===d&&(d=c());d[0]=a.xmin;d[1]=a.ymin;d[2]=a.zmin;d[3]=a.xmax;d[4]=a.ymax;d[5]=a.zmax;
return d};a.toExtent=function(a,d){return isFinite(a[2])||isFinite(a[5])?new q({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:d}):new q({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:d})};a.fromMinMax=function(a,d,b){void 0===b&&(b=c());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=d[0];b[4]=d[1];b[5]=d[2];return b};a.expandPointInPlace=function(a,d){d[0]<a[0]&&(a[0]=d[0]);d[0]>a[3]&&(a[3]=d[0]);d[1]<a[1]&&(a[1]=d[1]);d[1]>a[4]&&(a[4]=d[1]);d[2]<a[2]&&(a[2]=d[2]);d[2]>
a[5]&&(a[5]=d[2])};a.expand=function(a,d,b){void 0===b&&(b=a);y(d)?(b[0]=Math.min(a[0],d[0]),b[1]=Math.min(a[1],d[1]),b[2]=Math.min(a[2],d[2]),b[3]=Math.max(a[3],d[3]),b[4]=Math.max(a[4],d[4]),b[5]=Math.max(a[5],d[5])):k.is(d)?(b[0]=Math.min(a[0],d[0]),b[1]=Math.min(a[1],d[1]),b[3]=Math.max(a[3],d[2]),b[4]=Math.max(a[4],d[3])):2===d.length?(b[0]=Math.min(a[0],d[0]),b[1]=Math.min(a[1],d[1]),b[3]=Math.max(a[3],d[0]),b[4]=Math.max(a[4],d[1])):3===d.length&&(b[0]=Math.min(a[0],d[0]),b[1]=Math.min(a[1],
d[1]),b[2]=Math.min(a[2],d[2]),b[3]=Math.max(a[3],d[0]),b[4]=Math.max(a[4],d[1]),b[5]=Math.max(a[5],d[2]));return b};a.expandWithBuffer=function(a,d,b,c,g){void 0===b&&(b=0);void 0===c&&(c=d.length/3);void 0===g&&(g=a);var n=a[0],l=a[1],e=a[2],v=a[3],k=a[4];a=a[5];for(var p=0;p<c;p++)n=Math.min(n,d[b+3*p]),l=Math.min(l,d[b+3*p+1]),e=Math.min(e,d[b+3*p+2]),v=Math.max(v,d[b+3*p]),k=Math.max(k,d[b+3*p+1]),a=Math.max(a,d[b+3*p+2]);g[0]=n;g[1]=l;g[2]=e;g[3]=v;g[4]=k;g[5]=a;return g};a.expandWithOffset=
function(a,d,b,c,g){void 0===g&&(g=a);g[0]=Math.min(a[0],a[0]+d);g[3]=Math.max(a[3],a[3]+d);g[1]=Math.min(a[1],a[1]+b);g[4]=Math.max(a[4],a[4]+b);g[2]=Math.min(a[2],a[2]+c);g[5]=Math.max(a[5],a[5]+c);return g};a.expandWithNestedArray=function(a,d,b,c){void 0===c&&(c=a);var g=d.length,n=a[0],l=a[1],e=a[2],v=a[3],k=a[4];a=a[5];if(b)for(b=0;b<g;b++){var p=d[b],n=Math.min(n,p[0]),l=Math.min(l,p[1]),e=Math.min(e,p[2]),v=Math.max(v,p[0]),k=Math.max(k,p[1]);a=Math.max(a,p[2])}else for(b=0;b<g;b++)p=d[b],
n=Math.min(n,p[0]),l=Math.min(l,p[1]),v=Math.max(v,p[0]),k=Math.max(k,p[1]);c[0]=n;c[1]=l;c[2]=e;c[3]=v;c[4]=k;c[5]=a;return c};a.allFinite=function(a){for(var d=0;6>d;d++)if(!isFinite(a[d]))return!1;return!0};a.width=b;a.depth=p;a.height=u;a.diameter=function(a){var d=b(a),n=u(a);a=p(a);return Math.sqrt(d*d+n*n+a*a)};a.center=function(a,d){void 0===d&&(d=[0,0,0]);d[0]=a[0]+b(a)/2;d[1]=a[1]+p(a)/2;d[2]=a[2]+u(a)/2;return d};a.size=function(a,d){void 0===d&&(d=[0,0,0]);d[0]=b(a);d[1]=p(a);d[2]=u(a);
return d};a.maximumDimension=function(a){return Math.max(b(a),u(a),p(a))};a.containsPoint=function(a,d){return d[0]>=a[0]&&d[1]>=a[1]&&d[2]>=a[2]&&d[0]<=a[3]&&d[1]<=a[4]&&d[2]<=a[5]};a.containsPointWithMargin=function(a,d,b){return d[0]>=a[0]-b&&d[1]>=a[1]-b&&d[2]>=a[2]-b&&d[0]<=a[3]+b&&d[1]<=a[4]+b&&d[2]<=a[5]+b};a.contains=function(a,d){return d[0]>=a[0]&&d[1]>=a[1]&&d[2]>=a[2]&&d[3]<=a[3]&&d[4]<=a[4]&&d[5]<=a[5]};a.intersects=x;a.intersectsClippingArea=function(a,d){return r.isNone(d)?!0:x(a,d)};
a.offset=function(a,d,b,c,g){void 0===g&&(g=a);g[0]=a[0]+d;g[1]=a[1]+b;g[2]=a[2]+c;g[3]=a[3]+d;g[4]=a[4]+b;g[5]=a[5]+c;return g};a.getMin=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];return d};a.getMax=function(a,d){d[0]=a[3];d[1]=a[4];d[2]=a[5];return d};a.setMin=function(a,d,b){void 0===b&&(b=a);b[0]=d[0];b[1]=d[1];b[2]=d[2];b!==a&&(b[3]=a[3],b[4]=a[4],b[5]=a[5]);return b};a.setMax=function(a,d,b){void 0===b&&(b=a);b[3]=d[0];b[4]=d[1];b[5]=d[2];b!==a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return a};a.set=
d;a.empty=function(b){return b?d(b,a.NEGATIVE_INFINITY):c(a.NEGATIVE_INFINITY)};a.toRect=function(a,d){d||(d=k.create());d[0]=a[0];d[1]=a[1];d[2]=a[3];d[3]=a[4];return d};a.fromRect=function(a,d){a[0]=d[0];a[1]=d[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=d[2];a[4]=d[3];a[5]=Number.POSITIVE_INFINITY;return a};a.is=y;a.isPoint=function(a){return 0===b(a)&&0===p(a)&&0===u(a)};a.equals=function(a,d,b){if(r.isNone(a)||r.isNone(d))return a===d;if(!y(a)||!y(d))return!1;if(b)for(var c=0;c<a.length;c++){if(!b(a[c],
d[c]))return!1}else for(c=0;c<a.length;c++)if(a[c]!==d[c])return!1;return!0};a.wrap=function(a,d,b,c,g,t){return e(a,d,b,c,g,t,v)};a.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0,0,0];var v=c()})},"esri/geometry/support/aaBoundingRect":function(){define(["require","exports","../../core/compilerUtils","../Extent"],function(z,a,r,q){function k(d){void 0===d&&(d=a.ZERO);return[d[0],
d[1],d[2],d[3]]}function c(a){return a[0]>=a[2]?0:a[2]-a[0]}function e(a){return a[1]>=a[3]?0:a[3]-a[1]}function b(a,b,c){return b>=a[0]&&c>=a[1]&&b<=a[2]&&c<=a[3]}function p(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function u(a){return 4===a.length}function x(a,b,c){return a<b?b:a>c?c:a}Object.defineProperty(a,"__esModule",{value:!0});a.UNIT=a.ZERO=a.NEGATIVE_INFINITY=a.POSITIVE_INFINITY=a.equals=a.isPoint=a.is=a.empty=a.set=a.setMax=a.setMin=a.pad=a.offset=a.size=a.distance=a.intersection=
a.contains=a.intersects=a.containsPointWithMargin=a.containsXY=a.containsPointObject=a.containsPoint=a.center=a.area=a.diameter=a.height=a.width=a.allFinite=a.expandWithNestedArray=a.expand=a.expandPointInPlace=a.toExtent=a.fromExtent=a.fromValues=a.clone=a.create=void 0;a.create=k;a.clone=function(a){return[a[0],a[1],a[2],a[3]]};a.fromValues=function(a,b,c,n,e){void 0===e&&(e=k());e[0]=a;e[1]=b;e[2]=c;e[3]=n;return e};a.fromExtent=function(a,b){void 0===b&&(b=k());b[0]=a.xmin;b[1]=a.ymin;b[2]=a.xmax;
b[3]=a.ymax;return b};a.toExtent=function(a,b){return new q({xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:b})};a.expandPointInPlace=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[2]&&(a[2]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[3]&&(a[3]=b[1])};a.expand=function(a,b,c){void 0===c&&(c=a);if("length"in b)if(u(b))c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.max(a[2],b[2]),c[3]=Math.max(a[3],b[3]);else{if(2===b.length||3===b.length)c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),
c[2]=Math.max(a[2],b[0]),c[3]=Math.max(a[3],b[1])}else switch(b.type){case "extent":c[0]=Math.min(a[0],b.xmin);c[1]=Math.min(a[1],b.ymin);c[2]=Math.max(a[2],b.xmax);c[3]=Math.max(a[3],b.ymax);break;case "point":c[0]=Math.min(a[0],b.x);c[1]=Math.min(a[1],b.y);c[2]=Math.max(a[2],b.x);c[3]=Math.max(a[3],b.y);break;default:r.neverReached(b)}return c};a.expandWithNestedArray=function(a,b,c){void 0===c&&(c=a);var d=b.length,e=a[0],k=a[1],v=a[2];a=a[3];for(var g=0;g<d;g++){var t=b[g],e=Math.min(e,t[0]),
k=Math.min(k,t[1]),v=Math.max(v,t[0]);a=Math.max(a,t[1])}c[0]=e;c[1]=k;c[2]=v;c[3]=a;return c};a.allFinite=function(a){for(var b=0;4>b;b++)if(!isFinite(a[b]))return!1;return!0};a.width=c;a.height=e;a.diameter=function(a){var b=c(a);a=e(a);return Math.sqrt(b*b+a*a)};a.area=function(a){return c(a)*e(a)};a.center=function(a,b){void 0===b&&(b=[0,0]);b[0]=(a[0]+a[2])/2;b[1]=(a[1]+a[3])/2;return b};a.containsPoint=function(a,c){return b(a,c[0],c[1])};a.containsPointObject=function(a,c){return b(a,c.x,c.y)};
a.containsXY=b;a.containsPointWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[0]<=a[2]+c&&b[1]<=a[3]+c};a.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[2],a[2])&&Math.max(b[1],a[1])<=Math.min(b[3],a[3])};a.contains=function(a,b){return b[0]>=a[0]&&b[2]<=a[2]&&b[1]>=a[1]&&b[3]<=a[3]};a.intersection=function(a,b,c){void 0===c&&(c=a);var d=b[0],e=b[1],k=b[2];b=b[3];c[0]=x(a[0],d,k);c[1]=x(a[1],e,b);c[2]=x(a[2],d,k);c[3]=x(a[3],e,b);return c};a.distance=function(a,b){var d=
(a[1]+a[3])/2,n=Math.max(Math.abs(b[0]-(a[0]+a[2])/2)-c(a)/2,0);a=Math.max(Math.abs(b[1]-d)-e(a)/2,0);return Math.sqrt(n*n+a*a)};a.size=function(a,b){b[0]=a[2]-a[0];b[1]=a[3]-a[1]};a.offset=function(a,b,c,e){void 0===e&&(e=a);e[0]=a[0]+b;e[1]=a[1]+c;e[2]=a[2]+b;e[3]=a[3]+c;return e};a.pad=function(a,b,c){void 0===c&&(c=a);c[0]=a[0]-b;c[1]=a[1]-b;c[2]=a[2]+b;c[3]=a[3]+b;return c};a.setMin=function(a,b,c){void 0===c&&(c=a);c[0]=b[0];c[1]=b[1];c!==a&&(c[2]=a[2],c[3]=a[3]);return c};a.setMax=function(a,
b,c){void 0===c&&(c=a);c[2]=b[0];c[3]=b[1];c!==a&&(c[0]=a[0],c[1]=a[1]);return a};a.set=p;a.empty=function(b){return b?p(b,a.NEGATIVE_INFINITY):k(a.NEGATIVE_INFINITY)};a.is=u;a.isPoint=function(a){return(0===c(a)||!isFinite(a[0]))&&(0===e(a)||!isFinite(a[1]))};a.equals=function(a,b,c){if(null==a||null==b)return a===b;if(!u(a)||!u(b))return!1;if(c)for(var d=0;d<a.length;d++){if(!c(a[d],b[d]))return!1}else for(d=0;d<a.length;d++)if(a[d]!==b[d])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,
Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0];a.UNIT=[0,0,1,1]})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(z,a,r,q){Object.defineProperty(a,"__esModule",{value:!0});a.BoundsStore=void 0;var k={minX:0,minY:0,maxX:0,maxY:0};z=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=q(9,r("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,e){b[c++]=e});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,b){this._loadIndex();var c=0,e=this._index;k.minX=a[0];k.minY=a[1];k.maxX=a[2];k.maxY=a[3];for(a=e.search(k);c<a.length;c++)b(this._idByBounds.get(a[c]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||(this._boundsToLoad.push(b),5E4<this._boundsToLoad.length&&this._loadIndex()))};return a}();a.BoundsStore=z})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(z){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function r(a,b){q(a,0,a.children.length,b,a)}function q(a,b,c,e,p){p||(p=d(null));p.minX=Infinity;p.minY=Infinity;p.maxX=-Infinity;p.maxY=-Infinity;for(var g;b<c;b++)g=a.children[b],k(p,a.leaf?e(g):g);return p}function k(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function e(a,b){return a.minY-b.minY}function b(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function p(a){return a.maxX-a.minX+(a.maxY-a.minY)}function u(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function x(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function d(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function y(a,b,c,d,e){for(var g=[b,c],t;g.length;)c=g.pop(),b=g.pop(),c-b<=d||(t=b+Math.ceil((c-b)/d/2)*d,z(a,t,b,c,e),g.push(b,t,t,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],d=this.toBBox;if(!x(a,b))return c;for(var e=[],g,t,l,k;b;){g=0;for(t=b.children.length;g<t;g++)l=b.children[g],k=b.leaf?d(l):l,x(a,k)&&(b.leaf?c.push(l):u(a,k)?this._all(l,c):e.push(l));b=e.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!x(a,b))return!1;for(var d=[],e,g,t,l;b;){e=0;for(g=b.children.length;e<g;e++)if(t=b.children[e],l=b.leaf?c(t):t,x(a,l)){if(b.leaf||u(a,l))return!0;d.push(t)}b=d.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=d([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,d=this.toBBox(a),e=[],g=[],t,l,k,p;c||e.length;){c||(c=e.pop(),l=e[e.length-1],t=g.pop(),p=!0);if(c.leaf){a:{k=a;var n=c.children,v=b;if(v){for(var x=0;x<n.length;x++)if(v(k,n[x])){k=x;break a}k=-1}else k=n.indexOf(k)}if(-1!==k){c.children.splice(k,
1);e.push(c);this._condense(e);break}}p||c.leaf||!u(c,d)?l?(t++,c=l.children[t],p=!1):c=null:(e.push(c),g.push(t),t=0,l=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:e,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,e){var k=c-b+1,g=this._maxEntries,t;if(k<=g)return t=d(a.slice(b,c+1)),r(t,
this.toBBox),t;e||(e=Math.ceil(Math.log(k)/Math.log(g)),g=Math.ceil(k/Math.pow(g,e-1)));t=d([]);t.leaf=!1;t.height=e;var k=Math.ceil(k/g),g=k*Math.ceil(Math.sqrt(g)),l,p,n;for(y(a,b,c,g,this.compareMinX);b<=c;b+=g)for(p=Math.min(b+g-1,c),y(a,b,p,k,this.compareMinY),l=b;l<=p;l+=k)n=Math.min(l+k-1,p),t.children.push(this._build(a,l,n,e-1));r(t,this.toBBox);return t},_chooseSubtree:function(a,c,d,e){for(var k,g,t,l,p,n,u,v;;){e.push(c);if(c.leaf||e.length-1===d)break;u=v=Infinity;k=0;for(g=c.children.length;k<
g;k++)t=c.children[k],p=b(t),n=(Math.max(t.maxX,a.maxX)-Math.min(t.minX,a.minX))*(Math.max(t.maxY,a.maxY)-Math.min(t.minY,a.minY))-p,n<v?(v=n,u=p<u?p:u,l=t):n===v&&p<u&&(u=p,l=t);c=l||c.children[0]}return c},_insert:function(a,b,c){var d=this.toBBox;c=c?a:d(a);var d=[],e=this._chooseSubtree(c,this.data,b,d);e.children.push(a);for(k(e,c);0<=b;)if(d[b].children.length>this._maxEntries)this._split(d,b),b--;else break;this._adjustParentBBoxes(c,d,b)},_split:function(a,b){var c=a[b],e=c.children.length,
k=this._minEntries;this._chooseSplitAxis(c,k,e);e=this._chooseSplitIndex(c,k,e);e=d(c.children.splice(e,c.children.length-e));e.height=c.height;e.leaf=c.leaf;r(c,this.toBBox);r(e,this.toBBox);b?a[b-1].children.push(e):this._splitRoot(c,e)},_splitRoot:function(a,b){this.data=d([a,b]);this.data.height=a.height+1;this.data.leaf=!1;r(this.data,this.toBBox)},_chooseSplitIndex:function(a,c,d){var e,k,g,t,l,p,u;l=p=Infinity;for(e=c;e<=d-c;e++)k=q(a,0,e,this.toBBox),g=q(a,e,d,this.toBBox),t=Math.max(0,Math.min(k.maxX,
g.maxX)-Math.max(k.minX,g.minX))*Math.max(0,Math.min(k.maxY,g.maxY)-Math.max(k.minY,g.minY)),k=b(k)+b(g),t<l?(l=t,u=e,p=k<p?k:p):t===l&&k<p&&(p=k,u=e);return u},_chooseSplitAxis:function(a,b,d){var k=a.leaf?this.compareMinX:c,p=a.leaf?this.compareMinY:e,g=this._allDistMargin(a,b,d,k);b=this._allDistMargin(a,b,d,p);g<b&&a.children.sort(k)},_allDistMargin:function(a,b,c,d){a.children.sort(d);d=this.toBBox;var e=q(a,0,b,d),g=q(a,c-b,c,d),t=p(e)+p(g),l,u;for(l=b;l<c-b;l++)u=a.children[l],k(e,a.leaf?d(u):
u),t+=p(e);for(l=c-b-1;l>=b;l--)u=a.children[l],k(g,a.leaf?d(u):u),t+=p(g);return t},_adjustParentBBoxes:function(a,b,c){for(;0<=c;c--)k(b[c],a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():r(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function z(q,k,c,e,b){for(;e>c;){if(600<e-c){var p=e-c+1,u=k-c+1,x=Math.log(p),d=.5*Math.exp(2*x/3),x=.5*Math.sqrt(x*d*(p-d)/p)*(0>u-p/2?-1:1);z(q,k,Math.max(c,Math.floor(k-u*d/p+x)),Math.min(e,Math.floor(k+(p-u)*d/p+x)),b)}p=q[k];u=c;d=e;a(q,c,k);for(0<b(q[e],p)&&a(q,c,e);u<d;){a(q,u,d);u++;for(d--;0>b(q[u],p);)u++;for(;0<b(q[d],p);)d--}0===b(q[c],p)?
a(q,c,d):(d++,a(q,d,e));d<=k&&(c=d+1);k<=d&&(e=d-1)}}function a(a,k,c){var e=a[k];a[k]=a[c];a[c]=e}function r(a,k){return a<k?-1:a>k?1:0}return function(a,k,c,e,b){z(a,k,c||0,e||a.length-1,b||r)}})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(z,a,r,q,k){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter=void 0;a.optimizedFeatureQueryEngineAdapter=
{getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,e){return a.attributes[e]},cloneWithGeometry:function(a,e){return new q.default(e,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,e){a.centroid||(a.centroid=r.getCentroidOptimizedGeometry(new k.default,a.geometry,e.hasZ,e.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/centroid":function(){define(["require",
"exports"],function(z,a){function r(a,c,e,b,p,u,x){void 0===x&&(x=1);u=p?u?4:3:u?3:2;var d=e,k=e+u,v=0,n=0,q=e=0,r=0,C=0;for(--b;C<b;C++,d+=u,k+=u){var g=c[d],t=c[d+1],l=c[d+2],H=c[k],O=c[k+1],D=c[k+2],M=g*O-H*t,q=q+M,v=v+(g+H)*M,n=n+(t+O)*M;p&&(M=g*D-H*l,e+=(l+D)*M,r+=M);g<a[0]&&(a[0]=g);g>a[1]&&(a[1]=g);t<a[2]&&(a[2]=t);t>a[3]&&(a[3]=t);p&&(l<a[4]&&(a[4]=l),l>a[5]&&(a[5]=l))}0<q*x&&(q*=-1);0<r*x&&(r*=-1);if(!q)return null;a=[v,n,.5*q];p&&(a[3]=e,a[4]=.5*r);return a}function q(a,c,e,b,p){p=b?p?4:
3:p?3:2;for(var k=c,x=c+p,d=0,q=0,v=0,n=0,r=0,z=e-1;r<z;r++,k+=p,x+=p){var C=a[k],g=a[k+1],t=a[k+2],l=a[x],H=a[x+1],O=a[x+2],D;if(b){D=l-C;var M=H-g,N=O-t;D=Math.sqrt(D*D+M*M+N*N)}else D=l-C,M=H-g,D=Math.sqrt(D*D+M*M);D&&(d+=D,b?(C=[C+.5*(l-C),g+.5*(H-g),t+.5*(O-t)],q+=D*C[0],v+=D*C[1],n+=D*C[2]):(C=[C+.5*(l-C),g+.5*(H-g)],q+=D*C[0],v+=D*C[1]))}return 0<d?b?[q/d,v/d,n/d]:[q/d,v/d]:0<e?b?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.lineCentroid=a.getCentroidOptimizedGeometry=
void 0;a.getCentroidOptimizedGeometry=function(a,c,e,b,p){if(!c||!c.lengths.length)return null;var k="upperLeft"===(null===p||void 0===p?void 0:p.originPosition)?-1:1;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);p=a.coords;for(var x=[],d=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],
y=c.lengths,v=c.coords,n=e?b?4:3:b?3:2,z=0,F=0;F<y.length;F++){var C=y[F],g=r(d,v,z,C,e,b,k);g&&x.push(g);z+=C*n}x.sort(function(a,b){var c=k*a[2]-k*b[2];0===c&&e&&(c=a[4]-b[4]);return c});x.length&&(n=6*x[0][2],p[0]=x[0][0]/n,p[1]=x[0][1]/n,e&&(n=6*x[0][4],p[2]=0!==n?x[0][3]/n:0),p[0]<d[0]||p[0]>d[1]||p[1]<d[2]||p[1]>d[3]||e&&(p[2]<d[4]||p[2]>d[5]))&&(p.length=0);if(!p.length)if(c=c.lengths[0]?q(v,0,y[0],e,b):null)p[0]=c[0],p[1]=c[1],e&&2<c.length&&(p[2]=c[2]);else return null;return a};a.lineCentroid=
q})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(z,a,r,q,k,c,e,b,p){function u(a,b){var c;if(!b)return null;if("x"in b){var g={x:0,y:0};a=a(b.x,b.y,v);g.x=a[0];g.y=a[1];null!=b.z&&(g.z=b.z);null!=b.m&&(g.m=b.m);return g}if("xmin"in
b)return g={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,v),g.xmin=c[0],g.ymin=c[1],a=a(b.xmax,b.ymax,v),g.xmax=a[0],g.ymax=a[1],b.hasZ&&(g.zmin=b.zmin,g.zmax=b.zmax,g.hasZ=!0),b.hasM&&(g.mmin=b.mmin,g.mmax=b.mmax,g.hasM=!0),g;if("rings"in b)return{rings:x(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:x(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:d(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function x(a,b){for(var c=[],g=0;g<a.length;g++)c.push(d(a[g],b));return c}
function d(a,b){for(var c=[],d=0;d<a.length;d++){var g=a[d],e=b(g[0],g[1],[0,0]);c.push(e);2<g.length&&e.push(g[2]);3<g.length&&e.push(g[3])}return c}function y(a,c){return!b.isValid(a)||!b.isValid(c)||b.equals(a,c)||p.canProject(a,c)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});a.projectMany=a.project=a.checkProjectionSupport=a.doesBrowserSupportProjection=void 0;var v=[0,0];a.doesBrowserSupportProjection=function(a,b){return y(a,b)?c.isSupported():!0};a.checkProjectionSupport=function(a,
b){return r.__awaiter(this,void 0,void 0,function(){var d,g,e;return r.__generator(this,function(l){if(!b)return[2];if(Array.isArray(a)){d=0;for(g=a;d<g.length;d++)if(e=g[d],y(e.geometry&&e.geometry.spatialReference,b)){if(c.isSupported())return[2,c.load()];throw new q("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});}return[2]}if(!y(a,b))return[2];if(c.isSupported())return[2,c.load()];throw new q("feature-store:unsupported-query","projection not supported",
{inSpatialReference:a,outSpatialReference:b});})})};var n=u.bind(null,p.lngLatToXY),G=u.bind(null,p.xyToLngLat);a.project=function(a,d,k){if(!a)return a;k||(k=d,d=a.spatialReference);return b.isValid(d)&&b.isValid(k)&&!b.equals(d,k)?p.canProject(d,k)?b.isWebMercator(k)?n(a):G(a):c.projectMany(e.jsonAdapter,[a],d,k,null)[0]:a};var F=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,c,d){return r.__awaiter(this,void 0,void 0,
function(){var g,e=this;return r.__generator(this,function(l){a&&a.length&&c&&d&&!b.equals(c,d)||k.resolve(a);g={geometries:a,inSpatialReference:c,outSpatialReference:d,resolve:null};this._jobs.push(g);return[2,k.create(function(a){g.resolve=a;null===e._timer&&(e._timer=setTimeout(e._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var d=a.geometries,l=a.inSpatialReference,k=a.outSpatialReference,a=a.resolve;p.canProject(l,k)?b.isWebMercator(k)?
a(d.map(n)):a(d.map(G)):a(c.projectMany(e.jsonAdapter,d,l,k,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(d){return[2,F.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),function(z,a,r,q,k){function c(a,c,p,u,q){void 0===
q&&(q=null);if(null===q){var d=k.cacheKey(p,u);void 0!==x[d]?q=x[d]:(q=e(p,u,null),null===q&&(q=new k),x[d]=q)}return b._project(a,c,p,u,q)}function e(a,c,e){void 0===e&&(e=null);a=b._getTransformation(p,a,c,e,null===e||void 0===e?void 0:e.spatialReference);return null!==a?k.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});a.getTransformations=a.getTransformation=a.projectMany=a.project=a.load=a.isSupported=a.isLoaded=void 0;var b=null,p=null;a.isLoaded=function(){return!!b&&q.isLoaded()};
a.isSupported=function(){return q.isSupported()};var u=null;a.load=function(){return u?u:u=r.all([q.load(),new Promise(function(a,b){z(["./geometryEngineBase"],a,b)}),new Promise(function(a,b){z(["./geometryAdapters/hydrated"],a,b)})]).then(function(a){var c=a[1];p=a[2].hydratedAdapter;b=c;b._enableProjection(q)})};a.project=function(a,b,e){void 0===e&&(e=null);return a instanceof Array?0===a.length?[]:c(p,a,a[0].spatialReference,b,e):c(p,[a],a.spatialReference,b,e)[0]};var x={};a.projectMany=c;a.getTransformation=
e;a.getTransformations=function(a,c,e){void 0===e&&(e=null);a=b._getTransformationBySuitability(p,a,c,e,null===e||void 0===e?void 0:e.spatialReference);if(null!==a){c=[];for(e=0;e<a.length;e++)c.push(k.fromGE(a[e]));return c}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(z,a,r,q,k,c){function e(b){function c(a,b,c){a[b]=c(a[b])}a._pe=b;y.init();v.init();n.init();G.init();F.init();
a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}r.__extends(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var d=0,e=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];d<e.length;d++)b=e[d],c(b.prototype,"getName",function(a){return function(){return a.call(this,Array(y.PE_NAME_MAX))}});d=0;for(e=[a._pe.PeGeogtran,a._pe.PeProjcs];d<
e.length;d++)b=e[d],c(b.prototype,"getParameters",function(b){return function(){for(var c=Array(y.PE_PARM_MAX),d=b.call(this),g=0;g<c.length;g++){var e=a._pe.getValue(d,"*");c[g]=e?a._pe.wrapPointer(e,a._pe.PeParameter):null;d+=Int32Array.BYTES_PER_ELEMENT}return c}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var c=[],d=a.call(this);x(c,b,d);return c}});c(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();
return function(){var d=null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var d=[g],e=this.getSteps();if(1<e)for(var g=a._pe.getPointer(g),l=1;l<e;l++)d.push(a._pe.wrapPointer(g+c*l,a._pe.PeGTlistExtendedGTs))}return d}});var k=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var d=null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var d=[g],e=g.getNump();if(1<e)for(var g=a._pe.getPointer(g),l=1;l<e;l++)d.push(a._pe.wrapPointer(g+
k*l,a._pe.PeHorizon))}c.set(b,d);return d}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=y.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),d=a._pe.ensureInt8(Array(y.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,d))}}function b(b){if(b){var c=a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}
function p(b,c){var d=[];c=Array(c);for(var g=0;g<b;g++)d.push(a._pe.ensureInt8(c));return d}function u(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function x(b,c,d,e){void 0===e&&(e=!1);if(e)for(e=0;e<2*c;e++)b[e]=a._pe.getValue(d+e*Float64Array.BYTES_PER_ELEMENT,"double");else{var g=0===b.length;for(e=0;e<c;e++)g&&(b[e]=Array(2)),b[e][0]=a._pe.getValue(d,"double"),b[e][1]=a._pe.getValue(d+Float64Array.BYTES_PER_ELEMENT,"double"),d+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});a._init=a.PeVersion=a.PePCSInfo=a.PeNotationUtm=a.PeNotationUsng=a.PeNotationMgrs=a.PeNotationDms=a.PeGTTransformations=a.PeGTlistExtendedEntry=a.PeGTlistExtended=a.PeGCSExtent=a.PeFactory=a.PeDefs=a.PeCSTransformations=a.load=a.isSupported=a.isLoaded=a._pe=void 0;var d;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!k("esri-wasm")};a.load=function(){return d?d:d=c.create(function(a,b){(new Promise(function(a,b){z(["./support/pe-wasm"],
a,b)})).then(function(c){c({locateFile:function(a){return q.getAssetUrl("esri/geometry/support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){e(b);a()})})})};(function(b){function c(b,c,d){a._pe.ensureCache.prepare();var g=u(d),e=d===g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,g))&&x(d,c,g,e);return b}function d(a,b,c){return e(a,b,c,0)}function e(b,c,d,g){a._pe.ensureCache.prepare();var e=u(d),k=d===e,e=a._pe.ensureFloat64(e);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),
c,e,g))&&x(d,c,e,k);return b}b.geogToProj=c;b.projGeog=function(a,b,g,e){switch(e){case y.PE_TRANSFORM_P_TO_G:return d(a,b,g);case y.PE_TRANSFORM_G_TO_P:return c(a,b,g)}return 0};b.projToGeog=d;b.projToGeogCenter=e})(a.PeCSTransformations||(a.PeCSTransformations={}));var y;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(y=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var g=null,k=e[b];k||(k={},e[b]=k);k.hasOwnProperty(String(c))?g=k[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,
c),a._pe.compare(b,a._pe.NULL)||(g=b,k[c]=g));return g=d(g)}function d(b){if(b){var c=b.getType();switch(c){case y.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case y.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case y.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&y.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var e={},k={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(y.PE_TYPE_COORDSYS,
a)};b.factoryByType=c;b.fromString=function(b,c){var g=null,e=k[b];e||(e={},k[b]=e);e.hasOwnProperty(c)?g=e[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(g=b,e[c]=g));return g=d(g)};b.geogcs=function(a){return c(y.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(y.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(y.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(y.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var v;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,d,g,e,k,p){var l=null,t=new a._pe.PeInteger(p);try{var u=a._pe.PeGTlistExtended.prototype.getGTlist(b,d,g,e,k,t);if(p=t.val)if(l=[u],1<p){var w=a._pe.getPointer(u);for(b=1;b<p;b++)l.push(a._pe.wrapPointer(w+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(t)}return l}})(v=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(c){c.destroy=function(c){if(c&&c.length){for(var d=0;d<c.length;d++){var g=c[d];b(g);g.getEntries().forEach(function(a){b(a);a=a.getGeogtran();b(a);a.getParameters().forEach(b);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){b(a);var c=a.getDatum();b(c);b(c.getSpheroid());b(a.getPrimem());b(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(c[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,d,e,
k){a._pe.ensureCache.prepare();var g=u(d),l=d===g,g=a._pe.ensureFloat64(g),p=0;e&&(p=a._pe.ensureFloat64(e));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,g,p,k))&&x(d,c,g,l);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function c(b,c,d,g,e,k){a._pe.ensureCache.prepare();var l,t;switch(b){case "dd":l=a._pe._pe_geog_to_dd;t=y.PE_DD_MAX;break;case "ddm":l=a._pe._pe_geog_to_ddm;t=y.PE_DDM_MAX;break;case "dms":l=a._pe._pe_geog_to_dms,t=y.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));
c=u(g);c=a._pe.ensureFloat64(c);t=p(d,t);g=a._pe.ensureInt32(t);if(e=l(b,d,c,e,g))for(l=0;l<d;l++)k[l]=a._pe.UTF8ToString(t[l]);return e}function d(b,c,d,g,e){a._pe.ensureCache.prepare();var k;switch(b){case "dd":k=a._pe._pe_dd_to_geog;break;case "ddm":k=a._pe._pe_ddm_to_geog;break;case "dms":k=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(k=k(b,d,g,c))&&x(e,d,c);return k}b.geog_to_dms=
function(a,b,d,g,e){return c("dms",a,b,d,g,e)};b.dms_to_geog=function(a,b,c,g){return d("dms",a,b,c,g)};b.geog_to_ddm=function(a,b,d,g,e){return c("ddm",a,b,d,g,e)};b.ddm_to_geog=function(a,b,c,g){return d("ddm",a,b,c,g)};b.geog_to_dd=function(a,b,d,g,e){return c("dd",a,b,d,g,e)};b.dd_to_geog=function(a,b,c,g){return d("dd",a,b,c,g)}})(a.PeNotationDms||(a.PeNotationDms={}));var n;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,d,e,k,n,q){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=u(d);d=a._pe.ensureFloat64(b);b=p(c,y.PE_MGRS_MAX);var l=a._pe.ensureInt32(b);if(e=a._pe._pe_geog_to_mgrs_extended(g,
c,d,e,k,n,l))for(k=0;k<c;k++)q[k]=a._pe.UTF8ToString(b[k]);return e};b.mgrs_to_geog_extended=function(b,c,d,e,k){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(e=a._pe._pe_mgrs_to_geog_extended(g,c,d,e,b))&&x(k,c,b);return e}})(n=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,d,e,k,n,q){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));
b=u(d);d=a._pe.ensureFloat64(b);b=p(c,y.PE_MGRS_MAX);var l=a._pe.ensureInt32(b);if(e=a._pe._pe_geog_to_usng(g,c,d,e,k,n,l))for(k=0;k<c;k++)q[k]=a._pe.UTF8ToString(b[k]);return e};b.usng_to_geog=function(b,c,d,e){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(g=a._pe._pe_usng_to_geog(g,c,d,b))&&x(e,c,b);return g}})(a.PeNotationUsng||(a.PeNotationUsng={}));var G;(function(b){b.init=
function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,c,d,e,k){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=u(d);d=a._pe.ensureFloat64(b);b=p(c,y.PE_UTM_MAX);var l=a._pe.ensureInt32(b);if(e=a._pe._pe_geog_to_utm(g,c,d,e,l))for(g=0;g<c;g++)k[g]=a._pe.UTF8ToString(b[g]);return e};b.utm_to_geog=
function(b,c,d,e,k){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(e=a._pe._pe_utm_to_geog(g,c,d,e,b))&&x(k,c,b);return e}})(G=a.PeNotationUtm||(a.PeNotationUtm={}));var F;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(d,e){void 0===e&&(e=b.PE_PCSINFO_OPTION_DOMAIN);var g,k;c.has(d)&&(k=c.get(d),k[e]&&(g=k[e]));g||(g=a._pe.PePCSInfo.prototype.generate(d,e),k||(k=[],c.set(d,k)),k[e]=g);return g}})(F=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=e})},"esri/assets":function(){define(["require",
"exports","./request","./core/urlUtils"],function(z,a,r,q){function k(a){return q.join(z.toUrl("."),"../",a)}Object.defineProperty(a,"__esModule",{value:!0});a.getAssetUrl=a.fetchAsset=void 0;a.fetchAsset=function(a,e){return r(k(a),e)};a.getAssetUrl=k})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(z,a,r){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;
if(a&&a.steps){var c=0;for(a=a.steps;c<a.length;c++){var e=a[c];e instanceof r?this.steps.push(e):this.steps.push(new r({wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(k){var c=new a,e="",b=0;for(k=k.steps;b<k.length;b++){var p=r.fromGE(k[b]);
c.steps.push(p);e+=p.uid.toString()+","}c._cached_projection={};c._gtlistentry=null;c._chain=e;return c};a.prototype.getInverse=function(){var k=new a;k.steps=[];for(var c=this.steps.length-1;0<=c;c--)k.steps.push(this.steps[c].getInverse());return k};a.prototype.getGTListEntry=function(){for(var a="",c=0,e=this.steps;c<e.length;c++)a+=e[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(k,
c,e){this._cached_projection[a.cacheKey(k,c)]=e};a.prototype.getCachedGeTransformation=function(k,c){for(var e="",b=0,p=this.steps;b<p.length;b++)e+=p[b].uid.toString()+",";e!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=e);k=this._cached_projection[a.cacheKey(k,c)];return void 0===k?null:k};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(z,a){var r=0;return function(){function a(a){void 0===a&&(a=
null);this.uid=r++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(k){var c=new a;c._wkt=k.wkt;c._wkid=k.wkid;c._isInverse=k.isInverse;return c};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=r++},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},
set:function(a){this._wkid=a;this.uid=r++},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=r++},enumerable:!1,configurable:!0});a.prototype.getInverse=function(){var k=new a;k._wkt=this.wkt;k._wkid=this._wkid;k._isInverse=!this.isInverse;return k};return a}()})},"esri/geometry/geometryAdapters/json":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",
{value:!0});a.jsonAdapter=void 0;a.jsonAdapter={convertToGEGeometry:function(a,c){return null==c?null:a.convertJSONToGeometry(c)},exportPoint:function(a,c,e){e=new r(a.getPointX(c),a.getPointY(c),e);var b=a.hasZ(c),d=a.hasM(c);b&&(e.z=a.getPointZ(c));d&&(e.m=a.getPointM(c));return e},exportPolygon:function(a,c,e){return new q(a.exportPaths(c),e,a.hasZ(c),a.hasM(c))},exportPolyline:function(a,c,e){return new k(a.exportPaths(c),e,a.hasZ(c),a.hasM(c))},exportMultipoint:function(a,e,k){return new c(a.exportPoints(e),
k,a.hasZ(e),a.hasM(e))},exportExtent:function(a,c,k){var b=a.hasZ(c),d=a.hasM(c);k=new e(a.getXMin(c),a.getYMin(c),a.getXMax(c),a.getYMax(c),k);b&&(b=a.getZExtent(c),k.zmin=b.vmin,k.zmax=b.vmax);d&&(a=a.getMExtent(c),k.mmin=a.vmin,k.mmax=a.vmax);return k}};var r=function(){return function(a,c,e){this.x=a;this.y=c;this.spatialReference=e;this.m=this.z=void 0}}(),q=function(){return function(a,c,e,k){this.rings=a;this.spatialReference=c;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);k&&(this.hasM=k)}}(),
k=function(){return function(a,c,e,k){this.paths=a;this.spatialReference=c;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);k&&(this.hasM=k)}}(),c=function(){return function(a,c,e,k){this.points=a;this.spatialReference=c;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);k&&(this.hasM=k)}}(),e=function(){return function(a,c,e,k,d){this.xmin=a;this.ymin=c;this.xmax=e;this.ymax=k;this.spatialReference=d;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports tslib ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(z,a,r,q,k,c,e,b,p,u,x,d,y,v,n,G,F,C,g,t,l,H,O,D){function M(a){return a.every(function(a){return"exceedslimit"!==a.statisticType})}Object.defineProperty(a,"__esModule",{value:!0});a.Feature=void 0;z=function(){return function(a,b,c,m,d){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=m;this.filterFlags=d;this.groupId=-1;this.displayId=b}}();a.Feature=z;var N=new Set,J=new e.MemCacheStorage(2E6),I=0;z=function(){function a(a){var b=this;this.capabilities={query:C.queryCapabilities};
this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new e.MemCache(I++ +"$$",J));this.fieldsIndex=new O(a.fields);a.scheduler&&a.task&&(this._frameQueue=new D.default,
this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",
{get:function(){return this.featureStore.featureAdapter},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:H.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=l.getTimeExtent(this.timeInfo,
this.featureStore):null},enumerable:!1,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,m,d=this;return r.__generator(this,function(e){switch(e.label){case 0:b=k.clone(a),e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this._schedule(function(){return H.normalizeQuery(b,d.definitionExpression,
d.spatialReference)})];case 2:return b=e.sent(),[4,this._reschedule(function(){return d._checkQuerySupport(b)})];case 3:return b=e.sent(),[4,this._reschedule(function(){return d._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),
[3,9];case 8:m=e.sent();if(m!==H.QUERY_ENGINE_EMPTY_RESULT)throw m;c=new g.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,m,d=this;return r.__generator(this,function(e){switch(e.label){case 0:b=k.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this._schedule(function(){return H.normalizeQuery(b,
d.definitionExpression,d.spatialReference)})];case 2:return b=e.sent(),[4,this._reschedule(function(){return d._checkQuerySupport(b)})];case 3:return b=e.sent(),[4,this._reschedule(function(){return d._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];
case 7:return c=e.sent(),[3,9];case 8:m=e.sent();if(m!==H.QUERY_ENGINE_EMPTY_RESULT)throw m;return[2,0];case 9:return[2,c.createQueryResponseForCount(b)]}})})};a.prototype.executeQueryForExtent=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,d,e,g,l,p,E,t=this;return r.__generator(this,function(I){switch(I.label){case 0:b=k.clone(a),d=b.outSR,I.label=1;case 1:return I.trys.push([1,8,,9]),[4,this._schedule(function(){return H.normalizeQuery(b,t.definitionExpression,
t.spatialReference)})];case 2:return b=I.sent(),[4,this._reschedule(function(){return t._checkQuerySupport(b)})];case 3:return b=I.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return t._executeGeometryQuery(b)})];case 4:return c=I.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=I.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=I.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];
case 7:c=I.sent();e=c.size;if(!e)return[2,{count:e,extent:null}];x.set(m,x.NEGATIVE_INFINITY);this.featureStore.forEachBounds(c.items,function(a){return x.expand(m,a)},w);g={xmin:m[0],ymin:m[1],xmax:m[3],ymax:m[4],spatialReference:H.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(m[2])&&isFinite(m[5])&&(g.zmin=m[2],g.zmax=m[5]);l=F.project(g,c.spatialReference,d);l.spatialReference=H.cleanFromGeometryEngine(d||this.spatialReference);0===l.xmax-l.xmin&&(p=u.getMetersPerUnitForSR(l.spatialReference),
l.xmin-=p,l.xmax+=p);0===l.ymax-l.ymin&&(p=u.getMetersPerUnitForSR(l.spatialReference),l.ymin-=p,l.ymax+=p);this.hasZ&&null!=l.zmin&&null!=l.zmax&&0===l.zmax-l.zmin&&(p=u.getMetersPerUnitForSR(l.spatialReference),l.zmin-=p,l.zmax+=p);return[2,{count:e,extent:l}];case 8:E=I.sent();if(E===H.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw E;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,
function(c){return[2,this.executeQueryForIdSet(a,b).then(function(a){return p.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,m,d,e,g=this;return r.__generator(this,function(w){switch(w.label){case 0:b=k.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,w.label=1;case 1:return w.trys.push([1,9,,10]),[4,this._schedule(function(){return H.normalizeQuery(b,g.definitionExpression,g.spatialReference)})];
case 2:return b=w.sent(),[4,this._reschedule(function(){return g._checkQuerySupport(b)})];case 3:return b=w.sent(),[4,this._reschedule(function(){return g._executeGeometryQuery(b)})];case 4:return c=w.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=w.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=w.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=w.sent(),m=c.items,d=new Set,
[4,this._reschedule(function(){for(var a=0,b=m;a<b.length;a++)d.add(c.featureAdapter.getObjectId(b[a]))})];case 8:return w.sent(),[2,d];case 9:e=w.sent();if(e===H.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw e;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,m,d=this;return r.__generator(this,function(e){switch(e.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new q("feature-store:unsupported-query",
"Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});b=k.clone(a);e.label=1;case 1:return e.trys.push([1,9,,10]),[4,this._schedule(function(){return H.normalizeQuery(b,d.definitionExpression,d.spatialReference)})];case 2:return b=e.sent(),[4,this._reschedule(function(){return d._checkQuerySupport(b)})];case 3:return b=e.sent(),[4,this._reschedule(function(){return d._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];
case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),[4,this._reschedule(function(){return c.filterLatest()})];case 8:return c=e.sent(),[3,10];case 9:m=e.sent();if(m!==H.QUERY_ENGINE_EMPTY_RESULT)throw m;c=new g.default([],null,this);return[3,10];case 10:return[2,c.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return r.__awaiter(this,
void 0,void 0,function(){return r.__generator(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=
[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new g.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return r.__awaiter(this,void 0,void 0,function(){var b,m,d,e,k,w,l,p,E,I,u,J,ca,q,x,v,H,D,y,N,O=this;return r.__generator(this,function(P){switch(P.label){case 0:b=a.geometry;m=a.outSR;d=a.spatialRel;e=n.isValid(m)&&!n.equals(this.spatialReference,m);if(k=this._geometryQueryCache?e?JSON.stringify({geometry:b,spatialRelationship:d,
outSpatialReference:m}):JSON.stringify({geometry:b,spatialRelationship:d}):null)if(w=this._geometryQueryCache.get(k),!c.isUndefined(w))return[2,w];l=function(b){return r.__awaiter(O,void 0,void 0,function(){var c;return r.__generator(this,function(d){switch(d.label){case 0:return e&&(a.returnGeometry||a.returnCentroid)?[4,b.project(m)]:[3,2];case 1:return c=d.sent(),k&&this._geometryQueryCache.put(k,c,c.size||1),[2,c];case 2:return k&&this._geometryQueryCache.put(k,b,b.size||1),[2,b]}})})};if(!b)return[2,
l(this._getAll())];p=this.featureAdapter;if("esriSpatialRelDisjoint"!==d)return[3,3];E=this._searchFeatures(this._getQueryBBoxes(b));if(!E.length)return[2,l(this._getAll())];J=new Set;ca=0;for(q=E;ca<q.length;ca++)x=q[ca],J.add(p.getObjectId(x));return[4,this._reschedule(function(){var a=0;I=Array(J.size);O.featureStore.forEach(function(b){return I[a++]=b});u=J})];case 1:return P.sent(),[4,this._reschedule(function(){return r.__awaiter(O,void 0,void 0,function(){var a,c,m;return r.__generator(this,
function(e){switch(e.label){case 0:return[4,t.getSpatialQueryOperator(d,b,this.geometryType,this.hasZ,this.hasM)];case 1:return a=e.sent(),c=function(b){return!u.has(p.getObjectId(b))||a(p.getGeometry(b))},m=g.default.bind,[4,this._runSpatialFilter(I,c)];case 2:return[2,new (m.apply(g.default,[void 0,e.sent(),b,this]))]}})})})];case 2:return v=P.sent(),[2,l(v)];case 3:return H=this._searchFeatures(this._getQueryBBoxes(b)),H.length?(D=this._canExecuteSoloPass(b,a))?[2,l(new g.default(H,b,this))]:[4,
t.getSpatialQueryOperator(d,b,this.geometryType,this.hasZ,this.hasM)]:(v=new g.default([],b,this),k&&this._geometryQueryCache.put(k,v,v.size||1),[2,v]);case 4:return y=P.sent(),[4,this._runSpatialFilter(H,function(a){return y(p.getGeometry(a))})];case 5:return N=P.sent(),[2,l(new g.default(N,b,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return r.__awaiter(this,void 0,void 0,function(){var c,m,d,e=this;return r.__generator(this,function(g){if(!b)return[2,a];if(!this._budget)return[2,
a.filter(function(a){return b(a)})];c=0;m=[];d=function(){return r.__awaiter(e,void 0,void 0,function(){var e;return r.__generator(this,function(g){switch(g.label){case 0:if(!(c<a.length))return[3,3];e=a[c];b(e)&&m.push(e);return this._budget.done?[4,this._reschedule(function(){return d()})]:[3,2];case 1:g.sent(),g.label=2;case 2:return++c,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return d()}).then(function(){return m})]})})};a.prototype._canExecuteSoloPass=function(a,b){var c=
this.geometryType;b=b.spatialRel;return t.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(t.canQueryWithRBush(a)){if(v.isExtent(a))return[d.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(v.isPolygon(a))return a.rings.map(function(a){return d.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),
Math.max(a[0][1],a[2][1]))})}return[y.getBoundsXY(d.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){N.add(a)});var c=Array(N.size),m=0;N.forEach(function(a){return c[m++]=a});N.clear();return c};a.prototype._checkQuerySupport=function(a){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||
a.text)throw new q("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,b.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),t.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),F.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,m=a.returnDistinctValues,d=a.outStatistics,e=d?d.map(function(a){return a.outStatisticFieldName&&
a.outStatisticFieldName.toLowerCase()}):[];c&&0<c.length&&(c=c.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?b.split(" asc")[0]:-1<b.indexOf(" desc")?b.split(" desc")[0]:a}).filter(function(a){return-1===e.indexOf(a)}),G.validateFields(this.fieldsIndex,c,"orderByFields contains missing fields"));if(b&&0<b.length)G.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(m)throw new q("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",
{query:a});G.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return r.__awaiter(this,void 0,void 0,function(){var b,c,m,d,e,g,k,w,l,p,E,t,I;return r.__generator(this,function(u){b=a.outStatistics;c=a.groupByFieldsForStatistics;m=a.having;d=c&&c.length;e=b&&b.length;if(m){if(!d||!e)throw new q("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});G.validateHaving(this.fieldsIndex,m,b)}if(e){if(!M(b))return[2];
g=b.map(function(a){return a.onStatisticField});G.validateFields(this.fieldsIndex,g,"onStatisticFields contains missing fields");d&&G.validateFields(this.fieldsIndex,c,"groupByFieldsForStatistics contains missing fields");k=0;for(w=b;k<w.length;k++)if(l=w[k],p=l.onStatisticField,E=l.statisticType,(t="percentile_disc"===E||"percentile_cont"===E)&&"statisticParameters"in l){if(I=l.statisticParameters,!I)throw new q("feature-store:unsupported-query","statisticParamters should be set for percentile type",
{definition:l,query:a});}else if("count"!==E&&p&&G.hasInvalidFieldType(p,this.fieldsIndex))throw new q("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:l,query:a});}return[2]})})};return a}();a.default=z;var w=x.create(),m=x.create()})},"esri/core/MemCache":function(){define(["require","exports","./MapUtils","./PooledArray","./string"],function(z,a,r,q,k){Object.defineProperty(a,"__esModule",{value:!0});a.MemCacheStorage=a.MemCache=a.MIN_PRIORITY=void 0;a.MIN_PRIORITY=
-3;z=function(){function a(a,b,c){this._namespace=a;this._storage=b;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";c&&(this._storage.registerRemoveFunc(this._namespace,c),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!1,configurable:!0});
Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!1,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,b,c,k){void 0===
k&&(k=0);this._storage.put(this._namespace+a,b,c,k)};a.prototype.get=function(a){a=this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.updateSize=function(a,b,c){this._storage.updateSize(this._namespace+a,b,c)};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=
function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=z;z=function(){function c(a){void 0===a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new q}c.prototype.register=function(a){this._users.push(a)};c.prototype.deregister=function(a){this._users.removeUnordered(a)};c.prototype.registerRemoveFunc=function(a,b){this._removeFuncs.push([a,b])};c.prototype.deregisterRemoveFunc=
function(a){this._removeFuncs=this._removeFuncs.filter(function(b){return b[0]!==a})};Object.defineProperty(c.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._checkSizeLimit()},enumerable:!1,configurable:!0});c.prototype.put=function(c,b,k,u){var e=this._db.get(c);e&&(this._size-=e.size,this._db.delete(c),e.entry!==b&&this._notifyRemoved(c,
e.entry));k>this._maxSize?this._notifyRemoved(c,b):void 0===b?console.warn("Refusing to cache undefined entry "):!k||0>k?console.warn("Refusing to cache entry with invalid size "+k):(u=1+Math.max(u,a.MIN_PRIORITY)-a.MIN_PRIORITY,this._db.set(c,{entry:b,size:k,lifetime:u,lives:u}),this._size+=k,this._checkSizeLimit())};c.prototype.updateSize=function(a,b,c){var e=this._db.get(a);e&&e.entry===b&&(this._size-=e.size,c>this._maxSize?this._notifyRemoved(a,b):(e.size=c,this._size+=c,this._checkSizeLimit()))};
c.prototype.pop=function(a){var b=this._db.get(a);if(b)return this._size-=b.size,this._db.delete(a),++this._hit,b.entry;++this._miss};c.prototype.get=function(a){var b=this._db.get(a);if(void 0===b)++this._miss;else return this._db.delete(a),b.lives=b.lifetime,this._db.set(a,b),++this._hit,b.entry};c.prototype.getStats=function(){var c=this,b={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},
p={},u=[];this._db.forEach(function(a,b){var d=a.lifetime;u[d]=(u[d]||0)+a.size;c._users.forEachSimple(function(c){c=c.namespace;k.startsWith(b,c)&&(p[c]=(p[c]||0)+a.size)})});var q={};this._users.forEachSimple(function(a){var b=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(p[b]=p[b]||0,q[b]=Math.round(100*a.hitRate)+"%"):q[b]="0%"});var d=Object.keys(p);d.forEach(function(a){return p[a]=p[a]/c._size*100});d.sort(function(a,b){return p[b]-p[a]});d.forEach(function(a){return b[a]=Math.round(p[a])+"% / "+
q[a]});for(d=u.length-1;0<=d;--d){var r=u[d];r&&(b["Priority "+(d+a.MIN_PRIORITY-1)]=Math.round(r/this.size*100)+"%")}return b};c.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEachSimple(function(a){return a.resetHitRate()})};c.prototype.clear=function(a){var b=this;this._db.forEach(function(c,e){k.startsWith(e,a)&&(b._size-=c.size,b._db.delete(e),b._notifyRemoved(e,c.entry))})};c.prototype.clearAll=function(){var a=this;this._db.forEach(function(b,c){return a._notifyRemoved(c,
b.entry)});this._size=0;this._db.clear()};c.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};c.prototype._notifyRemoved=function(a,b){this._removeFuncs.forEach(function(c){if(k.startsWith(a,c[0]))c[1](b)})};c.prototype._checkSizeLimit=function(){var a=this;this._size<=this._maxSize||r.someMap(this._db,function(b,c){a._db.delete(c);1>=b.lives?(a._size-=b.size,a._notifyRemoved(c,b.entry)):(--b.lives,a._db.set(c,b));return a._size<=.9*a.maxSize})};return c}();a.MemCacheStorage=
z})},"esri/core/MapUtils":function(){define(["require","exports","./maybe"],function(z,a,r){function q(a){if(0===a.size)throw Error("Map is empty");return a.keys().next().value}function k(a){if(0===a.size)throw Error("Map is empty");var b=void 0,c=!1;a.forEach(function(a,d){c||(b=d,c=!0)});return r.assumeNonNull(b)}function c(a){if(0===a.size)throw Error("Map is empty");return a.values().next().value}function e(a){if(0===a.size)throw Error("Map is empty");var b=void 0,c=!1;a.forEach(function(a){c||
(b=a,c=!0)});return r.assumeNonNull(b)}Object.defineProperty(a,"__esModule",{value:!0});a.test=a.firstValueOfMap=a.firstKeyOfMap=a.MapFromValues=a.keysOfMap=a.valuesOfMap=a.pairsOfMap=a.someMap=void 0;a.someMap=Map.prototype.entries?function(a,b){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(b(c.value[1],c.value[0]))return!0;return!1}:function(a,b){var c=!0;a.forEach(function(a,d){c&&(c=!b(a,d))});return!c};z=!!Map.prototype.values;var b=!!Map.prototype.keys,p=!!Array.from;a.pairsOfMap=function(a){var b=
[];a.forEach(function(a,c){return b.push([c,a])});return b};a.valuesOfMap=z&&p?function(a){return Array.from(a.values())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a){return b[c++]=a});return b};a.keysOfMap=b&&p?function(a){return Array.from(a.keys())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a,d){return b[c++]=d});return b};a.MapFromValues=z?function(a){return new Map(a)}:function(a){for(var b=new Map,c=0;c<a.length;c++){var e=a[c];b.set(e[0],e[1])}return b};a.firstKeyOfMap=
b?q:k;a.firstValueOfMap=z?c:e;a.test={firstKeyOfMapFallback:k,firstValueOfMapFallback:e}})},"esri/core/SetUtils":function(){define(["require","exports","./maybe"],function(z,a,r){function q(a){if(0===a.size)throw Error("Set is empty");return a.values().next().value}function k(a){if(0===a.size)throw Error("Set is empty");var b=void 0,c=!1;a.forEach(function(a){c||(b=a,c=!0)});return r.assumeNonNull(b)}Object.defineProperty(a,"__esModule",{value:!0});a.reduceSet=a.firstOfSet=a.SetFromValues=a.valuesOfSet=
a.someSet=void 0;a.someSet=Set.prototype.entries?function(a,b){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(b(c.value[0]))return!0;return!1}:function(a,b){var c=!0;a.forEach(function(a){c&&(c=!b(a))});return!c};z=!!Set.prototype.values;var c=!!Array.from;a.valuesOfSet=z&&c?function(a){return Array.from(a.values())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a){return b[c++]=a});return b};a.SetFromValues=z?function(a){return new Set(a)}:function(a){for(var b=new Set,c=0;c<a.length;c++)b.add(a[c]);
return b};a.firstOfSet=z?q:k;a.reduceSet=function(a,b,c){var e=c;a.forEach(function(a){return e=b(a,e)});return e}})},"esri/core/unitUtils":function(){define("require exports ./compilerUtils ./jsonMap ./SetUtils ../geometry/support/geodesicConstants ../geometry/support/WKIDUnitConversion".split(" "),function(z,a,r,q,k,c,e){function b(a){if(a=J[a])return a;throw Error("unknown measure");}function p(a){return N[a].baseUnit}function u(a,c){void 0===c&&(c=null);c=c||b(a);return N[c].baseUnit===a}function x(a,
c,m){if(c===m)return a;var d=b(c);if(d!==b(m))throw Error("incompatible units");a=u(c,d)?a:a*N[d].units[c].inBaseUnits;return u(m,d)?a:a/N[d].units[m].inBaseUnits}function d(a,b){return 3E3>x(a,b,"meters")?"meters":"kilometers"}function y(a,b){return 1E5>x(a,b,"meters")?"meters":"kilometers"}function v(a,b){return 1E3>x(a,b,"feet")?"feet":"miles"}function n(a,b){return 1E5>x(a,b,"feet")?"feet":"miles"}function G(a){return M.fromJSON(a.toLowerCase())||null}function F(a,b){void 0===b&&(b=t);return C(a,
!0)||b}function C(a,b){void 0===b&&(b=!1);var c,d,e;null!=a&&("object"===typeof a?(c=a.wkid,d=a.wkt):"number"===typeof a?c=a:"string"===typeof a&&(d=a));c?(e=O.values[O[c]],!e&&b&&D.has(c)&&(e=l)):d&&-1!==d.search(/^PROJCS/i)&&(a=H.exec(d))&&a[1]&&(e=parseFloat(a[1].split(",")[1]));return e}function g(a){var b,c,d;null!=a&&("object"===typeof a?(b=a.wkid,c=a.wkt):"number"===typeof a?b=a:"string"===typeof a&&(c=a));b?d=O.units[O[b]]:c&&-1!==c.search(/^PROJCS/i)&&(a=H.exec(c))&&a[1]&&(d=(a=/[\\"\\']{1}([^\\"\\']+)/.exec(a[1]))&&
a[1]);return d?G(d):null}Object.defineProperty(a,"__esModule",{value:!0});a.getDefaultUnitSystem=a.getUnitString=a.getMetersPerUnit=a.getMetersPerUnitForSR=a.getVerticalUnitStringForSR=a.getMetersPerVerticalUnitForSR=a.unitToRESTJSON=a.unitFromRESTJSON=a.lengthToDegrees=a.preferredImperialAreaUnit=a.preferredMetricAreaUnit=a.preferredImperialVerticalLengthUnit=a.preferredImperialLengthUnit=a.preferredMetricVerticalLengthUnit=a.preferredMetricLengthUnit=a.preferredVerticalLengthUnit=a.preferredLengthUnit=
a.convertUnit=a.isBaseUnit=a.baseUnitForUnit=a.baseUnitForMeasure=a.measureForUnit=a.measurementLengthUnits=a.measurementAreaUnits=a.inchesPerMeter=void 0;a.inchesPerMeter=39.37;var t=c.metersPerDegree,l=c.earthRadius*Math.PI/200,H=/UNIT\[([^\]]+)\]\]$/i,O=e,D=k.SetFromValues([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),M=q.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",
foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});z={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},
yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};q={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:function(a){return a*
a}(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};var N={length:{baseUnit:"meters",units:z},area:{baseUnit:"square-meters",units:q},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*
304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},J=function(){var a={},b;for(b in N)for(var c in N[b].units)a[c]=b;return a}();a.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");a.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");
a.measureForUnit=b;a.baseUnitForMeasure=p;a.baseUnitForUnit=function(a){return p(b(a))};a.isBaseUnit=u;a.convertUnit=x;a.preferredLengthUnit=function(a,b,c){switch(c){case "metric":return d(a,b);case "imperial":return v(a,b);default:return c}};a.preferredVerticalLengthUnit=function(a,b,c){switch(c){case "metric":return y(a,b);case "imperial":return n(a,b);default:return c}};a.preferredMetricLengthUnit=d;a.preferredMetricVerticalLengthUnit=y;a.preferredImperialLengthUnit=v;a.preferredImperialVerticalLengthUnit=
n;a.preferredMetricAreaUnit=function(a,b){return 3E6>x(a,b,"square-meters")?"square-meters":"square-kilometers"};a.preferredImperialAreaUnit=function(a,b){return 1E6>x(a,b,"square-feet")?"square-feet":"square-miles"};a.lengthToDegrees=function(a,b,d){void 0===d&&(d=c.earthRadius);return x(a,b,"meters")/(d*Math.PI/180)};a.unitFromRESTJSON=G;a.unitToRESTJSON=function(a){return M.toJSON(a)||null};a.getMetersPerVerticalUnitForSR=function(a){a=F(a);return 1E5<a?1:a};a.getVerticalUnitStringForSR=function(a){return 1E5<
F(a)?"meters":g(a)};a.getMetersPerUnitForSR=F;a.getMetersPerUnit=C;a.getUnitString=g;a.getDefaultUnitSystem=function(a){if(!a)return null;a=g(a);switch(a){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";case "50-kilometers":case "150-kilometers":case "meters":return"metric";
case null:case void 0:break;default:r.neverReached(a)}return null}})},"esri/layers/graphics/data/attributeSupport":function(){define(["require","exports","../../../core/Error","../../../core/SetUtils","../../../core/sql/WhereClauseCache"],function(z,a,r,q,k){function c(a,b){return a?p.get(a,b):null}function e(a,d,k,p){void 0===p&&(p=!0);for(var n=[],u=0;u<d.length;u++){var q=d[u];if("*"!==q&&!a.has(q))if(p){var v=b(q);try{var g=c(v,a);if(!g)throw new r("feature-store:unsupported-query","invalid SQL expression",
{where:v});if(!g.isStandardized)throw new r("feature-store:unsupported-query","expression is not standard",{clause:g});e(a,g.fieldNames,"expression contains missing fields")}catch(t){if((v=t&&t.details)&&(v.clause||v.where))throw t;v&&v.missingFields?n.push.apply(n,v.missingFields):n.push(q)}}else n.push(q)}if(n.length)throw new r("feature-store:unsupported-query",k,{missingFields:n});}function b(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});a.hasInvalidFieldType=a.getAliasFromFieldName=
a.getExpressionFromFieldName=a.validateFields=a.getWhereClause=a.validateHaving=a.validateWhere=void 0;var p=new k.WhereClauseCache(50,500),u=q.SetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;var c=p.get(b,a);if(!c)throw new r("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new r("feature-store:unsupported-query",
"where clause is not standard",{where:b});e(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var d=p.get(b,a);if(!d)throw new r("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!d.isAggregate)throw new r("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:b});e(a,d.fieldNames,"having contains missing fields");if(!d.getExpressions().every(function(b){var d=b.aggregateType;
b=b.field;var e=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===e&&b.toLowerCase().trim()===d})}))throw new r("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=c;a.validateFields=e;a.getExpressionFromFieldName=b;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!u.has(a.type):
!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(z,a,r,q){Object.defineProperty(a,"__esModule",{value:!0});a.WhereClauseCache=void 0;z=function(){function a(a,e){this._cache=new r(a);this._invalidCache=new r(e)}a.prototype.get=function(a,e){var b=e.uid+":"+a,c=this._cache.get(b);if(c)return c;if(void 0!==this._invalidCache.get(b))return null;try{var k=q.WhereClause.create(a,e);this._cache.put(b,k);return k}catch(x){return this._invalidCache.put(b,
null),null}};return a}();a.WhereClauseCache=z})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(z,a,r){return function(){function a(a,c){this._storage=new r.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};
a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(z,a,r,q,k,c,e){function b(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function p(a,c,d,e,g,k,l,p,t){void 0===d&&(d="0");void 0===e&&(e="0");void 0===g&&(g="0");void 0===k&&(k="0");void 0===l&&(l="");void 0===p&&(p="0");void 0===t&&(t="0");return"+"===
l||"-"===l?(a=b(parseInt(a,10),4)+"-"+b(parseInt(c,10),2)+"-"+b(parseInt(d,10),2),c="",10>parseFloat(k)&&(c="0"),e=b(parseInt(e,10),2)+":"+b(parseInt(g,10),2)+":"+(c+parseFloat(k).toString()),l=""+l+b(parseInt(p,10),2)+":"+b(parseInt(t,10),2),new Date(a+"T"+e+l)):new Date(parseInt(a,10),parseInt(c,10)-1,parseInt(d,10),parseInt(e,10),parseInt(g,10),parseFloat(k))}function u(a){var b=D.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],e=b[4],g=b[5],k=b[6];return p(a,c,d,e,g,k)}b=M.exec(a);if(null!==b){a=
b[1];var c=b[2],d=b[3],e=b[4],g=b[5],k=b[6],l=b[7],w=b[8],b=b[9];return p(a,c,d,e,g,k,l,w,b)}b=N.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],g=b[5],l=b[6],w=b[7],b=b[8],p(a,c,d,e,g,"0",l,w,b);b=J.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],g=b[5],p(a,c,d,e,g);b=O.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],p(a,c,d);throw Error("SQL Invalid Timestamp");}function x(a){a=O.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),
parseInt(b,10)-1,parseInt(c,10))}function d(a){return Array.isArray(a)?a:[a]}function y(a){return null!==a?!0!==a:null}function v(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function n(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function G(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var m=b[d];if(null==m)c=null;else if(a===m){c=!0;break}}return c}function F(a,b,c){if(null==a)return null;for(var d="",m=0,e=0;e<b.length;e++){var g=b.charAt(e);
switch(m){case 0:g===c?m=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):"%"===g?d+".*":"_"===g?d+".":d+g;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):d+g,m=0}}return(new RegExp("^"+d+"$")).test(a)}function C(a){return a instanceof Date?a.valueOf():a}function g(a,b,c){if(null==b||null==c)return null;b=C(b);c=C(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function t(a){for(var b=
[],c={},d=0;d<a.length;d++){var e=a[d],g=e.toLowerCase();void 0===c[g]&&(b.push(e),c[g]=1)}return b}function l(a,b,d){if(b instanceof c.SqlInterval)if(d instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+d.getTime());case "-":return b.valueInMilliseconds()-d.getTime();case "*":return b.valueInMilliseconds()*d.getTime();case "/":return b.valueInMilliseconds()/d.getTime()}else if(d instanceof c.SqlInterval)switch(a){case "+":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+
d.valueInMilliseconds());case "-":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-d.valueInMilliseconds());case "*":return b.valueInMilliseconds()*d.valueInMilliseconds();case "/":return b.valueInMilliseconds()/d.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(d instanceof c.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(d.valueInMilliseconds()+b.getTime());case "-":return new Date(b.getTime()-d.valueInMilliseconds());case "*":return b.getTime()*
d.valueInMilliseconds();case "/":return b.getTime()/d.valueInMilliseconds()}else d=d.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof d)switch(d*=864E5,b=b.getTime(),a){case "+":return new Date(b+d);case "-":return new Date(b-d);case "*":return new Date(b*d);case "/":return new Date(b/d)}else if(d instanceof Date&&"number"===typeof b)switch(b*=864E5,d=d.getTime(),a){case "+":return new Date(b+d);case "-":return new Date(b-d);case "*":return new Date(b*d);case "/":return new Date(b/
d)}switch(a){case "+":return b+d;case "-":return b-d;case "*":return b*d;case "/":return b/d}}function H(a,b,c,d){a=d.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});a.defaultAttributeAdapter=a.WhereClause=void 0;var O=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,D=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,M=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,N=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,
J=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,I=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,d){return H(a,b,c,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return F(a,b,c)};a.ensureArray=function(a){return d(a)};a.applyIn=function(a,b){return G(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=function(a,b,d){return c.SqlInterval.createFromValueAndQualifer(a,b,d)};a.convertInterval=
function(a){return a instanceof c.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return g(a,b,c)};a.calculate=function(a,b,c){return l(a,b,c)};a.makeComparable=function(a){return C(a)};a.evaluateFunction=function(a,b){return c.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==
b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return y(a)};a.ternaryAnd=function(a,b){return v(a,b)};a.ternaryOr=function(a,b){return n(a,b)};return a}();z=function(){function b(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=e.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;this.isStandardized=b;this.isAggregate=c}b.create=function(a,c){return new b(a,c)};Object.defineProperty(b.prototype,
"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!1,configurable:!0});b.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var d={},e=function(a){d[a]=b.map(function(b){return c.getAttribute(b,a)})},g=0,m=this.fieldNames;g<m.length;g++)e(m[g]);return!!this.evaluateNode(this.parseTree,{attributes:d},a.defaultAttributeAdapter)};b.prototype.calculateValue=function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,d);
return b instanceof c.SqlInterval?b.valueInMilliseconds()/864E5:b};b.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(r("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};b.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);
return!!this.evaluateNode(this.parseTree,b,c)};b.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(r("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};b.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===
b.type&&a.push(b.name.toLowerCase())});return t(a)};b.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var d=c+"-"+b;a.has(d)||a.set(d,{aggregateType:c,field:b})}}});return q.valuesOfMap(a)};b.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return t(a)};b.prototype.compileMe=
function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(I)};b.prototype.extractExpressionInfo=function(a){var b=this,d=[],e=!0,g=!0;this.visitAll(this.parseTree,function(m){switch(m.type){case "column_ref":var l=a.get(m.column),p=l&&l.name;!l||"date"!==l.type&&"esriFieldTypeDate"!==l.type||(b.datefields[l.name]=1);void 0!==p?(d.push(p),m.column=p):d.push(m.column);
break;case "function":l=m.name,m=m.args.value.length,e&&(e=c.isStandardized(l,m)),g&&(g=k.isAggregate(l,m))}});return{referencedFieldNames:t(d),isStandardized:e,isAggregate:g}};b.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];this.visitAll(e,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;
case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],this.visitAll(e,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};b.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===
a.format)for(var c="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",d=0;d<a.clauses.length;d++)b+=" ("+c+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";else for(b="( ",d=0;d<a.clauses.length;d++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";b=null!==a.else?b+
this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";c=0;for(a=a.value;c<a.length;c++)d=a[c],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(d);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+
this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+
","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+
JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+x(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+u(a.value).getTime().toString()+"))";case "current_time":return"date"===a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+
JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};b.prototype.evaluateNode=function(a,b,e){switch(a.type){case "interval":return b=this.evaluateNode(a.value,b,e),c.SqlInterval.createFromValueAndQualifer(b,a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var m=C(this.evaluateNode(a.operand,b,e)),p=0;p<a.clauses.length;p++){if(m===
C(this.evaluateNode(a.clauses[p].operand,b,e)))return this.evaluateNode(a.clauses[p].value,b,e)}else for(p=0;p<a.clauses.length;p++)if(!0===this.evaluateNode(a.clauses[p].operand,b,e))return this.evaluateNode(a.clauses[p].value,b,e);return null!==a.else?this.evaluateNode(a.else,b,e):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":m=[];p=0;for(a=a.value;p<a.length;p++)m.push(this.evaluateNode(a[p],b,e));return m;case "unary_expr":return y(this.evaluateNode(a.expr,b,
e));case "binary_expr":switch(a.operator){case "AND":return v(this.evaluateNode(a.left,b,e),this.evaluateNode(a.right,b,e));case "OR":return n(this.evaluateNode(a.left,b,e),this.evaluateNode(a.right,b,e));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,b,e);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,b,e);case "IN":return m=d(this.evaluateNode(a.right,b,e)),G(this.evaluateNode(a.left,
b,e),m);case "NOT IN":return m=d(this.evaluateNode(a.right,b,e)),y(G(this.evaluateNode(a.left,b,e),m));case "BETWEEN":return m=this.evaluateNode(a.left,b,e),a=this.evaluateNode(a.right,b,e),null==m||null==a[0]||null==a[1]?null:m>=C(a[0])&&m<=C(a[1]);case "NOTBETWEEN":return m=this.evaluateNode(a.left,b,e),a=this.evaluateNode(a.right,b,e),null==m||null==a[0]||null==a[1]?null:m<C(a[0])||m>C(a[1]);case "LIKE":return F(this.evaluateNode(a.left,b,e),this.evaluateNode(a.right,b,e),a.escape);case "NOT LIKE":return y(F(this.evaluateNode(a.left,
b,e),this.evaluateNode(a.right,b,e),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return g(a.operator,this.evaluateNode(a.left,b,e),this.evaluateNode(a.right,b,e));case "-":case "+":case "*":case "/":return l(a.operator,this.evaluateNode(a.left,b,e),this.evaluateNode(a.right,b,e))}case "null":case "bool":case "string":case "number":return a.value;case "date":return x(a.value);case "timestamp":return u(a.value);case "current_time":return b=new Date,
"date"===a.mode&&b.setHours(0,0,0,0),b;case "column_ref":return H(b,a.column,this.datefields,e);case "function":return b=this.evaluateNode(a.args,b,e),this.isAggregate?k.aggregateFunction(a.name,b):c.evaluateFunction(a.name,b)}throw Error("Unsupported sql syntax "+a.type);};return b}();a.WhereClause=z;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(z,
a){function r(a){for(var c=0,b=0;b<a.length;b++)c+=a[b];return c/a.length}function q(a){for(var c=r(a),b=a.length,k=0,u=0;u<a.length;u++)k+=Math.pow(a[u]-c,2);return 1<b?k/(b-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.isAggregate=a.aggregateFunction=void 0;a.aggregateFunction=function(a,e){var b=k[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(e.length<b.minParams||e.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(e)};
a.isAggregate=function(a,e){a=k[a.toLowerCase()];return null!=a&&e>=a.minParams&&e<=a.maxParams};var k={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:r(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var c=0,b=0;b<a.length;b++)c+=
a[b];a=c}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(q(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:q(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(z,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.isStandardized=a.evaluateFunction=a.SqlInterval=void 0;
z=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(c){var e=new a;e.second=c/1E3;return e};a.createFromValueAndQualifer=function(c,e,b){var k=null,u=new a;u.op="-"===b?"-":"+";if("interval-period"===e.type){a.fixDefaults(e);if("year"===e.period||"month"===e.period)throw Error("Year-Month Intervals not supported");
if(/^[0-9]{1,}$/.test(c))u[e.period]=parseFloat(c);else throw Error("Illegal Interval");}else{a.fixDefaults(e.start);a.fixDefaults(e.end);if("year"===e.start.period||"month"===e.start.period)throw Error("Year-Month Intervals not supported");if("year"===e.end.period||"month"===e.end.period)throw Error("Year-Month Intervals not supported");switch(e.start.period){case "day":switch(e.end.period){case "hour":k=/^[0-9]{1,} [0-9]{1,}$/;if(k.test(c))u[e.start.period]=parseFloat(c.split(" ")[0]),u[e.end.period]=
parseFloat(c.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":k=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(k.test(c))u[e.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),u.hour=parseFloat(c[0]),u.minute=parseFloat(c[1]);else throw Error("Illegal Interval");break;case "second":k=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(k.test(c))u[e.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),u.hour=parseFloat(c[0]),u.minute=
parseFloat(c[1]),u.second=parseFloat(c[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(e.end.period){case "minute":k=/^[0-9]{1,}:[0-9]{1,}$/;if(k.test(c))u.hour=parseFloat(c.split(":")[0]),u.minute=parseFloat(c.split(":")[1]);else throw Error("Illegal Interval");break;case "second":k=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(k.test(c))c=c.split(":"),u.hour=parseFloat(c[0]),u.minute=parseFloat(c[1]),u.second=parseFloat(c[2]);
else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(e.end.period){case "second":k=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(k.test(c))c=c.split(":"),u.minute=parseFloat(c[0]),u.second=parseFloat(c[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return u};a.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+
864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=z;a.evaluateFunction=function(a,c){var e=q[a.toLowerCase()];if(null==e)throw Error("Function Not Recognised");if(c.length<e.minParams||c.length>e.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return e.evaluate(c)};a.isStandardized=function(a,c){a=q[a.toLowerCase()];return null!=a&&c>=a.minParams&&c<=a.maxParams};var q={extract:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];
a=a[1];if(null==a)return null;if(a instanceof Date)switch(c.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var c=a[0],e=a[1];return null==c||null==e?null:c.toString().substring(e-1)}if(3===a.length)return c=
a[0],e=a[1],a=a[2],null==c||null==e||null==a?null:0>=a?"":c.toString().substring(e-1,e+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];return null==c||null==a?null:a.indexOf(c)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var c=3===a.length,e=c?a[1]:" ",c=c?a[2]:a[1];if(null==e||null==c)return null;e="("+r.escapeRegExpString(e)+")";switch(a[0]){case "BOTH":return c.replace(new RegExp("^"+e+"*|"+e+"*$","g"),"");case "LEADING":return c.replace(new RegExp("^"+
e+"*","g"),"");case "TRAILING":return c.replace(new RegExp(e+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var c=a[0];a=2===a.length?
Math.pow(10,a[1]):1;return null==c?null:Math.round(c*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var c="",e=0;e<a.length;e++){if(null==a[e])return null;c+=a[e].toString()}return c}},lower:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(z,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.WhereGrammar=void 0;z=function(){function a(){}a.parse=function(a){return r.parse(a)};return a}();a.WhereGrammar=z})},"esri/core/sql/sql92grammar":function(){(function(z,
a){"function"===typeof define&&define.amd?define([],a):"object"===typeof module&&module.exports&&(module.exports=a())})(this,function(){function z(a,r,q,k){this.message=a;this.expected=r;this.found=q;this.location=k;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,z)}(function(a,r){function q(){this.constructor=a}q.prototype=r.prototype;a.prototype=new q})(z,Error);z.buildMessage=function(a,r){function q(a){return a.charCodeAt(0).toString(16).toUpperCase()}
function k(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+q(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+q(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+
q(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+q(a)})}var e={literal:function(a){return'"'+k(a.text)+'"'},"class":function(a){var b="",e;for(e=0;e<a.parts.length;e++)b+=a.parts[e]instanceof Array?c(a.parts[e][0])+"-"+c(a.parts[e][1]):c(a.parts[e]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var k=
c,d;d=a[c];d=e[d.type](d);b[k]=d}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(r?'"'+k(r)+'"':"end of input")+" found."};return{SyntaxError:z,parse:function(a,r){function q(a,b){return{type:"literal",text:a,ignoreCase:b}}function k(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function c(b){var c=Oa[b],
f;if(!c){for(f=b-1;!Oa[f];)f--;c=Oa[f];for(c={line:c.line,column:c.column};f<b;)10===a.charCodeAt(f)?(c.line++,c.column=1):c.column++,f++;Oa[b]=c}return c}function e(a,b){var f=c(a),d=c(b);return{start:{offset:a,line:f.line,column:f.column},end:{offset:b,line:d.line,column:d.column}}}function b(a){h<ta||(h>ta&&(ta=h,Pa=[]),Pa.push(a))}function p(){var a,b,c;a=h;b=B();b!==f?(b=x(),b!==f?(c=B(),c!==f?a=b:(h=a,a=f)):(h=a,a=f)):(h=a,a=f);return a}function u(){var a,b,c,d,e,g,l,m;a=h;b=x();if(b!==f){c=
[];d=h;e=B();e!==f?(g=ma(),g!==f?(l=B(),l!==f?(m=x(),m!==f?d=e=[e,g,l,m]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);for(;d!==f;)c.push(d),d=h,e=B(),e!==f?(g=ma(),g!==f?(l=B(),l!==f?(m=x(),m!==f?d=e=[e,g,l,m]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);if(c!==f){a={type:"expr_list"};b=[b];for(d=0;d<c.length;d++)b.push(c[d][3]);a.value=b}else h=a,a=f}else h=a,a=f;return a}function x(){var a,b,c,e,g,l,m,k;a=h;b=d();if(b!==f){c=[];e=h;g=B();g!==f?(l=ea(),l!==f?(m=B(),m!==f?(k=d(),k!==f?e=g=[g,l,m,k]:(h=
e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f);for(;e!==f;)c.push(e),e=h,g=B(),g!==f?(l=ea(),l!==f?(m=B(),m!==f?(k=d(),k!==f?e=g=[g,l,m,k]:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function d(){var a,b,c,d,e,g,l,m;a=h;b=y();if(b!==f){c=[];d=h;e=B();e!==f?(g=T(),g!==f?(l=B(),l!==f?(m=y(),m!==f?d=e=[e,g,l,m]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);for(;d!==f;)c.push(d),d=h,e=B(),e!==f?(g=T(),g!==f?(l=B(),l!==f?(m=y(),m!==f?d=e=[e,g,l,m]:(h=d,d=f)):(h=d,
d=f)):(h=d,d=f)):(h=d,d=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function y(){var c,d,e,g,l;c=h;d=Z();d===f&&(d=h,33===a.charCodeAt(h)?(e=ad,h++):(e=f,0===A&&b(bd)),e!==f?(g=h,A++,61===a.charCodeAt(h)?(l=lb,h++):(l=f,0===A&&b(mb)),A--,l===f?g=void 0:(h=g,g=f),g!==f?d=e=[e,g]:(h=d,d=f)):(h=d,d=f));d!==f?(e=B(),e!==f?(g=y(),g!==f?c=d={type:"unary_expr",operator:"NOT",expr:g}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f);if(c===f)if(c=h,d=F(),d!==f)if(e=B(),e!==f){var m,k,t;e=[];g=h;l=B();l!==f?(m=v(),
m!==f?(k=B(),k!==f?(t=F(),t!==f?g=l=[l,m,k,t]:(h=g,g=f)):(h=g,g=f)):(h=g,g=f)):(h=g,g=f);if(g!==f)for(;g!==f;)e.push(g),g=h,l=B(),l!==f?(m=v(),m!==f?(k=B(),k!==f?(t=F(),t!==f?g=l=[l,m,k,t]:(h=g,g=f)):(h=g,g=f)):(h=g,g=f)):(h=g,g=f);else e=f;e!==f&&(e={type:"arithmetic",tail:e});e===f&&(e=h,g=G(),g!==f?(l=B(),l!==f?(l=ga(),l!==f?(l=B(),l!==f?(l=u(),l!==f?(m=B(),m!==f?(m=ia(),m!==f?e=g={op:g,right:l}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=G(),g!==f?
(l=B(),l!==f?(l=ga(),l!==f?(l=B(),l!==f?(l=ia(),l!==f?e=g={op:g,right:{type:"expr_list",value:[]}}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=G(),g!==f?(l=B(),l!==f?(l=N(),l!==f?e=g={op:g,right:l}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f))),e===f&&(e=h,l=Z(),l!==f?(g=B(),g!==f?(g=ha(),g!==f?(m=B(),m!==f?(m=F(),m!==f?(k=B(),k!==f?(k=T(),k!==f?(l=B(),l!==f?(l=F(),l!==f?e=l={op:"NOT"+g,right:{type:"expr_list",value:[m,l]}}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=
f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,l=ha(),l!==f?(g=B(),g!==f?(g=F(),g!==f?(m=B(),m!==f?(m=T(),m!==f?(k=B(),k!==f?(k=F(),k!==f?e=l={op:l,right:{type:"expr_list",value:[g,k]}}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)),e===f&&(e=h,g=X(),g!==f?(l=B(),l!==f?(l=Z(),l!==f?(l=B(),l!==f?(l=F(),l!==f?e=g={op:g+"NOT",right:l}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=X(),g!==f?(l=B(),l!==f?(l=F(),l!==f?e=g={op:g,right:l}:(h=e,e=f)):(h=
e,e=f)):(h=e,e=f)),e===f&&(e=h,g=n(),g!==f?(l=B(),l!==f?(l=ca(),l!==f?(m=B(),m!==f?(m=h,a.substr(h,6).toLowerCase()===cd?(k=a.substr(h,6),h+=6):(k=f,0===A&&b(dd)),k!==f?(k=h,A++,t=D(),A--,t===f?k=void 0:(h=k,k=f),k!==f?m="ESCAPE":(h=m,m=f)):(h=m,m=f),m!==f?(m=B(),m!==f?(m=va(),m!==f?e=g={op:g,right:l,escape:m.value}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=n(),g!==f?(l=B(),l!==f?(l=ca(),l!==f?e=g={op:g,right:l,escape:""}:(h=e,e=f)):(h=e,e=f)):(h=e,
e=f))))));e===f&&(e=null);e!==f?(c=d,d=e,""==d||void 0==d||null==d?d=c:(e=null,d=e="arithmetic"==d.type?Ga(c,d.tail):Na(d.op,c,d.right,d.escape)),c=d):(h=c,c=f)}else h=c,c=f;else h=c,c=f;return c}function v(){var c;a.substr(h,2)===nb?(c=nb,h+=2):(c=f,0===A&&b(ed));c===f&&(62===a.charCodeAt(h)?(c=fd,h++):(c=f,0===A&&b(gd)),c===f&&(a.substr(h,2)===ob?(c=ob,h+=2):(c=f,0===A&&b(hd)),c===f&&(a.substr(h,2)===pb?(c=pb,h+=2):(c=f,0===A&&b(id)),c===f&&(60===a.charCodeAt(h)?(c=jd,h++):(c=f,0===A&&b(kd)),c===
f&&(61===a.charCodeAt(h)?(c=lb,h++):(c=f,0===A&&b(mb)),c===f&&(a.substr(h,2)===qb?(c=qb,h+=2):(c=f,0===A&&b(ld))))))));return c}function n(){var a,b,c,d;a=a=h;b=Z();b!==f?(c=B(),c!==f?(d=Q(),d!==f?a=b=[b,c,d]:(h=a,a=f)):(h=a,a=f)):(h=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=Q());return a}function G(){var a,b,c,d;a=a=h;b=Z();b!==f?(c=B(),c!==f?(d=ja(),d!==f?a=b=[b,c,d]:(h=a,a=f)):(h=a,a=f)):(h=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=ja());return a}function F(){var a,b,c,d,e,l,m,k;a=h;b=g();if(b!==
f){c=[];d=h;e=B();e!==f?(l=C(),l!==f?(m=B(),m!==f?(k=g(),k!==f?d=e=[e,l,m,k]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);for(;d!==f;)c.push(d),d=h,e=B(),e!==f?(l=C(),l!==f?(m=B(),m!==f?(k=g(),k!==f?d=e=[e,l,m,k]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function C(){var c;43===a.charCodeAt(h)?(c=gc,h++):(c=f,0===A&&b(hc));c===f&&(45===a.charCodeAt(h)?(c=ic,h++):(c=f,0===A&&b(jc)));return c}function g(){var a,b,c,d,e,g,m,k;a=h;b=l();if(b!==f){c=[];
d=h;e=B();e!==f?(g=t(),g!==f?(m=B(),m!==f?(k=l(),k!==f?d=e=[e,g,m,k]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);for(;d!==f;)c.push(d),d=h,e=B(),e!==f?(g=t(),g!==f?(m=B(),m!==f?(k=l(),k!==f?d=e=[e,g,m,k]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function t(){var c;42===a.charCodeAt(h)?(c=md,h++):(c=f,0===A&&b(nd));c===f&&(47===a.charCodeAt(h)?(c=od,h++):(c=f,0===A&&b(pd)));return c}function l(){var c,d,e,g,l,m,k;k=va();if(k===f){var t,w,p,n;t=h;var q,
r,v,P;q=h;r=sa();r!==f?(v=pa(),v!==f?(P=U(),P!==f?q=r=parseFloat(r+v+P):(h=q,q=f)):(h=q,q=f)):(h=q,q=f);q===f&&(q=h,r=sa(),r!==f?(v=pa(),v!==f?q=r=parseFloat(r+v):(h=q,q=f)):(h=q,q=f),q===f&&(q=h,r=sa(),r!==f?(v=U(),v!==f?q=r=parseFloat(r+v):(h=q,q=f)):(h=q,q=f),q===f&&(q=h,r=sa(),r!==f&&(r=parseFloat(r)),q=r)));w=q;w!==f?(p=h,A++,n=O(),A--,n===f?p=void 0:(h=p,p=f),p!==f?t=w={type:"number",value:w}:(h=t,t=f)):(h=t,t=f);k=t;if(k===f){var E,R;E=h;var y,C,z,F;y=h;a.substr(h,4).toLowerCase()===qd?(C=
a.substr(h,4),h+=4):(C=f,0===A&&b(rd));C!==f?(z=h,A++,F=D(),A--,F===f?z=void 0:(h=z,z=f),z!==f?y=C=[C,z]:(h=y,y=f)):(h=y,y=f);R=y;R!==f&&(R={type:"bool",value:!0});E=R;if(E===f){E=h;var X,G,Q,T;X=h;a.substr(h,5).toLowerCase()===sd?(G=a.substr(h,5),h+=5):(G=f,0===A&&b(td));G!==f?(Q=h,A++,T=D(),A--,T===f?Q=void 0:(h=Q,Q=f),Q!==f?X=G=[G,Q]:(h=X,X=f)):(h=X,X=f);R=X;R!==f&&(R={type:"bool",value:!1});E=R}k=E;if(k===f){var Z,ha,ea,da,ma;ha=h;a.substr(h,4).toLowerCase()===ud?(ea=a.substr(h,4),h+=4):(ea=f,
0===A&&b(vd));ea!==f?(da=h,A++,ma=D(),A--,ma===f?da=void 0:(h=da,da=f),da!==f?ha=ea=[ea,da]:(h=ha,ha=f)):(h=ha,ha=f);Z=ha;Z!==f&&(Z={type:"null",value:null});k=Z;if(k===f){var fa,ta,Ca,Ga;fa=h;var Qa,Na,rb,Oa;Qa=h;a.substr(h,4).toLowerCase()===wd?(Na=a.substr(h,4),h+=4):(Na=f,0===A&&b(xd));Na!==f?(rb=h,A++,Oa=D(),A--,Oa===f?rb=void 0:(h=rb,rb=f),rb!==f?Qa=Na="DATE":(h=Qa,Qa=f)):(h=Qa,Qa=f);ta=Qa;ta!==f?(Ca=B(),Ca!==f?(Ga=ca(),Ga!==f?fa=ta={type:"date",value:Ga.value}:(h=fa,fa=f)):(h=fa,fa=f)):(h=
fa,fa=f);k=fa;if(k===f){var Ha,La,Xa,Pa;Ha=h;var Ra,Lb,sb,kb;Ra=h;a.substr(h,9).toLowerCase()===yd?(Lb=a.substr(h,9),h+=9):(Lb=f,0===A&&b(zd));Lb!==f?(sb=h,A++,kb=D(),A--,kb===f?sb=void 0:(h=sb,sb=f),sb!==f?Ra=Lb="TIMESTAMP":(h=Ra,Ra=f)):(h=Ra,Ra=f);La=Ra;La!==f?(Xa=B(),Xa!==f?(Pa=ca(),Pa!==f?Ha=La={type:"timestamp",value:Pa.value}:(h=Ha,Ha=f)):(h=Ha,Ha=f)):(h=Ha,Ha=f);k=Ha;if(k===f){var V,$a,Mb,Da,Nb,ab,lb,kc;V=h;$a=Ia();$a!==f?(Mb=B(),Mb!==f?(45===a.charCodeAt(h)?(Da=ic,h++):(Da=f,0===A&&b(jc)),
Da===f&&(43===a.charCodeAt(h)?(Da=gc,h++):(Da=f,0===A&&b(hc))),Da!==f?(Nb=B(),Nb!==f?(ab=ca(),ab!==f?(lb=B(),lb!==f?(kc=I(),kc!==f?V=$a={type:"interval",value:ab,qualifier:kc,op:Da}:(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f);V===f&&(V=h,$a=Ia(),$a!==f?(Mb=B(),Mb!==f?(Da=ca(),Da!==f?(Nb=B(),Nb!==f?(ab=I(),ab!==f?V=$a={type:"interval",value:Da,qualifier:ab,op:""}:(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f));k=V}}}}}}c=k;if(c===f){var aa,lc,mb,nb,ob,mc,pb,qb,
Cb,nc,Db,Eb;aa=h;var Sa,Ob,tb,Fb;Sa=h;a.substr(h,7).toLowerCase()===Ad?(Ob=a.substr(h,7),h+=7):(Ob=f,0===A&&b(Bd));Ob!==f?(tb=h,A++,Fb=D(),A--,Fb===f?tb=void 0:(h=tb,tb=f),tb!==f?Sa=Ob="EXTRACT":(h=Sa,Sa=f)):(h=Sa,Sa=f);lc=Sa;if(lc!==f)if(mb=B(),mb!==f)if(nb=ga(),nb!==f)if(ob=B(),ob!==f){var wa;wa=Ma();wa===f&&(wa=ib(),wa===f&&(wa=Ya(),wa===f&&(wa=Za(),wa===f&&(wa=jb(),wa===f&&(wa=Ba())))));mc=wa;mc!==f?(pb=B(),pb!==f?(qb=qa(),qb!==f?(Cb=B(),Cb!==f?(nc=x(),nc!==f?(Db=B(),Db!==f?(Eb=ia(),Eb!==f?aa=
lc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:mc},nc]}}:(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)}else h=aa,aa=f;else h=aa,aa=f;else h=aa,aa=f;else h=aa,aa=f;c=aa;if(c===f){var Y,oc,Gb,Hb,Ib,Pb,Jb,Kb,yc,Qb,zc,ra,bb,pc,qc,rc;Y=h;var Ta,Rb,ub,Ac;Ta=h;a.substr(h,9).toLowerCase()===Cd?(Rb=a.substr(h,9),h+=9):(Rb=f,0===A&&b(Dd));Rb!==f?(ub=h,A++,Ac=D(),A--,Ac===f?ub=void 0:(h=ub,ub=f),ub!==f?Ta=Rb="SUBSTRING":(h=Ta,
Ta=f)):(h=Ta,Ta=f);oc=Ta;if(oc!==f)if(Gb=B(),Gb!==f)if(Hb=ga(),Hb!==f)if(Ib=B(),Ib!==f)if(Pb=x(),Pb!==f)if(Jb=B(),Jb!==f)if(Kb=qa(),Kb!==f)if(yc=B(),yc!==f)if(Qb=x(),Qb!==f)if(zc=B(),zc!==f){ra=h;var Ua,Sb,vb,Bc;Ua=h;a.substr(h,3).toLowerCase()===Ed?(Sb=a.substr(h,3),h+=3):(Sb=f,0===A&&b(Fd));Sb!==f?(vb=h,A++,Bc=D(),A--,Bc===f?vb=void 0:(h=vb,vb=f),vb!==f?Ua=Sb="FOR":(h=Ua,Ua=f)):(h=Ua,Ua=f);bb=Ua;bb!==f?(pc=B(),pc!==f?(qc=x(),qc!==f?(rc=B(),rc!==f?ra=bb=[bb,pc,qc,rc]:(h=ra,ra=f)):(h=ra,ra=f)):(h=
ra,ra=f)):(h=ra,ra=f);ra===f&&(ra=null);ra!==f?(bb=ia(),bb!==f?Y=oc={type:"function",name:"substring",args:{type:"expr_list",value:ra?[Pb,Qb,ra[2]]:[Pb,Qb]}}:(h=Y,Y=f)):(h=Y,Y=f)}else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;else h=Y,Y=f;c=Y;if(c===f){var K,cb,Tb,Ub,Vb,xa,Wb,db,Xb,Yb,Cc,sc,Dc,Ec;K=h;cb=ka();cb!==f?(Tb=B(),Tb!==f?(Ub=ga(),Ub!==f?(Vb=B(),Vb!==f?(xa=J(),xa===f&&(xa=null),xa!==f?(Wb=B(),Wb!==f?(db=x(),db!==f?(Xb=B(),
Xb!==f?(Yb=qa(),Yb!==f?(Cc=B(),Cc!==f?(sc=x(),sc!==f?(Dc=B(),Dc!==f?(Ec=ia(),Ec!==f?K=cb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==xa?"BOTH":xa},db,sc]}}:(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f);K===f&&(K=h,cb=ka(),cb!==f?(Tb=B(),Tb!==f?(Ub=ga(),Ub!==f?(Vb=B(),Vb!==f?(xa=J(),xa===f&&(xa=null),xa!==f?(Wb=B(),Wb!==f?(db=x(),db!==f?(Xb=B(),Xb!==f?(Yb=ia(),Yb!==
f?K=cb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==xa?"BOTH":xa},db]}}:(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f)):(h=K,K=f));c=K;if(c===f){var ba,tc,Fc,Gc,Hc,uc,Ic,Jc,Kc,vc,Lc,Mc;ba=h;var Va,Zb,wb,Nc;Va=h;a.substr(h,8).toLowerCase()===Gd?(Zb=a.substr(h,8),h+=8):(Zb=f,0===A&&b(Hd));Zb!==f?(wb=h,A++,Nc=D(),A--,Nc===f?wb=void 0:(h=wb,wb=f),wb!==f?Va=Zb="POSITION":(h=Va,Va=f)):(h=Va,Va=f);tc=Va;tc!==f?(Fc=B(),Fc!==
f?(Gc=ga(),Gc!==f?(Hc=B(),Hc!==f?(uc=x(),uc!==f?(Ic=B(),Ic!==f?(Jc=ja(),Jc!==f?(Kc=B(),Kc!==f?(vc=x(),vc!==f?(Lc=B(),Lc!==f?(Mc=ia(),Mc!==f?ba=tc={type:"function",name:"position",args:{type:"expr_list",value:[uc,vc]}}:(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f)):(h=ba,ba=f);c=ba;if(c===f){var la,$b,Oc,Pc,Qc,eb,Rc,Sc;la=h;var ya,xb,yb,Ea;ya=h;ya=xb=H();if(ya===f)if(ya=h,96===a.charCodeAt(h)?(xb=Tc,h++):(xb=f,0===A&&
b(Uc)),xb!==f){yb=[];Vc.test(a.charAt(h))?(Ea=a.charAt(h),h++):(Ea=f,0===A&&b(Wc));if(Ea!==f)for(;Ea!==f;)yb.push(Ea),Vc.test(a.charAt(h))?(Ea=a.charAt(h),h++):(Ea=f,0===A&&b(Wc));else yb=f;yb!==f?(96===a.charCodeAt(h)?(Ea=Tc,h++):(Ea=f,0===A&&b(Uc)),Ea!==f?ya=xb=yb.join(""):(h=ya,ya=f)):(h=ya,ya=f)}else h=ya,ya=f;$b=ya;$b!==f?(Oc=B(),Oc!==f?(Pc=ga(),Pc!==f?(Qc=B(),Qc!==f?(eb=u(),eb===f&&(eb=null),eb!==f?(Rc=B(),Rc!==f?(Sc=ia(),Sc!==f?la=$b={type:"function",name:$b,args:eb?eb:{type:"expr_list",value:[]}}:
(h=la,la=f)):(h=la,la=f)):(h=la,la=f)):(h=la,la=f)):(h=la,la=f)):(h=la,la=f)):(h=la,la=f);c=la;if(c===f){var ac,S,fb,bc,gb,cc,Ja,za,zb,Xc,Yc;S=h;fb=Fa();if(fb!==f)if(bc=B(),bc!==f)if(gb=x(),gb!==f)if(cc=B(),cc!==f){Ja=[];for(za=oa();za!==f;)Ja.push(za),za=oa();Ja!==f?(za=B(),za!==f?(zb=ua(),zb!==f?S=fb={type:"case_expression",format:"simple",operand:gb,clauses:Ja,else:null}:(h=S,S=f)):(h=S,S=f)):(h=S,S=f)}else h=S,S=f;else h=S,S=f;else h=S,S=f;else h=S,S=f;if(S===f)if(S=h,fb=Fa(),fb!==f)if(bc=B(),
bc!==f)if(gb=x(),gb!==f)if(cc=B(),cc!==f){Ja=[];for(za=oa();za!==f;)Ja.push(za),za=oa();Ja!==f?(za=B(),za!==f?(zb=L(),zb!==f?(Xc=B(),Xc!==f?(Yc=ua(),Yc!==f?S=fb={type:"case_expression",format:"simple",operand:gb,clauses:Ja,else:zb.value}:(h=S,S=f)):(h=S,S=f)):(h=S,S=f)):(h=S,S=f)):(h=S,S=f)}else h=S,S=f;else h=S,S=f;else h=S,S=f;else h=S,S=f;ac=S;if(ac===f){var W,hb,dc,Ka,Aa,Ab,Zc,$c;W=h;hb=Fa();if(hb!==f)if(dc=B(),dc!==f){Ka=[];for(Aa=na();Aa!==f;)Ka.push(Aa),Aa=na();Ka!==f?(Aa=B(),Aa!==f?(Ab=ua(),
Ab!==f?W=hb={type:"case_expression",format:"searched",clauses:Ka,else:null}:(h=W,W=f)):(h=W,W=f)):(h=W,W=f)}else h=W,W=f;else h=W,W=f;if(W===f)if(W=h,hb=Fa(),hb!==f)if(dc=B(),dc!==f){Ka=[];for(Aa=na();Aa!==f;)Ka.push(Aa),Aa=na();Ka!==f?(Aa=B(),Aa!==f?(Ab=L(),Ab!==f?(Zc=B(),Zc!==f?($c=ua(),$c!==f?W=hb={type:"case_expression",format:"searched",clauses:Ka,else:Ab.value}:(h=W,W=f)):(h=W,W=f)):(h=W,W=f)):(h=W,W=f)):(h=W,W=f)}else h=W,W=f;else h=W,W=f;ac=W}c=ac;if(c===f){var Bb,Wa,wc,ec,fc;Wa=h;wc=O();
if(wc!==f){ec=[];for(fc=M();fc!==f;)ec.push(fc),fc=M();ec!==f?Wa=wc+=ec.join(""):(h=Wa,Wa=f)}else h=Wa,Wa=f;Bb=Wa;if(Bb!==f){var xc=Bb;Bb=/^CURRENT_DATE$/i.test(xc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(xc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:xc}}c=Bb;c===f&&(c=N(),c===f&&(c=h,d=ga(),d!==f?(e=B(),e!==f?(g=x(),g!==f?(l=B(),l!==f?(m=ia(),m!==f?(g.paren=!0,c=d=g):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)))}}}}}}}return c}function H(){var a,
b,c,d;a=h;b=O();if(b!==f){c=[];for(d=D();d!==f;)c.push(d),d=D();c!==f?a=b+=c.join(""):(h=a,a=f)}else h=a,a=f;return a}function O(){var c;Id.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===A&&b(Jd));return c}function D(){var c;Kd.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===A&&b(Ld));return c}function M(){var c;Md.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===A&&b(Nd));return c}function N(){var c,d,e;c=h;64===a.charCodeAt(h)?(d=Od,h++):(d=f,0===A&&b(Pd));d!==f?(e=H(),e!==f?c=d=[d,e]:(h=c,c=f)):(h=
c,c=f);c!==f&&(c={type:"param",value:c[1]});return c}function J(){var c,d,e;c=h;a.substr(h,7).toLowerCase()===Qd?(d=a.substr(h,7),h+=7):(d=f,0===A&&b(Rd));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="LEADING":(h=c,c=f)):(h=c,c=f);c===f&&(c=h,a.substr(h,8).toLowerCase()===Sd?(d=a.substr(h,8),h+=8):(d=f,0===A&&b(Td)),d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="TRAILING":(h=c,c=f)):(h=c,c=f),c===f&&(c=h,a.substr(h,4).toLowerCase()===Ud?(d=a.substr(h,4),h+=4):(d=f,0===A&&
b(Vd)),d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="BOTH":(h=c,c=f)):(h=c,c=f)));return c}function I(){var c,d,e;c=h;var g,l;d=h;e=w();e!==f?(g=B(),g!==f?(g=ga(),g!==f?(g=B(),g!==f?(g=E(),g!==f?(l=B(),l!==f?(l=ia(),l!==f?d=e={type:"interval-period",period:e.value,precision:g,secondary:null}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);d===f&&(d=h,e=w(),e!==f&&(e=Cb(e)),d=e);if(d!==f)if(e=B(),e!==f)if(e=h,a.substr(h,2).toLowerCase()===Wd?(g=a.substr(h,2),
h+=2):(g=f,0===A&&b(Xd)),g!==f?(g=h,A++,l=D(),A--,l===f?g=void 0:(h=g,g=f),g!==f?e="TO":(h=e,e=f)):(h=e,e=f),e!==f)if(e=B(),e!==f){var k;e=h;g=w();g!==f&&(g={type:"interval-period",period:g.value,precision:null,secondary:null});e=g;e===f&&(e=h,g=Ba(),g!==f?(g=B(),g!==f?(g=ga(),g!==f?(g=B(),g!==f?(g=E(),g!==f?(l=B(),l!==f?(l=ma(),l!==f?(l=B(),l!==f?(l=m(),l!==f?(k=B(),k!==f?(k=ia(),k!==f?e=g=Db(g,l):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):
(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=Ba(),g!==f?(g=B(),g!==f?(g=ga(),g!==f?(g=B(),g!==f?(g=E(),g!==f?(l=B(),l!==f?(l=ia(),l!==f?e=g={type:"interval-period",period:"second",precision:g,secondary:null}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=Ba(),g!==f&&(g={type:"interval-period",period:"second",precision:null,secondary:null}),e=g)));e!==f?c=d={type:"interval-qualifier",start:d,end:e}:(h=c,c=f)}else h=c,c=f;else h=c,c=f;else h=c,c=f;else h=c,c=f;c===f&&
(c=h,e=w(),e!==f?(d=B(),d!==f?(d=ga(),d!==f?(d=B(),d!==f?(d=m(),d!==f?(g=B(),g!==f?(g=ia(),g!==f?c=e={type:"interval-period",period:e.value,precision:d,secondary:null}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f),c===f&&(c=h,e=w(),e!==f&&(e=Cb(e)),c=e,c===f&&(c=h,e=Ba(),e!==f?(d=B(),d!==f?(d=ga(),d!==f?(d=B(),d!==f?(d=E(),d!==f?(g=B(),g!==f?(g=ma(),g!==f?(e=B(),e!==f?(e=m(),e!==f?(g=B(),g!==f?(g=ia(),g!==f?c=e=Db(d,e):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,
c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f),c===f&&(c=h,e=Ba(),e!==f?(d=B(),d!==f?(d=ga(),d!==f?(d=B(),d!==f?(d=m(),d!==f?(g=B(),g!==f?(g=ia(),g!==f?c=e={type:"interval-period",period:"second",precision:d,secondary:null}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f),c===f&&(c=h,e=Ba(),e!==f&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),c=e)))));return c}function w(){var a;a=h;a=Ya();a!==f&&(a={type:"string",value:"day"});
a===f&&(a=h,a=Za(),a!==f&&(a={type:"string",value:"hour"}),a===f&&(a=h,a=jb(),a!==f&&(a={type:"string",value:"minute"}),a===f&&(a=h,a=ib(),a!==f&&(a={type:"string",value:"month"}),a===f&&(a=h,a=Ma(),a!==f&&(a={type:"string",value:"year"})))));return a}function m(){var a;a=P();a!==f&&(a=parseFloat(a));return a}function E(){var a;a=P();a!==f&&(a=parseFloat(a));return a}function ca(){var a;a=va();a===f&&(a=N());return a}function va(){var c,d,e;c=h;39===a.charCodeAt(h)?(d=Eb,h++):(d=f,0===A&&b(Fb));d===
f&&(a.substr(h,2)===Gb?(d=Gb,h+=2):(d=f,0===A&&b(Yd)));if(d!==f){d=[];e=h;a.substr(h,2)===La?(e=La,h+=2):(e=f,0===A&&b(Hb));e!==f&&(e="'");e===f&&(Ib.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===A&&b(Jb)));for(;e!==f;)d.push(e),e=h,a.substr(h,2)===La?(e=La,h+=2):(e=f,0===A&&b(Hb)),e!==f&&(e="'"),e===f&&(Ib.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===A&&b(Jb)));d!==f?(39===a.charCodeAt(h)?(e=Eb,h++):(e=f,0===A&&b(Fb)),e!==f?c=d={type:"string",value:d.join("")}:(h=c,c=f)):(h=c,c=f)}else h=c,c=
f;return c}function na(){var a,b,c;a=h;b=da();b!==f?(b=B(),b!==f?(b=x(),b!==f?(c=B(),c!==f?(c=fa(),c!==f?(c=B(),c!==f?(c=x(),c!==f?a=b={type:"when_clause",operand:b,value:c}:(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f);return a}function oa(){var a,b,c;a=h;b=da();b!==f?(b=B(),b!==f?(b=x(),b!==f?(c=B(),c!==f?(c=fa(),c!==f?(c=B(),c!==f?(c=x(),c!==f?a=b={type:"when_clause",operand:b,value:c}:(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f);return a}
function L(){var c,d;c=h;var e,g;d=h;a.substr(h,4).toLowerCase()===Zd?(e=a.substr(h,4),h+=4):(e=f,0===A&&b($d));e!==f?(e=h,A++,g=D(),A--,g===f?e=void 0:(h=e,e=f),e!==f?d="ELSE":(h=d,d=f)):(h=d,d=f);d!==f?(d=B(),d!==f?(d=x(),d!==f?c={type:"else_clause",value:d}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f);return c}function sa(){var c,d,e;c=P();c===f&&(c=h,45===a.charCodeAt(h)?(d=ic,h++):(d=f,0===A&&b(jc)),d===f&&(43===a.charCodeAt(h)?(d=gc,h++):(d=f,0===A&&b(hc))),d!==f?(e=P(),e!==f?c=d=d[0]+e:(h=c,c=f)):(h=c,
c=f));return c}function pa(){var c,d;c=h;46===a.charCodeAt(h)?(d=ae,h++):(d=f,0===A&&b(be));d!==f?(d=P(),d===f&&(d=null),d!==f?c="."+(null!=d?d:""):(h=c,c=f)):(h=c,c=f);return c}function U(){var c,d,e;d=c=h;ce.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===A&&b(de));e!==f?(ee.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===A&&b(fe)),e===f&&(e=null),e!==f?d="e"+(null===e?"":e):(h=d,d=f)):(h=d,d=f);d!==f?(e=P(),e!==f?c=d+e:(h=c,c=f)):(h=c,c=f);return c}function P(){var a,b;a=[];b=R();if(b!==f)for(;b!==
f;)a.push(b),b=R();else a=f;a!==f&&(a=a.join(""));return a}function R(){var c;ge.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===A&&b(he));return c}function ja(){var c,d,e;c=h;a.substr(h,2).toLowerCase()===ie?(d=a.substr(h,2),h+=2):(d=f,0===A&&b(je));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="IN":(h=c,c=f)):(h=c,c=f);return c}function X(){var c,d,e;c=h;a.substr(h,2).toLowerCase()===ke?(d=a.substr(h,2),h+=2):(d=f,0===A&&b(le));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?
c="IS":(h=c,c=f)):(h=c,c=f);return c}function Q(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===me?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(ne));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="LIKE":(h=c,c=f)):(h=c,c=f);return c}function Z(){var c,d,e;c=h;a.substr(h,3).toLowerCase()===oe?(d=a.substr(h,3),h+=3):(d=f,0===A&&b(pe));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="NOT":(h=c,c=f)):(h=c,c=f);return c}function T(){var c,d,e;c=h;a.substr(h,3).toLowerCase()===qe?(d=a.substr(h,
3),h+=3):(d=f,0===A&&b(re));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="AND":(h=c,c=f)):(h=c,c=f);return c}function ea(){var c,d,e;c=h;a.substr(h,2).toLowerCase()===se?(d=a.substr(h,2),h+=2):(d=f,0===A&&b(te));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="OR":(h=c,c=f)):(h=c,c=f);return c}function ha(){var c,d,e;c=h;a.substr(h,7).toLowerCase()===ue?(d=a.substr(h,7),h+=7):(d=f,0===A&&b(ve));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="BETWEEN":(h=c,c=f)):(h=
c,c=f);return c}function qa(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===we?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(xe));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="FROM":(h=c,c=f)):(h=c,c=f);return c}function ka(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===ye?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(ze));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="TRIM":(h=c,c=f)):(h=c,c=f);return c}function Ia(){var c,d,e;c=h;a.substr(h,8).toLowerCase()===Ae?(d=a.substr(h,8),h+=8):(d=f,
0===A&&b(Be));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="INTERVAL":(h=c,c=f)):(h=c,c=f);return c}function Ma(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Ce?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(De));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="YEAR":(h=c,c=f)):(h=c,c=f);return c}function ib(){var c,d,e;c=h;a.substr(h,5).toLowerCase()===Ee?(d=a.substr(h,5),h+=5):(d=f,0===A&&b(Fe));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="MONTH":(h=c,c=f)):(h=c,c=f);
return c}function Ya(){var c,d,e;c=h;a.substr(h,3).toLowerCase()===Ge?(d=a.substr(h,3),h+=3):(d=f,0===A&&b(He));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="DAY":(h=c,c=f)):(h=c,c=f);return c}function Za(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Ie?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(Je));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="HOUR":(h=c,c=f)):(h=c,c=f);return c}function jb(){var c,d,e;c=h;a.substr(h,6).toLowerCase()===Ke?(d=a.substr(h,6),h+=6):(d=f,0===A&&b(Le));
d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="MINUTE":(h=c,c=f)):(h=c,c=f);return c}function Ba(){var c,d,e;c=h;a.substr(h,6).toLowerCase()===Me?(d=a.substr(h,6),h+=6):(d=f,0===A&&b(Ne));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="SECOND":(h=c,c=f)):(h=c,c=f);return c}function Fa(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Oe?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(Pe));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="CASE":(h=c,c=f)):(h=c,c=f);return c}function ua(){var c,
d,e;c=h;a.substr(h,3).toLowerCase()===Qe?(d=a.substr(h,3),h+=3):(d=f,0===A&&b(Re));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="END":(h=c,c=f)):(h=c,c=f);return c}function da(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Se?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(Te));d!==f?(d=h,A++,e=D(),A--,e===f?d=void 0:(h=d,d=f),d!==f?c="WHEN":(h=c,c=f)):(h=c,c=f);return c}function fa(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Ue?(d=a.substr(h,4),h+=4):(d=f,0===A&&b(Ve));d!==f?(d=h,A++,e=D(),A--,
e===f?d=void 0:(h=d,d=f),d!==f?c="THEN":(h=c,c=f)):(h=c,c=f);return c}function ma(){var c;44===a.charCodeAt(h)?(c=We,h++):(c=f,0===A&&b(Xe));return c}function ga(){var c;40===a.charCodeAt(h)?(c=Ye,h++):(c=f,0===A&&b(Ze));return c}function ia(){var c;41===a.charCodeAt(h)?(c=$e,h++):(c=f,0===A&&b(af));return c}function B(){var a,b;a=[];for(b=Ca();b!==f;)a.push(b),b=Ca();return a}function Ca(){var c;bf.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===A&&b(cf));return c}function Na(a,b,c,d){a={type:"binary_expr",
operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function Ga(a,b){for(var c=0;c<b.length;c++)a=Na(b[c][1],a,b[c][3]);return a}r=void 0!==r?r:{};var f={},kb={start:p},Kb=p,ad="!",bd=q("!",!1),lb="\x3d",mb=q("\x3d",!1),nb="\x3e\x3d",ed=q("\x3e\x3d",!1),fd="\x3e",gd=q("\x3e",!1),ob="\x3c\x3d",hd=q("\x3c\x3d",!1),pb="\x3c\x3e",id=q("\x3c\x3e",!1),jd="\x3c",kd=q("\x3c",!1),qb="!\x3d",ld=q("!\x3d",!1),gc="+",hc=q("+",!1),ic="-",jc=q("-",!1),md="*",nd=q("*",!1),od="/",pd=q("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,
Jd=k([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=k([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=q("@",!1),Cb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},Db=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},Eb="'",Fb=q("'",!1),Gb="N'",Yd=q("N'",!1),La="''",Hb=q("''",!1),Ib=/^[^']/,
Jb=k(["'"],!0,!1),ae=".",be=q(".",!1),ge=/^[0-9]/,he=k([["0","9"]],!1,!1),ce=/^[eE]/,de=k(["e","E"],!1,!1),ee=/^[+\-]/,fe=k(["+","-"],!1,!1),ud="null",vd=q("NULL",!0),qd="true",rd=q("TRUE",!0),sd="false",td=q("FALSE",!0),ie="in",je=q("IN",!0),ke="is",le=q("IS",!0),me="like",ne=q("LIKE",!0),cd="escape",dd=q("ESCAPE",!0),oe="not",pe=q("NOT",!0),qe="and",re=q("AND",!0),se="or",te=q("OR",!0),ue="between",ve=q("BETWEEN",!0),we="from",xe=q("FROM",!0),Ed="for",Fd=q("FOR",!0),Cd="substring",Dd=q("SUBSTRING",
!0),Ad="extract",Bd=q("EXTRACT",!0),ye="trim",ze=q("TRIM",!0),Gd="position",Hd=q("POSITION",!0),yd="timestamp",zd=q("TIMESTAMP",!0),wd="date",xd=q("DATE",!0),Qd="leading",Rd=q("LEADING",!0),Sd="trailing",Td=q("TRAILING",!0),Ud="both",Vd=q("BOTH",!0),Wd="to",Xd=q("TO",!0),Ae="interval",Be=q("INTERVAL",!0),Ce="year",De=q("YEAR",!0),Ee="month",Fe=q("MONTH",!0),Ge="day",He=q("DAY",!0),Ie="hour",Je=q("HOUR",!0),Ke="minute",Le=q("MINUTE",!0),Me="second",Ne=q("SECOND",!0),Oe="case",Pe=q("CASE",!0),Qe="end",
Re=q("END",!0),Se="when",Te=q("WHEN",!0),Ue="then",Ve=q("THEN",!0),Zd="else",$d=q("ELSE",!0),We=",",Xe=q(",",!1),Ye="(",Ze=q("(",!1),$e=")",af=q(")",!1),bf=/^[ \t\n\r]/,cf=k([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=q("`",!1),Vc=/^[^`]/,Wc=k(["`"],!0,!1),h=0,Oa=[{line:1,column:1}],ta=0,Pa=[],A=0,Xa;if("startRule"in r){if(!(r.startRule in kb))throw Error("Can't start parsing from rule \""+r.startRule+'".');Kb=kb[r.startRule]}Xa=Kb();if(Xa!==f&&h===a.length)return Xa;Xa!==f&&h<a.length&&b({type:"end"});
throw function(a,b,c){return new z(z.buildMessage(a,b),a,b,c)}(Pa,ta<a.length?a.charAt(ta):null,ta<a.length?e(ta,ta+1):e(ta,ta));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities=void 0;a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports tslib ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(z,a,r,q,k,c,e,b,p,u,x,d,y,v,n){function G(a){return a.substr(24,12)+a.substr(19,4)+a.substr(16,2)+a.substr(14,2)+a.substr(11,2)+a.substr(9,2)+a.substr(6,2)+a.substr(4,2)+a.substr(2,2)+a.substr(0,2)}function F(a,b,c,d){if(c&&"esriFieldTypeDate"===c.type){var e=(new Date(a)).getTime(),g=(new Date(b)).getTime();if(!isNaN(e)&&!isNaN(g))return d?g-e:e-g}return"number"===typeof a&&"number"===typeof b?d?b-a:a-b:"string"===typeof a&&"string"===typeof b?(e=a.toUpperCase(),g=b.toUpperCase(),!c||"esriFieldTypeGUID"!==
c.type&&"esriFieldTypeGlobalID"!==c.type?d=(d?e>g:e<g)?-1:(d?e<g:e>g)?1:0:(a=G(e),g=G(g),d=(d?a>g:a<g)?-1:(d?a<g:a>g)?1:0),d):d?1:-1}Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=
c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!1,configurable:!0});a.prototype.createQueryResponseForCount=function(a){var b=new x.default(a,this.featureAdapter,this.fieldsIndex);if(!a.outStatistics)return b.countDistinctValues(this.items);var c=a.groupByFieldsForStatistics,d=a.having;if(null===c||void 0===c||!c.length)return 1;var e=new Map,g=new Map,k=new Set,p=0;for(a=a.outStatistics;p<a.length;p++){var J=a[p],J="exceedslimit"!==
J.statisticType?J.onStatisticField:void 0;if(!g.has(J)){for(var n=[],w=0,m=c;w<m.length;w++){var u=this._getAttributeValues(b,m[w],e);n.push(u)}g.set(J,this._calculateUniqueValues(n))}var J=g.get(J),q;for(q in J)w=J[q],n=w.items,w=w.data.join(","),d&&!b.validateItems(n,d)||k.add(w)}return k.size};a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):
this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(p.isValid(a.outSR)&&!p.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=n.cleanFromGeometryEngine(r.__assign({spatialReference:a.outSR},y.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):b.queryGeometry=n.cleanFromGeometryEngine(r.__assign({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var e=d.getWhereClause(b.where,this.fieldsIndex);if(!e)return c.resolve(this);
if(e.isStandardized){for(var g=0,k=[],p=0,n=this.items;p<n.length;p++){var u=n[p];e.testFeature(u,this.featureAdapter)&&(k[g++]=u)}e=new a(k,this.queryGeometry,this);e.definitionExpression=b.where;return c.resolve(e)}return c.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return c.resolve(this);var d=e.SetFromValues(b.objectIds),g=this.featureAdapter.getObjectId;return c.resolve(new a(this.items.filter(function(a){return d.has(g(a))}),
this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=v.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!k.isSome(b))return c.resolve(this);b=this.items.filter(b);return c.resolve(new a(b,this.queryGeometry,this))};a.prototype.filterLatest=function(){for(var b=this.timeInfo,d=b.trackIdField,e=b.startTimeField,b=b.endTimeField||e,e=new Map,k=this.featureAdapter.getAttribute,p=0,n=this.items;p<n.length;p++){var u=n[p],r=k(u,d),J=k(u,b),I=e.get(r);(!I||J>k(I,b))&&e.set(r,
u)}d=q.valuesOfMap(e);return c.resolve(new a(d,this.queryGeometry,this))};a.prototype.project=function(b){return r.__awaiter(this,void 0,void 0,function(){var c,d,e,g=this;return r.__generator(this,function(l){switch(l.label){case 0:if(!b||p.equals(this.spatialReference,b))return[2,this];c=this.featureAdapter;return[4,y.projectMany(this.items.map(function(a){return n.getGeometry(g.geometryType,g.hasZ,g.hasM,c.getGeometry(a))}),this.spatialReference,b)];case 1:return d=l.sent(),e=d.map(function(a,
b){return c.cloneWithGeometry(g.items[b],u.convertFromGeometry(a,g.hasZ,g.hasM))}),[2,new a(e,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:b,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._sortFeatures=function(a,b,c){if(1<a.length&&b&&b.length){var d=function(b){b=b.split(" ");var d=b[0],g=e.fieldsIndex.get(d),
l=b[1]&&"desc"===b[1].toLowerCase();a.sort(function(a,b){a=c(a,d,g);b=c(b,d,g);return F(a,b,g,l)})},e=this,g=0;for(b=b.reverse();g<b.length;g++)d(b[g])}};a.prototype._createFeatureQueryResponse=function(a){var c=this,d=this.items,e=this.geometryType,g=this.hasM,k=this.hasZ,p=this.objectIdField,u=this.spatialReference,J=a.outFields,q=a.outSR,w=a.quantizationParameters,m=a.resultRecordCount,v=a.resultOffset,x=a.returnZ,y=a.returnM,m=null!=m?d.length>(v||0)+m:!1,J=J&&(-1<J.indexOf("*")?r.__spreadArrays(this.fieldsIndex.fields):
J.map(function(a){return c.fieldsIndex.get(a)}));return{exceededTransferLimit:m,features:this._createFeatures(a,d),fields:J,geometryType:e,hasM:g&&y,hasZ:k&&x,objectIdFieldName:p,spatialReference:n.cleanFromGeometryEngine(q?q:u),transform:w&&b.toQuantizationTransform(w)||null}};a.prototype._createFeatures=function(a,c){var d=new x.default(a,this.featureAdapter,this.fieldsIndex),e=a.orderByFields,g=a.quantizationParameters,k=a.returnGeometry,p=a.returnCentroid,t=a.maxAllowableOffset,J=a.resultOffset,
u=a.resultRecordCount,w=a.returnZ;a=a.returnM;var m=this.hasZ&&(void 0===w?!1:w),q=this.hasM&&(void 0===a?!1:a),w=[];a=0;c=r.__spreadArrays(c);this._sortFeatures(c,e,function(a,b,c){return d.getFieldValue(a,b,c)});if(k||p)if(e=b.toQuantizationTransform(g),k&&!p)for(p=0;p<c.length;p++)k=c[p],w[a++]={attributes:d.getAttributes(k),geometry:n.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(k),t,e,m,q)};else if(!k&&p)for(t=0;t<c.length;t++)k=c[t],w[a++]={attributes:d.getAttributes(k),
centroid:n.transformCentroid(this,this.featureAdapter.getCentroid(k,this),e)};else for(p=0;p<c.length;p++)k=c[p],w[a++]={attributes:d.getAttributes(k),centroid:n.transformCentroid(this,this.featureAdapter.getCentroid(k,this),e),geometry:n.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(k),t,e,m,q)};else for(t=0;t<c.length;t++)k=c[t],(m=d.getAttributes(k))&&(w[a++]={attributes:m});J=J||0;null!=u&&(w=w.slice(J,Math.min(w.length,J+u)));return w};a.prototype._createExceedsLimitQueryResponse=
function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=0;for(a=a.outStatistics;e<a.length;e++){var g=a[e];if("exceedslimit"===g.statisticType){c=null!=g.maxPointCount?g.maxPointCount:Number.POSITIVE_INFINITY;d=null!=g.maxRecordCount?g.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=g.maxVertexCount?g.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=
this.hasZ?this.hasM?4:3:this.hasM?3:2,k=this.featureAdapter,b=this.items.reduce(function(a,b){b=k.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=this,c={attributes:{}},d=[],e=new Map,g=new Map,k=new Map,p=new Map,n=new x.default(a,this.featureAdapter,
this.fieldsIndex),u=a.outStatistics,w=a.groupByFieldsForStatistics,m=a.having;a=a.orderByFields;for(var r=w&&w.length,v=!!r,y=v&&w[0],z=v&&!this.fieldsIndex.get(y),C=0;C<u.length;C++){var L=u[C],F=L.outStatisticFieldName,G=L.statisticType,U=L,P="exceedslimit"!==G?L.onStatisticField:void 0,R="percentile_disc"===G||"percentile_cont"===G,ja=v&&1===r&&(P===y||z)&&"count"===G;if(v){if(!k.has(P)){for(var L=[],G=0,X=w;G<X.length;G++){var Q=this._getAttributeValues(n,X[G],e);L.push(Q)}k.set(P,this._calculateUniqueValues(L))}var Z=
k.get(P),L=function(a){var c=Z[a];a=c.count;var d=c.data,g=c.items,l=c.itemPositions,c=d.join(",");if(!m||n.validateItems(g,m)){var k=p.get(c)||{attributes:{}},g=null;if(ja)g=a;else{var t=T._getAttributeValues(n,P,e);a=l.map(function(a){return t[a]});g=R&&"statisticParameters"in U?T._getPercentileValue(U,a):T._getStatisticValue(U,a)}k.attributes[F]=g;w.forEach(function(a,c){return k.attributes[b.fieldsIndex.get(a)?a:"EXPR_"+(c+1)]=d[c]});p.set(c,k)}},T=this,ea;for(ea in Z)L(ea)}else Q=this._getAttributeValues(n,
P,e),c.attributes[F]=R&&"statisticParameters"in U?this._getPercentileValue(U,Q):this._getStatisticValue(U,Q,g);d.push({name:F,alias:F,type:"esriFieldTypeDouble"})}c=v?q.valuesOfMap(p):[c];this._sortFeatures(c,a,function(a,b){return a.attributes[b]});return{fields:d,features:c}};a.prototype._getStatisticValue=function(a,b,c){var d=a.onStatisticField;a=a.statisticType;b=c&&c.has(d)?c.get(d):this._calculateStatistics(b);c&&c.set(d,b);return b["var"===a?"variance":a]};a.prototype._getPercentileValue=
function(a,b){var c=a.statisticParameters,d=a.statisticType,e=c.value,g="desc"===c.orderBy,k=this.fieldsIndex.get(a.onStatisticField);a=r.__spreadArrays(b).filter(function(a){return null!=a}).sort(function(a,b){return F(a,b,k,g)});return this._calculatePercentile(a,e,"percentile_disc"===d)};a.prototype._getAttributeValues=function(a,b,c){if(c.has(b))return c.get(b);var d=this.fieldsIndex.get(b),e=this.items.map(function(c){return a.getFieldValue(c,b,d)});c.set(b,e);return e};a.prototype._calculateStatistics=
function(a){for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=null,e=null,g=null,k=null,p=[],n=0,u=0;u<a.length;u++){var w=a[u];"string"===typeof w?n++:null==w||isNaN(w)||(d+=w,b=Math.min(b,w),c=Math.max(c,w),p.push(w),n++)}if(n){e=d/n;for(g=a=0;g<p.length;g++)w=p[g],a+=Math.pow(w-e,2);k=1<n?a/(n-1):0;g=Math.sqrt(k)}else c=b=null;return{avg:e,count:n,max:c,min:b,stddev:g,sum:d,variance:k}};a.prototype._calculateUniqueValues=function(a){for(var b={},c=this.items,d=c.length,e=0;e<d;e++){for(var g=
c[e],k=[],p=0,n=a;p<n.length;p++)k.push(n[p][e]);p=k.join(",");null==b[p]?b[p]={count:1,data:k,items:[g],itemPositions:[e]}:(b[p].count++,b[p].items.push(g),b[p].itemPositions.push(e))}return b};a.prototype._calculatePercentile=function(a,b,c){if(0===a.length)return null;if(0>=b)return a[0];if(1<=b)return a[a.length-1];var d=(a.length-1)*b,e=Math.floor(d);b=e+1;var d=d%1,e=a[e],g=a[b];return b>=a.length||c||"string"===typeof e||"string"===typeof g?e:e*(1-d)+g*d};return a}();a.default=z})},"esri/geometry/support/quantizationUtils":function(){define(["require",
"exports","./jsonUtils"],function(z,a,r){function q(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function k(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function c(a,b,c){for(var d=[],e,g,l,p,n=0;n<c.length;n++){var w=c[n];if(0<n){if(l=q(a,w[0]),p=k(a,w[1]),l!==e||p!==g)d.push(b(w,l-e,p-g)),e=l,g=p}else e=q(a,w[0]),g=k(a,w[1]),d.push(b(w,e,g))}return 0<d.length?d:null}function e(a,b,d,e){return c(a,d?e?N:M:e?M:D,b)}function b(a,b,d,e){var g=[];d=d?e?N:M:e?M:D;for(e=0;e<b.length;e++){var m=
c(a,d,b[e]);m&&3<=m.length&&g.push(m)}return g.length?g:null}function p(a,b,d,e){var g=[];d=d?e?N:M:e?M:D;for(e=0;e<b.length;e++){var k=c(a,d,b[e]);k&&2<=k.length&&g.push(k)}return g.length?g:null}function u(a,b){return b*a.scale[0]+a.translate[0]}function x(a,b){return a.translate[1]-b*a.scale[1]}function d(a,b,c){var d=Array(c.length);if(!c.length)return d;var e=a.scale,g=e[0],e=e[1],k=u(a,c[0][0]);a=x(a,c[0][1]);d[0]=b(c[0],k,a);for(var l=1;l<c.length;l++){var p=c[l],k=k+p[0]*g;a-=p[1]*e;d[l]=
b(p,k,a)}return d}function y(a,b,c){for(var e=Array(c.length),g=0;g<c.length;g++)e[g]=d(a,b,c[g]);return e}function v(a,b,c,e){return d(a,c?e?N:M:e?M:D,b)}function n(a,b,c,d){return y(a,c?d?N:M:d?M:D,b)}function G(a,b,c,d){return y(a,c?d?N:M:d?M:D,b)}function F(a,b,c){var d=c[0],e=d[0],d=d[1],g=Math.min(e,b[0]),k=Math.min(d,b[1]),l=Math.max(e,b[2]);b=Math.max(d,b[3]);for(var p=1;p<c.length;p++){var n=c[p],w=n[0],n=n[1],e=e+w,d=d+n;0>w&&(g=Math.min(g,e));0<w&&(l=Math.max(l,e));0>n?k=Math.min(k,d):
0<n&&(b=Math.max(b,d))}a[0]=g;a[1]=k;a[2]=l;a[3]=b;return a}function C(a,b){if(!b.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(var c=0;c<b.length;c++)F(a,a,b[c]);return a}function g(a,b,c,d,e){b.xmin=q(a,c.xmin);b.ymin=k(a,c.ymin);b.xmax=q(a,c.xmax);b.ymax=k(a,c.ymax);b!==c&&(d&&(b.zmin=c.zmin,b.zmax=c.zmax),e&&(b.mmin=c.mmin,b.mmax=c.mmax));return b}function t(a,b,c,d,g){b.points=e(a,c.points,d,g);return b}function l(a,b,c,d,e){b.x=q(a,c.x);b.y=k(a,
c.y);b!==c&&(d&&(b.z=c.z),e&&(b.m=c.m));return b}function H(a,c,d,e,g){a=b(a,d.rings,e,g);if(!a)return null;c.rings=a;return c}function O(a,b,c,d,e){a=p(a,c.paths,d,e);if(!a)return null;b.paths=a;return b}Object.defineProperty(a,"__esModule",{value:!0});a.unquantizePolyline=a.unquantizePolygon=a.unquantizePoint=a.unquantizeMultipoint=a.unquantizeExtent=a.quantizeGeometry=a.quantizePolyline=a.quantizePolygon=a.quantizePoint=a.quantizeMultipoint=a.quantizeExtent=a.getQuantizedBoundsRings=a.getQuantizedBoundsPaths=
a.getQuantizedBoundsPoints=a.getQuantizedBoundsCoordsArrayArray=a.getQuantizedBoundsCoordsArray=a.unquantizeRings=a.unquantizePaths=a.unquantizePoints=a.unquantizeBounds=a.unquantizeCoordsArrayArray=a.unquantizeCoordsArray=a.unquantizeY=a.unquantizeX=a.quantizePaths=a.quantizeRings=a.quantizePoints=a.quantizeBounds=a.quantizeY=a.quantizeX=a.equals=a.toQuantizationTransform=void 0;var D=function(a,b,c){return[b,c]},M=function(a,b,c){return[b,c,a[2]]},N=function(a,b,c){return[b,c,a[2],a[3]]};a.toQuantizationTransform=
function(a){return a?{originPosition:"upper-left"===a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,b){if(a===b||null==a&&null==b)return!0;if(null==a||null==b)return!1;var c,d,e,g;a&&"upperLeft"===a.originPosition?(c=a.translate[0],d=a.translate[1],a=a.scale[0]):(c=a.extent.xmin,d=a.extent.ymax,a=a.tolerance);b&&"upperLeft"===b.originPosition?(e=b.translate[0],
g=b.translate[1],b=b.scale[0]):(e=b.extent.xmin,g=b.extent.ymax,b=b.tolerance);return c===e&&d===g&&a===b};a.quantizeX=q;a.quantizeY=k;a.quantizeBounds=function(a,b,c){b[0]=q(a,c[0]);b[3]=k(a,c[1]);b[2]=q(a,c[2]);b[1]=k(a,c[3]);return b};a.quantizePoints=e;a.quantizeRings=b;a.quantizePaths=p;a.unquantizeX=u;a.unquantizeY=x;a.unquantizeCoordsArray=d;a.unquantizeCoordsArrayArray=y;a.unquantizeBounds=function(a,b,c){return c?(b[0]=u(a,c[0]),b[1]=x(a,c[3]),b[2]=u(a,c[2]),b[3]=x(a,c[1]),b):[u(a,b[0]),
x(a,b[3]),u(a,b[2]),x(a,b[1])]};a.unquantizePoints=v;a.unquantizePaths=n;a.unquantizeRings=G;a.getQuantizedBoundsCoordsArray=F;a.getQuantizedBoundsCoordsArrayArray=C;a.getQuantizedBoundsPoints=function(a){var b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return F(b,b,a)};a.getQuantizedBoundsPaths=function(a){return C([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return C([0,0,0,0],a)};a.quantizeExtent=g;a.quantizeMultipoint=t;a.quantizePoint=
l;a.quantizePolygon=H;a.quantizePolyline=O;a.quantizeGeometry=function(a,b){return a&&b?r.isPoint(b)?l(a,{},b,!1,!1):r.isPolyline(b)?O(a,{},b,!1,!1):r.isPolygon(b)?H(a,{},b,!1,!1):r.isMultipoint(b)?t(a,{},b,!1,!1):r.isExtent(b)?g(a,{},b,!1,!1):null:null};a.unquantizeExtent=function(a,b,c,d,e){b.xmin=u(a,c.xmin);b.ymin=x(a,c.ymin);b.xmax=u(a,c.xmax);b.ymax=x(a,c.ymax);b!==c&&(d&&(b.zmin=c.zmin,b.zmax=c.zmax),e&&(b.mmin=c.mmin,b.mmax=c.mmax));return b};a.unquantizeMultipoint=function(a,b,c,d,e){b.points=
v(a,c.points,d,e);return b};a.unquantizePoint=function(a,b,c,d,e){b.x=u(a,c.x);b.y=x(a,c.y);b!==c&&(d&&(b.z=c.z),e&&(b.m=c.m));return b};a.unquantizePolygon=function(a,b,c,d,e){b.rings=G(a,c.rings,d,e);return b};a.unquantizePolyline=function(a,b,c,d,e){b.paths=n(a,c.paths,d,e);return b}})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(z,a,r,q){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,
e,b){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=b;this.featureAdapter=e;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=e=0;c<a.length;c++){var k=a[c],r=q.getExpressionFromFieldName(k),d=this.fieldsIndex.get(r),r=d?null:q.getWhereClause(r,b),d=d?d.name:q.getAliasFromFieldName(k)||"FIELD_EXP_"+e++;this._fieldDataCache.set(k,{alias:d,clause:r})}}}a.prototype.countDistinctValues=function(a){var c=
this;if(!this.returnDistinctValues)return a.length;a.forEach(function(a){return c.getAttributes(a)});return this._returnDistinctMap.size};a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,e,b){var c=b?b.name:e,k=null;this._fieldDataCache.has(c)?k=this._fieldDataCache.get(c).clause:b||(k=q.getWhereClause(e,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:k}));return b?this.featureAdapter.getAttribute(a,
c):k.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:q.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:q.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=
function(a){var c=this.outFields;if(!c||!c.length)return this.featureAdapter.getAttributes(a);for(var b={},k=0;k<c.length;k++){var u=this._fieldDataCache.get(c[k]),q=u.alias,u=u.clause;b[q]=u?u.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,q)}return b};a.prototype._processAttributesForDistinctValues=function(a){if(r.isNone(a)||!this.returnDistinctValues)return a;var c=this.outFields,b=[];if(c)for(var k=0;k<c.length;k++){var u=this._fieldDataCache.get(c[k]).alias;b.push(a[u])}else for(u in a)b.push(a[u]);
c=(c||["*"]).join(",")+"\x3d"+b.join(",");b=this._returnDistinctMap.get(c)||0;this._returnDistinctMap.set(c,++b);return 1<b?null:a};return a}();a.default=z})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(z,a){function r(a,e,b,k,u){if(null!=k&&null!=u)return function(c){var d=a.getAttribute(c,e);c=a.getAttribute(c,b);return(null==d||d<=u)&&(null==c||c>=k)};if(null!=k)return function(c){c=a.getAttribute(c,b);return null==c||c>=k};if(null!=u)return function(b){b=
a.getAttribute(b,e);return null==b||b<=u}}function q(a,e,b,k){if(null!=b&&null!=k&&b===k)return function(c){return a.getAttribute(c,e)===b};if(null!=b&&null!=k)return function(c){c=a.getAttribute(c,e);return c>=b&&c<=k};if(null!=b)return function(c){return a.getAttribute(c,e)>=b};if(null!=k)return function(b){return a.getAttribute(b,e)<=k}}function k(){return function(){return!1}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeOperator=a.getTimeExtent=void 0;a.getTimeExtent=function(a,e){if(!a)return null;
var b=e.featureAdapter,c=a.startTimeField,k=a.endTimeField,q=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;if(c&&k)e.forEach(function(a){var e=b.getAttribute(a,c);a=b.getAttribute(a,k);null==e||isNaN(e)||(q=Math.min(q,e));null==a||isNaN(a)||(d=Math.max(d,a))});else{var r=c||k;e.forEach(function(a){a=b.getAttribute(a,r);null==a||isNaN(a)||(q=Math.min(q,a),d=Math.max(d,a))})}return{start:q,end:d}};a.getTimeOperator=function(a,e,b){if(!e||!a)return null;var c=a.startTimeField;a=a.endTimeField;
if(!c&&!a)return null;var u=e.start;e=e.end;return null===u&&null===e?null:void 0===u&&void 0===e?k():c&&a?r(b,c,a,u,e):q(b,c||a,u,e)}})},"esri/layers/graphics/data/utils":function(){define("require exports tslib ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(z,a,r,q,k,c,e,b,p,u,x,d,y,v,n){function G(a,b,c,e,g){void 0===e&&(e=a.hasZ);void 0===g&&(g=a.hasM);var k=a.hasZ&&e,l=a.hasM&&g;return c?(a=d.quantizeOptimizedGeometry(H,b,a.hasZ,a.hasM,"esriGeometryPoint",c,e,g),d.convertToPoint(a,k,l)):d.convertToPoint(b,k,l)}function F(c,d,g){return r.__awaiter(this,void 0,void 0,function(){var l,m,n,t,q,u;return r.__generator(this,function(r){switch(r.label){case 0:if(!c)return[2,null];l=c.where;c.where=l=l&&l.trim();if(!l||/^1 *= *1$/.test(l)||d&&d===
l)c.where=null;return c.geometry?[4,C(c)]:[2,c];case 1:return m=r.sent(),c.distance=0,c.units=null,"esriSpatialRelEnvelopeIntersects"===c.spatialRel&&(n=c.geometry.spatialReference,m=e.getGeometryExtent(m),m.spatialReference=n),c.geometry=m,[4,v.checkProjectionSupport(m.spatialReference,g)];case 2:return r.sent(),[4,p.normalizeCentralMeridian(b.fromJSON(m))];case 3:t=r.sent()[0];if(k.isNone(t))throw a.QUERY_ENGINE_EMPTY_RESULT;q=t.toJSON();return[4,v.project(q,q.spatialReference,g)];case 4:u=r.sent();
if(!u)throw a.QUERY_ENGINE_EMPTY_RESULT;u.spatialReference=g;c.geometry=u;return[2,c]}})})}function C(a){return r.__awaiter(this,void 0,void 0,function(){var b,d,e,k,l,p,t,q,x;return r.__generator(this,function(m){switch(m.label){case 0:b=a.geometry;d=a.distance;e=a.units;if(null==d||"vertexAttributes"in b)return[2,b];k=b.spatialReference;l=e?g.fromJSON(e):c.getUnitString(k);p=k&&(u.isGeographic(k)||u.isWebMercator(k));if(!p)return[3,1];q=b;return[3,3];case 1:return[4,v.checkProjectionSupport(k,u.WGS84).then(function(){return v.project(b,
u.WGS84)})];case 2:q=m.sent(),m.label=3;case 3:return t=q,[4,n.getGeodesicBufferOperator()];case 4:return x=m.sent(),[2,x(t.spatialReference,t,d,l)]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.cleanFromGeometryEngine=a.normalizeQueryLike=a.normalizeFilter=a.normalizeQuery=a.getGeometry=a.getCentroid=a.transformCentroid=a.QUERY_ENGINE_EMPTY_RESULT=void 0;var g=new q.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var t=new y.default,l=new y.default,H=new y.default,O={esriGeometryPoint:d.convertToPoint,esriGeometryPolyline:d.convertToPolyline,esriGeometryPolygon:d.convertToPolygon,esriGeometryMultipoint:d.convertToMultipoint};a.transformCentroid=G;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=
x.getCentroidOptimizedGeometry(new y.default,b.geometry,a.hasZ,a.hasM));return G(a,b.centroid,c)};a.getGeometry=function(a,b,c,e,g,k,p,n){void 0===p&&(p=b);void 0===n&&(n=c);var m=b&&p,q=c&&n;e=e?"coords"in e?e:e.geometry:null;if(!e)return null;if(g)return b=d.generalizeOptimizedGeometry(l,e,b,c,a,g,p,n),k&&(b=d.quantizeOptimizedGeometry(H,b,m,q,a,k)),O[a](b,m,q);if(k)return b=d.quantizeOptimizedGeometry(H,e,b,c,a,k,p,n),O[a](b,m,q);d.removeZMValues(t,e,b,c,p,n);return O[a](t,m,q)};a.normalizeQuery=
function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e,g,k,l;return r.__generator(this,function(m){d=a.outFields;e=a.orderByFields;g=a.groupByFieldsForStatistics;k=a.outStatistics;if(d)for(l=0;l<d.length;l++)d[l]=d[l].trim();if(e)for(l=0;l<e.length;l++)e[l]=e[l].trim();if(g)for(l=0;l<g.length;l++)g[l]=g[l].trim();if(k)for(l=0;l<k.length;l++)k[l].onStatisticField&&(k[l].onStatisticField=k[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,
F(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(d){return[2,F(a,b,c)]})})};a.normalizeQueryLike=F;a.cleanFromGeometryEngine=function(a){return a&&D in a?JSON.parse(JSON.stringify(a,M)):a};var D="_geVersion",M=function(a,b){return a!==D?b:void 0}})},"esri/geometry/support/normalizeUtils":function(){define("require exports tslib ../../config ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../Polygon ../Polyline ../SpatialReference ./spatialReferenceUtils ./webMercatorUtils ../../tasks/geometry/cut ../../tasks/geometry/simplify".split(" "),
function(z,a,r,q,k,c,e,b,p,u,x,d,y,v,n){function G(a){return"polygon"===a.type?a.rings:a.paths}function F(a,b){return Math.ceil((a-b)/(2*b))}function C(a,b){for(var c=0,d=G(a);c<d.length;c++)for(var e=0,g=d[c];e<g.length;e++)g[e][0]+=b;return a}function g(a){for(var b=[],c=0,d=0,e=0;e<a.length;e++){for(var g=a[e],k=null,l=0;l<g.length;l++)k=g[l],b.push(k),0===l?d=c=k[0]:(c=Math.min(c,k[0]),d=Math.max(d,k[0]));k&&b.push([(c+d)/2,0])}return b}function t(a,b){if(!(a instanceof u||a instanceof p))throw M.error("straightLineDensify: the input geometry is neither polyline nor polygon"),
new k("straightLineDensify: the input geometry is neither polyline nor polygon");for(var c=[],d=0,e=G(a);d<e.length;d++){var g=e[d],l=[];c.push(l);l.push([g[0][0],g[0][1]]);for(var n=0;n<g.length-1;n++){var t=g[n][0],q=g[n][1],r=g[n+1][0],v=g[n+1][1],x=Math.sqrt((r-t)*(r-t)+(v-q)*(v-q)),P=(v-q)/x,R=(r-t)/x,y=x/b;if(1<y){for(var H=1;H<=y-1;H++){var D=H*b;l.push([R*D+t,P*D+q])}x=(x+Math.floor(y-1)*b)/2;l.push([R*x+t,P*x+q])}l.push([r,v])}}return"polygon"===a.type?new p({rings:c,spatialReference:a.spatialReference}):
new u({paths:c,spatialReference:a.spatialReference})}function l(a,b,c){b&&(a=t(a,1E6),a=y.webMercatorToGeographic(a,!0));c&&(a=C(a,c));return a}function H(a,b,c){if(Array.isArray(a)){var d=a[0];if(d>b){var e=F(d,b);a[0]=d+-2*e*b}else d<c&&(e=F(d,c),a[0]=d+-2*e*c)}else d=a.x,d>b?(e=F(d,b),a=a.clone().offset(-2*e*b,0)):d<c&&(e=F(d,c),a=a.clone().offset(-2*e*c,0));return a}function O(a,b){for(var c=-1,d=function(d){var e=b.cutIndexes[d],g=b.geometries[d],k=G(g);d=function(a){var b=k[a];b.some(function(c){if(180>
c[0])return!0;for(var d=c=0;d<b.length;d++){var e=b[d][0];c=e>c?e:c}c=Number(c.toFixed(9));c=-360*F(c,180);for(d=0;d<b.length;d++)e=g.getPoint(a,d),g.setPoint(a,d,e.clone().offset(c,0));return!0})};for(var l=0;l<k.length;l++)d(l);if(e===c)if("polygon"===a[0].type)for(d=0,l=G(g);d<l.length;d++)a[e]=a[e].addRing(l[d]);else{if("polyline"===a[0].type)for(d=0,l=G(g);d<l.length;d++)a[e]=a[e].addPath(l[d])}else c=e,a[e]=g},e=0;e<b.cutIndexes.length;e++)d(e);return a}function D(a,c,g){return r.__awaiter(this,
void 0,void 0,function(){var k,t,w,x,z,J,I,M,G,U,P,R,ja,X,Q,Z,T,ea,ha,qa,ka,Ia,Ma,ib,Ya,Za,jb,Ba,Fa,ua,da,fa,ma,ga,ia,B,Ca;return r.__generator(this,function(m){switch(m.label){case 0:if(!Array.isArray(a))return[2,D([a],c)];k=c?c.url:q.geometryServiceUrl;U=0;P=[];R=[];ja=0;for(X=a;ja<X.length;ja++)Q=X[ja],e.isNone(Q)?R.push(Q):(t||(t=Q.spatialReference,w=d.getInfo(t),I=(x=t.isWebMercator)?102100:4326,z=N[I].maxX,J=N[I].minX,M=N[I].plus180Line,G=N[I].minus180Line),w?"mesh"===Q.type?R.push(Q):"point"===
Q.type?R.push(H(Q.clone(),z,J)):"multipoint"===Q.type?(Z=Q.clone(),Z.points=Z.points.map(function(a){return H(a,z,J)}),R.push(Z)):"extent"===Q.type?(T=Q.clone(),ea=T._normalize(!1,!1,w),R.push(ea.rings?new p(ea):ea)):Q.extent?(T=Q.extent,ha=F(T.xmin,J),qa=2*ha*z,ka=0===qa?Q.clone():C(Q.clone(),qa),T.offset(qa,0),T.intersects(M)&&T.xmax!==z?(U=T.xmax>U?T.xmax:U,ka=l(ka,x),P.push(ka),R.push("cut")):T.intersects(G)&&T.xmin!==J?(U=2*T.xmax*z>U?2*T.xmax*z:U,ka=l(ka,x,360),P.push(ka),R.push("cut")):R.push(ka)):
R.push(Q.clone()):R.push(Q));Ia=F(U,z);Ma=-90;ib=Ia;for(Ya=new u;0<Ia;)Za=-180+360*Ia,Ya.addPath([[Za,Ma],[Za,-1*Ma]]),Ma*=-1,Ia--;return 0<P.length&&0<ib?[4,v.cut(k,P,Ya,g)]:[3,3];case 1:jb=m.sent();Ba=O(P,jb);Fa=[];ua=[];for(da=0;da<R.length;da++)fa=R[da],"cut"!==fa?ua.push(fa):(ma=Ba.shift(),ga=a[da],e.isSome(ga)&&"polygon"===ga.type&&ga.rings&&1<ga.rings.length&&ma.rings.length>=ga.rings.length?(Fa.push(ma),ua.push("simplify")):ua.push(x?y.geographicToWebMercator(ma):ma));return Fa.length?[4,
n.simplify(k,Fa,g)]:[2,ua];case 2:ia=m.sent();B=[];for(da=0;da<ua.length;da++)fa=ua[da],"simplify"!==fa?B.push(fa):B.push(x?y.geographicToWebMercator(ia.shift()):ia.shift());return[2,B];case 3:Ca=[];for(da=0;da<R.length;da++)fa=R[da],"cut"!==fa?Ca.push(fa):(ma=P.shift(),Ca.push(!0===x?y.geographicToWebMercator(ma):ma));return[2,b.resolve(Ca)]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.normalizeMapX=a.getDenormalizedExtent=a.normalizeCentralMeridian=a.straightLineDensify=void 0;var M=
c.getLogger("esri.geometry.support.normalizeUtils"),N={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new u({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:x.WebMercator}),minus180Line:new u({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:x.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new u({paths:[[[180,-180],[180,180]]],spatialReference:x.WGS84}),
minus180Line:new u({paths:[[[-180,-180],[-180,180]]],spatialReference:x.WGS84})}};a.straightLineDensify=t;a.normalizeCentralMeridian=D;a.getDenormalizedExtent=function(a){var b;if(!a)return null;var c=a.extent;if(!c)return null;var e=a.spatialReference&&d.getInfo(a.spatialReference);if(!e)return c;var e=e.valid,k=e[0],e=e[1],l=c.width,p=c.xmin;b=c.xmax;b=[b,p];p=b[0];b=b[1];if("extent"===a.type||0===l||l<=e||l>2*e||p<k||b>e)return c;var n;switch(a.type){case "polygon":if(1<a.rings.length)n=g(a.rings);
else return c;break;case "polyline":if(1<a.paths.length)n=g(a.paths);else return c;break;case "multipoint":n=a.points}a=c.clone();for(k=0;k<n.length;k++){var t=n[k][0];0>t?(t+=e,b=Math.max(t,b)):(t-=e,p=Math.min(t,p))}a.xmin=p;a.xmax=b;return a.width<l?(a.xmin-=e,a.xmax-=e,a):c};a.normalizeMapX=function(a,b){if(b=d.getInfo(b)){var c=b.valid;b=c[0];var c=c[1],e=c-b;if(a<b)for(;a<b;)a+=e;if(a>c)for(;a>c;)a-=e}return a}})},"esri/tasks/geometry/cut":function(){define("require exports tslib ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),
function(z,a,r,q,k,c,e){Object.defineProperty(a,"__esModule",{value:!0});a.cut=void 0;a.cut=function(a,p,u,x){return r.__awaiter(this,void 0,void 0,function(){var b,y,v,n,z,F,C,g;return r.__generator(this,function(d){switch(d.label){case 0:return b="string"===typeof a?c.urlToObject(a):a,y=p[0].spatialReference,v=r.__assign(r.__assign({},x),{query:r.__assign(r.__assign({},b.query),{f:"json",sr:JSON.stringify(y),target:JSON.stringify({geometryType:e.getJsonType(p[0]),geometries:p}),cutter:JSON.stringify(u)})}),
[4,k(b.path+"/cut",v)];case 1:return n=d.sent(),z=n.data,F=z.cutIndexes,C=z.geometries,g=void 0===C?[]:C,[2,{cutIndexes:F,geometries:g.map(function(a){a=q.fromJSON(a);a.spatialReference=y;return a})}]}})})}})},"esri/tasks/geometry/simplify":function(){define("require exports tslib ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(z,a,r,q,k,c){function e(a){return{geometryType:c.getJsonType(a[0]),geometries:a.map(function(a){return a.toJSON()})}}function b(a,b,
e){var d=c.getGeometryType(b);return a.map(function(a){a=d.fromJSON(a);a.spatialReference=e;return a})}Object.defineProperty(a,"__esModule",{value:!0});a.simplify=void 0;a.simplify=function(a,u,x){return r.__awaiter(this,void 0,void 0,function(){var d,p,v,n,z;return r.__generator(this,function(y){switch(y.label){case 0:return d="string"===typeof a?k.urlToObject(a):a,p=u[0].spatialReference,v=c.getJsonType(u[0]),n=r.__assign(r.__assign({},x),{query:r.__assign(r.__assign({},d.query),{f:"json",sr:p.wkid?
p.wkid:JSON.stringify(p),geometries:JSON.stringify(e(u))})}),[4,q(d.path+"/simplify",n)];case 1:return z=y.sent(),[2,b(z.data,v,p)]}})})}})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils @dojo/framework/shim/Promise".split(" "),
function(z,a,r,q,k,c,e,b,p,u,x,d,y,v){function n(){return new Promise(function(a,b){z(["../../../geometry/geometryEngineJSON"],a,b)})}Object.defineProperty(a,"__esModule",{value:!0});a.canQueryWithRBush=a.checkSpatialQuerySupport=a.getSpatialQueryOperator=a.getGeodesicBufferOperator=a.importGeometryEngine=void 0;var G={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",
esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},F={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},C={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!0},g={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=n;a.getGeodesicBufferOperator=function(){return n().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,g,p,q,r){if(b.isPolygon(g)&&"esriGeometryPoint"===p&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var l=x.convertFromPolygon(new d.default,g,!1,!1);return k.resolve(function(a){return u.polygonContainsPoint(l,
!1,!1,a)})}if(b.isPolygon(g)&&"esriGeometryMultipoint"===p){var t=x.convertFromPolygon(new d.default,g,!1,!1);if("esriSpatialRelContains"===a)return k.resolve(function(a){return u.polygonContainsMultipoint(t,!1,!1,a,q,r)})}if(b.isExtent(g)&&"esriGeometryPoint"===p&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return k.resolve(function(a){return c.extentContainsPoint(g,v.getGeometry(p,q,r,a))});if(b.isExtent(g)&&"esriGeometryMultipoint"===p&&"esriSpatialRelContains"===a)return k.resolve(function(a){return c.extentContainsMultipoint(g,
v.getGeometry(p,q,r,a))});if(b.isExtent(g)&&"esriSpatialRelIntersects"===a){var y=e.getExtentIntersector(p);return k.resolve(function(a){return y(g,v.getGeometry(p,q,r,a))})}return n().then(function(b){var c=b[G[a]].bind(null,g.spatialReference,g);return function(a){return c(v.getGeometry(p,q,r,a))}})};a.checkSpatialQuerySupport=function(a,c,d){return r.__awaiter(this,void 0,void 0,function(){var e,k;return r.__generator(this,function(l){e=a.spatialRel;k=a.geometry;if(!k)return[2];if(!0!==F[e])throw new q("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!p.isValid(k.spatialReference)||!p.isValid(d))return[2];if(!0!==C[b.getJsonType(k)])throw new q("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==g[c])throw new q("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,y.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(b.isExtent(a))return!0;if(b.isPolygon(a)){var c=
0;for(a=a.rings;c<a.length;c++){var d=a[c];if(5!==d.length||d[0][0]!==d[1][0]||d[0][0]!==d[4][0]||d[2][0]!==d[3][0]||d[0][1]!==d[3][1]||d[0][1]!==d[4][1]||d[1][1]!==d[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(z,a){function r(a,k,c,e,b){if(!a)return!1;k=k?c?4:3:c?3:2;c=a.coords;var p=!1,q=0,r=0;for(a=a.lengths;r<a.length;r++){for(var d=a[r],y=q,v=q,n=q+d*k;v<n;v+=k){y=v+k;y===n&&(y=q);var z=c[v],F=c[v+1],C=c[y],y=c[y+1];(F<
b&&y>=b||y<b&&F>=b)&&z+(b-F)/(y-F)*(C-z)<e&&(p=!p)}q+=d*k}return p}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsCoords=a.polygonContainsMultipoint=a.polygonContainsPoint=void 0;a.polygonContainsPoint=function(a,k,c,e){return r(a,k,c,e.coords[0],e.coords[1])};a.polygonContainsMultipoint=function(a,k,c,e,b,p){b=b?p?4:3:p?3:2;p=e.coords;e=e.lengths;if(!e)return!1;for(var q=0,x=0;q<e.length;q++,x+=b)if(!r(a,k,c,p[x],p[x+1]))return!1;return!0};a.polygonContainsCoords=r})},"esri/layers/support/FieldsIndex":function(){define(["require",
"exports"],function(z,a){return function(){function a(a){this.fields=a;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this.dateFields=[];if(a){for(var k=[],c=0;c<a.length;c++){var e=a[c],b=e&&e.name;if(b){var p=b.toLowerCase().trim();this._fieldsMap.set(b,e);this._fieldsMap.set(p,e);k.push(p);if("date"===e.type||"esriFieldTypeDate"===e.type)this.dateFields.push(e),this._dateFieldsSet.add(e)}}k.sort();this.uid=k.join(",")}}a.prototype.destroy=function(){this._fieldsMap.clear()};a.prototype.has=
function(a){return null!=this.get(a)};a.prototype.get=function(a){return null!=a?this._fieldsMap.get(a)||this._fieldsMap.get(a.toLowerCase().trim()):void 0};a.prototype.isDateField=function(a){return this._dateFieldsSet.has(this.get(a))};a.prototype.normalizeFieldName=function(a){if(a=this.get(a))return a.name};return a}()})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports tslib ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),function(z,
a,r,q,k,c){function e(a){var b=[];a.forEach(function(a){return b.push(a)});return b}function b(a){var b,c,d,e;return r.__generator(this,function(g){switch(g.label){case 0:b=a.type;switch(b){case "Feature":return[3,1];case "FeatureCollection":return[3,3]}return[3,7];case 1:return[4,a];case 2:return g.sent(),[3,7];case 3:c=0,d=a.features,g.label=4;case 4:return c<d.length?(e=d[c])?[4,e]:[3,6]:[3,7];case 5:g.sent(),g.label=6;case 6:return c++,[3,4];case 7:return[2]}})}function p(a){var b,c,d,e,g,k,p,
n,q,u;return r.__generator(this,function(l){switch(l.label){case 0:if(!a)return[2,null];b=a.type;switch(b){case "Point":return[3,1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,a.coordinates];case 2:return l.sent(),[3,17];case 3:return[5,r.__values(a.coordinates)];case 4:return l.sent(),[3,17];case 5:c=0,d=a.coordinates,l.label=6;case 6:if(!(c<d.length))return[3,
9];e=d[c];return[5,r.__values(e)];case 7:l.sent(),l.label=8;case 8:return c++,[3,6];case 9:return[3,17];case 10:g=0,k=a.coordinates,l.label=11;case 11:if(!(g<k.length))return[3,16];p=k[g];n=0;q=p;l.label=12;case 12:if(!(n<q.length))return[3,15];u=q[n];return[5,r.__values(u)];case 13:l.sent(),l.label=14;case 14:return n++,[3,12];case 15:return g++,[3,11];case 16:return[3,17];case 17:return[2]}})}function u(a,b){var d,e,g,p,n,q,t,u,w,m;void 0===b&&(b={});return r.__generator(this,function(l){switch(l.label){case 0:d=
b.geometryType,e=b.objectIdFieldName,l.label=1;case 1:g=a.next();p=g.value;if(n=g.done)return[2];q=p.geometry;t=p.properties;u=p.id;if(q&&C[q.type]!==d)return[3,1];w=t||{};e&&null!=u&&!w[e]&&(w[e]=u);m=new k.default(q?v(new c.default,q,b):null,w);return[4,m];case 2:return l.sent(),[3,1];case 3:return[2]}})}function x(a){for(;;){var b=a.next();if(b.done)return!1;if(2<b.value.length)return!0}}function d(a){for(var b=0,c=0;c<a.length;c++)var d=a[c],e=a[(c+1)%a.length],b=b+(d[0]*e[1]-e[0]*d[1]);return 0>=
b}function y(a){var b=a[0],c=a[a.length-1];b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]||a.push(b);return a}function v(a,b,c){switch(b.type){case "LineString":return n(a,b.coordinates,c),a;case "MultiLineString":var e=0;for(b=b.coordinates;e<b.length;e++)n(a,b[e],c);return a;case "MultiPoint":return n(a,b.coordinates,c),a;case "MultiPolygon":e=0;for(b=b.coordinates;e<b.length;e++){var g=b[e],k=a,l=c,p=y(g[0]);d(p)?n(k,p,l):G(k,p,l);for(k=1;k<g.length;k++){var l=a,p=c,q=y(g[k]);d(q)?G(l,q,p):n(l,q,p)}}return a;
case "Point":return F(a,b.coordinates,c),a;case "Polygon":e=b.coordinates;b=y(e[0]);d(b)?n(a,b,c):G(a,b,c);for(b=1;b<e.length;b++)g=a,k=c,l=y(e[b]),d(l)?G(g,l,k):n(g,l,k);return a}}function n(a,b,c){for(var d=0;d<b.length;d++)F(a,b[d],c);a.lengths.push(b.length)}function G(a,b,c){for(var d=b.length-1;0<=d;d--)F(a,b[d],c);a.lengths.push(b.length)}function F(a,b,c){var d=b[2];a.coords.push(b[0],b[1]);c.hasZ&&a.coords.push(d||0)}Object.defineProperty(a,"__esModule",{value:!0});a.createOptimizedFeatures=
a.inferLayerProperties=a.validateGeoJSON=void 0;var C={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};a.validateGeoJSON=function(a){if(!a)throw new q("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new q("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",
{data:a});if(a=a.crs){var b="string"===typeof a?a:"name"===a.type?a.properties.name:null,c=/.*(CRS84H?|4326)$/i;if(!b||!c.test(b))throw new q("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:a});}};a.inferLayerProperties=function(a,c){void 0===c&&(c={});var d=b(a),g=[],k=new Set,n=new Set,q=!1,r=Number.NEGATIVE_INFINITY,u=null,t=!1,v=void 0;a=c.geometryType;var m=void 0===a?null:a,y=!1;for(a=function(){var a=d.next(),b=a.value;if(a.done){var c=u&&1===u.length&&u[0]||null;if(c)for(b=
0;b<g.length;b++)a=g[b],a.name===c&&(a.type="esriFieldTypeOID");return{value:{fields:g,geometryType:m,hasZ:q,maxObjectId:Math.max(0,r),objectIdFieldName:c,objectIdFieldType:v,unknownFields:e(n)}}}var a=b.geometry,l=b.properties,w=b.id;if(a&&(m||(m=C[a.type]),C[a.type]!==m))return"continue";q||(b=p(a),q=x(b));!t&&(t=null!=w)&&(v=typeof w,"number"===v&&(u=Object.keys(l).filter(function(a){return l[a]===w})));t&&"number"===v&&null!=w&&(r=Math.max(r,w),1<u.length?u=u.filter(function(a){return l[a]===
w}):1===u.length&&(u=l[u[0]]===w?u:[]));if(!y&&l){b=!0;for(c in l)if(!k.has(c))if(a=l[c],null==a)b=!1,n.add(c);else{a:switch(typeof a){case "string":a="esriFieldTypeString";break a;case "number":a="esriFieldTypeDouble";break a;default:a="unknown"}"unknown"===a?n.add(c):(n.delete(c),k.add(c),g.push({name:c,alias:c,type:a}))}y=b}};;)if(c=a(),"object"===typeof c)return c.value};a.createOptimizedFeatures=function(a,c){a:for(a=u(b(a),c),c=[];;){var d=a.next(),e=d.value;if(d.done)break a;c.push(e)}return c}})},
"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports tslib ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(z,a,r,q,k,c){Object.defineProperty(a,"__esModule",{value:!0});a.createDefaultTemplate=a.createDefaultAttributesFunction=a.createDrawingInfo=void 0;a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===
a?c.defaultPolylineSymbolJSON:c.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(q("csp-restrictions"))return function(){var c;return r.__assign((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",e;for(e in a)var k=e.indexOf(".")?'["'+e+'"]':"."+e,c=c+("this"+k+" \x3d "+JSON.stringify(a[e])+";");var d=new Function(c);return function(){return new d}}catch(y){return function(){var c;return r.__assign((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===
a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:k.clone(a)}}]}})},"esri/symbols/support/defaultsJSON":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});a.errorPolygonSymbolJSON=a.errorPolylineSymbolJSON=a.errorPointSymbolJSON=a.defaultTextSymbolJSON=a.defaultPolygonSymbolJSON=a.defaultPolylineSymbolJSON=a.defaultPointSymbolJSON=a.defaultOutlineColor=a.defaultColor=void 0;a.defaultColor=[252,146,31,255];a.defaultOutlineColor=
[153,153,153,255];a.defaultPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",size:6,color:a.defaultColor,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}};a.defaultPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",width:.75,color:a.defaultColor};a.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};a.defaultTextSymbolJSON={type:"esriTS",color:[255,
255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};a.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};a.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};a.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}})},"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports tslib ../../../../geometry/support/spatialReferenceUtils ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),
function(z,a,r,q,k){function c(a){return new p(a)}function e(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(a){switch(a.label){case 0:return d?[2,d]:[4,new Promise(function(a,b){z(["../../../../geometry/geometryEngineJSON"],a,b)})];case 1:return d=a.sent(),[2,d]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.loadGeometryEngineForSimplify=a.loadGeometryEngine=a.simplify=a.mixAttributes=a.createFeatureEditSuccessResult=a.createFeatureEditErrorResult=void 0;
var b=function(){return function(){this.description=this.code=null}}(),p=function(){return function(a){this.error=new b;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=c;var u=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();a.createFeatureEditSuccessResult=function(a){return new u(a)};var x=new Set;a.mixAttributes=function(a,b,d,e,p,q){void 0===p&&(p=!1);x.clear();for(var g in e){var n=
a.get(g);if(n){var l=e[g],r;r=n;var u=l,v=u;"string"===typeof u&&k.isNumericField(r)?v=parseFloat(u):null!=u&&k.isStringField(r)&&"string"!==typeof u&&(v=String(u));r=k.sanitizeNullFieldValue(v);r!==l&&q&&q.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:n,originalValue:l,sanitizedValue:r}});x.add(n.name);if(n&&(p||n.editable)){if(l=k.validateFieldValue(n,r))return c(k.validationErrorToString(l,n,r));d[n.name]=r}}}for(a=0;a<b.length;a++)if(d=
b[a],!x.has(d.name))return c('missing required field "'+d.name+'"');return null};var d;a.simplify=function(a,b){if(!a||!q.isValid(b))return a;if("rings"in a||"paths"in a){if(!d)throw new TypeError("geometry engine not loaded");return d.simplify(b,a)}return a};a.loadGeometryEngine=e;a.loadGeometryEngineForSimplify=function(a,b){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){switch(c.label){case 0:return!q.isValid(a)||"esriGeometryPolygon"!==b&&"esriGeometryPolyline"!==
b?[3,2]:[4,e()];case 1:c.sent(),c.label=2;case 2:return[2]}})})}})},"esri/layers/support/fieldUtils":function(){define("require exports tslib @dojo/framework/shim/array ../../core/Error ../../core/maybe ../../core/object ../../core/promiseUtils ../../core/SetUtils ./domains ../../support/arcadeOnDemand @dojo/framework/shim/Promise".split(" "),function(z,a,r,q,k,c,e,b,p,u,x){function d(a,b,c){if(a)for(var d=0;d<a.length;d++){var g=a[d],k=e.getDeepValue(g,b);(k=k&&"function"!==typeof k&&G(c,k))&&e.setDeepValue(g,
k.name,b)}}function y(a,b){if(!a||!b)return[];oa.clear();v(oa,a,b);return p.valuesOfSet(oa).sort()}function v(a,b,c){if(c)if(b&&b.length)if(q.includes(c,"*"))for(c=0;c<b.length;c++)a.add(b[c].name);else for(var d=0;d<c.length;d++)e=c[d],n(a,b,e);else if(q.includes(c,"*"))a.clear(),a.add("*");else for(b=0;b<c.length;b++){var e=c[b];a.add(e)}}function n(a,b,c){b&&b.length?(b=G(b,c))&&a.add(b.name):"string"===typeof c&&a.add(c)}function G(a,b){if("string"!==typeof b)return null;if(null!=a){b=b.toLowerCase();
for(var c=0;c<a.length;c++){var d=a[c];if(d&&d.name.toLowerCase()===b)return d}}return null}function F(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e,g,k,l;return r.__generator(this,function(m){switch(m.label){case 0:return c?[4,x.loadArcade()]:[2];case 1:d=m.sent().arcadeUtils;e=d.extractFieldNames(c);g=0;for(k=e;g<k.length;g++)l=k[g],n(a,b,l);return[2]}})})}function C(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d&&d.valueType&&d.valueType===b)return d.name}return null}function g(a,
b){return r.__awaiter(this,void 0,void 0,function(){var c,d;return r.__generator(this,function(g){if(!b)return[2];c=b.fields;return(d=e.getDeepValue("elevationInfo.featureExpressionInfo",b))?[2,d.collectRequiredFields(a,c)]:[2]})})}function t(a,b,c){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(d){c.outStatistic.onStatisticValueExpression?F(a,b,c.outStatistic.onStatisticValueExpression):a.add(c.outStatistic.onStatisticField);return[2]})})}function l(a,c){return r.__awaiter(this,
void 0,void 0,function(){var d,e;return r.__generator(this,function(g){switch(g.label){case 0:return d=c.labelingInfo,e=c.fields,d&&d.length?[4,b.all(d.map(function(b){return H(a,e,b)}))]:[2];case 1:return g.sent(),[2]}})})}function H(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e,g,k,l;return r.__generator(this,function(m){switch(m.label){case 0:if(!c)return[2];d=c.getLabelExpression();e=c.where;return"arcade"!==d.type?[3,2]:[4,F(a,b,d.expression)];case 1:return m.sent(),[3,3];case 2:(g=
d.expression.match(/{[^}]*}/g))&&g.forEach(function(c){n(a,b,c.slice(1,-1))}),m.label=3;case 3:return k=/['"]+/g,e&&(l=e.split(" "),3===l.length&&n(a,b,l[0].replace(k,"")),7===l.length&&(n(a,b,l[0].replace(k,"")),n(a,b,l[4].replace(k,"")))),[2]}})})}function O(a){return"number"===typeof a&&!isNaN(a)&&isFinite(a)}function D(a){return null===a||O(a)}function M(a){return null===a||L(a)}function N(a){return null!=a&&"string"===typeof a}function J(a){return null===a||N(a)}function I(){return!0}function w(a,
b){var c;switch(a.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":c=a.nullable?M:L;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":c=a.nullable?D:O;break;case "string":case "esriFieldTypeString":c=a.nullable?J:N;break;default:c=I}return 1===arguments.length?c:c(b)}function m(a){return null!=a&&sa.has(a.type)}function E(a,b){return a.nullable&&
null===b?null:m(a)&&!ca(a.type,Number(b))?pa.OUT_OF_RANGE:w(a,b)?a.domain?u.validateDomainValue(a.domain,b):null:U.INVALID_TYPE}function ca(a,b){return(a="string"===typeof a?va(a):a)?a.isInteger?L(b)&&b>=a.min&&b<=a.max:b>=a.min&&b<=a.max:!1}function va(b){switch(b){case "esriFieldTypeSmallInteger":case "small-integer":return a.smallIntegerRange;case "esriFieldTypeInteger":case "integer":return a.integerRange;case "esriFieldTypeSingle":case "single":return a.singleRange;case "esriFieldTypeDouble":case "double":return a.doubleRange}}
function na(a,b,d){if(!b||!b.attributes||!a){if(c.isSome(d))for(var e=0;e<a.length;e++)b=a[e],d.add(b);return!0}for(var e=b.attributes,g=!1,k=0;k<a.length;k++)if(b=a[k],!(b in e))if(g=!0,c.isSome(d))d.add(b);else break;return g}Object.defineProperty(a,"__esModule",{value:!0});a.getExpressionFields=a.populateMissingFields=a.featureHasFields=a.validationErrorToString=a.doubleRange=a.singleRange=a.integerRange=a.smallIntegerRange=a.getNumericTypeForValue=a.getFieldRange=a.isNumberInRange=a.validateFieldValue=
a.sanitizeNullFieldValue=a.TypeValidationError=a.NumericRangeValidationError=a.isValidFieldValue=a.isDateField=a.isStringField=a.isNumericField=a.numericTypes=a.isValueMatchingFieldType=a.getFieldDefaultValue=a.collectLabelingFields=a.getLabelingFields=a.getFeatureGeometryFields=a.getFeatureEditFields=a.getTimeFields=a.collectFilterFields=a.collectFeatureReductionFields=a.collectElevationFields=a.getElevationFields=a.getDisplayFieldName=a.collectArcadeFieldNames=a.hasField=a.getField=a.packFields=
a.unpackFieldNames=a.collectField=a.collectFields=a.fixFields=a.fixTimeInfoFields=a.fixRendererFields=a.visualVariableFields=a.rendererFields=void 0;a.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");a.visualVariableFields=["field","normalizationField"];a.fixRendererFields=function(b,c){if(null!=b&&null!=c){var e=0;for(b=Array.isArray(b)?b:[b];e<
b.length;e++){var g=b[e];d(a.rendererFields,g,c);if("visualVariables"in g&&g.visualVariables)for(var k=0,g=g.visualVariables;k<g.length;k++)d(a.visualVariableFields,g[k],c)}}};a.fixTimeInfoFields=function(a,b){if(null!=a&&null!=b)if("startField"in a){var c=G(b,a.startField);b=G(b,a.endField);a.startField=c&&c.name||null;a.endField=b&&b.name||null}else c=G(b,a.startTimeField),b=G(b,a.endTimeField),a.startTimeField=c&&c.name||null,a.endTimeField=b&&b.name||null};var oa=new Set;a.fixFields=y;a.collectFields=
v;a.collectField=n;a.unpackFieldNames=function(a,b){return b&&a?q.includes(b,"*")?a.map(function(a){return a.name}):b:[]};a.packFields=function(a,b,c){void 0===c&&(c=1);if(!b||!a)return[];if(q.includes(b,"*"))return["*"];b=y(a,b);return b.length/a.length>=c?["*"]:b};a.getField=G;a.hasField=function(a,b){if(!a||!b||"string"!==typeof b)return!1;b=b.toLowerCase();for(var c=0;c<a.length;c++){var d=a[c];if(d&&d.name.toLowerCase()===b)return!0}return!1};a.collectArcadeFieldNames=F;a.getDisplayFieldName=
function(a){var b=a.displayField;a=a.fields;if(b)return b;if(!a||!a.length)return null;if(!(b=C(a,"name-or-title")||C(a,"unique-identifier")||C(a,"type-or-category")))a:{for(b=0;b<a.length;b++){var c=a[b];if(c&&c.name){var d=c.name.toLowerCase();if(-1<d.indexOf("name")||-1<d.indexOf("title")){b=c.name;break a}}}b=null}return b};a.getElevationFields=function(a){return r.__awaiter(this,void 0,void 0,function(){var b;return r.__generator(this,function(c){switch(c.label){case 0:if(!a)return[2,[]];b=new Set;
return[4,g(b,a)];case 1:return c.sent(),[2,p.valuesOfSet(b).sort()]}})})};a.collectElevationFields=g;a.collectFeatureReductionFields=function(a,c,d){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return c&&d&&"cluster"===d.type&&d.fields?[4,b.all(d.fields.map(function(b){return t(a,c.fields,b)}))]:[2];case 1:return e.sent(),[2]}})})};a.collectFilterFields=function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e;return r.__generator(this,
function(g){switch(g.label){case 0:if(!b||!c||!(c.where&&"1\x3d1"!==c.where||c.timeExtent))return[2];b.timeInfo&&c.timeExtent&&v(a,b.fields,[b.timeInfo.startField,b.timeInfo.endField]);return c.where?[4,new Promise(function(a,b){z(["../../core/sql/WhereClause"],a,b)})]:[3,2];case 1:d=g.sent();e=d.WhereClause.create(c.where,b.fieldsIndex);if(!e.isStandardized)throw new k("fieldUtils:collectFilterFields","Where clause is not standardized");v(a,b.fields,e.fieldNames);g.label=2;case 2:return[2]}})})};
a.getTimeFields=function(a){return r.__awaiter(this,void 0,void 0,function(){var b;return r.__generator(this,function(c){return a?(b="timeInfo"in a&&a.timeInfo)?[2,y(a.fields,[a.trackIdField,b.startField,b.endField])]:[2,[]]:[2,[]]})})};a.getFeatureEditFields=function(a){if(!a)return[];var b="editFieldsInfo"in a&&a.editFieldsInfo;return b?y(a.fields,[b&&b.creatorField,b&&b.creationDateField,b&&b.editorField,b&&b.editDateField]):[]};a.getFeatureGeometryFields=function(a){if(!a)return[];var b="geometryProperties"in
a&&a.geometryProperties;return b?y(a.fields,[b&&b.shapeAreaFieldName,b&&b.shapeLengthFieldName]):[]};a.getLabelingFields=function(a){return r.__awaiter(this,void 0,void 0,function(){var b;return r.__generator(this,function(c){switch(c.label){case 0:if(!a)return[2,[]];b=new Set;return[4,l(b,a)];case 1:return c.sent(),[2,p.valuesOfSet(b).sort()]}})})};a.collectLabelingFields=l;a.getFieldDefaultValue=function(a){var b=a.defaultValue;if(void 0!==b&&w(a,b))return b;if(a.nullable)return null};var L=function(){return"isInteger"in
Number?Number.isInteger:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}}();a.isValueMatchingFieldType=w;a.numericTypes=["integer","small-integer","single","double"];var sa=p.SetFromValues(r.__spreadArrays(a.numericTypes,["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));a.isNumericField=m;a.isStringField=function(a){return null!=a&&("string"===a.type||"esriFieldTypeString"===a.type)};a.isDateField=function(a){return null!=a&&("date"===
a.type||"esriFieldTypeDate"===a.type)};a.isValidFieldValue=function(a,b){return null===E(a,b)};var pa;(pa=a.NumericRangeValidationError||(a.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";var U;(U=a.TypeValidationError||(a.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";a.sanitizeNullFieldValue=function(a){return null==a||"number"===typeof a&&isNaN(a)?null:a};a.validateFieldValue=E;a.isNumberInRange=ca;a.getFieldRange=function(a){var b=
u.getDomainRange(a.domain);if(b)return b;if(m(a))return va(a.type)};a.getNumericTypeForValue=function(b){if(!O(b))return null;if(L(b)){if(b>=a.smallIntegerRange.min&&b<=a.smallIntegerRange.max)return"esriFieldTypeSmallInteger";if(b>=a.integerRange.min&&b<=a.integerRange.max)return"esriFieldTypeInteger"}return b>=a.singleRange.min&&b<=a.singleRange.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};a.smallIntegerRange={min:-32768,max:32767,isInteger:!0};a.integerRange={min:-2147483648,max:2147483647,
isInteger:!0};a.singleRange={min:-3.4E38,max:1.2E38,isInteger:!1};a.doubleRange={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};a.validationErrorToString=function(a,b,c){switch(a){case u.DomainValidationError.INVALID_CODED_VALUE:return"Value "+c+" is not in the coded domain - field: "+b.name+", domain: "+JSON.stringify(b.domain);case u.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+c+" is out of the range of valid values - field: "+b.name+", domain: "+JSON.stringify(b.domain);case U.INVALID_TYPE:return"Value "+
c+" is not a valid value for the field type - field: "+b.name+", type: "+b.type+", nullable: "+b.nullable;case pa.OUT_OF_RANGE:return a=va(b.type),"Value "+c+" is out of range for the number type - field: "+b.name+", type: "+b.type+", value range is "+a.min+" to "+a.max}};a.featureHasFields=function(a,b){return!na(a,b,null)};a.populateMissingFields=na;a.getExpressionFields=function(a,b){return r.__awaiter(this,void 0,void 0,function(){var c,d,e,g;return r.__generator(this,function(k){switch(k.label){case 0:c=
new Set,d=0,e=b,k.label=1;case 1:if(!(d<e.length))return[3,4];g=e[d];return[4,F(c,a.fields,g)];case 2:k.sent(),k.label=3;case 3:return d++,[3,1];case 4:return[2,p.valuesOfSet(c).sort()]}})})}})},"esri/layers/support/domains":function(){define("require exports ../../core/compilerUtils ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(z,a,r,q,k,c,e){function b(a,b){switch(a.type){case "range":var c="range"in a?a.range[1]:a.maxValue;if(+b<("range"in a?a.range[0]:a.minValue)||
+b>c)return p.VALUE_OUT_OF_RANGE;break;case "coded-value":case "codedValue":if(null==a.codedValues||a.codedValues.every(function(a){return null==a||a.code!==b}))return p.INVALID_CODED_VALUE}return null}Object.defineProperty(a,"__esModule",{value:!0});a.fromJSON=a.getDomainRange=a.types=a.validateDomainValue=a.isValidDomainValue=a.DomainValidationError=a.RangeDomain=a.InheritedDomain=a.DomainBase=a.CodedValueDomain=void 0;a.CodedValueDomain=q;a.DomainBase=k;a.InheritedDomain=c;a.RangeDomain=e;var p;
(function(a){a.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";a.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(p=a.DomainValidationError||(a.DomainValidationError={}));a.isValidDomainValue=function(a,c){return null===b(a,c)};a.validateDomainValue=b;a.types={key:"type",base:k,typeMap:{range:e,"coded-value":q,inherited:c}};a.getDomainRange=function(a){if(a&&"range"===a.type)return{min:"range"in a?a.range[0]:a.minValue,max:"range"in a?a.range[1]:a.maxValue}};a.fromJSON=
function(a){if(!a||!a.type)return null;switch(a.type){case "range":return e.fromJSON(a);case "codedValue":return q.fromJSON(a);case "inherited":return c.fromJSON(a);default:r.neverReached(a)}return null}})},"esri/layers/support/CodedValueDomain":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./CodedValue ./Domain".split(" "),function(z,a,r,q,k,c,e){return function(a){function b(b){b=a.call(this,b)||this;b.codedValues=null;b.type="coded-value";return b}
r.__extends(b,a);e=b;b.prototype.getName=function(a){var b=null;if(this.codedValues){var c=String(a);this.codedValues.some(function(a){String(a.code)===c&&(b=a.name);return!!b})}return b};b.prototype.clone=function(){return new e({codedValues:q.clone(this.codedValues),name:this.name})};var e;r.__decorate([k.property({type:[c.default],json:{write:!0}})],b.prototype,"codedValues",void 0);r.__decorate([k.enumeration({codedValue:"coded-value"})],b.prototype,"type",void 0);return b=e=r.__decorate([k.subclass("esri.layers.support.CodedValueDomain")],
b)}(e)})},"esri/layers/support/CodedValue":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(z,a,r,q,k){Object.defineProperty(a,"__esModule",{value:!0});a.CodedValue=void 0;z=function(a){function c(b){b=a.call(this,b)||this;b.name=null;b.code=null;return b}r.__extends(c,a);b=c;c.prototype.clone=function(){return new b({name:this.name,code:this.code})};var b;r.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,
"name",void 0);r.__decorate([k.property({type:[String,Number],json:{write:!0}})],c.prototype,"code",void 0);return c=b=r.__decorate([k.subclass("esri.layers.support.CodedValue")],c)}(q.JSONSupport);a.CodedValue=z;a.default=z})},"esri/layers/support/Domain":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(z,a,r,q,k,c){var e=new q.default({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(a){function b(b){b=
a.call(this,b)||this;b.name=null;b.type=null;return b}r.__extends(b,a);r.__decorate([c.property({type:String,json:{write:!0}})],b.prototype,"name",void 0);r.__decorate([c.enumeration(e)],b.prototype,"type",void 0);return b=r.__decorate([c.subclass("esri.layers.support.Domain")],b)}(k.JSONSupport)})},"esri/layers/support/InheritedDomain":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Domain"],function(z,a,r,q,k){return function(a){function c(b){b=a.call(this,
b)||this;b.type="inherited";return b}r.__extends(c,a);b=c;c.prototype.clone=function(){return new b};var b;r.__decorate([q.enumeration({inherited:"inherited"})],c.prototype,"type",void 0);return c=b=r.__decorate([q.subclass("esri.layers.support.InheritedDomain")],c)}(k)})},"esri/layers/support/RangeDomain":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Domain"],function(z,a,r,q,k){return function(a){function c(b){b=a.call(this,b)||this;b.maxValue=null;b.minValue=
null;b.type="range";return b}r.__extends(c,a);b=c;c.prototype.clone=function(){return new b({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};var b;r.__decorate([q.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(a,b){return b.range&&b.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(a,b,c){b[c]=[this.minValue||0,a]}}}})],c.prototype,"maxValue",void 0);r.__decorate([q.property({type:Number,
json:{type:[Number],read:{source:"range",reader:function(a,b){return b.range&&b.range[0]}},write:{target:"range",writer:function(a,b,c){b[c]=[a,this.maxValue||0]}}}})],c.prototype,"minValue",void 0);r.__decorate([q.enumeration({range:"range"})],c.prototype,"type",void 0);return c=b=r.__decorate([q.subclass("esri.layers.support.RangeDomain")],c)}(k)})},"esri/support/arcadeOnDemand":function(){define("require exports tslib ../geometry ../core/maybe ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),
function(z,a,r,q,k,c){function e(){return r.__awaiter(this,void 0,void 0,function(){var a=this;return r.__generator(this,function(c){b||(b=function(){return r.__awaiter(a,void 0,void 0,function(){var a;return r.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,b){z(["./arcadeUtils"],a,b)})];case 1:return a=b.sent(),[4,a.arcade.load()];case 2:return b.sent(),[2,{arcade:a.arcade,arcadeUtils:a,Dictionary:a.Dictionary,Feature:a.arcadeFeature}]}})})}());return[2,b]})})}
Object.defineProperty(a,"__esModule",{value:!0});a.ArcadeExpression=a.createDictionaryExpression=a.createVVExpression=a.createRendererExpression=a.createLabelExpression=a.loadArcade=void 0;var b;a.loadArcade=e;a.createLabelExpression=function(a,b,c){return p.create(a,b,c,null,["$feature"])};a.createRendererExpression=function(a,b,c){return p.create(a,b,c,null,["$feature","$view"])};a.createVVExpression=a.createRendererExpression;a.createDictionaryExpression=function(a,b,c,e){return p.create(a,b,c,
e,["$feature","$view"])};var p=function(){function a(a,b,c,e,k,p,q,r){this.script=a;this.evaluate=k;this.fields=q;this._syntaxTree=e;this._arcade=b;this._arcadeDictionary=c;this._arcadeFeature=p;this._spatialReference=r;this._referencesGeometry=b.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}a.create=function(b,d,p,u,n,z){return r.__awaiter(this,void 0,void 0,function(){var v,x,g,t,l,y,O,D,G,N,J,I,w,m,E;return r.__generator(this,
function(H){switch(H.label){case 0:return[4,e()];case 1:return v=H.sent(),x=v.arcade,g=v.Feature,t=v.Dictionary,l=q.SpatialReference.fromJSON(d),y=x.parseScript(b,z),O=n.reduce(function(a,b){var c;return r.__assign(r.__assign({},a),(c={},c[b]=null,c))},{}),D=null,k.isSome(u)&&(D=new t(u),D.immutable=!0,O.$config=null),G=x.scriptUsesGeometryEngine(y)&&x.enableGeometrySupport(),N=x.scriptUsesFeatureSet(y)&&x.enableFeatureSetSupport(),J=x.scriptIsAsync(y)&&x.enableAsyncSupport(),I={vars:O,spatialReference:l,
useAsync:!!J},w=new t,w.immutable=!1,w.setField("scale",0),m=x.compileScript(y,I),E=function(a){"$view"in a&&a.$view&&(w.setField("scale",a.$view.scale),a.$view=w);D&&(a.$config=D);return m({vars:a,spatialReference:l})},[4,c.all([G,N,J])];case 2:return H.sent(),[2,new a(b,x,t,y,E,new g,p,l)]}})})};a.prototype.repurposeFeature=function(a){a.geometry&&!a.geometry.spatialReference&&(a.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(a.geometry,a.attributes,
{fields:this.fields});return this._arcadeFeature};a.prototype.repurposeAdapter=function(a){this._arcadeFeature.repurposeFromAdapter(a,{fields:this.fields});return this._arcadeFeature};a.prototype.createDictionary=function(){return new this._arcadeDictionary};a.prototype.referencesMember=function(a){return this._arcade.referencesMember(this._syntaxTree,a)};a.prototype.referencesFunction=function(a){return this._arcade.referencesFunction(this._syntaxTree,a)};a.prototype.referencesGeometry=function(){return this._referencesGeometry};
a.prototype.referencesScale=function(){return this._referencesScale};a.prototype.extractFieldLiterals=function(a){return this._arcade.extractFieldLiterals(this._syntaxTree,a)};return a}();a.ArcadeExpression=p;a.default=p})},"esri/layers/support/fieldType":function(){define(["require","exports","../../core/jsonMap"],function(z,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.kebabDict=void 0;a.kebabDict=new r.default({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",
esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})})},"*noref":1}});
define("require exports tslib ../../../../request ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../support/sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(z,a,r,q,k,c,e,b,p,u,x,d,y,v,n,G,F,C){Object.defineProperty(a,
"__esModule",{value:!0});var g={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,
supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};z=function(){function a(){this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a){return r.__awaiter(this,void 0,void 0,function(){var c,e,l,n,t,z,I,w,m,E,ca,va,na,oa,L,sa,pa,U,P,R,ja,X,Q,Z,T,ea,ha;return r.__generator(this,
function(D){switch(D.label){case 0:return c=[],[4,this._checkProjection(a.spatialReference)];case 1:return D.sent(),e=null,a.url?[4,q(a.url,{responseType:"json"})]:[3,4];case 2:return l=D.sent(),e=l.data,[4,y.validateGeoJSON(e)];case 3:D.sent(),D.label=4;case 4:n=y.inferLayerProperties(e,{geometryType:a.geometryType});t=a.fields||n.fields||[];z=null!=a.hasZ?a.hasZ:n.hasZ;I=n.geometryType;w=a.objectIdField||("number"===n.objectIdFieldType?n.objectIdFieldName:"OBJECTID")||"OBJECTID";m=a.spatialReference||
b.WGS84;E=a.timeInfo;if(!I)throw new k("geojson-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");"string"===n.objectIdFieldType&&c.push({name:"geojson-layer:unsupported-id-type",message:"Feature ids are of type string and can't be honored."});t===n.fields&&0<n.unknownFields.length&&c.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:n.unknownFields}});
w&&(ca=null,(va=t.some(function(a){return a.name===w?(ca=a,!0):!1}))?(ca.type="esriFieldTypeOID",ca.editable=!1,ca.nullable=!1):t.unshift({alias:w,name:w,type:"esriFieldTypeOID",editable:!1,nullable:!1}));na=0;for(oa=t;na<oa.length;na++){L=oa[na];null==L.name&&(L.name=L.alias);null==L.alias&&(L.alias=L.name);if(!L.name)throw new k("geojson-layer:invalid-field-name","field name is missing",{field:L});L.name===w&&(L.type="esriFieldTypeOID");if(-1===F.kebabDict.jsonValues.indexOf(L.type))throw new k("geojson-layer:invalid-field-type",
'invalid type for field "'+L.name+'"',{field:L});}sa={};this._requiredFields=[];pa=0;for(U=t;pa<U.length;pa++)L=U[pa],"esriFieldTypeOID"!==L.type&&"esriFieldTypeGlobalID"!==L.type&&(L.editable=null==L.editable?!0:!!L.editable,L.nullable=null==L.nullable?!0:!!L.nullable,P=C.getFieldDefaultValue(L),L.nullable||void 0!==P?sa[L.name]=P:this._requiredFields.push(L));this._fieldsIndex=new G(t);E&&(E.startTimeField&&((R=this._fieldsIndex.get(E.startTimeField))?(E.startTimeField=R.name,R.type="esriFieldTypeDate"):
E.startTimeField=null),E.endTimeField&&((ja=this._fieldsIndex.get(E.endTimeField))?(E.endTimeField=ja.name,ja.type="esriFieldTypeDate"):E.endTimeField=null),E.trackIdField&&((X=this._fieldsIndex.get(E.trackIdField))?E.trackIdField=X.name:(E.trackIdField=null,c.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:E}}))),E.startTimeField||E.endTimeField||(c.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",
details:{timeInfo:E}}),E=null));Q={warnings:c,featureErrors:[],layerDefinition:r.__assign(r.__assign({},g),{drawingInfo:v.createDrawingInfo(I),templates:v.createDefaultTemplate(sa),extent:null,geometryType:I,objectIdField:w,fields:t,hasZ:!!z,timeInfo:E})};this._queryEngine=new d.default({fields:t,geometryType:I,hasM:!1,hasZ:z,objectIdField:w,spatialReference:m,timeInfo:E,featureStore:new u.default({geometryType:I,hasM:!1,hasZ:z})});this._createDefaultAttributes=v.createDefaultAttributesFunction(sa,
w);this._nextObjectId=n.maxObjectId+1;Z=y.createOptimizedFeatures(e,{geometryType:I,hasZ:z,objectIdFieldName:"number"===n.objectIdFieldType?w:null});if(!b.equals(m,b.WGS84))for(T=0,ea=Z;T<ea.length;T++)ha=ea[T],ha.geometry&&(ha.geometry=p.convertFromGeometry(x.project(p.convertToGeometry(ha.geometry,I,z,!1),b.WGS84,m)));this._loadInitialFeatures(Q,Z);return[2,Q]}})})};a.prototype.applyEdits=function(a){return r.__awaiter(this,void 0,void 0,function(){var b,d,e;return r.__generator(this,function(g){switch(g.label){case 0:return b=
this._queryEngine,d=b.spatialReference,e=b.geometryType,[4,c.all([n.loadGeometryEngineForSimplify(d,e),x.checkProjectionSupport(a.adds,d),x.checkProjectionSupport(a.updates,d)])];case 1:return g.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQuery(a,b.signal)]})})};a.prototype.queryFeatureCount=function(a,b){void 0===
a&&(a={});void 0===b&&(b={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};a.prototype.queryObjectIds=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};a.prototype.queryExtent=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return r.__awaiter(this,
void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine,d=c.featureStore,c=c.objectIdField,e=[],g=0;g<b.length;g++){var k=b[g],l=this._createDefaultAttributes(),p=n.mixAttributes(this._fieldsIndex,this._requiredFields,l,k.attributes,!0,a.warnings);p?a.featureErrors.push(p):(this._assignObjectId(l,k.attributes,!0),k.attributes=l,k.objectId=l[c],e.push(k))}d.addMany(e);
a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(d,b);c&&c.length&&this._applyUpdateEdits(d,c);if(a&&a.length){for(b=0;b<a.length;b++)d.deleteResults.push(n.createFeatureEditSuccessResult(a[b]));
this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:d}};a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,d=this._queryEngine,g=d.geometryType,k=d.hasM,l=d.hasZ,q=d.objectIdField,r=d.spatialReference,d=d.featureStore,m=[],u=0;u<b.length;u++){var t=b[u];if(t.geometry&&g!==e.getJsonType(t.geometry))c.push(n.createFeatureEditErrorResult("Incorrect geometry type."));else{var v=this._createDefaultAttributes(),
y=n.mixAttributes(this._fieldsIndex,this._requiredFields,v,t.attributes);y?c.push(y):(this._assignObjectId(v,t.attributes),t.attributes=v,null!=t.uid&&(a.uidToObjectId[t.uid]=t.attributes[q]),t.geometry&&(t.geometry=x.project(n.simplify(t.geometry,r),t.geometry.spatialReference,r)),m.push(t),c.push(n.createFeatureEditSuccessResult(t.attributes[q])))}}d.addMany(p.convertFromFeatures([],m,g,l,k,q))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,d=c.geometryType,
g=c.hasM,k=c.hasZ,l=c.objectIdField,q=c.spatialReference,c=c.featureStore,r=0;r<b.length;r++){var m=b[r],t=m.attributes,u=m.geometry,m=t&&t[l];if(null==m)a.push(n.createFeatureEditErrorResult("Identifier field "+l+" missing"));else if(c.has(m)){var v=p.convertToFeature(c.getFeature(m),d,k,g);if(u){if(d!==e.getJsonType(u)){a.push(n.createFeatureEditErrorResult("Incorrect geometry type."));continue}v.geometry=x.project(n.simplify(u,q),u.spatialReference,q)}if(t&&(t=n.mixAttributes(this._fieldsIndex,
this._requiredFields,v.attributes,t))){a.push(t);continue}c.add(p.convertFromFeature(v,d,k,g,l));a.push(n.createFeatureEditSuccessResult(m))}else a.push(n.createFeatureEditErrorResult("Feature with object id "+m+" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var d=this._queryEngine.objectIdField;c?isFinite(b[d])?a[d]=b[d]:a[d]=this._nextObjectId++:a[d]=this._nextObjectId++};a.prototype._checkProjection=function(a){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,
function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,x.checkProjectionSupport(b.WGS84,a)];case 1:return c.sent(),[3,3];case 2:throw c.sent(),new k("geojson-layer","Projection not supported");case 3:return[2]}})})};return a}();a.default=z});