// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../config ../geometry ../request ../core/Error ../core/Evented ../core/Identifiable ../core/Loadable ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators @dojo/framework/shim/Promise".split(" "),function(k,w,b,m,e,n,p,q,r,t,h,u,d){var v=0,l=h.getLogger("esri.layers.Layer");return function(g){function c(){var a=null!==g&&g.apply(this,arguments)||this;a.attributionDataUrl=null;a.fullExtent=new e.Extent(-180,-90,180,90,e.SpatialReference.WGS84);a.id=Date.now().toString(16)+
"-layer-"+v++;a.legendEnabled=!0;a.listMode="show";a.opacity=1;a.parent=null;a.popupEnabled=!0;a.attributionVisible=!0;a.spatialReference=e.SpatialReference.WGS84;a.title=null;a.type=null;a.url=null;a.visible=!0;return a}b.__extends(c,g);c.fromArcGISServerUrl=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,d,f;return b.__generator(this,function(b){switch(b.label){case 0:return c="string"===typeof a?{url:a}:a,[4,new Promise(function(a,b){k(["./support/arcgisLayers"],a,b)})];case 1:d=
b.sent(),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,d.fromUrl(c)];case 3:return[2,b.sent()];case 4:throw f=b.sent(),l.error("#fromArcGISServerUrl({ url: '"+c.url+"'})","Failed to create layer from arcgis server url",f),f;case 5:return[2]}})})};c.fromPortalItem=function(a){return b.__awaiter(this,void 0,void 0,function(){var c,d,f,e,g,h;return b.__generator(this,function(b){switch(b.label){case 0:return c="portalItem"in a?a:{portalItem:a},[4,new Promise(function(a,b){k(["../portal/support/portalLayers"],
a,b)})];case 1:d=b.sent(),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,d.fromItem(c)];case 3:return[2,b.sent()];case 4:throw f=b.sent(),g=(e=c&&c.portalItem)&&e.id||"unset",h=e&&e.portal&&e.portal.url||m.portalUrl,l.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+h+"', id: '"+g+"')",f),f;case 5:return[2]}})})};c.prototype.initialize=function(){var a=this;this.when().catch(function(b){var c,d;h.getLogger(a.declaredClass).error("#load()","Failed to load layer (title: '"+
(null!==(c=a.title)&&void 0!==c?c:"no title")+"', id: '"+(null!==(d=a.id)&&void 0!==d?d:"no id")+"')",{error:b})})};c.prototype.destroy=function(){if(this.parent){var a=this.parent;"layers"in a&&a.layers.includes(this)?a.layers.remove(this):"tables"in a&&a.tables.includes(this)?a.tables.remove(this):"baseLayers"in a&&a.baseLayers.includes(this)?a.baseLayers.remove(this):"baseLayers"in a&&a.referenceLayers.includes(this)&&a.referenceLayers.remove(this)}};Object.defineProperty(c.prototype,"hasAttributionData",
{get:function(){return null!=this.attributionDataUrl},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"parsedUrl",{get:function(){var a=this._get("url");return a?u.urlToObject(a):null},enumerable:!1,configurable:!0});c.prototype.fetchAttributionData=function(){return b.__awaiter(this,void 0,void 0,function(){var a,c;return b.__generator(this,function(b){switch(b.label){case 0:return a=this.attributionDataUrl,this.hasAttributionData&&a?[4,n(a,{query:{f:"json"},responseType:"json"})]:
[3,2];case 1:return c=b.sent(),[2,c.data];case 2:throw new p("layer:no-attribution-data","Layer does not have attribution data");}})})};b.__decorate([d.property({type:String})],c.prototype,"attributionDataUrl",void 0);b.__decorate([d.property({type:e.Extent})],c.prototype,"fullExtent",void 0);b.__decorate([d.property({readOnly:!0,dependsOn:["attributionDataUrl"]})],c.prototype,"hasAttributionData",null);b.__decorate([d.property({type:String})],c.prototype,"id",void 0);b.__decorate([d.property({type:Boolean,
nonNullable:!0})],c.prototype,"legendEnabled",void 0);b.__decorate([d.property({type:["show","hide","hide-children"]})],c.prototype,"listMode",void 0);b.__decorate([d.property({type:Number,range:{min:0,max:1},nonNullable:!0})],c.prototype,"opacity",void 0);b.__decorate([d.property()],c.prototype,"parent",void 0);b.__decorate([d.property({readOnly:!0,dependsOn:["url"]})],c.prototype,"parsedUrl",null);b.__decorate([d.property({type:Boolean})],c.prototype,"popupEnabled",void 0);b.__decorate([d.property({type:Boolean})],
c.prototype,"attributionVisible",void 0);b.__decorate([d.property({type:e.SpatialReference})],c.prototype,"spatialReference",void 0);b.__decorate([d.property({type:String})],c.prototype,"title",void 0);b.__decorate([d.property({type:String,readOnly:!0,json:{read:!1}})],c.prototype,"type",void 0);b.__decorate([d.property()],c.prototype,"url",void 0);b.__decorate([d.property({type:Boolean,nonNullable:!0})],c.prototype,"visible",void 0);return c=b.__decorate([d.subclass("esri.layers.Layer")],c)}(q.EventedMixin(r.IdentifiableMixin(t)))});