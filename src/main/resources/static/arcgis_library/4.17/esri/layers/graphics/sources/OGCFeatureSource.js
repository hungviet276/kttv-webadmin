// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../../geometry ../../../core/Error ../../../core/Loadable ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../../ogc/ogcFeatureUtils".split(" "),function(g,e,c,k,p,l,q,r,f,h){Object.defineProperty(e,"__esModule",{value:!0});e.OGCFeatureSource=void 0;g=function(e){function a(){var b=null!==e&&e.apply(this,arguments)||this;b.collection=null;b.conformance=null;b.landingPage=null;b.layerDefinition=null;b.type="ogc-feature";return b}
c.__extends(a,e);a.prototype.load=function(b){var t=this;b=q.isSome(b)?b.signal:null;var d=this.layer,a=d.collectionId,c=d.fields,e=d.geometryType,f=d.hasZ,g=d.mediaType,l=d.objectIdField,m=d.spatialReference,n=d.timeInfo,d=d.url,c={fields:null===c||void 0===c?void 0:c.map(function(b){return b.toJSON()}),geometryType:k.typeKebabDictionary.toJSON(e),hasZ:f,objectIdField:l,spatialReference:null===m||void 0===m?void 0:m.toJSON(),timeInfo:null===n||void 0===n?void 0:n.toJSON()};this.addResolvingPromise(r.all([h.getServerLandingPage(d,
g,b),h.getServerConformance(d,g,b),h.getServerCollection(d,a,g,b),h.getCollectionDefinition(d,a,c,b)]).then(function(b){var a=b[1];t.set({landingPage:b[0],conformance:a,collection:b[2],layerDefinition:b[3]});if(-1===(null===a||void 0===a?void 0:a.conformsTo.indexOf("http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson"))&&-1===(null===a||void 0===a?void 0:a.conformsTo.indexOf("https://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson")))throw new p("ogc-feature-layer:no-geojson-support",
"Server does not support geojson");}));return this.when()};Object.defineProperty(a.prototype,"fullExtent",{get:function(){var b,a,d=null===(a=null===(b=this.collection)||void 0===b?void 0:b.extent)||void 0===a?void 0:a.spatial;if(!d)return null;b=d.bbox[0];a=4===b.length;return new k.Extent({xmin:b[0],ymin:b[1],xmax:a?b[2]:b[3],ymax:a?b[3]:b[4],zmin:a?void 0:b[2],zmax:a?void 0:b[5],spatialReference:k.SpatialReference.WGS84})},enumerable:!1,configurable:!0});a.prototype.queryExtent=function(b,a){void 0===
a&&(a={});return null};a.prototype.queryFeatureCount=function(b,a){void 0===a&&(a={});return null};a.prototype.queryFeatures=function(b,a){void 0===a&&(a={});var d=this._getFeatureDefinition();return this.load(a).then(function(){return h.queryFeatureSet(d,b,a)})};a.prototype.queryFeaturesJSON=function(a,c){void 0===c&&(c={});var b=this._getFeatureDefinition();return this.load(c).then(function(){return h.queryFeatureSetJSON(b,a,c)})};a.prototype.queryObjectIds=function(a,c){void 0===c&&(c={});return null};
a.prototype._getFeatureDefinition=function(){var a=this.layer;return{capabilities:a.capabilities,collectionId:a.collectionId,layerDefinition:this.layerDefinition,url:a.url}};c.__decorate([f.property()],a.prototype,"collection",void 0);c.__decorate([f.property()],a.prototype,"conformance",void 0);c.__decorate([f.property({dependsOn:["collection"],readOnly:!0,type:k.Extent})],a.prototype,"fullExtent",null);c.__decorate([f.property()],a.prototype,"landingPage",void 0);c.__decorate([f.property({constructOnly:!0})],
a.prototype,"layer",void 0);c.__decorate([f.property()],a.prototype,"layerDefinition",void 0);c.__decorate([f.property()],a.prototype,"type",void 0);return a=c.__decorate([f.subclass("esri.layers.graphics.sources.OGCFeatureSource")],a)}(l);e.OGCFeatureSource=g;e.default=g});