// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(x,a,r,q,g,c,d,b){function n(a,l){return a?l?4:3:l?3:2}function m(a,l,p,e){if(a){if(p)return l&&e?ma:S;if(l&&e)return ba}else if(l&&e)return S;return Y}function w(a,l){return Math.round((l-a.translate[0])/a.scale[0])}function e(a,l){return Math.round((a.translate[1]-
l)/a.scale[1])}function u(a,l){return l*a.scale[0]+a.translate[0]}function t(a,l){return a.translate[1]-l*a.scale[1]}function p(a){a=a.coords;return{x:a[0],y:a[1]}}function D(a,l){a.coords[0]=l.x;a.coords[1]=l.y;return a}function E(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function A(a,l){a.coords[0]=l.x;a.coords[1]=l.y;a.coords[2]=l.z;return a}function k(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function J(a,l){a.coords[0]=l.x;a.coords[1]=l.y;a.coords[2]=l.m;return a}function O(a){a=a.coords;return{x:a[0],
y:a[1],z:a[2],m:a[3]}}function H(a,l){a.coords[0]=l.x;a.coords[1]=l.y;a.coords[2]=l.z;a.coords[3]=l.m;return a}function L(a,l){return a&&l?H:a?A:l?J:D}function B(a,l,p,e,k){p=L(p,e);for(e=0;e<l.length;e++){var t=l[e],d=t.geometry,t=t.attributes,v=void 0;d&&(v=p(new b.default,d));a.push(new c.default(v,t,null,t[k]))}return a}function K(a,l,p,e){for(var c=0;c<l.length;c++){var b=l[c],k=b.geometry,b=b.attributes,t=void 0;k&&(t=P(k,p,e));a.push({attributes:b,geometry:t})}return a}function P(a,l,p){if(!a)return null;
for(var e=n(l,p),c=[],b=0;b<a.coords.length;b+=e){for(var k=[],t=0;t<e;t++)k.push(a.coords[b+t]);c.push(k)}return l?p?{points:c,hasZ:l,hasM:p}:{points:c,hasZ:l}:p?{points:c,hasM:p}:{points:c}}function C(a,l,p,e,k){p=n(p,e);for(e=0;e<l.length;e++){var t=l[e],d=t.geometry,t=t.attributes,v=void 0;d&&(v=F(new b.default,d,p));a.push(new c.default(v,t,null,t[k]))}return a}function F(a,l,p){void 0===p&&(p=n(l.hasZ,l.hasM));a.lengths[0]=l.points.length;var e=a.coords,c=0,b=0;for(l=l.points;b<l.length;b++)for(var t=
l[b],k=0;k<p;k++)e[c++]=t[k];return a}function v(a,l,p){if(!a)return null;var e=n(l,p),c=a.coords,b=[],k=0,t=0;for(a=a.lengths;t<a.length;t++){for(var d=a[t],v=[],g=0;g<d;g++){for(var u=[],m=0;m<e;m++)u.push(c[k++]);v.push(u)}b.push(v)}return l?p?{paths:b,hasZ:l,hasM:p}:{paths:b,hasZ:l}:p?{paths:b,hasM:p}:{paths:b}}function l(a,l,p,e,t){p=n(p,e);for(e=0;e<l.length;e++){var k=l[e],d=k.geometry,k=k.attributes,v=void 0;d&&(v=G(new b.default,d,p));a.push(new c.default(v,k,null,k[t]))}return a}function G(a,
l,p){void 0===p&&(p=n(l.hasZ,l.hasM));var e=a.lengths,b=a.coords,c=0,k=0;for(l=l.paths;k<l.length;k++){for(var t=l[k],d=0,v=t;d<v.length;d++)for(var g=v[d],u=0;u<p;u++)b[c++]=g[u];e.push(t.length)}return a}function da(a,l,p){if(!a)return null;var e=n(l,p),b=a.coords,c=[],k=0,t=0;for(a=a.lengths;t<a.length;t++){for(var d=a[t],v=[],g=0;g<d;g++){for(var u=[],m=0;m<e;m++)u.push(b[k++]);v.push(u)}c.push(v)}return l?p?{rings:c,hasZ:l,hasM:p}:{rings:c,hasZ:l}:p?{rings:c,hasM:p}:{rings:c}}function pa(a,l,
p,e,k){for(var t=0;t<l.length;t++){var d=l[t],v=d.geometry,g=d.centroid,d=d.attributes,u=void 0;v&&(u=za(new b.default,v,p,e));g?a.push(new c.default(u,d,D(new b.default,g),d[k])):a.push(new c.default(u,d,null,d[k]))}return a}function za(a,l,p,e){void 0===p&&(p=l.hasZ);void 0===e&&(e=l.hasM);Aa(a,l.rings,p,e);return a}function Aa(a,l,p,e){p=n(p,e);e=a.lengths;for(var c=a.coords,b=0,k=e.length=c.length=0;k<l.length;k++){for(var t=l[k],d=0,v=t;d<v.length;d++)for(var g=v[d],u=0;u<p;u++)c[b++]=g[u];e.push(t.length)}return a}
function T(a,p,e,b,k,t){a.length=0;if(!e){for(e=0;e<p.length;e++)b=p[e],a.push(new c.default(null,b.attributes,null,b.attributes[t]));return a}switch(e){case "esriGeometryPoint":return B(a,p,b,k,t);case "esriGeometryMultipoint":return C(a,p,b,k,t);case "esriGeometryPolyline":return l(a,p,b,k,t);case "esriGeometryPolygon":return pa(a,p,b,k,t);default:W.error("convertToFeatureSet:unknown-geometry",new r("Unable to parse unknown geometry type '"+e+"'")),a.length=0}return a}function qa(a,l,e,b){a=a&&
("coords"in a?a:a.geometry);if(!a)return null;switch(l){case "esriGeometryPoint":return l=p,e&&b?l=O:e?l=E:b&&(l=k),l(a);case "esriGeometryMultipoint":return P(a,e,b);case "esriGeometryPolyline":return v(a,e,b);case "esriGeometryPolygon":return da(a,e,b);default:W.error("convertToGeometry:unknown-geometry",new r("Unable to parse unknown geometry type '"+l+"'"))}}function ha(a,l,e,b,c){a.length=0;switch(e){case "esriGeometryPoint":e=p;b&&c?e=O:b?e=E:c&&(e=k);for(b=0;b<l.length;b++){var t=l[b];c=t.geometry;
t=t.attributes;c=c?e(c):null;a.push({attributes:t,geometry:c})}break;case "esriGeometryMultipoint":return K(a,l,b,c);case "esriGeometryPolyline":for(e=0;e<l.length;e++){var d=l[e],t=d.geometry,d=d.attributes,g=void 0;t&&(g=v(t,b,c));a.push({attributes:d,geometry:g})}break;case "esriGeometryPolygon":for(e=0;e<l.length;e++){var g=l[e],d=g.geometry,t=g.attributes,u=g.centroid,g=void 0;d&&(g=da(d,b,c));u?(d=p(u),a.push({attributes:t,centroid:d,geometry:g})):a.push({attributes:t,geometry:g})}break;default:W.error("convertToFeatureSet:unknown-geometry",
new r("Unable to parse unknown geometry type '"+e+"'"))}return a}function ga(a,l,p,b,c,t,k,d){void 0===k&&(k=p);void 0===d&&(d=b);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!l||!l.coords.length)return null;c=Q[c];var v=l.coords;l=l.lengths;var g=n(p,b),u=n(p&&k,b&&d);p=m(p,b,k,d);if(!l.length)return p(a.coords,v,0,0,w(t,v[0]),e(t,v[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=g,a;for(var G,A=0,F,D=0,C=0;C<l.length;C++){var da=l[C];if(!(da<c)){var J=
0;F=D;d=b=w(t,v[A]);G=k=e(t,v[A+1]);p(a.coords,v,F,A,d,G);J++;A+=g;F+=u;for(var f=1;f<da;f++,A+=g)if(d=w(t,v[A]),G=e(t,v[A+1]),d!==b||G!==k)p(a.coords,v,F,A,d-b,G-k),F+=u,J++,b=d,k=G;J>=c&&(a.lengths.push(J),D=F)}}a.coords.length=D;return a.coords.length?a:null}function M(a,l,p,e,b,c,t){for(var k=e,d=0,v,g=c+p;g<t;g+=p){v=l[g];var u=l[g+1],n=l[t],m=l[t+1],G=l[c],A=l[c+1],F=n-G,D=m-A;if(0!==F||0!==D){var f=((v-G)*F+(u-A)*D)/(F*F+D*D);1<f?(G=n,A=m):0<f&&(G+=F*f,A+=D*f)}F=v-G;D=u-A;v=F*F+D*D;v>k&&(d=
g,k=v)}k>e&&(d-c>p&&M(a,l,p,e,b,c,d),b(a,l,a.length,d,l[d],l[d+1]),t-d>p&&M(a,l,p,e,b,d,t))}function I(a,l,p,e,b){var c=l.coords,k=l.lengths,d=p?e?ma:S:e?S:Y;p=n(p,e);if(!c.length)return a!==l&&(a.lengths.length=0,a.coords.length=0),a;if(!k.length)return d(a.coords,c,0,0,u(b,c[0]),t(b,c[1])),a!==l&&(a.lengths.length=0,a.coords.length=p),a;var v=b.scale;e=v[0];for(var v=v[1],g=0,m=0;m<k.length;m++){var G=k[m];a.lengths[m]=G;var A=u(b,c[g]),F=t(b,c[g+1]);d(a.coords,c,g,g,A,F);for(var g=g+p,D=1;D<G;D++,
g+=p)A+=c[g]*e,F-=c[g+1]*v,d(a.coords,c,g,g,A,F)}a!==l&&(a.lengths.length=k.length,a.coords.length=c.length);return a}function la(a,l,p,e){for(var b=0,c=a[e*l],t=a[e*(l+1)],k=1;k<p;k++)var d=c+a[e*(l+k)],v=t+a[e*(l+k)+1],g=(d-c)*(v+t),c=d,t=v,b=b+g;return.5*b}Object.defineProperty(a,"__esModule",{value:!0});a.deltaDecodeGeometry=a.deltaEncodeGeometry=a.getQuantizedArea=a.getSignedQuantizedRingArea=a.removeCollinearVectices=a.removeZMValues=a.unquantizeOptimizedGeometry=a.getQuantizedBoundsOptimizedGeometry=
a.getBoundsOptimizedGeometry=a.generalizeOptimizedGeometry=a.quantizeOptimizedGeometry=a.quantizeOptimizedFeatureSet=a.unquantizeOptimizedFeatureSet=a.convertFromFeatureSet=a.convertToFeatureSet=a.convertToFeatures=a.convertToGeometry=a.convertFromGeometry=a.convertToFeature=a.convertFromGraphics=a.convertFromFeatures=a.convertFromFeature=a.convertFromNestedArray=a.convertFromPolygon=a.convertToPolygon=a.convertFromPolyline=a.convertFromPolylineFeatures=a.convertToPolyline=a.convertFromMultipoint=
a.convertFromMultipointFeatures=a.convertToMultipoint=a.convertToMultipointFeatures=a.convertFromPoint=a.convertFromPointFeatures=a.convertToPoint=a.unquantizeY=a.unquantizeX=a.quantizeY=a.quantizeX=void 0;var W=q.getLogger("esri.tasks.support.optimizedFeatureSet"),Q={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},Y=function(a,l,p,e,b,c){a[p]=b;a[p+1]=c},S=function(a,l,p,e,b,c){a[p]=b;a[p+1]=c;a[p+2]=l[e+2]},ba=function(a,l,p,e,b,c){a[p]=b;a[p+1]=c;a[p+
2]=l[e+3]},ma=function(a,l,p,e,b,c){a[p]=b;a[p+1]=c;a[p+2]=l[e+2];a[p+3]=l[e+3]};a.quantizeX=w;a.quantizeY=e;a.unquantizeX=u;a.unquantizeY=t;a.convertToPoint=function(a,l,e){return a?l?e?O(a):E(a):e?k(a):p(a):null};a.convertFromPointFeatures=B;a.convertFromPoint=function(a,l,p){void 0===p&&(p=L(null!=l.z,null!=l.m));return p(a,l)};a.convertToMultipointFeatures=K;a.convertToMultipoint=P;a.convertFromMultipointFeatures=C;a.convertFromMultipoint=F;a.convertToPolyline=v;a.convertFromPolylineFeatures=
l;a.convertFromPolyline=G;a.convertToPolygon=da;a.convertFromPolygon=za;a.convertFromNestedArray=Aa;var ka=[],ia=[];a.convertFromFeature=function(a,l,p,e,b){ka[0]=a;a=T(ia,ka,l,p,e,b)[0];ka.length=ia.length=0;return a};a.convertFromFeatures=T;a.convertFromGraphics=function(a,p,e,b,c,t){var k=a.length;switch(e){case "esriGeometryPoint":B(a,p,b,c,t);break;case "esriGeometryMultipoint":C(a,p,b,c,t);break;case "esriGeometryPolyline":l(a,p,b,c,t);break;case "esriGeometryPolygon":pa(a,p,b,c,t);break;default:W.error("convertToFeatureSet:unknown-geometry",
new r("Unable to parse unknown geometry type '"+e+"'"))}for(b=0;b<p.length;b++)a[b+k].geometryType=e,a[b+k].insertAfter=p[b].insertAfter,a[b+k].groupId=p[b].groupId;return a};a.convertToFeature=function(a,l,p,e){ia[0]=a;ha(ka,ia,l,p,e);a=ka[0];ka.length=ia.length=0;return a};a.convertFromGeometry=function(a,l,p){if(!a)return null;var e=new b.default;"hasZ"in a&&null==l&&(l=a.hasZ);"hasM"in a&&null==p&&(p=a.hasM);if(g.isPoint(a))return L(null!=l?l:null!=a.z,null!=p?p:null!=a.m)(e,a);if(g.isPolygon(a))return za(e,
a,l,p);if(g.isPolyline(a))return G(e,a,n(l,p));if(g.isMultipoint(a))return F(e,a,n(l,p));W.error("convertFromGeometry:unknown-geometry",new r("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=qa;a.convertToFeatures=ha;a.convertToFeatureSet=function(a){var l=a.objectIdFieldName,p=a.spatialReference,e=a.transform,b=a.fields,c=a.hasM,t=a.hasZ,k=a.geometryType,d=a.exceededTransferLimit,v=a.uniqueIdField,g=a.queryGeometry,u=a.queryGeometryType;a=ha([],a.features,k,t,c);g=qa(g,u,!1,
!1);l={features:a,fields:b,geometryType:k,objectIdFieldName:l,spatialReference:p,uniqueIdField:v,queryGeometry:g};e&&(l.transform=e);d&&(l.exceededTransferLimit=d);c&&(l.hasM=c);t&&(l.hasZ=t);return l};a.convertFromFeatureSet=function(a,l){var p=new d.default,e=a.hasM,b=a.hasZ,c=a.features,t=a.objectIdFieldName,k=a.spatialReference,v=a.geometryType,g=a.exceededTransferLimit,u=a.transform;if(a=a.fields)p.fields=a;p.geometryType=v;p.objectIdFieldName=t||l;p.spatialReference=k;if(!p.objectIdFieldName)return W.error(new r("optimized-features:invalid-objectIdFieldName",
"objectIdFieldName is missing")),p;c&&T(p.features,c,v,b,e,p.objectIdFieldName);g&&(p.exceededTransferLimit=g);e&&(p.hasM=e);b&&(p.hasZ=b);u&&(p.transform=u);return p};a.unquantizeOptimizedFeatureSet=function(a){var l=a.transform,p=a.hasM,e=a.hasZ;if(!l)return a;for(var b=0,c=a.features;b<c.length;b++){var t=c[b];t.geometry&&I(t.geometry,t.geometry,p,e,l);t.centroid&&I(t.centroid,t.centroid,p,e,l)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,l){var p=l.geometryType,e=l.features,
c=l.hasM,t=l.hasZ;if(!a)return l;for(var k=0;k<e.length;k++){var d=e[k],v=d.weakClone();v.geometry=new b.default;ga(v.geometry,d.geometry,c,t,p,a);d.centroid&&(v.centroid=new b.default,ga(v.centroid,d.centroid,c,t,"esriGeometryPoint",a));e[k]=v}l.transform=a;return l};a.quantizeOptimizedGeometry=ga;a.generalizeOptimizedGeometry=function(a,l,p,e,b,c,t,k){void 0===t&&(t=p);void 0===k&&(k=e);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!l||!l.coords.length)return null;
b=Q[b];var d=l.coords;l=l.lengths;var v=n(p,e),g=n(p&&t,e&&k);p=m(p,e,t,k);if(!l.length)return p(a.coords,d,0,0,d[0],d[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=v,a;e=0;c*=c;for(t=0;t<l.length;t++){k=l[t];if(!(k<b)){var u=a.coords.length/g,G=e,A=e+(k-1)*v;p(a.coords,d,a.coords.length,G,d[G],d[G+1]);M(a.coords,d,v,c,p,G,A);p(a.coords,d,a.coords.length,A,d[A],d[A+1]);G=a.coords.length/g-u;G>=b?a.lengths.push(G):a.coords.length=u*g}e+=k*v}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=
function(a,l,p,e){if(!l||!l.coords||!l.coords.length)return null;p=n(p,e);var b=e=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,t=Number.NEGATIVE_INFINITY;if(l&&l.coords){l=l.coords;for(var k=0;k<l.length;k+=p){var d=l[k],v=l[k+1];e=Math.min(e,d);c=Math.max(c,d);b=Math.min(b,v);t=Math.max(t,v)}}a[0]=e;a[1]=b;a[2]=c;a[3]=t;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,l,p,e){p=n(p,e);e=l.coords;var b=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY,
k=Number.NEGATIVE_INFINITY,d=0,v=0;for(l=l.lengths;v<l.length;v++)for(var g=l[v],u=e[d],G=e[d+1],b=Math.min(u,b),c=Math.min(G,c),t=Math.max(u,t),k=Math.max(G,k),d=d+p,m=1;m<g;m++,d+=p){var A=e[d],F=e[d+1],u=u+A,G=G+F;0>A&&(b=Math.min(b,u));0<A&&(t=Math.max(t,u));0>F?c=Math.min(c,G):0<F&&(k=Math.max(k,G))}a[0]=b;a[1]=c;a[2]=t;a[3]=k;return a};a.unquantizeOptimizedGeometry=I;a.removeZMValues=function(a,l,p,e,b,c){var t,k=n(p,e);p=m(p,e,b,c);e=l.coords;a.coords.length=0;a.lengths.length=0;(t=a.lengths).push.apply(t,
l.lengths);for(l=0;l<e.length;l+=k)p(a.coords,e,a.coords.length,l,e[l],e[l+1]);return a};a.removeCollinearVectices=function(a,l,p,e,b){if(!l||!l.coords||!l.coords.length)return null;p=Q[p];var c=l.coords;l=l.lengths;var t=m(e,b,e,b);e=n(e,b);for(var k=b=0,d=0,v=0,g=0;g<l.length;g++){var u=l[g],k=v;t(a.coords,c,k,b,c[b],c[b+1]);b+=e;var G=c[b],A=c[b+1],F=G,D=A,C=A/G,k=k+e;t(a.coords,c,k,b,F,D);b+=e;for(var da=2;da<u;da++){var G=c[b],A=c[b+1],f=A/G,J=C===f||!isFinite(C)&&!isFinite(f),C=J&&isFinite(f)?
0<=C&&0<=f||0>=C&&0>=f:0<=D&&0<=A||0>=D&&0>=A;J&&C?(F+=G,D+=A):(F=G,D=A,k+=e);t(a.coords,c,k,b,F,D);b+=e;C=f}k+=e;u=(k-v)/e;u>=p&&(a.lengths[d]=u,v=k,d++)}a.coords.length>v&&(a.coords.length=v);a.lengths.length>d&&(a.lengths.length=d);return a.coords.length&&a.lengths.length?a:null};a.getSignedQuantizedRingArea=la;a.getQuantizedArea=function(a,l){var p=a.coords;a=a.lengths;for(var e=0,b=0,c=0;c<a.length;c++)b+=la(p,e,a[c],l),e+=c;return Math.abs(b)};a.deltaEncodeGeometry=function(a,l){var p=a.clone(),
e=a.coords;a=a.lengths;for(var b=0,c=0;c<a.length;c++){for(var t=a[c],k=e[l*b],d=e[l*b+1],v=1;v<t;v++){var g=e[l*(b+v)],u=e[l*(b+v)+1],d=u-d;p.coords[l*(b+v)]=g-k;p.coords[l*(b+v)+1]=d;k=g;d=u}b+=t}return p};a.deltaDecodeGeometry=function(a,l){var p=a.clone(),e=a.coords;a=a.lengths;for(var b=0,c=0;c<a.length;c++){for(var t=a[c],k=e[l*b],d=e[l*b+1],v=1;v<t;v++)k+=e[l*(b+v)],d+=e[l*(b+v)+1],p.coords[l*(b+v)]=k,p.coords[l*(b+v)+1]=d;b+=t}return p}})},"esri/layers/graphics/OptimizedFeature":function(){define(["require",
"exports"],function(x,a){Object.defineProperty(a,"__esModule",{value:!0});x=function(){function a(a,g,c,d){void 0===a&&(a=null);void 0===g&&(g={});this.displayId=0;this.geohashIndexed=!1;this.geohashY=this.geohashX=0;this.geometry=a;g&&(this.attributes=g);c&&(this.centroid=c);null!=d&&(this.objectId=d)}Object.defineProperty(a.prototype,"hasGeometry",{get:function(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)},enumerable:!1,configurable:!0});a.prototype.weakClone=function(){var q=
new a(this.geometry,this.attributes,this.centroid,this.objectId);q.displayId=this.displayId;q.geohashIndexed=this.geohashIndexed;q.geohashX=this.geohashX;q.geohashY=this.geohashY;return q};return a}();a.default=x})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["require","exports"],function(x,a){Object.defineProperty(a,"__esModule",{value:!0});x=function(){function a(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=
null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}a.prototype.weakClone=function(){var q=new a;q.objectIdFieldName=this.objectIdFieldName;q.globalIdFieldName=this.globalIdFieldName;q.geohashFieldName=this.geohashFieldName;q.geometryProperties=this.geometryProperties;q.geometryType=this.geometryType;q.spatialReference=this.spatialReference;q.hasZ=this.hasZ;q.hasM=this.hasM;
q.features=this.features;q.fields=this.fields;q.transform=this.transform;q.exceededTransferLimit=this.exceededTransferLimit;q.uniqueIdField=this.uniqueIdField;q.queryGeometry=this.queryGeometry;q.queryGeometryType=this.queryGeometryType;return q};return a}();a.default=x})},"esri/layers/graphics/OptimizedGeometry":function(){define(["require","exports"],function(x,a){Object.defineProperty(a,"__esModule",{value:!0});x=function(){function a(a,g,c){void 0===a&&(a=[]);void 0===g&&(g=[]);void 0===c&&(c=
!1);this.lengths=a;this.coords=g;this.hasIndeterminateRingOrder=c}Object.defineProperty(a.prototype,"isPoint",{get:function(){return 0===this.lengths.length},enumerable:!1,configurable:!0});a.prototype.forEachVertex=function(a){var g=0;this.lengths.length||a(this.coords[0],this.coords[1]);for(var c=0;c<this.lengths.length;c++){for(var d=this.lengths[c],b=0;b<d;b++)a(this.coords[2*(b+g)],this.coords[2*(b+g)+1]);g+=d}};a.prototype.clone=function(){return new a(this.lengths.slice(),this.coords.slice(),
this.hasIndeterminateRingOrder)};return a}();a.default=x})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./optimizedFeatureQueryEngineAdapter".split(" "),function(x,a,r,q,g,c,d,b,n,m,w){Object.defineProperty(a,"__esModule",{value:!0});x=function(){function a(a){this.geometryInfo=
a;this._boundsStore=new m.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new q;this.featureAdapter=w.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},
enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var e=b.create(b.NEGATIVE_INFINITY);this._featuresById.forEach(function(p){if(p=a._boundsStore.get(p.objectId))e[0]=Math.min(p[0],e[0]),e[1]=Math.min(p[1],e[1]),e[2]=Math.max(p[2],e[2]),e[3]=Math.max(p[3],e[3])});return e},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(e){e.geometry&&e.geometry.coords&&(a+=e.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!1,configurable:!0});a.prototype.add=function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var e=0;e<a.length;e++)this._add(a[e]);this._emitChanged()};a.prototype.clear=
function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var e=0;e<a.length;e++){var p=this._featuresById.get(a[e]);p&&this._remove(p)}this._emitChanged()};a.prototype.forEachBounds=function(a,e,p){for(var b=0;b<a.length;b++){var c=this._boundsStore.get(a[b].objectId);
c&&e(d.fromRect(p,c))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(e){return a(e)})};a.prototype.forEachInBounds=function(a,e){var p=this;this._boundsStore.forEachInBounds(a,function(a){e(p._featuresById.get(a))})};a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=
this,e=!1;this._featuresById.forEach(function(p,b){a._markedIds.has(b)||(e=!0,a._remove(p))});this._markedIds.clear();e&&this._emitChanged()};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var e=a.objectId;if(null==e)g.getLogger("esri.layers.graphics.data.FeatureStore").error(new r("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var p=this._featuresById.get(e),d;this._markedIds.add(e);if(p)a.displayId=p.displayId,
d=this._boundsStore.get(e),this._boundsStore.delete(e);else if(c.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(d=n.getBoundsOptimizedGeometry(d||b.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(e,d)):this._boundsStore.set(e,null);this._featuresById.set(e,a)}}};a.prototype._remove=function(a){if(c.isSome(this.onFeatureRemove))this.onFeatureRemove(a);this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);
this._featuresById.delete(a.objectId);return a};return a}();a.default=x})},"esri/core/Evented":function(){define("require exports tslib ./Accessor ./handleUtils ./accessorSupport/decorators/subclass".split(" "),function(x,a,r,q,g,c){var d=function(){function a(){this._emitter=new a.EventEmitter(this)}a.prototype.emit=function(a,b){return this._emitter.emit(a,b)};a.prototype.on=function(a,b){return this._emitter.on(a,b)};a.prototype.once=function(a,b){return this._emitter.once(a,b)};a.prototype.hasEventListener=
function(a){return this._emitter.hasEventListener(a)};return a}();(function(a){var b=function(){function a(a){void 0===a&&(a=null);this.target=a;this._listenersMap=null}a.prototype.clear=function(){this._listenersMap&&this._listenersMap.clear()};a.prototype.emit=function(a,b){a=this._listenersMap&&this._listenersMap.get(a);if(!a)return!1;var e=this.target||this;r.__spreadArrays(a).forEach(function(a){a.call(e,b)});return 0<a.length};a.prototype.on=function(a,b){var e=this;if(Array.isArray(a)){var p=
a.map(function(a){return e.on(a,b)});return g.handlesGroup(p)}if(-1<a.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);p=this._listenersMap.get(a)||[];p.push(b);this._listenersMap.set(a,p);return{remove:function(){var p=e._listenersMap&&e._listenersMap.get(a)||[],c=p.indexOf(b);0<=c&&p.splice(c,1)}}};a.prototype.once=function(a,b){var e;return e=this.on(a,function(a){e.remove();b.call(null,
a)})};a.prototype.hasEventListener=function(a){a=this._listenersMap&&this._listenersMap.get(a);return null!=a&&0<a.length};return a}();a.EventEmitter=b;a.EventedMixin=function(a){return function(a){function e(){var e=null!==a&&a.apply(this,arguments)||this;e._emitter=new b;return e}r.__extends(e,a);e.prototype.emit=function(a,p){return this._emitter.emit(a,p)};e.prototype.on=function(a,p){return this._emitter.on(a,p)};e.prototype.once=function(a,p){return this._emitter.once(a,p)};e.prototype.hasEventListener=
function(a){return this._emitter.hasEventListener(a)};return e=r.__decorate([c.subclass("esri.core.Evented")],e)}(a)};var m=function(a){function e(){var e=null!==a&&a.apply(this,arguments)||this;e._emitter=new d.EventEmitter(e);return e}r.__extends(e,a);e.prototype.emit=function(a,e){return this._emitter.emit(a,e)};e.prototype.on=function(a,e){return this._emitter.on(a,e)};e.prototype.once=function(a,e){return this._emitter.once(a,e)};e.prototype.hasEventListener=function(a){return this._emitter.hasEventListener(a)};
return e=r.__decorate([c.subclass("esri.core.Evented")],e)}(q);a.EventedAccessor=m})(d||(d={}));return d})},"esri/geometry/support/aaBoundingBox":function(){define(["require","exports","../../core/maybe","../Extent","./aaBoundingRect"],function(x,a,r,q,g){function c(p){void 0===p&&(p=a.ZERO);return[p[0],p[1],p[2],p[3],p[4],p[5]]}function d(a,e,b,d,k,t,g){void 0===g&&(g=c());g[0]=a;g[1]=e;g[2]=b;g[3]=d;g[4]=k;g[5]=t;return g}function b(a){return a[0]>=a[3]?0:a[3]-a[0]}function n(a){return a[1]>=a[4]?
0:a[4]-a[1]}function m(a){return a[2]>=a[5]?0:a[5]-a[2]}function w(a,e){return Math.max(e[0],a[0])<=Math.min(e[3],a[3])&&Math.max(e[1],a[1])<=Math.min(e[4],a[4])&&Math.max(e[2],a[2])<=Math.min(e[5],a[5])}function e(a,e){a[0]=e[0];a[1]=e[1];a[2]=e[2];a[3]=e[3];a[4]=e[4];a[5]=e[5];return a}function u(a){return 6===a.length}Object.defineProperty(a,"__esModule",{value:!0});a.ZERO=a.NEGATIVE_INFINITY=a.POSITIVE_INFINITY=a.wrap=a.equals=a.isPoint=a.is=a.fromRect=a.toRect=a.empty=a.set=a.setMax=a.setMin=
a.getMax=a.getMin=a.offset=a.intersectsClippingArea=a.intersects=a.contains=a.containsPointWithMargin=a.containsPoint=a.maximumDimension=a.size=a.center=a.diameter=a.height=a.depth=a.width=a.allFinite=a.expandWithNestedArray=a.expandWithOffset=a.expandWithBuffer=a.expand=a.expandPointInPlace=a.fromMinMax=a.toExtent=a.fromExtent=a.fromValues=a.create=void 0;a.create=c;a.fromValues=d;a.fromExtent=function(a,e){void 0===e&&(e=c());e[0]=a.xmin;e[1]=a.ymin;e[2]=a.zmin;e[3]=a.xmax;e[4]=a.ymax;e[5]=a.zmax;
return e};a.toExtent=function(a,e){return isFinite(a[2])||isFinite(a[5])?new q({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:e}):new q({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:e})};a.fromMinMax=function(a,e,b){void 0===b&&(b=c());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=e[0];b[4]=e[1];b[5]=e[2];return b};a.expandPointInPlace=function(a,e){e[0]<a[0]&&(a[0]=e[0]);e[0]>a[3]&&(a[3]=e[0]);e[1]<a[1]&&(a[1]=e[1]);e[1]>a[4]&&(a[4]=e[1]);e[2]<a[2]&&(a[2]=e[2]);e[2]>
a[5]&&(a[5]=e[2])};a.expand=function(a,e,b){void 0===b&&(b=a);u(e)?(b[0]=Math.min(a[0],e[0]),b[1]=Math.min(a[1],e[1]),b[2]=Math.min(a[2],e[2]),b[3]=Math.max(a[3],e[3]),b[4]=Math.max(a[4],e[4]),b[5]=Math.max(a[5],e[5])):g.is(e)?(b[0]=Math.min(a[0],e[0]),b[1]=Math.min(a[1],e[1]),b[3]=Math.max(a[3],e[2]),b[4]=Math.max(a[4],e[3])):2===e.length?(b[0]=Math.min(a[0],e[0]),b[1]=Math.min(a[1],e[1]),b[3]=Math.max(a[3],e[0]),b[4]=Math.max(a[4],e[1])):3===e.length&&(b[0]=Math.min(a[0],e[0]),b[1]=Math.min(a[1],
e[1]),b[2]=Math.min(a[2],e[2]),b[3]=Math.max(a[3],e[0]),b[4]=Math.max(a[4],e[1]),b[5]=Math.max(a[5],e[2]));return b};a.expandWithBuffer=function(a,e,b,c,k){void 0===b&&(b=0);void 0===c&&(c=e.length/3);void 0===k&&(k=a);var p=a[0],d=a[1],t=a[2],g=a[3],A=a[4];a=a[5];for(var m=0;m<c;m++)p=Math.min(p,e[b+3*m]),d=Math.min(d,e[b+3*m+1]),t=Math.min(t,e[b+3*m+2]),g=Math.max(g,e[b+3*m]),A=Math.max(A,e[b+3*m+1]),a=Math.max(a,e[b+3*m+2]);k[0]=p;k[1]=d;k[2]=t;k[3]=g;k[4]=A;k[5]=a;return k};a.expandWithOffset=
function(a,e,b,c,k){void 0===k&&(k=a);k[0]=Math.min(a[0],a[0]+e);k[3]=Math.max(a[3],a[3]+e);k[1]=Math.min(a[1],a[1]+b);k[4]=Math.max(a[4],a[4]+b);k[2]=Math.min(a[2],a[2]+c);k[5]=Math.max(a[5],a[5]+c);return k};a.expandWithNestedArray=function(a,e,b,c){void 0===c&&(c=a);var p=e.length,d=a[0],t=a[1],g=a[2],m=a[3],A=a[4];a=a[5];if(b)for(b=0;b<p;b++){var n=e[b],d=Math.min(d,n[0]),t=Math.min(t,n[1]),g=Math.min(g,n[2]),m=Math.max(m,n[0]),A=Math.max(A,n[1]);a=Math.max(a,n[2])}else for(b=0;b<p;b++)n=e[b],
d=Math.min(d,n[0]),t=Math.min(t,n[1]),m=Math.max(m,n[0]),A=Math.max(A,n[1]);c[0]=d;c[1]=t;c[2]=g;c[3]=m;c[4]=A;c[5]=a;return c};a.allFinite=function(a){for(var e=0;6>e;e++)if(!isFinite(a[e]))return!1;return!0};a.width=b;a.depth=n;a.height=m;a.diameter=function(a){var e=b(a),c=m(a);a=n(a);return Math.sqrt(e*e+c*c+a*a)};a.center=function(a,e){void 0===e&&(e=[0,0,0]);e[0]=a[0]+b(a)/2;e[1]=a[1]+n(a)/2;e[2]=a[2]+m(a)/2;return e};a.size=function(a,e){void 0===e&&(e=[0,0,0]);e[0]=b(a);e[1]=n(a);e[2]=m(a);
return e};a.maximumDimension=function(a){return Math.max(b(a),m(a),n(a))};a.containsPoint=function(a,e){return e[0]>=a[0]&&e[1]>=a[1]&&e[2]>=a[2]&&e[0]<=a[3]&&e[1]<=a[4]&&e[2]<=a[5]};a.containsPointWithMargin=function(a,e,b){return e[0]>=a[0]-b&&e[1]>=a[1]-b&&e[2]>=a[2]-b&&e[0]<=a[3]+b&&e[1]<=a[4]+b&&e[2]<=a[5]+b};a.contains=function(a,e){return e[0]>=a[0]&&e[1]>=a[1]&&e[2]>=a[2]&&e[3]<=a[3]&&e[4]<=a[4]&&e[5]<=a[5]};a.intersects=w;a.intersectsClippingArea=function(a,e){return r.isNone(e)?!0:w(a,e)};
a.offset=function(a,e,b,c,k){void 0===k&&(k=a);k[0]=a[0]+e;k[1]=a[1]+b;k[2]=a[2]+c;k[3]=a[3]+e;k[4]=a[4]+b;k[5]=a[5]+c;return k};a.getMin=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];return e};a.getMax=function(a,e){e[0]=a[3];e[1]=a[4];e[2]=a[5];return e};a.setMin=function(a,e,b){void 0===b&&(b=a);b[0]=e[0];b[1]=e[1];b[2]=e[2];b!==a&&(b[3]=a[3],b[4]=a[4],b[5]=a[5]);return b};a.setMax=function(a,e,b){void 0===b&&(b=a);b[3]=e[0];b[4]=e[1];b[5]=e[2];b!==a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return a};a.set=
e;a.empty=function(b){return b?e(b,a.NEGATIVE_INFINITY):c(a.NEGATIVE_INFINITY)};a.toRect=function(a,e){e||(e=g.create());e[0]=a[0];e[1]=a[1];e[2]=a[3];e[3]=a[4];return e};a.fromRect=function(a,e){a[0]=e[0];a[1]=e[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=e[2];a[4]=e[3];a[5]=Number.POSITIVE_INFINITY;return a};a.is=u;a.isPoint=function(a){return 0===b(a)&&0===n(a)&&0===m(a)};a.equals=function(a,e,b){if(r.isNone(a)||r.isNone(e))return a===e;if(!u(a)||!u(e))return!1;if(b)for(var c=0;c<a.length;c++){if(!b(a[c],
e[c]))return!1}else for(c=0;c<a.length;c++)if(a[c]!==e[c])return!1;return!0};a.wrap=function(a,e,b,c,k,g){return d(a,e,b,c,k,g,t)};a.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0,0,0];var t=c()})},"esri/geometry/support/aaBoundingRect":function(){define(["require","exports","../../core/compilerUtils","../Extent"],function(x,a,r,q){function g(e){void 0===e&&(e=a.ZERO);return[e[0],
e[1],e[2],e[3]]}function c(a){return a[0]>=a[2]?0:a[2]-a[0]}function d(a){return a[1]>=a[3]?0:a[3]-a[1]}function b(a,b,c){return b>=a[0]&&c>=a[1]&&b<=a[2]&&c<=a[3]}function n(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function m(a){return 4===a.length}function w(a,b,c){return a<b?b:a>c?c:a}Object.defineProperty(a,"__esModule",{value:!0});a.UNIT=a.ZERO=a.NEGATIVE_INFINITY=a.POSITIVE_INFINITY=a.equals=a.isPoint=a.is=a.empty=a.set=a.setMax=a.setMin=a.pad=a.offset=a.size=a.distance=a.intersection=
a.contains=a.intersects=a.containsPointWithMargin=a.containsXY=a.containsPointObject=a.containsPoint=a.center=a.area=a.diameter=a.height=a.width=a.allFinite=a.expandWithNestedArray=a.expand=a.expandPointInPlace=a.toExtent=a.fromExtent=a.fromValues=a.clone=a.create=void 0;a.create=g;a.clone=function(a){return[a[0],a[1],a[2],a[3]]};a.fromValues=function(a,b,c,d,m){void 0===m&&(m=g());m[0]=a;m[1]=b;m[2]=c;m[3]=d;return m};a.fromExtent=function(a,b){void 0===b&&(b=g());b[0]=a.xmin;b[1]=a.ymin;b[2]=a.xmax;
b[3]=a.ymax;return b};a.toExtent=function(a,b){return new q({xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:b})};a.expandPointInPlace=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[2]&&(a[2]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[3]&&(a[3]=b[1])};a.expand=function(a,b,c){void 0===c&&(c=a);if("length"in b)if(m(b))c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.max(a[2],b[2]),c[3]=Math.max(a[3],b[3]);else{if(2===b.length||3===b.length)c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),
c[2]=Math.max(a[2],b[0]),c[3]=Math.max(a[3],b[1])}else switch(b.type){case "extent":c[0]=Math.min(a[0],b.xmin);c[1]=Math.min(a[1],b.ymin);c[2]=Math.max(a[2],b.xmax);c[3]=Math.max(a[3],b.ymax);break;case "point":c[0]=Math.min(a[0],b.x);c[1]=Math.min(a[1],b.y);c[2]=Math.max(a[2],b.x);c[3]=Math.max(a[3],b.y);break;default:r.neverReached(b)}return c};a.expandWithNestedArray=function(a,b,c){void 0===c&&(c=a);var e=b.length,d=a[0],g=a[1],t=a[2];a=a[3];for(var k=0;k<e;k++){var m=b[k],d=Math.min(d,m[0]),
g=Math.min(g,m[1]),t=Math.max(t,m[0]);a=Math.max(a,m[1])}c[0]=d;c[1]=g;c[2]=t;c[3]=a;return c};a.allFinite=function(a){for(var b=0;4>b;b++)if(!isFinite(a[b]))return!1;return!0};a.width=c;a.height=d;a.diameter=function(a){var b=c(a);a=d(a);return Math.sqrt(b*b+a*a)};a.area=function(a){return c(a)*d(a)};a.center=function(a,b){void 0===b&&(b=[0,0]);b[0]=(a[0]+a[2])/2;b[1]=(a[1]+a[3])/2;return b};a.containsPoint=function(a,c){return b(a,c[0],c[1])};a.containsPointObject=function(a,c){return b(a,c.x,c.y)};
a.containsXY=b;a.containsPointWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[0]<=a[2]+c&&b[1]<=a[3]+c};a.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[2],a[2])&&Math.max(b[1],a[1])<=Math.min(b[3],a[3])};a.contains=function(a,b){return b[0]>=a[0]&&b[2]<=a[2]&&b[1]>=a[1]&&b[3]<=a[3]};a.intersection=function(a,b,c){void 0===c&&(c=a);var e=b[0],d=b[1],g=b[2];b=b[3];c[0]=w(a[0],e,g);c[1]=w(a[1],d,b);c[2]=w(a[2],e,g);c[3]=w(a[3],d,b);return c};a.distance=function(a,b){var e=
(a[1]+a[3])/2,g=Math.max(Math.abs(b[0]-(a[0]+a[2])/2)-c(a)/2,0);a=Math.max(Math.abs(b[1]-e)-d(a)/2,0);return Math.sqrt(g*g+a*a)};a.size=function(a,b){b[0]=a[2]-a[0];b[1]=a[3]-a[1]};a.offset=function(a,b,c,d){void 0===d&&(d=a);d[0]=a[0]+b;d[1]=a[1]+c;d[2]=a[2]+b;d[3]=a[3]+c;return d};a.pad=function(a,b,c){void 0===c&&(c=a);c[0]=a[0]-b;c[1]=a[1]-b;c[2]=a[2]+b;c[3]=a[3]+b;return c};a.setMin=function(a,b,c){void 0===c&&(c=a);c[0]=b[0];c[1]=b[1];c!==a&&(c[2]=a[2],c[3]=a[3]);return c};a.setMax=function(a,
b,c){void 0===c&&(c=a);c[2]=b[0];c[3]=b[1];c!==a&&(c[0]=a[0],c[1]=a[1]);return a};a.set=n;a.empty=function(b){return b?n(b,a.NEGATIVE_INFINITY):g(a.NEGATIVE_INFINITY)};a.is=m;a.isPoint=function(a){return(0===c(a)||!isFinite(a[0]))&&(0===d(a)||!isFinite(a[1]))};a.equals=function(a,b,c){if(null==a||null==b)return a===b;if(!m(a)||!m(b))return!1;if(c)for(var e=0;e<a.length;e++){if(!c(a[e],b[e]))return!1}else for(e=0;e<a.length;e++)if(a[e]!==b[e])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,
Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0];a.UNIT=[0,0,1,1]})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(x,a,r,q){Object.defineProperty(a,"__esModule",{value:!0});a.BoundsStore=void 0;var g={minX:0,minY:0,maxX:0,maxY:0};x=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=q(9,r("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,d){b[c++]=d});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,b){this._loadIndex();var c=0,d=this._index;g.minX=a[0];g.minY=a[1];g.maxX=a[2];g.maxY=a[3];for(a=d.search(g);c<a.length;c++)b(this._idByBounds.get(a[c]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||(this._boundsToLoad.push(b),5E4<this._boundsToLoad.length&&this._loadIndex()))};return a}();a.BoundsStore=x})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(x){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function r(a,b){q(a,0,a.children.length,b,a)}function q(a,b,c,d,m){m||(m=e(null));m.minX=Infinity;m.minY=Infinity;m.maxX=-Infinity;m.maxY=-Infinity;for(var k;b<c;b++)k=a.children[b],g(m,a.leaf?d(k):k);return m}function g(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function d(a,b){return a.minY-b.minY}function b(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function n(a){return a.maxX-a.minX+(a.maxY-a.minY)}function m(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function w(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function e(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function u(a,b,c,e,d){for(var k=[b,c],g;k.length;)c=k.pop(),b=k.pop(),c-b<=e||(g=b+Math.ceil((c-b)/e/2)*e,x(a,g,b,c,d),k.push(b,g,g,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],e=this.toBBox;if(!w(a,b))return c;for(var d=[],k,g,n,t;b;){k=0;for(g=b.children.length;k<g;k++)n=b.children[k],t=b.leaf?e(n):n,w(a,t)&&(b.leaf?c.push(n):m(a,t)?this._all(n,c):d.push(n));b=d.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!w(a,b))return!1;for(var e=[],d,k,g,n;b;){d=0;for(k=b.children.length;d<k;d++)if(g=b.children[d],n=b.leaf?c(g):g,w(a,n)){if(b.leaf||m(a,n))return!0;e.push(g)}b=e.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=e([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,e=this.toBBox(a),d=[],k=[],g,n,p,t;c||d.length;){c||(c=d.pop(),n=d[d.length-1],g=k.pop(),t=!0);if(c.leaf){a:{p=a;var B=c.children,q=b;if(q){for(var w=0;w<B.length;w++)if(q(p,B[w])){p=w;break a}p=-1}else p=B.indexOf(p)}if(-1!==p){c.children.splice(p,
1);d.push(c);this._condense(d);break}}t||c.leaf||!m(c,e)?n?(g++,c=n.children[g],t=!1):c=null:(d.push(c),k.push(g),g=0,n=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:d,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,d){var g=c-b+1,k=this._maxEntries,m;if(g<=k)return m=e(a.slice(b,c+1)),r(m,
this.toBBox),m;d||(d=Math.ceil(Math.log(g)/Math.log(k)),k=Math.ceil(g/Math.pow(k,d-1)));m=e([]);m.leaf=!1;m.height=d;var g=Math.ceil(g/k),k=g*Math.ceil(Math.sqrt(k)),n,p,t;for(u(a,b,c,k,this.compareMinX);b<=c;b+=k)for(p=Math.min(b+k-1,c),u(a,b,p,g,this.compareMinY),n=b;n<=p;n+=g)t=Math.min(n+g-1,p),m.children.push(this._build(a,n,t,d-1));r(m,this.toBBox);return m},_chooseSubtree:function(a,c,e,d){for(var g,k,m,n,p,t,B,q;;){d.push(c);if(c.leaf||d.length-1===e)break;B=q=Infinity;g=0;for(k=c.children.length;g<
k;g++)m=c.children[g],p=b(m),t=(Math.max(m.maxX,a.maxX)-Math.min(m.minX,a.minX))*(Math.max(m.maxY,a.maxY)-Math.min(m.minY,a.minY))-p,t<q?(q=t,B=p<B?p:B,n=m):t===q&&p<B&&(B=p,n=m);c=n||c.children[0]}return c},_insert:function(a,b,c){var e=this.toBBox;c=c?a:e(a);var e=[],d=this._chooseSubtree(c,this.data,b,e);d.children.push(a);for(g(d,c);0<=b;)if(e[b].children.length>this._maxEntries)this._split(e,b),b--;else break;this._adjustParentBBoxes(c,e,b)},_split:function(a,b){var c=a[b],d=c.children.length,
g=this._minEntries;this._chooseSplitAxis(c,g,d);d=this._chooseSplitIndex(c,g,d);d=e(c.children.splice(d,c.children.length-d));d.height=c.height;d.leaf=c.leaf;r(c,this.toBBox);r(d,this.toBBox);b?a[b-1].children.push(d):this._splitRoot(c,d)},_splitRoot:function(a,b){this.data=e([a,b]);this.data.height=a.height+1;this.data.leaf=!1;r(this.data,this.toBBox)},_chooseSplitIndex:function(a,c,e){var d,g,k,m,n,p,t;n=p=Infinity;for(d=c;d<=e-c;d++)g=q(a,0,d,this.toBBox),k=q(a,d,e,this.toBBox),m=Math.max(0,Math.min(g.maxX,
k.maxX)-Math.max(g.minX,k.minX))*Math.max(0,Math.min(g.maxY,k.maxY)-Math.max(g.minY,k.minY)),g=b(g)+b(k),m<n?(n=m,t=d,p=g<p?g:p):m===n&&g<p&&(p=g,t=d);return t},_chooseSplitAxis:function(a,b,e){var g=a.leaf?this.compareMinX:c,m=a.leaf?this.compareMinY:d,k=this._allDistMargin(a,b,e,g);b=this._allDistMargin(a,b,e,m);k<b&&a.children.sort(g)},_allDistMargin:function(a,b,c,e){a.children.sort(e);e=this.toBBox;var d=q(a,0,b,e),k=q(a,c-b,c,e),m=n(d)+n(k),p,t;for(p=b;p<c-b;p++)t=a.children[p],g(d,a.leaf?e(t):
t),m+=n(d);for(p=c-b-1;p>=b;p--)t=a.children[p],g(k,a.leaf?e(t):t),m+=n(k);return m},_adjustParentBBoxes:function(a,b,c){for(;0<=c;c--)g(b[c],a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():r(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function x(q,g,c,d,b){for(;d>c;){if(600<d-c){var n=d-c+1,m=g-c+1,w=Math.log(n),e=.5*Math.exp(2*w/3),w=.5*Math.sqrt(w*e*(n-e)/n)*(0>m-n/2?-1:1);x(q,g,Math.max(c,Math.floor(g-m*e/n+w)),Math.min(d,Math.floor(g+(n-m)*e/n+w)),b)}n=q[g];m=c;e=d;a(q,c,g);for(0<b(q[d],n)&&a(q,c,d);m<e;){a(q,m,e);m++;for(e--;0>b(q[m],n);)m++;for(;0<b(q[e],n);)e--}0===b(q[c],n)?
a(q,c,e):(e++,a(q,e,d));e<=g&&(c=e+1);g<=e&&(d=e-1)}}function a(a,g,c){var d=a[g];a[g]=a[c];a[c]=d}function r(a,g){return a<g?-1:a>g?1:0}return function(a,g,c,d,b){x(a,g,c||0,d||a.length-1,b||r)}})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(x,a,r,q,g){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter=void 0;a.optimizedFeatureQueryEngineAdapter=
{getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,d){return a.attributes[d]},cloneWithGeometry:function(a,d){return new q.default(d,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,d){a.centroid||(a.centroid=r.getCentroidOptimizedGeometry(new g.default,a.geometry,d.hasZ,d.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/centroid":function(){define(["require",
"exports"],function(x,a){function r(a,c,d,b,n,m,w){void 0===w&&(w=1);m=n?m?4:3:m?3:2;var e=d,g=d+m,t=0,p=0,q=d=0,r=0,A=0;for(--b;A<b;A++,e+=m,g+=m){var k=c[e],J=c[e+1],O=c[e+2],H=c[g],L=c[g+1],B=c[g+2],K=k*L-H*J,q=q+K,t=t+(k+H)*K,p=p+(J+L)*K;n&&(K=k*B-H*O,d+=(O+B)*K,r+=K);k<a[0]&&(a[0]=k);k>a[1]&&(a[1]=k);J<a[2]&&(a[2]=J);J>a[3]&&(a[3]=J);n&&(O<a[4]&&(a[4]=O),O>a[5]&&(a[5]=O))}0<q*w&&(q*=-1);0<r*w&&(r*=-1);if(!q)return null;a=[t,p,.5*q];n&&(a[3]=d,a[4]=.5*r);return a}function q(a,c,d,b,n){n=b?n?4:
3:n?3:2;for(var g=c,q=c+n,e=0,r=0,t=0,p=0,x=0,E=d-1;x<E;x++,g+=n,q+=n){var A=a[g],k=a[g+1],J=a[g+2],O=a[q],H=a[q+1],L=a[q+2],B;if(b){B=O-A;var K=H-k,P=L-J;B=Math.sqrt(B*B+K*K+P*P)}else B=O-A,K=H-k,B=Math.sqrt(B*B+K*K);B&&(e+=B,b?(A=[A+.5*(O-A),k+.5*(H-k),J+.5*(L-J)],r+=B*A[0],t+=B*A[1],p+=B*A[2]):(A=[A+.5*(O-A),k+.5*(H-k)],r+=B*A[0],t+=B*A[1]))}return 0<e?b?[r/e,t/e,p/e]:[r/e,t/e]:0<d?b?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.lineCentroid=a.getCentroidOptimizedGeometry=
void 0;a.getCentroidOptimizedGeometry=function(a,c,d,b,n){if(!c||!c.lengths.length)return null;var g="upperLeft"===(null===n||void 0===n?void 0:n.originPosition)?-1:1;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);n=a.coords;for(var w=[],e=d?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],
u=c.lengths,t=c.coords,p=d?b?4:3:b?3:2,x=0,E=0;E<u.length;E++){var A=u[E],k=r(e,t,x,A,d,b,g);k&&w.push(k);x+=A*p}w.sort(function(a,b){var c=g*a[2]-g*b[2];0===c&&d&&(c=a[4]-b[4]);return c});w.length&&(p=6*w[0][2],n[0]=w[0][0]/p,n[1]=w[0][1]/p,d&&(p=6*w[0][4],n[2]=0!==p?w[0][3]/p:0),n[0]<e[0]||n[0]>e[1]||n[1]<e[2]||n[1]>e[3]||d&&(n[2]<e[4]||n[2]>e[5]))&&(n.length=0);if(!n.length)if(c=c.lengths[0]?q(t,0,u[0],d,b):null)n[0]=c[0],n[1]=c[1],d&&2<c.length&&(n[2]=c[2]);else return null;return a};a.lineCentroid=
q})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(x,a,r,q,g,c,d,b,n){function m(a,b){var c;if(!b)return null;if("x"in b){var d={x:0,y:0};a=a(b.x,b.y,t);d.x=a[0];d.y=a[1];null!=b.z&&(d.z=b.z);null!=b.m&&(d.m=b.m);return d}if("xmin"in
b)return d={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,t),d.xmin=c[0],d.ymin=c[1],a=a(b.xmax,b.ymax,t),d.xmax=a[0],d.ymax=a[1],b.hasZ&&(d.zmin=b.zmin,d.zmax=b.zmax,d.hasZ=!0),b.hasM&&(d.mmin=b.mmin,d.mmax=b.mmax,d.hasM=!0),d;if("rings"in b)return{rings:w(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:w(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:e(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function w(a,b){for(var c=[],d=0;d<a.length;d++)c.push(e(a[d],b));return c}
function e(a,b){for(var c=[],e=0;e<a.length;e++){var d=a[e],g=b(d[0],d[1],[0,0]);c.push(g);2<d.length&&g.push(d[2]);3<d.length&&g.push(d[3])}return c}function u(a,c){return!b.isValid(a)||!b.isValid(c)||b.equals(a,c)||n.canProject(a,c)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});a.projectMany=a.project=a.checkProjectionSupport=a.doesBrowserSupportProjection=void 0;var t=[0,0];a.doesBrowserSupportProjection=function(a,b){return u(a,b)?c.isSupported():!0};a.checkProjectionSupport=function(a,
b){return r.__awaiter(this,void 0,void 0,function(){var e,d,g;return r.__generator(this,function(k){if(!b)return[2];if(Array.isArray(a)){e=0;for(d=a;e<d.length;e++)if(g=d[e],u(g.geometry&&g.geometry.spatialReference,b)){if(c.isSupported())return[2,c.load()];throw new q("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});}return[2]}if(!u(a,b))return[2];if(c.isSupported())return[2,c.load()];throw new q("feature-store:unsupported-query","projection not supported",
{inSpatialReference:a,outSpatialReference:b});})})};var p=m.bind(null,n.lngLatToXY),D=m.bind(null,n.xyToLngLat);a.project=function(a,e,g){if(!a)return a;g||(g=e,e=a.spatialReference);return b.isValid(e)&&b.isValid(g)&&!b.equals(e,g)?n.canProject(e,g)?b.isWebMercator(g)?p(a):D(a):c.projectMany(d.jsonAdapter,[a],e,g,null)[0]:a};var E=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,c,e){return r.__awaiter(this,void 0,void 0,
function(){var d,k=this;return r.__generator(this,function(m){a&&a.length&&c&&e&&!b.equals(c,e)||g.resolve(a);d={geometries:a,inSpatialReference:c,outSpatialReference:e,resolve:null};this._jobs.push(d);return[2,g.create(function(a){d.resolve=a;null===k._timer&&(k._timer=setTimeout(k._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var e=a.geometries,g=a.inSpatialReference,m=a.outSpatialReference,a=a.resolve;n.canProject(g,m)?b.isWebMercator(m)?
a(e.map(p)):a(e.map(D)):a(c.projectMany(d.jsonAdapter,e,g,m,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2,E.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./support/GeographicTransformation @dojo/framework/shim/Promise".split(" "),function(x,a,r,q,g){function c(a,c,m,n,q){void 0===
q&&(q=null);if(null===q){var e=g.cacheKey(m,n);void 0!==w[e]?q=w[e]:(q=d(m,n,null),null===q&&(q=new g),w[e]=q)}return b._project(a,c,m,n,q)}function d(a,c,d){void 0===d&&(d=null);a=b._getTransformation(n,a,c,d,null===d||void 0===d?void 0:d.spatialReference);return null!==a?g.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});a.getTransformations=a.getTransformation=a.projectMany=a.project=a.load=a.isSupported=a.isLoaded=void 0;var b=null,n=null;a.isLoaded=function(){return!!b&&q.isLoaded()};
a.isSupported=function(){return q.isSupported()};var m=null;a.load=function(){return m?m:m=r.all([q.load(),new Promise(function(a,b){x(["./geometryEngineBase"],a,b)}),new Promise(function(a,b){x(["./geometryAdapters/hydrated"],a,b)})]).then(function(a){var c=a[1];n=a[2].hydratedAdapter;b=c;b._enableProjection(q)})};a.project=function(a,b,d){void 0===d&&(d=null);return a instanceof Array?0===a.length?[]:c(n,a,a[0].spatialReference,b,d):c(n,[a],a.spatialReference,b,d)[0]};var w={};a.projectMany=c;a.getTransformation=
d;a.getTransformations=function(a,c,d){void 0===d&&(d=null);a=b._getTransformationBySuitability(n,a,c,d,null===d||void 0===d?void 0:d.spatialReference);if(null!==a){c=[];for(d=0;d<a.length;d++)c.push(g.fromGE(a[d]));return c}return[]}})},"esri/geometry/pe":function(){define("require exports tslib ../assets ../core/has ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),function(x,a,r,q,g,c){function d(b){function c(a,b,c){a[b]=c(a[b])}a._pe=b;u.init();t.init();p.init();D.init();E.init();
a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}r.__extends(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var e=0,d=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];e<d.length;e++)b=d[e],c(b.prototype,"getName",function(a){return function(){return a.call(this,Array(u.PE_NAME_MAX))}});e=0;for(d=[a._pe.PeGeogtran,a._pe.PeProjcs];e<
d.length;e++)b=d[e],c(b.prototype,"getParameters",function(b){return function(){for(var c=Array(u.PE_PARM_MAX),e=b.call(this),d=0;d<c.length;d++){var g=a._pe.getValue(e,"*");c[d]=g?a._pe.wrapPointer(g,a._pe.PeParameter):null;e+=Int32Array.BYTES_PER_ELEMENT}return c}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var c=[],e=a.call(this);w(c,b,e);return c}});c(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();
return function(){var e=null,d=b.call(this);if(!a._pe.compare(d,a._pe.NULL)){var e=[d],g=this.getSteps();if(1<g)for(var d=a._pe.getPointer(d),k=1;k<g;k++)e.push(a._pe.wrapPointer(d+c*k,a._pe.PeGTlistExtendedGTs))}return e}});var g=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var e=null,d=b.call(this);if(!a._pe.compare(d,a._pe.NULL)){var e=[d],k=d.getNump();if(1<k)for(var d=a._pe.getPointer(d),m=1;m<k;m++)e.push(a._pe.wrapPointer(d+
g*m,a._pe.PeHorizon))}c.set(b,e);return e}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=u.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),e=a._pe.ensureInt8(Array(u.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,e))}}function b(b){if(b){var c=a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}
function n(b,c){var e=[];c=Array(c);for(var d=0;d<b;d++)e.push(a._pe.ensureInt8(c));return e}function m(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function w(b,c,e,d){void 0===d&&(d=!1);if(d)for(d=0;d<2*c;d++)b[d]=a._pe.getValue(e+d*Float64Array.BYTES_PER_ELEMENT,"double");else{var g=0===b.length;for(d=0;d<c;d++)g&&(b[d]=Array(2)),b[d][0]=a._pe.getValue(e,"double"),b[d][1]=a._pe.getValue(e+Float64Array.BYTES_PER_ELEMENT,"double"),e+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});a._init=a.PeVersion=a.PePCSInfo=a.PeNotationUtm=a.PeNotationUsng=a.PeNotationMgrs=a.PeNotationDms=a.PeGTTransformations=a.PeGTlistExtendedEntry=a.PeGTlistExtended=a.PeGCSExtent=a.PeFactory=a.PeDefs=a.PeCSTransformations=a.load=a.isSupported=a.isLoaded=a._pe=void 0;var e;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!g("esri-wasm")};a.load=function(){return e?e:e=c.create(function(a,b){(new Promise(function(a,b){x(["./support/pe-wasm"],
a,b)})).then(function(c){c({locateFile:function(a){return q.getAssetUrl("esri/geometry/support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){d(b);a()})})})};(function(b){function c(b,c,e){a._pe.ensureCache.prepare();var d=m(e),g=e===d,d=a._pe.ensureFloat64(d);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,d))&&w(e,c,d,g);return b}function e(a,b,c){return d(a,b,c,0)}function d(b,c,e,d){a._pe.ensureCache.prepare();var g=m(e),k=e===g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),
c,g,d))&&w(e,c,g,k);return b}b.geogToProj=c;b.projGeog=function(a,b,d,g){switch(g){case u.PE_TRANSFORM_P_TO_G:return e(a,b,d);case u.PE_TRANSFORM_G_TO_P:return c(a,b,d)}return 0};b.projToGeog=e;b.projToGeogCenter=d})(a.PeCSTransformations||(a.PeCSTransformations={}));var u;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(u=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var g=null,m=d[b];m||(m={},d[b]=m);m.hasOwnProperty(String(c))?g=m[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,
c),a._pe.compare(b,a._pe.NULL)||(g=b,m[c]=g));return g=e(g)}function e(b){if(b){var c=b.getType();switch(c){case u.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case u.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case u.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&u.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var d={},g={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(u.PE_TYPE_COORDSYS,
a)};b.factoryByType=c;b.fromString=function(b,c){var d=null,m=g[b];m||(m={},g[b]=m);m.hasOwnProperty(c)?d=m[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(d=b,m[c]=d));return d=e(d)};b.geogcs=function(a){return c(u.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(u.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(u.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(u.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var t;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,e,d,g,m,k){var n=null,C=new a._pe.PeInteger(k);try{var F=a._pe.PeGTlistExtended.prototype.getGTlist(b,e,d,g,m,C);if(k=C.val)if(n=[F],1<k){var v=a._pe.getPointer(F);for(b=1;b<k;b++)n.push(a._pe.wrapPointer(v+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(C)}return n}})(t=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(c){c.destroy=function(c){if(c&&c.length){for(var e=0;e<c.length;e++){var d=c[e];b(d);d.getEntries().forEach(function(a){b(a);a=a.getGeogtran();b(a);a.getParameters().forEach(b);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){b(a);var c=a.getDatum();b(c);b(c.getSpheroid());b(a.getPrimem());b(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(c[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,e,d,
g){a._pe.ensureCache.prepare();var k=m(e),n=e===k,k=a._pe.ensureFloat64(k),p=0;d&&(p=a._pe.ensureFloat64(d));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,k,p,g))&&w(e,c,k,n);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function c(b,c,e,d,g,k){a._pe.ensureCache.prepare();var p,F;switch(b){case "dd":p=a._pe._pe_geog_to_dd;F=u.PE_DD_MAX;break;case "ddm":p=a._pe._pe_geog_to_ddm;F=u.PE_DDM_MAX;break;case "dms":p=a._pe._pe_geog_to_dms,F=u.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));
c=m(d);c=a._pe.ensureFloat64(c);F=n(e,F);d=a._pe.ensureInt32(F);if(g=p(b,e,c,g,d))for(p=0;p<e;p++)k[p]=a._pe.UTF8ToString(F[p]);return g}function e(b,c,e,d,g){a._pe.ensureCache.prepare();var m;switch(b){case "dd":m=a._pe._pe_dd_to_geog;break;case "ddm":m=a._pe._pe_ddm_to_geog;break;case "dms":m=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*e));(m=m(b,e,d,c))&&w(g,e,c);return m}b.geog_to_dms=
function(a,b,e,d,g){return c("dms",a,b,e,d,g)};b.dms_to_geog=function(a,b,c,d){return e("dms",a,b,c,d)};b.geog_to_ddm=function(a,b,e,d,g){return c("ddm",a,b,e,d,g)};b.ddm_to_geog=function(a,b,c,d){return e("ddm",a,b,c,d)};b.geog_to_dd=function(a,b,e,d,g){return c("dd",a,b,e,d,g)};b.dd_to_geog=function(a,b,c,d){return e("dd",a,b,c,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var p;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,e,d,g,p,q){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=m(e);e=a._pe.ensureFloat64(b);b=n(c,u.PE_MGRS_MAX);var C=a._pe.ensureInt32(b);if(d=a._pe._pe_geog_to_mgrs_extended(k,
c,e,d,g,p,C))for(g=0;g<c;g++)q[g]=a._pe.UTF8ToString(b[g]);return d};b.mgrs_to_geog_extended=function(b,c,e,d,g){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(d=a._pe._pe_mgrs_to_geog_extended(m,c,e,d,b))&&w(g,c,b);return d}})(p=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,e,d,g,p,q){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));
b=m(e);e=a._pe.ensureFloat64(b);b=n(c,u.PE_MGRS_MAX);var C=a._pe.ensureInt32(b);if(d=a._pe._pe_geog_to_usng(k,c,e,d,g,p,C))for(g=0;g<c;g++)q[g]=a._pe.UTF8ToString(b[g]);return d};b.usng_to_geog=function(b,c,e,d){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(g=a._pe._pe_usng_to_geog(g,c,e,b))&&w(d,c,b);return g}})(a.PeNotationUsng||(a.PeNotationUsng={}));var D;(function(b){b.init=
function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,c,e,d,g){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=m(e);e=a._pe.ensureFloat64(b);b=n(c,u.PE_UTM_MAX);var p=a._pe.ensureInt32(b);if(d=a._pe._pe_geog_to_utm(k,c,e,d,p))for(k=0;k<c;k++)g[k]=a._pe.UTF8ToString(b[k]);return d};b.utm_to_geog=
function(b,c,e,d,g){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(d=a._pe._pe_utm_to_geog(m,c,e,d,b))&&w(g,c,b);return d}})(D=a.PeNotationUtm||(a.PeNotationUtm={}));var E;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(e,d){void 0===d&&(d=b.PE_PCSINFO_OPTION_DOMAIN);var g,m;c.has(e)&&(m=c.get(e),m[d]&&(g=m[d]));g||(g=a._pe.PePCSInfo.prototype.generate(e,d),m||(m=[],c.set(e,m)),m[d]=g);return g}})(E=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=d})},"esri/assets":function(){define(["require",
"exports","./request","./core/urlUtils"],function(x,a,r,q){function g(a){return q.join(x.toUrl("."),"../",a)}Object.defineProperty(a,"__esModule",{value:!0});a.getAssetUrl=a.fetchAsset=void 0;a.fetchAsset=function(a,d){return r(g(a),d)};a.getAssetUrl=g})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(x,a,r){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;
if(a&&a.steps){var c=0;for(a=a.steps;c<a.length;c++){var d=a[c];d instanceof r?this.steps.push(d):this.steps.push(new r({wkid:d.wkid,wkt:d.wkt,isInverse:d.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(g){var c=new a,d="",b=0;for(g=g.steps;b<g.length;b++){var n=r.fromGE(g[b]);
c.steps.push(n);d+=n.uid.toString()+","}c._cached_projection={};c._gtlistentry=null;c._chain=d;return c};a.prototype.getInverse=function(){var g=new a;g.steps=[];for(var c=this.steps.length-1;0<=c;c--)g.steps.push(this.steps[c].getInverse());return g};a.prototype.getGTListEntry=function(){for(var a="",c=0,d=this.steps;c<d.length;c++)a+=d[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(g,
c,d){this._cached_projection[a.cacheKey(g,c)]=d};a.prototype.getCachedGeTransformation=function(g,c){for(var d="",b=0,n=this.steps;b<n.length;b++)d+=n[b].uid.toString()+",";d!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=d);g=this._cached_projection[a.cacheKey(g,c)];return void 0===g?null:g};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(x,a){var r=0;return function(){function a(a){void 0===a&&(a=
null);this.uid=r++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(g){var c=new a;c._wkt=g.wkt;c._wkid=g.wkid;c._isInverse=g.isInverse;return c};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=r++},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},
set:function(a){this._wkid=a;this.uid=r++},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=r++},enumerable:!1,configurable:!0});a.prototype.getInverse=function(){var g=new a;g._wkt=this.wkt;g._wkid=this._wkid;g._isInverse=!this.isInverse;return g};return a}()})},"esri/geometry/geometryAdapters/json":function(){define(["require","exports"],function(x,a){Object.defineProperty(a,"__esModule",
{value:!0});a.jsonAdapter=void 0;a.jsonAdapter={convertToGEGeometry:function(a,c){return null==c?null:a.convertJSONToGeometry(c)},exportPoint:function(a,c,d){d=new r(a.getPointX(c),a.getPointY(c),d);var b=a.hasZ(c),e=a.hasM(c);b&&(d.z=a.getPointZ(c));e&&(d.m=a.getPointM(c));return d},exportPolygon:function(a,c,d){return new q(a.exportPaths(c),d,a.hasZ(c),a.hasM(c))},exportPolyline:function(a,c,d){return new g(a.exportPaths(c),d,a.hasZ(c),a.hasM(c))},exportMultipoint:function(a,d,g){return new c(a.exportPoints(d),
g,a.hasZ(d),a.hasM(d))},exportExtent:function(a,c,g){var b=a.hasZ(c),e=a.hasM(c);g=new d(a.getXMin(c),a.getYMin(c),a.getXMax(c),a.getYMax(c),g);b&&(b=a.getZExtent(c),g.zmin=b.vmin,g.zmax=b.vmax);e&&(a=a.getMExtent(c),g.mmin=a.vmin,g.mmax=a.vmax);return g}};var r=function(){return function(a,c,d){this.x=a;this.y=c;this.spatialReference=d;this.m=this.z=void 0}}(),q=function(){return function(a,c,d,g){this.rings=a;this.spatialReference=c;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);g&&(this.hasM=g)}}(),
g=function(){return function(a,c,d,g){this.paths=a;this.spatialReference=c;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);g&&(this.hasM=g)}}(),c=function(){return function(a,c,d,g){this.points=a;this.spatialReference=c;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);g&&(this.hasM=g)}}(),d=function(){return function(a,c,d,g,e){this.xmin=a;this.ymin=c;this.xmax=d;this.ymax=g;this.spatialReference=e;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}()})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports tslib ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(x,a,r,q,g,c,d,b,n,m,w,e,u,t,p,D,E,A,k,J,O,H,L,B){function K(a){return a.every(function(a){return"exceedslimit"!==a.statisticType})}Object.defineProperty(a,"__esModule",{value:!0});a.Feature=void 0;x=function(){return function(a,b,c,e,l){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=e;this.filterFlags=l;this.groupId=-1;this.displayId=b}}();a.Feature=x;var P=new Set,C=new d.MemCacheStorage(2E6),F=0;x=function(){function a(a){var b=this;this.capabilities={query:A.queryCapabilities};
this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new d.MemCache(F++ +"$$",C));this.fieldsIndex=new L(a.fields);a.scheduler&&a.task&&(this._frameQueue=new B.default,
this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",
{get:function(){return this.featureStore.featureAdapter},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:H.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=O.getTimeExtent(this.timeInfo,
this.featureStore):null},enumerable:!1,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,e,l=this;return r.__generator(this,function(d){switch(d.label){case 0:b=g.clone(a),d.label=1;case 1:return d.trys.push([1,8,,9]),[4,this._schedule(function(){return H.normalizeQuery(b,l.definitionExpression,
l.spatialReference)})];case 2:return b=d.sent(),[4,this._reschedule(function(){return l._checkQuerySupport(b)})];case 3:return b=d.sent(),[4,this._reschedule(function(){return l._executeGeometryQuery(b)})];case 4:return c=d.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=d.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=d.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=d.sent(),
[3,9];case 8:e=d.sent();if(e!==H.QUERY_ENGINE_EMPTY_RESULT)throw e;c=new k.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,e,l=this;return r.__generator(this,function(d){switch(d.label){case 0:b=g.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,d.label=1;case 1:return d.trys.push([1,8,,9]),[4,this._schedule(function(){return H.normalizeQuery(b,
l.definitionExpression,l.spatialReference)})];case 2:return b=d.sent(),[4,this._reschedule(function(){return l._checkQuerySupport(b)})];case 3:return b=d.sent(),[4,this._reschedule(function(){return l._executeGeometryQuery(b)})];case 4:return c=d.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=d.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=d.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];
case 7:return c=d.sent(),[3,9];case 8:e=d.sent();if(e!==H.QUERY_ENGINE_EMPTY_RESULT)throw e;return[2,0];case 9:return[2,c.createQueryResponseForCount(b)]}})})};a.prototype.executeQueryForExtent=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,e,d,k,n,G,F,p=this;return r.__generator(this,function(C){switch(C.label){case 0:b=g.clone(a),e=b.outSR,C.label=1;case 1:return C.trys.push([1,8,,9]),[4,this._schedule(function(){return H.normalizeQuery(b,p.definitionExpression,
p.spatialReference)})];case 2:return b=C.sent(),[4,this._reschedule(function(){return p._checkQuerySupport(b)})];case 3:return b=C.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return p._executeGeometryQuery(b)})];case 4:return c=C.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=C.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=C.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];
case 7:c=C.sent();d=c.size;if(!d)return[2,{count:d,extent:null}];w.set(l,w.NEGATIVE_INFINITY);this.featureStore.forEachBounds(c.items,function(a){return w.expand(l,a)},v);k={xmin:l[0],ymin:l[1],xmax:l[3],ymax:l[4],spatialReference:H.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(l[2])&&isFinite(l[5])&&(k.zmin=l[2],k.zmax=l[5]);n=E.project(k,c.spatialReference,e);n.spatialReference=H.cleanFromGeometryEngine(e||this.spatialReference);0===n.xmax-n.xmin&&(G=m.getMetersPerUnitForSR(n.spatialReference),
n.xmin-=G,n.xmax+=G);0===n.ymax-n.ymin&&(G=m.getMetersPerUnitForSR(n.spatialReference),n.ymin-=G,n.ymax+=G);this.hasZ&&null!=n.zmin&&null!=n.zmax&&0===n.zmax-n.zmin&&(G=m.getMetersPerUnitForSR(n.spatialReference),n.zmin-=G,n.zmax+=G);return[2,{count:d,extent:n}];case 8:F=C.sent();if(F===H.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw F;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,
function(c){return[2,this.executeQueryForIdSet(a,b).then(function(a){return n.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,e,d,l,v=this;return r.__generator(this,function(m){switch(m.label){case 0:b=g.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,m.label=1;case 1:return m.trys.push([1,9,,10]),[4,this._schedule(function(){return H.normalizeQuery(b,v.definitionExpression,v.spatialReference)})];
case 2:return b=m.sent(),[4,this._reschedule(function(){return v._checkQuerySupport(b)})];case 3:return b=m.sent(),[4,this._reschedule(function(){return v._executeGeometryQuery(b)})];case 4:return c=m.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=m.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=m.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=m.sent(),e=c.items,d=new Set,
[4,this._reschedule(function(){for(var a=0,b=e;a<b.length;a++)d.add(c.featureAdapter.getObjectId(b[a]))})];case 8:return m.sent(),[2,d];case 9:l=m.sent();if(l===H.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw l;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){void 0===a&&(a={});return r.__awaiter(this,void 0,void 0,function(){var b,c,e,d=this;return r.__generator(this,function(l){switch(l.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new q("feature-store:unsupported-query",
"Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});b=g.clone(a);l.label=1;case 1:return l.trys.push([1,9,,10]),[4,this._schedule(function(){return H.normalizeQuery(b,d.definitionExpression,d.spatialReference)})];case 2:return b=l.sent(),[4,this._reschedule(function(){return d._checkQuerySupport(b)})];case 3:return b=l.sent(),[4,this._reschedule(function(){return d._executeGeometryQuery(b)})];case 4:return c=l.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];
case 5:return c=l.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=l.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=l.sent(),[4,this._reschedule(function(){return c.filterLatest()})];case 8:return c=l.sent(),[3,10];case 9:e=l.sent();if(e!==H.QUERY_ENGINE_EMPTY_RESULT)throw e;c=new k.default([],null,this);return[3,10];case 10:return[2,c.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return r.__awaiter(this,
void 0,void 0,function(){return r.__generator(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=
[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new k.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return r.__awaiter(this,void 0,void 0,function(){var b,e,d,l,g,v,m,n,G,F,C,t,q,da,w,u,B,P,A,L,H=this;return r.__generator(this,function(pa){switch(pa.label){case 0:b=a.geometry;e=a.outSR;d=a.spatialRel;l=p.isValid(e)&&!p.equals(this.spatialReference,e);if(g=this._geometryQueryCache?l?JSON.stringify({geometry:b,spatialRelationship:d,
outSpatialReference:e}):JSON.stringify({geometry:b,spatialRelationship:d}):null)if(v=this._geometryQueryCache.get(g),!c.isUndefined(v))return[2,v];m=function(b){return r.__awaiter(H,void 0,void 0,function(){var c;return r.__generator(this,function(d){switch(d.label){case 0:return l&&(a.returnGeometry||a.returnCentroid)?[4,b.project(e)]:[3,2];case 1:return c=d.sent(),g&&this._geometryQueryCache.put(g,c,c.size||1),[2,c];case 2:return g&&this._geometryQueryCache.put(g,b,b.size||1),[2,b]}})})};if(!b)return[2,
m(this._getAll())];n=this.featureAdapter;if("esriSpatialRelDisjoint"!==d)return[3,3];G=this._searchFeatures(this._getQueryBBoxes(b));if(!G.length)return[2,m(this._getAll())];t=new Set;q=0;for(da=G;q<da.length;q++)w=da[q],t.add(n.getObjectId(w));return[4,this._reschedule(function(){var a=0;F=Array(t.size);H.featureStore.forEach(function(b){return F[a++]=b});C=t})];case 1:return pa.sent(),[4,this._reschedule(function(){return r.__awaiter(H,void 0,void 0,function(){var a,c,e;return r.__generator(this,
function(l){switch(l.label){case 0:return[4,J.getSpatialQueryOperator(d,b,this.geometryType,this.hasZ,this.hasM)];case 1:return a=l.sent(),c=function(b){return!C.has(n.getObjectId(b))||a(n.getGeometry(b))},e=k.default.bind,[4,this._runSpatialFilter(F,c)];case 2:return[2,new (e.apply(k.default,[void 0,l.sent(),b,this]))]}})})})];case 2:return u=pa.sent(),[2,m(u)];case 3:return B=this._searchFeatures(this._getQueryBBoxes(b)),B.length?(P=this._canExecuteSoloPass(b,a))?[2,m(new k.default(B,b,this))]:
[4,J.getSpatialQueryOperator(d,b,this.geometryType,this.hasZ,this.hasM)]:(u=new k.default([],b,this),g&&this._geometryQueryCache.put(g,u,u.size||1),[2,u]);case 4:return A=pa.sent(),[4,this._runSpatialFilter(B,function(a){return A(n.getGeometry(a))})];case 5:return L=pa.sent(),[2,m(new k.default(L,b,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return r.__awaiter(this,void 0,void 0,function(){var c,e,d,l=this;return r.__generator(this,function(g){if(!b)return[2,a];if(!this._budget)return[2,
a.filter(function(a){return b(a)})];c=0;e=[];d=function(){return r.__awaiter(l,void 0,void 0,function(){var l;return r.__generator(this,function(g){switch(g.label){case 0:if(!(c<a.length))return[3,3];l=a[c];b(l)&&e.push(l);return this._budget.done?[4,this._reschedule(function(){return d()})]:[3,2];case 1:g.sent(),g.label=2;case 2:return++c,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return d()}).then(function(){return e})]})})};a.prototype._canExecuteSoloPass=function(a,b){var c=
this.geometryType;b=b.spatialRel;return J.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(J.canQueryWithRBush(a)){if(t.isExtent(a))return[e.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(t.isPolygon(a))return a.rings.map(function(a){return e.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),
Math.max(a[0][1],a[2][1]))})}return[u.getBoundsXY(e.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){P.add(a)});var c=Array(P.size),e=0;P.forEach(function(a){return c[e++]=a});P.clear();return c};a.prototype._checkQuerySupport=function(a){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||
a.text)throw new q("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,b.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),J.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),E.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,e=a.returnDistinctValues,d=a.outStatistics,l=d?d.map(function(a){return a.outStatisticFieldName&&
a.outStatisticFieldName.toLowerCase()}):[];c&&0<c.length&&(c=c.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?b.split(" asc")[0]:-1<b.indexOf(" desc")?b.split(" desc")[0]:a}).filter(function(a){return-1===l.indexOf(a)}),D.validateFields(this.fieldsIndex,c,"orderByFields contains missing fields"));if(b&&0<b.length)D.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(e)throw new q("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",
{query:a});D.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return r.__awaiter(this,void 0,void 0,function(){var b,c,e,d,l,g,v,m,n,k,G,F,p;return r.__generator(this,function(C){b=a.outStatistics;c=a.groupByFieldsForStatistics;e=a.having;d=c&&c.length;l=b&&b.length;if(e){if(!d||!l)throw new q("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});D.validateHaving(this.fieldsIndex,e,b)}if(l){if(!K(b))return[2];
g=b.map(function(a){return a.onStatisticField});D.validateFields(this.fieldsIndex,g,"onStatisticFields contains missing fields");d&&D.validateFields(this.fieldsIndex,c,"groupByFieldsForStatistics contains missing fields");v=0;for(m=b;v<m.length;v++)if(n=m[v],k=n.onStatisticField,G=n.statisticType,(F="percentile_disc"===G||"percentile_cont"===G)&&"statisticParameters"in n){if(p=n.statisticParameters,!p)throw new q("feature-store:unsupported-query","statisticParamters should be set for percentile type",
{definition:n,query:a});}else if("count"!==G&&k&&D.hasInvalidFieldType(k,this.fieldsIndex))throw new q("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:n,query:a});}return[2]})})};return a}();a.default=x;var v=w.create(),l=w.create()})},"esri/core/MemCache":function(){define(["require","exports","./MapUtils","./PooledArray","./string"],function(x,a,r,q,g){Object.defineProperty(a,"__esModule",{value:!0});a.MemCacheStorage=a.MemCache=a.MIN_PRIORITY=void 0;a.MIN_PRIORITY=
-3;x=function(){function a(a,b,c){this._namespace=a;this._storage=b;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";c&&(this._storage.registerRemoveFunc(this._namespace,c),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!1,configurable:!0});
Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!1,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,b,c,g){void 0===
g&&(g=0);this._storage.put(this._namespace+a,b,c,g)};a.prototype.get=function(a){a=this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.updateSize=function(a,b,c){this._storage.updateSize(this._namespace+a,b,c)};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=
function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=x;x=function(){function c(a){void 0===a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new q}c.prototype.register=function(a){this._users.push(a)};c.prototype.deregister=function(a){this._users.removeUnordered(a)};c.prototype.registerRemoveFunc=function(a,b){this._removeFuncs.push([a,b])};c.prototype.deregisterRemoveFunc=
function(a){this._removeFuncs=this._removeFuncs.filter(function(b){return b[0]!==a})};Object.defineProperty(c.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._checkSizeLimit()},enumerable:!1,configurable:!0});c.prototype.put=function(c,b,g,m){var d=this._db.get(c);d&&(this._size-=d.size,this._db.delete(c),d.entry!==b&&this._notifyRemoved(c,
d.entry));g>this._maxSize?this._notifyRemoved(c,b):void 0===b?console.warn("Refusing to cache undefined entry "):!g||0>g?console.warn("Refusing to cache entry with invalid size "+g):(m=1+Math.max(m,a.MIN_PRIORITY)-a.MIN_PRIORITY,this._db.set(c,{entry:b,size:g,lifetime:m,lives:m}),this._size+=g,this._checkSizeLimit())};c.prototype.updateSize=function(a,b,c){var d=this._db.get(a);d&&d.entry===b&&(this._size-=d.size,c>this._maxSize?this._notifyRemoved(a,b):(d.size=c,this._size+=c,this._checkSizeLimit()))};
c.prototype.pop=function(a){var b=this._db.get(a);if(b)return this._size-=b.size,this._db.delete(a),++this._hit,b.entry;++this._miss};c.prototype.get=function(a){var b=this._db.get(a);if(void 0===b)++this._miss;else return this._db.delete(a),b.lives=b.lifetime,this._db.set(a,b),++this._hit,b.entry};c.prototype.getStats=function(){var c=this,b={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},
n={},m=[];this._db.forEach(function(a,b){var e=a.lifetime;m[e]=(m[e]||0)+a.size;c._users.forEachSimple(function(c){c=c.namespace;g.startsWith(b,c)&&(n[c]=(n[c]||0)+a.size)})});var q={};this._users.forEachSimple(function(a){var b=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(n[b]=n[b]||0,q[b]=Math.round(100*a.hitRate)+"%"):q[b]="0%"});var e=Object.keys(n);e.forEach(function(a){return n[a]=n[a]/c._size*100});e.sort(function(a,b){return n[b]-n[a]});e.forEach(function(a){return b[a]=Math.round(n[a])+"% / "+
q[a]});for(e=m.length-1;0<=e;--e){var r=m[e];r&&(b["Priority "+(e+a.MIN_PRIORITY-1)]=Math.round(r/this.size*100)+"%")}return b};c.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEachSimple(function(a){return a.resetHitRate()})};c.prototype.clear=function(a){var b=this;this._db.forEach(function(c,d){g.startsWith(d,a)&&(b._size-=c.size,b._db.delete(d),b._notifyRemoved(d,c.entry))})};c.prototype.clearAll=function(){var a=this;this._db.forEach(function(b,c){return a._notifyRemoved(c,
b.entry)});this._size=0;this._db.clear()};c.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};c.prototype._notifyRemoved=function(a,b){this._removeFuncs.forEach(function(c){if(g.startsWith(a,c[0]))c[1](b)})};c.prototype._checkSizeLimit=function(){var a=this;this._size<=this._maxSize||r.someMap(this._db,function(b,c){a._db.delete(c);1>=b.lives?(a._size-=b.size,a._notifyRemoved(c,b.entry)):(--b.lives,a._db.set(c,b));return a._size<=.9*a.maxSize})};return c}();a.MemCacheStorage=
x})},"esri/core/MapUtils":function(){define(["require","exports","./maybe"],function(x,a,r){function q(a){if(0===a.size)throw Error("Map is empty");return a.keys().next().value}function g(a){if(0===a.size)throw Error("Map is empty");var b=void 0,c=!1;a.forEach(function(a,e){c||(b=e,c=!0)});return r.assumeNonNull(b)}function c(a){if(0===a.size)throw Error("Map is empty");return a.values().next().value}function d(a){if(0===a.size)throw Error("Map is empty");var b=void 0,c=!1;a.forEach(function(a){c||
(b=a,c=!0)});return r.assumeNonNull(b)}Object.defineProperty(a,"__esModule",{value:!0});a.test=a.firstValueOfMap=a.firstKeyOfMap=a.MapFromValues=a.keysOfMap=a.valuesOfMap=a.pairsOfMap=a.someMap=void 0;a.someMap=Map.prototype.entries?function(a,b){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(b(c.value[1],c.value[0]))return!0;return!1}:function(a,b){var c=!0;a.forEach(function(a,e){c&&(c=!b(a,e))});return!c};x=!!Map.prototype.values;var b=!!Map.prototype.keys,n=!!Array.from;a.pairsOfMap=function(a){var b=
[];a.forEach(function(a,c){return b.push([c,a])});return b};a.valuesOfMap=x&&n?function(a){return Array.from(a.values())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a){return b[c++]=a});return b};a.keysOfMap=b&&n?function(a){return Array.from(a.keys())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a,e){return b[c++]=e});return b};a.MapFromValues=x?function(a){return new Map(a)}:function(a){for(var b=new Map,c=0;c<a.length;c++){var d=a[c];b.set(d[0],d[1])}return b};a.firstKeyOfMap=
b?q:g;a.firstValueOfMap=x?c:d;a.test={firstKeyOfMapFallback:g,firstValueOfMapFallback:d}})},"esri/core/SetUtils":function(){define(["require","exports","./maybe"],function(x,a,r){function q(a){if(0===a.size)throw Error("Set is empty");return a.values().next().value}function g(a){if(0===a.size)throw Error("Set is empty");var b=void 0,c=!1;a.forEach(function(a){c||(b=a,c=!0)});return r.assumeNonNull(b)}Object.defineProperty(a,"__esModule",{value:!0});a.reduceSet=a.firstOfSet=a.SetFromValues=a.valuesOfSet=
a.someSet=void 0;a.someSet=Set.prototype.entries?function(a,b){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(b(c.value[0]))return!0;return!1}:function(a,b){var c=!0;a.forEach(function(a){c&&(c=!b(a))});return!c};x=!!Set.prototype.values;var c=!!Array.from;a.valuesOfSet=x&&c?function(a){return Array.from(a.values())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a){return b[c++]=a});return b};a.SetFromValues=x?function(a){return new Set(a)}:function(a){for(var b=new Set,c=0;c<a.length;c++)b.add(a[c]);
return b};a.firstOfSet=x?q:g;a.reduceSet=function(a,b,c){var d=c;a.forEach(function(a){return d=b(a,d)});return d}})},"esri/core/unitUtils":function(){define("require exports ./compilerUtils ./jsonMap ./SetUtils ../geometry/support/geodesicConstants ../geometry/support/WKIDUnitConversion".split(" "),function(x,a,r,q,g,c,d){function b(a){if(a=C[a])return a;throw Error("unknown measure");}function n(a){return P[a].baseUnit}function m(a,c){void 0===c&&(c=null);c=c||b(a);return P[c].baseUnit===a}function w(a,
c,l){if(c===l)return a;var e=b(c);if(e!==b(l))throw Error("incompatible units");a=m(c,e)?a:a*P[e].units[c].inBaseUnits;return m(l,e)?a:a/P[e].units[l].inBaseUnits}function e(a,b){return 3E3>w(a,b,"meters")?"meters":"kilometers"}function u(a,b){return 1E5>w(a,b,"meters")?"meters":"kilometers"}function t(a,b){return 1E3>w(a,b,"feet")?"feet":"miles"}function p(a,b){return 1E5>w(a,b,"feet")?"feet":"miles"}function D(a){return K.fromJSON(a.toLowerCase())||null}function E(a,b){void 0===b&&(b=J);return A(a,
!0)||b}function A(a,b){void 0===b&&(b=!1);var c,e,d;null!=a&&("object"===typeof a?(c=a.wkid,e=a.wkt):"number"===typeof a?c=a:"string"===typeof a&&(e=a));c?(d=L.values[L[c]],!d&&b&&B.has(c)&&(d=O)):e&&-1!==e.search(/^PROJCS/i)&&(a=H.exec(e))&&a[1]&&(d=parseFloat(a[1].split(",")[1]));return d}function k(a){var b,c,e;null!=a&&("object"===typeof a?(b=a.wkid,c=a.wkt):"number"===typeof a?b=a:"string"===typeof a&&(c=a));b?e=L.units[L[b]]:c&&-1!==c.search(/^PROJCS/i)&&(a=H.exec(c))&&a[1]&&(e=(a=/[\\"\\']{1}([^\\"\\']+)/.exec(a[1]))&&
a[1]);return e?D(e):null}Object.defineProperty(a,"__esModule",{value:!0});a.getDefaultUnitSystem=a.getUnitString=a.getMetersPerUnit=a.getMetersPerUnitForSR=a.getVerticalUnitStringForSR=a.getMetersPerVerticalUnitForSR=a.unitToRESTJSON=a.unitFromRESTJSON=a.lengthToDegrees=a.preferredImperialAreaUnit=a.preferredMetricAreaUnit=a.preferredImperialVerticalLengthUnit=a.preferredImperialLengthUnit=a.preferredMetricVerticalLengthUnit=a.preferredMetricLengthUnit=a.preferredVerticalLengthUnit=a.preferredLengthUnit=
a.convertUnit=a.isBaseUnit=a.baseUnitForUnit=a.baseUnitForMeasure=a.measureForUnit=a.measurementLengthUnits=a.measurementAreaUnits=a.inchesPerMeter=void 0;a.inchesPerMeter=39.37;var J=c.metersPerDegree,O=c.earthRadius*Math.PI/200,H=/UNIT\[([^\]]+)\]\]$/i,L=d,B=g.SetFromValues([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),K=q.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",
foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});x={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},
yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};q={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:function(a){return a*
a}(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};var P={length:{baseUnit:"meters",units:x},area:{baseUnit:"square-meters",units:q},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*
304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},C=function(){var a={},b;for(b in P)for(var c in P[b].units)a[c]=b;return a}();a.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");a.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");
a.measureForUnit=b;a.baseUnitForMeasure=n;a.baseUnitForUnit=function(a){return n(b(a))};a.isBaseUnit=m;a.convertUnit=w;a.preferredLengthUnit=function(a,b,c){switch(c){case "metric":return e(a,b);case "imperial":return t(a,b);default:return c}};a.preferredVerticalLengthUnit=function(a,b,c){switch(c){case "metric":return u(a,b);case "imperial":return p(a,b);default:return c}};a.preferredMetricLengthUnit=e;a.preferredMetricVerticalLengthUnit=u;a.preferredImperialLengthUnit=t;a.preferredImperialVerticalLengthUnit=
p;a.preferredMetricAreaUnit=function(a,b){return 3E6>w(a,b,"square-meters")?"square-meters":"square-kilometers"};a.preferredImperialAreaUnit=function(a,b){return 1E6>w(a,b,"square-feet")?"square-feet":"square-miles"};a.lengthToDegrees=function(a,b,e){void 0===e&&(e=c.earthRadius);return w(a,b,"meters")/(e*Math.PI/180)};a.unitFromRESTJSON=D;a.unitToRESTJSON=function(a){return K.toJSON(a)||null};a.getMetersPerVerticalUnitForSR=function(a){a=E(a);return 1E5<a?1:a};a.getVerticalUnitStringForSR=function(a){return 1E5<
E(a)?"meters":k(a)};a.getMetersPerUnitForSR=E;a.getMetersPerUnit=A;a.getUnitString=k;a.getDefaultUnitSystem=function(a){if(!a)return null;a=k(a);switch(a){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";case "50-kilometers":case "150-kilometers":case "meters":return"metric";
case null:case void 0:break;default:r.neverReached(a)}return null}})},"esri/layers/graphics/data/attributeSupport":function(){define(["require","exports","../../../core/Error","../../../core/SetUtils","../../../core/sql/WhereClauseCache"],function(x,a,r,q,g){function c(a,b){return a?n.get(a,b):null}function d(a,e,g,m){void 0===m&&(m=!0);for(var n=[],q=0;q<e.length;q++){var t=e[q];if("*"!==t&&!a.has(t))if(m){var w=b(t);try{var k=c(w,a);if(!k)throw new r("feature-store:unsupported-query","invalid SQL expression",
{where:w});if(!k.isStandardized)throw new r("feature-store:unsupported-query","expression is not standard",{clause:k});d(a,k.fieldNames,"expression contains missing fields")}catch(J){if((w=J&&J.details)&&(w.clause||w.where))throw J;w&&w.missingFields?n.push.apply(n,w.missingFields):n.push(t)}}else n.push(t)}if(n.length)throw new r("feature-store:unsupported-query",g,{missingFields:n});}function b(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});a.hasInvalidFieldType=a.getAliasFromFieldName=
a.getExpressionFromFieldName=a.validateFields=a.getWhereClause=a.validateHaving=a.validateWhere=void 0;var n=new g.WhereClauseCache(50,500),m=q.SetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;var c=n.get(b,a);if(!c)throw new r("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new r("feature-store:unsupported-query",
"where clause is not standard",{where:b});d(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var e=n.get(b,a);if(!e)throw new r("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!e.isAggregate)throw new r("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:b});d(a,e.fieldNames,"having contains missing fields");if(!e.getExpressions().every(function(b){var e=b.aggregateType;
b=b.field;var d=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===d&&b.toLowerCase().trim()===e})}))throw new r("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=c;a.validateFields=d;a.getExpressionFromFieldName=b;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!m.has(a.type):
!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(x,a,r,q){Object.defineProperty(a,"__esModule",{value:!0});a.WhereClauseCache=void 0;x=function(){function a(a,d){this._cache=new r(a);this._invalidCache=new r(d)}a.prototype.get=function(a,d){var b=d.uid+":"+a,c=this._cache.get(b);if(c)return c;if(void 0!==this._invalidCache.get(b))return null;try{var g=q.WhereClause.create(a,d);this._cache.put(b,g);return g}catch(w){return this._invalidCache.put(b,
null),null}};return a}();a.WhereClauseCache=x})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(x,a,r){return function(){function a(a,c){this._storage=new r.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};
a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(x,a,r,q,g,c,d){function b(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function n(a,c,e,d,g,m,k,n,C){void 0===e&&(e="0");void 0===d&&(d="0");void 0===g&&(g="0");void 0===m&&(m="0");void 0===k&&(k="");void 0===n&&(n="0");void 0===C&&(C="0");return"+"===
k||"-"===k?(a=b(parseInt(a,10),4)+"-"+b(parseInt(c,10),2)+"-"+b(parseInt(e,10),2),c="",10>parseFloat(m)&&(c="0"),d=b(parseInt(d,10),2)+":"+b(parseInt(g,10),2)+":"+(c+parseFloat(m).toString()),k=""+k+b(parseInt(n,10),2)+":"+b(parseInt(C,10),2),new Date(a+"T"+d+k)):new Date(parseInt(a,10),parseInt(c,10)-1,parseInt(e,10),parseInt(d,10),parseInt(g,10),parseFloat(m))}function m(a){var b=B.exec(a);if(null!==b){a=b[1];var c=b[2],e=b[3],d=b[4],g=b[5],m=b[6];return n(a,c,e,d,g,m)}b=K.exec(a);if(null!==b){a=
b[1];var c=b[2],e=b[3],d=b[4],g=b[5],m=b[6],v=b[7],k=b[8],b=b[9];return n(a,c,e,d,g,m,v,k,b)}b=P.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],d=b[4],g=b[5],v=b[6],k=b[7],b=b[8],n(a,c,e,d,g,"0",v,k,b);b=C.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],d=b[4],g=b[5],n(a,c,e,d,g);b=L.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],n(a,c,e);throw Error("SQL Invalid Timestamp");}function w(a){a=L.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),
parseInt(b,10)-1,parseInt(c,10))}function e(a){return Array.isArray(a)?a:[a]}function u(a){return null!==a?!0!==a:null}function t(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function p(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function D(a,b){if(null==a)return null;for(var c=!1,e=0;e<b.length;e++){var d=b[e];if(null==d)c=null;else if(a===d){c=!0;break}}return c}function E(a,b,c){if(null==a)return null;for(var e="",d=0,l=0;l<b.length;l++){var g=b.charAt(l);
switch(d){case 0:g===c?d=1:e=0<="-[]/{}()*+?.\\^$|".indexOf(g)?e+("\\"+g):"%"===g?e+".*":"_"===g?e+".":e+g;break;case 1:e=0<="-[]/{}()*+?.\\^$|".indexOf(g)?e+("\\"+g):e+g,d=0}}return(new RegExp("^"+e+"$")).test(a)}function A(a){return a instanceof Date?a.valueOf():a}function k(a,b,c){if(null==b||null==c)return null;b=A(b);c=A(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function J(a){for(var b=
[],c={},e=0;e<a.length;e++){var d=a[e],g=d.toLowerCase();void 0===c[g]&&(b.push(d),c[g]=1)}return b}function O(a,b,e){if(b instanceof c.SqlInterval)if(e instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+e.getTime());case "-":return b.valueInMilliseconds()-e.getTime();case "*":return b.valueInMilliseconds()*e.getTime();case "/":return b.valueInMilliseconds()/e.getTime()}else if(e instanceof c.SqlInterval)switch(a){case "+":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+
e.valueInMilliseconds());case "-":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-e.valueInMilliseconds());case "*":return b.valueInMilliseconds()*e.valueInMilliseconds();case "/":return b.valueInMilliseconds()/e.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(e instanceof c.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(e.valueInMilliseconds()+b.getTime());case "-":return new Date(b.getTime()-e.valueInMilliseconds());case "*":return b.getTime()*
e.valueInMilliseconds();case "/":return b.getTime()/e.valueInMilliseconds()}else e=e.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof e)switch(e*=864E5,b=b.getTime(),a){case "+":return new Date(b+e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/e)}else if(e instanceof Date&&"number"===typeof b)switch(b*=864E5,e=e.getTime(),a){case "+":return new Date(b+e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/
e)}switch(a){case "+":return b+e;case "-":return b-e;case "*":return b*e;case "/":return b/e}}function H(a,b,c,e){a=e.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});a.defaultAttributeAdapter=a.WhereClause=void 0;var L=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,B=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,K=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,P=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,
C=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,F=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,e){return H(a,b,c,e)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return E(a,b,c)};a.ensureArray=function(a){return e(a)};a.applyIn=function(a,b){return D(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=function(a,b,e){return c.SqlInterval.createFromValueAndQualifer(a,b,e)};a.convertInterval=
function(a){return a instanceof c.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return k(a,b,c)};a.calculate=function(a,b,c){return O(a,b,c)};a.makeComparable=function(a){return A(a)};a.evaluateFunction=function(a,b){return c.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==
b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return u(a)};a.ternaryAnd=function(a,b){return t(a,b)};a.ternaryOr=function(a,b){return p(a,b)};return a}();x=function(){function b(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=d.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;this.isStandardized=b;this.isAggregate=c}b.create=function(a,c){return new b(a,c)};Object.defineProperty(b.prototype,
"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!1,configurable:!0});b.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var e={},d=function(a){e[a]=b.map(function(b){return c.getAttribute(b,a)})},g=0,l=this.fieldNames;g<l.length;g++)d(l[g]);return!!this.evaluateNode(this.parseTree,{attributes:e},a.defaultAttributeAdapter)};b.prototype.calculateValue=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,e);
return b instanceof c.SqlInterval?b.valueInMilliseconds()/864E5:b};b.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(r("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};b.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);
return!!this.evaluateNode(this.parseTree,b,c)};b.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(r("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};b.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===
b.type&&a.push(b.name.toLowerCase())});return J(a)};b.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var e=c+"-"+b;a.has(e)||a.set(e,{aggregateType:c,field:b})}}});return q.valuesOfMap(a)};b.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return J(a)};b.prototype.compileMe=
function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(F)};b.prototype.extractExpressionInfo=function(a){var b=this,e=[],d=!0,l=!0;this.visitAll(this.parseTree,function(m){switch(m.type){case "column_ref":var k=a.get(m.column),n=k&&k.name;!k||"date"!==k.type&&"esriFieldTypeDate"!==k.type||(b.datefields[k.name]=1);void 0!==n?(e.push(n),m.column=n):e.push(m.column);
break;case "function":k=m.name,m=m.args.value.length,d&&(d=c.isStandardized(k,m)),l&&(l=g.isAggregate(k,m))}});return{referencedFieldNames:J(e),isStandardized:d,isAggregate:l}};b.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,e=a.clauses;c<e.length;c++){var d=e[c];this.visitAll(d,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;
case "expr_list":c=0;for(a=a.value;c<a.length;c++)d=a[c],this.visitAll(d,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};b.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===
a.format)for(var c="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",e=0;e<a.clauses.length;e++)b+=" ("+c+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[e].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[e].value)+") : ";else for(b="( ",e=0;e<a.clauses.length;e++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[e].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[e].value)+") : ";b=null!==a.else?b+
this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";c=0;for(a=a.value;c<a.length;c++)e=a[c],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(e);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+
this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+
","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+
JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+w(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+m(a.value).getTime().toString()+"))";case "current_time":return"date"===a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+
JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};b.prototype.evaluateNode=function(a,b,d){switch(a.type){case "interval":return b=this.evaluateNode(a.value,b,d),c.SqlInterval.createFromValueAndQualifer(b,a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var l=A(this.evaluateNode(a.operand,b,d)),n=0;n<a.clauses.length;n++){if(l===
A(this.evaluateNode(a.clauses[n].operand,b,d)))return this.evaluateNode(a.clauses[n].value,b,d)}else for(n=0;n<a.clauses.length;n++)if(!0===this.evaluateNode(a.clauses[n].operand,b,d))return this.evaluateNode(a.clauses[n].value,b,d);return null!==a.else?this.evaluateNode(a.else,b,d):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":l=[];n=0;for(a=a.value;n<a.length;n++)l.push(this.evaluateNode(a[n],b,d));return l;case "unary_expr":return u(this.evaluateNode(a.expr,b,
d));case "binary_expr":switch(a.operator){case "AND":return t(this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d));case "OR":return p(this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,b,d);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,b,d);case "IN":return l=e(this.evaluateNode(a.right,b,d)),D(this.evaluateNode(a.left,
b,d),l);case "NOT IN":return l=e(this.evaluateNode(a.right,b,d)),u(D(this.evaluateNode(a.left,b,d),l));case "BETWEEN":return l=this.evaluateNode(a.left,b,d),a=this.evaluateNode(a.right,b,d),null==l||null==a[0]||null==a[1]?null:l>=A(a[0])&&l<=A(a[1]);case "NOTBETWEEN":return l=this.evaluateNode(a.left,b,d),a=this.evaluateNode(a.right,b,d),null==l||null==a[0]||null==a[1]?null:l<A(a[0])||l>A(a[1]);case "LIKE":return E(this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d),a.escape);case "NOT LIKE":return u(E(this.evaluateNode(a.left,
b,d),this.evaluateNode(a.right,b,d),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return k(a.operator,this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d));case "-":case "+":case "*":case "/":return O(a.operator,this.evaluateNode(a.left,b,d),this.evaluateNode(a.right,b,d))}case "null":case "bool":case "string":case "number":return a.value;case "date":return w(a.value);case "timestamp":return m(a.value);case "current_time":return b=new Date,
"date"===a.mode&&b.setHours(0,0,0,0),b;case "column_ref":return H(b,a.column,this.datefields,d);case "function":return b=this.evaluateNode(a.args,b,d),this.isAggregate?g.aggregateFunction(a.name,b):c.evaluateFunction(a.name,b)}throw Error("Unsupported sql syntax "+a.type);};return b}();a.WhereClause=x;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(x,
a){function r(a){for(var c=0,b=0;b<a.length;b++)c+=a[b];return c/a.length}function q(a){for(var c=r(a),b=a.length,g=0,m=0;m<a.length;m++)g+=Math.pow(a[m]-c,2);return 1<b?g/(b-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.isAggregate=a.aggregateFunction=void 0;a.aggregateFunction=function(a,d){var b=g[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(d.length<b.minParams||d.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(d)};
a.isAggregate=function(a,d){a=g[a.toLowerCase()];return null!=a&&d>=a.minParams&&d<=a.maxParams};var g={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:r(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var c=0,b=0;b<a.length;b++)c+=
a[b];a=c}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(q(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:q(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(x,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.isStandardized=a.evaluateFunction=a.SqlInterval=void 0;
x=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(c){var d=new a;d.second=c/1E3;return d};a.createFromValueAndQualifer=function(c,d,b){var g=null,m=new a;m.op="-"===b?"-":"+";if("interval-period"===d.type){a.fixDefaults(d);if("year"===d.period||"month"===d.period)throw Error("Year-Month Intervals not supported");
if(/^[0-9]{1,}$/.test(c))m[d.period]=parseFloat(c);else throw Error("Illegal Interval");}else{a.fixDefaults(d.start);a.fixDefaults(d.end);if("year"===d.start.period||"month"===d.start.period)throw Error("Year-Month Intervals not supported");if("year"===d.end.period||"month"===d.end.period)throw Error("Year-Month Intervals not supported");switch(d.start.period){case "day":switch(d.end.period){case "hour":g=/^[0-9]{1,} [0-9]{1,}$/;if(g.test(c))m[d.start.period]=parseFloat(c.split(" ")[0]),m[d.end.period]=
parseFloat(c.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(g.test(c))m[d.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),m.hour=parseFloat(c[0]),m.minute=parseFloat(c[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(c))m[d.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),m.hour=parseFloat(c[0]),m.minute=
parseFloat(c[1]),m.second=parseFloat(c[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(d.end.period){case "minute":g=/^[0-9]{1,}:[0-9]{1,}$/;if(g.test(c))m.hour=parseFloat(c.split(":")[0]),m.minute=parseFloat(c.split(":")[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(c))c=c.split(":"),m.hour=parseFloat(c[0]),m.minute=parseFloat(c[1]),m.second=parseFloat(c[2]);
else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(d.end.period){case "second":g=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(c))c=c.split(":"),m.minute=parseFloat(c[0]),m.second=parseFloat(c[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return m};a.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+
864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=x;a.evaluateFunction=function(a,c){var d=q[a.toLowerCase()];if(null==d)throw Error("Function Not Recognised");if(c.length<d.minParams||c.length>d.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return d.evaluate(c)};a.isStandardized=function(a,c){a=q[a.toLowerCase()];return null!=a&&c>=a.minParams&&c<=a.maxParams};var q={extract:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];
a=a[1];if(null==a)return null;if(a instanceof Date)switch(c.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var c=a[0],d=a[1];return null==c||null==d?null:c.toString().substring(d-1)}if(3===a.length)return c=
a[0],d=a[1],a=a[2],null==c||null==d||null==a?null:0>=a?"":c.toString().substring(d-1,d+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];return null==c||null==a?null:a.indexOf(c)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var c=3===a.length,d=c?a[1]:" ",c=c?a[2]:a[1];if(null==d||null==c)return null;d="("+r.escapeRegExpString(d)+")";switch(a[0]){case "BOTH":return c.replace(new RegExp("^"+d+"*|"+d+"*$","g"),"");case "LEADING":return c.replace(new RegExp("^"+
d+"*","g"),"");case "TRAILING":return c.replace(new RegExp(d+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var c=a[0];a=2===a.length?
Math.pow(10,a[1]):1;return null==c?null:Math.round(c*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var c="",d=0;d<a.length;d++){if(null==a[d])return null;c+=a[d].toString()}return c}},lower:{minParams:1,
maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(x,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.WhereGrammar=void 0;x=function(){function a(){}a.parse=function(a){return r.parse(a)};return a}();a.WhereGrammar=x})},"esri/core/sql/sql92grammar":function(){(function(x,
a){"function"===typeof define&&define.amd?define([],a):"object"===typeof module&&module.exports&&(module.exports=a())})(this,function(){function x(a,r,q,g){this.message=a;this.expected=r;this.found=q;this.location=g;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,x)}(function(a,r){function q(){this.constructor=a}q.prototype=r.prototype;a.prototype=new q})(x,Error);x.buildMessage=function(a,r){function q(a){return a.charCodeAt(0).toString(16).toUpperCase()}
function g(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+q(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+q(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+
q(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+q(a)})}var d={literal:function(a){return'"'+g(a.text)+'"'},"class":function(a){var b="",d;for(d=0;d<a.parts.length;d++)b+=a.parts[d]instanceof Array?c(a.parts[d][0])+"-"+c(a.parts[d][1]):c(a.parts[d]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var g=
c,e;e=a[c];e=d[e.type](e);b[g]=e}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(r?'"'+g(r)+'"':"end of input")+" found."};return{SyntaxError:x,parse:function(a,r){function q(a,b){return{type:"literal",text:a,ignoreCase:b}}function g(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function c(b){var c=Oa[b],
f;if(!c){for(f=b-1;!Oa[f];)f--;c=Oa[f];for(c={line:c.line,column:c.column};f<b;)10===a.charCodeAt(f)?(c.line++,c.column=1):c.column++,f++;Oa[b]=c}return c}function d(a,b){var f=c(a),e=c(b);return{start:{offset:a,line:f.line,column:f.column},end:{offset:b,line:e.line,column:e.column}}}function b(a){h<sa||(h>sa&&(sa=h,Pa=[]),Pa.push(a))}function n(){var a,b,c;a=h;b=z();b!==f?(b=w(),b!==f?(c=z(),c!==f?a=b:(h=a,a=f)):(h=a,a=f)):(h=a,a=f);return a}function m(){var a,b,c,e,d,g,l,k;a=h;b=w();if(b!==f){c=
[];e=h;d=z();d!==f?(g=oa(),g!==f?(l=z(),l!==f?(k=w(),k!==f?e=d=[d,g,l,k]:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f);for(;e!==f;)c.push(e),e=h,d=z(),d!==f?(g=oa(),g!==f?(l=z(),l!==f?(k=w(),k!==f?e=d=[d,g,l,k]:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f);if(c!==f){a={type:"expr_list"};b=[b];for(e=0;e<c.length;e++)b.push(c[e][3]);a.value=b}else h=a,a=f}else h=a,a=f;return a}function w(){var a,b,c,d,g,l,k,m;a=h;b=e();if(b!==f){c=[];d=h;g=z();g!==f?(l=ba(),l!==f?(k=z(),k!==f?(m=e(),m!==f?d=g=[g,l,k,m]:(h=
d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);for(;d!==f;)c.push(d),d=h,g=z(),g!==f?(l=ba(),l!==f?(k=z(),k!==f?(m=e(),m!==f?d=g=[g,l,k,m]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function e(){var a,b,c,e,d,g,l,k;a=h;b=u();if(b!==f){c=[];e=h;d=z();d!==f?(g=S(),g!==f?(l=z(),l!==f?(k=u(),k!==f?e=d=[d,g,l,k]:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f);for(;e!==f;)c.push(e),e=h,d=z(),d!==f?(g=S(),g!==f?(l=z(),l!==f?(k=u(),k!==f?e=d=[d,g,l,k]:(h=e,e=f)):(h=e,
e=f)):(h=e,e=f)):(h=e,e=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function u(){var c,e,d,g,l;c=h;e=Y();e===f&&(e=h,33===a.charCodeAt(h)?(d=ad,h++):(d=f,0===y&&b(bd)),d!==f?(g=h,y++,61===a.charCodeAt(h)?(l=lb,h++):(l=f,0===y&&b(mb)),y--,l===f?g=void 0:(h=g,g=f),g!==f?e=d=[d,g]:(h=e,e=f)):(h=e,e=f));e!==f?(d=z(),d!==f?(g=u(),g!==f?c=e={type:"unary_expr",operator:"NOT",expr:g}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f);if(c===f)if(c=h,e=E(),e!==f)if(d=z(),d!==f){var k,n,C;d=[];g=h;l=z();l!==f?(k=t(),
k!==f?(n=z(),n!==f?(C=E(),C!==f?g=l=[l,k,n,C]:(h=g,g=f)):(h=g,g=f)):(h=g,g=f)):(h=g,g=f);if(g!==f)for(;g!==f;)d.push(g),g=h,l=z(),l!==f?(k=t(),k!==f?(n=z(),n!==f?(C=E(),C!==f?g=l=[l,k,n,C]:(h=g,g=f)):(h=g,g=f)):(h=g,g=f)):(h=g,g=f);else d=f;d!==f&&(d={type:"arithmetic",tail:d});d===f&&(d=h,g=D(),g!==f?(l=z(),l!==f?(l=fa(),l!==f?(l=z(),l!==f?(l=m(),l!==f?(k=z(),k!==f?(k=ja(),k!==f?d=g={op:g,right:l}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f),d===f&&(d=h,g=D(),g!==f?
(l=z(),l!==f?(l=fa(),l!==f?(l=z(),l!==f?(l=ja(),l!==f?d=g={op:g,right:{type:"expr_list",value:[]}}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f),d===f&&(d=h,g=D(),g!==f?(l=z(),l!==f?(l=P(),l!==f?d=g={op:g,right:l}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f))),d===f&&(d=h,l=Y(),l!==f?(g=z(),g!==f?(g=ma(),g!==f?(k=z(),k!==f?(k=E(),k!==f?(n=z(),n!==f?(n=S(),n!==f?(l=z(),l!==f?(l=E(),l!==f?d=l={op:"NOT"+g,right:{type:"expr_list",value:[k,l]}}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=
f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f),d===f&&(d=h,l=ma(),l!==f?(g=z(),g!==f?(g=E(),g!==f?(k=z(),k!==f?(k=S(),k!==f?(n=z(),n!==f?(n=E(),n!==f?d=l={op:l,right:{type:"expr_list",value:[g,n]}}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)),d===f&&(d=h,g=W(),g!==f?(l=z(),l!==f?(l=Y(),l!==f?(l=z(),l!==f?(l=E(),l!==f?d=g={op:g+"NOT",right:l}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f),d===f&&(d=h,g=W(),g!==f?(l=z(),l!==f?(l=E(),l!==f?d=g={op:g,right:l}:(h=d,d=f)):(h=
d,d=f)):(h=d,d=f)),d===f&&(d=h,g=p(),g!==f?(l=z(),l!==f?(l=da(),l!==f?(k=z(),k!==f?(k=h,a.substr(h,6).toLowerCase()===cd?(n=a.substr(h,6),h+=6):(n=f,0===y&&b(dd)),n!==f?(n=h,y++,C=B(),y--,C===f?n=void 0:(h=n,n=f),n!==f?k="ESCAPE":(h=k,k=f)):(h=k,k=f),k!==f?(k=z(),k!==f?(k=pa(),k!==f?d=g={op:g,right:l,escape:k.value}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f),d===f&&(d=h,g=p(),g!==f?(l=z(),l!==f?(l=da(),l!==f?d=g={op:g,right:l,escape:""}:(h=d,d=f)):(h=d,d=f)):(h=d,
d=f))))));d===f&&(d=null);d!==f?(c=e,e=d,""==e||void 0==e||null==e?e=c:(d=null,e=d="arithmetic"==e.type?Ga(c,e.tail):Na(e.op,c,e.right,e.escape)),c=e):(h=c,c=f)}else h=c,c=f;else h=c,c=f;return c}function t(){var c;a.substr(h,2)===nb?(c=nb,h+=2):(c=f,0===y&&b(ed));c===f&&(62===a.charCodeAt(h)?(c=fd,h++):(c=f,0===y&&b(gd)),c===f&&(a.substr(h,2)===ob?(c=ob,h+=2):(c=f,0===y&&b(hd)),c===f&&(a.substr(h,2)===pb?(c=pb,h+=2):(c=f,0===y&&b(id)),c===f&&(60===a.charCodeAt(h)?(c=jd,h++):(c=f,0===y&&b(kd)),c===
f&&(61===a.charCodeAt(h)?(c=lb,h++):(c=f,0===y&&b(mb)),c===f&&(a.substr(h,2)===qb?(c=qb,h+=2):(c=f,0===y&&b(ld))))))));return c}function p(){var a,b,c,d;a=a=h;b=Y();b!==f?(c=z(),c!==f?(d=Q(),d!==f?a=b=[b,c,d]:(h=a,a=f)):(h=a,a=f)):(h=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=Q());return a}function D(){var a,b,c,d;a=a=h;b=Y();b!==f?(c=z(),c!==f?(d=la(),d!==f?a=b=[b,c,d]:(h=a,a=f)):(h=a,a=f)):(h=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=la());return a}function E(){var a,b,c,d,e,g,l,m;a=h;b=k();if(b!==
f){c=[];d=h;e=z();e!==f?(g=A(),g!==f?(l=z(),l!==f?(m=k(),m!==f?d=e=[e,g,l,m]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);for(;d!==f;)c.push(d),d=h,e=z(),e!==f?(g=A(),g!==f?(l=z(),l!==f?(m=k(),m!==f?d=e=[e,g,l,m]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function A(){var c;43===a.charCodeAt(h)?(c=gc,h++):(c=f,0===y&&b(hc));c===f&&(45===a.charCodeAt(h)?(c=ic,h++):(c=f,0===y&&b(jc)));return c}function k(){var a,b,c,d,e,g,l,k;a=h;b=O();if(b!==f){c=[];
d=h;e=z();e!==f?(g=J(),g!==f?(l=z(),l!==f?(k=O(),k!==f?d=e=[e,g,l,k]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);for(;d!==f;)c.push(d),d=h,e=z(),e!==f?(g=J(),g!==f?(l=z(),l!==f?(k=O(),k!==f?d=e=[e,g,l,k]:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);c!==f?a=b=Ga(b,c):(h=a,a=f)}else h=a,a=f;return a}function J(){var c;42===a.charCodeAt(h)?(c=md,h++):(c=f,0===y&&b(nd));c===f&&(47===a.charCodeAt(h)?(c=od,h++):(c=f,0===y&&b(pd)));return c}function O(){var c,d,e,g,l,k,n;n=pa();if(n===f){var p,v,q,r;p=h;var t,
M,I,u;t=h;M=qa();M!==f?(I=ha(),I!==f?(u=ga(),u!==f?t=M=parseFloat(M+I+u):(h=t,t=f)):(h=t,t=f)):(h=t,t=f);t===f&&(t=h,M=qa(),M!==f?(I=ha(),I!==f?t=M=parseFloat(M+I):(h=t,t=f)):(h=t,t=f),t===f&&(t=h,M=qa(),M!==f?(I=ga(),I!==f?t=M=parseFloat(M+I):(h=t,t=f)):(h=t,t=f),t===f&&(t=h,M=qa(),M!==f&&(M=parseFloat(M)),t=M)));v=t;v!==f?(q=h,y++,r=L(),y--,r===f?q=void 0:(h=q,q=f),q!==f?p=v={type:"number",value:v}:(h=p,p=f)):(h=p,p=f);n=p;if(n===f){var G,J;G=h;var A,O,x,D;A=h;a.substr(h,4).toLowerCase()===qd?(O=
a.substr(h,4),h+=4):(O=f,0===y&&b(rd));O!==f?(x=h,y++,D=B(),y--,D===f?x=void 0:(h=x,x=f),x!==f?A=O=[O,x]:(h=A,A=f)):(h=A,A=f);J=A;J!==f&&(J={type:"bool",value:!0});G=J;if(G===f){G=h;var W,E,Q,S;W=h;a.substr(h,5).toLowerCase()===sd?(E=a.substr(h,5),h+=5):(E=f,0===y&&b(td));E!==f?(Q=h,y++,S=B(),y--,S===f?Q=void 0:(h=Q,Q=f),Q!==f?W=E=[E,Q]:(h=W,W=f)):(h=W,W=f);J=W;J!==f&&(J={type:"bool",value:!1});G=J}n=G;if(n===f){var Y,ba,ma,ca,oa;ba=h;a.substr(h,4).toLowerCase()===ud?(ma=a.substr(h,4),h+=4):(ma=f,
0===y&&b(vd));ma!==f?(ca=h,y++,oa=B(),y--,oa===f?ca=void 0:(h=ca,ca=f),ca!==f?ba=ma=[ma,ca]:(h=ba,ba=f)):(h=ba,ba=f);Y=ba;Y!==f&&(Y={type:"null",value:null});n=Y;if(n===f){var ea,sa,Ca,Ga;ea=h;var Qa,Na,rb,Oa;Qa=h;a.substr(h,4).toLowerCase()===wd?(Na=a.substr(h,4),h+=4):(Na=f,0===y&&b(xd));Na!==f?(rb=h,y++,Oa=B(),y--,Oa===f?rb=void 0:(h=rb,rb=f),rb!==f?Qa=Na="DATE":(h=Qa,Qa=f)):(h=Qa,Qa=f);sa=Qa;sa!==f?(Ca=z(),Ca!==f?(Ga=da(),Ga!==f?ea=sa={type:"date",value:Ga.value}:(h=ea,ea=f)):(h=ea,ea=f)):(h=
ea,ea=f);n=ea;if(n===f){var Ha,La,Xa,Pa;Ha=h;var Ra,Lb,sb,kb;Ra=h;a.substr(h,9).toLowerCase()===yd?(Lb=a.substr(h,9),h+=9):(Lb=f,0===y&&b(zd));Lb!==f?(sb=h,y++,kb=B(),y--,kb===f?sb=void 0:(h=sb,sb=f),sb!==f?Ra=Lb="TIMESTAMP":(h=Ra,Ra=f)):(h=Ra,Ra=f);La=Ra;La!==f?(Xa=z(),Xa!==f?(Pa=da(),Pa!==f?Ha=La={type:"timestamp",value:Pa.value}:(h=Ha,Ha=f)):(h=Ha,Ha=f)):(h=Ha,Ha=f);n=Ha;if(n===f){var U,$a,Mb,Da,Nb,ab,lb,kc;U=h;$a=Ia();$a!==f?(Mb=z(),Mb!==f?(45===a.charCodeAt(h)?(Da=ic,h++):(Da=f,0===y&&b(jc)),
Da===f&&(43===a.charCodeAt(h)?(Da=gc,h++):(Da=f,0===y&&b(hc))),Da!==f?(Nb=z(),Nb!==f?(ab=da(),ab!==f?(lb=z(),lb!==f?(kc=F(),kc!==f?U=$a={type:"interval",value:ab,qualifier:kc,op:Da}:(h=U,U=f)):(h=U,U=f)):(h=U,U=f)):(h=U,U=f)):(h=U,U=f)):(h=U,U=f)):(h=U,U=f);U===f&&(U=h,$a=Ia(),$a!==f?(Mb=z(),Mb!==f?(Da=da(),Da!==f?(Nb=z(),Nb!==f?(ab=F(),ab!==f?U=$a={type:"interval",value:Da,qualifier:ab,op:""}:(h=U,U=f)):(h=U,U=f)):(h=U,U=f)):(h=U,U=f)):(h=U,U=f));n=U}}}}}}c=n;if(c===f){var Z,lc,mb,nb,ob,mc,pb,qb,
Cb,nc,Db,Eb;Z=h;var Sa,Ob,tb,Fb;Sa=h;a.substr(h,7).toLowerCase()===Ad?(Ob=a.substr(h,7),h+=7):(Ob=f,0===y&&b(Bd));Ob!==f?(tb=h,y++,Fb=B(),y--,Fb===f?tb=void 0:(h=tb,tb=f),tb!==f?Sa=Ob="EXTRACT":(h=Sa,Sa=f)):(h=Sa,Sa=f);lc=Sa;if(lc!==f)if(mb=z(),mb!==f)if(nb=fa(),nb!==f)if(ob=z(),ob!==f){var ua;ua=Ma();ua===f&&(ua=ib(),ua===f&&(ua=Ya(),ua===f&&(ua=Za(),ua===f&&(ua=jb(),ua===f&&(ua=Ba())))));mc=ua;mc!==f?(pb=z(),pb!==f?(qb=ka(),qb!==f?(Cb=z(),Cb!==f?(nc=w(),nc!==f?(Db=z(),Db!==f?(Eb=ja(),Eb!==f?Z=lc=
{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:mc},nc]}}:(h=Z,Z=f)):(h=Z,Z=f)):(h=Z,Z=f)):(h=Z,Z=f)):(h=Z,Z=f)):(h=Z,Z=f)):(h=Z,Z=f)}else h=Z,Z=f;else h=Z,Z=f;else h=Z,Z=f;else h=Z,Z=f;c=Z;if(c===f){var X,oc,Gb,Hb,Ib,Pb,Jb,Kb,yc,Qb,zc,ra,bb,pc,qc,rc;X=h;var Ta,Rb,ub,Ac;Ta=h;a.substr(h,9).toLowerCase()===Cd?(Rb=a.substr(h,9),h+=9):(Rb=f,0===y&&b(Dd));Rb!==f?(ub=h,y++,Ac=B(),y--,Ac===f?ub=void 0:(h=ub,ub=f),ub!==f?Ta=Rb="SUBSTRING":(h=Ta,Ta=f)):(h=Ta,Ta=f);oc=Ta;
if(oc!==f)if(Gb=z(),Gb!==f)if(Hb=fa(),Hb!==f)if(Ib=z(),Ib!==f)if(Pb=w(),Pb!==f)if(Jb=z(),Jb!==f)if(Kb=ka(),Kb!==f)if(yc=z(),yc!==f)if(Qb=w(),Qb!==f)if(zc=z(),zc!==f){ra=h;var Ua,Sb,vb,Bc;Ua=h;a.substr(h,3).toLowerCase()===Ed?(Sb=a.substr(h,3),h+=3):(Sb=f,0===y&&b(Fd));Sb!==f?(vb=h,y++,Bc=B(),y--,Bc===f?vb=void 0:(h=vb,vb=f),vb!==f?Ua=Sb="FOR":(h=Ua,Ua=f)):(h=Ua,Ua=f);bb=Ua;bb!==f?(pc=z(),pc!==f?(qc=w(),qc!==f?(rc=z(),rc!==f?ra=bb=[bb,pc,qc,rc]:(h=ra,ra=f)):(h=ra,ra=f)):(h=ra,ra=f)):(h=ra,ra=f);ra===
f&&(ra=null);ra!==f?(bb=ja(),bb!==f?X=oc={type:"function",name:"substring",args:{type:"expr_list",value:ra?[Pb,Qb,ra[2]]:[Pb,Qb]}}:(h=X,X=f)):(h=X,X=f)}else h=X,X=f;else h=X,X=f;else h=X,X=f;else h=X,X=f;else h=X,X=f;else h=X,X=f;else h=X,X=f;else h=X,X=f;else h=X,X=f;else h=X,X=f;c=X;if(c===f){var N,cb,Tb,Ub,Vb,va,Wb,db,Xb,Yb,Cc,sc,Dc,Ec;N=h;cb=ia();cb!==f?(Tb=z(),Tb!==f?(Ub=fa(),Ub!==f?(Vb=z(),Vb!==f?(va=C(),va===f&&(va=null),va!==f?(Wb=z(),Wb!==f?(db=w(),db!==f?(Xb=z(),Xb!==f?(Yb=ka(),Yb!==f?(Cc=
z(),Cc!==f?(sc=w(),sc!==f?(Dc=z(),Dc!==f?(Ec=ja(),Ec!==f?N=cb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==va?"BOTH":va},db,sc]}}:(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f);N===f&&(N=h,cb=ia(),cb!==f?(Tb=z(),Tb!==f?(Ub=fa(),Ub!==f?(Vb=z(),Vb!==f?(va=C(),va===f&&(va=null),va!==f?(Wb=z(),Wb!==f?(db=w(),db!==f?(Xb=z(),Xb!==f?(Yb=ja(),Yb!==f?N=cb={type:"function",
name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==va?"BOTH":va},db]}}:(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f)):(h=N,N=f));c=N;if(c===f){var aa,tc,Fc,Gc,Hc,uc,Ic,Jc,Kc,vc,Lc,Mc;aa=h;var Va,Zb,wb,Nc;Va=h;a.substr(h,8).toLowerCase()===Gd?(Zb=a.substr(h,8),h+=8):(Zb=f,0===y&&b(Hd));Zb!==f?(wb=h,y++,Nc=B(),y--,Nc===f?wb=void 0:(h=wb,wb=f),wb!==f?Va=Zb="POSITION":(h=Va,Va=f)):(h=Va,Va=f);tc=Va;tc!==f?(Fc=z(),Fc!==f?(Gc=fa(),Gc!==f?(Hc=z(),
Hc!==f?(uc=w(),uc!==f?(Ic=z(),Ic!==f?(Jc=la(),Jc!==f?(Kc=z(),Kc!==f?(vc=w(),vc!==f?(Lc=z(),Lc!==f?(Mc=ja(),Mc!==f?aa=tc={type:"function",name:"position",args:{type:"expr_list",value:[uc,vc]}}:(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f)):(h=aa,aa=f);c=aa;if(c===f){var na,$b,Oc,Pc,Qc,eb,Rc,Sc;na=h;var wa,xb,yb,Ea;wa=h;wa=xb=H();if(wa===f)if(wa=h,96===a.charCodeAt(h)?(xb=Tc,h++):(xb=f,0===y&&b(Uc)),xb!==f){yb=[];Vc.test(a.charAt(h))?
(Ea=a.charAt(h),h++):(Ea=f,0===y&&b(Wc));if(Ea!==f)for(;Ea!==f;)yb.push(Ea),Vc.test(a.charAt(h))?(Ea=a.charAt(h),h++):(Ea=f,0===y&&b(Wc));else yb=f;yb!==f?(96===a.charCodeAt(h)?(Ea=Tc,h++):(Ea=f,0===y&&b(Uc)),Ea!==f?wa=xb=yb.join(""):(h=wa,wa=f)):(h=wa,wa=f)}else h=wa,wa=f;$b=wa;$b!==f?(Oc=z(),Oc!==f?(Pc=fa(),Pc!==f?(Qc=z(),Qc!==f?(eb=m(),eb===f&&(eb=null),eb!==f?(Rc=z(),Rc!==f?(Sc=ja(),Sc!==f?na=$b={type:"function",name:$b,args:eb?eb:{type:"expr_list",value:[]}}:(h=na,na=f)):(h=na,na=f)):(h=na,na=
f)):(h=na,na=f)):(h=na,na=f)):(h=na,na=f)):(h=na,na=f);c=na;if(c===f){var ac,R,fb,bc,gb,cc,Ja,xa,zb,Xc,Yc;R=h;fb=Fa();if(fb!==f)if(bc=z(),bc!==f)if(gb=w(),gb!==f)if(cc=z(),cc!==f){Ja=[];for(xa=Aa();xa!==f;)Ja.push(xa),xa=Aa();Ja!==f?(xa=z(),xa!==f?(zb=ta(),zb!==f?R=fb={type:"case_expression",format:"simple",operand:gb,clauses:Ja,else:null}:(h=R,R=f)):(h=R,R=f)):(h=R,R=f)}else h=R,R=f;else h=R,R=f;else h=R,R=f;else h=R,R=f;if(R===f)if(R=h,fb=Fa(),fb!==f)if(bc=z(),bc!==f)if(gb=w(),gb!==f)if(cc=z(),
cc!==f){Ja=[];for(xa=Aa();xa!==f;)Ja.push(xa),xa=Aa();Ja!==f?(xa=z(),xa!==f?(zb=T(),zb!==f?(Xc=z(),Xc!==f?(Yc=ta(),Yc!==f?R=fb={type:"case_expression",format:"simple",operand:gb,clauses:Ja,else:zb.value}:(h=R,R=f)):(h=R,R=f)):(h=R,R=f)):(h=R,R=f)):(h=R,R=f)}else h=R,R=f;else h=R,R=f;else h=R,R=f;else h=R,R=f;ac=R;if(ac===f){var V,hb,dc,Ka,ya,Ab,Zc,$c;V=h;hb=Fa();if(hb!==f)if(dc=z(),dc!==f){Ka=[];for(ya=za();ya!==f;)Ka.push(ya),ya=za();Ka!==f?(ya=z(),ya!==f?(Ab=ta(),Ab!==f?V=hb={type:"case_expression",
format:"searched",clauses:Ka,else:null}:(h=V,V=f)):(h=V,V=f)):(h=V,V=f)}else h=V,V=f;else h=V,V=f;if(V===f)if(V=h,hb=Fa(),hb!==f)if(dc=z(),dc!==f){Ka=[];for(ya=za();ya!==f;)Ka.push(ya),ya=za();Ka!==f?(ya=z(),ya!==f?(Ab=T(),Ab!==f?(Zc=z(),Zc!==f?($c=ta(),$c!==f?V=hb={type:"case_expression",format:"searched",clauses:Ka,else:Ab.value}:(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f)):(h=V,V=f)}else h=V,V=f;else h=V,V=f;ac=V}c=ac;if(c===f){var Bb,Wa,wc,ec,fc;Wa=h;wc=L();if(wc!==f){ec=[];for(fc=K();fc!==f;)ec.push(fc),
fc=K();ec!==f?Wa=wc+=ec.join(""):(h=Wa,Wa=f)}else h=Wa,Wa=f;Bb=Wa;if(Bb!==f){var xc=Bb;Bb=/^CURRENT_DATE$/i.test(xc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(xc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:xc}}c=Bb;c===f&&(c=P(),c===f&&(c=h,d=fa(),d!==f?(e=z(),e!==f?(g=w(),g!==f?(l=z(),l!==f?(k=ja(),k!==f?(g.paren=!0,c=d=g):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)))}}}}}}}return c}function H(){var a,b,c,d;a=h;b=L();if(b!==f){c=[];for(d=
B();d!==f;)c.push(d),d=B();c!==f?a=b+=c.join(""):(h=a,a=f)}else h=a,a=f;return a}function L(){var c;Id.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===y&&b(Jd));return c}function B(){var c;Kd.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===y&&b(Ld));return c}function K(){var c;Md.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===y&&b(Nd));return c}function P(){var c,d,e;c=h;64===a.charCodeAt(h)?(d=Od,h++):(d=f,0===y&&b(Pd));d!==f?(e=H(),e!==f?c=d=[d,e]:(h=c,c=f)):(h=c,c=f);c!==f&&(c={type:"param",value:c[1]});
return c}function C(){var c,d,e;c=h;a.substr(h,7).toLowerCase()===Qd?(d=a.substr(h,7),h+=7):(d=f,0===y&&b(Rd));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="LEADING":(h=c,c=f)):(h=c,c=f);c===f&&(c=h,a.substr(h,8).toLowerCase()===Sd?(d=a.substr(h,8),h+=8):(d=f,0===y&&b(Td)),d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="TRAILING":(h=c,c=f)):(h=c,c=f),c===f&&(c=h,a.substr(h,4).toLowerCase()===Ud?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(Vd)),d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:
(h=d,d=f),d!==f?c="BOTH":(h=c,c=f)):(h=c,c=f)));return c}function F(){var c,d,e;c=h;var g,k;d=h;e=v();e!==f?(g=z(),g!==f?(g=fa(),g!==f?(g=z(),g!==f?(g=G(),g!==f?(k=z(),k!==f?(k=ja(),k!==f?d=e={type:"interval-period",period:e.value,precision:g,secondary:null}:(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f)):(h=d,d=f);d===f&&(d=h,e=v(),e!==f&&(e=Cb(e)),d=e);if(d!==f)if(e=z(),e!==f)if(e=h,a.substr(h,2).toLowerCase()===Wd?(g=a.substr(h,2),h+=2):(g=f,0===y&&b(Xd)),g!==f?(g=h,y++,k=B(),
y--,k===f?g=void 0:(h=g,g=f),g!==f?e="TO":(h=e,e=f)):(h=e,e=f),e!==f)if(e=z(),e!==f){var m;e=h;g=v();g!==f&&(g={type:"interval-period",period:g.value,precision:null,secondary:null});e=g;e===f&&(e=h,g=Ba(),g!==f?(g=z(),g!==f?(g=fa(),g!==f?(g=z(),g!==f?(g=G(),g!==f?(k=z(),k!==f?(k=oa(),k!==f?(k=z(),k!==f?(k=l(),k!==f?(m=z(),m!==f?(m=ja(),m!==f?e=g=Db(g,k):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=Ba(),g!==f?
(g=z(),g!==f?(g=fa(),g!==f?(g=z(),g!==f?(g=G(),g!==f?(k=z(),k!==f?(k=ja(),k!==f?e=g={type:"interval-period",period:"second",precision:g,secondary:null}:(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f)):(h=e,e=f),e===f&&(e=h,g=Ba(),g!==f&&(g={type:"interval-period",period:"second",precision:null,secondary:null}),e=g)));e!==f?c=d={type:"interval-qualifier",start:d,end:e}:(h=c,c=f)}else h=c,c=f;else h=c,c=f;else h=c,c=f;else h=c,c=f;c===f&&(c=h,e=v(),e!==f?(d=z(),d!==f?(d=fa(),d!==f?
(d=z(),d!==f?(d=l(),d!==f?(g=z(),g!==f?(g=ja(),g!==f?c=e={type:"interval-period",period:e.value,precision:d,secondary:null}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f),c===f&&(c=h,e=v(),e!==f&&(e=Cb(e)),c=e,c===f&&(c=h,e=Ba(),e!==f?(d=z(),d!==f?(d=fa(),d!==f?(d=z(),d!==f?(d=G(),d!==f?(g=z(),g!==f?(g=oa(),g!==f?(e=z(),e!==f?(e=l(),e!==f?(g=z(),g!==f?(g=ja(),g!==f?c=e=Db(d,e):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,
c=f)):(h=c,c=f)):(h=c,c=f),c===f&&(c=h,e=Ba(),e!==f?(d=z(),d!==f?(d=fa(),d!==f?(d=z(),d!==f?(d=l(),d!==f?(g=z(),g!==f?(g=ja(),g!==f?c=e={type:"interval-period",period:"second",precision:d,secondary:null}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f)):(h=c,c=f),c===f&&(c=h,e=Ba(),e!==f&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),c=e)))));return c}function v(){var a;a=h;a=Ya();a!==f&&(a={type:"string",value:"day"});a===f&&(a=h,a=Za(),a!==f&&(a={type:"string",
value:"hour"}),a===f&&(a=h,a=jb(),a!==f&&(a={type:"string",value:"minute"}),a===f&&(a=h,a=ib(),a!==f&&(a={type:"string",value:"month"}),a===f&&(a=h,a=Ma(),a!==f&&(a={type:"string",value:"year"})))));return a}function l(){var a;a=M();a!==f&&(a=parseFloat(a));return a}function G(){var a;a=M();a!==f&&(a=parseFloat(a));return a}function da(){var a;a=pa();a===f&&(a=P());return a}function pa(){var c,d,e;c=h;39===a.charCodeAt(h)?(d=Eb,h++):(d=f,0===y&&b(Fb));d===f&&(a.substr(h,2)===Gb?(d=Gb,h+=2):(d=f,0===
y&&b(Yd)));if(d!==f){d=[];e=h;a.substr(h,2)===La?(e=La,h+=2):(e=f,0===y&&b(Hb));e!==f&&(e="'");e===f&&(Ib.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===y&&b(Jb)));for(;e!==f;)d.push(e),e=h,a.substr(h,2)===La?(e=La,h+=2):(e=f,0===y&&b(Hb)),e!==f&&(e="'"),e===f&&(Ib.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===y&&b(Jb)));d!==f?(39===a.charCodeAt(h)?(e=Eb,h++):(e=f,0===y&&b(Fb)),e!==f?c=d={type:"string",value:d.join("")}:(h=c,c=f)):(h=c,c=f)}else h=c,c=f;return c}function za(){var a,b,c;a=h;b=ca();
b!==f?(b=z(),b!==f?(b=w(),b!==f?(c=z(),c!==f?(c=ea(),c!==f?(c=z(),c!==f?(c=w(),c!==f?a=b={type:"when_clause",operand:b,value:c}:(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f);return a}function Aa(){var a,b,c;a=h;b=ca();b!==f?(b=z(),b!==f?(b=w(),b!==f?(c=z(),c!==f?(c=ea(),c!==f?(c=z(),c!==f?(c=w(),c!==f?a=b={type:"when_clause",operand:b,value:c}:(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f)):(h=a,a=f);return a}function T(){var c,d;c=h;var e,g;d=h;a.substr(h,
4).toLowerCase()===Zd?(e=a.substr(h,4),h+=4):(e=f,0===y&&b($d));e!==f?(e=h,y++,g=B(),y--,g===f?e=void 0:(h=e,e=f),e!==f?d="ELSE":(h=d,d=f)):(h=d,d=f);d!==f?(d=z(),d!==f?(d=w(),d!==f?c={type:"else_clause",value:d}:(h=c,c=f)):(h=c,c=f)):(h=c,c=f);return c}function qa(){var c,d,e;c=M();c===f&&(c=h,45===a.charCodeAt(h)?(d=ic,h++):(d=f,0===y&&b(jc)),d===f&&(43===a.charCodeAt(h)?(d=gc,h++):(d=f,0===y&&b(hc))),d!==f?(e=M(),e!==f?c=d=d[0]+e:(h=c,c=f)):(h=c,c=f));return c}function ha(){var c,d;c=h;46===a.charCodeAt(h)?
(d=ae,h++):(d=f,0===y&&b(be));d!==f?(d=M(),d===f&&(d=null),d!==f?c="."+(null!=d?d:""):(h=c,c=f)):(h=c,c=f);return c}function ga(){var c,d,e;d=c=h;ce.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===y&&b(de));e!==f?(ee.test(a.charAt(h))?(e=a.charAt(h),h++):(e=f,0===y&&b(fe)),e===f&&(e=null),e!==f?d="e"+(null===e?"":e):(h=d,d=f)):(h=d,d=f);d!==f?(e=M(),e!==f?c=d+e:(h=c,c=f)):(h=c,c=f);return c}function M(){var a,b;a=[];b=I();if(b!==f)for(;b!==f;)a.push(b),b=I();else a=f;a!==f&&(a=a.join(""));return a}
function I(){var c;ge.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===y&&b(he));return c}function la(){var c,d,e;c=h;a.substr(h,2).toLowerCase()===ie?(d=a.substr(h,2),h+=2):(d=f,0===y&&b(je));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="IN":(h=c,c=f)):(h=c,c=f);return c}function W(){var c,d,e;c=h;a.substr(h,2).toLowerCase()===ke?(d=a.substr(h,2),h+=2):(d=f,0===y&&b(le));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="IS":(h=c,c=f)):(h=c,c=f);return c}function Q(){var c,d,e;
c=h;a.substr(h,4).toLowerCase()===me?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(ne));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="LIKE":(h=c,c=f)):(h=c,c=f);return c}function Y(){var c,d,e;c=h;a.substr(h,3).toLowerCase()===oe?(d=a.substr(h,3),h+=3):(d=f,0===y&&b(pe));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="NOT":(h=c,c=f)):(h=c,c=f);return c}function S(){var c,d,e;c=h;a.substr(h,3).toLowerCase()===qe?(d=a.substr(h,3),h+=3):(d=f,0===y&&b(re));d!==f?(d=h,y++,e=B(),y--,e===
f?d=void 0:(h=d,d=f),d!==f?c="AND":(h=c,c=f)):(h=c,c=f);return c}function ba(){var c,d,e;c=h;a.substr(h,2).toLowerCase()===se?(d=a.substr(h,2),h+=2):(d=f,0===y&&b(te));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="OR":(h=c,c=f)):(h=c,c=f);return c}function ma(){var c,d,e;c=h;a.substr(h,7).toLowerCase()===ue?(d=a.substr(h,7),h+=7):(d=f,0===y&&b(ve));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="BETWEEN":(h=c,c=f)):(h=c,c=f);return c}function ka(){var c,d,e;c=h;a.substr(h,
4).toLowerCase()===we?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(xe));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="FROM":(h=c,c=f)):(h=c,c=f);return c}function ia(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===ye?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(ze));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="TRIM":(h=c,c=f)):(h=c,c=f);return c}function Ia(){var c,d,e;c=h;a.substr(h,8).toLowerCase()===Ae?(d=a.substr(h,8),h+=8):(d=f,0===y&&b(Be));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=
d,d=f),d!==f?c="INTERVAL":(h=c,c=f)):(h=c,c=f);return c}function Ma(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Ce?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(De));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="YEAR":(h=c,c=f)):(h=c,c=f);return c}function ib(){var c,d,e;c=h;a.substr(h,5).toLowerCase()===Ee?(d=a.substr(h,5),h+=5):(d=f,0===y&&b(Fe));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="MONTH":(h=c,c=f)):(h=c,c=f);return c}function Ya(){var c,d,e;c=h;a.substr(h,3).toLowerCase()===
Ge?(d=a.substr(h,3),h+=3):(d=f,0===y&&b(He));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="DAY":(h=c,c=f)):(h=c,c=f);return c}function Za(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Ie?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(Je));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="HOUR":(h=c,c=f)):(h=c,c=f);return c}function jb(){var c,d,e;c=h;a.substr(h,6).toLowerCase()===Ke?(d=a.substr(h,6),h+=6):(d=f,0===y&&b(Le));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="MINUTE":
(h=c,c=f)):(h=c,c=f);return c}function Ba(){var c,d,e;c=h;a.substr(h,6).toLowerCase()===Me?(d=a.substr(h,6),h+=6):(d=f,0===y&&b(Ne));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="SECOND":(h=c,c=f)):(h=c,c=f);return c}function Fa(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Oe?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(Pe));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="CASE":(h=c,c=f)):(h=c,c=f);return c}function ta(){var c,d,e;c=h;a.substr(h,3).toLowerCase()===Qe?(d=a.substr(h,
3),h+=3):(d=f,0===y&&b(Re));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="END":(h=c,c=f)):(h=c,c=f);return c}function ca(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Se?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(Te));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="WHEN":(h=c,c=f)):(h=c,c=f);return c}function ea(){var c,d,e;c=h;a.substr(h,4).toLowerCase()===Ue?(d=a.substr(h,4),h+=4):(d=f,0===y&&b(Ve));d!==f?(d=h,y++,e=B(),y--,e===f?d=void 0:(h=d,d=f),d!==f?c="THEN":(h=c,c=f)):(h=
c,c=f);return c}function oa(){var c;44===a.charCodeAt(h)?(c=We,h++):(c=f,0===y&&b(Xe));return c}function fa(){var c;40===a.charCodeAt(h)?(c=Ye,h++):(c=f,0===y&&b(Ze));return c}function ja(){var c;41===a.charCodeAt(h)?(c=$e,h++):(c=f,0===y&&b(af));return c}function z(){var a,b;a=[];for(b=Ca();b!==f;)a.push(b),b=Ca();return a}function Ca(){var c;bf.test(a.charAt(h))?(c=a.charAt(h),h++):(c=f,0===y&&b(cf));return c}function Na(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=
d);return a}function Ga(a,b){for(var c=0;c<b.length;c++)a=Na(b[c][1],a,b[c][3]);return a}r=void 0!==r?r:{};var f={},kb={start:n},Kb=n,ad="!",bd=q("!",!1),lb="\x3d",mb=q("\x3d",!1),nb="\x3e\x3d",ed=q("\x3e\x3d",!1),fd="\x3e",gd=q("\x3e",!1),ob="\x3c\x3d",hd=q("\x3c\x3d",!1),pb="\x3c\x3e",id=q("\x3c\x3e",!1),jd="\x3c",kd=q("\x3c",!1),qb="!\x3d",ld=q("!\x3d",!1),gc="+",hc=q("+",!1),ic="-",jc=q("-",!1),md="*",nd=q("*",!1),od="/",pd=q("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=g([["A","Z"],["a","z"],"_",["\u0080",
"\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=g([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=g([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=q("@",!1),Cb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},Db=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},Eb="'",Fb=q("'",!1),Gb="N'",Yd=q("N'",!1),La="''",Hb=q("''",!1),Ib=/^[^']/,Jb=g(["'"],!0,!1),ae=".",be=q(".",!1),
ge=/^[0-9]/,he=g([["0","9"]],!1,!1),ce=/^[eE]/,de=g(["e","E"],!1,!1),ee=/^[+\-]/,fe=g(["+","-"],!1,!1),ud="null",vd=q("NULL",!0),qd="true",rd=q("TRUE",!0),sd="false",td=q("FALSE",!0),ie="in",je=q("IN",!0),ke="is",le=q("IS",!0),me="like",ne=q("LIKE",!0),cd="escape",dd=q("ESCAPE",!0),oe="not",pe=q("NOT",!0),qe="and",re=q("AND",!0),se="or",te=q("OR",!0),ue="between",ve=q("BETWEEN",!0),we="from",xe=q("FROM",!0),Ed="for",Fd=q("FOR",!0),Cd="substring",Dd=q("SUBSTRING",!0),Ad="extract",Bd=q("EXTRACT",!0),
ye="trim",ze=q("TRIM",!0),Gd="position",Hd=q("POSITION",!0),yd="timestamp",zd=q("TIMESTAMP",!0),wd="date",xd=q("DATE",!0),Qd="leading",Rd=q("LEADING",!0),Sd="trailing",Td=q("TRAILING",!0),Ud="both",Vd=q("BOTH",!0),Wd="to",Xd=q("TO",!0),Ae="interval",Be=q("INTERVAL",!0),Ce="year",De=q("YEAR",!0),Ee="month",Fe=q("MONTH",!0),Ge="day",He=q("DAY",!0),Ie="hour",Je=q("HOUR",!0),Ke="minute",Le=q("MINUTE",!0),Me="second",Ne=q("SECOND",!0),Oe="case",Pe=q("CASE",!0),Qe="end",Re=q("END",!0),Se="when",Te=q("WHEN",
!0),Ue="then",Ve=q("THEN",!0),Zd="else",$d=q("ELSE",!0),We=",",Xe=q(",",!1),Ye="(",Ze=q("(",!1),$e=")",af=q(")",!1),bf=/^[ \t\n\r]/,cf=g([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=q("`",!1),Vc=/^[^`]/,Wc=g(["`"],!0,!1),h=0,Oa=[{line:1,column:1}],sa=0,Pa=[],y=0,Xa;if("startRule"in r){if(!(r.startRule in kb))throw Error("Can't start parsing from rule \""+r.startRule+'".');Kb=kb[r.startRule]}Xa=Kb();if(Xa!==f&&h===a.length)return Xa;Xa!==f&&h<a.length&&b({type:"end"});throw function(a,b,c){return new x(x.buildMessage(a,
b),a,b,c)}(Pa,sa<a.length?a.charAt(sa):null,sa<a.length?d(sa,sa+1):d(sa,sa));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(x,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities=void 0;a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,
supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports tslib ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(x,a,r,q,g,c,d,b,n,m,w,e,u,t,p){function D(a){return a.substr(24,12)+a.substr(19,4)+a.substr(16,2)+a.substr(14,2)+a.substr(11,2)+a.substr(9,2)+a.substr(6,2)+a.substr(4,2)+a.substr(2,2)+a.substr(0,2)}function E(a,b,c,d){if(c&&"esriFieldTypeDate"===c.type){var e=(new Date(a)).getTime(),g=(new Date(b)).getTime();if(!isNaN(e)&&!isNaN(g))return d?g-e:e-g}return"number"===typeof a&&"number"===typeof b?d?b-a:a-b:"string"===typeof a&&"string"===typeof b?(e=a.toUpperCase(),g=b.toUpperCase(),!c||"esriFieldTypeGUID"!==
c.type&&"esriFieldTypeGlobalID"!==c.type?d=(d?e>g:e<g)?-1:(d?e<g:e>g)?1:0:(a=D(e),g=D(g),d=(d?a>g:a<g)?-1:(d?a<g:a>g)?1:0),d):d?1:-1}Object.defineProperty(a,"__esModule",{value:!0});x=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=
c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!1,configurable:!0});a.prototype.createQueryResponseForCount=function(a){var b=new w.default(a,this.featureAdapter,this.fieldsIndex);if(!a.outStatistics)return b.countDistinctValues(this.items);var c=a.groupByFieldsForStatistics,d=a.having;if(null===c||void 0===c||!c.length)return 1;var e=new Map,g=new Map,k=new Set,m=0;for(a=a.outStatistics;m<a.length;m++){var n=a[m],n="exceedslimit"!==
n.statisticType?n.onStatisticField:void 0;if(!g.has(n)){for(var p=[],v=0,l=c;v<l.length;v++){var t=this._getAttributeValues(b,l[v],e);p.push(t)}g.set(n,this._calculateUniqueValues(p))}var n=g.get(n),q;for(q in n)v=n[q],p=v.items,v=v.data.join(","),d&&!b.validateItems(p,d)||k.add(v)}return k.size};a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):
this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(n.isValid(a.outSR)&&!n.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=p.cleanFromGeometryEngine(r.__assign({spatialReference:a.outSR},u.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):b.queryGeometry=p.cleanFromGeometryEngine(r.__assign({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var d=e.getWhereClause(b.where,this.fieldsIndex);if(!d)return c.resolve(this);
if(d.isStandardized){for(var g=0,k=[],m=0,n=this.items;m<n.length;m++){var p=n[m];d.testFeature(p,this.featureAdapter)&&(k[g++]=p)}d=new a(k,this.queryGeometry,this);d.definitionExpression=b.where;return c.resolve(d)}return c.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return c.resolve(this);var e=d.SetFromValues(b.objectIds),g=this.featureAdapter.getObjectId;return c.resolve(new a(this.items.filter(function(a){return e.has(g(a))}),
this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=t.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!g.isSome(b))return c.resolve(this);b=this.items.filter(b);return c.resolve(new a(b,this.queryGeometry,this))};a.prototype.filterLatest=function(){for(var b=this.timeInfo,d=b.trackIdField,e=b.startTimeField,b=b.endTimeField||e,e=new Map,g=this.featureAdapter.getAttribute,m=0,n=this.items;m<n.length;m++){var p=n[m],t=g(p,d),C=g(p,b),F=e.get(t);(!F||C>g(F,b))&&e.set(t,
p)}d=q.valuesOfMap(e);return c.resolve(new a(d,this.queryGeometry,this))};a.prototype.project=function(b){return r.__awaiter(this,void 0,void 0,function(){var c,d,e,g=this;return r.__generator(this,function(k){switch(k.label){case 0:if(!b||n.equals(this.spatialReference,b))return[2,this];c=this.featureAdapter;return[4,u.projectMany(this.items.map(function(a){return p.getGeometry(g.geometryType,g.hasZ,g.hasM,c.getGeometry(a))}),this.spatialReference,b)];case 1:return d=k.sent(),e=d.map(function(a,
b){return c.cloneWithGeometry(g.items[b],m.convertFromGeometry(a,g.hasZ,g.hasM))}),[2,new a(e,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:b,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._sortFeatures=function(a,b,c){if(1<a.length&&b&&b.length){var d=function(b){b=b.split(" ");var d=b[0],g=e.fieldsIndex.get(d),
k=b[1]&&"desc"===b[1].toLowerCase();a.sort(function(a,b){a=c(a,d,g);b=c(b,d,g);return E(a,b,g,k)})},e=this,g=0;for(b=b.reverse();g<b.length;g++)d(b[g])}};a.prototype._createFeatureQueryResponse=function(a){var c=this,d=this.items,e=this.geometryType,g=this.hasM,k=this.hasZ,m=this.objectIdField,n=this.spatialReference,C=a.outFields,F=a.outSR,v=a.quantizationParameters,l=a.resultRecordCount,t=a.resultOffset,q=a.returnZ,w=a.returnM,l=null!=l?d.length>(t||0)+l:!1,C=C&&(-1<C.indexOf("*")?r.__spreadArrays(this.fieldsIndex.fields):
C.map(function(a){return c.fieldsIndex.get(a)}));return{exceededTransferLimit:l,features:this._createFeatures(a,d),fields:C,geometryType:e,hasM:g&&w,hasZ:k&&q,objectIdFieldName:m,spatialReference:p.cleanFromGeometryEngine(F?F:n),transform:v&&b.toQuantizationTransform(v)||null}};a.prototype._createFeatures=function(a,c){var d=new w.default(a,this.featureAdapter,this.fieldsIndex),e=a.orderByFields,g=a.quantizationParameters,m=a.returnGeometry,k=a.returnCentroid,n=a.maxAllowableOffset,C=a.resultOffset,
F=a.resultRecordCount,v=a.returnZ;a=a.returnM;var l=this.hasZ&&(void 0===v?!1:v),t=this.hasM&&(void 0===a?!1:a),v=[];a=0;c=r.__spreadArrays(c);this._sortFeatures(c,e,function(a,b,c){return d.getFieldValue(a,b,c)});if(m||k)if(e=b.toQuantizationTransform(g),m&&!k)for(k=0;k<c.length;k++)m=c[k],v[a++]={attributes:d.getAttributes(m),geometry:p.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(m),n,e,l,t)};else if(!m&&k)for(n=0;n<c.length;n++)m=c[n],v[a++]={attributes:d.getAttributes(m),
centroid:p.transformCentroid(this,this.featureAdapter.getCentroid(m,this),e)};else for(k=0;k<c.length;k++)m=c[k],v[a++]={attributes:d.getAttributes(m),centroid:p.transformCentroid(this,this.featureAdapter.getCentroid(m,this),e),geometry:p.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(m),n,e,l,t)};else for(n=0;n<c.length;n++)m=c[n],(l=d.getAttributes(m))&&(v[a++]={attributes:l});C=C||0;null!=F&&(v=v.slice(C,Math.min(v.length,C+F)));return v};a.prototype._createExceedsLimitQueryResponse=
function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=0;for(a=a.outStatistics;e<a.length;e++){var g=a[e];if("exceedslimit"===g.statisticType){c=null!=g.maxPointCount?g.maxPointCount:Number.POSITIVE_INFINITY;d=null!=g.maxRecordCount?g.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=g.maxVertexCount?g.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=
this.hasZ?this.hasM?4:3:this.hasM?3:2,m=this.featureAdapter,b=this.items.reduce(function(a,b){b=m.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=this,c={attributes:{}},d=[],e=new Map,g=new Map,m=new Map,k=new Map,n=new w.default(a,this.featureAdapter,
this.fieldsIndex),p=a.outStatistics,v=a.groupByFieldsForStatistics,l=a.having;a=a.orderByFields;for(var t=v&&v.length,r=!!t,u=r&&v[0],A=r&&!this.fieldsIndex.get(u),x=0;x<p.length;x++){var D=p[x],E=D.outStatisticFieldName,ha=D.statisticType,ga=D,M="exceedslimit"!==ha?D.onStatisticField:void 0,I="percentile_disc"===ha||"percentile_cont"===ha,la=r&&1===t&&(M===u||A)&&"count"===ha;if(r){if(!m.has(M)){for(var D=[],ha=0,W=v;ha<W.length;ha++){var Q=this._getAttributeValues(n,W[ha],e);D.push(Q)}m.set(M,this._calculateUniqueValues(D))}var Y=
m.get(M),D=function(a){var c=Y[a];a=c.count;var d=c.data,g=c.items,m=c.itemPositions,c=d.join(",");if(!l||n.validateItems(g,l)){var p=k.get(c)||{attributes:{}},g=null;if(la)g=a;else{var C=S._getAttributeValues(n,M,e);a=m.map(function(a){return C[a]});g=I&&"statisticParameters"in ga?S._getPercentileValue(ga,a):S._getStatisticValue(ga,a)}p.attributes[E]=g;v.forEach(function(a,c){return p.attributes[b.fieldsIndex.get(a)?a:"EXPR_"+(c+1)]=d[c]});k.set(c,p)}},S=this,ba;for(ba in Y)D(ba)}else Q=this._getAttributeValues(n,
M,e),c.attributes[E]=I&&"statisticParameters"in ga?this._getPercentileValue(ga,Q):this._getStatisticValue(ga,Q,g);d.push({name:E,alias:E,type:"esriFieldTypeDouble"})}c=r?q.valuesOfMap(k):[c];this._sortFeatures(c,a,function(a,b){return a.attributes[b]});return{fields:d,features:c}};a.prototype._getStatisticValue=function(a,b,c){var d=a.onStatisticField;a=a.statisticType;b=c&&c.has(d)?c.get(d):this._calculateStatistics(b);c&&c.set(d,b);return b["var"===a?"variance":a]};a.prototype._getPercentileValue=
function(a,b){var c=a.statisticParameters,d=a.statisticType,e=c.value,g="desc"===c.orderBy,m=this.fieldsIndex.get(a.onStatisticField);a=r.__spreadArrays(b).filter(function(a){return null!=a}).sort(function(a,b){return E(a,b,m,g)});return this._calculatePercentile(a,e,"percentile_disc"===d)};a.prototype._getAttributeValues=function(a,b,c){if(c.has(b))return c.get(b);var d=this.fieldsIndex.get(b),e=this.items.map(function(c){return a.getFieldValue(c,b,d)});c.set(b,e);return e};a.prototype._calculateStatistics=
function(a){for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=null,e=null,g=null,m=null,n=[],k=0,p=0;p<a.length;p++){var v=a[p];"string"===typeof v?k++:null==v||isNaN(v)||(d+=v,b=Math.min(b,v),c=Math.max(c,v),n.push(v),k++)}if(k){e=d/k;for(g=a=0;g<n.length;g++)v=n[g],a+=Math.pow(v-e,2);m=1<k?a/(k-1):0;g=Math.sqrt(m)}else c=b=null;return{avg:e,count:k,max:c,min:b,stddev:g,sum:d,variance:m}};a.prototype._calculateUniqueValues=function(a){for(var b={},c=this.items,d=c.length,e=0;e<d;e++){for(var g=
c[e],m=[],n=0,k=a;n<k.length;n++)m.push(k[n][e]);n=m.join(",");null==b[n]?b[n]={count:1,data:m,items:[g],itemPositions:[e]}:(b[n].count++,b[n].items.push(g),b[n].itemPositions.push(e))}return b};a.prototype._calculatePercentile=function(a,b,c){if(0===a.length)return null;if(0>=b)return a[0];if(1<=b)return a[a.length-1];var d=(a.length-1)*b,e=Math.floor(d);b=e+1;var d=d%1,e=a[e],g=a[b];return b>=a.length||c||"string"===typeof e||"string"===typeof g?e:e*(1-d)+g*d};return a}();a.default=x})},"esri/geometry/support/quantizationUtils":function(){define(["require",
"exports","./jsonUtils"],function(x,a,r){function q(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function g(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function c(a,b,c){for(var d=[],e,m,n,k,p=0;p<c.length;p++){var v=c[p];if(0<p){if(n=q(a,v[0]),k=g(a,v[1]),n!==e||k!==m)d.push(b(v,n-e,k-m)),e=n,m=k}else e=q(a,v[0]),m=g(a,v[1]),d.push(b(v,e,m))}return 0<d.length?d:null}function d(a,b,d,e){return c(a,d?e?P:K:e?K:B,b)}function b(a,b,d,e){var g=[];d=d?e?P:K:e?K:B;for(e=0;e<b.length;e++){var l=
c(a,d,b[e]);l&&3<=l.length&&g.push(l)}return g.length?g:null}function n(a,b,d,e){var g=[];d=d?e?P:K:e?K:B;for(e=0;e<b.length;e++){var l=c(a,d,b[e]);l&&2<=l.length&&g.push(l)}return g.length?g:null}function m(a,b){return b*a.scale[0]+a.translate[0]}function w(a,b){return a.translate[1]-b*a.scale[1]}function e(a,b,c){var d=Array(c.length);if(!c.length)return d;var e=a.scale,g=e[0],e=e[1],n=m(a,c[0][0]);a=w(a,c[0][1]);d[0]=b(c[0],n,a);for(var k=1;k<c.length;k++){var p=c[k],n=n+p[0]*g;a-=p[1]*e;d[k]=
b(p,n,a)}return d}function u(a,b,c){for(var d=Array(c.length),g=0;g<c.length;g++)d[g]=e(a,b,c[g]);return d}function t(a,b,c,d){return e(a,c?d?P:K:d?K:B,b)}function p(a,b,c,d){return u(a,c?d?P:K:d?K:B,b)}function D(a,b,c,d){return u(a,c?d?P:K:d?K:B,b)}function E(a,b,c){var d=c[0],e=d[0],d=d[1],g=Math.min(e,b[0]),m=Math.min(d,b[1]),n=Math.max(e,b[2]);b=Math.max(d,b[3]);for(var k=1;k<c.length;k++){var p=c[k],v=p[0],p=p[1],e=e+v,d=d+p;0>v&&(g=Math.min(g,e));0<v&&(n=Math.max(n,e));0>p?m=Math.min(m,d):
0<p&&(b=Math.max(b,d))}a[0]=g;a[1]=m;a[2]=n;a[3]=b;return a}function A(a,b){if(!b.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(var c=0;c<b.length;c++)E(a,a,b[c]);return a}function k(a,b,c,d,e){b.xmin=q(a,c.xmin);b.ymin=g(a,c.ymin);b.xmax=q(a,c.xmax);b.ymax=g(a,c.ymax);b!==c&&(d&&(b.zmin=c.zmin,b.zmax=c.zmax),e&&(b.mmin=c.mmin,b.mmax=c.mmax));return b}function J(a,b,c,e,g){b.points=d(a,c.points,e,g);return b}function O(a,b,c,d,e){b.x=q(a,c.x);b.y=g(a,
c.y);b!==c&&(d&&(b.z=c.z),e&&(b.m=c.m));return b}function H(a,c,d,e,g){a=b(a,d.rings,e,g);if(!a)return null;c.rings=a;return c}function L(a,b,c,d,e){a=n(a,c.paths,d,e);if(!a)return null;b.paths=a;return b}Object.defineProperty(a,"__esModule",{value:!0});a.unquantizePolyline=a.unquantizePolygon=a.unquantizePoint=a.unquantizeMultipoint=a.unquantizeExtent=a.quantizeGeometry=a.quantizePolyline=a.quantizePolygon=a.quantizePoint=a.quantizeMultipoint=a.quantizeExtent=a.getQuantizedBoundsRings=a.getQuantizedBoundsPaths=
a.getQuantizedBoundsPoints=a.getQuantizedBoundsCoordsArrayArray=a.getQuantizedBoundsCoordsArray=a.unquantizeRings=a.unquantizePaths=a.unquantizePoints=a.unquantizeBounds=a.unquantizeCoordsArrayArray=a.unquantizeCoordsArray=a.unquantizeY=a.unquantizeX=a.quantizePaths=a.quantizeRings=a.quantizePoints=a.quantizeBounds=a.quantizeY=a.quantizeX=a.equals=a.toQuantizationTransform=void 0;var B=function(a,b,c){return[b,c]},K=function(a,b,c){return[b,c,a[2]]},P=function(a,b,c){return[b,c,a[2],a[3]]};a.toQuantizationTransform=
function(a){return a?{originPosition:"upper-left"===a.originPosition?"upperLeft":"lower-left"===a.originPosition?"lowerLeft":a.originPosition,scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,b){if(a===b||null==a&&null==b)return!0;if(null==a||null==b)return!1;var c,d,e,g;a&&"upperLeft"===a.originPosition?(c=a.translate[0],d=a.translate[1],a=a.scale[0]):(c=a.extent.xmin,d=a.extent.ymax,a=a.tolerance);b&&"upperLeft"===b.originPosition?(e=b.translate[0],
g=b.translate[1],b=b.scale[0]):(e=b.extent.xmin,g=b.extent.ymax,b=b.tolerance);return c===e&&d===g&&a===b};a.quantizeX=q;a.quantizeY=g;a.quantizeBounds=function(a,b,c){b[0]=q(a,c[0]);b[3]=g(a,c[1]);b[2]=q(a,c[2]);b[1]=g(a,c[3]);return b};a.quantizePoints=d;a.quantizeRings=b;a.quantizePaths=n;a.unquantizeX=m;a.unquantizeY=w;a.unquantizeCoordsArray=e;a.unquantizeCoordsArrayArray=u;a.unquantizeBounds=function(a,b,c){return c?(b[0]=m(a,c[0]),b[1]=w(a,c[3]),b[2]=m(a,c[2]),b[3]=w(a,c[1]),b):[m(a,b[0]),
w(a,b[3]),m(a,b[2]),w(a,b[1])]};a.unquantizePoints=t;a.unquantizePaths=p;a.unquantizeRings=D;a.getQuantizedBoundsCoordsArray=E;a.getQuantizedBoundsCoordsArrayArray=A;a.getQuantizedBoundsPoints=function(a){var b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return E(b,b,a)};a.getQuantizedBoundsPaths=function(a){return A([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return A([0,0,0,0],a)};a.quantizeExtent=k;a.quantizeMultipoint=J;a.quantizePoint=
O;a.quantizePolygon=H;a.quantizePolyline=L;a.quantizeGeometry=function(a,b){return a&&b?r.isPoint(b)?O(a,{},b,!1,!1):r.isPolyline(b)?L(a,{},b,!1,!1):r.isPolygon(b)?H(a,{},b,!1,!1):r.isMultipoint(b)?J(a,{},b,!1,!1):r.isExtent(b)?k(a,{},b,!1,!1):null:null};a.unquantizeExtent=function(a,b,c,d,e){b.xmin=m(a,c.xmin);b.ymin=w(a,c.ymin);b.xmax=m(a,c.xmax);b.ymax=w(a,c.ymax);b!==c&&(d&&(b.zmin=c.zmin,b.zmax=c.zmax),e&&(b.mmin=c.mmin,b.mmax=c.mmax));return b};a.unquantizeMultipoint=function(a,b,c,d,e){b.points=
t(a,c.points,d,e);return b};a.unquantizePoint=function(a,b,c,d,e){b.x=m(a,c.x);b.y=w(a,c.y);b!==c&&(d&&(b.z=c.z),e&&(b.m=c.m));return b};a.unquantizePolygon=function(a,b,c,d,e){b.rings=D(a,c.rings,d,e);return b};a.unquantizePolyline=function(a,b,c,d,e){b.paths=p(a,c.paths,d,e);return b}})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(x,a,r,q){Object.defineProperty(a,"__esModule",{value:!0});x=function(){function a(a,
d,b){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=b;this.featureAdapter=d;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=d=0;c<a.length;c++){var g=a[c],r=q.getExpressionFromFieldName(g),e=this.fieldsIndex.get(r),r=e?null:q.getWhereClause(r,b),e=e?e.name:q.getAliasFromFieldName(g)||"FIELD_EXP_"+d++;this._fieldDataCache.set(g,{alias:e,clause:r})}}}a.prototype.countDistinctValues=function(a){var c=
this;if(!this.returnDistinctValues)return a.length;a.forEach(function(a){return c.getAttributes(a)});return this._returnDistinctMap.size};a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,d,b){var c=b?b.name:d,g=null;this._fieldDataCache.has(c)?g=this._fieldDataCache.get(c).clause:b||(g=q.getWhereClause(d,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:g}));return b?this.featureAdapter.getAttribute(a,
c):g.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:q.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d).clause.testFeature(a,this.featureAdapter)};a.prototype.validateItems=function(a,d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:q.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=
function(a){var c=this.outFields;if(!c||!c.length)return this.featureAdapter.getAttributes(a);for(var b={},g=0;g<c.length;g++){var m=this._fieldDataCache.get(c[g]),q=m.alias,m=m.clause;b[q]=m?m.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,q)}return b};a.prototype._processAttributesForDistinctValues=function(a){if(r.isNone(a)||!this.returnDistinctValues)return a;var c=this.outFields,b=[];if(c)for(var g=0;g<c.length;g++){var m=this._fieldDataCache.get(c[g]).alias;b.push(a[m])}else for(m in a)b.push(a[m]);
c=(c||["*"]).join(",")+"\x3d"+b.join(",");b=this._returnDistinctMap.get(c)||0;this._returnDistinctMap.set(c,++b);return 1<b?null:a};return a}();a.default=x})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(x,a){function r(a,d,b,g,m){if(null!=g&&null!=m)return function(c){var e=a.getAttribute(c,d);c=a.getAttribute(c,b);return(null==e||e<=m)&&(null==c||c>=g)};if(null!=g)return function(c){c=a.getAttribute(c,b);return null==c||c>=g};if(null!=m)return function(b){b=
a.getAttribute(b,d);return null==b||b<=m}}function q(a,d,b,g){if(null!=b&&null!=g&&b===g)return function(c){return a.getAttribute(c,d)===b};if(null!=b&&null!=g)return function(c){c=a.getAttribute(c,d);return c>=b&&c<=g};if(null!=b)return function(c){return a.getAttribute(c,d)>=b};if(null!=g)return function(b){return a.getAttribute(b,d)<=g}}function g(){return function(){return!1}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeOperator=a.getTimeExtent=void 0;a.getTimeExtent=function(a,d){if(!a)return null;
var b=d.featureAdapter,c=a.startTimeField,g=a.endTimeField,q=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY;if(c&&g)d.forEach(function(a){var d=b.getAttribute(a,c);a=b.getAttribute(a,g);null==d||isNaN(d)||(q=Math.min(q,d));null==a||isNaN(a)||(e=Math.max(e,a))});else{var r=c||g;d.forEach(function(a){a=b.getAttribute(a,r);null==a||isNaN(a)||(q=Math.min(q,a),e=Math.max(e,a))})}return{start:q,end:e}};a.getTimeOperator=function(a,d,b){if(!d||!a)return null;var c=a.startTimeField;a=a.endTimeField;
if(!c&&!a)return null;var m=d.start;d=d.end;return null===m&&null===d?null:void 0===m&&void 0===d?g():c&&a?r(b,c,a,m,d):q(b,c||a,m,d)}})},"esri/layers/graphics/data/utils":function(){define("require exports tslib ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(x,a,r,q,g,c,d,b,n,m,w,e,u,t,p){function D(a,b,c,d,g){void 0===d&&(d=a.hasZ);void 0===g&&(g=a.hasM);var l=a.hasZ&&d,m=a.hasM&&g;return c?(a=e.quantizeOptimizedGeometry(H,b,a.hasZ,a.hasM,"esriGeometryPoint",c,d,g),e.convertToPoint(a,l,m)):e.convertToPoint(b,l,m)}function E(c,e,m){return r.__awaiter(this,void 0,void 0,function(){var k,l,p,q,u,C;return r.__generator(this,function(r){switch(r.label){case 0:if(!c)return[2,null];k=c.where;c.where=k=k&&k.trim();if(!k||/^1 *= *1$/.test(k)||e&&e===
k)c.where=null;return c.geometry?[4,A(c)]:[2,c];case 1:return l=r.sent(),c.distance=0,c.units=null,"esriSpatialRelEnvelopeIntersects"===c.spatialRel&&(p=c.geometry.spatialReference,l=d.getGeometryExtent(l),l.spatialReference=p),c.geometry=l,[4,t.checkProjectionSupport(l.spatialReference,m)];case 2:return r.sent(),[4,n.normalizeCentralMeridian(b.fromJSON(l))];case 3:q=r.sent()[0];if(g.isNone(q))throw a.QUERY_ENGINE_EMPTY_RESULT;u=q.toJSON();return[4,t.project(u,u.spatialReference,m)];case 4:C=r.sent();
if(!C)throw a.QUERY_ENGINE_EMPTY_RESULT;C.spatialReference=m;c.geometry=C;return[2,c]}})})}function A(a){return r.__awaiter(this,void 0,void 0,function(){var b,d,e,g,n,q,u,w,B;return r.__generator(this,function(l){switch(l.label){case 0:b=a.geometry;d=a.distance;e=a.units;if(null==d||"vertexAttributes"in b)return[2,b];g=b.spatialReference;n=e?k.fromJSON(e):c.getUnitString(g);q=g&&(m.isGeographic(g)||m.isWebMercator(g));if(!q)return[3,1];w=b;return[3,3];case 1:return[4,t.checkProjectionSupport(g,m.WGS84).then(function(){return t.project(b,
m.WGS84)})];case 2:w=l.sent(),l.label=3;case 3:return u=w,[4,p.getGeodesicBufferOperator()];case 4:return B=l.sent(),[2,B(u.spatialReference,u,d,n)]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.cleanFromGeometryEngine=a.normalizeQueryLike=a.normalizeFilter=a.normalizeQuery=a.getGeometry=a.getCentroid=a.transformCentroid=a.QUERY_ENGINE_EMPTY_RESULT=void 0;var k=new q.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var J=new u.default,O=new u.default,H=new u.default,L={esriGeometryPoint:e.convertToPoint,esriGeometryPolyline:e.convertToPolyline,esriGeometryPolygon:e.convertToPolygon,esriGeometryMultipoint:e.convertToMultipoint};a.transformCentroid=D;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=
w.getCentroidOptimizedGeometry(new u.default,b.geometry,a.hasZ,a.hasM));return D(a,b.centroid,c)};a.getGeometry=function(a,b,c,d,g,m,k,n){void 0===k&&(k=b);void 0===n&&(n=c);var l=b&&k,p=c&&n;d=d?"coords"in d?d:d.geometry:null;if(!d)return null;if(g)return b=e.generalizeOptimizedGeometry(O,d,b,c,a,g,k,n),m&&(b=e.quantizeOptimizedGeometry(H,b,l,p,a,m)),L[a](b,l,p);if(m)return b=e.quantizeOptimizedGeometry(H,d,b,c,a,m,k,n),L[a](b,l,p);e.removeZMValues(J,d,b,c,k,n);return L[a](J,l,p)};a.normalizeQuery=
function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e,g,m,k;return r.__generator(this,function(l){d=a.outFields;e=a.orderByFields;g=a.groupByFieldsForStatistics;m=a.outStatistics;if(d)for(k=0;k<d.length;k++)d[k]=d[k].trim();if(e)for(k=0;k<e.length;k++)e[k]=e[k].trim();if(g)for(k=0;k<g.length;k++)g[k]=g[k].trim();if(m)for(k=0;k<m.length;k++)m[k].onStatisticField&&(m[k].onStatisticField=m[k].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,
E(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(d){return[2,E(a,b,c)]})})};a.normalizeQueryLike=E;a.cleanFromGeometryEngine=function(a){return a&&B in a?JSON.parse(JSON.stringify(a,K)):a};var B="_geVersion",K=function(a,b){return a!==B?b:void 0}})},"esri/geometry/support/normalizeUtils":function(){define("require exports tslib ../../config ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../Polygon ../Polyline ../SpatialReference ./spatialReferenceUtils ./webMercatorUtils ../../tasks/geometry/cut ../../tasks/geometry/simplify".split(" "),
function(x,a,r,q,g,c,d,b,n,m,w,e,u,t,p){function D(a){return"polygon"===a.type?a.rings:a.paths}function E(a,b){return Math.ceil((a-b)/(2*b))}function A(a,b){for(var c=0,d=D(a);c<d.length;c++)for(var e=0,g=d[c];e<g.length;e++)g[e][0]+=b;return a}function k(a){for(var b=[],c=0,d=0,e=0;e<a.length;e++){for(var g=a[e],m=null,k=0;k<g.length;k++)m=g[k],b.push(m),0===k?d=c=m[0]:(c=Math.min(c,m[0]),d=Math.max(d,m[0]));m&&b.push([(c+d)/2,0])}return b}function J(a,b){if(!(a instanceof m||a instanceof n))throw K.error("straightLineDensify: the input geometry is neither polyline nor polygon"),
new g("straightLineDensify: the input geometry is neither polyline nor polygon");for(var c=[],d=0,e=D(a);d<e.length;d++){var k=e[d],p=[];c.push(p);p.push([k[0][0],k[0][1]]);for(var q=0;q<k.length-1;q++){var t=k[q][0],r=k[q][1],u=k[q+1][0],w=k[q+1][1],B=Math.sqrt((u-t)*(u-t)+(w-r)*(w-r)),M=(w-r)/B,I=(u-t)/B,C=B/b;if(1<C){for(var F=1;F<=C-1;F++){var A=F*b;p.push([I*A+t,M*A+r])}B=(B+Math.floor(C-1)*b)/2;p.push([I*B+t,M*B+r])}p.push([u,w])}}return"polygon"===a.type?new n({rings:c,spatialReference:a.spatialReference}):
new m({paths:c,spatialReference:a.spatialReference})}function O(a,b,c){b&&(a=J(a,1E6),a=u.webMercatorToGeographic(a,!0));c&&(a=A(a,c));return a}function H(a,b,c){if(Array.isArray(a)){var d=a[0];if(d>b){var e=E(d,b);a[0]=d+-2*e*b}else d<c&&(e=E(d,c),a[0]=d+-2*e*c)}else d=a.x,d>b?(e=E(d,b),a=a.clone().offset(-2*e*b,0)):d<c&&(e=E(d,c),a=a.clone().offset(-2*e*c,0));return a}function L(a,b){for(var c=-1,d=function(d){var e=b.cutIndexes[d],g=b.geometries[d],m=D(g);d=function(a){var b=m[a];b.some(function(c){if(180>
c[0])return!0;for(var d=c=0;d<b.length;d++){var e=b[d][0];c=e>c?e:c}c=Number(c.toFixed(9));c=-360*E(c,180);for(d=0;d<b.length;d++)e=g.getPoint(a,d),g.setPoint(a,d,e.clone().offset(c,0));return!0})};for(var l=0;l<m.length;l++)d(l);if(e===c)if("polygon"===a[0].type)for(d=0,l=D(g);d<l.length;d++)a[e]=a[e].addRing(l[d]);else{if("polyline"===a[0].type)for(d=0,l=D(g);d<l.length;d++)a[e]=a[e].addPath(l[d])}else c=e,a[e]=g},e=0;e<b.cutIndexes.length;e++)d(e);return a}function B(a,c,g){return r.__awaiter(this,
void 0,void 0,function(){var l,k,v,w,C,x,F,J,D,K,M,I,la,W,Q,Y,S,ba,ma,ka,ia,Ia,Ma,ib,Ya,Za,jb,Ba,Fa,ta,ca,ea,oa,fa,ja,z,Ca;return r.__generator(this,function(r){switch(r.label){case 0:if(!Array.isArray(a))return[2,B([a],c)];l=c?c.url:q.geometryServiceUrl;K=0;M=[];I=[];la=0;for(W=a;la<W.length;la++)Q=W[la],d.isNone(Q)?I.push(Q):(k||(k=Q.spatialReference,v=e.getInfo(k),F=(w=k.isWebMercator)?102100:4326,C=P[F].maxX,x=P[F].minX,J=P[F].plus180Line,D=P[F].minus180Line),v?"mesh"===Q.type?I.push(Q):"point"===
Q.type?I.push(H(Q.clone(),C,x)):"multipoint"===Q.type?(Y=Q.clone(),Y.points=Y.points.map(function(a){return H(a,C,x)}),I.push(Y)):"extent"===Q.type?(S=Q.clone(),ba=S._normalize(!1,!1,v),I.push(ba.rings?new n(ba):ba)):Q.extent?(S=Q.extent,ma=E(S.xmin,x),ka=2*ma*C,ia=0===ka?Q.clone():A(Q.clone(),ka),S.offset(ka,0),S.intersects(J)&&S.xmax!==C?(K=S.xmax>K?S.xmax:K,ia=O(ia,w),M.push(ia),I.push("cut")):S.intersects(D)&&S.xmin!==x?(K=2*S.xmax*C>K?2*S.xmax*C:K,ia=O(ia,w,360),M.push(ia),I.push("cut")):I.push(ia)):
I.push(Q.clone()):I.push(Q));Ia=E(K,C);Ma=-90;ib=Ia;for(Ya=new m;0<Ia;)Za=-180+360*Ia,Ya.addPath([[Za,Ma],[Za,-1*Ma]]),Ma*=-1,Ia--;return 0<M.length&&0<ib?[4,t.cut(l,M,Ya,g)]:[3,3];case 1:jb=r.sent();Ba=L(M,jb);Fa=[];ta=[];for(ca=0;ca<I.length;ca++)ea=I[ca],"cut"!==ea?ta.push(ea):(oa=Ba.shift(),fa=a[ca],d.isSome(fa)&&"polygon"===fa.type&&fa.rings&&1<fa.rings.length&&oa.rings.length>=fa.rings.length?(Fa.push(oa),ta.push("simplify")):ta.push(w?u.geographicToWebMercator(oa):oa));return Fa.length?[4,
p.simplify(l,Fa,g)]:[2,ta];case 2:ja=r.sent();z=[];for(ca=0;ca<ta.length;ca++)ea=ta[ca],"simplify"!==ea?z.push(ea):z.push(w?u.geographicToWebMercator(ja.shift()):ja.shift());return[2,z];case 3:Ca=[];for(ca=0;ca<I.length;ca++)ea=I[ca],"cut"!==ea?Ca.push(ea):(oa=M.shift(),Ca.push(!0===w?u.geographicToWebMercator(oa):oa));return[2,b.resolve(Ca)]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.normalizeMapX=a.getDenormalizedExtent=a.normalizeCentralMeridian=a.straightLineDensify=void 0;var K=
c.getLogger("esri.geometry.support.normalizeUtils"),P={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new m({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:w.WebMercator}),minus180Line:new m({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:w.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new m({paths:[[[180,-180],[180,180]]],spatialReference:w.WGS84}),
minus180Line:new m({paths:[[[-180,-180],[-180,180]]],spatialReference:w.WGS84})}};a.straightLineDensify=J;a.normalizeCentralMeridian=B;a.getDenormalizedExtent=function(a){var b;if(!a)return null;var c=a.extent;if(!c)return null;var d=a.spatialReference&&e.getInfo(a.spatialReference);if(!d)return c;var d=d.valid,g=d[0],d=d[1],m=c.width,n=c.xmin;b=c.xmax;b=[b,n];n=b[0];b=b[1];if("extent"===a.type||0===m||m<=d||m>2*d||n<g||b>d)return c;var p;switch(a.type){case "polygon":if(1<a.rings.length)p=k(a.rings);
else return c;break;case "polyline":if(1<a.paths.length)p=k(a.paths);else return c;break;case "multipoint":p=a.points}a=c.clone();for(g=0;g<p.length;g++){var q=p[g][0];0>q?(q+=d,b=Math.max(q,b)):(q-=d,n=Math.min(q,n))}a.xmin=n;a.xmax=b;return a.width<m?(a.xmin-=d,a.xmax-=d,a):c};a.normalizeMapX=function(a,b){if(b=e.getInfo(b)){var c=b.valid;b=c[0];var c=c[1],d=c-b;if(a<b)for(;a<b;)a+=d;if(a>c)for(;a>c;)a-=d}return a}})},"esri/tasks/geometry/cut":function(){define("require exports tslib ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),
function(x,a,r,q,g,c,d){Object.defineProperty(a,"__esModule",{value:!0});a.cut=void 0;a.cut=function(a,n,m,w){return r.__awaiter(this,void 0,void 0,function(){var b,u,t,p,x,E,A,k;return r.__generator(this,function(e){switch(e.label){case 0:return b="string"===typeof a?c.urlToObject(a):a,u=n[0].spatialReference,t=r.__assign(r.__assign({},w),{query:r.__assign(r.__assign({},b.query),{f:"json",sr:JSON.stringify(u),target:JSON.stringify({geometryType:d.getJsonType(n[0]),geometries:n}),cutter:JSON.stringify(m)})}),
[4,g(b.path+"/cut",t)];case 1:return p=e.sent(),x=p.data,E=x.cutIndexes,A=x.geometries,k=void 0===A?[]:A,[2,{cutIndexes:E,geometries:k.map(function(a){a=q.fromJSON(a);a.spatialReference=u;return a})}]}})})}})},"esri/tasks/geometry/simplify":function(){define("require exports tslib ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(x,a,r,q,g,c){function d(a){return{geometryType:c.getJsonType(a[0]),geometries:a.map(function(a){return a.toJSON()})}}function b(a,b,
d){var e=c.getGeometryType(b);return a.map(function(a){a=e.fromJSON(a);a.spatialReference=d;return a})}Object.defineProperty(a,"__esModule",{value:!0});a.simplify=void 0;a.simplify=function(a,m,w){return r.__awaiter(this,void 0,void 0,function(){var e,n,t,p,x;return r.__generator(this,function(u){switch(u.label){case 0:return e="string"===typeof a?g.urlToObject(a):a,n=m[0].spatialReference,t=c.getJsonType(m[0]),p=r.__assign(r.__assign({},w),{query:r.__assign(r.__assign({},e.query),{f:"json",sr:n.wkid?
n.wkid:JSON.stringify(n),geometries:JSON.stringify(d(m))})}),[4,q(e.path+"/simplify",p)];case 1:return x=u.sent(),[2,b(x.data,t,n)]}})})}})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports tslib ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils @dojo/framework/shim/Promise".split(" "),
function(x,a,r,q,g,c,d,b,n,m,w,e,u,t){function p(){return new Promise(function(a,b){x(["../../../geometry/geometryEngineJSON"],a,b)})}Object.defineProperty(a,"__esModule",{value:!0});a.canQueryWithRBush=a.checkSpatialQuerySupport=a.getSpatialQueryOperator=a.getGeodesicBufferOperator=a.importGeometryEngine=void 0;var D={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",
esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},E={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},A={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!0},k={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=p;a.getGeodesicBufferOperator=function(){return p().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,k,n,q,r){if(b.isPolygon(k)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var u=w.convertFromPolygon(new e.default,k,!1,!1);return g.resolve(function(a){return m.polygonContainsPoint(u,
!1,!1,a)})}if(b.isPolygon(k)&&"esriGeometryMultipoint"===n){var B=w.convertFromPolygon(new e.default,k,!1,!1);if("esriSpatialRelContains"===a)return g.resolve(function(a){return m.polygonContainsMultipoint(B,!1,!1,a,q,r)})}if(b.isExtent(k)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return g.resolve(function(a){return c.extentContainsPoint(k,t.getGeometry(n,q,r,a))});if(b.isExtent(k)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===a)return g.resolve(function(a){return c.extentContainsMultipoint(k,
t.getGeometry(n,q,r,a))});if(b.isExtent(k)&&"esriSpatialRelIntersects"===a){var x=d.getExtentIntersector(n);return g.resolve(function(a){return x(k,t.getGeometry(n,q,r,a))})}return p().then(function(b){var c=b[D[a]].bind(null,k.spatialReference,k);return function(a){return c(t.getGeometry(n,q,r,a))}})};a.checkSpatialQuerySupport=function(a,c,d){return r.__awaiter(this,void 0,void 0,function(){var e,g;return r.__generator(this,function(m){e=a.spatialRel;g=a.geometry;if(!g)return[2];if(!0!==E[e])throw new q("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!n.isValid(g.spatialReference)||!n.isValid(d))return[2];if(!0!==A[b.getJsonType(g)])throw new q("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==k[c])throw new q("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,u.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(b.isExtent(a))return!0;if(b.isPolygon(a)){var c=
0;for(a=a.rings;c<a.length;c++){var d=a[c];if(5!==d.length||d[0][0]!==d[1][0]||d[0][0]!==d[4][0]||d[2][0]!==d[3][0]||d[0][1]!==d[3][1]||d[0][1]!==d[4][1]||d[1][1]!==d[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(x,a){function r(a,g,c,d,b){if(!a)return!1;g=g?c?4:3:c?3:2;c=a.coords;var n=!1,m=0,q=0;for(a=a.lengths;q<a.length;q++){for(var e=a[q],r=m,t=m,p=m+e*g;t<p;t+=g){r=t+g;r===p&&(r=m);var x=c[t],E=c[t+1],A=c[r],r=c[r+1];(E<
b&&r>=b||r<b&&E>=b)&&x+(b-E)/(r-E)*(A-x)<d&&(n=!n)}m+=e*g}return n}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsCoords=a.polygonContainsMultipoint=a.polygonContainsPoint=void 0;a.polygonContainsPoint=function(a,g,c,d){return r(a,g,c,d.coords[0],d.coords[1])};a.polygonContainsMultipoint=function(a,g,c,d,b,n){b=b?n?4:3:n?3:2;n=d.coords;d=d.lengths;if(!d)return!1;for(var m=0,q=0;m<d.length;m++,q+=b)if(!r(a,g,c,n[q],n[q+1]))return!1;return!0};a.polygonContainsCoords=r})},"esri/layers/support/FieldsIndex":function(){define(["require",
"exports"],function(x,a){return function(){function a(a){this.fields=a;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this.dateFields=[];if(a){for(var g=[],c=0;c<a.length;c++){var d=a[c],b=d&&d.name;if(b){var n=b.toLowerCase().trim();this._fieldsMap.set(b,d);this._fieldsMap.set(n,d);g.push(n);if("date"===d.type||"esriFieldTypeDate"===d.type)this.dateFields.push(d),this._dateFieldsSet.add(d)}}g.sort();this.uid=g.join(",")}}a.prototype.destroy=function(){this._fieldsMap.clear()};a.prototype.has=
function(a){return null!=this.get(a)};a.prototype.get=function(a){return null!=a?this._fieldsMap.get(a)||this._fieldsMap.get(a.toLowerCase().trim()):void 0};a.prototype.isDateField=function(a){return this._dateFieldsSet.has(this.get(a))};a.prototype.normalizeFieldName=function(a){if(a=this.get(a))return a.name};return a}()})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports tslib ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),
function(x,a,r,q,g,c){Object.defineProperty(a,"__esModule",{value:!0});a.createDefaultTemplate=a.createDefaultAttributesFunction=a.createDrawingInfo=void 0;a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===a?c.defaultPolylineSymbolJSON:c.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(q("csp-restrictions"))return function(){var c;return r.__assign((c=
{},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",d;for(d in a)var g=d.indexOf(".")?'["'+d+'"]':"."+d,c=c+("this"+g+" \x3d "+JSON.stringify(a[d])+";");var e=new Function(c);return function(){return new e}}catch(u){return function(){var c;return r.__assign((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:g.clone(a)}}]}})},"esri/symbols/support/defaultsJSON":function(){define(["require","exports"],function(x,
a){Object.defineProperty(a,"__esModule",{value:!0});a.errorPolygonSymbolJSON=a.errorPolylineSymbolJSON=a.errorPointSymbolJSON=a.defaultTextSymbolJSON=a.defaultPolygonSymbolJSON=a.defaultPolylineSymbolJSON=a.defaultPointSymbolJSON=a.defaultOutlineColor=a.defaultColor=void 0;a.defaultColor=[252,146,31,255];a.defaultOutlineColor=[153,153,153,255];a.defaultPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",size:6,color:a.defaultColor,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,
153,153,255]}};a.defaultPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",width:.75,color:a.defaultColor};a.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};a.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,
angle:0};a.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};a.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};a.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}})},"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports tslib ../../../../geometry/support/spatialReferenceUtils ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),
function(x,a,r,q,g){function c(a){return new n(a)}function d(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(a){switch(a.label){case 0:return e?[2,e]:[4,new Promise(function(a,b){x(["../../../../geometry/geometryEngineJSON"],a,b)})];case 1:return e=a.sent(),[2,e]}})})}Object.defineProperty(a,"__esModule",{value:!0});a.loadGeometryEngineForSimplify=a.loadGeometryEngine=a.simplify=a.mixAttributes=a.createFeatureEditSuccessResult=a.createFeatureEditErrorResult=void 0;
var b=function(){return function(){this.description=this.code=null}}(),n=function(){return function(a){this.error=new b;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=c;var m=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();a.createFeatureEditSuccessResult=function(a){return new m(a)};var w=new Set;a.mixAttributes=function(a,b,d,e,m,n){void 0===m&&(m=!1);w.clear();for(var k in e){var p=
a.get(k);if(p){var q=e[k],r;r=p;var t=q,u=t;"string"===typeof t&&g.isNumericField(r)?u=parseFloat(t):null!=t&&g.isStringField(r)&&"string"!==typeof t&&(u=String(t));r=g.sanitizeNullFieldValue(u);r!==q&&n&&n.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:p,originalValue:q,sanitizedValue:r}});w.add(p.name);if(p&&(m||p.editable)){if(q=g.validateFieldValue(p,r))return c(g.validationErrorToString(q,p,r));d[p.name]=r}}}for(a=0;a<b.length;a++)if(d=
b[a],!w.has(d.name))return c('missing required field "'+d.name+'"');return null};var e;a.simplify=function(a,b){if(!a||!q.isValid(b))return a;if("rings"in a||"paths"in a){if(!e)throw new TypeError("geometry engine not loaded");return e.simplify(b,a)}return a};a.loadGeometryEngine=d;a.loadGeometryEngineForSimplify=function(a,b){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){switch(c.label){case 0:return!q.isValid(a)||"esriGeometryPolygon"!==b&&"esriGeometryPolyline"!==
b?[3,2]:[4,d()];case 1:c.sent(),c.label=2;case 2:return[2]}})})}})},"esri/layers/support/fieldUtils":function(){define("require exports tslib @dojo/framework/shim/array ../../core/Error ../../core/maybe ../../core/object ../../core/promiseUtils ../../core/SetUtils ./domains ../../support/arcadeOnDemand @dojo/framework/shim/Promise".split(" "),function(x,a,r,q,g,c,d,b,n,m,w){function e(a,b,c){if(a)for(var e=0;e<a.length;e++){var g=a[e],m=d.getDeepValue(g,b);(m=m&&"function"!==typeof m&&D(c,m))&&d.setDeepValue(g,
m.name,b)}}function u(a,b){if(!a||!b)return[];Aa.clear();t(Aa,a,b);return n.valuesOfSet(Aa).sort()}function t(a,b,c){if(c)if(b&&b.length)if(q.includes(c,"*"))for(c=0;c<b.length;c++)a.add(b[c].name);else for(var d=0;d<c.length;d++)e=c[d],p(a,b,e);else if(q.includes(c,"*"))a.clear(),a.add("*");else for(b=0;b<c.length;b++){var e=c[b];a.add(e)}}function p(a,b,c){b&&b.length?(b=D(b,c))&&a.add(b.name):"string"===typeof c&&a.add(c)}function D(a,b){if("string"!==typeof b)return null;if(null!=a){b=b.toLowerCase();
for(var c=0;c<a.length;c++){var d=a[c];if(d&&d.name.toLowerCase()===b)return d}}return null}function E(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e,g,m,k;return r.__generator(this,function(l){switch(l.label){case 0:return c?[4,w.loadArcade()]:[2];case 1:d=l.sent().arcadeUtils;e=d.extractFieldNames(c);g=0;for(m=e;g<m.length;g++)k=m[g],p(a,b,k);return[2]}})})}function A(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d&&d.valueType&&d.valueType===b)return d.name}return null}function k(a,
b){return r.__awaiter(this,void 0,void 0,function(){var c,e;return r.__generator(this,function(g){if(!b)return[2];c=b.fields;return(e=d.getDeepValue("elevationInfo.featureExpressionInfo",b))?[2,e.collectRequiredFields(a,c)]:[2]})})}function J(a,b,c){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(d){c.outStatistic.onStatisticValueExpression?E(a,b,c.outStatistic.onStatisticValueExpression):a.add(c.outStatistic.onStatisticField);return[2]})})}function O(a,c){return r.__awaiter(this,
void 0,void 0,function(){var d,e;return r.__generator(this,function(g){switch(g.label){case 0:return d=c.labelingInfo,e=c.fields,d&&d.length?[4,b.all(d.map(function(b){return H(a,e,b)}))]:[2];case 1:return g.sent(),[2]}})})}function H(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e,g,m,k;return r.__generator(this,function(l){switch(l.label){case 0:if(!c)return[2];d=c.getLabelExpression();e=c.where;return"arcade"!==d.type?[3,2]:[4,E(a,b,d.expression)];case 1:return l.sent(),[3,3];case 2:(g=
d.expression.match(/{[^}]*}/g))&&g.forEach(function(c){p(a,b,c.slice(1,-1))}),l.label=3;case 3:return m=/['"]+/g,e&&(k=e.split(" "),3===k.length&&p(a,b,k[0].replace(m,"")),7===k.length&&(p(a,b,k[0].replace(m,"")),p(a,b,k[4].replace(m,"")))),[2]}})})}function L(a){return"number"===typeof a&&!isNaN(a)&&isFinite(a)}function B(a){return null===a||L(a)}function K(a){return null===a||T(a)}function P(a){return null!=a&&"string"===typeof a}function C(a){return null===a||P(a)}function F(){return!0}function v(a,
b){var c;switch(a.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":c=a.nullable?K:T;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":c=a.nullable?B:L;break;case "string":case "esriFieldTypeString":c=a.nullable?C:P;break;default:c=F}return 1===arguments.length?c:c(b)}function l(a){return null!=a&&qa.has(a.type)}function G(a,b){return a.nullable&&
null===b?null:l(a)&&!da(a.type,Number(b))?ha.OUT_OF_RANGE:v(a,b)?a.domain?m.validateDomainValue(a.domain,b):null:ga.INVALID_TYPE}function da(a,b){return(a="string"===typeof a?pa(a):a)?a.isInteger?T(b)&&b>=a.min&&b<=a.max:b>=a.min&&b<=a.max:!1}function pa(b){switch(b){case "esriFieldTypeSmallInteger":case "small-integer":return a.smallIntegerRange;case "esriFieldTypeInteger":case "integer":return a.integerRange;case "esriFieldTypeSingle":case "single":return a.singleRange;case "esriFieldTypeDouble":case "double":return a.doubleRange}}
function za(a,b,d){if(!b||!b.attributes||!a){if(c.isSome(d))for(var e=0;e<a.length;e++)b=a[e],d.add(b);return!0}for(var e=b.attributes,g=!1,m=0;m<a.length;m++)if(b=a[m],!(b in e))if(g=!0,c.isSome(d))d.add(b);else break;return g}Object.defineProperty(a,"__esModule",{value:!0});a.getExpressionFields=a.populateMissingFields=a.featureHasFields=a.validationErrorToString=a.doubleRange=a.singleRange=a.integerRange=a.smallIntegerRange=a.getNumericTypeForValue=a.getFieldRange=a.isNumberInRange=a.validateFieldValue=
a.sanitizeNullFieldValue=a.TypeValidationError=a.NumericRangeValidationError=a.isValidFieldValue=a.isDateField=a.isStringField=a.isNumericField=a.numericTypes=a.isValueMatchingFieldType=a.getFieldDefaultValue=a.collectLabelingFields=a.getLabelingFields=a.getFeatureGeometryFields=a.getFeatureEditFields=a.getTimeFields=a.collectFilterFields=a.collectFeatureReductionFields=a.collectElevationFields=a.getElevationFields=a.getDisplayFieldName=a.collectArcadeFieldNames=a.hasField=a.getField=a.packFields=
a.unpackFieldNames=a.collectField=a.collectFields=a.fixFields=a.fixTimeInfoFields=a.fixRendererFields=a.visualVariableFields=a.rendererFields=void 0;a.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");a.visualVariableFields=["field","normalizationField"];a.fixRendererFields=function(b,c){if(null!=b&&null!=c){var d=0;for(b=Array.isArray(b)?b:[b];d<
b.length;d++){var g=b[d];e(a.rendererFields,g,c);if("visualVariables"in g&&g.visualVariables)for(var m=0,g=g.visualVariables;m<g.length;m++)e(a.visualVariableFields,g[m],c)}}};a.fixTimeInfoFields=function(a,b){if(null!=a&&null!=b)if("startField"in a){var c=D(b,a.startField);b=D(b,a.endField);a.startField=c&&c.name||null;a.endField=b&&b.name||null}else c=D(b,a.startTimeField),b=D(b,a.endTimeField),a.startTimeField=c&&c.name||null,a.endTimeField=b&&b.name||null};var Aa=new Set;a.fixFields=u;a.collectFields=
t;a.collectField=p;a.unpackFieldNames=function(a,b){return b&&a?q.includes(b,"*")?a.map(function(a){return a.name}):b:[]};a.packFields=function(a,b,c){void 0===c&&(c=1);if(!b||!a)return[];if(q.includes(b,"*"))return["*"];b=u(a,b);return b.length/a.length>=c?["*"]:b};a.getField=D;a.hasField=function(a,b){if(!a||!b||"string"!==typeof b)return!1;b=b.toLowerCase();for(var c=0;c<a.length;c++){var d=a[c];if(d&&d.name.toLowerCase()===b)return!0}return!1};a.collectArcadeFieldNames=E;a.getDisplayFieldName=
function(a){var b=a.displayField;a=a.fields;if(b)return b;if(!a||!a.length)return null;if(!(b=A(a,"name-or-title")||A(a,"unique-identifier")||A(a,"type-or-category")))a:{for(b=0;b<a.length;b++){var c=a[b];if(c&&c.name){var d=c.name.toLowerCase();if(-1<d.indexOf("name")||-1<d.indexOf("title")){b=c.name;break a}}}b=null}return b};a.getElevationFields=function(a){return r.__awaiter(this,void 0,void 0,function(){var b;return r.__generator(this,function(c){switch(c.label){case 0:if(!a)return[2,[]];b=new Set;
return[4,k(b,a)];case 1:return c.sent(),[2,n.valuesOfSet(b).sort()]}})})};a.collectElevationFields=k;a.collectFeatureReductionFields=function(a,c,d){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return c&&d&&"cluster"===d.type&&d.fields?[4,b.all(d.fields.map(function(b){return J(a,c.fields,b)}))]:[2];case 1:return e.sent(),[2]}})})};a.collectFilterFields=function(a,b,c){return r.__awaiter(this,void 0,void 0,function(){var d,e;return r.__generator(this,
function(m){switch(m.label){case 0:if(!b||!c||!(c.where&&"1\x3d1"!==c.where||c.timeExtent))return[2];b.timeInfo&&c.timeExtent&&t(a,b.fields,[b.timeInfo.startField,b.timeInfo.endField]);return c.where?[4,new Promise(function(a,b){x(["../../core/sql/WhereClause"],a,b)})]:[3,2];case 1:d=m.sent();e=d.WhereClause.create(c.where,b.fieldsIndex);if(!e.isStandardized)throw new g("fieldUtils:collectFilterFields","Where clause is not standardized");t(a,b.fields,e.fieldNames);m.label=2;case 2:return[2]}})})};
a.getTimeFields=function(a){return r.__awaiter(this,void 0,void 0,function(){var b;return r.__generator(this,function(c){return a?(b="timeInfo"in a&&a.timeInfo)?[2,u(a.fields,[a.trackIdField,b.startField,b.endField])]:[2,[]]:[2,[]]})})};a.getFeatureEditFields=function(a){if(!a)return[];var b="editFieldsInfo"in a&&a.editFieldsInfo;return b?u(a.fields,[b&&b.creatorField,b&&b.creationDateField,b&&b.editorField,b&&b.editDateField]):[]};a.getFeatureGeometryFields=function(a){if(!a)return[];var b="geometryProperties"in
a&&a.geometryProperties;return b?u(a.fields,[b&&b.shapeAreaFieldName,b&&b.shapeLengthFieldName]):[]};a.getLabelingFields=function(a){return r.__awaiter(this,void 0,void 0,function(){var b;return r.__generator(this,function(c){switch(c.label){case 0:if(!a)return[2,[]];b=new Set;return[4,O(b,a)];case 1:return c.sent(),[2,n.valuesOfSet(b).sort()]}})})};a.collectLabelingFields=O;a.getFieldDefaultValue=function(a){var b=a.defaultValue;if(void 0!==b&&v(a,b))return b;if(a.nullable)return null};var T=function(){return"isInteger"in
Number?Number.isInteger:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}}();a.isValueMatchingFieldType=v;a.numericTypes=["integer","small-integer","single","double"];var qa=n.SetFromValues(r.__spreadArrays(a.numericTypes,["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));a.isNumericField=l;a.isStringField=function(a){return null!=a&&("string"===a.type||"esriFieldTypeString"===a.type)};a.isDateField=function(a){return null!=a&&("date"===
a.type||"esriFieldTypeDate"===a.type)};a.isValidFieldValue=function(a,b){return null===G(a,b)};var ha;(ha=a.NumericRangeValidationError||(a.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";var ga;(ga=a.TypeValidationError||(a.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";a.sanitizeNullFieldValue=function(a){return null==a||"number"===typeof a&&isNaN(a)?null:a};a.validateFieldValue=G;a.isNumberInRange=da;a.getFieldRange=function(a){var b=
m.getDomainRange(a.domain);if(b)return b;if(l(a))return pa(a.type)};a.getNumericTypeForValue=function(b){if(!L(b))return null;if(T(b)){if(b>=a.smallIntegerRange.min&&b<=a.smallIntegerRange.max)return"esriFieldTypeSmallInteger";if(b>=a.integerRange.min&&b<=a.integerRange.max)return"esriFieldTypeInteger"}return b>=a.singleRange.min&&b<=a.singleRange.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};a.smallIntegerRange={min:-32768,max:32767,isInteger:!0};a.integerRange={min:-2147483648,max:2147483647,
isInteger:!0};a.singleRange={min:-3.4E38,max:1.2E38,isInteger:!1};a.doubleRange={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};a.validationErrorToString=function(a,b,c){switch(a){case m.DomainValidationError.INVALID_CODED_VALUE:return"Value "+c+" is not in the coded domain - field: "+b.name+", domain: "+JSON.stringify(b.domain);case m.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+c+" is out of the range of valid values - field: "+b.name+", domain: "+JSON.stringify(b.domain);case ga.INVALID_TYPE:return"Value "+
c+" is not a valid value for the field type - field: "+b.name+", type: "+b.type+", nullable: "+b.nullable;case ha.OUT_OF_RANGE:return a=pa(b.type),"Value "+c+" is out of range for the number type - field: "+b.name+", type: "+b.type+", value range is "+a.min+" to "+a.max}};a.featureHasFields=function(a,b){return!za(a,b,null)};a.populateMissingFields=za;a.getExpressionFields=function(a,b){return r.__awaiter(this,void 0,void 0,function(){var c,d,e,g;return r.__generator(this,function(m){switch(m.label){case 0:c=
new Set,d=0,e=b,m.label=1;case 1:if(!(d<e.length))return[3,4];g=e[d];return[4,E(c,a.fields,g)];case 2:m.sent(),m.label=3;case 3:return d++,[3,1];case 4:return[2,n.valuesOfSet(c).sort()]}})})}})},"esri/layers/support/domains":function(){define("require exports ../../core/compilerUtils ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(x,a,r,q,g,c,d){function b(a,b){switch(a.type){case "range":var c="range"in a?a.range[1]:a.maxValue;if(+b<("range"in a?a.range[0]:a.minValue)||
+b>c)return n.VALUE_OUT_OF_RANGE;break;case "coded-value":case "codedValue":if(null==a.codedValues||a.codedValues.every(function(a){return null==a||a.code!==b}))return n.INVALID_CODED_VALUE}return null}Object.defineProperty(a,"__esModule",{value:!0});a.fromJSON=a.getDomainRange=a.types=a.validateDomainValue=a.isValidDomainValue=a.DomainValidationError=a.RangeDomain=a.InheritedDomain=a.DomainBase=a.CodedValueDomain=void 0;a.CodedValueDomain=q;a.DomainBase=g;a.InheritedDomain=c;a.RangeDomain=d;var n;
(function(a){a.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";a.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(n=a.DomainValidationError||(a.DomainValidationError={}));a.isValidDomainValue=function(a,c){return null===b(a,c)};a.validateDomainValue=b;a.types={key:"type",base:g,typeMap:{range:d,"coded-value":q,inherited:c}};a.getDomainRange=function(a){if(a&&"range"===a.type)return{min:"range"in a?a.range[0]:a.minValue,max:"range"in a?a.range[1]:a.maxValue}};a.fromJSON=
function(a){if(!a||!a.type)return null;switch(a.type){case "range":return d.fromJSON(a);case "codedValue":return q.fromJSON(a);case "inherited":return c.fromJSON(a);default:r.neverReached(a)}return null}})},"esri/layers/support/CodedValueDomain":function(){define("require exports tslib ../../core/lang ../../core/accessorSupport/decorators ./CodedValue ./Domain".split(" "),function(x,a,r,q,g,c,d){return function(a){function b(b){b=a.call(this,b)||this;b.codedValues=null;b.type="coded-value";return b}
r.__extends(b,a);d=b;b.prototype.getName=function(a){var b=null;if(this.codedValues){var c=String(a);this.codedValues.some(function(a){String(a.code)===c&&(b=a.name);return!!b})}return b};b.prototype.clone=function(){return new d({codedValues:q.clone(this.codedValues),name:this.name})};var d;r.__decorate([g.property({type:[c.default],json:{write:!0}})],b.prototype,"codedValues",void 0);r.__decorate([g.enumeration({codedValue:"coded-value"})],b.prototype,"type",void 0);return b=d=r.__decorate([g.subclass("esri.layers.support.CodedValueDomain")],
b)}(d)})},"esri/layers/support/CodedValue":function(){define(["require","exports","tslib","../../core/JSONSupport","../../core/accessorSupport/decorators"],function(x,a,r,q,g){Object.defineProperty(a,"__esModule",{value:!0});a.CodedValue=void 0;x=function(a){function c(b){b=a.call(this,b)||this;b.name=null;b.code=null;return b}r.__extends(c,a);b=c;c.prototype.clone=function(){return new b({name:this.name,code:this.code})};var b;r.__decorate([g.property({type:String,json:{write:!0}})],c.prototype,
"name",void 0);r.__decorate([g.property({type:[String,Number],json:{write:!0}})],c.prototype,"code",void 0);return c=b=r.__decorate([g.subclass("esri.layers.support.CodedValue")],c)}(q.JSONSupport);a.CodedValue=x;a.default=x})},"esri/layers/support/Domain":function(){define("require exports tslib ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(x,a,r,q,g,c){var d=new q.default({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(a){function b(b){b=
a.call(this,b)||this;b.name=null;b.type=null;return b}r.__extends(b,a);r.__decorate([c.property({type:String,json:{write:!0}})],b.prototype,"name",void 0);r.__decorate([c.enumeration(d)],b.prototype,"type",void 0);return b=r.__decorate([c.subclass("esri.layers.support.Domain")],b)}(g.JSONSupport)})},"esri/layers/support/InheritedDomain":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Domain"],function(x,a,r,q,g){return function(a){function c(b){b=a.call(this,
b)||this;b.type="inherited";return b}r.__extends(c,a);b=c;c.prototype.clone=function(){return new b};var b;r.__decorate([q.enumeration({inherited:"inherited"})],c.prototype,"type",void 0);return c=b=r.__decorate([q.subclass("esri.layers.support.InheritedDomain")],c)}(g)})},"esri/layers/support/RangeDomain":function(){define(["require","exports","tslib","../../core/accessorSupport/decorators","./Domain"],function(x,a,r,q,g){return function(a){function c(b){b=a.call(this,b)||this;b.maxValue=null;b.minValue=
null;b.type="range";return b}r.__extends(c,a);b=c;c.prototype.clone=function(){return new b({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};var b;r.__decorate([q.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(a,b){return b.range&&b.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(a,b,c){b[c]=[this.minValue||0,a]}}}})],c.prototype,"maxValue",void 0);r.__decorate([q.property({type:Number,
json:{type:[Number],read:{source:"range",reader:function(a,b){return b.range&&b.range[0]}},write:{target:"range",writer:function(a,b,c){b[c]=[a,this.maxValue||0]}}}})],c.prototype,"minValue",void 0);r.__decorate([q.enumeration({range:"range"})],c.prototype,"type",void 0);return c=b=r.__decorate([q.subclass("esri.layers.support.RangeDomain")],c)}(g)})},"esri/support/arcadeOnDemand":function(){define("require exports tslib ../geometry ../core/maybe ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),
function(x,a,r,q,g,c){function d(){return r.__awaiter(this,void 0,void 0,function(){var a=this;return r.__generator(this,function(c){b||(b=function(){return r.__awaiter(a,void 0,void 0,function(){var a;return r.__generator(this,function(b){switch(b.label){case 0:return[4,new Promise(function(a,b){x(["./arcadeUtils"],a,b)})];case 1:return a=b.sent(),[4,a.arcade.load()];case 2:return b.sent(),[2,{arcade:a.arcade,arcadeUtils:a,Dictionary:a.Dictionary,Feature:a.arcadeFeature}]}})})}());return[2,b]})})}
Object.defineProperty(a,"__esModule",{value:!0});a.ArcadeExpression=a.createDictionaryExpression=a.createVVExpression=a.createRendererExpression=a.createLabelExpression=a.loadArcade=void 0;var b;a.loadArcade=d;a.createLabelExpression=function(a,b,c){return n.create(a,b,c,null,["$feature"])};a.createRendererExpression=function(a,b,c){return n.create(a,b,c,null,["$feature","$view"])};a.createVVExpression=a.createRendererExpression;a.createDictionaryExpression=function(a,b,c,d){return n.create(a,b,c,
d,["$feature","$view"])};var n=function(){function a(a,b,c,d,g,m,n,r){this.script=a;this.evaluate=g;this.fields=n;this._syntaxTree=d;this._arcade=b;this._arcadeDictionary=c;this._arcadeFeature=m;this._spatialReference=r;this._referencesGeometry=b.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}a.create=function(b,e,m,n,p,x){return r.__awaiter(this,void 0,void 0,function(){var t,u,k,w,D,H,L,B,K,P,C,F,v,l,G;return r.__generator(this,
function(A){switch(A.label){case 0:return[4,d()];case 1:return t=A.sent(),u=t.arcade,k=t.Feature,w=t.Dictionary,D=q.SpatialReference.fromJSON(e),H=u.parseScript(b,x),L=p.reduce(function(a,b){var c;return r.__assign(r.__assign({},a),(c={},c[b]=null,c))},{}),B=null,g.isSome(n)&&(B=new w(n),B.immutable=!0,L.$config=null),K=u.scriptUsesGeometryEngine(H)&&u.enableGeometrySupport(),P=u.scriptUsesFeatureSet(H)&&u.enableFeatureSetSupport(),C=u.scriptIsAsync(H)&&u.enableAsyncSupport(),F={vars:L,spatialReference:D,
useAsync:!!C},v=new w,v.immutable=!1,v.setField("scale",0),l=u.compileScript(H,F),G=function(a){"$view"in a&&a.$view&&(v.setField("scale",a.$view.scale),a.$view=v);B&&(a.$config=B);return l({vars:a,spatialReference:D})},[4,c.all([K,P,C])];case 2:return A.sent(),[2,new a(b,u,w,H,G,new k,m,D)]}})})};a.prototype.repurposeFeature=function(a){a.geometry&&!a.geometry.spatialReference&&(a.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(a.geometry,a.attributes,
{fields:this.fields});return this._arcadeFeature};a.prototype.repurposeAdapter=function(a){this._arcadeFeature.repurposeFromAdapter(a,{fields:this.fields});return this._arcadeFeature};a.prototype.createDictionary=function(){return new this._arcadeDictionary};a.prototype.referencesMember=function(a){return this._arcade.referencesMember(this._syntaxTree,a)};a.prototype.referencesFunction=function(a){return this._arcade.referencesFunction(this._syntaxTree,a)};a.prototype.referencesGeometry=function(){return this._referencesGeometry};
a.prototype.referencesScale=function(){return this._referencesScale};a.prototype.extractFieldLiterals=function(a){return this._arcade.extractFieldLiterals(this._syntaxTree,a)};return a}();a.ArcadeExpression=n;a.default=n})},"esri/layers/support/fieldType":function(){define(["require","exports","../../core/jsonMap"],function(x,a,r){Object.defineProperty(a,"__esModule",{value:!0});a.kebabDict=void 0;a.kebabDict=new r.default({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",
esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})})},"*noref":1}});
define("require exports tslib ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ./sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(x,a,r,q,g,c,d,b,n,m,w,e,u,t,p,D){function E(a){return c.isPoint(a)?null!=a.z:!!a.hasZ}
function A(a){return c.isPoint(a)?null!=a.m:!!a.hasM}Object.defineProperty(a,"__esModule",{value:!0});var k=d.WGS84,J={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:d.WGS84},O={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,
supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};x=function(){function a(){this._nextObjectId=this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null};
a.prototype.load=function(a){return r.__awaiter(this,void 0,void 0,function(){var b,c,d,g,u,v,l,x,A,L,E,H,T,qa,ha,ga,M,I,la,W,Q,Y,S,ba,ma,ka,ia;return r.__generator(this,function(B){switch(B.label){case 0:b=[];c=a.features;d=this._inferLayerProperties(c,a.fields);g=a.fields||[];u=null!=a.hasM?a.hasM:d.hasM;v=null!=a.hasZ?a.hasZ:d.hasZ;x=(l=!a.spatialReference&&!d.spatialReference)?k:a.spatialReference||d.spatialReference;A=l?J:null;L=a.geometryType||d.geometryType;E=!L;H=a.objectIdField||d.objectIdField;
T=a.timeInfo;if(!E&&(l&&b.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!L))throw new q("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!H)throw new q("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");d.objectIdField&&H!==d.objectIdField&&(b.push({name:"feature-layer:duplicated-oid-field",message:'Provided objectIdField "'+
H+'" doesn\'t match the field name "'+d.objectIdField+'", found in the provided fields'}),H=d.objectIdField);H&&!d.objectIdField&&(qa=null,(ha=g.some(function(a){return a.name===H?(qa=a,!0):!1}))?(qa.type="esriFieldTypeOID",qa.editable=!1,qa.nullable=!1):g.unshift({alias:H,name:H,type:"esriFieldTypeOID",editable:!1,nullable:!1}));ga=0;for(M=g;ga<M.length;ga++){I=M[ga];null==I.name&&(I.name=I.alias);null==I.alias&&(I.alias=I.name);if(!I.name)throw new q("feature-layer:invalid-field-name","field name is missing",
{field:I});I.name===H&&(I.type="esriFieldTypeOID");if(-1===p.kebabDict.jsonValues.indexOf(I.type))throw new q("feature-layer:invalid-field-type",'invalid type for field "'+I.name+'"',{field:I});}la={};this._requiredFields=[];W=0;for(Q=g;W<Q.length;W++)I=Q[W],"esriFieldTypeOID"!==I.type&&"esriFieldTypeGlobalID"!==I.type&&(I.editable=null==I.editable?!0:!!I.editable,I.nullable=null==I.nullable?!0:!!I.nullable,Y=D.getFieldDefaultValue(I),I.nullable||void 0!==Y?la[I.name]=Y:this._requiredFields.push(I));
this._fieldsIndex=new t(g);this._createDefaultAttributes=e.createDefaultAttributesFunction(la,H);T&&(T.startTimeField&&((S=this._fieldsIndex.get(T.startTimeField))?(T.startTimeField=S.name,S.type="esriFieldTypeDate"):T.startTimeField=null),T.endTimeField&&((ba=this._fieldsIndex.get(T.endTimeField))?(T.endTimeField=ba.name,ba.type="esriFieldTypeDate"):T.endTimeField=null),T.trackIdField&&((ma=this._fieldsIndex.get(T.trackIdField))?T.trackIdField=ma.name:(T.trackIdField=null,b.push({name:"feature-layer:invalid-timeInfo-trackIdField",
message:"trackIdField is missing",details:{timeInfo:T}}))),T.startTimeField||T.endTimeField||(b.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:T}}),T=null));ka={warnings:b,featureErrors:[],layerDefinition:r.__assign(r.__assign({},O),{drawingInfo:e.createDrawingInfo(L),templates:e.createDefaultTemplate(la),extent:A,geometryType:L,objectIdField:H,fields:g,hasZ:!!v,hasM:!!u,timeInfo:T}),assignedObjectIds:{}};this._queryEngine=
new w.default({fields:g,geometryType:L,hasM:u,hasZ:v,objectIdField:H,spatialReference:x,featureStore:new n.default({geometryType:L,hasM:u,hasZ:v}),timeInfo:T});if(!c||!c.length)return this._nextObjectId=1,[2,ka];ia=c.reduce(function(a,b){b=b.attributes&&b.attributes[H];return null==b||isNaN(b)||!isFinite(b)?a:Math.max(a,b)},0);this._nextObjectId=1+ia;return[4,m.checkProjectionSupport(c,x)];case 1:return B.sent(),[2,this._loadInitialFeatures(ka,c)]}})})};a.prototype.applyEdits=function(a){return r.__awaiter(this,
void 0,void 0,function(){var b,c,d;return r.__generator(this,function(e){switch(e.label){case 0:return b=this._queryEngine,c=b.spatialReference,d=b.geometryType,[4,g.all([u.loadGeometryEngineForSimplify(c,d),m.checkProjectionSupport(a.adds,c),m.checkProjectionSupport(a.updates,c)])];case 1:return e.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,b){void 0===b&&(b={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQuery(a,
b.signal)]})})};a.prototype.queryFeatureCount=function(a,b){void 0===b&&(b={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};a.prototype.queryObjectIds=function(a,b){void 0===b&&(b={});return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};a.prototype.queryExtent=function(a,b){void 0===b&&(b={});return r.__awaiter(this,
void 0,void 0,function(){return r.__generator(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};a.prototype._inferLayerProperties=function(a,b){for(var d=void 0,e=void 0,g=null,k=null,m=null,l=0;l<a.length;l++){var n=a[l].geometry;if(n&&(g||(g=c.getJsonType(n)),k||(k=n.spatialReference),null==d&&(d=E(n)),null==e&&(e=A(n)),g&&k&&null!=d&&null!=e))break}if(b&&b.length){var p=null;b.some(function(a){var b="esriFieldTypeOID"===a.type,c=!a.type&&a.name&&"objectid"===a.name.toLowerCase();
p=a;return b||c})&&(m=p.name)}return{geometryType:g,spatialReference:k,objectIdField:m,hasM:e,hasZ:d}};a.prototype._loadInitialFeatures=function(a,d){for(var e=this._queryEngine,g=e.geometryType,k=e.hasM,n=e.hasZ,p=e.objectIdField,l=e.spatialReference,e=e.featureStore,r=[],q=0;q<d.length;q++){var t=d[q];null!=t.uid&&(a.assignedObjectIds[t.uid]=-1);if(t.geometry&&g!==c.getJsonType(t.geometry))a.featureErrors.push(u.createFeatureEditErrorResult("Incorrect geometry type."));else{var w=this._createDefaultAttributes(),
x=u.mixAttributes(this._fieldsIndex,this._requiredFields,w,t.attributes,!0,a.warnings);x?a.featureErrors.push(x):(this._assignObjectId(w,t.attributes,!0),t.attributes=w,null!=t.uid&&(a.assignedObjectIds[t.uid]=t.attributes[p]),t.geometry&&(t.geometry=m.project(t.geometry,t.geometry.spatialReference,l)),r.push(t))}}e.addMany(b.convertFromFeatures([],r,g,n,k,p));a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(d=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=
[d.start,d.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(d,b);c&&c.length&&this._applyUpdateEdits(d,c);if(a&&a.length){for(b=0;b<a.length;b++)d.deleteResults.push(u.createFeatureEditSuccessResult(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:d}};a.prototype._applyAddEdits=function(a,
d){for(var e=a.addResults,g=this._queryEngine,k=g.geometryType,n=g.hasM,p=g.hasZ,l=g.objectIdField,r=g.spatialReference,g=g.featureStore,q=[],t=0;t<d.length;t++){var w=d[t];if(w.geometry&&k!==c.getJsonType(w.geometry))e.push(u.createFeatureEditErrorResult("Incorrect geometry type."));else{var x=this._createDefaultAttributes(),A=u.mixAttributes(this._fieldsIndex,this._requiredFields,x,w.attributes);A?e.push(A):(this._assignObjectId(x,w.attributes),w.attributes=x,null!=w.uid&&(a.uidToObjectId[w.uid]=
w.attributes[l]),w.geometry&&(w.geometry=m.project(u.simplify(w.geometry,r),w.geometry.spatialReference,r)),q.push(w),e.push(u.createFeatureEditSuccessResult(w.attributes[l])))}}g.addMany(b.convertFromFeatures([],q,k,p,n,l))};a.prototype._applyUpdateEdits=function(a,d){a=a.updateResults;for(var e=this._queryEngine,g=e.geometryType,k=e.hasM,n=e.hasZ,p=e.objectIdField,l=e.spatialReference,e=e.featureStore,r=0;r<d.length;r++){var q=d[r],t=q.attributes,w=q.geometry,q=t&&t[p];if(null==q)a.push(u.createFeatureEditErrorResult("Identifier field "+
p+" missing"));else if(e.has(q)){var x=b.convertToFeature(e.getFeature(q),g,n,k);if(w){if(g!==c.getJsonType(w)){a.push(u.createFeatureEditErrorResult("Incorrect geometry type."));continue}x.geometry=m.project(u.simplify(w,l),w.spatialReference,l)}if(t&&(t=u.mixAttributes(this._fieldsIndex,this._requiredFields,x.attributes,t))){a.push(t);continue}e.add(b.convertFromFeature(x,g,n,k,p));a.push(u.createFeatureEditSuccessResult(q))}else a.push(u.createFeatureEditErrorResult("Feature with object id "+q+
" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var d=this._queryEngine.objectIdField;c?b&&isFinite(b[d])?a[d]=b[d]:a[d]=this._nextObjectId++:a[d]=this._nextObjectId++};return a}();a.default=x});