// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../core/compilerUtils ../../core/has ../../core/maybe ../../core/typedArrayUtil ../../core/uid ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/quantizationUtils ../../geometry/support/typeUtils ../support/Field ./dehydratedFeatureComparison".split(" "),function(l,c,h,z,p,m,A,B,f,k,n,q,C,D){function r(a,b,d){if(!a)return null;switch(b){case "point":return a={x:a.x,y:a.y,z:a.z,m:a.m,hasZ:null!=
a.z,hasM:null!=a.m,type:"point",spatialReference:d};case "polyline":return a={paths:a.paths,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polyline",spatialReference:d};case "polygon":return a={rings:a.rings,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polygon",spatialReference:d};case "multipoint":return a={points:a.points,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"multipoint",spatialReference:d}}}function t(a){if(!a)return 0;var b=32,d;for(d in a)if(a.hasOwnProperty(d)){var c=a[d];switch(typeof c){case "string":b+=E(c);break;default:case "number":b+=
16}}return b}function u(a){if(p.isNone(a))return 0;var b=32;switch(a.type){case "point":b+=42;break;case "polyline":case "polygon":var d=0,c=2+(a.hasZ?1:0)+(a.hasM?1:0);a="polyline"===a.type?a.paths:a.rings;for(var f=0;f<a.length;f++)d+=a[f].length;b=b+(8*d*c+64)+128*d+34;b+=32*(a.length+1);break;case "multipoint":c=2+(a.hasZ?1:0)+(a.hasM?1:0);d=a.points.length;b+=8*d*c+64;b+=128*d;b+=34;b+=32;break;case "extent":b+=98;a.hasM&&(b+=32);a.hasZ&&(b+=32);break;case "mesh":b+=m.estimateSize(a.vertexAttributes.position);
b+=m.estimateSize(a.vertexAttributes.normal);b+=m.estimateSize(a.vertexAttributes.uv);b+=m.estimateSize(a.vertexAttributes.tangent);break;default:h.neverReached(a)}return b}function v(a,b){f.empty(b);"mesh"===a.type&&(a=a.extent);switch(a.type){case "point":b[0]=b[3]=a.x;b[1]=b[4]=a.y;a.hasZ&&(b[2]=b[5]=a.z);break;case "polyline":for(var d=0;d<a.paths.length;d++)f.expandWithNestedArray(b,a.paths[d],a.hasZ);break;case "polygon":for(d=0;d<a.rings.length;d++)f.expandWithNestedArray(b,a.rings[d],a.hasZ);
break;case "multipoint":f.expandWithNestedArray(b,a.points,a.hasZ);break;case "extent":b[0]=a.xmin;b[1]=a.ymin;b[3]=a.xmax;b[4]=a.ymax;null!=a.zmin&&(b[2]=a.zmin);null!=a.zmax&&(b[5]=a.zmax);break;default:h.neverReached(a)}}function w(a,b){k.empty(b);"mesh"===a.type&&(a=a.extent);switch(a.type){case "point":b[0]=b[2]=a.x;b[1]=b[3]=a.y;break;case "polyline":for(var d=0;d<a.paths.length;d++)k.expandWithNestedArray(b,a.paths[d]);break;case "polygon":for(d=0;d<a.rings.length;d++)k.expandWithNestedArray(b,
a.rings[d]);break;case "multipoint":k.expandWithNestedArray(b,a.points);break;case "extent":b[0]=a.xmin;b[1]=a.ymin;b[2]=a.xmax;b[3]=a.ymax;break;default:h.neverReached(a)}}Object.defineProperty(c,"__esModule",{value:!0});c.getObjectId=c.expandAABR=c.computeAABR=c.expandAABB=c.computeAABB=c.hasVertices=c.numVertices=c.estimateSize=c.estimateGeometryObjectSize=c.estimateAttributesObjectSize=c.makeDehydratedPoint=c.fromJSONGeometry=c.fromFeatureSetJSON=c.isDehydratedPoint=c.DehydratedFeatureSetClass=
c.isFeatureGeometry=c.hasGeometry=c.DehydratedFeatureClass=void 0;Object.defineProperty(c,"equals",{enumerable:!0,get:function(){return D.equals}});l=function(){return function(a,b,d){this.uid=a;this.geometry=b;this.attributes=d;this.visible=!0;this.centroid=this.objectId=null}}();c.DehydratedFeatureClass=l;c.hasGeometry=function(a){return p.isSome(a.geometry)};c.isFeatureGeometry=function(a){return q.isFeatureGeometryType(a.type)};l=function(){return function(){this.exceededTransferLimit=!1;this.features=
[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null}}();c.DehydratedFeatureSetClass=l;c.isDehydratedPoint=function(a){return"point"===a.type};c.fromFeatureSetJSON=function(a){var b=q.featureGeometryTypeKebabDictionary.fromJSON(a.geometryType),d=B.fromJSON(a.spatialReference),c=a.transform,f=a.features.map(function(g){var e=a.objectIdFieldName;g={uid:A.generateUID(),
objectId:e&&g.attributes?g.attributes[e]:null,attributes:g.attributes,geometry:r(g.geometry,b,d),visible:!0};if((e=g.geometry)&&c)switch(e.type){case "point":g.geometry=n.unquantizePoint(c,e,e,e.hasZ,e.hasM);break;case "multipoint":g.geometry=n.unquantizeMultipoint(c,e,e,e.hasZ,e.hasM);break;case "polygon":g.geometry=n.unquantizePolygon(c,e,e,e.hasZ,e.hasM);break;case "polyline":g.geometry=n.unquantizePolyline(c,e,e,e.hasZ,e.hasM);break;default:h.neverReached(e)}return g});return{geometryType:b,features:f,
spatialReference:d,fields:a.fields?a.fields.map(function(a){return C.fromJSON(a)}):null,objectIdFieldName:a.objectIdFieldName,globalIdFieldName:a.globalIdFieldName,geohashFieldName:a.geohashFieldName,geometryProperties:a.geometryProperties,hasZ:a.hasZ,hasM:a.hasM,exceededTransferLimit:a.exceededTransferLimit,transform:null}};c.fromJSONGeometry=r;c.makeDehydratedPoint=function(a,b,c,f){return{x:a,y:b,z:c,hasZ:null!=c,hasM:!1,spatialReference:f,type:"point"}};var E=z("esri-text-decoder")?function(a){return 32+
a.length}:function(a){return 32*a.length};c.estimateAttributesObjectSize=t;c.estimateGeometryObjectSize=u;c.estimateSize=function(a){var b;b=32+t(a.attributes);return b=b+3+(8+u(a.geometry))};c.numVertices=function(a){if(p.isNone(a))return 0;switch(a.type){case "point":return 1;case "polyline":var b=0,c=0;for(a=a.paths;c<a.length;c++)b+=a[c].length;return b;case "polygon":c=b=0;for(a=a.rings;c<a.length;c++)b+=a[c].length;return b;case "multipoint":return a.points.length;case "extent":return 2;case "mesh":return(b=
a.vertexAttributes&&a.vertexAttributes.position)?b.length/3:0;default:h.neverReached(a)}};c.hasVertices=function(a){if(!a)return!1;switch(a.type){case "extent":case "point":return!0;case "polyline":var b=0;for(a=a.paths;b<a.length;b++)if(0<a[b].length)return!0;return!1;case "polygon":b=0;for(a=a.rings;b<a.length;b++)if(0<a[b].length)return!0;return!1;case "multipoint":return 0<a.points.length;case "mesh":return a.vertexAttributes&&a.vertexAttributes.position&&0<a.vertexAttributes.position.length;
default:h.neverReached(a)}};c.computeAABB=v;c.expandAABB=function(a,b){v(a,x);f.expand(b,x)};c.computeAABR=w;c.expandAABR=function(a,b){w(a,y);k.expand(b,y)};c.getObjectId=function(a,b){return null!=a.objectId?a.objectId:a.attributes&&b?a.attributes[b]:null};var x=f.create(),y=k.create()});