// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../core/Error ../../core/lang ../../core/maybe ../../core/object ../../core/SetUtils ../../core/accessorSupport/extensions/serializableProperty/writer".split(" "),function(q,c,m,n,k,p,l,e){function f(a){return!("feature"!==a.type||a.url||!a.source||"memory"!==a.source.type)}Object.defineProperty(c,"__esModule",{value:!0});c.getLayerJSON=c.disableRestrictedWriting=c.enableRestrictedWriting=void 0;var g=l.SetFromValues("bing-maps open-street-map tile unknown unsupported vector-tile web-tile".split(" ")),
h=l.SetFromValues("feature group tile unknown unsupported vector-tile web-tile".split(" "));c.enableRestrictedWriting=function(a){g.delete(a);h.delete(a)};c.disableRestrictedWriting=function(a){g.add(a);h.add(a)};c.getLayerJSON=function(a,c,b){if(!("write"in a&&a.write))return b&&b.messages&&b.messages.push(new m("layer:unsupported","Layers ("+a.title+", "+a.id+") of type '"+a.declaredClass+"' cannot be persisted",{layer:a})),null;var d;b.restrictedWebMapWriting?(d="basemap"===b.layerContainerType?
g:"operational-layers"===b.layerContainerType?h:null,d=k.isSome(d)?d.has(a.type)&&!f(a):!0):d=!0;if(d)return c={},a.write(c,b)?c:null;if(k.isSome(c)){b=c=n.clone(c);if(f(a)){if(d=(d=p.getDeepValue("featureCollection.layers",b))&&d[0]&&d[0].layerDefinition)"maxScale"in a&&(d.maxScale=e.numberToJSON(a.maxScale)),"minScale"in a&&(d.minScale=e.numberToJSON(a.minScale))}else"group"!==a.type&&("maxScale"in a&&(b.maxScale=e.numberToJSON(a.maxScale)),"minScale"in a&&(b.minScale=e.numberToJSON(a.minScale)));
"blendMode"in a&&(b.blendMode=a.blendMode,"normal"===b.blendMode&&delete b.blendMode);b.opacity=e.numberToJSON(a.opacity);b.title=a.title||"Layer";b.visibility=a.visible;if("legendEnabled"in a&&"wmts"!==a.type)if(f(a)){if(b=b.featureCollection)b.showLegend=a.legendEnabled}else b.showLegend=a.legendEnabled}return c}});