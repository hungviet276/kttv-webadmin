// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../PopupTemplate ../../core/Error ../../core/promiseUtils ../../intl/messages ./support/utils".split(" "),function(y,k,l,r,m,v,w,t){function x(n){return l.__awaiter(this,void 0,void 0,function(){var c,d,b,a;return l.__generator(this,function(e){switch(e.label){case 0:return c=n.layer,d=n.renderer,[4,c.load()];case 1:e.sent();b=d||c.renderer;if("unique-value"!==b.type)throw new m("relationship-popup:invalid-parameters","renderer.type must be 'unique-value'");a=b.authoringInfo;
if(!a||"relationship"!==a.type)throw new m("relationship-popup:invalid-parameters","renderer.authoringInfo.type must be 'relationship'");if(!(a.field1&&a.field1.field&&a.field2&&a.field2.field))throw new m("relationship-popup:invalid-parameters","'field1' and/or 'field2' properties are missing in renderer.authoringInfo");return[2,{layer:c,renderer:b}]}})})}function u(n,c,d){void 0===d&&(d="divide");return l.__awaiter(this,void 0,void 0,function(){var b,a,e,p,f;return l.__generator(this,function(h){switch(h.label){case 0:return[4,
t.getFieldAndExpressionInfos({renderer:n,layer:c,normFieldExpressionTemplate:d})];case 1:return b=h.sent(),a=b.fieldInfos,e=b.expressionInfos,p=r.bind,f={},[4,t.getContentFromFieldInfos(c,{fieldInfos:a,expressionInfos:e})];case 2:return[2,new (p.apply(r,[void 0,(f.content=h.sent(),f.fieldInfos=a,f.expressionInfos=e,f)]))]}})})}Object.defineProperty(k,"__esModule",{value:!0});k.getTemplates=void 0;k.getTemplates=function(n){return l.__awaiter(this,void 0,void 0,function(){var c,d,b,a,e,p,f,h,k,m,q;
return l.__generator(this,function(g){switch(g.label){case 0:return[4,v.all([x(n),w.loadMessageBundle("esri/smartMapping/t9n/smartMapping")])];case 1:return c=g.sent(),d=c[0],b=d.renderer,a=d.layer,e=c[1],f={name:"relationship",title:e.relationshipPopupTitle},[4,u(b,a)];case 2:p=(f.value=g.sent(),f);h=[];g=b.authoringInfo;if(!g.field1.normalizationField&&!g.field2.normalizationField)return[3,4];m=(k=h).push;q={name:"relationship-percent",title:e.relationshipNormFieldAsPercent};return[4,u(b,a,"percentage")];
case 3:m.apply(k,[(q.value=g.sent(),q)]),g.label=4;case 4:return[2,{primaryTemplate:p,secondaryTemplates:h}]}})})}});