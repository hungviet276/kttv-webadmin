// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../core/Error","../../support/utils","../../support/adapters/support/layerUtils"],function(q,c,h,k,n){function p(a){a=a.map(function(a){return'$feature["'+a+'"];'});return a.length?a.join("\n")+"\n":""}function l(a,e,f){a="number"===e?a:"date"===e?a.getTime():'$feature["'+a+'"]';return"var "+f+" \x3d "+a+";"}Object.defineProperty(c,"__esModule",{value:!0});c.getAgeExpressions=c.verifyDates=c.supportedAgeUnits=void 0;var m=["date","number"];c.supportedAgeUnits="years months days hours minutes seconds".split(" ");
c.verifyDates=function(a,e,f,b){var d=[],g=null;[e,f].every(function(b){(b=k.getDateType(a,b))&&d.push(b);return!!b})?d[0]===d[1]?"field"===d[0]?e===f&&(g=new h(b,"'startTime' and 'endTime' parameters cannot be identical")):g=new h(b,"Invalid combination of 'startTime' and 'endTime' parameters"):-1<m.indexOf(d[0])&&-1<m.indexOf(d[1])&&(g=new h(b,"Invalid combination of 'startTime' and 'endTime' parameters")):g=new h(b,"'startTime' and 'endTime' parameters must be one of these values: a date object, unix epoch time, name of a valid date field or \x3cnow\x3e");
return g};c.getAgeExpressions=function(a){var e=a.startTime,f=a.endTime,b=n.createLayerAdapter(a.layer),d=a.unit||"days";a=k.getDateDiffSQL(b,e,f,d);var g=k.getDateType(b,e),b=k.getDateType(b,f),d=[l(e,g,"startTime"),l(f,b,"endTime"),'var retVal \x3d null;\n\n    if (startTime !\x3d null \x26\x26 endTime !\x3d null) {\n      startTime \x3d Date(startTime);\n      endTime \x3d Date(endTime);\n      retVal \x3d DateDiff(endTime, startTime, "'+d+'");\n    }\n\n    return retVal;'],c=[];"field"===g&&
c.push(e);"field"===b&&c.push(f);return{valueExpression:p(c)+d.join("\n"),statisticsQuery:a,histogramQuery:a}}});