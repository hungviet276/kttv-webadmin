// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../core/Error ../../core/maybe ../../renderers/support/AuthoringInfo ./color ./size ./support/utils ../support/utils ../support/adapters/support/layerUtils".split(" "),function(D,m,c,l,p,x,y,q,r,t,n){function z(a){return c.__awaiter(this,void 0,void 0,function(){var b,e,f,k,d,g;return c.__generator(this,function(h){switch(h.label){case 0:if(!(a&&a.layer&&(a.field||a.valueExpression||a.sqlExpression)))throw new l("univariate-colorsize-visual-variables:missing-parameters",
"'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(a.valueExpression&&!a.sqlExpression&&!a.view)throw new l("univariate-colorsize-visual-variables:missing-parameters","View is required when 'valueExpression' is specified");b=c.__assign({},a);e=[0,2,1,3];f=n.createLayerAdapter(b.layer,e);b.layer=f;if(!f)throw new l("univariate-colorsize-visual-variables:invalid-parameters","'layer' must be one of these types: "+n.getLayerTypeLabels(e).join(", "));k=p.isSome(b.signal)?
{signal:b.signal}:null;return[4,f.load(k)];case 1:return h.sent(),[4,t.getFieldsList({field:b.field,normalizationField:b.normalizationField,valueExpression:b.valueExpression})];case 2:d=h.sent();if(g=r.verifyBasicFieldValidity(f,d,"univariate-colorsize-visual-variables:invalid-parameters"))throw g;return[2,b]}})})}function u(a,b){a=c.__assign({},a);b=0===b?a.colorOptions:a.sizeOptions;delete a.sizeOptions;delete a.colorOptions;return c.__assign(c.__assign({},a),b)}function A(a){return c.__awaiter(this,
void 0,void 0,function(){var b,e,f,k,d,g;return c.__generator(this,function(h){switch(h.label){case 0:if(!(a&&a.layer&&(a.field||a.valueExpression||a.sqlExpression)))throw new l("univariate-colorsize-continuous-renderer:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(a.valueExpression&&!a.sqlExpression&&!a.view)throw new l("univariate-colorsize-continuous-renderer:missing-parameters","View is required when 'valueExpression' is specified");
b=c.__assign({},a);b.symbolType=b.symbolType||"2d";e=[0,2,1,3];f=n.createLayerAdapter(b.layer,e);b.layer=f;if(!f)throw new l("univariate-colorsize-continuous-renderer:invalid-parameters","'layer' must be one of these types: "+n.getLayerTypeLabels(e).join(", "));k=p.isSome(b.signal)?{signal:b.signal}:null;return[4,f.load(k)];case 1:return h.sent(),[4,t.getFieldsList({field:b.field,normalizationField:b.normalizationField,valueExpression:b.valueExpression})];case 2:d=h.sent();if(g=r.verifyBasicFieldValidity(f,
d,"univariate-colorsize-continuous-renderer:invalid-parameters"))throw g;return[2,b]}})})}function B(a){a=c.__assign({},a);var b=c.__assign({},a.sizeOptions);delete a.sizeOptions;delete a.colorOptions;delete b.sizeOptimizationEnabled;return c.__assign(c.__assign({},a),b)}function C(a){a=c.__assign({},a);var b=a.symbolType,e=-1<b.indexOf("3d-volumetric");delete a.symbolType;delete a.defaultSymbolEnabled;if(a.worldScale=e)a.sizeOptions=c.__assign({},a.sizeOptions),a.sizeOptions.axis="3d-volumetric-uniform"===
b?"all":"height";return a}function v(a){return c.__awaiter(this,void 0,void 0,function(){var b,e,f,k,d,g,h,w,l,m,n;return c.__generator(this,function(c){switch(c.label){case 0:return[4,z(a)];case 1:return b=c.sent(),[4,y.createVisualVariable(u(b,0))];case 2:return f=c.sent(),k=u(b,1),k.statistics=f.statistics,e=f,[4,q.createVisualVariables(k)];case 3:return d=c.sent(),g=e.visualVariable,h=d.visualVariables,w=g.stops.length,h.forEach(function(a){null!=a.minDataValue&&(a.minDataValue=g.stops[0].value,
a.maxDataValue=g.stops[w-1].value)}),l=e.authoringInfo.visualVariables[0],m=d.authoringInfo.visualVariables[0],n=new x({type:"univariate-color-size",visualVariables:[l.clone(),m.clone()]}),[2,{basemapId:d.basemapId,basemapTheme:d.basemapTheme,statistics:e.statistics,defaultValuesUsed:e.defaultValuesUsed,color:{visualVariable:g,colorScheme:e.colorScheme},size:{visualVariables:h,sizeScheme:d.sizeScheme},authoringInfo:n}]}})})}Object.defineProperty(m,"__esModule",{value:!0});m.createContinuousRenderer=
m.createVisualVariables=void 0;m.createVisualVariables=v;m.createContinuousRenderer=function(a){return c.__awaiter(this,void 0,void 0,function(){var b,e,f,k,d,g,h;return c.__generator(this,function(c){switch(c.label){case 0:return[4,A(a)];case 1:return b=c.sent(),[4,q.createContinuousRenderer(B(b))];case 2:return f=c.sent(),k=C(b),k.statistics=f.statistics,e=f,[4,v(k)];case 3:return d=c.sent(),g=e.renderer,h=d.size.visualVariables.map(function(a){return a.clone()}),h.push(d.color.visualVariable.clone()),
g.visualVariables=h,g.authoringInfo=d.authoringInfo&&d.authoringInfo.clone(),[2,{renderer:g,statistics:e.statistics,defaultValuesUsed:e.defaultValuesUsed,color:d.color,size:d.size,basemapId:d.basemapId,basemapTheme:d.basemapTheme}]}})})}});