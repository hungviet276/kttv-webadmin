// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../../core/Error ../../core/maybe ../../core/promiseUtils ./summaryStatistics ./support/ageUtils ./support/ageUtils ../support/adapters/support/layerUtils".split(" "),function(A,B,c,h,v,w,x,f,y,m){function z(d){return c.__awaiter(this,void 0,void 0,function(){var g,k,a,e,b,l,n,p;return c.__generator(this,function(q){switch(q.label){case 0:if(!(d&&d.layer&&d.startTime&&d.endTime&&d.unit))throw new h("summary-statistics-for-age:missing-parameters","'layer', 'startTime', 'endTime' and 'unit' parameters are required");
g=[0,2,1,3];k=d.layer;a=c.__rest(d,["layer"]);e=m.createLayerAdapter(k,g);b=c.__assign({layerAdapter:e},a);if(!e)throw new h("summary-statistics-for-age:invalid-parameters","'layer' must be one of these types: "+m.getLayerTypeLabels(g).join(", "));l=b.view;n=v.isSome(b.signal)?{signal:b.signal}:null;return[4,w.all([l&&l.when(),e.load(n)])];case 1:q.sent();if(p=f.verifyDates(e,b.startTime,b.endTime,"summary-statistics-for-age:invalid-parameters"))throw p;if(-1===f.supportedAgeUnits.indexOf(b.unit))throw new h("summary-statistics-for-age:invalid-parameters",
"Supported units are: "+f.supportedAgeUnits.join(", "));return[2,b]}})})}return function(d){return c.__awaiter(this,void 0,void 0,function(){var g,k,a,e,b,l,n,p,q,h,f,m,r,t;return c.__generator(this,function(u){switch(u.label){case 0:return[4,z(d)];case 1:return g=u.sent(),k=g.layerAdapter,a=c.__rest(g,["layerAdapter"]),e=a.view,b=a.startTime,l=a.endTime,n=a.unit,p=a.minValue,q=a.maxValue,h=a.signal,f=y.getAgeExpressions({layer:k,startTime:b,endTime:l,unit:n}),m=f.valueExpression,r=f.statisticsQuery,
t=c.__assign(c.__assign({layer:k,valueExpression:m},r),{minValue:p,maxValue:q,view:e,signal:h}),[2,x(t)]}})})}});