// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports tslib ../CIMCursor ../enums ../GeometryWalker".split(" "),function(g,f,k,l,d,h){Object.defineProperty(f,"__esModule",{value:!0});f.PlacementAlongLineSameSize=void 0;g=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(c,a,b){return new m(c,a,b)};c.instance=null;return c}();f.PlacementAlongLineSameSize=g;var m=function(c){function e(a,b,d){a=c.call(this,a,!0,!0)||this;a._grometryWalker=new h.GeometryWalker;
a._grometryWalker.updateTolerance(d);a._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;a._offset=void 0!==b.offset?b.offset*d:0;a._originalEndings=b.endings;a._offsetAtEnd=void 0!==b.customEndingOffset?b.customEndingOffset*d:0;a._position=void 0!==b.offsetAlongLine?b.offsetAlongLine*d:0;a._pattern=new h.DashPattern;a._pattern.init(b.placementTemplate,!1);a._pattern.scale(d);a._endings=a._originalEndings;return a}k.__extends(e,c);e.prototype.processPath=function(a){if(this._pattern.isEmpty())return null;
var b;if(this.iteratePath)b=this._pattern.nextValue();else{this._endings=this._originalEndings===d.PlacementEndings.WithFullGap&&this.isClosed?d.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;var c=!0;b=void 0;switch(this._endings){case d.PlacementEndings.NoConstraint:b=-this._position;b=this._adjustPosition(b);c=!1;break;default:b=-this._pattern.lastValue()/2;break;case d.PlacementEndings.WithFullGap:b=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();
break;case d.PlacementEndings.WithMarkers:b=0;break;case d.PlacementEndings.Custom:b=-this._position,b=this._adjustPosition(b),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(a,this._pattern,c))return null;this._pattern.reset();for(a=0;b>a;)b-=a,a=this._pattern.nextValue();b=a-b;this.iteratePath=!0}a={};if(!this._grometryWalker.nextPointAndAngle(b,a)||this._endings===d.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===
d.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(a.pt[0]+this._offset*a.sa,a.pt[1]-this._offset*a.ca);this._angleToLine&&this.internalPlacement.setRotateCS(a.ca,a.sa);return this.internalPlacement};e.prototype._adjustPosition=function(a){a/=this._pattern.length();a-=Math.floor(a);return a*this._pattern.length()};return e}(l.PathTransformationCursor)});