// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(l,f,p,m,q){Object.defineProperty(f,"__esModule",{value:!0});f.PlacementAtExtremities=void 0;l=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(b,a,c){return new r(b,a,c)};b.instance=null;return b}();f.PlacementAtExtremities=l;var r=function(b){function h(a,c,n){a=b.call(this,a,!1,!0)||this;a._curveHelper=new q.CurveHelper;a._angleToLine=void 0!==
c.angleToLine?c.angleToLine:!0;a._offset=void 0!==c.offset?c.offset*n:0;a._type=c.extremityPlacement;a._position=void 0!==c.offsetAlongLine?c.offsetAlongLine*n:0;a._beginProcessed=!1;return a}p.__extends(h,b);h.prototype.processPath=function(a){var c;switch(this._type){default:this._beginProcessed?(c=this._atExtremities(a,this._position,!1),this.iteratePath=this._beginProcessed=!1):(c=this._atExtremities(a,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":c=this._atExtremities(a,
this._position,!0);break;case "JustEnd":c=this._atExtremities(a,this._position,!1);case "None":}return c};h.prototype._atExtremities=function(a,c,b){var d=a.length;if(2>d)return null;for(var g=b?d:-1,h=b?1:-1,f=0,e=b?a[0]:a[d-1],d=b?1:d-2;d!==g;d+=h){b=e;var e=a[d],k=this._curveHelper.calculateLength(b,e);if(f+k>c)return c=(c-f)/k,g=this._curveHelper.getAngleCS(b,e,c),a=g[0],g=g[1],e=m.getCoord2D(b,e,c),this.internalPlacement.setTranslate(e[0]-this._offset*g,e[1]+this._offset*a),this._angleToLine&&
this.internalPlacement.setRotateCS(-a,-g),this.internalPlacement;f+=k}return null};return h}(m.PathTransformationCursor)});