// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","tslib","../CIMCursor","../GeometryWalker"],function(f,d,h,k,g){Object.defineProperty(d,"__esModule",{value:!0});d.PlacementAtRatioPositions=void 0;f=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(b,a,c){return new l(b,a,c)};b.instance=null;return b}();d.PlacementAtRatioPositions=f;var l=function(b){function d(a,c,e){a=b.call(this,a,!0,!0)||this;a._walker=new g.GeometryWalker;a._walker.updateTolerance(e);
a._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;a._offset=void 0!==c.offset?c.offset*e:0;a._beginGap=void 0!==c.beginPosition?c.beginPosition*e:0;a._endGap=void 0!==c.endPosition?c.endPosition*e:0;a._flipFirst=void 0!==c.flipFirst?c.flipFirst:!0;a._pattern=new g.DashPattern;a._pattern.init(c.positionArray,!1,!1);a._subPathLen=0;a._posCount=a._pattern.size();a._isFirst=!0;a._prevPos=0;return a}h.__extends(d,b);d.prototype.processPath=function(a){if(this._pattern.isEmpty())return null;var c;
if(this.iteratePath)a=this._pattern.nextValue()*this._subPathLen,a=this._beginGap+a,c=a-this._prevPos,this._prevPos=a;else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(a)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(a,this._pattern,!1))return null;this._pattern.reset();a=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+a;c=a-this._prevPos;this._prevPos=a;
this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(c,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]+this._offset*a.sa,a.pt[1]-this._offset*a.ca);c=this._isFirst&&this._flipFirst;var b;this._angleToLine?(b=a.ca,a=a.sa):(b=1,a=0);c&&(b=-b,a=-a);this.internalPlacement.setRotateCS(b,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return d}(k.PathTransformationCursor)});