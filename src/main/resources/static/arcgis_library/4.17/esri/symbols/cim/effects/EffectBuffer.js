// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(k,f,h,l){Object.defineProperty(f,"__esModule",{value:!0});f.EffectBuffer=void 0;k=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(a,c,d){return new m(a,c,d)};b.instance=null;return b}();f.EffectBuffer=k;var m=function(){function b(a,c,d){this._inputGeometries=a;this._curveHelper=new l.CurveHelper;this._size=(void 0!==c.size?
c.size:1)*d;this._offsetFlattenError=l.PIXEL_TOLERANCE*d}b.prototype.next=function(){for(var a=this._inputGeometries.next();a;){if(h.isExtent(a))if(0<this._size){var c=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(c=this._curveHelper.offset(c,this._size,"Rounded",4,this._offsetFlattenError))return{rings:[c]}}else if(0>this._size){if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._size)return{xmin:a.xmin-this._size,xmax:a.xmax+this._size,ymin:a.ymin-this._size,
ymax:a.ymax+this._size}}else return a;if(h.isPolygon(a)){if(0===this._size)return a;for(var d=[],b=0,g=a.rings;b<g.length;b++)c=g[b],(c=this._curveHelper.offset(c,this._size,"Rounded",4,this._offsetFlattenError))&&d.push(c);if(d.length)return{rings:d}}if(h.isPolyline(a)&&0<this._size){d=[];b=0;for(g=a.paths;b<g.length;b++){var e=g[b];if(e&&1<e.length&&(c=this._curveHelper.offset(e,this._size,"Rounded",4,this._offsetFlattenError),e=this._curveHelper.offset(e,-this._size,"Rounded",4,this._offsetFlattenError),
c&&e)){for(var f=e.length-1;0<=f;f--)c.push(e[f]);c.push([c[0][0],c[0][1]]);d.push(c)}}if(d.length)return{rings:d}}h.isPoint(a);a=this._inputGeometries.next()}return null};return b}()});