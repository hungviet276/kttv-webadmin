// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","tslib","../CIMCursor","../CurveHelper"],function(m,h,n,k,p){Object.defineProperty(h,"__esModule",{value:!0});h.PlacementOnLine=void 0;m=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(c,b,a){return new q(c,b,a)};c.instance=null;return c}();h.PlacementOnLine=m;var q=function(c){function f(b,a,d){b=c.call(this,b,!0,!0)||this;b._curveHelper=new p.CurveHelper;b._angleToLine=void 0!==a.angleToLine?
a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*d:0;b._relativeTo=a.relativeTo;b._position=void 0!==a.startPointOffset?a.startPointOffset*d:0;b._epsilon=.001*d;return b}n.__extends(f,c);f.prototype.processPath=function(b){var a=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=b.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var d=this._curSegment;this._curSegment++;var a=b[d-1],d=b[d],c=this._curveHelper.calculateLength(a,
d);if(!(c<this._epsilon)){var c=.5+this._position/c,e=this._curveHelper.getAngleCS(a,d,c);b=e[0];e=e[1];a=k.getCoord2D(a,d,c);this.internalPlacement.setTranslate(a[0]-this._offset*e,a[1]+this._offset*b);this._angleToLine&&this.internalPlacement.setRotateCS(b,e);return this.internalPlacement}}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&k.reversePath(b);a=this.onLine(b,a);"LineEnd"===this._relativeTo&&k.reversePath(b);return a};f.prototype.onLine=function(b,a){var d,c=!1;switch(this._relativeTo){default:d=
this._curveHelper.calculatePathLength(b)/2+a;break;case "LineBeginning":d=a;break;case "LineEnd":d=a,c=!0}for(var e=b.length,f=0,g=b[0],h=1;h<e;++h){a=g;var g=b[h],l=this._curveHelper.calculateLength(a,g);if(f+l>d)return e=(d-f)/l,d=this._curveHelper.getAngleCS(a,g,e),b=d[0],d=d[1],a=k.getCoord2D(a,g,e),g=c?this._offset:-this._offset,this.internalPlacement.setTranslate(a[0]-g*d,a[1]+g*b),this._angleToLine&&(c?this.internalPlacement.setRotateCS(-b,-d):this.internalPlacement.setRotateCS(b,d)),this.internalPlacement;
f+=l}return null};return f}(k.PathTransformationCursor)});