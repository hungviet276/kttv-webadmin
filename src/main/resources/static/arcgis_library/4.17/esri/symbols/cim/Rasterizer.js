// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ./CIMSymbolHelper ./Rect ./SDFHelper ./utils".split(" "),function(n,p,h,q,m,r){Object.defineProperty(p,"__esModule",{value:!0});n=function(){function k(){}k.prototype.dispose=function(){this._rasterizationCanvas=null};k.prototype.rasterizeJSONResource=function(a,f,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return b=h.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style,
f),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return b=h.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[b[1],b[2]],image:new Uint32Array(b[0].buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var d,e;"simple-marker"===a.type||"esriSMS"===a.type||"line-marker"===a.type?(a=h.CIMSymbolHelper.fromSimpleMarker(a),e=m.getSDFInfo(a)):"CIMHatchFill"===a.type?(a=h.CIMSymbolHelper.fromCIMHatchFill(a),
d=new q.default(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):a.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===a.markerPlacement.type?(a=h.CIMSymbolHelper.fromCIMInsidePolygon(a),d=new q.default(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):e=m.getSDFInfo(a);if(e&&!b)return b=m.buildSDF(e),(d=b[0])?{size:[b[1],b[2]],image:new Uint32Array(d.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;b=h.CIMSymbolHelper.rasterize(this._rasterizationCanvas,
a,d,!b);d=b[0];e=b[3];a=b[4];return d?{size:[b[1],b[2]],image:new Uint32Array(d.buffer),sdf:!1,simplePattern:!1,anchorX:e,anchorY:a}:null};k.prototype.rasterizeImageResource=function(a,f){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var b=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?b.putImageData(a,0,0):(a.setAttribute("width",a.width.toString()),a.setAttribute("height",
a.height.toString()),b.drawImage(a,0,0,a.width,a.height));b=b.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);if(f)for(var d=0;d<f.length;d++){var e=f[d];if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){var l=e.oldColor,g=l[0],h=l[1],k=l[2],l=l[3],c=e.newColor,e=c[0],m=c[1],n=c[2],p=c[3];if(g!==e||h!==m||k!==n||l!==p)for(c=0;c<b.length;c+=4)g===b[c]&&h===b[c+1]&&k===b[c+2]&&l===b[c+3]&&(b[c]=e,b[c+1]=m,b[c+2]=n,b[c+3]=p)}}for(c=0;c<b.length;c+=4)f=b[c+3]/255,
b[c]*=f,b[c+1]*=f,b[c+2]*=f;f=a.width;d=a.height;g=b;if(512<=f||512<=d)g=a.width/a.height,1<g?(f=512,d=Math.round(512/g)):(d=512,f=Math.round(512*g)),g=new Uint8Array(4*f*d),r.resampleHermite(b,a.width,a.height,new Uint8ClampedArray(g.buffer),f,d,!1);return{size:[f,d],image:new Uint32Array(g.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return k}();p.default=n});