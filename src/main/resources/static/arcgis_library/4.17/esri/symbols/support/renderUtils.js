// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ../../libs/maquette/index ./svgUtils".split(" "),function(E,k,v,x,u,y,w,z,A,B){function C(a,h,c){return a?x(a,{responseType:"image"}).then(function(a){a=a.data;var g=a.width,e=a.height,m=g/e,l=h;c&&(l=Math.min(l,Math.max(g,e)));return{image:a,width:1>=m?Math.ceil(l*m):l,height:1>=m?l:Math.ceil(l/m)}}):z.reject(new y("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(k,
"__esModule",{value:!0});k.tintImageWithColor=k.renderSymbol=void 0;var D=A.createProjector();k.renderSymbol=function(a,h,c){var k=Math.ceil(h[0]);h=Math.ceil(h[1]);if(!a.some(function(a){return!!a.length}))return null;var g=c&&c.node||document.createElement("div");null!=c.opacity&&(g.style.opacity=c.opacity.toString());D.append(g,B.renderSVG.bind(null,a,k,h,c));return g};k.tintImageWithColor=function(a,h,c,k,g){return C(a,h,g).then(function(e){var m=e.width?e.width:h,l=e.height?e.height:h,d;if(d=
e.image)d=c&&"ignore"!==k?"multiply"===k&&255===c.r&&255===c.g&&255===c.b&&1===c.a?!1:!0:!1;if(d){var g=e.image.width,t=e.image.height;(w("edge")||w("ie"))&&/\.svg$/i.test(a)&&(--g,--t);var n,b;n=Math.ceil(m);b=Math.ceil(l);d=document.createElement("canvas");d.width=n;d.height=b;d.style.width=n+"px";d.style.height=b+"px";d=d.getContext("2d");d.clearRect(0,0,n,b);d.drawImage(e.image,0,0,g,t,0,0,m,l);e=d.getImageData(0,0,m,l);g=[c.r/255,c.g/255,c.b/255,c.a];t=u.toHSV(c);for(n=0;n<e.data.length;n+=4){b=
e.data;var f=n,q=g,p=t;switch(k){case "multiply":b[f+0]*=q[0];b[f+1]*=q[1];b[f+2]*=q[2];b[f+3]*=q[3];break;default:var r=u.toHSV({r:b[f+0],g:b[f+1],b:b[f+2]});r.h=p.h;r.s=p.s;r.v=r.v/100*p.v;p=u.toRGB(r);b[f+0]=p.r;b[f+1]=p.g;b[f+2]=p.b;b[f+3]*=q[3]}}d.putImageData(e,0,0);a=d.canvas.toDataURL("image/png")}else(d=v.id&&v.id.findCredential(a))&&d.token&&(e=-1===a.indexOf("?")?"?":"\x26",a=""+a+e+"token\x3d"+d.token);return{url:a,width:m,height:l}}).catch(function(){return{url:a,width:h,height:h}})}});