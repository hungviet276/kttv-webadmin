// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.17/esri/copyright.txt for details.
//>>built
define(["require","exports","../../Color","../cim/utils"],function(v,f,k,g){function p(a){var b=g.toCIMSymbolJSON(a);if("CIMTextSymbol"===b.type)return b.height;a=0;if(b.symbolLayers)for(var c=0,b=b.symbolLayers;c<b.length;c++){var d=b[c];g.isCIMMarker(d)&&d.size>a?a=d.size:g.isCIMStroke(d)&&d.width>a?a=d.width:g.isCIMFill(d)}return a}function l(a,b,c){if("CIMTextSymbol"===a.type)a.height*=b;else{if(c&&a.effects){c=0;for(var d=a.effects;c<d.length;c++)r(d[c],b)}if(a.symbolLayers)for(c=0,a=a.symbolLayers;c<
a.length;c++)switch(d=a[c],d.type){case "CIMPictureMarker":case "CIMVectorMarker":q(d,b);break;case "CIMPictureStroke":case "CIMSolidStroke":d.width*=b;break;case "CIMPictureFill":d.height*=b;d.offsetX*=b;d.offsetY*=b;break;case "CIMHatchFill":l(d.lineSymbol,b,!0),d.offsetX*=b,d.offsetY*=b,d.separation*=b}}}function q(a,b){a.markerPlacement&&t(a.markerPlacement,b);a.offsetX*=b;a.offsetY*=b;a.anchorPoint&&"Absolute"===a.anchorPointUnits&&(a.anchorPoint={x:a.anchorPoint.x*b,y:a.anchorPoint.y*b});a.size*=
b;if("CIMVectorMarker"===a.type&&a.markerGraphics)for(var c=0,d=a.markerGraphics;c<d.length;c++){var e=d[c];a.scaleSymbolsProportionally||l(e.symbol,b,!0)}}function t(a,b){g.isCIMMarkerStrokePlacement(a)&&(a.offset*=b);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset*=b;a.offsetAlongLine*=b;if(a.placementTemplate&&a.placementTemplate.length){var c=a.placementTemplate.map(function(a){return a*b});a.placementTemplate=c}break;
case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset*=b;a.placementTemplate&&a.placementTemplate.length&&(c=a.placementTemplate.map(function(a){return a*b}),a.placementTemplate=c);break;case "CIMMarkerPlacementOnLine":a.startPointOffset*=b;break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine*=b;break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition*=b;a.endPosition*=b;break;case "CIMMarkerPlacementPolygonCenter":a.offsetX*=b;a.offsetY*=b;break;case "CIMMarkerPlacementInsidePolygon":a.offsetX*=
b,a.offsetY*=b,a.stepX*=b,a.stepY*=b}}function r(a,b){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width*=b;break;case "CIMGeometricEffectBuffer":a.size*=b;break;case "CIMGeometricEffectCut":a.beginCut*=b;a.endCut*=b;a.middleCut*=b;break;case "CIMGeometricEffectDashes":a.customEndingOffset*=b;a.offsetAlongLine*=b;if(a.dashTemplate&&a.dashTemplate.length){var c=a.dashTemplate.map(function(a){return a*b});a.dashTemplate=c}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length*=
b;break;case "CIMGeometricEffectMove":a.offsetX*=b;a.offsetY*=b;break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset*=b;break;case "CIMGeometricEffectRegularPolygon":a.radius*=b;break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth*=b;a.length*=b;a.toWidth*=b;break;case "CIMGeometricEffectWave":a.amplitude*=b,a.period*=b}}function m(a,b){var c;c="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(c.symbolLayers){var d=0;for(c=c.symbolLayers;d<
c.length;d++){var e=c[d];if(!(e.colorLocked||a&&(g.isCIMStroke(e)||g.isCIMMarker(e)&&e.markerPlacement&&g.isCIMMarkerStrokePlacement(e.markerPlacement))))switch(e.type){case "CIMVectorMarker":e.markerGraphics.forEach(function(a){m(a.symbol,b)});break;case "CIMSolidStroke":case "CIMSolidFill":u(b,e.color);break;case "CIMHatchFill":m(e.lineSymbol,b)}}}}function u(a,b){for(var c=0;c<a.length;c++)if(a[c].join(".")===b.join("."))return;a.push(b)}function n(a,b){var c;c="CIMTextSymbol"===a.type?a.symbol:
a;a="CIMPolygonSymbol"===a.type?!0:!1;if(c.symbolLayers){var d=0;for(c=c.symbolLayers;d<c.length;d++){var e=c[d];if(!(e.colorLocked||a&&(g.isCIMStroke(e)||g.isCIMMarker(e)&&e.markerPlacement&&g.isCIMMarkerStrokePlacement(e.markerPlacement)))){var f=b.toArray(0);switch(e.type){case "CIMVectorMarker":e.markerGraphics.forEach(function(a){n(a.symbol,b)});break;case "CIMSolidStroke":case "CIMSolidFill":e.color=f;break;case "CIMHatchFill":n(e.lineSymbol,b)}}}}}Object.defineProperty(f,"__esModule",{value:!0});
f.applyCIMSymbolRotation=f.getCIMSymbolRotation=f.applyCIMSymbolColor=f.getCIMSymbolColor=f.scaleCIMMarker=f.scaleCIMSymbolTo=f.getCIMSymbolSize=void 0;f.getCIMSymbolSize=p;f.scaleCIMSymbolTo=function(a,b){var c=g.toCIMSymbolJSON(a);a=p(a);if(0===a)if("CIMTextSymbol"===c.type)c.height=b;else{if(c.symbolLayers)for(a=0,c=c.symbolLayers;a<c.length;a++){var d=c[a];switch(d.type){case "CIMPictureMarker":case "CIMVectorMarker":d.size=b;break;case "CIMPictureStroke":case "CIMSolidStroke":d.width=b}}}else l(c,
b/a,!1)};f.scaleCIMMarker=q;f.getCIMSymbolColor=function(a){a=g.toCIMSymbolJSON(a);var b=[];m(a,b);return b.length?new k(g.fromCIMColor(b[0])):null};f.applyCIMSymbolColor=function(a,b){b instanceof k||(b=new k(b));a=g.toCIMSymbolJSON(a);n(a,b)};f.getCIMSymbolRotation=function(a){a=g.toCIMSymbolJSON(a);return"CIMTextSymbol"===a.type||"CIMPointSymbol"===a.type?a.angle||0:0};f.applyCIMSymbolRotation=function(a,b){a=g.toCIMSymbolJSON(a);if("CIMTextSymbol"===a.type)a.angle=b;else if("CIMPointSymbol"===
a.type&&a.symbolLayers)for(var c=b-(a.angle||0),d=0,e=a.symbolLayers;d<e.length;d++){var f=e[d];if(g.isCIMMarker(f)){var h=f.rotation||0,h=f.rotateClockwise?h-c:h+c;f.rotation=h}a.angle=b}}});